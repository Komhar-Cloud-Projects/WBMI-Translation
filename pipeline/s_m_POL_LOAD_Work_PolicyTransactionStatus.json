{
    "name": "s_m_POL_LOAD_Work_PolicyTransactionStatus",
    "properties": {
        "activities": [
            {
                "name": "m_POL_LOAD_Work_PolicyTransactionStatus",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_arch_pif_4514_stage AS (\n\tSELECT LTRIM(RTRIM(arch.pif_symbol)),\r\n\t       arch.pif_policy_number,\r\n\t       arch.pif_module,\r\n\t       arch.sar_id,\r\n\t       LTRIM(RTRIM(arch.sar_insurance_line)),\r\n\t       LTRIM(RTRIM(arch.sar_location_x)),\r\n\t       LTRIM(RTRIM(arch.sar_sub_location_x)),\r\n\t       LTRIM(RTRIM(arch.sar_risk_unit_group)),\r\n\t       LTRIM(RTRIM(arch.sar_class_code_grp_x)),\r\n\t       LTRIM(RTRIM(arch.sar_class_code_mem_x)),\r\n\t       LTRIM(RTRIM(arch.sar_unit)),\r\n\t       LTRIM(RTRIM(arch.sar_risk_unit_continued)),\r\n\t       LTRIM(RTRIM(arch.sar_seq_rsk_unt_a)),\r\n\t       LTRIM(RTRIM(arch.sar_major_peril)),\r\n\t       LTRIM(RTRIM(arch.sar_seq_no)),\r\n\t       arch.sar_cov_eff_year,\r\n\t       arch.sar_cov_eff_month,\r\n\t       arch.sar_cov_eff_day,\r\n\t       sar_part_code,\r\n\t       LTRIM(RTRIM(arch.sar_entrd_date)),\r\n\t       arch.sar_transaction,\r\n\t       arch.sar_premium,\r\n\t       arch.sar_agents_comm_rate,\r\n\t       LTRIM(RTRIM(arch.sar_state)),\r\n\t       LTRIM(RTRIM(arch.sar_loc_prov_territory)),\r\n\t       CASE WHEN LEN(LTRIM(RTRIM(arch.sar_county_first_two)) + LTRIM(RTRIM(arch.sar_county_last_one)) + LTRIM(RTRIM(arch.sar_city))) < 6 THEN '000000' ELSE \r\n\t       \t    LTRIM(RTRIM(arch.sar_county_first_two)) + LTRIM(RTRIM(arch.sar_county_last_one)) + LTRIM(RTRIM(arch.sar_city)) END as sar_city,\r\n\t       LTRIM(RTRIM(arch.sar_section)),\r\n\t       LTRIM(RTRIM(arch.sar_class_1_4)),\r\n\t       LTRIM(RTRIM(arch.sar_class_5_6)),\r\n\t       LTRIM(RTRIM(arch.sar_sub_line)),\r\n\t       LTRIM(RTRIM(sar_zip_postal_code)),\r\n\t       Hashbytes('MD5', ( LTRIM(RTRIM(arch.sar_id)) + LTRIM(RTRIM(arch.sar_insurance_line)) + LTRIM(RTRIM(arch.sar_location_x)) + LTRIM(RTRIM(arch.sar_unit)) + LTRIM(RTRIM(arch.sar_sub_location_x)) + LTRIM(RTRIM(arch.sar_risk_unit_group)) + LTRIM(RTRIM(arch.sar_class_code_grp_x)) + LTRIM(RTRIM(arch.sar_class_code_mem_x)) + LTRIM(RTRIM(arch.sar_risk_unit_continued)) + LTRIM(RTRIM(arch.sar_seq_rsk_unt_a)) + LTRIM(RTRIM(arch.sar_type_exposure)) + LTRIM(RTRIM(arch.sar_major_peril)) + LTRIM(RTRIM(arch.sar_seq_no)) + LTRIM(RTRIM(arch.sar_cov_eff_year)) + LTRIM(RTRIM(arch.sar_cov_eff_month)) + LTRIM(RTRIM(arch.sar_cov_eff_day)) + LTRIM(RTRIM(arch.sar_part_code)) + LTRIM(RTRIM(arch.sar_trans_eff_year)) + LTRIM(RTRIM(arch.sar_trans_eff_month)) + LTRIM(RTRIM(arch.sar_trans_eff_day)) + LTRIM(RTRIM(arch.sar_reinsurance_company_no)) + LTRIM(RTRIM(arch.sar_entrd_date)) + LTRIM(RTRIM(arch.sar_exp_year)) + LTRIM(RTRIM(arch.sar_exp_month)) + LTRIM(RTRIM(arch.sar_exp_day)) + Ltrim(\r\n\t                          Rtrim(arch.sar_transaction))\r\n\t                          + LTRIM(RTRIM(arch.sar_premium)) + LTRIM(RTRIM(arch.sar_original_prem)) + LTRIM(RTRIM(arch.sar_agents_comm_rate)) + LTRIM(RTRIM(arch.sar_acct_entrd_date)) + LTRIM(RTRIM(arch.sar_annual_state_line)) + LTRIM(RTRIM(arch.sar_state)) + LTRIM(RTRIM(arch.sar_loc_prov_territory)) + LTRIM(RTRIM(arch.sar_county_first_two)) + LTRIM(RTRIM(arch.sar_county_last_one)) + LTRIM(RTRIM(arch.sar_city)) + LTRIM(RTRIM(arch.sar_rsn_amend_one)) + LTRIM(RTRIM(arch.sar_rsn_amend_two)) + LTRIM(RTRIM(arch.sar_rsn_amend_three)) + LTRIM(RTRIM(arch.sar_special_use)) + LTRIM(RTRIM(arch.sar_stat_breakdown_line)) + LTRIM(RTRIM(arch.sar_user_line)) + LTRIM(RTRIM(arch.sar_section)) + LTRIM(RTRIM(arch.sar_rating_date_ind)) + LTRIM(RTRIM(arch.sar_type_bureau)) + LTRIM(RTRIM(arch.sar_class_1_4)) + LTRIM(RTRIM(arch.sar_class_5_6)) + LTRIM(RTRIM(arch.sar_exposure)) + LTRIM(RTRIM(arch.sar_sub_line)) + LTRIM(RTRIM(arch.sar_code_1)) + LTRIM(RTRIM(arch.sar_code_2)) + Ltrim(Rtrim(arch.sar_code_3)) + LTRIM(RTRIM(arch.sar_code_4)) + LTRIM(RTRIM(arch.sar_code_5)) + LTRIM(RTRIM(arch.sar_code_6)) + LTRIM(RTRIM(arch.sar_code_7)) + LTRIM(RTRIM(arch.sar_code_8)) + LTRIM(RTRIM(arch.sar_code_9)) + LTRIM(RTRIM(arch.sar_code_10)) + LTRIM(RTRIM(arch.sar_code_11)) + LTRIM(RTRIM(arch.sar_code_12)) + LTRIM(RTRIM(arch.sar_code_13)) + LTRIM(RTRIM(arch.sar_code_14)) + LTRIM(RTRIM(arch.sar_code_15)) + LTRIM(RTRIM(arch.sar_zip_postal_code)) + LTRIM(RTRIM(arch.sar_audit_reinst_ind)) )) AS sar_yr2000_cust_use\r\n\tFROM   @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.@{pipeline().parameters.SOURCE_TABLE_NAME_ARCH} arch\r\n\t       INNER JOIN (SELECT pif_symbol,\r\n\t                          pif_policy_number,\r\n\t                          pif_module,\r\n\t                          MAX(audit_id) AS audit_id\r\n\t                   FROM   @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.@{pipeline().parameters.SOURCE_TABLE_NAME_ARCH}                   \r\n\t                    WHERE  logical_flag IN ('0','1','2','3')  AND @{pipeline().parameters.WHERE_CLAUSE_2}             \r\n\tGROUP  BY pif_symbol,pif_policy_number,pif_module)A\r\n\t         ON arch.pif_symbol = a.pif_symbol\r\n\t            AND arch.pif_policy_number = a.pif_policy_number\r\n\t            AND arch.pif_module = a.pif_module\r\n\t            AND arch.audit_id = a.audit_id\r\n\tWHERE  EXISTS(SELECT DISTINCT pif_symbol,\r\n\t                              pif_policy_number,\r\n\t                              pif_module\r\n\t              FROM   @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.@{pipeline().parameters.SOURCE_TABLE_NAME_STAGE} stage\r\n\t              WHERE logical_flag IN ('0','1','2','3')  \r\n\t\t\t\tAND stage.pif_symbol = arch.pif_symbol\r\n\t                   AND stage.pif_policy_number = arch.pif_policy_number\r\n\t                   AND stage.pif_module = arch.pif_module)\r\n\tAND @{pipeline().parameters.WHERE_CLAUSE_ARCH}\n),\nEXP_Default_Archive AS (\n\tSELECT\n\tpif_symbol AS arch_pif_symbol,\n\tpif_policy_number AS arch_pif_policy_number,\n\tpif_module AS arch_pif_module,\n\tsar_id AS arch_sar_id,\n\tsar_insurance_line AS arch_sar_insurance_line,\n\tsar_location_x AS arch_sar_location_x,\n\tsar_sub_location_x AS arch_sar_sub_location_x,\n\tsar_risk_unit_group AS arch_sar_risk_unit_group,\n\tsar_class_code_grp_x AS arch_sar_class_code_grp_x,\n\tsar_class_code_mem_x AS arch_sar_class_code_mem_x,\n\tsar_unit AS arch_sar_unit,\n\tsar_risk_unit_continued AS arch_sar_risk_unit_continued,\n\tsar_seq_rsk_unt_a AS arch_sar_seq_rsk_unt_a,\n\tsar_major_peril AS arch_sar_major_peril,\n\tsar_seq_no AS arch_sar_seq_no,\n\tsar_cov_eff_year AS arch_sar_cov_eff_year,\n\tsar_cov_eff_month AS arch_sar_cov_eff_month,\n\tsar_cov_eff_day AS arch_sar_cov_eff_day,\n\tsar_part_code AS arch_sar_part_code,\n\tsar_entrd_date AS arch_sar_entrd_date,\n\tsar_transaction AS arch_sar_transaction,\n\tsar_premium AS arch_sar_premium,\n\tsar_agents_comm_rate AS arch_sar_agents_comm_rate,\n\tsar_state AS arch_sar_state,\n\tsar_loc_prov_territory AS arch_sar_loc_prov_territory,\n\tsar_city AS arch_sar_city,\n\tsar_section AS arch_sar_section,\n\tsar_class_1_4 AS arch_sar_class_1_4,\n\tsar_class_5_6 AS arch_sar_class_5_6,\n\tarch_sar_class_1_4  ||  arch_sar_class_5_6 AS arch_sar_class_code,\n\tsar_sub_line AS arch_sar_sub_line,\n\tsar_zip_postal_code AS arch_sar_zip_postal_code,\n\tsar_yr2000_cust_use AS arch_sar_yr2000_cust_use\n\tFROM SQ_arch_pif_4514_stage\n),\nSQ_pif_4514_stage AS (\n\tSELECT LTRIM(RTRIM(pif_symbol)),\r\n\t       pif_policy_number,\r\n\t       pif_module,\r\n\t       sar_id,\r\n\t       LTRIM(RTRIM(sar_insurance_line)),\r\n\t       LTRIM(RTRIM(sar_location_x)),\r\n\t       LTRIM(RTRIM(sar_sub_location_x)),\r\n\t       LTRIM(RTRIM(sar_risk_unit_group)),\r\n\t       LTRIM(RTRIM(sar_class_code_grp_x)),\r\n\t       LTRIM(RTRIM(sar_class_code_mem_x)),\r\n\t       LTRIM(RTRIM(sar_unit)),\r\n\t       LTRIM(RTRIM(sar_risk_unit_continued)),\r\n\t       LTRIM(RTRIM(sar_seq_rsk_unt_a)),\r\n\t       LTRIM(RTRIM(sar_major_peril)),\r\n\t       LTRIM(RTRIM(sar_seq_no)),\r\n\t       sar_cov_eff_year,\r\n\t       sar_cov_eff_month,\r\n\t       sar_cov_eff_day,\r\n\t       sar_part_code,\r\n\t       LTRIM(RTRIM(sar_entrd_date)),\r\n\t       sar_transaction,\r\n\t       sar_premium,\r\n\t       sar_agents_comm_rate,\r\n\t       LTRIM(RTRIM(sar_state)),\r\n\t       LTRIM(RTRIM(sar_loc_prov_territory)),\r\n\t       CASE WHEN LEN(LTRIM(RTRIM(sar_county_first_two)) + LTRIM(RTRIM(sar_county_last_one)) + LTRIM(RTRIM(sar_city))) < 6 THEN '000000' ELSE \r\n\t       \t    LTRIM(RTRIM(sar_county_first_two)) + LTRIM(RTRIM(sar_county_last_one)) + LTRIM(RTRIM(sar_city)) END as sar_city,\r\n\t       LTRIM(RTRIM(sar_section)),\r\n\t       LTRIM(RTRIM(sar_class_1_4)),\r\n\t       LTRIM(RTRIM(sar_class_5_6)),\r\n\t       LTRIM(RTRIM(sar_sub_line)),\r\n\t       LTRIM(RTRIM(sar_zip_postal_code)),\r\n\t       Hashbytes('MD5', ( LTRIM(RTRIM(sar_id)) + LTRIM(RTRIM(sar_insurance_line)) + LTRIM(RTRIM(sar_location_x)) + LTRIM(RTRIM(sar_unit)) \r\n\t                          + LTRIM(RTRIM(sar_sub_location_x)) + LTRIM(RTRIM(sar_risk_unit_group)) + LTRIM(RTRIM(sar_class_code_grp_x)) + \r\n\t                          LTRIM(RTRIM(sar_class_code_mem_x)) + LTRIM(RTRIM(sar_risk_unit_continued)) + LTRIM(RTRIM(sar_seq_rsk_unt_a)) + \r\n\t                          LTRIM(RTRIM(sar_type_exposure)) + LTRIM(RTRIM(sar_major_peril)) + LTRIM(RTRIM(sar_seq_no)) + \r\n\t                          LTRIM(RTRIM(sar_cov_eff_year)) + LTRIM(RTRIM(sar_cov_eff_month)) + LTRIM(RTRIM(sar_cov_eff_day)) + \r\n\t                          LTRIM(RTRIM(sar_part_code)) + LTRIM(RTRIM(sar_trans_eff_year)) + LTRIM(RTRIM(sar_trans_eff_month)) + \r\n\t                          LTRIM(RTRIM(sar_trans_eff_day)) + LTRIM(RTRIM(sar_reinsurance_company_no)) + LTRIM(RTRIM(sar_entrd_date)) + \r\n\t                          LTRIM(RTRIM(sar_exp_year)) + LTRIM(RTRIM(sar_exp_month)) + LTRIM(RTRIM(sar_exp_day)) +\r\n\t                          LTRIM(RTRIM(sar_transaction)) + LTRIM(RTRIM(sar_premium)) + LTRIM(RTRIM(sar_original_prem)) + \r\n\t                          LTRIM(RTRIM(sar_agents_comm_rate)) + LTRIM(RTRIM(sar_acct_entrd_date)) + LTRIM(RTRIM(sar_annual_state_line)) + \r\n\t                          LTRIM(RTRIM(sar_state)) + LTRIM(RTRIM(sar_loc_prov_territory)) + LTRIM(RTRIM(sar_county_first_two)) + \r\n\t                          LTRIM(RTRIM(sar_county_last_one)) + LTRIM(RTRIM(sar_city)) + LTRIM(RTRIM(sar_rsn_amend_one)) + LTRIM(RTRIM(sar_rsn_amend_two)) + LTRIM(RTRIM(sar_rsn_amend_three)) + LTRIM(RTRIM(sar_special_use)) + LTRIM(RTRIM(sar_stat_breakdown_line)) + LTRIM(RTRIM(sar_user_line)) + LTRIM(RTRIM(sar_section)) + LTRIM(RTRIM(sar_rating_date_ind)) + LTRIM(RTRIM(sar_type_bureau)) + LTRIM(RTRIM(sar_class_1_4)) + LTRIM(RTRIM(sar_class_5_6)) + LTRIM(RTRIM(sar_exposure)) + LTRIM(RTRIM(sar_sub_line)) + Ltrim(\r\n\t                          Rtrim(sar_code_1)) + LTRIM(RTRIM(sar_code_2)) + LTRIM(RTRIM(sar_code_3)) + LTRIM(RTRIM(sar_code_4)) + LTRIM(RTRIM(sar_code_5)) + LTRIM(RTRIM(sar_code_6)) + LTRIM(RTRIM(sar_code_7)) + LTRIM(RTRIM(sar_code_8)) + LTRIM(RTRIM(sar_code_9)) + LTRIM(RTRIM(sar_code_10)) + LTRIM(RTRIM(sar_code_11)) + LTRIM(RTRIM(sar_code_12)) + LTRIM(RTRIM(sar_code_13)) + LTRIM(RTRIM(sar_code_14)) + LTRIM(RTRIM(sar_code_15)) + LTRIM(RTRIM(sar_zip_postal_code)) + LTRIM(RTRIM(sar_audit_reinst_ind)) ))                                                                                                                                                                                                                                                                                                                                                                AS sar_yr2000_cust_use\r\n\tFROM  @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.@{pipeline().parameters.SOURCE_TABLE_NAME_STAGE}\r\n\tWHERE logical_flag in ('0','1','2','3') AND @{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Default_Stage AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tsar_id,\n\tsar_insurance_line,\n\tsar_location_x,\n\tsar_sub_location_x,\n\tsar_risk_unit_group,\n\tsar_class_code_grp_x,\n\tsar_class_code_mem_x,\n\tsar_unit,\n\tsar_risk_unit_continued,\n\tsar_seq_rsk_unt_a,\n\tsar_major_peril,\n\tsar_seq_no,\n\tsar_cov_eff_year,\n\tsar_cov_eff_month,\n\tsar_cov_eff_day,\n\tsar_part_code,\n\tsar_entrd_date,\n\tsar_transaction,\n\tsar_premium,\n\tsar_agents_comm_rate,\n\tsar_state,\n\tsar_loc_prov_territory,\n\tsar_city,\n\tsar_section,\n\tsar_class_1_4,\n\tsar_class_5_6,\n\tsar_class_1_4  ||  sar_class_5_6 AS sar_class_code,\n\tsar_sub_line,\n\tsar_zip_postal_code,\n\tsar_yr2000_cust_use\n\tFROM SQ_pif_4514_stage\n),\nJNR_Stage_Archive_Data AS (SELECT\n\tEXP_Default_Archive.arch_pif_symbol, \n\tEXP_Default_Archive.arch_pif_policy_number, \n\tEXP_Default_Archive.arch_pif_module, \n\tEXP_Default_Archive.arch_sar_id, \n\tEXP_Default_Archive.arch_sar_insurance_line, \n\tEXP_Default_Archive.arch_sar_location_x, \n\tEXP_Default_Archive.arch_sar_sub_location_x, \n\tEXP_Default_Archive.arch_sar_risk_unit_group, \n\tEXP_Default_Archive.arch_sar_class_code_grp_x, \n\tEXP_Default_Archive.arch_sar_class_code_mem_x, \n\tEXP_Default_Archive.arch_sar_unit, \n\tEXP_Default_Archive.arch_sar_risk_unit_continued, \n\tEXP_Default_Archive.arch_sar_seq_rsk_unt_a, \n\tEXP_Default_Archive.arch_sar_major_peril, \n\tEXP_Default_Archive.arch_sar_seq_no, \n\tEXP_Default_Archive.arch_sar_cov_eff_year, \n\tEXP_Default_Archive.arch_sar_cov_eff_month, \n\tEXP_Default_Archive.arch_sar_cov_eff_day, \n\tEXP_Default_Archive.arch_sar_part_code, \n\tEXP_Default_Archive.arch_sar_entrd_date, \n\tEXP_Default_Archive.arch_sar_transaction, \n\tEXP_Default_Archive.arch_sar_premium, \n\tEXP_Default_Archive.arch_sar_agents_comm_rate, \n\tEXP_Default_Archive.arch_sar_state, \n\tEXP_Default_Archive.arch_sar_loc_prov_territory, \n\tEXP_Default_Archive.arch_sar_city, \n\tEXP_Default_Archive.arch_sar_section, \n\tEXP_Default_Archive.arch_sar_class_code, \n\tEXP_Default_Archive.arch_sar_sub_line, \n\tEXP_Default_Archive.arch_sar_zip_postal_code, \n\tEXP_Default_Archive.arch_sar_yr2000_cust_use, \n\tEXP_Default_Stage.pif_symbol, \n\tEXP_Default_Stage.pif_policy_number, \n\tEXP_Default_Stage.pif_module, \n\tEXP_Default_Stage.sar_id, \n\tEXP_Default_Stage.sar_insurance_line, \n\tEXP_Default_Stage.sar_location_x, \n\tEXP_Default_Stage.sar_sub_location_x, \n\tEXP_Default_Stage.sar_risk_unit_group, \n\tEXP_Default_Stage.sar_class_code_grp_x, \n\tEXP_Default_Stage.sar_class_code_mem_x, \n\tEXP_Default_Stage.sar_unit, \n\tEXP_Default_Stage.sar_risk_unit_continued, \n\tEXP_Default_Stage.sar_seq_rsk_unt_a, \n\tEXP_Default_Stage.sar_major_peril, \n\tEXP_Default_Stage.sar_seq_no, \n\tEXP_Default_Stage.sar_cov_eff_year, \n\tEXP_Default_Stage.sar_cov_eff_month, \n\tEXP_Default_Stage.sar_cov_eff_day, \n\tEXP_Default_Stage.sar_part_code, \n\tEXP_Default_Stage.sar_entrd_date, \n\tEXP_Default_Stage.sar_transaction, \n\tEXP_Default_Stage.sar_premium, \n\tEXP_Default_Stage.sar_agents_comm_rate, \n\tEXP_Default_Stage.sar_state, \n\tEXP_Default_Stage.sar_loc_prov_territory, \n\tEXP_Default_Stage.sar_city, \n\tEXP_Default_Stage.sar_section, \n\tEXP_Default_Stage.sar_class_code, \n\tEXP_Default_Stage.sar_sub_line, \n\tEXP_Default_Stage.sar_zip_postal_code, \n\tEXP_Default_Stage.sar_yr2000_cust_use\n\tFROM EXP_Default_Archive\n\tRIGHT OUTER JOIN EXP_Default_Stage\n\tON EXP_Default_Stage.pif_symbol = EXP_Default_Archive.arch_pif_symbol AND EXP_Default_Stage.pif_policy_number = EXP_Default_Archive.arch_pif_policy_number AND EXP_Default_Stage.pif_module = EXP_Default_Archive.arch_pif_module AND EXP_Default_Stage.sar_id = EXP_Default_Archive.arch_sar_id AND EXP_Default_Stage.sar_insurance_line = EXP_Default_Archive.arch_sar_insurance_line AND EXP_Default_Stage.sar_location_x = EXP_Default_Archive.arch_sar_location_x AND EXP_Default_Stage.sar_sub_location_x = EXP_Default_Archive.arch_sar_sub_location_x AND EXP_Default_Stage.sar_risk_unit_group = EXP_Default_Archive.arch_sar_risk_unit_group AND EXP_Default_Stage.sar_class_code_grp_x = EXP_Default_Archive.arch_sar_class_code_grp_x AND EXP_Default_Stage.sar_class_code_mem_x = EXP_Default_Archive.arch_sar_class_code_mem_x AND EXP_Default_Stage.sar_unit = EXP_Default_Archive.arch_sar_unit AND EXP_Default_Stage.sar_risk_unit_continued = EXP_Default_Archive.arch_sar_risk_unit_continued AND EXP_Default_Stage.sar_seq_rsk_unt_a = EXP_Default_Archive.arch_sar_seq_rsk_unt_a AND EXP_Default_Stage.sar_major_peril = EXP_Default_Archive.arch_sar_major_peril AND EXP_Default_Stage.sar_seq_no = EXP_Default_Archive.arch_sar_seq_no AND EXP_Default_Stage.sar_cov_eff_year = EXP_Default_Archive.arch_sar_cov_eff_year AND EXP_Default_Stage.sar_cov_eff_month = EXP_Default_Archive.arch_sar_cov_eff_month AND EXP_Default_Stage.sar_cov_eff_day = EXP_Default_Archive.arch_sar_cov_eff_day AND EXP_Default_Stage.sar_part_code = EXP_Default_Archive.arch_sar_part_code AND EXP_Default_Stage.sar_entrd_date = EXP_Default_Archive.arch_sar_entrd_date AND EXP_Default_Stage.sar_transaction = EXP_Default_Archive.arch_sar_transaction AND EXP_Default_Stage.sar_premium = EXP_Default_Archive.arch_sar_premium AND EXP_Default_Stage.sar_state = EXP_Default_Archive.arch_sar_state\n),\nEXP_Evaluate AS (\n\tSELECT\n\tarch_pif_symbol,\n\tarch_pif_policy_number,\n\tarch_pif_module,\n\tarch_sar_location_x,\n\tarch_sar_sub_location_x,\n\tarch_sar_unit,\n\tarch_sar_major_peril,\n\tarch_sar_seq_no,\n\tarch_sar_entrd_date,\n\tarch_sar_transaction,\n\tarch_sar_premium,\n\tarch_sar_agents_comm_rate,\n\tarch_sar_state,\n\tarch_sar_loc_prov_territory,\n\tarch_sar_city,\n\tarch_sar_section,\n\tarch_sar_class_code,\n\tarch_sar_sub_line,\n\tarch_sar_zip_postal_code,\n\tarch_sar_yr2000_cust_use,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tpif_symbol  ||  pif_policy_number  || pif_module AS PolicyKey,\n\tsar_location_x,\n\tsar_sub_location_x,\n\tsar_unit,\n\tsar_major_peril,\n\tsar_seq_no,\n\tsar_entrd_date,\n\tsar_transaction,\n\tsar_premium,\n\tsar_agents_comm_rate,\n\tsar_state,\n\tsar_loc_prov_territory,\n\tsar_city,\n\tsar_section,\n\tsar_class_code,\n\tsar_sub_line,\n\tsar_zip_postal_code,\n\tsar_yr2000_cust_use,\n\t-- *INF*: DECODE(TRUE,arch_sar_yr2000_cust_use = sar_yr2000_cust_use, 'NOCHANGE',\r\n\t-- ISNULL(arch_sar_yr2000_cust_use), 'NEWTRANSACTION',\r\n\t-- arch_sar_yr2000_cust_use <> sar_yr2000_cust_use AND \r\n\t-- (arch_sar_state <> sar_state OR \r\n\t-- arch_sar_loc_prov_territory <> sar_loc_prov_territory OR \r\n\t-- arch_sar_city <> sar_city OR \r\n\t-- arch_sar_zip_postal_code <> sar_zip_postal_code), 'RISKLOCATIONLEVELCHANGE',\r\n\t-- arch_sar_yr2000_cust_use <> sar_yr2000_cust_use AND \r\n\t-- (arch_sar_agents_comm_rate <> sar_agents_comm_rate  OR \r\n\t-- arch_sar_section <> sar_section OR\r\n\t-- arch_sar_class_code  <> sar_class_code OR \r\n\t-- arch_sar_sub_line <> sar_sub_line  ), 'COVERAGEDETAILLEVELCHANGE'  )\n\tDECODE(TRUE,\n\tarch_sar_yr2000_cust_use = sar_yr2000_cust_use, 'NOCHANGE',\n\tarch_sar_yr2000_cust_use IS NULL, 'NEWTRANSACTION',\n\tarch_sar_yr2000_cust_use <> sar_yr2000_cust_use AND ( arch_sar_state <> sar_state OR arch_sar_loc_prov_territory <> sar_loc_prov_territory OR arch_sar_city <> sar_city OR arch_sar_zip_postal_code <> sar_zip_postal_code ), 'RISKLOCATIONLEVELCHANGE',\n\tarch_sar_yr2000_cust_use <> sar_yr2000_cust_use AND ( arch_sar_agents_comm_rate <> sar_agents_comm_rate OR arch_sar_section <> sar_section OR arch_sar_class_code <> sar_class_code OR arch_sar_sub_line <> sar_sub_line ), 'COVERAGEDETAILLEVELCHANGE') AS v_Status_flag,\n\t-- *INF*: IIF(ISNULL(v_Status_flag),'UNKNOWN',v_Status_flag)\n\tIFF(v_Status_flag IS NULL, 'UNKNOWN', v_Status_flag) AS StatusFlag\n\tFROM JNR_Stage_Archive_Data\n),\nFIL_Records AS (\n\tSELECT\n\tPolicyKey, \n\tStatusFlag AS Flag, \n\tarch_sar_location_x, \n\tarch_sar_sub_location_x, \n\tarch_sar_unit, \n\tarch_sar_major_peril, \n\tarch_sar_seq_no, \n\tarch_sar_entrd_date, \n\tarch_sar_transaction, \n\tarch_sar_premium, \n\tarch_sar_agents_comm_rate, \n\tarch_sar_state, \n\tarch_sar_loc_prov_territory, \n\tarch_sar_city, \n\tarch_sar_section, \n\tarch_sar_class_code, \n\tarch_sar_sub_line, \n\tarch_sar_zip_postal_code, \n\tsar_location_x, \n\tsar_sub_location_x, \n\tsar_unit, \n\tsar_major_peril, \n\tsar_seq_no, \n\tsar_entrd_date, \n\tsar_transaction, \n\tsar_premium, \n\tsar_agents_comm_rate, \n\tsar_state, \n\tsar_loc_prov_territory, \n\tsar_city, \n\tsar_section, \n\tsar_class_code, \n\tsar_sub_line, \n\tsar_zip_postal_code\n\tFROM EXP_Evaluate\n\tWHERE TRUE\n),\nSRT_Sort_Policies AS (\n\tSELECT\n\tPolicyKey, \n\tFlag\n\tFROM FIL_Records\n\tORDER BY PolicyKey ASC, Flag ASC\n),\nEXP_Values AS (\n\tSELECT\n\tPolicyKey,\n\tFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate\n\tFROM SRT_Sort_Policies\n),\nWork_PolicyTransactionStatus AS (\n\tINSERT INTO Work_PolicyTransactionStatus\n\t(PolicyKey, PolicyStatus, AuditID, CreatedDate, ModifiedDate)\n\tSELECT \n\tPOLICYKEY, \n\tFlag AS POLICYSTATUS, \n\tAUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE\n\tFROM EXP_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_NAME_ARCH": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_NAME_STAGE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_ARCH": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Policy DataWarehouse/"
        },
        "annotations": []
    }
}