{
    "name": "s_m_CLM_ARCH_Insert_CLAIM_OBJECT",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_CLAIM_OBJECT",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CLAIM_OBJECT_STAGE1 AS (\n\tSELECT\n\t\tclaim_object_id AS CLAIM_OBJECT_ID,\n\t\tcob_claim_nbr AS COB_CLAIM_NBR,\n\t\tcob_object_type_cd AS COB_OBJECT_TYPE_CD,\n\t\tcob_object_seq_nbr AS COB_OBJECT_SEQ_NBR,\n\t\tcob_demand_amt AS COB_DEMAND_AMT,\n\t\tcob_bills_des_id AS COB_BILLS_DES_ID,\n\t\tcob_client_seq_nbr AS COB_CLIENT_SEQ_NBR,\n\t\tcob_cmt_dsc_id AS COB_CMT_DSC_ID,\n\t\tcob_create_ts AS COB_CREATE_TS,\n\t\tcob_dcs_bse_doc_cd AS COB_DCS_BSE_DOC_CD,\n\t\tcob_dsc_rea_cd AS COB_DSC_REA_CD,\n\t\tcob_entry_opr_id AS COB_ENTRY_OPR_ID,\n\t\tcob_pmsd_ts AS COB_PMSD_TS,\n\t\tcob_object_cmt_id AS COB_OBJECT_CMT_ID,\n\t\tcob_rea_for_los_id AS COB_REA_FOR_LOS_ID,\n\t\tcob_recovery_ind AS COB_RECOVERY_IND,\n\t\tcob_type_of_loss AS COB_TYPE_OF_LOSS,\n\t\tcob_update_opr_id AS COB_UPDATE_OPR_ID,\n\t\tcob_upd_ts AS COB_UPD_TS,\n\t\tcob_police_ivs_cd AS COB_POLICE_IVS_CD,\n\t\tcob_rsp_party_id AS COB_RSP_PARTY_ID,\n\t\tcob_lia_type_cd AS COB_LIA_TYPE_CD,\n\t\tcob_liability_ind AS COB_LIABILITY_IND,\n\t\tcob_injury_ind AS COB_INJURY_IND,\n\t\tcob_loss_place_id AS COB_LOSS_PLACE_ID,\n\t\tcob_notice_wch_ind AS COB_NOTICE_WCH_IND,\n\t\tcob_adjusted_ind AS COB_ADJUSTED_IND,\n\t\tcob_adjusted_dt AS COB_ADJUSTED_DT,\n\t\tcob_blood_test_tm AS COB_BLOOD_TEST_TM,\n\t\tcob_blood_test_dt AS COB_BLOOD_TEST_DT,\n\t\tcob_alcohol_pct AS COB_ALCOHOL_PCT,\n\t\tcob_alcohol_ifl_cd AS COB_ALCOHOL_IFL_CD,\n\t\tcob_alcohol_tm AS COB_ALCOHOL_TM,\n\t\tcob_blood_test_ind AS COB_BLOOD_TEST_IND,\n\t\tcob_alcohol_ind AS COB_ALCOHOL_IND,\n\t\tcob_cession_nbr AS COB_CESSION_NBR,\n\t\tcob_rin_ind AS COB_RIN_IND,\n\t\tcob_suit_ind AS COB_SUIT_IND,\n\t\tcob_other_cov_ind AS COB_OTHER_COV_IND,\n\t\tcob_leg_counsel_cd AS COB_LEG_COUNSEL_CD,\n\t\tcob_sport_cd AS COB_SPORT_CD,\n\t\tcob_report_nbr AS COB_REPORT_NBR,\n\t\tcob_isu_own_ind AS COB_ISU_OWN_IND,\n\t\tcob_isu_tnt_ind AS COB_ISU_TNT_IND,\n\t\tcob_isu_oth_ind AS COB_ISU_OTH_IND,\n\t\tcob_premise_des AS COB_PREMISE_DES,\n\t\tcob_isu_muf_ind AS COB_ISU_MUF_IND,\n\t\tcob_isu_ven_ind AS COB_ISU_VEN_IND,\n\t\tcob_prd_des_id AS COB_PRD_DES_ID,\n\t\tcob_lia_des_id AS COB_LIA_DES_ID,\n\t\tcob_offer_amt AS COB_OFFER_AMT,\n\t\tcob_offer_dt AS COB_OFFER_DT,\n\t\tcob_object_status AS COB_OBJECT_STATUS,\n\t\tcob_on_pms_ind AS COB_ON_PMS_IND,\n\t\tcob_unit_type_ind AS COB_UNIT_TYPE_IND,\n\t\tcob_unit_des_id AS COB_UNIT_DES_ID,\n\t\tcob_cov_unit_nbr AS COB_COV_UNIT_NBR,\n\t\tcob_ald_ind AS COB_ALD_IND,\n\t\tcob_cov_bld_nbr AS COB_COV_BLD_NBR,\n\t\tcob_total_loss_ind AS COB_TOTAL_LOSS_IND,\n\t\tcob_at_fault_cd AS COB_AT_FAULT_CD,\n\t\tcob_tty_unt_nbr AS COB_TTY_UNT_NBR,\n\t\tcob_unit_type_cd AS COB_UNIT_TYPE_CD,\n\t\tcob_spp_use_cd AS COB_SPP_USE_CD,\n\t\tcob_sar_id AS COB_SAR_ID,\n\t\tcob_ins_line AS COB_INS_LINE,\n\t\tcob_loc_unit_num AS COB_LOC_UNIT_NUM,\n\t\tcob_risk_unit_grp AS COB_RISK_UNIT_GRP,\n\t\tcob_rsk_unt_gr_seq AS COB_RSK_UNT_GR_SEQ,\n\t\tcob_risk_unit AS COB_RISK_UNIT,\n\t\tcob_risk_type_ind AS COB_RISK_TYPE_IND,\n\t\tcob_class_code AS COB_CLASS_CODE,\n\t\tcob_sub_loc_num AS COB_SUB_LOC_NUM,\n\t\tcob_seq_risk_unit AS COB_SEQ_RISK_UNIT,\n\t\tcob_sr_seq AS COB_SR_SEQ,\n\t\tcob_client_id AS COB_CLIENT_ID,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID,\n\t\tcob_coverage_form,\n\t\tcob_coverage_type,\n\t\tcob_risk_type\n\tFROM CLAIM_OBJECT_STAGE\n),\nEXP_CLAIM_OBJECT_STAGE AS (\n\tSELECT\n\tCLAIM_OBJECT_ID,\n\tCOB_CLAIM_NBR,\n\tCOB_OBJECT_TYPE_CD,\n\tCOB_OBJECT_SEQ_NBR,\n\tCOB_DEMAND_AMT,\n\tCOB_BILLS_DES_ID,\n\tCOB_CLIENT_SEQ_NBR,\n\tCOB_CMT_DSC_ID,\n\tCOB_CREATE_TS,\n\tCOB_DCS_BSE_DOC_CD,\n\tCOB_DSC_REA_CD,\n\tCOB_ENTRY_OPR_ID,\n\tCOB_PMSD_TS,\n\tCOB_OBJECT_CMT_ID,\n\tCOB_REA_FOR_LOS_ID,\n\tCOB_RECOVERY_IND,\n\tCOB_TYPE_OF_LOSS,\n\tCOB_UPDATE_OPR_ID,\n\tCOB_UPD_TS,\n\tCOB_POLICE_IVS_CD,\n\tCOB_RSP_PARTY_ID,\n\tCOB_LIA_TYPE_CD,\n\tCOB_LIABILITY_IND,\n\tCOB_INJURY_IND,\n\tCOB_LOSS_PLACE_ID,\n\tCOB_NOTICE_WCH_IND,\n\tCOB_ADJUSTED_IND,\n\tCOB_ADJUSTED_DT,\n\tCOB_BLOOD_TEST_TM,\n\tCOB_BLOOD_TEST_DT,\n\tCOB_ALCOHOL_PCT,\n\tCOB_ALCOHOL_IFL_CD,\n\tCOB_ALCOHOL_TM,\n\tCOB_BLOOD_TEST_IND,\n\tCOB_ALCOHOL_IND,\n\tCOB_CESSION_NBR,\n\tCOB_RIN_IND,\n\tCOB_SUIT_IND,\n\tCOB_OTHER_COV_IND,\n\tCOB_LEG_COUNSEL_CD,\n\tCOB_SPORT_CD,\n\tCOB_REPORT_NBR,\n\tCOB_ISU_OWN_IND,\n\tCOB_ISU_TNT_IND,\n\tCOB_ISU_OTH_IND,\n\tCOB_PREMISE_DES,\n\tCOB_ISU_MUF_IND,\n\tCOB_ISU_VEN_IND,\n\tCOB_PRD_DES_ID,\n\tCOB_LIA_DES_ID,\n\tCOB_OFFER_AMT,\n\tCOB_OFFER_DT,\n\tCOB_OBJECT_STATUS,\n\tCOB_ON_PMS_IND,\n\tCOB_UNIT_TYPE_IND,\n\tCOB_UNIT_DES_ID,\n\tCOB_COV_UNIT_NBR,\n\tCOB_ALD_IND,\n\tCOB_COV_BLD_NBR,\n\tCOB_TOTAL_LOSS_IND,\n\tCOB_AT_FAULT_CD,\n\tCOB_TTY_UNT_NBR,\n\tCOB_UNIT_TYPE_CD,\n\tCOB_SPP_USE_CD,\n\tCOB_SAR_ID,\n\tCOB_INS_LINE,\n\tCOB_LOC_UNIT_NUM,\n\tCOB_RISK_UNIT_GRP,\n\tCOB_RSK_UNT_GR_SEQ,\n\tCOB_RISK_UNIT,\n\tCOB_RISK_TYPE_IND,\n\tCOB_CLASS_CODE,\n\tCOB_SUB_LOC_NUM,\n\tCOB_SEQ_RISK_UNIT,\n\tCOB_SR_SEQ,\n\tCOB_CLIENT_ID,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\tcob_coverage_form,\n\tcob_coverage_type,\n\tcob_risk_type,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_CLAIM_OBJECT_STAGE1\n),\nARCH_CLAIM_OBJECT_STAGE AS (\n\tINSERT INTO ARCH_CLAIM_OBJECT_STAGE\n\t(claim_object_id, cob_claim_nbr, cob_object_type_cd, cob_object_seq_nbr, cob_demand_amt, cob_bills_des_id, cob_client_seq_nbr, cob_cmt_dsc_id, cob_create_ts, cob_dcs_bse_doc_cd, cob_dsc_rea_cd, cob_entry_opr_id, cob_pmsd_ts, cob_object_cmt_id, cob_rea_for_los_id, cob_recovery_ind, cob_type_of_loss, cob_update_opr_id, cob_upd_ts, cob_police_ivs_cd, cob_rsp_party_id, cob_lia_type_cd, cob_liability_ind, cob_injury_ind, cob_loss_place_id, cob_notice_wch_ind, cob_adjusted_ind, cob_adjusted_dt, cob_blood_test_tm, cob_blood_test_dt, cob_alcohol_pct, cob_alcohol_ifl_cd, cob_alcohol_tm, cob_blood_test_ind, cob_alcohol_ind, cob_cession_nbr, cob_rin_ind, cob_suit_ind, cob_other_cov_ind, cob_leg_counsel_cd, cob_sport_cd, cob_report_nbr, cob_isu_own_ind, cob_isu_tnt_ind, cob_isu_oth_ind, cob_premise_des, cob_isu_muf_ind, cob_isu_ven_ind, cob_prd_des_id, cob_lia_des_id, cob_offer_amt, cob_offer_dt, cob_object_status, cob_on_pms_ind, cob_unit_type_ind, cob_unit_des_id, cob_cov_unit_nbr, cob_ald_ind, cob_cov_bld_nbr, cob_total_loss_ind, cob_at_fault_cd, cob_tty_unt_nbr, cob_unit_type_cd, cob_spp_use_cd, cob_sar_id, cob_ins_line, cob_loc_unit_num, cob_risk_unit_grp, cob_rsk_unt_gr_seq, cob_risk_unit, cob_risk_type_ind, cob_class_code, cob_sub_loc_num, cob_seq_risk_unit, cob_sr_seq, cob_client_id, extract_date, as_of_date, record_count, source_system_id, audit_id, cob_coverage_form, cob_coverage_type, cob_risk_type)\n\tSELECT \n\tCLAIM_OBJECT_ID AS CLAIM_OBJECT_ID, \n\tCOB_CLAIM_NBR AS COB_CLAIM_NBR, \n\tCOB_OBJECT_TYPE_CD AS COB_OBJECT_TYPE_CD, \n\tCOB_OBJECT_SEQ_NBR AS COB_OBJECT_SEQ_NBR, \n\tCOB_DEMAND_AMT AS COB_DEMAND_AMT, \n\tCOB_BILLS_DES_ID AS COB_BILLS_DES_ID, \n\tCOB_CLIENT_SEQ_NBR AS COB_CLIENT_SEQ_NBR, \n\tCOB_CMT_DSC_ID AS COB_CMT_DSC_ID, \n\tCOB_CREATE_TS AS COB_CREATE_TS, \n\tCOB_DCS_BSE_DOC_CD AS COB_DCS_BSE_DOC_CD, \n\tCOB_DSC_REA_CD AS COB_DSC_REA_CD, \n\tCOB_ENTRY_OPR_ID AS COB_ENTRY_OPR_ID, \n\tCOB_PMSD_TS AS COB_PMSD_TS, \n\tCOB_OBJECT_CMT_ID AS COB_OBJECT_CMT_ID, \n\tCOB_REA_FOR_LOS_ID AS COB_REA_FOR_LOS_ID, \n\tCOB_RECOVERY_IND AS COB_RECOVERY_IND, \n\tCOB_TYPE_OF_LOSS AS COB_TYPE_OF_LOSS, \n\tCOB_UPDATE_OPR_ID AS COB_UPDATE_OPR_ID, \n\tCOB_UPD_TS AS COB_UPD_TS, \n\tCOB_POLICE_IVS_CD AS COB_POLICE_IVS_CD, \n\tCOB_RSP_PARTY_ID AS COB_RSP_PARTY_ID, \n\tCOB_LIA_TYPE_CD AS COB_LIA_TYPE_CD, \n\tCOB_LIABILITY_IND AS COB_LIABILITY_IND, \n\tCOB_INJURY_IND AS COB_INJURY_IND, \n\tCOB_LOSS_PLACE_ID AS COB_LOSS_PLACE_ID, \n\tCOB_NOTICE_WCH_IND AS COB_NOTICE_WCH_IND, \n\tCOB_ADJUSTED_IND AS COB_ADJUSTED_IND, \n\tCOB_ADJUSTED_DT AS COB_ADJUSTED_DT, \n\tCOB_BLOOD_TEST_TM AS COB_BLOOD_TEST_TM, \n\tCOB_BLOOD_TEST_DT AS COB_BLOOD_TEST_DT, \n\tCOB_ALCOHOL_PCT AS COB_ALCOHOL_PCT, \n\tCOB_ALCOHOL_IFL_CD AS COB_ALCOHOL_IFL_CD, \n\tCOB_ALCOHOL_TM AS COB_ALCOHOL_TM, \n\tCOB_BLOOD_TEST_IND AS COB_BLOOD_TEST_IND, \n\tCOB_ALCOHOL_IND AS COB_ALCOHOL_IND, \n\tCOB_CESSION_NBR AS COB_CESSION_NBR, \n\tCOB_RIN_IND AS COB_RIN_IND, \n\tCOB_SUIT_IND AS COB_SUIT_IND, \n\tCOB_OTHER_COV_IND AS COB_OTHER_COV_IND, \n\tCOB_LEG_COUNSEL_CD AS COB_LEG_COUNSEL_CD, \n\tCOB_SPORT_CD AS COB_SPORT_CD, \n\tCOB_REPORT_NBR AS COB_REPORT_NBR, \n\tCOB_ISU_OWN_IND AS COB_ISU_OWN_IND, \n\tCOB_ISU_TNT_IND AS COB_ISU_TNT_IND, \n\tCOB_ISU_OTH_IND AS COB_ISU_OTH_IND, \n\tCOB_PREMISE_DES AS COB_PREMISE_DES, \n\tCOB_ISU_MUF_IND AS COB_ISU_MUF_IND, \n\tCOB_ISU_VEN_IND AS COB_ISU_VEN_IND, \n\tCOB_PRD_DES_ID AS COB_PRD_DES_ID, \n\tCOB_LIA_DES_ID AS COB_LIA_DES_ID, \n\tCOB_OFFER_AMT AS COB_OFFER_AMT, \n\tCOB_OFFER_DT AS COB_OFFER_DT, \n\tCOB_OBJECT_STATUS AS COB_OBJECT_STATUS, \n\tCOB_ON_PMS_IND AS COB_ON_PMS_IND, \n\tCOB_UNIT_TYPE_IND AS COB_UNIT_TYPE_IND, \n\tCOB_UNIT_DES_ID AS COB_UNIT_DES_ID, \n\tCOB_COV_UNIT_NBR AS COB_COV_UNIT_NBR, \n\tCOB_ALD_IND AS COB_ALD_IND, \n\tCOB_COV_BLD_NBR AS COB_COV_BLD_NBR, \n\tCOB_TOTAL_LOSS_IND AS COB_TOTAL_LOSS_IND, \n\tCOB_AT_FAULT_CD AS COB_AT_FAULT_CD, \n\tCOB_TTY_UNT_NBR AS COB_TTY_UNT_NBR, \n\tCOB_UNIT_TYPE_CD AS COB_UNIT_TYPE_CD, \n\tCOB_SPP_USE_CD AS COB_SPP_USE_CD, \n\tCOB_SAR_ID AS COB_SAR_ID, \n\tCOB_INS_LINE AS COB_INS_LINE, \n\tCOB_LOC_UNIT_NUM AS COB_LOC_UNIT_NUM, \n\tCOB_RISK_UNIT_GRP AS COB_RISK_UNIT_GRP, \n\tCOB_RSK_UNT_GR_SEQ AS COB_RSK_UNT_GR_SEQ, \n\tCOB_RISK_UNIT AS COB_RISK_UNIT, \n\tCOB_RISK_TYPE_IND AS COB_RISK_TYPE_IND, \n\tCOB_CLASS_CODE AS COB_CLASS_CODE, \n\tCOB_SUB_LOC_NUM AS COB_SUB_LOC_NUM, \n\tCOB_SEQ_RISK_UNIT AS COB_SEQ_RISK_UNIT, \n\tCOB_SR_SEQ AS COB_SR_SEQ, \n\tCOB_CLIENT_ID AS COB_CLIENT_ID, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID, \n\tCOB_COVERAGE_FORM, \n\tCOB_COVERAGE_TYPE, \n\tCOB_RISK_TYPE\n\tFROM EXP_CLAIM_OBJECT_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsStaging/"
        },
        "annotations": []
    }
}