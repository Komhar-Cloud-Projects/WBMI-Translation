{
    "name": "m_POL_DM_LOAD_PremiumMasterDim",
    "properties": {
        "activities": [
            {
                "name": "m_POL_DM_LOAD_PremiumMasterDim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PremiumMasterCalculation AS (\n\tSELECT DISTINCT \r\n\t        LTRIM(RTRIM(A.PremiumMasterPolicyExpirationYear)) AS PremiumMasterPolicyExpirationYear,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterPolicyTerm)) AS PremiumMasterPolicyTerm,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterBureauPolicyType)) AS PremiumMasterBureauPolicyType,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterAuditCode)) AS PremiumMasterAuditCode,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterTypeBureauCode)) AS PremiumMasterTypeBureauCode,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterBureauStatisticalLine)) AS PremiumMasterBureauStatisticalLine,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterProductLine)) AS PremiumMasterProductLine,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterClassCode)) AS PremiumMasterClassCode,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterSubLine)) AS PremiumMasterSubLine,  \r\n\t        A.PremiumMasterStatisticalCode1 AS PremiumMasterStatisticalCode1,  \r\n\t        A.PremiumMasterStatisticalCode2 AS PremiumMasterStatisticalCode2,  \r\n\t        A.PremiumMasterStatisticalCode3 AS PremiumMasterStatisticalCode3,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterRateModifier)) AS PremiumMasterRateModifier,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterRateDeparture)) AS PremiumMasterRateDeparture,  \r\n\t        A.PremiumMasterBureauInceptionDate AS PremiumMasterBureauInceptionDate,\r\n\t        LTRIM(RTRIM(A.PremiumMasterCountersignAgencyType)) AS PremiumMasterCountersignAgencyType,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterCountersignAgencyCode)) AS PremiumMasterCountersignAgencyCode,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterCountersignAgencyState)) AS PremiumMasterCountersignAgencyState,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterCountersignAgencyRate)) AS PremiumMasterCountersignAgencyRate,  \r\n\t        LTRIM(RTRIM(A.PremiumMasterRenewalIndicator)) AS PremiumMasterRenewalIndicator\r\n\tFROM @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumMasterCalculation A\r\n\tWHERE \r\n\tA.CreatedDate > '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_Source AS (\n\tSELECT\n\tPremiumMasterPolicyExpirationYear,\n\tPremiumMasterPolicyTerm,\n\tPremiumMasterBureauPolicyType,\n\tPremiumMasterAuditCode,\n\tPremiumMasterTypeBureauCode,\n\tPremiumMasterBureauStatisticalLine,\n\tPremiumMasterProductLine,\n\tPremiumMasterClassCode,\n\tPremiumMasterSubLine,\n\tPremiumMasterStatisticalCode1,\n\tPremiumMasterStatisticalCode2,\n\tPremiumMasterStatisticalCode3,\n\tPremiumMasterRateModifier,\n\tPremiumMasterRateDeparture,\n\tPremiumMasterBureauInceptionDate,\n\t-- *INF*: TO_CHAR(PremiumMasterBureauInceptionDate,'YYYY')\n\tTO_CHAR(PremiumMasterBureauInceptionDate, 'YYYY') AS PremiumMasterBureauInceptionDate_out,\n\tPremiumMasterCountersignAgencyType,\n\tPremiumMasterCountersignAgencyCode,\n\tPremiumMasterCountersignAgencyState,\n\tPremiumMasterCountersignAgencyRate,\n\tPremiumMasterRenewalIndicator\n\tFROM SQ_PremiumMasterCalculation\n),\nmplt_PremiumMasterDimID AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_Source AS (\n\t\tSELECT\n\t\tPremiumMasterPolicyExpirationYear,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterPolicyExpirationYear),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterPolicyExpirationYear),'N/A',\r\n\t\t-- LENGTH(PremiumMasterPolicyExpirationYear)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterPolicyExpirationYear)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterPolicyExpirationYear IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterPolicyExpirationYear), 'N/A',\n\t\tLENGTH(PremiumMasterPolicyExpirationYear) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterPolicyExpirationYear))) AS v_PremiumMasterPolicyExpirationYear,\n\t\tv_PremiumMasterPolicyExpirationYear AS PremiumMasterPolicyExpirationYear_out,\n\t\tPremiumMasterPolicyTerm,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterPolicyTerm),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterPolicyTerm),'N/A',\r\n\t\t-- LENGTH(PremiumMasterPolicyTerm)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterPolicyTerm)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterPolicyTerm IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterPolicyTerm), 'N/A',\n\t\tLENGTH(PremiumMasterPolicyTerm) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterPolicyTerm))) AS v_PremiumMasterPolicyTerm,\n\t\tv_PremiumMasterPolicyTerm AS PremiumMasterPolicyTerm_out,\n\t\tPremiumMasterBureauPolicyType,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterBureauPolicyType),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterBureauPolicyType),'N/A',\r\n\t\t-- LENGTH(PremiumMasterBureauPolicyType)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterBureauPolicyType)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterBureauPolicyType IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterBureauPolicyType), 'N/A',\n\t\tLENGTH(PremiumMasterBureauPolicyType) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterBureauPolicyType))) AS v_PremiumMasterBureauPolicyType,\n\t\tv_PremiumMasterBureauPolicyType AS PremiumMasterBureauPolicyType_out,\n\t\tPremiumMasterAuditCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterAuditCode),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterAuditCode),'N/A',\r\n\t\t-- LENGTH(PremiumMasterAuditCode)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterAuditCode)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterAuditCode IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterAuditCode), 'N/A',\n\t\tLENGTH(PremiumMasterAuditCode) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterAuditCode))) AS v_PremiumMasterAuditCode,\n\t\tv_PremiumMasterAuditCode AS PremiumMasterAuditCode_out,\n\t\tPremiumMasterTypeBureauCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterTypeBureauCode),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterTypeBureauCode),'N/A',\r\n\t\t-- LENGTH(PremiumMasterTypeBureauCode)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterTypeBureauCode)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterTypeBureauCode IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterTypeBureauCode), 'N/A',\n\t\tLENGTH(PremiumMasterTypeBureauCode) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterTypeBureauCode))) AS v_PremiumMasterTypeBureauCode,\n\t\tv_PremiumMasterTypeBureauCode AS PremiumMasterTypeBureauCode_out,\n\t\tPremiumMasterBureauStatisticalLine,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterBureauStatisticalLine),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterBureauStatisticalLine),'N/A',\r\n\t\t-- LENGTH(PremiumMasterBureauStatisticalLine)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterBureauStatisticalLine)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterBureauStatisticalLine IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterBureauStatisticalLine), 'N/A',\n\t\tLENGTH(PremiumMasterBureauStatisticalLine) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterBureauStatisticalLine))) AS v_PremiumMasterBureauStatisticalLine,\n\t\tv_PremiumMasterBureauStatisticalLine AS PremiumMasterBureauStatisticalLine_out,\n\t\tPremiumMasterProductLine,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterProductLine),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterProductLine),'N/A',\r\n\t\t-- LENGTH(PremiumMasterProductLine)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterProductLine)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterProductLine IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterProductLine), 'N/A',\n\t\tLENGTH(PremiumMasterProductLine) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterProductLine))) AS v_PremiumMasterProductLine,\n\t\tv_PremiumMasterProductLine AS PremiumMasterProductLine_out,\n\t\tPremiumMasterClassCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterClassCode),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterClassCode),'N/A',\r\n\t\t-- LENGTH(PremiumMasterClassCode)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterClassCode)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterClassCode IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterClassCode), 'N/A',\n\t\tLENGTH(PremiumMasterClassCode) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterClassCode))) AS v_PremiumMasterClassCode,\n\t\tv_PremiumMasterClassCode AS PremiumMasterClassCode_out,\n\t\tPremiumMasterExposure,\n\t\tPremiumMasterSubLine,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterSubLine),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterSubLine),'N/A',\r\n\t\t-- LENGTH(PremiumMasterSubLine)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterSubLine)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterSubLine IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterSubLine), 'N/A',\n\t\tLENGTH(PremiumMasterSubLine) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterSubLine))) AS v_PremiumMasterSubLine,\n\t\tv_PremiumMasterSubLine AS PremiumMasterSubLine_out,\n\t\tPremiumMasterStatisticalCode1,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterStatisticalCode1),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterStatisticalCode1),'N/A',\r\n\t\t-- LENGTH(PremiumMasterStatisticalCode1)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterStatisticalCode1)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterStatisticalCode1 IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterStatisticalCode1), 'N/A',\n\t\tLENGTH(PremiumMasterStatisticalCode1) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterStatisticalCode1))) AS v_PremiumMasterStatisticalCode1,\n\t\t-- *INF*: IIF(ISNULL(PremiumMasterStatisticalCode1) OR IS_SPACES(PremiumMasterStatisticalCode1) OR LENGTH(PremiumMasterStatisticalCode1)=0,'N/A',\r\n\t\t-- PremiumMasterStatisticalCode1)\n\t\tIFF(PremiumMasterStatisticalCode1 IS NULL OR IS_SPACES(PremiumMasterStatisticalCode1) OR LENGTH(PremiumMasterStatisticalCode1) = 0, 'N/A', PremiumMasterStatisticalCode1) AS PremiumMasterStatisticalCode1_out,\n\t\tPremiumMasterStatisticalCode2,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterStatisticalCode2),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterStatisticalCode2),'N/A',\r\n\t\t-- LENGTH(PremiumMasterStatisticalCode2)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterStatisticalCode2)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterStatisticalCode2 IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterStatisticalCode2), 'N/A',\n\t\tLENGTH(PremiumMasterStatisticalCode2) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterStatisticalCode2))) AS v_PremiumMasterStatisticalCode2,\n\t\t-- *INF*: IIF(ISNULL(PremiumMasterStatisticalCode2) OR IS_SPACES(PremiumMasterStatisticalCode2) OR LENGTH(PremiumMasterStatisticalCode2)=0,'N/A',\r\n\t\t-- PremiumMasterStatisticalCode2)\n\t\tIFF(PremiumMasterStatisticalCode2 IS NULL OR IS_SPACES(PremiumMasterStatisticalCode2) OR LENGTH(PremiumMasterStatisticalCode2) = 0, 'N/A', PremiumMasterStatisticalCode2) AS PremiumMasterStatisticalCode2_out,\n\t\tPremiumMasterStatisticalCode3,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterStatisticalCode3),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterStatisticalCode3),'N/A',\r\n\t\t-- LENGTH(PremiumMasterStatisticalCode3)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterStatisticalCode3)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterStatisticalCode3 IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterStatisticalCode3), 'N/A',\n\t\tLENGTH(PremiumMasterStatisticalCode3) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterStatisticalCode3))) AS v_PremiumMasterStatisticalCode3,\n\t\t-- *INF*: IIF(ISNULL(PremiumMasterStatisticalCode3) OR IS_SPACES(PremiumMasterStatisticalCode3) OR LENGTH(PremiumMasterStatisticalCode3)=0,'N/A',\r\n\t\t-- PremiumMasterStatisticalCode3)\n\t\tIFF(PremiumMasterStatisticalCode3 IS NULL OR IS_SPACES(PremiumMasterStatisticalCode3) OR LENGTH(PremiumMasterStatisticalCode3) = 0, 'N/A', PremiumMasterStatisticalCode3) AS PremiumMasterStatisticalCode3_out,\n\t\tPremiumMasterRateModifier,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterRateModifier),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterRateModifier),'N/A',\r\n\t\t-- LENGTH(PremiumMasterRateModifier)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterRateModifier)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterRateModifier IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterRateModifier), 'N/A',\n\t\tLENGTH(PremiumMasterRateModifier) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterRateModifier))) AS v_PremiumMasterRateModifier,\n\t\tv_PremiumMasterRateModifier AS PremiumMasterRateModifier_out,\n\t\tPremiumMasterRateDeparture,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterRateDeparture),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterRateDeparture),'N/A',\r\n\t\t-- LENGTH(PremiumMasterRateDeparture)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterRateDeparture)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterRateDeparture IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterRateDeparture), 'N/A',\n\t\tLENGTH(PremiumMasterRateDeparture) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterRateDeparture))) AS v_PremiumMasterRateDeparture,\n\t\tv_PremiumMasterRateDeparture AS PremiumMasterRateDeparture_out,\n\t\tPremiumMasterBureauInceptionDate,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterBureauInceptionDate),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterBureauInceptionDate),'N/A',\r\n\t\t-- LENGTH(PremiumMasterBureauInceptionDate)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterBureauInceptionDate)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterBureauInceptionDate IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterBureauInceptionDate), 'N/A',\n\t\tLENGTH(PremiumMasterBureauInceptionDate) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterBureauInceptionDate))) AS v_PremiumMasterBureauInceptionDate,\n\t\tv_PremiumMasterBureauInceptionDate AS PremiumMasterBureauInceptionDate_out,\n\t\tPremiumMasterCountersignAgencyType,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterCountersignAgencyType),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterCountersignAgencyType),'N/A',\r\n\t\t-- LENGTH(PremiumMasterCountersignAgencyType)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterCountersignAgencyType)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterCountersignAgencyType IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterCountersignAgencyType), 'N/A',\n\t\tLENGTH(PremiumMasterCountersignAgencyType) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterCountersignAgencyType))) AS v_PremiumMasterCountersignAgencyType,\n\t\tv_PremiumMasterCountersignAgencyType AS PremiumMasterCountersignAgencyType_out,\n\t\tPremiumMasterCountersignAgencyCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterCountersignAgencyCode),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterCountersignAgencyCode),'N/A',\r\n\t\t-- LENGTH(PremiumMasterCountersignAgencyCode)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterCountersignAgencyCode)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterCountersignAgencyCode IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterCountersignAgencyCode), 'N/A',\n\t\tLENGTH(PremiumMasterCountersignAgencyCode) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterCountersignAgencyCode))) AS v_PremiumMasterCountersignAgencyCode,\n\t\tv_PremiumMasterCountersignAgencyCode AS PremiumMasterCountersignAgencyCode_out,\n\t\tPremiumMasterCountersignAgencyState,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterCountersignAgencyState),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterCountersignAgencyState),'N/A',\r\n\t\t-- LENGTH(PremiumMasterCountersignAgencyState)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterCountersignAgencyState)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterCountersignAgencyState IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterCountersignAgencyState), 'N/A',\n\t\tLENGTH(PremiumMasterCountersignAgencyState) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterCountersignAgencyState))) AS v_PremiumMasterCountersignAgencyState,\n\t\tv_PremiumMasterCountersignAgencyState AS PremiumMasterCountersignAgencyState_out,\n\t\tPremiumMasterCountersignAgencyRate,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterCountersignAgencyRate),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterCountersignAgencyRate),'N/A',\r\n\t\t-- LENGTH(PremiumMasterCountersignAgencyRate)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterCountersignAgencyRate)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterCountersignAgencyRate IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterCountersignAgencyRate), 'N/A',\n\t\tLENGTH(PremiumMasterCountersignAgencyRate) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterCountersignAgencyRate))) AS v_PremiumMasterCountersignAgencyRate,\n\t\tv_PremiumMasterCountersignAgencyRate AS PremiumMasterCountersignAgencyRate_out,\n\t\tPremiumMasterRenewalIndicator,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- ISNULL(PremiumMasterRenewalIndicator),'N/A',\r\n\t\t-- IS_SPACES(PremiumMasterRenewalIndicator),'N/A',\r\n\t\t-- LENGTH(PremiumMasterRenewalIndicator)=0,'N/A',\r\n\t\t-- LTRIM(RTRIM(PremiumMasterRenewalIndicator)))\n\t\tDECODE(TRUE,\n\t\tPremiumMasterRenewalIndicator IS NULL, 'N/A',\n\t\tIS_SPACES(PremiumMasterRenewalIndicator), 'N/A',\n\t\tLENGTH(PremiumMasterRenewalIndicator) = 0, 'N/A',\n\t\tLTRIM(RTRIM(PremiumMasterRenewalIndicator))) AS v_PremiumMasterRenewalIndicator,\n\t\tv_PremiumMasterRenewalIndicator AS PremiumMasterRenewalIndicator_out,\n\t\t-- *INF*: MD5(\r\n\t\t-- TO_CHAR(v_PremiumMasterPolicyExpirationYear)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterPolicyTerm)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterBureauPolicyType)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterAuditCode)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterTypeBureauCode)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterBureauStatisticalLine)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterProductLine)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterClassCode)  ||  \r\n\t\t-- ----TO_CHAR(PremiumMasterExposure)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterSubLine)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterStatisticalCode1)  ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterStatisticalCode2) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterStatisticalCode3) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterRateModifier) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterRateDeparture) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterBureauInceptionDate) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterCountersignAgencyType) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterCountersignAgencyCode) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterCountersignAgencyState) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterCountersignAgencyRate) ||  \r\n\t\t-- TO_CHAR(v_PremiumMasterRenewalIndicator) \r\n\t\t-- \r\n\t\t-- )\n\t\tMD5(TO_CHAR(v_PremiumMasterPolicyExpirationYear) || TO_CHAR(v_PremiumMasterPolicyTerm) || TO_CHAR(v_PremiumMasterBureauPolicyType) || TO_CHAR(v_PremiumMasterAuditCode) || TO_CHAR(v_PremiumMasterTypeBureauCode) || TO_CHAR(v_PremiumMasterBureauStatisticalLine) || TO_CHAR(v_PremiumMasterProductLine) || TO_CHAR(v_PremiumMasterClassCode) || TO_CHAR(v_PremiumMasterSubLine) || TO_CHAR(v_PremiumMasterStatisticalCode1) || TO_CHAR(v_PremiumMasterStatisticalCode2) || TO_CHAR(v_PremiumMasterStatisticalCode3) || TO_CHAR(v_PremiumMasterRateModifier) || TO_CHAR(v_PremiumMasterRateDeparture) || TO_CHAR(v_PremiumMasterBureauInceptionDate) || TO_CHAR(v_PremiumMasterCountersignAgencyType) || TO_CHAR(v_PremiumMasterCountersignAgencyCode) || TO_CHAR(v_PremiumMasterCountersignAgencyState) || TO_CHAR(v_PremiumMasterCountersignAgencyRate) || TO_CHAR(v_PremiumMasterRenewalIndicator)) AS v_PremiumMasterDimHashkey,\n\t\tv_PremiumMasterDimHashkey AS PremiumMasterDimHashkey_out\n\t\tFROM INPUT\n\t),\n\tLKP_PremiumMasterDim AS (\n\t\tSELECT\n\t\tPremiumMasterDimID,\n\t\tPremiumMasterClassCode_IN,\n\t\tPremiumMasterDimHashkey,\n\t\tPremiumMasterClassCode\n\t\tFROM (\n\t\t\tSELECT A.PremiumMasterDimID as PremiumMasterDimID, \r\n\t\t\tA.PremiumMasterDimHashkey as PremiumMasterDimHashkey,\r\n\t\t\tA.PremiumMasterClassCode as PremiumMasterClassCode  \r\n\t\t\tFROM\r\n\t\t\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PremiumMasterDim A\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PremiumMasterDimHashkey,PremiumMasterClassCode ORDER BY PremiumMasterDimID DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_PremiumMasterDim.PremiumMasterDimID, \n\t\tEXP_Source.PremiumMasterDimHashkey_out AS PremiumMasterDimHashkey, \n\t\tEXP_Source.PremiumMasterPolicyExpirationYear_out AS PremiumMasterPolicyExpirationYear, \n\t\tEXP_Source.PremiumMasterPolicyTerm_out AS PremiumMasterPolicyTerm, \n\t\tEXP_Source.PremiumMasterBureauPolicyType_out AS PremiumMasterBureauPolicyType, \n\t\tEXP_Source.PremiumMasterAuditCode_out AS PremiumMasterAuditCode, \n\t\tEXP_Source.PremiumMasterTypeBureauCode_out AS PremiumMasterTypeBureauCode, \n\t\tEXP_Source.PremiumMasterBureauStatisticalLine_out AS PremiumMasterBureauStatisticalLine, \n\t\tEXP_Source.PremiumMasterProductLine_out AS PremiumMasterProductLine, \n\t\tEXP_Source.PremiumMasterClassCode_out AS PremiumMasterClassCode, \n\t\tEXP_Source.PremiumMasterExposure, \n\t\tEXP_Source.PremiumMasterSubLine_out AS PremiumMasterSubLine, \n\t\tEXP_Source.PremiumMasterStatisticalCode1_out AS PremiumMasterStatisticalCode1, \n\t\tEXP_Source.PremiumMasterStatisticalCode2_out AS PremiumMasterStatisticalCode2, \n\t\tEXP_Source.PremiumMasterStatisticalCode3_out AS PremiumMasterStatisticalCode3, \n\t\tEXP_Source.PremiumMasterRateModifier_out AS PremiumMasterRateModifier, \n\t\tEXP_Source.PremiumMasterRateDeparture_out AS PremiumMasterRateDeparture, \n\t\tEXP_Source.PremiumMasterBureauInceptionDate_out AS PremiumMasterBureauInceptionDate, \n\t\tEXP_Source.PremiumMasterCountersignAgencyType_out AS PremiumMasterCountersignAgencyType, \n\t\tEXP_Source.PremiumMasterCountersignAgencyCode_out AS PremiumMasterCountersignAgencyCode, \n\t\tEXP_Source.PremiumMasterCountersignAgencyState_out AS PremiumMasterCountersignAgencyState, \n\t\tEXP_Source.PremiumMasterCountersignAgencyRate_out AS PremiumMasterCountersignAgencyRate, \n\t\tEXP_Source.PremiumMasterRenewalIndicator_out AS PremiumMasterRenewalIndicator\n\t\tFROM EXP_Source\n\t\tLEFT JOIN LKP_PremiumMasterDim\n\t\tON LKP_PremiumMasterDim.PremiumMasterDimHashkey = EXP_Source.PremiumMasterDimHashkey_out AND LKP_PremiumMasterDim.PremiumMasterClassCode = EXP_Source.PremiumMasterClassCode_out\n\t),\n),\nAGG_RemoveDuplicates AS (\n\tSELECT\n\tPremiumMasterDimID, \n\tPremiumMasterPolicyExpirationYear1 AS PremiumMasterPolicyExpirationYear, \n\tPremiumMasterPolicyTerm1 AS PremiumMasterPolicyTerm, \n\tPremiumMasterBureauPolicyType1 AS PremiumMasterBureauPolicyType, \n\tPremiumMasterAuditCode1 AS PremiumMasterAuditCode, \n\tPremiumMasterTypeBureauCode1 AS PremiumMasterTypeBureauCode, \n\tPremiumMasterBureauStatisticalLine1 AS PremiumMasterBureauStatisticalLine, \n\tPremiumMasterProductLine1 AS PremiumMasterProductLine, \n\tPremiumMasterClassCode1 AS PremiumMasterClassCode, \n\tPremiumMasterSubLine1 AS PremiumMasterSubLine, \n\tPremiumMasterStatisticalCode11 AS PremiumMasterStatisticalCode1, \n\tPremiumMasterStatisticalCode21 AS PremiumMasterStatisticalCode2, \n\tPremiumMasterStatisticalCode31 AS PremiumMasterStatisticalCode3, \n\tPremiumMasterRateModifier1 AS PremiumMasterRateModifier, \n\tPremiumMasterRateDeparture1 AS PremiumMasterRateDeparture, \n\tPremiumMasterBureauInceptionDate1 AS PremiumMasterBureauInceptionDate, \n\tPremiumMasterCountersignAgencyType1 AS PremiumMasterCountersignAgencyType, \n\tPremiumMasterCountersignAgencyCode1 AS PremiumMasterCountersignAgencyCode, \n\tPremiumMasterCountersignAgencyState1 AS PremiumMasterCountersignAgencyState, \n\tPremiumMasterCountersignAgencyRate1 AS PremiumMasterCountersignAgencyRate, \n\tPremiumMasterRenewalIndicator1 AS PremiumMasterRenewalIndicator, \n\tPremiumMasterDimHashkey\n\tFROM mplt_PremiumMasterDimID\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PremiumMasterDimHashkey ORDER BY NULL) = 1\n),\nEXP_Values AS (\n\tSELECT\n\tPremiumMasterDimID,\n\tPremiumMasterPolicyExpirationYear,\n\tPremiumMasterPolicyTerm,\n\tPremiumMasterBureauPolicyType,\n\tPremiumMasterAuditCode,\n\tPremiumMasterTypeBureauCode,\n\tPremiumMasterBureauStatisticalLine,\n\tPremiumMasterProductLine,\n\tPremiumMasterClassCode,\n\tPremiumMasterSubLine,\n\tPremiumMasterStatisticalCode1,\n\tPremiumMasterStatisticalCode2,\n\tPremiumMasterStatisticalCode3,\n\tPremiumMasterRateModifier,\n\tPremiumMasterRateDeparture,\n\tPremiumMasterBureauInceptionDate,\n\tPremiumMasterCountersignAgencyType,\n\tPremiumMasterCountersignAgencyCode,\n\tPremiumMasterCountersignAgencyState,\n\tPremiumMasterCountersignAgencyRate,\n\tPremiumMasterRenewalIndicator,\n\tPremiumMasterDimHashkey\n\tFROM AGG_RemoveDuplicates\n),\nRTR_Insert_Update AS (\n\tSELECT\n\tPremiumMasterDimID,\n\tPremiumMasterDimHashkey,\n\tPremiumMasterPolicyExpirationYear,\n\tPremiumMasterPolicyTerm,\n\tPremiumMasterBureauPolicyType,\n\tPremiumMasterAuditCode,\n\tPremiumMasterTypeBureauCode,\n\tPremiumMasterBureauStatisticalLine,\n\tPremiumMasterProductLine,\n\tPremiumMasterClassCode,\n\tPremiumMasterSubLine,\n\tPremiumMasterStatisticalCode1,\n\tPremiumMasterStatisticalCode2,\n\tPremiumMasterStatisticalCode3,\n\tPremiumMasterRateModifier,\n\tPremiumMasterRateDeparture,\n\tPremiumMasterBureauInceptionDate,\n\tPremiumMasterCountersignAgencyType,\n\tPremiumMasterCountersignAgencyCode,\n\tPremiumMasterCountersignAgencyState,\n\tPremiumMasterCountersignAgencyRate,\n\tPremiumMasterRenewalIndicator\n\tFROM EXP_Values\n),\nRTR_Insert_Update_INSERT AS (SELECT * FROM RTR_Insert_Update WHERE IIF(ISNULL(PremiumMasterDimID),TRUE,FALSE)),\nRTR_Insert_Update_UPDATE AS (SELECT * FROM RTR_Insert_Update WHERE IIF(NOT ISNULL(PremiumMasterDimID),TRUE,FALSE)),\nUPD_Update AS (\n\tSELECT\n\tPremiumMasterDimID, \n\tPremiumMasterDimHashkey, \n\tPremiumMasterPolicyExpirationYear, \n\tPremiumMasterPolicyTerm, \n\tPremiumMasterBureauPolicyType, \n\tPremiumMasterAuditCode, \n\tPremiumMasterTypeBureauCode, \n\tPremiumMasterBureauStatisticalLine, \n\tPremiumMasterProductLine, \n\tPremiumMasterClassCode, \n\tPremiumMasterSubLine, \n\tPremiumMasterStatisticalCode1, \n\tPremiumMasterStatisticalCode2, \n\tPremiumMasterStatisticalCode AS PremiumMasterStatisticalCode3, \n\tPremiumMasterRateModifier, \n\tPremiumMasterRateDeparture, \n\tPremiumMasterBureauInceptionDate, \n\tPremiumMasterCountersignAgencyType, \n\tPremiumMasterCountersignAgencyCode, \n\tPremiumMasterCountersignAgencyState, \n\tPremiumMasterCountersignAgencyRate, \n\tPremiumMasterRenewalIndicator\n\tFROM RTR_Insert_Update_UPDATE\n),\nPremiumMasterDim_Update AS (\n\tMERGE INTO PremiumMasterDim AS T\n\tUSING UPD_Update AS S\n\tON T.PremiumMasterDimID = S.PremiumMasterDimID\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.PremiumMasterDimHashkey = S.PremiumMasterDimHashkey, T.PremiumMasterPolicyExpirationYear = S.PremiumMasterPolicyExpirationYear, T.PremiumMasterPolicyTerm = S.PremiumMasterPolicyTerm, T.PremiumMasterBureauPolicyType = S.PremiumMasterBureauPolicyType, T.PremiumMasterAuditCode = S.PremiumMasterAuditCode, T.PremiumMasterTypeBureauCode = S.PremiumMasterTypeBureauCode, T.PremiumMasterBureauStatisticalLine = S.PremiumMasterBureauStatisticalLine, T.PremiumMasterProductLine = S.PremiumMasterProductLine, T.PremiumMasterClassCode = S.PremiumMasterClassCode, T.PremiumMasterSubLine = S.PremiumMasterSubLine, T.PremiumMasterStatisticalCode1 = S.PremiumMasterStatisticalCode1, T.PremiumMasterStatisticalCode2 = S.PremiumMasterStatisticalCode2, T.PremiumMasterStatisticalCode3 = S.PremiumMasterStatisticalCode3, T.PremiumMasterRateModifier = S.PremiumMasterRateModifier, T.PremiumMasterRateDeparture = S.PremiumMasterRateDeparture, T.PremiumMasterBureauInceptionDate = S.PremiumMasterBureauInceptionDate, T.PremiumMasterCountersignAgencyType = S.PremiumMasterCountersignAgencyType, T.PremiumMasterCountersignAgencyCode = S.PremiumMasterCountersignAgencyCode, T.PremiumMasterCountersignAgencyState = S.PremiumMasterCountersignAgencyState, T.PremiumMasterCountersignAgencyRate = S.PremiumMasterCountersignAgencyRate, T.PremiumMasterRenewalIndicator = S.PremiumMasterRenewalIndicator\n),\nEXP_Target AS (\n\tSELECT\n\t1 AS CurrentSnapshotFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS EffectiveDate,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS ExpirationDate,\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate,\n\tPremiumMasterDimHashkey,\n\tPremiumMasterPolicyExpirationYear,\n\tPremiumMasterPolicyTerm,\n\tPremiumMasterBureauPolicyType,\n\tPremiumMasterAuditCode,\n\tPremiumMasterTypeBureauCode,\n\tPremiumMasterBureauStatisticalLine,\n\tPremiumMasterProductLine,\n\tPremiumMasterClassCode,\n\tPremiumMasterSubLine,\n\tPremiumMasterStatisticalCode AS PremiumMasterStatisticalCode1,\n\tPremiumMasterStatisticalCode2,\n\tPremiumMasterStatisticalCode3,\n\tPremiumMasterRateModifier,\n\tPremiumMasterRateDeparture,\n\tPremiumMasterBureauInceptionDate,\n\tPremiumMasterCountersignAgencyType,\n\tPremiumMasterCountersignAgencyCode,\n\tPremiumMasterCountersignAgencyState,\n\tPremiumMasterCountersignAgencyRate,\n\tPremiumMasterRenewalIndicator\n\tFROM RTR_Insert_Update_INSERT\n),\nPremiumMasterDim_Insert AS (\n\tINSERT INTO PremiumMasterDim\n\t(CurrentSnapshotFlag, AuditID, EffectiveDate, ExpirationDate, CreatedDate, ModifiedDate, PremiumMasterDimHashkey, PremiumMasterPolicyExpirationYear, PremiumMasterPolicyTerm, PremiumMasterBureauPolicyType, PremiumMasterAuditCode, PremiumMasterTypeBureauCode, PremiumMasterBureauStatisticalLine, PremiumMasterProductLine, PremiumMasterClassCode, PremiumMasterSubLine, PremiumMasterStatisticalCode1, PremiumMasterStatisticalCode2, PremiumMasterStatisticalCode3, PremiumMasterRateModifier, PremiumMasterRateDeparture, PremiumMasterBureauInceptionDate, PremiumMasterCountersignAgencyType, PremiumMasterCountersignAgencyCode, PremiumMasterCountersignAgencyState, PremiumMasterCountersignAgencyRate, PremiumMasterRenewalIndicator)\n\tSELECT \n\tCURRENTSNAPSHOTFLAG, \n\tAUDITID, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tPREMIUMMASTERDIMHASHKEY, \n\tPREMIUMMASTERPOLICYEXPIRATIONYEAR, \n\tPREMIUMMASTERPOLICYTERM, \n\tPREMIUMMASTERBUREAUPOLICYTYPE, \n\tPREMIUMMASTERAUDITCODE, \n\tPREMIUMMASTERTYPEBUREAUCODE, \n\tPREMIUMMASTERBUREAUSTATISTICALLINE, \n\tPREMIUMMASTERPRODUCTLINE, \n\tPREMIUMMASTERCLASSCODE, \n\tPREMIUMMASTERSUBLINE, \n\tPREMIUMMASTERSTATISTICALCODE1, \n\tPREMIUMMASTERSTATISTICALCODE2, \n\tPREMIUMMASTERSTATISTICALCODE3, \n\tPREMIUMMASTERRATEMODIFIER, \n\tPREMIUMMASTERRATEDEPARTURE, \n\tPREMIUMMASTERBUREAUINCEPTIONDATE, \n\tPREMIUMMASTERCOUNTERSIGNAGENCYTYPE, \n\tPREMIUMMASTERCOUNTERSIGNAGENCYCODE, \n\tPREMIUMMASTERCOUNTERSIGNAGENCYSTATE, \n\tPREMIUMMASTERCOUNTERSIGNAGENCYRATE, \n\tPREMIUMMASTERRENEWALINDICATOR\n\tFROM EXP_Target\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Policy DataMart/"
        },
        "annotations": []
    }
}