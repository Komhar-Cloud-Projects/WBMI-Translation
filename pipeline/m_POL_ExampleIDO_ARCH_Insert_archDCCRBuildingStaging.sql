WITH
SQ_DCCRBuildingStaging AS (
	SELECT
		ExtractDate,
		SourceSystemId,
		LineId,
		CR_LocationId,
		CR_BuildingId,
		SessionId,
		Id,
		Deleted,
		AlarmCompanyHasKeys,
		AlarmType,
		BulletResistingEnclosure,
		BulletResistingEnclosureAndAlarm,
		BurglarAlarmSystem,
		CentralStation,
		CentralStationAtleastHourly,
		CertificateNumber,
		ConnectedWith,
		ConstructionCode,
		CoveredProperty,
		Description,
		DoorType,
		EffectiveDate,
		ExpirationDate,
		GradeExtentOfProtection,
		GuardsOnDuty,
		HoldupAlarm,
		Insured,
		LocalGong,
		LockedSafe,
		NameOfCompany,
		NumberOfGuards,
		NumberOfProtectiveDevices,
		NumberOfStories,
		NumberOfWatchpersons,
		OutsideCentralStation,
		OutsideGong,
		PoliceStation,
		PrivateWatchPerson,
		RegisterHourlyOnAClock,
		RoofCovering,
		RoofDeckAttachment,
		RoofGeometry,
		RoofWallConstruction,
		SignalACentralStation,
		Sprinkler,
		SquareFt,
		ULClassification,
		ULIProtectiveBag,
		UnexpiredCertificate,
		WindowProtection,
		WindstormLossMitigation,
		YearBuilt,
		CR_LocationXmlId
	FROM DCCRBuildingStaging
),
EXP_Metadata AS (
	SELECT
	ExtractDate,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,
	LineId,
	CR_LocationId,
	CR_BuildingId,
	SessionId,
	Id,
	Deleted,
	AlarmCompanyHasKeys,
	AlarmType,
	BulletResistingEnclosure,
	BulletResistingEnclosureAndAlarm,
	BurglarAlarmSystem,
	CentralStation,
	CentralStationAtleastHourly,
	CertificateNumber,
	ConnectedWith,
	ConstructionCode,
	CoveredProperty,
	Description,
	DoorType,
	EffectiveDate,
	ExpirationDate,
	GradeExtentOfProtection,
	GuardsOnDuty,
	HoldupAlarm,
	Insured,
	LocalGong,
	LockedSafe,
	NameOfCompany,
	NumberOfGuards,
	NumberOfProtectiveDevices,
	NumberOfStories,
	NumberOfWatchpersons,
	OutsideCentralStation,
	OutsideGong,
	PoliceStation,
	PrivateWatchPerson,
	RegisterHourlyOnAClock,
	RoofCovering,
	RoofDeckAttachment,
	RoofGeometry,
	RoofWallConstruction,
	SignalACentralStation,
	Sprinkler,
	SquareFt,
	ULClassification,
	ULIProtectiveBag,
	UnexpiredCertificate,
	WindowProtection,
	WindstormLossMitigation,
	YearBuilt,
	CR_LocationXmlId
	FROM SQ_DCCRBuildingStaging
),
archDCCRBuildingStaging AS (
	INSERT INTO archDCCRBuildingStaging
	(ExtractDate, SourceSystemId, AuditId, LineId, CR_LocationId, CR_BuildingId, SessionId, Id, Deleted, AlarmCompanyHasKeys, AlarmType, BulletResistingEnclosure, BulletResistingEnclosureAndAlarm, BurglarAlarmSystem, CentralStation, CentralStationAtleastHourly, CertificateNumber, ConnectedWith, ConstructionCode, CoveredProperty, Description, DoorType, EffectiveDate, ExpirationDate, GradeExtentOfProtection, GuardsOnDuty, HoldupAlarm, Insured, LocalGong, LockedSafe, NameOfCompany, NumberOfGuards, NumberOfProtectiveDevices, NumberOfStories, NumberOfWatchpersons, OutsideCentralStation, OutsideGong, PoliceStation, PrivateWatchPerson, RegisterHourlyOnAClock, RoofCovering, RoofDeckAttachment, RoofGeometry, RoofWallConstruction, SignalACentralStation, Sprinkler, SquareFt, ULClassification, ULIProtectiveBag, UnexpiredCertificate, WindowProtection, WindstormLossMitigation, YearBuilt, CR_LocationXmlId)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	AUDITID, 
	LINEID, 
	CR_LOCATIONID, 
	CR_BUILDINGID, 
	SESSIONID, 
	ID, 
	DELETED, 
	ALARMCOMPANYHASKEYS, 
	ALARMTYPE, 
	BULLETRESISTINGENCLOSURE, 
	BULLETRESISTINGENCLOSUREANDALARM, 
	BURGLARALARMSYSTEM, 
	CENTRALSTATION, 
	CENTRALSTATIONATLEASTHOURLY, 
	CERTIFICATENUMBER, 
	CONNECTEDWITH, 
	CONSTRUCTIONCODE, 
	COVEREDPROPERTY, 
	DESCRIPTION, 
	DOORTYPE, 
	EFFECTIVEDATE, 
	EXPIRATIONDATE, 
	GRADEEXTENTOFPROTECTION, 
	GUARDSONDUTY, 
	HOLDUPALARM, 
	INSURED, 
	LOCALGONG, 
	LOCKEDSAFE, 
	NAMEOFCOMPANY, 
	NUMBEROFGUARDS, 
	NUMBEROFPROTECTIVEDEVICES, 
	NUMBEROFSTORIES, 
	NUMBEROFWATCHPERSONS, 
	OUTSIDECENTRALSTATION, 
	OUTSIDEGONG, 
	POLICESTATION, 
	PRIVATEWATCHPERSON, 
	REGISTERHOURLYONACLOCK, 
	ROOFCOVERING, 
	ROOFDECKATTACHMENT, 
	ROOFGEOMETRY, 
	ROOFWALLCONSTRUCTION, 
	SIGNALACENTRALSTATION, 
	SPRINKLER, 
	SQUAREFT, 
	ULCLASSIFICATION, 
	ULIPROTECTIVEBAG, 
	UNEXPIREDCERTIFICATE, 
	WINDOWPROTECTION, 
	WINDSTORMLOSSMITIGATION, 
	YEARBUILT, 
	CR_LOCATIONXMLID
	FROM EXP_Metadata
),