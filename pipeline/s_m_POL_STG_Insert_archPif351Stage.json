{
    "name": "s_m_POL_STG_Insert_archPif351Stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_archPif351Stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif351Stage AS (\n\tSELECT\n\t\tPif351StageId,\n\t\tExtractDate,\n\t\tSourceSystemid,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifModule,\n\t\tVehicleCoverageSegmentId,\n\t\tUnitNum,\n\t\tVehicleCoverageSegmentNumber,\n\t\tAmendmentNumber,\n\t\tChangeEffectiveDateCentury,\n\t\tChangeEffectiveDateYear,\n\t\tChangeEffectiveDateMonth,\n\t\tChangeEffectiveDateDay,\n\t\tVehicleReasonAmendedCode,\n\t\tVehicleTotalPremium,\n\t\tVehicleOldPremium,\n\t\tVehicleCoverageCode1,\n\t\tVehicleCoverageCode2,\n\t\tVehicleCoverageCode3,\n\t\tVehicleCoverageCode4,\n\t\tVehicleCoverageCode5,\n\t\tVehicleCoverageCode6,\n\t\tVehicleCoverageCode7,\n\t\tVehicleCoverageCode8,\n\t\tVehicleCoverageCode9,\n\t\tVehicleCoverageCode10,\n\t\tVehicleCoverageCode11,\n\t\tVehicleCoverageCode12,\n\t\tVehicleCoverageCode13,\n\t\tVehicleCoverageCode14,\n\t\tVehicleCoverageLimit1,\n\t\tVehicleCoverageLimit2,\n\t\tVehicleCoverageLimit3,\n\t\tVehicleCoverageLimit4,\n\t\tVehicleCoverageLimit5,\n\t\tVehicleCoverageLimit6,\n\t\tVehicleCoverageLimit7,\n\t\tVehicleCoverageLimit8,\n\t\tVehicleCoverageLimit9,\n\t\tVehicleCoverageLimit10,\n\t\tVehicleCoverageLimit11,\n\t\tVehicleCoverageLimit12,\n\t\tVehicleCoverageLimit13,\n\t\tVehicleCoverageLimit14,\n\t\tVehicleCoveragePremium1,\n\t\tVehicleCoveragePremium2,\n\t\tVehicleCoveragePremium3,\n\t\tVehicleCoveragePremium4,\n\t\tVehicleCoveragePremium5,\n\t\tVehicleCoveragePremium6,\n\t\tVehicleCoveragePremium7,\n\t\tVehicleCoveragePremium8,\n\t\tVehicleCoveragePremium9,\n\t\tVehicleCoveragePremium10,\n\t\tVehicleCoveragePremium11,\n\t\tVehicleCoveragePremium12,\n\t\tVehicleCoveragePremium13,\n\t\tVehicleCoveragePremium14,\n\t\tVehicleCoverageRateBookId1,\n\t\tVehicleCoverageRateBookId2,\n\t\tVehicleCoverageRateBookId3,\n\t\tVehicleCoverageRateBookId4,\n\t\tVehicleCoverageRateBookId5,\n\t\tVehicleCoverageRateBookId6,\n\t\tVehicleCoverageRateBookId7,\n\t\tVehicleCoverageRateBookId8,\n\t\tVehicleCoverageRateBookId9,\n\t\tVehicleCoverageRateBookId10,\n\t\tVehicleCoverageRateBookId11,\n\t\tVehicleCoverageRateBookId12,\n\t\tVehicleCoverageRateBookId13,\n\t\tVehicleCoverageRateBookId14,\n\t\tHomeAndHighwayModIndicator,\n\t\tVehicleFactorHoldArea,\n\t\tVehicleUmsUmpSwitch,\n\t\tVehicleDeletedIndicator,\n\t\tNonSmokerDiscount,\n\t\tAccidentFreeDiscountPercent,\n\t\tSafeDriverDiscount,\n\t\tHiredNonownedMinimum,\n\t\tHiredNonownedFactor,\n\t\tInexperiencedOperatorSurcharge,\n\t\tPmsFutureUse,\n\t\tCustomerFutureUse,\n\t\tYr2000CustomerUse,\n\t\tDuplicateKeySequenceNumber\n\tFROM Pif351Stage\n),\nEXP_Pif351Stage AS (\n\tSELECT\n\tPif351StageId,\n\tExtractDate,\n\tSourceSystemid,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifModule,\n\tVehicleCoverageSegmentId,\n\tUnitNum,\n\tVehicleCoverageSegmentNumber,\n\tAmendmentNumber,\n\tChangeEffectiveDateCentury,\n\tChangeEffectiveDateYear,\n\tChangeEffectiveDateMonth,\n\tChangeEffectiveDateDay,\n\tVehicleReasonAmendedCode,\n\tVehicleTotalPremium,\n\tVehicleOldPremium,\n\tVehicleCoverageCode1,\n\tVehicleCoverageCode2,\n\tVehicleCoverageCode3,\n\tVehicleCoverageCode4,\n\tVehicleCoverageCode5,\n\tVehicleCoverageCode6,\n\tVehicleCoverageCode7,\n\tVehicleCoverageCode8,\n\tVehicleCoverageCode9,\n\tVehicleCoverageCode10,\n\tVehicleCoverageCode11,\n\tVehicleCoverageCode12,\n\tVehicleCoverageCode13,\n\tVehicleCoverageCode14,\n\tVehicleCoverageLimit1,\n\tVehicleCoverageLimit2,\n\tVehicleCoverageLimit3,\n\tVehicleCoverageLimit4,\n\tVehicleCoverageLimit5,\n\tVehicleCoverageLimit6,\n\tVehicleCoverageLimit7,\n\tVehicleCoverageLimit8,\n\tVehicleCoverageLimit9,\n\tVehicleCoverageLimit10,\n\tVehicleCoverageLimit11,\n\tVehicleCoverageLimit12,\n\tVehicleCoverageLimit13,\n\tVehicleCoverageLimit14,\n\tVehicleCoveragePremium1,\n\tVehicleCoveragePremium2,\n\tVehicleCoveragePremium3,\n\tVehicleCoveragePremium4,\n\tVehicleCoveragePremium5,\n\tVehicleCoveragePremium6,\n\tVehicleCoveragePremium7,\n\tVehicleCoveragePremium8,\n\tVehicleCoveragePremium9,\n\tVehicleCoveragePremium10,\n\tVehicleCoveragePremium11,\n\tVehicleCoveragePremium12,\n\tVehicleCoveragePremium13,\n\tVehicleCoveragePremium14,\n\tVehicleCoverageRateBookId1,\n\tVehicleCoverageRateBookId2,\n\tVehicleCoverageRateBookId3,\n\tVehicleCoverageRateBookId4,\n\tVehicleCoverageRateBookId5,\n\tVehicleCoverageRateBookId6,\n\tVehicleCoverageRateBookId7,\n\tVehicleCoverageRateBookId8,\n\tVehicleCoverageRateBookId9,\n\tVehicleCoverageRateBookId10,\n\tVehicleCoverageRateBookId11,\n\tVehicleCoverageRateBookId12,\n\tVehicleCoverageRateBookId13,\n\tVehicleCoverageRateBookId14,\n\tHomeAndHighwayModIndicator,\n\tVehicleFactorHoldArea,\n\tVehicleUmsUmpSwitch,\n\tVehicleDeletedIndicator,\n\tNonSmokerDiscount,\n\tAccidentFreeDiscountPercent,\n\tSafeDriverDiscount,\n\tHiredNonownedMinimum,\n\tHiredNonownedFactor,\n\tInexperiencedOperatorSurcharge,\n\tPmsFutureUse,\n\tCustomerFutureUse,\n\tYr2000CustomerUse,\n\tDuplicateKeySequenceNumber,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id\n\tFROM SQ_Pif351Stage\n),\narchPif351Stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archPif351Stage\n\t(ExtractDate, SourceSystemid, PifSymbol, PifPolicyNumber, PifModule, VehicleCoverageSegmentId, UnitNum, VehicleCoverageSegmentNumber, AmendmentNumber, ChangeEffectiveDateCentury, ChangeEffectiveDateYear, ChangeEffectiveDateMonth, ChangeEffectiveDateDay, VehicleReasonAmendedCode, VehicleTotalPremium, VehicleOldPremium, VehicleCoverageCode1, VehicleCoverageCode2, VehicleCoverageCode3, VehicleCoverageCode4, VehicleCoverageCode5, VehicleCoverageCode6, VehicleCoverageCode7, VehicleCoverageCode8, VehicleCoverageCode9, VehicleCoverageCode10, VehicleCoverageCode11, VehicleCoverageCode12, VehicleCoverageCode13, VehicleCoverageCode14, VehicleCoverageLimit1, VehicleCoverageLimit2, VehicleCoverageLimit3, VehicleCoverageLimit4, VehicleCoverageLimit5, VehicleCoverageLimit6, VehicleCoverageLimit7, VehicleCoverageLimit8, VehicleCoverageLimit9, VehicleCoverageLimit10, VehicleCoverageLimit11, VehicleCoverageLimit12, VehicleCoverageLimit13, VehicleCoverageLimit14, VehicleCoveragePremium1, VehicleCoveragePremium2, VehicleCoveragePremium3, VehicleCoveragePremium4, VehicleCoveragePremium5, VehicleCoveragePremium6, VehicleCoveragePremium7, VehicleCoveragePremium8, VehicleCoveragePremium9, VehicleCoveragePremium10, VehicleCoveragePremium11, VehicleCoveragePremium12, VehicleCoveragePremium13, VehicleCoveragePremium14, VehicleCoverageRateBookId1, VehicleCoverageRateBookId2, VehicleCoverageRateBookId3, VehicleCoverageRateBookId4, VehicleCoverageRateBookId5, VehicleCoverageRateBookId6, VehicleCoverageRateBookId7, VehicleCoverageRateBookId8, VehicleCoverageRateBookId9, VehicleCoverageRateBookId10, VehicleCoverageRateBookId11, VehicleCoverageRateBookId12, VehicleCoverageRateBookId13, VehicleCoverageRateBookId14, HomeAndHighwayModIndicator, VehicleFactorHoldArea, VehicleUmsUmpSwitch, VehicleDeletedIndicator, NonSmokerDiscount, AccidentFreeDiscountPercent, SafeDriverDiscount, HiredNonownedMinimum, HiredNonownedFactor, InexperiencedOperatorSurcharge, PmsFutureUse, CustomerFutureUse, Yr2000CustomerUse, DuplicateKeySequenceNumber, AuditId)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFMODULE, \n\tVEHICLECOVERAGESEGMENTID, \n\tUNITNUM, \n\tVEHICLECOVERAGESEGMENTNUMBER, \n\tAMENDMENTNUMBER, \n\tCHANGEEFFECTIVEDATECENTURY, \n\tCHANGEEFFECTIVEDATEYEAR, \n\tCHANGEEFFECTIVEDATEMONTH, \n\tCHANGEEFFECTIVEDATEDAY, \n\tVEHICLEREASONAMENDEDCODE, \n\tVEHICLETOTALPREMIUM, \n\tVEHICLEOLDPREMIUM, \n\tVEHICLECOVERAGECODE1, \n\tVEHICLECOVERAGECODE2, \n\tVEHICLECOVERAGECODE3, \n\tVEHICLECOVERAGECODE4, \n\tVEHICLECOVERAGECODE5, \n\tVEHICLECOVERAGECODE6, \n\tVEHICLECOVERAGECODE7, \n\tVEHICLECOVERAGECODE8, \n\tVEHICLECOVERAGECODE9, \n\tVEHICLECOVERAGECODE10, \n\tVEHICLECOVERAGECODE11, \n\tVEHICLECOVERAGECODE12, \n\tVEHICLECOVERAGECODE13, \n\tVEHICLECOVERAGECODE14, \n\tVEHICLECOVERAGELIMIT1, \n\tVEHICLECOVERAGELIMIT2, \n\tVEHICLECOVERAGELIMIT3, \n\tVEHICLECOVERAGELIMIT4, \n\tVEHICLECOVERAGELIMIT5, \n\tVEHICLECOVERAGELIMIT6, \n\tVEHICLECOVERAGELIMIT7, \n\tVEHICLECOVERAGELIMIT8, \n\tVEHICLECOVERAGELIMIT9, \n\tVEHICLECOVERAGELIMIT10, \n\tVEHICLECOVERAGELIMIT11, \n\tVEHICLECOVERAGELIMIT12, \n\tVEHICLECOVERAGELIMIT13, \n\tVEHICLECOVERAGELIMIT14, \n\tVEHICLECOVERAGEPREMIUM1, \n\tVEHICLECOVERAGEPREMIUM2, \n\tVEHICLECOVERAGEPREMIUM3, \n\tVEHICLECOVERAGEPREMIUM4, \n\tVEHICLECOVERAGEPREMIUM5, \n\tVEHICLECOVERAGEPREMIUM6, \n\tVEHICLECOVERAGEPREMIUM7, \n\tVEHICLECOVERAGEPREMIUM8, \n\tVEHICLECOVERAGEPREMIUM9, \n\tVEHICLECOVERAGEPREMIUM10, \n\tVEHICLECOVERAGEPREMIUM11, \n\tVEHICLECOVERAGEPREMIUM12, \n\tVEHICLECOVERAGEPREMIUM13, \n\tVEHICLECOVERAGEPREMIUM14, \n\tVEHICLECOVERAGERATEBOOKID1, \n\tVEHICLECOVERAGERATEBOOKID2, \n\tVEHICLECOVERAGERATEBOOKID3, \n\tVEHICLECOVERAGERATEBOOKID4, \n\tVEHICLECOVERAGERATEBOOKID5, \n\tVEHICLECOVERAGERATEBOOKID6, \n\tVEHICLECOVERAGERATEBOOKID7, \n\tVEHICLECOVERAGERATEBOOKID8, \n\tVEHICLECOVERAGERATEBOOKID9, \n\tVEHICLECOVERAGERATEBOOKID10, \n\tVEHICLECOVERAGERATEBOOKID11, \n\tVEHICLECOVERAGERATEBOOKID12, \n\tVEHICLECOVERAGERATEBOOKID13, \n\tVEHICLECOVERAGERATEBOOKID14, \n\tHOMEANDHIGHWAYMODINDICATOR, \n\tVEHICLEFACTORHOLDAREA, \n\tVEHICLEUMSUMPSWITCH, \n\tVEHICLEDELETEDINDICATOR, \n\tNONSMOKERDISCOUNT, \n\tACCIDENTFREEDISCOUNTPERCENT, \n\tSAFEDRIVERDISCOUNT, \n\tHIREDNONOWNEDMINIMUM, \n\tHIREDNONOWNEDFACTOR, \n\tINEXPERIENCEDOPERATORSURCHARGE, \n\tPMSFUTUREUSE, \n\tCUSTOMERFUTUREUSE, \n\tYR2000CUSTOMERUSE, \n\tDUPLICATEKEYSEQUENCENUMBER, \n\to_audit_id AS AUDITID\n\tFROM EXP_Pif351Stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}