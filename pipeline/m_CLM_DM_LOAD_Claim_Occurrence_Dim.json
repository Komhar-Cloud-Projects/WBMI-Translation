{
    "name": "m_CLM_DM_LOAD_Claim_Occurrence_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Occurrence_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Claim_Occurrence_Dim_Sources AS (\n\tSELECT\r\n\tCO.CLAIM_OCCURRENCE_ID AS CLAIM_OCCURRENCE_PK_ID,\r\n\tCO.CLAIM_OCCURRENCE_AK_ID AS CLAIM_OCCURRENCE_AK_ID,\r\n\tCO.CLAIM_OCCURRENCE_KEY,\r\n\tCO.CLAIM_OCCURRENCE_TYPE_CODE,\r\n\tCO.SOURCE_CLAIM_OCCURRENCE_STATUS_CODE,\r\n\tCO.S3P_CLAIM_CREATED_DATE,\r\n\tCO.SOURCE_CLAIM_RPTED_DATE,\r\n\tCO.RPT_METHOD,\r\n\tCO.HOW_CLAIM_RPTED,\r\n\tCO.LOSS_LOC_ADDR,\r\n\tCO.LOSS_LOC_CITY,\r\n\tCO.LOSS_LOC_COUNTY,\r\n\tLTRIM(RTRIM(CO.LOSS_LOC_STATE)) AS LOSS_LOC_STATE ,\r\n\tCO.LOSS_LOC_ZIP,\r\n\tCO.CLAIM_LOSS_DATE,\r\n\tCO.CLAIM_DISCOVERY_DATE,\r\n\tCO.CLAIM_CAT_CODE,\r\n\tCO.CLAIM_CAT_START_DATE,\r\n\tCO.CLAIM_CAT_END_DATE,\r\n\tCO.S3P_CLAIM_NUM,\r\n\tCO.REINS_NOTIFIED_DATE,\r\n\tCO.CLAIM_OCCURRENCE_NUM,\r\n\tCO.CLAIM_VOILATION_CITATION_DESCRIPT,\r\n\tCO.CLAIM_LOSS_DESCRIPT,\r\n\tCO.CLAIM_INSD_AT_FAULT_CODE,\r\n\tCO.CLAIM_INSD_DRIVER_NUM,\r\n\tCO.CLAIM_INSD_DRIVER_IND,\r\n\tCO.CLAIM_LOG_NOTE_LAST_ACT_DATE,\r\n\tCO.NEXT_DIARY_DATE,\r\n\tCO.NEXT_DIARY_DATE_REP,\r\n\tCO.OFFSET_ONSET_IND,\r\n\tCO.ERR_FLAG_BAL_TXN,\r\n\tCO.ERR_FLAG_BAL_REINS,\r\n\tDISTINCT_EFF_FROM_DATES.EFF_FROM_DATE EFF_FROM_DATE,\r\n\tCO.SOURCE_SYS_ID,\r\n\tCO.CLAIM_CREATED_BY_KEY,\r\n\tCOC.CLAIM_OCCURRENCE_CALCULATION_ID  AS CLAIM_OCCURRENCE_PK_ID,\r\n\tCOC.CLAIM_OCCURRENCE_DATE CLAIM_OCCURRENCE_DATE,\r\n\tCOC.CLAIM_OCCURRENCE_DATE_TYPE,\r\n\tCOC.CLAIM_OCCURRENCE_REPORTED_DATE,\r\n\tCOC.CLAIM_SUPPLEMENTAL_IND,\r\n\tCOC.CLAIM_FINANCIAL_IND,\r\n\tCOC.CLAIM_RECOVERY_IND,\r\n\tCOC.CLAIM_NOTICE_ONLY_IND,\r\n\tCORC_D.CLAIM_OCCURRENCE_RESERVE_CALCULATION_ID AS CLAIM_OCCURRENCE_RESERVE_CALCULATION_DIRECT_LOSS_PK_ID ,\r\n\tCORC_D.RESERVE_DATE_TYPE AS CLAIM_OCCURRENCE_DIRECT_LOSS_STATUS_CODE,\r\n\tCORC_E.CLAIM_OCCURRENCE_RESERVE_CALCULATION_ID AS  CLAIM_OCCURRENCE_RESERVE_CALCULATION_EXP_PK_ID ,\r\n\tCORC_E.RESERVE_DATE_TYPE AS CLAIM_OCCURRENCE_EXP_STATUS_CODE ,\r\n\tCORC_B.CLAIM_OCCURRENCE_RESERVE_CALCULATION_ID AS  CLAIM_OCCURRENCE_RESERVE_CALCULATION_SUBROGATION_PK_ID ,\r\n\tCORC_B.RESERVE_DATE_TYPE AS CLAIM_OCCURRENCE_SUBROGATION_STATUS_CODE,\r\n\tCORC_S.CLAIM_OCCURRENCE_RESERVE_CALCULATION_ID AS CLAIM_OCCURRENCE_RESERVE_CALCULATION_SALVAGE_PK_ID ,\r\n\tCORC_S.RESERVE_DATE_TYPE AS CLAIM_OCCURRENCE_SALVAGE_STATUS_CODE,\r\n\tCORC_R.CLAIM_OCCURRENCE_RESERVE_CALCULATION_ID AS  CLAIM_OCCURRENCE_RESERVE_CALCULATION_OTHER_RECOVERY_PK_ID ,\r\n\tCORC_R.RESERVE_DATE_TYPE AS CLAIM_OCCURRENCE_OTHER_RECOVERY_STATUS_CODE,\r\n\tCO.WC_CAT_CODE AS WC_CAT_CODE,\r\n\tCO.SupStateId AS SupStateId,\r\n\tCO.SupClaimInsuredAtFaultCodeId AS SupClaimInsuredAtFaultCodeId,\r\n\tCO.PrimaryWorkGroup AS PrimaryWorkGroup,\r\n\tCO.SecondaryWorkGroup AS SecondaryWorkGroup,\r\n\tCO.ClaimRelationshipKey AS ClaimRelationshipKey\r\n\tFROM\r\n\t\r\n\t(\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_CALCULATION WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_REPRESENTATIVE_OCCURRENCE WHERE MODIFIED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\t) AS DISTINCT_EFF_FROM_DATES\r\n\t\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE CO ON CO.CLAIM_OCCURRENCE_AK_ID = DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CO.EFF_FROM_DATE AND CO.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION CORC_D ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CORC_D.CLAIM_OCCURRENCE_AK_ID AND CORC_D.FINANCIAL_TYPE_CODE='D'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CORC_D.EFF_FROM_DATE AND CORC_D.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION CORC_E ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CORC_E.CLAIM_OCCURRENCE_AK_ID AND CORC_E.FINANCIAL_TYPE_CODE='E'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CORC_E.EFF_FROM_DATE AND CORC_E.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION CORC_B ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CORC_B.CLAIM_OCCURRENCE_AK_ID AND CORC_B.FINANCIAL_TYPE_CODE='B'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CORC_B.EFF_FROM_DATE AND CORC_B.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION CORC_S ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CORC_S.CLAIM_OCCURRENCE_AK_ID AND CORC_S.FINANCIAL_TYPE_CODE='S'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CORC_S.EFF_FROM_DATE AND CORC_S.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION CORC_R ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CORC_R.CLAIM_OCCURRENCE_AK_ID AND CORC_R.FINANCIAL_TYPE_CODE='R'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CORC_R.EFF_FROM_DATE AND CORC_R.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_CALCULATION COC ON DISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=COC.CLAIM_OCCURRENCE_AK_ID AND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COC.EFF_FROM_DATE AND COC.EFF_TO_DATE\n),\nSQ_Claim_Representative_Occurrence AS (\n\tSELECT\r\n\tCASE WHEN CRO_E.CLAIM_REP_OCCURRENCE_ID IS NULL  THEN -1 ELSE CRO_E.CLAIM_REP_OCCURRENCE_ID END,\r\n\t\r\n\tDISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID,\r\n\t\r\n\tCASE WHEN CRO_E.TRANSFERRED_CLAIM_ADJUSTER_LVL_IND  IS NULL THEN 'N/A' ELSE  CRO_E.TRANSFERRED_CLAIM_ADJUSTER_LVL_IND END ,\r\n\t\r\n\tCASE  WHEN CRO_E.TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND  IS NULL THEN 'N/A' ELSE CRO_E.TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND END,\r\n\t\r\n\tCASE  WHEN CRO_E.TRANSFERRED_CLAIM_DEPT_LVL_IND  IS NULL THEN 'N/A' ELSE CRO_E.TRANSFERRED_CLAIM_DEPT_LVL_IND END,\r\n\t\r\n\tCASE  WHEN CRO_E.TRANSFERRED_CLAIM_DVSN_LVL_IND  IS NULL THEN 'N/A' ELSE  CRO_E.TRANSFERRED_CLAIM_DVSN_LVL_IND END,\r\n\t\r\n\tDISTINCT_EFF_FROM_DATES.EFF_FROM_DATE,\r\n\t\r\n\tCRO_E.EFF_FROM_DATE EFF_FROM_DATE,\r\n\t\r\n\tCRO_E.EFF_TO_DATE EFF_TO_DATE,\r\n\t\r\n\tCASE  WHEN CRO_H.CLAIM_REP_OCCURRENCE_ID  IS NULL THEN -1 ELSE CRO_H.CLAIM_REP_OCCURRENCE_ID END ,\r\n\t\r\n\tCRO_H.EFF_FROM_DATE EFF_FROM_DATE,\r\n\t\r\n\tCRO_H.EFF_TO_DATE EFF_TO_DATE,\r\n\t\r\n\tCASE  WHEN CRO_H.TRANSFERRED_CLAIM_ADJUSTER_LVL_IND   IS NULL THEN 'N/A' ELSE CRO_H.TRANSFERRED_CLAIM_ADJUSTER_LVL_IND END,\r\n\t\r\n\tCASE  WHEN CRO_H.TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND  IS  NULL THEN 'N/A' ELSE CRO_H.TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND END,\r\n\t\r\n\tCASE  WHEN CRO_H.TRANSFERRED_CLAIM_DEPT_LVL_IND   IS NULL THEN 'N/A' ELSE CRO_H.TRANSFERRED_CLAIM_DEPT_LVL_IND END,\r\n\t\r\n\tCASE  WHEN CRO_H.TRANSFERRED_CLAIM_DVSN_LVL_IND   IS NULL THEN 'N/A' ELSE CRO_H.TRANSFERRED_CLAIM_DVSN_LVL_IND END\r\n\t\r\n\tFROM\r\n\t\r\n\t(\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_RESERVE_CALCULATION WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_OCCURRENCE_CALCULATION WHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT CLAIM_OCCURRENCE_AK_ID,EFF_FROM_DATE FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIM_REPRESENTATIVE_OCCURRENCE WHERE MODIFIED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\n\t) AS DISTINCT_EFF_FROM_DATES\r\n\t\r\n\tLEFT OUTER JOIN CLAIM_REPRESENTATIVE_OCCURRENCE CRO_E ON \r\n\tDISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CRO_E.CLAIM_OCCURRENCE_AK_ID AND \r\n\tDISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CRO_E.EFF_FROM_DATE AND CRO_E.EFF_TO_DATE AND \r\n\tCRO_E.CLAIM_REP_ROLE_CODE = 'E'\r\n\t\r\n\tLEFT OUTER JOIN CLAIM_REPRESENTATIVE_OCCURRENCE CRO_H ON \r\n\tDISTINCT_EFF_FROM_DATES.CLAIM_OCCURRENCE_AK_ID=CRO_H.CLAIM_OCCURRENCE_AK_ID AND \r\n\tDISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN CRO_H.EFF_FROM_DATE AND CRO_H.EFF_TO_DATE AND \r\n\tCRO_H.CLAIM_REP_ROLE_CODE = 'H'\n),\nJNR_CRO_EDW AS (SELECT\n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_id, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_ak_id, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_key, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_type_code, \n\tSQ_Claim_Occurrence_Dim_Sources.source_claim_occurrence_status_code, \n\tSQ_Claim_Occurrence_Dim_Sources.s3p_claim_created_date, \n\tSQ_Claim_Occurrence_Dim_Sources.source_claim_rpted_date, \n\tSQ_Claim_Occurrence_Dim_Sources.rpt_method, \n\tSQ_Claim_Occurrence_Dim_Sources.how_claim_rpted, \n\tSQ_Claim_Occurrence_Dim_Sources.loss_loc_addr, \n\tSQ_Claim_Occurrence_Dim_Sources.loss_loc_city, \n\tSQ_Claim_Occurrence_Dim_Sources.loss_loc_county, \n\tSQ_Claim_Occurrence_Dim_Sources.loss_loc_state, \n\tSQ_Claim_Occurrence_Dim_Sources.loss_loc_zip, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_cat_code, \n\tSQ_Claim_Occurrence_Dim_Sources.s3p_claim_num, \n\tSQ_Claim_Occurrence_Dim_Sources.reins_notified_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_num, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_voilation_citation_descript, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_loss_descript, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_insd_at_fault_code, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_insd_driver_num, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_insd_driver_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_log_note_last_act_date, \n\tSQ_Claim_Occurrence_Dim_Sources.next_diary_date, \n\tSQ_Claim_Occurrence_Dim_Sources.next_diary_date_rep, \n\tSQ_Claim_Occurrence_Dim_Sources.offset_onset_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.err_flag_bal_txn, \n\tSQ_Claim_Occurrence_Dim_Sources.err_flag_bal_reins, \n\tSQ_Claim_Occurrence_Dim_Sources.eff_from_date, \n\tSQ_Claim_Occurrence_Dim_Sources.source_sys_id, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_created_by_key, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_calculation_id, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_date_type, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_supplemental_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_financial_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_recovery_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_notice_only_ind, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reserve_calculation_id, \n\tSQ_Claim_Occurrence_Dim_Sources.reserve_date_type, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reserve_calculation_id1, \n\tSQ_Claim_Occurrence_Dim_Sources.reserve_date_type1, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reserve_calculation_id2, \n\tSQ_Claim_Occurrence_Dim_Sources.reserve_date_type2, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reserve_calculation_id3, \n\tSQ_Claim_Occurrence_Dim_Sources.reserve_date_type3, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reserve_calculation_id4, \n\tSQ_Claim_Occurrence_Dim_Sources.reserve_date_type4, \n\tSQ_Claim_Occurrence_Dim_Sources.financial_type_status_code4 AS wc_cat_code, \n\tSQ_Claim_Occurrence_Dim_Sources.SupStateId, \n\tSQ_Claim_Occurrence_Dim_Sources.SupClaimInsuredAtFaultCodeId, \n\tSQ_Claim_Representative_Occurrence.claim_rep_occurrence_id AS claim_rep_occurrence_id_E, \n\tSQ_Claim_Representative_Occurrence.created_date1 AS eff_from_date_cro, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_adjuster_lvl_ind AS transferred_claim_adjuster_lvl_ind_E, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_handling_office_lvl_ind AS transferred_claim_handling_office_lvl_ind_E, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_dept_lvl_ind AS transferred_claim_dept_lvl_ind_E, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_dvsn_lvl_ind AS transferred_claim_dvsn_lvl_ind_E, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_adjuster_lvl_ind1 AS transferred_claim_adjuster_lvl_ind_H, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_handling_office_lvl_ind1 AS transferred_claim_handling_office_lvl_ind_H, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_dept_lvl_ind1 AS transferred_claim_dept_lvl_ind_H, \n\tSQ_Claim_Representative_Occurrence.transferred_claim_dvsn_lvl_ind1 AS transferred_claim_dvsn_lvl_ind_H, \n\tSQ_Claim_Representative_Occurrence.claim_rep_occurrence_id1 AS claim_rep_occurrence_id_H, \n\tSQ_Claim_Representative_Occurrence.claim_occurrence_ak_id AS claim_occurrence_ak_id_cro, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_loss_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_discovery_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_reported_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_occurrence_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_cat_start_date, \n\tSQ_Claim_Occurrence_Dim_Sources.claim_cat_end_date, \n\tSQ_Claim_Representative_Occurrence.eff_from_date AS eff_from_date_E, \n\tSQ_Claim_Representative_Occurrence.eff_to_date AS eff_to_date_E, \n\tSQ_Claim_Representative_Occurrence.eff_from_date1 AS eff_from_date_H, \n\tSQ_Claim_Representative_Occurrence.eff_to_date1 AS eff_to_date_H, \n\tSQ_Claim_Occurrence_Dim_Sources.PrimaryWorkGroup, \n\tSQ_Claim_Occurrence_Dim_Sources.SecondaryWorkGroup, \n\tSQ_Claim_Occurrence_Dim_Sources.ClaimRelationshipKey\n\tFROM SQ_Claim_Occurrence_Dim_Sources\n\tINNER JOIN SQ_Claim_Representative_Occurrence\n\tON SQ_Claim_Representative_Occurrence.claim_occurrence_ak_id = SQ_Claim_Occurrence_Dim_Sources.claim_occurrence_ak_id AND SQ_Claim_Representative_Occurrence.created_date1 = SQ_Claim_Occurrence_Dim_Sources.eff_from_date\n),\nLKP_ClaimStory AS (\n\tSELECT\n\tCatalyst,\n\tCauseOfDamage,\n\tDamageCaused,\n\tItemDamaged,\n\tClaimOccurrenceKey\n\tFROM (\n\t\tSELECT \n\t\t\tCatalyst,\n\t\t\tCauseOfDamage,\n\t\t\tDamageCaused,\n\t\t\tItemDamaged,\n\t\t\tClaimOccurrenceKey\n\t\tFROM ClaimStory\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ClaimOccurrenceKey ORDER BY Catalyst) = 1\n),\nLKP_SupClaimReportedMethodDescription AS (\n\tSELECT\n\tClaimReportedMethodDescription,\n\tClaimReportedMethodCode\n\tFROM (\n\t\tselect ClaimReportedMethodCode as ClaimReportedMethodCode, \r\n\t\t\tClaimReportedMethodDescription as ClaimReportedMethodDescription\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupClaimReportedMethodDescription\r\n\t\twhere CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ClaimReportedMethodCode ORDER BY ClaimReportedMethodDescription) = 1\n),\nLKP_Sup_Claim_Insured_At_Fault_Code AS (\n\tSELECT\n\tclaim_insd_at_fault_descript,\n\tsup_claim_insd_at_fault_code_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_insd_at_fault_descript,\n\t\t\tsup_claim_insd_at_fault_code_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_insured_at_fault_code\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_claim_insd_at_fault_code_id ORDER BY claim_insd_at_fault_descript) = 1\n),\nLKP_Sup_State AS (\n\tSELECT\n\tstate_descript,\n\tstate_code\n\tFROM (\n\t\tSELECT \n\t\t\tstate_descript,\n\t\t\tstate_code\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_state\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY state_code ORDER BY state_descript) = 1\n),\nEXP_Set_Default_Value AS (\n\tSELECT\n\tJNR_CRO_EDW.claim_occurrence_id AS edw_claim_occurrence_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_pk_id), -1, edw_claim_occurrence_pk_id)\r\n\t-- \n\tIFF(edw_claim_occurrence_pk_id IS NULL, - 1, edw_claim_occurrence_pk_id) AS edw_claim_occurrence_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_calculation_id AS edw_claim_occurrence_calculation_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_calculation_pk_id),-1,edw_claim_occurrence_calculation_pk_id)\n\tIFF(edw_claim_occurrence_calculation_pk_id IS NULL, - 1, edw_claim_occurrence_calculation_pk_id) AS edw_claim_occurrence_calculation_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_reserve_calculation_id AS edw_claim_occurrence_reserve_calculation_direct_loss_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_reserve_calculation_direct_loss_pk_id),-1,edw_claim_occurrence_reserve_calculation_direct_loss_pk_id)\n\tIFF(edw_claim_occurrence_reserve_calculation_direct_loss_pk_id IS NULL, - 1, edw_claim_occurrence_reserve_calculation_direct_loss_pk_id) AS edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_reserve_calculation_id1 AS edw_claim_occurrence_reserve_calculation_exp_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_reserve_calculation_exp_pk_id),-1,edw_claim_occurrence_reserve_calculation_exp_pk_id)\n\tIFF(edw_claim_occurrence_reserve_calculation_exp_pk_id IS NULL, - 1, edw_claim_occurrence_reserve_calculation_exp_pk_id) AS edw_claim_occurrence_reserve_calculation_exp_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_reserve_calculation_id2 AS edw_claim_occurrence_reserve_calculation_subrogation_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_reserve_calculation_subrogation_pk_id),-1,edw_claim_occurrence_reserve_calculation_subrogation_pk_id)\n\tIFF(edw_claim_occurrence_reserve_calculation_subrogation_pk_id IS NULL, - 1, edw_claim_occurrence_reserve_calculation_subrogation_pk_id) AS edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_reserve_calculation_id3 AS edw_claim_occurrence_reserve_calculation_salvage_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_reserve_calculation_salvage_pk_id),-1,edw_claim_occurrence_reserve_calculation_salvage_pk_id)\n\tIFF(edw_claim_occurrence_reserve_calculation_salvage_pk_id IS NULL, - 1, edw_claim_occurrence_reserve_calculation_salvage_pk_id) AS edw_claim_occurrence_reserve_calculation_salvage_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_reserve_calculation_id4 AS edw_claim_occurrence_reserve_calculation_other_recovery_pk_id,\n\t-- *INF*: IIF(ISNULL(edw_claim_occurrence_reserve_calculation_other_recovery_pk_id),-1,edw_claim_occurrence_reserve_calculation_other_recovery_pk_id)\n\tIFF(edw_claim_occurrence_reserve_calculation_other_recovery_pk_id IS NULL, - 1, edw_claim_occurrence_reserve_calculation_other_recovery_pk_id) AS edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out,\n\tJNR_CRO_EDW.claim_occurrence_key,\n\tJNR_CRO_EDW.claim_occurrence_date_type AS in_claim_occurrence_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_status_code) OR LENGTH(in_claim_occurrence_status_code)=0 OR in_claim_occurrence_status_code = 'N/A' ,\r\n\t-- 'N/A',\r\n\t-- substr(in_claim_occurrence_status_code,2))\n\tIFF(in_claim_occurrence_status_code IS NULL OR LENGTH(in_claim_occurrence_status_code) = 0 OR in_claim_occurrence_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_status_code, 2)) AS v_claim_occurrence_status_code,\n\tv_claim_occurrence_status_code AS out_claim_occurrence_status_code,\n\tJNR_CRO_EDW.reserve_date_type AS in_claim_occurrence_direct_loss_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_direct_loss_status_code) OR in_claim_occurrence_direct_loss_status_code='N/A',\r\n\t-- 'N/A',\r\n\t-- substr(in_claim_occurrence_direct_loss_status_code,2))\n\tIFF(in_claim_occurrence_direct_loss_status_code IS NULL OR in_claim_occurrence_direct_loss_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_direct_loss_status_code, 2)) AS claim_occurrence_direct_loss_status_code_out,\n\tJNR_CRO_EDW.reserve_date_type1 AS in_claim_occurrence_exp_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_exp_status_code) OR in_claim_occurrence_exp_status_code = 'N/A'\r\n\t-- ,'N/A',\r\n\t-- substr(in_claim_occurrence_exp_status_code,2))\n\tIFF(in_claim_occurrence_exp_status_code IS NULL OR in_claim_occurrence_exp_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_exp_status_code, 2)) AS claim_occurrence_exp_status_code_out,\n\tJNR_CRO_EDW.reserve_date_type2 AS in_claim_occurrence_subrogation_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_subrogation_status_code) OR in_claim_occurrence_subrogation_status_code ='N/A'\r\n\t-- ,'N/A',\r\n\t-- substr(in_claim_occurrence_subrogation_status_code,2))\n\tIFF(in_claim_occurrence_subrogation_status_code IS NULL OR in_claim_occurrence_subrogation_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_subrogation_status_code, 2)) AS claim_occurrence_subrogation_status_code_out,\n\tJNR_CRO_EDW.reserve_date_type3 AS in_claim_occurrence_salvage_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_salvage_status_code) OR in_claim_occurrence_salvage_status_code='N/A'\r\n\t-- ,'N/A',\r\n\t-- substr(in_claim_occurrence_salvage_status_code,2))\n\tIFF(in_claim_occurrence_salvage_status_code IS NULL OR in_claim_occurrence_salvage_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_salvage_status_code, 2)) AS claim_occurrence_salvage_status_code_out,\n\tJNR_CRO_EDW.reserve_date_type4 AS in_claim_occurrence_other_recovery_status_code,\n\t-- *INF*: iif(isnull(in_claim_occurrence_other_recovery_status_code) OR in_claim_occurrence_other_recovery_status_code = 'N/A'\r\n\t-- ,'N/A',\r\n\t-- substr(in_claim_occurrence_other_recovery_status_code,2))\n\tIFF(in_claim_occurrence_other_recovery_status_code IS NULL OR in_claim_occurrence_other_recovery_status_code = 'N/A', 'N/A', substr(in_claim_occurrence_other_recovery_status_code, 2)) AS claim_occurrence_other_recovery_status_code_out,\n\tJNR_CRO_EDW.wc_cat_code AS in_wc_cat_code,\n\t-- *INF*: iif(isnull(in_wc_cat_code)\r\n\t-- ,'N/A',\r\n\t-- in_wc_cat_code)\n\tIFF(in_wc_cat_code IS NULL, 'N/A', in_wc_cat_code) AS wc_cat_code_out,\n\t-- *INF*: iif(isnull(in_claim_occurrence_reopen_ind),'N/A',in_claim_occurrence_reopen_ind)\n\tIFF(in_claim_occurrence_reopen_ind IS NULL, 'N/A', in_claim_occurrence_reopen_ind) AS claim_occurrence_reopen_ind_out,\n\tJNR_CRO_EDW.claim_financial_ind AS in_claim_occurrence_financial_ind,\n\t-- *INF*: iif(isnull(in_claim_occurrence_financial_ind),'N/A',in_claim_occurrence_financial_ind)\n\tIFF(in_claim_occurrence_financial_ind IS NULL, 'N/A', in_claim_occurrence_financial_ind) AS claim_occurrence_financial_ind_out,\n\tJNR_CRO_EDW.claim_supplemental_ind AS in_claim_occurrence_supplemental_ind,\n\t-- *INF*: iif(isnull(in_claim_occurrence_supplemental_ind),'N/A',in_claim_occurrence_supplemental_ind)\n\tIFF(in_claim_occurrence_supplemental_ind IS NULL, 'N/A', in_claim_occurrence_supplemental_ind) AS claim_occurrence_supplemental_ind_out,\n\tJNR_CRO_EDW.claim_recovery_ind AS in_claim_occurrence_recovery_ind,\n\t-- *INF*: iif(isnull(in_claim_occurrence_recovery_ind),'N/A',in_claim_occurrence_recovery_ind)\n\tIFF(in_claim_occurrence_recovery_ind IS NULL, 'N/A', in_claim_occurrence_recovery_ind) AS claim_occurrence_recovery_ind_out,\n\tJNR_CRO_EDW.claim_notice_only_ind AS in_claim_occurrence_notice_only_claim_ind,\n\t-- *INF*: iif(isnull(in_claim_occurrence_notice_only_claim_ind),'N/A',in_claim_occurrence_notice_only_claim_ind)\n\tIFF(in_claim_occurrence_notice_only_claim_ind IS NULL, 'N/A', in_claim_occurrence_notice_only_claim_ind) AS claim_occurrence_notice_only_claim_ind_out,\n\tJNR_CRO_EDW.claim_occurrence_type_code AS claim_occurrence_type,\n\tJNR_CRO_EDW.source_claim_occurrence_status_code,\n\tJNR_CRO_EDW.s3p_claim_created_date,\n\tJNR_CRO_EDW.source_claim_rpted_date,\n\tJNR_CRO_EDW.rpt_method,\n\tJNR_CRO_EDW.how_claim_rpted,\n\tJNR_CRO_EDW.loss_loc_zip,\n\tJNR_CRO_EDW.loss_loc_state AS i_state_code,\n\t-- *INF*: IIF(ISNULL(i_state_code) OR RTRIM(LTRIM(i_state_code))='',\r\n\t-- 'N/A',\r\n\t-- RTRIM(LTRIM(i_state_code)))\n\tIFF(i_state_code IS NULL OR RTRIM(LTRIM(i_state_code)) = '', 'N/A', RTRIM(LTRIM(i_state_code))) AS loss_loc_state,\n\tJNR_CRO_EDW.loss_loc_county,\n\tJNR_CRO_EDW.loss_loc_city,\n\tJNR_CRO_EDW.loss_loc_addr,\n\tJNR_CRO_EDW.claim_cat_code,\n\tJNR_CRO_EDW.s3p_claim_num AS in_claim_num,\n\t-- *INF*: IIF(ISNULL(in_claim_num) OR RTRIM(LTRIM(in_claim_num)) = '',\r\n\t-- 'N/A',\r\n\t-- RTRIM(LTRIM(in_claim_num)))\n\tIFF(in_claim_num IS NULL OR RTRIM(LTRIM(in_claim_num)) = '', 'N/A', RTRIM(LTRIM(in_claim_num))) AS o_claim_num,\n\tJNR_CRO_EDW.reins_notified_date,\n\tJNR_CRO_EDW.claim_occurrence_num,\n\tJNR_CRO_EDW.claim_voilation_citation_descript AS claim_violation_citation_descript,\n\tJNR_CRO_EDW.claim_loss_descript,\n\tJNR_CRO_EDW.claim_insd_at_fault_code,\n\tLKP_Sup_Claim_Insured_At_Fault_Code.claim_insd_at_fault_descript AS i_claim_insd_at_fault_descript,\n\t-- *INF*: IIF(ISNULL(i_claim_insd_at_fault_descript),'N/A',i_claim_insd_at_fault_descript)\n\tIFF(i_claim_insd_at_fault_descript IS NULL, 'N/A', i_claim_insd_at_fault_descript) AS o_claim_insd_at_fault_code_descript,\n\tJNR_CRO_EDW.claim_insd_driver_num AS claim_insd_drvr_num,\n\tJNR_CRO_EDW.claim_insd_driver_ind AS claim_insd_drvr_ind,\n\tJNR_CRO_EDW.offset_onset_ind AS claim_offset_onset_ind,\n\tJNR_CRO_EDW.err_flag_bal_txn,\n\tJNR_CRO_EDW.err_flag_bal_reins,\n\tJNR_CRO_EDW.source_sys_id,\n\tJNR_CRO_EDW.claim_created_by_key,\n\tJNR_CRO_EDW.claim_log_note_last_act_date,\n\tJNR_CRO_EDW.next_diary_date,\n\tJNR_CRO_EDW.next_diary_date_rep,\n\t-- *INF*: IIF(isnull(claim_rep_role_code), '-1', claim_rep_role_code)\n\tIFF(claim_rep_role_code IS NULL, '-1', claim_rep_role_code) AS claim_rep_role_code_out,\n\t-- *INF*: iif(isnull(in_claim_rep_role_code_descript),'N/A',in_claim_rep_role_code_descript)\n\tIFF(in_claim_rep_role_code_descript IS NULL, 'N/A', in_claim_rep_role_code_descript) AS claim_rep_role_code_descript_out,\n\tJNR_CRO_EDW.transferred_claim_dvsn_lvl_ind_E,\n\t-- *INF*: IIF(ISNULL(transferred_claim_dvsn_lvl_ind_E), '-1', transferred_claim_dvsn_lvl_ind_E)\n\tIFF(transferred_claim_dvsn_lvl_ind_E IS NULL, '-1', transferred_claim_dvsn_lvl_ind_E) AS transferred_claim_dvsn_lvl_ind_out_E,\n\tJNR_CRO_EDW.transferred_claim_dept_lvl_ind_E,\n\t-- *INF*: IIF(ISNULL(transferred_claim_dept_lvl_ind_E), '-1', transferred_claim_dept_lvl_ind_E)\n\tIFF(transferred_claim_dept_lvl_ind_E IS NULL, '-1', transferred_claim_dept_lvl_ind_E) AS transferred_claim_dept_lvl_ind_out_E,\n\tJNR_CRO_EDW.transferred_claim_handling_office_lvl_ind_E,\n\t-- *INF*: IIF(ISNULL(transferred_claim_handling_office_lvl_ind_E), '-1', transferred_claim_handling_office_lvl_ind_E)\n\tIFF(transferred_claim_handling_office_lvl_ind_E IS NULL, '-1', transferred_claim_handling_office_lvl_ind_E) AS transferred_claim_handling_office_lvl_ind_out_E,\n\tJNR_CRO_EDW.transferred_claim_adjuster_lvl_ind_E,\n\t-- *INF*: IIF(ISNULL(transferred_claim_adjuster_lvl_ind_E), '-1', transferred_claim_adjuster_lvl_ind_E)\n\tIFF(transferred_claim_adjuster_lvl_ind_E IS NULL, '-1', transferred_claim_adjuster_lvl_ind_E) AS transferred_claim_adjuster_lvl_ind_out_E,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tJNR_CRO_EDW.eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tsysdate AS created_date,\n\tsysdate AS modified_date,\n\tJNR_CRO_EDW.claim_occurrence_ak_id,\n\tJNR_CRO_EDW.transferred_claim_adjuster_lvl_ind_H,\n\tJNR_CRO_EDW.transferred_claim_handling_office_lvl_ind_H,\n\tJNR_CRO_EDW.transferred_claim_dept_lvl_ind_H,\n\tJNR_CRO_EDW.transferred_claim_dvsn_lvl_ind_H,\n\tJNR_CRO_EDW.claim_rep_occurrence_id_E,\n\tJNR_CRO_EDW.claim_rep_occurrence_id_H,\n\tJNR_CRO_EDW.claim_loss_date,\n\tJNR_CRO_EDW.claim_discovery_date,\n\tJNR_CRO_EDW.claim_occurrence_date,\n\t-- *INF*: DECODE(TRUE, v_claim_occurrence_status_code = 'OPEN', claim_occurrence_date, TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'))\r\n\t-- \r\n\t-- -- If this evaluates to 1/1/1800, the value will be overwritten in the post-session update that runs in a target of this mapping.\n\tDECODE(TRUE,\n\tv_claim_occurrence_status_code = 'OPEN', claim_occurrence_date,\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')) AS v_claim_open_date,\n\tv_claim_open_date AS claim_open_date,\n\t-- *INF*: DECODE(TRUE, v_claim_occurrence_status_code = 'CLOSED', claim_occurrence_date, TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'))\r\n\t-- \r\n\t-- -- If this evaluates to 1/1/1800, the value will be overwritten in the post-session update that runs in a target of this mapping.\n\tDECODE(TRUE,\n\tv_claim_occurrence_status_code = 'CLOSED', claim_occurrence_date,\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')) AS v_claim_closed_date,\n\tv_claim_closed_date AS claim_closed_date,\n\t-- *INF*: DECODE(TRUE,v_claim_occurrence_status_code = 'REOPEN',claim_occurrence_date,TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'))\r\n\t-- \r\n\t-- -- If this evaluates to 1/1/1800, the value will be overwritten in the post-session update that runs in a target of this mapping.\n\tDECODE(TRUE,\n\tv_claim_occurrence_status_code = 'REOPEN', claim_occurrence_date,\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')) AS v_claim_reopen_date,\n\tv_claim_reopen_date AS claim_reopen_date,\n\t-- *INF*: DECODE(TRUE,v_claim_occurrence_status_code = 'CLOSEDAFTERREOPEN', claim_occurrence_date,TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'))\r\n\t-- \r\n\t-- -- If this evaluates to 1/1/1800, the value will be overwritten in the post-session update that runs in a target of this mapping.\n\tDECODE(TRUE,\n\tv_claim_occurrence_status_code = 'CLOSEDAFTERREOPEN', claim_occurrence_date,\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')) AS v_claim_closed_after_reopen_date,\n\tv_claim_closed_after_reopen_date AS claim_closed_after_reopen_date,\n\t-- *INF*: DECODE(TRUE,v_claim_occurrence_status_code = 'NOTICEONLY',claim_occurrence_date,TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'))\r\n\t-- \r\n\t-- -- If this evaluates to 1/1/1800, the value will be overwritten in the post-session update that runs in a target of this mapping.\n\tDECODE(TRUE,\n\tv_claim_occurrence_status_code = 'NOTICEONLY', claim_occurrence_date,\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')) AS v_claim_notice_only_date,\n\tv_claim_notice_only_date AS claim_notice_only_date,\n\tJNR_CRO_EDW.claim_occurrence_reported_date,\n\tJNR_CRO_EDW.claim_cat_start_date,\n\tJNR_CRO_EDW.claim_cat_end_date,\n\tJNR_CRO_EDW.eff_from_date_E,\n\teff_from_date_E AS eff_from_date_E1,\n\tJNR_CRO_EDW.eff_to_date_E,\n\teff_to_date_E AS eff_to_date_E1,\n\tJNR_CRO_EDW.eff_from_date_H,\n\teff_from_date_H AS eff_from_date_H1,\n\tJNR_CRO_EDW.eff_to_date_H,\n\teff_to_date_H AS eff_to_date_H1,\n\t-- *INF*: TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AS default_date,\n\t'N/A' AS default_NA,\n\tclaim_occurrence_ak_id AS v_prev_row_claim_occurrence_ak_id,\n\tv_claim_open_date AS v_prev_row_claim_open_date,\n\tv_claim_closed_date AS v_prev_row_claim_closed_date,\n\tv_claim_reopen_date AS v_prev_row_claim_reopen_date,\n\tv_claim_closed_after_reopen_date AS v_prev_row_claim_closed_after_reopen_date,\n\tv_claim_notice_only_date AS v_prev_row_claim_notice_only_date,\n\tLKP_Sup_State.state_descript AS i_state_descript,\n\t-- *INF*: IIF(ISNULL(i_state_descript) OR RTRIM(LTRIM(i_state_descript))='','N/A',i_state_descript)\r\n\t-- \n\tIFF(i_state_descript IS NULL OR RTRIM(LTRIM(i_state_descript)) = '', 'N/A', i_state_descript) AS o_LossLocationStateDescription,\n\tJNR_CRO_EDW.PrimaryWorkGroup AS in_PrimaryWorkGroup,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_PrimaryWorkGroup)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_PrimaryWorkGroup) AS out_PrimaryWorkGroup,\n\tJNR_CRO_EDW.SecondaryWorkGroup AS in_SecondaryWorkGroup,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_SecondaryWorkGroup)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_SecondaryWorkGroup) AS out_SecondaryWorkGroup,\n\tJNR_CRO_EDW.ClaimRelationshipKey AS in_ClaimRelationshipKey,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_ClaimRelationshipKey)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_ClaimRelationshipKey) AS out_ClaimRelationshipKey,\n\tLKP_SupClaimReportedMethodDescription.ClaimReportedMethodDescription AS in_ClaimReportedMethodDescription,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_ClaimReportedMethodDescription)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_ClaimReportedMethodDescription) AS out_ClaimReportedMethodDescription,\n\tLKP_ClaimStory.Catalyst AS in_Catalyst,\n\t-- *INF*: IIF(ISNULL(in_Catalyst),'N/A',in_Catalyst)\n\tIFF(in_Catalyst IS NULL, 'N/A', in_Catalyst) AS out_Catalyst,\n\tLKP_ClaimStory.CauseOfDamage AS in_CauseOfDamage,\n\t-- *INF*: IIF(ISNULL(in_CauseOfDamage),'N/A',in_CauseOfDamage)\n\tIFF(in_CauseOfDamage IS NULL, 'N/A', in_CauseOfDamage) AS out_CauseOfDamage,\n\tLKP_ClaimStory.DamageCaused AS in_DamageCaused,\n\t-- *INF*: IIF(ISNULL(in_DamageCaused),'N/A',in_DamageCaused)\n\tIFF(in_DamageCaused IS NULL, 'N/A', in_DamageCaused) AS out_DamageCaused,\n\tLKP_ClaimStory.ItemDamaged AS in_ItemDamaged,\n\t-- *INF*: IIF(ISNULL(in_ItemDamaged),'N/A',in_ItemDamaged)\n\tIFF(in_ItemDamaged IS NULL, 'N/A', in_ItemDamaged) AS out_ItemDamaged\n\tFROM JNR_CRO_EDW\n\tLEFT JOIN LKP_ClaimStory\n\tON LKP_ClaimStory.ClaimOccurrenceKey = JNR_CRO_EDW.claim_occurrence_key\n\tLEFT JOIN LKP_SupClaimReportedMethodDescription\n\tON LKP_SupClaimReportedMethodDescription.ClaimReportedMethodCode = JNR_CRO_EDW.rpt_method\n\tLEFT JOIN LKP_Sup_Claim_Insured_At_Fault_Code\n\tON LKP_Sup_Claim_Insured_At_Fault_Code.sup_claim_insd_at_fault_code_id = JNR_CRO_EDW.SupClaimInsuredAtFaultCodeId\n\tLEFT JOIN LKP_Sup_State\n\tON LKP_Sup_State.state_code = JNR_CRO_EDW.loss_loc_state\n),\nFIL_Invalid_Record AS (\n\tSELECT\n\tedw_claim_occurrence_pk_id_out, \n\tedw_claim_occurrence_calculation_pk_id_out, \n\tedw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out, \n\tedw_claim_occurrence_reserve_calculation_exp_pk_id_out, \n\tedw_claim_occurrence_reserve_calculation_subrogation_pk_id_out, \n\tedw_claim_occurrence_reserve_calculation_salvage_pk_id_out, \n\tedw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out, \n\tclaim_occurrence_key, \n\tout_claim_occurrence_status_code, \n\tclaim_occurrence_direct_loss_status_code_out, \n\tclaim_occurrence_exp_status_code_out, \n\tclaim_occurrence_subrogation_status_code_out, \n\tclaim_occurrence_salvage_status_code_out, \n\tclaim_occurrence_other_recovery_status_code_out, \n\twc_cat_code_out AS claim_occurrence_wc_cat_code, \n\tclaim_occurrence_reopen_ind_out, \n\tclaim_occurrence_financial_ind_out, \n\tclaim_occurrence_supplemental_ind_out, \n\tclaim_occurrence_recovery_ind_out, \n\tclaim_occurrence_notice_only_claim_ind_out, \n\tclaim_occurrence_type, \n\tsource_claim_occurrence_status_code, \n\tclaim_created_by, \n\ts3p_claim_created_date, \n\tsource_claim_rpted_date, \n\trpt_method, \n\thow_claim_rpted, \n\tloss_loc_zip, \n\tloss_loc_state, \n\tloss_loc_county, \n\tloss_loc_city, \n\tloss_loc_addr, \n\tclaim_cat_code, \n\to_claim_num AS claim_num, \n\treins_notified_date, \n\tclaim_occurrence_num, \n\tclaim_violation_citation_descript, \n\tclaim_loss_descript, \n\tclaim_insd_at_fault_code, \n\to_claim_insd_at_fault_code_descript AS claim_insd_at_fault_code_descript_out, \n\tclaim_insd_drvr_num, \n\tclaim_insd_drvr_ind, \n\tclaim_offset_onset_ind, \n\terr_flag_bal_txn, \n\terr_flag_bal_reins, \n\tsource_sys_id, \n\tclaim_created_by_key, \n\tclaim_log_note_last_act_date, \n\tnext_diary_date, \n\tnext_diary_date_rep, \n\tclaim_rep_role_code_out, \n\tclaim_rep_role_code_descript_out, \n\ttransferred_claim_dvsn_lvl_ind_out_E, \n\ttransferred_claim_dept_lvl_ind_out_E, \n\ttransferred_claim_handling_office_lvl_ind_out_E, \n\ttransferred_claim_adjuster_lvl_ind_out_E, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_from_date, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\tclaim_occurrence_ak_id, \n\ttransferred_claim_adjuster_lvl_ind_H, \n\ttransferred_claim_handling_office_lvl_ind_H, \n\ttransferred_claim_dept_lvl_ind_H, \n\ttransferred_claim_dvsn_lvl_ind_H, \n\tclaim_rep_occurrence_id_E, \n\tclaim_rep_occurrence_id_H, \n\tclaim_loss_date, \n\tclaim_discovery_date, \n\tclaim_open_date, \n\tclaim_closed_date, \n\tclaim_reopen_date, \n\tclaim_closed_after_reopen_date, \n\tclaim_notice_only_date, \n\tclaim_occurrence_reported_date, \n\tclaim_cat_start_date, \n\tclaim_cat_end_date, \n\teff_from_date_E1, \n\teff_to_date_E1, \n\teff_from_date_H1, \n\teff_to_date_H1, \n\tdefault_date, \n\tdefault_NA, \n\to_LossLocationStateDescription AS LossLocationStateDescription, \n\tout_PrimaryWorkGroup AS PrimaryWorkGroup, \n\tout_SecondaryWorkGroup AS SecondaryWorkGroup, \n\tout_ClaimRelationshipKey AS ClaimRelationshipKey, \n\tout_ClaimReportedMethodDescription AS ClaimReportedMethodDescription, \n\tout_Catalyst AS Catalyst, \n\tout_CauseOfDamage AS CauseOfDamage, \n\tout_DamageCaused AS DamageCaused, \n\tout_ItemDamaged AS ItemDamaged\n\tFROM EXP_Set_Default_Value\n\tWHERE DECODE(TRUE, SUBSTR(out_claim_occurrence_status_code,1,6) = 'CLOSED' AND  (claim_occurrence_direct_loss_status_code_out = 'OPEN' OR claim_occurrence_exp_status_code_out = 'OPEN' OR claim_occurrence_subrogation_status_code_out = 'OPEN' OR claim_occurrence_salvage_status_code_out = 'OPEN' OR claim_occurrence_other_recovery_status_code_out = 'OPEN' OR  claim_occurrence_direct_loss_status_code_out = 'REOPEN' OR claim_occurrence_exp_status_code_out = 'REOPEN' OR claim_occurrence_subrogation_status_code_out = 'REOPEN' OR claim_occurrence_salvage_status_code_out = 'REOPEN' OR claim_occurrence_other_recovery_status_code_out = 'REOPEN'), FALSE,  (SUBSTR(out_claim_occurrence_status_code,1,4) = 'OPEN' OR SUBSTR(out_claim_occurrence_status_code,1,6) = 'REOPEN' OR SUBSTR(out_claim_occurrence_status_code,1,6) = 'CLOSED') AND SUBSTR(claim_occurrence_direct_loss_status_code_out,1,6) = 'N/A' AND SUBSTR(claim_occurrence_exp_status_code_out,1,6) = 'N/A' AND SUBSTR(claim_occurrence_subrogation_status_code_out,1,6) = 'N/A' AND SUBSTR(claim_occurrence_salvage_status_code_out,1,6) = 'N/A' AND SUBSTR(claim_occurrence_other_recovery_status_code_out,1,6) = 'N/A', TRUE,    (SUBSTR(out_claim_occurrence_status_code,1,4) = 'OPEN' OR SUBSTR(out_claim_occurrence_status_code,1,6) = 'REOPEN') AND ( (SUBSTR(claim_occurrence_direct_loss_status_code_out,1,6) = 'CLOSED' OR claim_occurrence_direct_loss_status_code_out = 'N/A' or claim_occurrence_direct_loss_status_code_out = 'NOTICEONLY') AND (SUBSTR(claim_occurrence_exp_status_code_out,1,6) = 'CLOSED' OR claim_occurrence_exp_status_code_out = 'N/A'  or claim_occurrence_exp_status_code_out = 'NOTICEONLY') AND (SUBSTR(claim_occurrence_subrogation_status_code_out,1,6) = 'CLOSED' OR claim_occurrence_subrogation_status_code_out = 'N/A'  or claim_occurrence_subrogation_status_code_out = 'NOTICEONLY') AND (SUBSTR(claim_occurrence_salvage_status_code_out,1,6) = 'CLOSED' OR claim_occurrence_salvage_status_code_out = 'N/A'  or claim_occurrence_salvage_status_code_out = 'NOTICEONLY') AND (SUBSTR(claim_occurrence_other_recovery_status_code_out,1,6) = 'CLOSED' OR claim_occurrence_other_recovery_status_code_out = 'N/A'  or claim_occurrence_other_recovery_status_code_out = 'NOTICEONLY') ), FALSE,   out_claim_occurrence_status_code = 'NOTICEONLY' AND  ( claim_occurrence_direct_loss_status_code_out = 'OPEN' OR  claim_occurrence_direct_loss_status_code_out = 'REOPEN' OR  SUBSTR(claim_occurrence_direct_loss_status_code_out,1,6) = 'CLOSED' OR  claim_occurrence_exp_status_code_out = 'OPEN' OR  claim_occurrence_exp_status_code_out = 'REOPEN' OR  SUBSTR(claim_occurrence_exp_status_code_out,1,6) = 'CLOSED' OR  claim_occurrence_subrogation_status_code_out = 'OPEN' OR  claim_occurrence_subrogation_status_code_out = 'REOPEN' OR  SUBSTR(claim_occurrence_subrogation_status_code_out,1,6) = 'CLOSED' OR  claim_occurrence_salvage_status_code_out = 'OPEN' OR  claim_occurrence_salvage_status_code_out = 'REOPEN' OR  SUBSTR(claim_occurrence_salvage_status_code_out,1,6) = 'CLOSED' OR  claim_occurrence_other_recovery_status_code_out = 'OPEN' OR  claim_occurrence_other_recovery_status_code_out = 'REOPEN' OR  SUBSTR(claim_occurrence_other_recovery_status_code_out,1,6) = 'CLOSED'   ) ,FALSE,  SUBSTR(out_claim_occurrence_status_code,1,6) = 'CLOSED' AND  SUBSTR(claim_occurrence_direct_loss_status_code_out,1,6) <> 'CLOSED' AND  SUBSTR(claim_occurrence_exp_status_code_out,1,6)  <> 'CLOSED' AND  SUBSTR(claim_occurrence_subrogation_status_code_out,1,6) <> 'CLOSED' AND  SUBSTR(claim_occurrence_salvage_status_code_out,1,6)  <> 'CLOSED' AND  SUBSTR(claim_occurrence_other_recovery_status_code_out,1,6)  <> 'CLOSED'  , FALSE,   TRUE)  //---------------------------------------------------------------------------------------------------- \r\n//This expression eliminates any invalid combination of reserve and non-reserve status. \r\n//If CO Status is CLOSED AND if any of the other fin typ code status is either open or reopen then  //filter the row out. \r\n// If CO Status is Open or Reopen AND if any of the other fin typ code status is either open or reopen  //then DON'T filter the row out. \r\n// If CO Status is NOTICEONLY AND all the other fin typ code status also NOTICEONLY or N/A then  //DON'T filter the row out \r\n//If NR Status is Open/Openedinerror/Openwithnofinancial and all fin types are N/A then DON'T filter //If NR Status is Closed and if none of the other fin type status is closed, then filter the row //----------------------------------------------------------------------------------------------------\n),\nLKP_Claim_Occurrence_Dim AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tedw_claim_occurrence_pk_id_out,\n\tedw_claim_occurrence_pk_id,\n\tedw_claim_occurrence_calculation_pk_id_out,\n\tedw_claim_occurrence_calculation_pk_id,\n\tedw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out,\n\tedw_claim_occurrence_reserve_calculation_direct_loss_pk_id,\n\tedw_claim_occurrence_reserve_calculation_exp_pk_id_out,\n\tedw_claim_occurrence_reserve_calculation_exp_pk_id,\n\tedw_claim_occurrence_reserve_calculation_subrogation_pk_id_out,\n\tedw_claim_occurrence_reserve_calculation_subrogation_pk_id,\n\tedw_claim_occurrence_reserve_calculation_salvage_pk_id_out,\n\tedw_claim_occurrence_reserve_calculation_salvage_pk_id,\n\tedw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out,\n\tedw_claim_occurrence_reserve_calculation_other_recovery_pk_id,\n\tclaim_rep_occurrence_id_H,\n\tedw_claim_rep_occurrence_pk_id_prim_claim_rep,\n\tclaim_rep_occurrence_id_E,\n\tedw_claim_rep_occurrence_pk_id_examiner\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_occurrence_dim_id,\n\t\t\tedw_claim_occurrence_pk_id_out,\n\t\t\tedw_claim_occurrence_pk_id,\n\t\t\tedw_claim_occurrence_calculation_pk_id_out,\n\t\t\tedw_claim_occurrence_calculation_pk_id,\n\t\t\tedw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out,\n\t\t\tedw_claim_occurrence_reserve_calculation_direct_loss_pk_id,\n\t\t\tedw_claim_occurrence_reserve_calculation_exp_pk_id_out,\n\t\t\tedw_claim_occurrence_reserve_calculation_exp_pk_id,\n\t\t\tedw_claim_occurrence_reserve_calculation_subrogation_pk_id_out,\n\t\t\tedw_claim_occurrence_reserve_calculation_subrogation_pk_id,\n\t\t\tedw_claim_occurrence_reserve_calculation_salvage_pk_id_out,\n\t\t\tedw_claim_occurrence_reserve_calculation_salvage_pk_id,\n\t\t\tedw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out,\n\t\t\tedw_claim_occurrence_reserve_calculation_other_recovery_pk_id,\n\t\t\tclaim_rep_occurrence_id_H,\n\t\t\tedw_claim_rep_occurrence_pk_id_prim_claim_rep,\n\t\t\tclaim_rep_occurrence_id_E,\n\t\t\tedw_claim_rep_occurrence_pk_id_examiner\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_pk_id,edw_claim_occurrence_calculation_pk_id,edw_claim_occurrence_reserve_calculation_direct_loss_pk_id,edw_claim_occurrence_reserve_calculation_exp_pk_id,edw_claim_occurrence_reserve_calculation_subrogation_pk_id,edw_claim_occurrence_reserve_calculation_salvage_pk_id,edw_claim_occurrence_reserve_calculation_other_recovery_pk_id,edw_claim_rep_occurrence_pk_id_prim_claim_rep,edw_claim_rep_occurrence_pk_id_examiner ORDER BY claim_occurrence_dim_id) = 1\n),\nRTR_Claim_Occurrence_Dim AS (\n\tSELECT\n\tLKP_Claim_Occurrence_Dim.claim_occurrence_dim_id,\n\tFIL_Invalid_Record.edw_claim_occurrence_pk_id_out AS in_edw_claim_occurrence_pk_id,\n\tFIL_Invalid_Record.edw_claim_occurrence_calculation_pk_id_out AS in_edw_claim_occurrence_calculation_pk_id_out,\n\tFIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out,\n\tFIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_exp_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_exp_pk_id_out,\n\tFIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out,\n\tFIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_salvage_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out,\n\tFIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out,\n\tFIL_Invalid_Record.claim_occurrence_key,\n\tFIL_Invalid_Record.out_claim_occurrence_status_code AS claim_occurrence_status_code,\n\tFIL_Invalid_Record.claim_occurrence_direct_loss_status_code_out,\n\tFIL_Invalid_Record.claim_occurrence_exp_status_code_out,\n\tFIL_Invalid_Record.claim_occurrence_subrogation_status_code_out,\n\tFIL_Invalid_Record.claim_occurrence_salvage_status_code_out,\n\tFIL_Invalid_Record.claim_occurrence_other_recovery_status_code_out,\n\tFIL_Invalid_Record.claim_occurrence_wc_cat_code AS claim_occurrence_wc_cat_code_out,\n\tFIL_Invalid_Record.claim_occurrence_reopen_ind_out,\n\tFIL_Invalid_Record.claim_occurrence_financial_ind_out,\n\tFIL_Invalid_Record.claim_occurrence_supplemental_ind_out,\n\tFIL_Invalid_Record.claim_occurrence_recovery_ind_out,\n\tFIL_Invalid_Record.claim_occurrence_notice_only_claim_ind_out,\n\tFIL_Invalid_Record.claim_occurrence_type,\n\tFIL_Invalid_Record.source_claim_occurrence_status_code,\n\tFIL_Invalid_Record.claim_created_by,\n\tFIL_Invalid_Record.s3p_claim_created_date,\n\tFIL_Invalid_Record.source_claim_rpted_date,\n\tFIL_Invalid_Record.rpt_method,\n\tFIL_Invalid_Record.how_claim_rpted,\n\tFIL_Invalid_Record.loss_loc_zip,\n\tFIL_Invalid_Record.loss_loc_state,\n\tFIL_Invalid_Record.loss_loc_county,\n\tFIL_Invalid_Record.loss_loc_city,\n\tFIL_Invalid_Record.loss_loc_addr,\n\tFIL_Invalid_Record.claim_cat_code,\n\tFIL_Invalid_Record.claim_num,\n\tFIL_Invalid_Record.reins_notified_date,\n\tFIL_Invalid_Record.claim_occurrence_num,\n\tFIL_Invalid_Record.claim_violation_citation_descript,\n\tFIL_Invalid_Record.claim_loss_descript,\n\tFIL_Invalid_Record.claim_insd_at_fault_code,\n\tFIL_Invalid_Record.claim_insd_at_fault_code_descript_out AS claim_insd_at_fault_descript,\n\tFIL_Invalid_Record.claim_insd_drvr_num,\n\tFIL_Invalid_Record.claim_insd_drvr_ind,\n\tFIL_Invalid_Record.claim_offset_onset_ind,\n\tFIL_Invalid_Record.err_flag_bal_txn,\n\tFIL_Invalid_Record.err_flag_bal_reins,\n\tFIL_Invalid_Record.source_sys_id,\n\tFIL_Invalid_Record.claim_created_by_key,\n\tFIL_Invalid_Record.claim_log_note_last_act_date,\n\tFIL_Invalid_Record.next_diary_date,\n\tFIL_Invalid_Record.next_diary_date_rep,\n\tFIL_Invalid_Record.claim_rep_role_code_out AS claim_rep_role_code,\n\tFIL_Invalid_Record.claim_rep_role_code_descript_out AS lkp_claim_rep_role_code_descript,\n\tFIL_Invalid_Record.transferred_claim_dvsn_lvl_ind_out_E AS transferred_claim_dvsn_lvl_ind,\n\tFIL_Invalid_Record.transferred_claim_dept_lvl_ind_out_E AS transferred_claim_dept_lvl_ind,\n\tFIL_Invalid_Record.transferred_claim_handling_office_lvl_ind_out_E AS transferred_claim_handling_office_lvl_ind,\n\tFIL_Invalid_Record.transferred_claim_adjuster_lvl_ind_out_E AS transferred_claim_adjuster_lvl_ind,\n\tFIL_Invalid_Record.crrnt_snpsht_flag,\n\tFIL_Invalid_Record.audit_id,\n\tFIL_Invalid_Record.eff_from_date,\n\tFIL_Invalid_Record.eff_to_date,\n\tFIL_Invalid_Record.created_date,\n\tFIL_Invalid_Record.modified_date,\n\tFIL_Invalid_Record.claim_occurrence_ak_id,\n\tFIL_Invalid_Record.claim_loss_date,\n\tFIL_Invalid_Record.claim_discovery_date,\n\tFIL_Invalid_Record.claim_occurrence_reported_date,\n\tFIL_Invalid_Record.claim_open_date,\n\tFIL_Invalid_Record.claim_closed_date,\n\tFIL_Invalid_Record.claim_reopen_date,\n\tFIL_Invalid_Record.claim_closed_after_reopen_date,\n\tFIL_Invalid_Record.claim_notice_only_date,\n\tFIL_Invalid_Record.claim_cat_start_date,\n\tFIL_Invalid_Record.claim_cat_end_date,\n\tFIL_Invalid_Record.transferred_claim_adjuster_lvl_ind_H,\n\tFIL_Invalid_Record.transferred_claim_handling_office_lvl_ind_H,\n\tFIL_Invalid_Record.transferred_claim_dept_lvl_ind_H,\n\tFIL_Invalid_Record.transferred_claim_dvsn_lvl_ind_H,\n\tFIL_Invalid_Record.eff_from_date_E1 AS eff_from_date_E,\n\tFIL_Invalid_Record.eff_to_date_E1 AS eff_to_date_E,\n\tFIL_Invalid_Record.eff_from_date_H1 AS eff_from_date_H,\n\tFIL_Invalid_Record.eff_to_date_H1 AS eff_to_date_H,\n\tFIL_Invalid_Record.claim_rep_occurrence_id_E,\n\tFIL_Invalid_Record.claim_rep_occurrence_id_H,\n\tFIL_Invalid_Record.default_date,\n\tFIL_Invalid_Record.default_NA,\n\tFIL_Invalid_Record.LossLocationStateDescription,\n\tFIL_Invalid_Record.PrimaryWorkGroup,\n\tFIL_Invalid_Record.SecondaryWorkGroup,\n\tFIL_Invalid_Record.ClaimRelationshipKey,\n\tFIL_Invalid_Record.ClaimReportedMethodDescription,\n\tFIL_Invalid_Record.Catalyst,\n\tFIL_Invalid_Record.CauseOfDamage,\n\tFIL_Invalid_Record.DamageCaused,\n\tFIL_Invalid_Record.ItemDamaged\n\tFROM FIL_Invalid_Record\n\tLEFT JOIN LKP_Claim_Occurrence_Dim\n\tON LKP_Claim_Occurrence_Dim.edw_claim_occurrence_pk_id = FIL_Invalid_Record.edw_claim_occurrence_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_calculation_pk_id = FIL_Invalid_Record.edw_claim_occurrence_calculation_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_reserve_calculation_direct_loss_pk_id = FIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_reserve_calculation_exp_pk_id = FIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_exp_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_reserve_calculation_subrogation_pk_id = FIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_reserve_calculation_salvage_pk_id = FIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_salvage_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_occurrence_reserve_calculation_other_recovery_pk_id = FIL_Invalid_Record.edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out AND LKP_Claim_Occurrence_Dim.edw_claim_rep_occurrence_pk_id_prim_claim_rep = FIL_Invalid_Record.claim_rep_occurrence_id_H AND LKP_Claim_Occurrence_Dim.edw_claim_rep_occurrence_pk_id_examiner = FIL_Invalid_Record.claim_rep_occurrence_id_E\n),\nRTR_Claim_Occurrence_Dim_INSERT AS (SELECT * FROM RTR_Claim_Occurrence_Dim WHERE isnull(claim_occurrence_dim_id)),\nRTR_Claim_Occurrence_Dim_DEFAULT1 AS (SELECT * FROM RTR_Claim_Occurrence_Dim WHERE NOT ( (isnull(claim_occurrence_dim_id)) )),\nUPD_Claim_Occurrence_Dim_UPDATE AS (\n\tSELECT\n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id1, \n\tin_edw_claim_occurrence_pk_id AS in_edw_claim_occurrence_pk_id1, \n\tin_edw_claim_occurrence_calculation_pk_id_out AS in_edw_claim_occurrence_calculation_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_exp_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_exp_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out1, \n\tclaim_occurrence_key AS claim_occurrence_key1, \n\tclaim_occurrence_status_code AS claim_occurrence_status_code1, \n\tclaim_occurrence_direct_loss_status_code_out AS claim_occurrence_direct_loss_status_code_out1, \n\tclaim_occurrence_exp_status_code_out AS claim_occurrence_exp_status_code_out1, \n\tclaim_occurrence_subrogation_status_code_out AS claim_occurrence_subrogation_status_code_out1, \n\tclaim_occurrence_salvage_status_code_out AS claim_occurrence_salvage_status_code_out1, \n\tclaim_occurrence_other_recovery_status_code_out AS claim_occurrence_other_recovery_status_code_out1, \n\tclaim_occurrence_wc_cat_code_out AS claim_occurrence_wc_cat_code_out1, \n\tclaim_occurrence_reopen_ind_out AS claim_occurrence_reopen_ind_out1, \n\tclaim_occurrence_financial_ind_out AS claim_occurrence_financial_ind_out1, \n\tclaim_occurrence_supplemental_ind_out AS claim_occurrence_supplemental_ind_out1, \n\tclaim_occurrence_recovery_ind_out AS claim_occurrence_recovery_ind_out1, \n\tclaim_occurrence_notice_only_claim_ind_out AS claim_occurrence_notice_only_claim_ind_out1, \n\tclaim_occurrence_type AS claim_occurrence_type1, \n\tclaim_created_by AS claim_created_by1, \n\tsource_claim_occurrence_status_code, \n\ts3p_claim_created_date AS s3p_claim_created_date1, \n\tsource_claim_rpted_date, \n\trpt_method AS rpt_method1, \n\thow_claim_rpted, \n\tloss_loc_zip AS loss_loc_zip1, \n\tloss_loc_state AS loss_loc_state1, \n\tloss_loc_county AS loss_loc_county1, \n\tloss_loc_city AS loss_loc_city1, \n\tloss_loc_addr AS loss_loc_addr1, \n\tclaim_cat_code AS claim_cat_code1, \n\tclaim_num AS claim_num1, \n\treins_notified_date AS reins_notified_date1, \n\tclaim_occurrence_num AS claim_occurrence_num1, \n\tclaim_violation_citation_descript AS claim_violation_citation_descript1, \n\tclaim_loss_descript AS claim_loss_descript1, \n\tclaim_insd_at_fault_code AS claim_insd_at_fault_code1, \n\tclaim_insd_at_fault_descript, \n\tclaim_insd_drvr_num AS claim_insd_drvr_num1, \n\tclaim_insd_drvr_ind AS claim_insd_drvr_ind1, \n\tclaim_offset_onset_ind AS claim_offset_onset_ind1, \n\terr_flag_bal_txn AS err_flag_bal_txn2, \n\terr_flag_bal_reins AS err_flag_bal_reins2, \n\tclaim_log_note_last_act_date AS claim_log_note_last_act_date1, \n\tnext_diary_date AS next_diary_date1, \n\tnext_diary_date_rep AS next_diary_date_rep1, \n\tclaim_rep_role_code AS claim_rep_role_code1, \n\tlkp_claim_rep_role_code_descript AS lkp_claim_rep_role_code_descript1, \n\ttransferred_claim_dvsn_lvl_ind AS transferred_claim_dvsn_lvl_ind1, \n\ttransferred_claim_dept_lvl_ind AS transferred_claim_dept_lvl_ind1, \n\ttransferred_claim_handling_office_lvl_ind AS transferred_claim_handling_office_lvl_ind1, \n\ttransferred_claim_adjuster_lvl_ind AS transferred_claim_adjuster_lvl_ind1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tclaim_occurrence_ak_id AS claim_occurrence_ak_id1, \n\tclaim_loss_date AS claim_loss_date1, \n\tclaim_discovery_date AS claim_discovery_date1, \n\tclaim_occurrence_reported_date AS claim_occurrence_reported_date1, \n\tclaim_open_date AS claim_open_date1, \n\tclaim_closed_date AS claim_closed_date1, \n\tclaim_reopen_date AS claim_reopen_date1, \n\tclaim_closed_after_reopen_date AS claim_closed_after_reopen_date1, \n\tclaim_notice_only_date AS claim_notice_only_date2, \n\tclaim_cat_start_date AS claim_cat_start_date1, \n\tclaim_cat_end_date AS claim_cat_end_date1, \n\ttransferred_claim_adjuster_lvl_ind_H AS transferred_claim_adjuster_lvl_ind_H1, \n\ttransferred_claim_handling_office_lvl_ind_H AS transferred_claim_handling_office_lvl_ind_H1, \n\ttransferred_claim_dept_lvl_ind_H AS transferred_claim_dept_lvl_ind_H1, \n\ttransferred_claim_dvsn_lvl_ind_H AS transferred_claim_dvsn_lvl_ind_H1, \n\teff_from_date_E AS eff_from_date_E1, \n\teff_to_date_E AS eff_to_date_E1, \n\teff_from_date_H AS eff_from_date_H1, \n\teff_to_date_H AS eff_to_date_H1, \n\tclaim_rep_occurrence_id_E AS claim_rep_occurrence_id_E1, \n\tclaim_rep_occurrence_id_H AS claim_rep_occurrence_id_H1, \n\tdefault_date AS default_date1, \n\tdefault_NA AS default_NA1, \n\tsource_sys_id AS source_sys_id2, \n\tclaim_created_by_key AS claim_created_by_key2, \n\tLossLocationStateDescription AS LossLocationStateDescription2, \n\tPrimaryWorkGroup, \n\tSecondaryWorkGroup, \n\tClaimRelationshipKey, \n\tClaimReportedMethodDescription, \n\tCatalyst, \n\tCauseOfDamage, \n\tDamageCaused, \n\tItemDamaged\n\tFROM RTR_Claim_Occurrence_Dim_DEFAULT1\n),\nClaim_Occurrence_Dim_Update AS (\n\tMERGE INTO claim_occurrence_dim AS T\n\tUSING UPD_Claim_Occurrence_Dim_UPDATE AS S\n\tON T.claim_occurrence_dim_id = S.claim_occurrence_dim_id1\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.edw_claim_occurrence_pk_id = S.in_edw_claim_occurrence_pk_id1, T.edw_claim_occurrence_calculation_pk_id = S.in_edw_claim_occurrence_calculation_pk_id_out1, T.edw_claim_occurrence_reserve_calculation_direct_loss_pk_id = S.in_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out1, T.edw_claim_occurrence_reserve_calculation_exp_pk_id = S.in_edw_claim_occurrence_reserve_calculation_exp_pk_id_out1, T.edw_claim_occurrence_reserve_calculation_subrogation_pk_id = S.in_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out1, T.edw_claim_occurrence_reserve_calculation_salvage_pk_id = S.in_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out1, T.edw_claim_occurrence_reserve_calculation_other_recovery_pk_id = S.in_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out1, T.edw_claim_rep_occurrence_pk_id_prim_claim_rep = S.claim_rep_occurrence_id_H1, T.edw_claim_rep_occurrence_pk_id_examiner = S.claim_rep_occurrence_id_E1, T.edw_claim_occurrence_ak_id = S.claim_occurrence_ak_id1, T.claim_occurrence_key = S.claim_occurrence_key1, T.source_claim_occurrence_status_code = S.source_claim_occurrence_status_code, T.claim_occurrence_status_type = S.claim_occurrence_status_code1, T.claim_occurrence_direct_loss_status_type = S.claim_occurrence_direct_loss_status_code_out1, T.claim_occurrence_exp_status_type = S.claim_occurrence_exp_status_code_out1, T.claim_occurrence_salvage_status_type = S.claim_occurrence_salvage_status_code_out1, T.claim_occurrence_subrogation_status_type = S.claim_occurrence_subrogation_status_code_out1, T.claim_occurrence_other_recovery_status_type = S.claim_occurrence_other_recovery_status_code_out1, T.claim_occurrence_financial_ind = S.claim_occurrence_financial_ind_out1, T.claim_occurrence_supplemental_ind = S.claim_occurrence_supplemental_ind_out1, T.claim_occurrence_recovery_ind = S.claim_occurrence_recovery_ind_out1, T.claim_occurrence_notice_only_claim_ind = S.claim_occurrence_notice_only_claim_ind_out1, T.claim_occurrence_type = S.claim_occurrence_type1, T.rpt_method = S.rpt_method1, T.how_claim_rpted = S.how_claim_rpted, T.claim_scripted_date = S.s3p_claim_created_date1, T.source_claim_rpted_date = S.source_claim_rpted_date, T.claim_rpted_date = S.claim_occurrence_reported_date1, T.loss_loc_zip = S.loss_loc_zip1, T.loss_loc_state = S.loss_loc_state1, T.loss_loc_county = S.loss_loc_county1, T.loss_loc_city = S.loss_loc_city1, T.loss_loc_addr = S.loss_loc_addr1, T.claim_loss_date = S.claim_loss_date1, T.claim_discovery_date = S.claim_discovery_date1, T.claim_open_date = S.claim_open_date1, T.claim_close_date = S.claim_closed_date1, T.claim_reopen_date = S.claim_reopen_date1, T.claim_closed_after_reopen_date = S.claim_closed_after_reopen_date1, T.claim_notice_only_date = S.claim_notice_only_date2, T.claim_cat_code = S.claim_cat_code1, T.claim_cat_start_date = S.claim_cat_start_date1, T.claim_cat_end_date = S.claim_cat_end_date1, T.claim_num = S.claim_num1, T.reins_notified_date = S.reins_notified_date1, T.claim_occurrence_num = S.claim_occurrence_num1, T.claim_violation_citation_descript = S.claim_violation_citation_descript1, T.claim_loss_descript = S.claim_loss_descript1, T.claim_insd_at_fault_code = S.claim_insd_at_fault_code1, T.claim_insd_at_fault_code_descript = S.claim_insd_at_fault_descript, T.claim_insd_driver_num = S.claim_insd_drvr_num1, T.claim_insd_driver_ind = S.claim_insd_drvr_ind1, T.claim_offset_onset_ind = S.claim_offset_onset_ind1, T.claim_log_note_last_act_date = S.claim_log_note_last_act_date1, T.next_diary_date = S.next_diary_date1, T.next_diary_date_rep = S.next_diary_date_rep1, T.prim_claim_rep_assigned_date = S.eff_from_date_H1, T.prim_claim_rep_transferred_claim_dvsn_lvl_ind = S.transferred_claim_dvsn_lvl_ind_H1, T.prim_claim_rep_transferred_claim_dept_lvl_ind = S.transferred_claim_dept_lvl_ind_H1, T.prim_claim_rep_transferred_claim_handling_office_lvl_ind = S.transferred_claim_handling_office_lvl_ind_H1, T.prim_claim_rep_transferred_claim_adjuster_lvl_ind = S.transferred_claim_adjuster_lvl_ind_H1, T.examiner_assigned_date = S.eff_from_date_E1, T.examiner_transferred_claim_dvsn_lvl_ind = S.transferred_claim_dvsn_lvl_ind1, T.examiner_transferred_claim_dept_lvl_ind = S.transferred_claim_dept_lvl_ind1, T.examiner_transferred_claim_handling_office_lvl_ind = S.transferred_claim_handling_office_lvl_ind1, T.examiner_transferred_claim_adjuster_lvl_ind = S.transferred_claim_adjuster_lvl_ind1, T.err_flag_bal_txn = S.err_flag_bal_txn2, T.err_flag_bal_reins = S.err_flag_bal_reins2, T.audit_id = S.audit_id1, T.modified_date = S.modified_date1, T.claim_created_by_key = S.claim_created_by_key2, T.wc_cat_code = S.claim_occurrence_wc_cat_code_out1, T.PrimaryWorkGroup = S.PrimaryWorkGroup, T.SecondaryWorkGroup = S.SecondaryWorkGroup, T.LossLocationStateDescription = S.LossLocationStateDescription2, T.ClaimRelationshipKey = S.ClaimRelationshipKey, T.ClaimReportedMethodDescription = S.ClaimReportedMethodDescription, T.Catalyst = S.Catalyst, T.CauseOfDamage = S.CauseOfDamage, T.DamageCaused = S.DamageCaused, T.ItemDamaged = S.ItemDamaged, T.SourceSystemId = S.source_sys_id2\n),\nUPD_Claim_Occurrence_Dim_INSERT AS (\n\tSELECT\n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id1, \n\tin_edw_claim_occurrence_pk_id AS in_edw_claim_occurrence_pk_id1, \n\tin_edw_claim_occurrence_calculation_pk_id_out AS in_edw_claim_occurrence_calculation_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_exp_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_exp_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out1, \n\tin_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out AS in_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out1, \n\tclaim_occurrence_key AS claim_occurrence_key1, \n\tclaim_occurrence_status_code AS claim_occurrence_status_code1, \n\tclaim_occurrence_direct_loss_status_code_out AS claim_occurrence_direct_loss_status_code_out1, \n\tclaim_occurrence_exp_status_code_out AS claim_occurrence_exp_status_code_out1, \n\tclaim_occurrence_subrogation_status_code_out AS claim_occurrence_subrogation_status_code_out1, \n\tclaim_occurrence_salvage_status_code_out AS claim_occurrence_salvage_status_code_out1, \n\tclaim_occurrence_other_recovery_status_code_out AS claim_occurrence_other_recovery_status_code_out1, \n\tclaim_occurrence_wc_cat_code_out AS claim_occurrence_wc_cat_code_out1, \n\tclaim_occurrence_reopen_ind_out AS claim_occurrence_reopen_ind_out1, \n\tclaim_occurrence_financial_ind_out AS claim_occurrence_financial_ind_out1, \n\tclaim_occurrence_supplemental_ind_out AS claim_occurrence_supplemental_ind_out1, \n\tclaim_occurrence_recovery_ind_out AS claim_occurrence_recovery_ind_out1, \n\tclaim_occurrence_notice_only_claim_ind_out AS claim_occurrence_notice_only_claim_ind_out1, \n\tclaim_occurrence_type AS claim_occurrence_type1, \n\tsource_claim_occurrence_status_code, \n\tclaim_created_by AS claim_created_by1, \n\ts3p_claim_created_date, \n\tsource_claim_rpted_date, \n\trpt_method AS rpt_method1, \n\thow_claim_rpted, \n\tloss_loc_zip AS loss_loc_zip1, \n\tloss_loc_state AS loss_loc_state1, \n\tloss_loc_county AS loss_loc_county1, \n\tloss_loc_city AS loss_loc_city1, \n\tloss_loc_addr AS loss_loc_addr1, \n\tclaim_cat_code AS claim_cat_code1, \n\tclaim_num AS claim_num1, \n\treins_notified_date AS reins_notified_date1, \n\tclaim_occurrence_num AS claim_occurrence_num1, \n\tclaim_violation_citation_descript AS claim_violation_citation_descript1, \n\tclaim_loss_descript AS claim_loss_descript1, \n\tclaim_insd_at_fault_code AS claim_insd_at_fault_code1, \n\tclaim_insd_at_fault_descript, \n\tclaim_insd_drvr_num AS claim_insd_drvr_num1, \n\tclaim_insd_drvr_ind AS claim_insd_drvr_ind1, \n\tclaim_offset_onset_ind AS claim_offset_onset_ind1, \n\terr_flag_bal_txn AS err_flag_bal_txn1, \n\terr_flag_bal_reins AS err_flag_bal_reins1, \n\tsource_sys_id AS source_sys_id1, \n\tclaim_created_by_key AS claim_created_by_key1, \n\tclaim_log_note_last_act_date AS claim_log_note_last_act_date1, \n\tnext_diary_date AS next_diary_date1, \n\tnext_diary_date_rep AS next_diary_date_rep1, \n\ttransferred_claim_dvsn_lvl_ind AS transferred_claim_dvsn_lvl_ind1, \n\ttransferred_claim_dept_lvl_ind AS transferred_claim_dept_lvl_ind1, \n\ttransferred_claim_handling_office_lvl_ind AS transferred_claim_handling_office_lvl_ind1, \n\ttransferred_claim_adjuster_lvl_ind AS transferred_claim_adjuster_lvl_ind1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tclaim_occurrence_ak_id AS claim_occurrence_ak_id1, \n\tclaim_loss_date AS claim_loss_date1, \n\tclaim_discovery_date AS claim_discovery_date1, \n\tclaim_occurrence_reported_date AS claim_occurrence_reported_date1, \n\tclaim_open_date AS claim_open_date1, \n\tclaim_closed_date AS claim_closed_date1, \n\tclaim_reopen_date AS claim_reopen_date1, \n\tclaim_closed_after_reopen_date AS claim_closed_after_reopen_date1, \n\tclaim_notice_only_date AS claim_notice_only_date1, \n\tclaim_cat_start_date AS claim_cat_start_date1, \n\tclaim_cat_end_date AS claim_cat_end_date1, \n\ttransferred_claim_adjuster_lvl_ind_H AS transferred_claim_adjuster_lvl_ind_H1, \n\ttransferred_claim_handling_office_lvl_ind_H AS transferred_claim_handling_office_lvl_ind_H1, \n\ttransferred_claim_dept_lvl_ind_H AS transferred_claim_dept_lvl_ind_H1, \n\ttransferred_claim_dvsn_lvl_ind_H AS transferred_claim_dvsn_lvl_ind_H1, \n\teff_from_date_E AS eff_from_date_E1, \n\teff_to_date_E AS eff_to_date_E1, \n\teff_from_date_H AS eff_from_date_H1, \n\teff_to_date_H AS eff_to_date_H1, \n\tclaim_rep_occurrence_id_E AS claim_rep_occurrence_id_E1, \n\tclaim_rep_occurrence_id_H AS claim_rep_occurrence_id_H1, \n\tdefault_date AS default_date1, \n\tdefault_NA AS default_NA1, \n\tLossLocationStateDescription AS LossLocationStateDescription1, \n\tPrimaryWorkGroup, \n\tSecondaryWorkGroup, \n\tClaimRelationshipKey, \n\tClaimReportedMethodDescription, \n\tCatalyst, \n\tCauseOfDamage, \n\tDamageCaused, \n\tItemDamaged\n\tFROM RTR_Claim_Occurrence_Dim_INSERT\n),\nClaim_Occurrence_Dim_Insert AS (\n\tINSERT INTO claim_occurrence_dim\n\t(edw_claim_occurrence_pk_id, edw_claim_occurrence_calculation_pk_id, edw_claim_occurrence_reserve_calculation_direct_loss_pk_id, edw_claim_occurrence_reserve_calculation_exp_pk_id, edw_claim_occurrence_reserve_calculation_subrogation_pk_id, edw_claim_occurrence_reserve_calculation_salvage_pk_id, edw_claim_occurrence_reserve_calculation_other_recovery_pk_id, edw_claim_rep_occurrence_pk_id_prim_claim_rep, edw_claim_rep_occurrence_pk_id_examiner, edw_claim_occurrence_ak_id, claim_occurrence_key, source_claim_occurrence_status_code, claim_occurrence_status_type, claim_occurrence_direct_loss_status_type, claim_occurrence_exp_status_type, claim_occurrence_salvage_status_type, claim_occurrence_subrogation_status_type, claim_occurrence_other_recovery_status_type, claim_occurrence_financial_ind, claim_occurrence_supplemental_ind, claim_occurrence_recovery_ind, claim_occurrence_notice_only_claim_ind, claim_occurrence_type, rpt_method, how_claim_rpted, claim_scripted_date, source_claim_rpted_date, claim_rpted_date, loss_loc_zip, loss_loc_state, loss_loc_county, loss_loc_city, loss_loc_addr, claim_loss_date, claim_discovery_date, claim_open_date, claim_close_date, claim_reopen_date, claim_closed_after_reopen_date, claim_notice_only_date, claim_cat_code, claim_cat_start_date, claim_cat_end_date, claim_num, reins_notified_date, claim_occurrence_num, claim_violation_citation_descript, claim_loss_descript, claim_insd_at_fault_code, claim_insd_at_fault_code_descript, claim_insd_driver_num, claim_insd_driver_ind, claim_offset_onset_ind, claim_log_note_last_act_date, next_diary_date, next_diary_date_rep, prim_claim_rep_assigned_date, prim_claim_rep_transferred_claim_dvsn_lvl_ind, prim_claim_rep_transferred_claim_dept_lvl_ind, prim_claim_rep_transferred_claim_handling_office_lvl_ind, prim_claim_rep_transferred_claim_adjuster_lvl_ind, examiner_assigned_date, examiner_transferred_claim_dvsn_lvl_ind, examiner_transferred_claim_dept_lvl_ind, examiner_transferred_claim_handling_office_lvl_ind, examiner_transferred_claim_adjuster_lvl_ind, err_flag_bal_txn, err_flag_bal_reins, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, claim_created_by_key, wc_cat_code, PrimaryWorkGroup, SecondaryWorkGroup, LossLocationStateDescription, ClaimRelationshipKey, ClaimReportedMethodDescription, Catalyst, CauseOfDamage, DamageCaused, ItemDamaged, SourceSystemId)\n\tSELECT \n\tin_edw_claim_occurrence_pk_id1 AS EDW_CLAIM_OCCURRENCE_PK_ID, \n\tin_edw_claim_occurrence_calculation_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_CALCULATION_PK_ID, \n\tin_edw_claim_occurrence_reserve_calculation_direct_loss_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_RESERVE_CALCULATION_DIRECT_LOSS_PK_ID, \n\tin_edw_claim_occurrence_reserve_calculation_exp_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_RESERVE_CALCULATION_EXP_PK_ID, \n\tin_edw_claim_occurrence_reserve_calculation_subrogation_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_RESERVE_CALCULATION_SUBROGATION_PK_ID, \n\tin_edw_claim_occurrence_reserve_calculation_salvage_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_RESERVE_CALCULATION_SALVAGE_PK_ID, \n\tin_edw_claim_occurrence_reserve_calculation_other_recovery_pk_id_out1 AS EDW_CLAIM_OCCURRENCE_RESERVE_CALCULATION_OTHER_RECOVERY_PK_ID, \n\tclaim_rep_occurrence_id_H1 AS EDW_CLAIM_REP_OCCURRENCE_PK_ID_PRIM_CLAIM_REP, \n\tclaim_rep_occurrence_id_E1 AS EDW_CLAIM_REP_OCCURRENCE_PK_ID_EXAMINER, \n\tclaim_occurrence_ak_id1 AS EDW_CLAIM_OCCURRENCE_AK_ID, \n\tclaim_occurrence_key1 AS CLAIM_OCCURRENCE_KEY, \n\tSOURCE_CLAIM_OCCURRENCE_STATUS_CODE, \n\tclaim_occurrence_status_code1 AS CLAIM_OCCURRENCE_STATUS_TYPE, \n\tclaim_occurrence_direct_loss_status_code_out1 AS CLAIM_OCCURRENCE_DIRECT_LOSS_STATUS_TYPE, \n\tclaim_occurrence_exp_status_code_out1 AS CLAIM_OCCURRENCE_EXP_STATUS_TYPE, \n\tclaim_occurrence_salvage_status_code_out1 AS CLAIM_OCCURRENCE_SALVAGE_STATUS_TYPE, \n\tclaim_occurrence_subrogation_status_code_out1 AS CLAIM_OCCURRENCE_SUBROGATION_STATUS_TYPE, \n\tclaim_occurrence_other_recovery_status_code_out1 AS CLAIM_OCCURRENCE_OTHER_RECOVERY_STATUS_TYPE, \n\tclaim_occurrence_financial_ind_out1 AS CLAIM_OCCURRENCE_FINANCIAL_IND, \n\tclaim_occurrence_supplemental_ind_out1 AS CLAIM_OCCURRENCE_SUPPLEMENTAL_IND, \n\tclaim_occurrence_recovery_ind_out1 AS CLAIM_OCCURRENCE_RECOVERY_IND, \n\tclaim_occurrence_notice_only_claim_ind_out1 AS CLAIM_OCCURRENCE_NOTICE_ONLY_CLAIM_IND, \n\tclaim_occurrence_type1 AS CLAIM_OCCURRENCE_TYPE, \n\trpt_method1 AS RPT_METHOD, \n\tHOW_CLAIM_RPTED, \n\ts3p_claim_created_date AS CLAIM_SCRIPTED_DATE, \n\tSOURCE_CLAIM_RPTED_DATE, \n\tclaim_occurrence_reported_date1 AS CLAIM_RPTED_DATE, \n\tloss_loc_zip1 AS LOSS_LOC_ZIP, \n\tloss_loc_state1 AS LOSS_LOC_STATE, \n\tloss_loc_county1 AS LOSS_LOC_COUNTY, \n\tloss_loc_city1 AS LOSS_LOC_CITY, \n\tloss_loc_addr1 AS LOSS_LOC_ADDR, \n\tclaim_loss_date1 AS CLAIM_LOSS_DATE, \n\tclaim_discovery_date1 AS CLAIM_DISCOVERY_DATE, \n\tclaim_open_date1 AS CLAIM_OPEN_DATE, \n\tclaim_closed_date1 AS CLAIM_CLOSE_DATE, \n\tclaim_reopen_date1 AS CLAIM_REOPEN_DATE, \n\tclaim_closed_after_reopen_date1 AS CLAIM_CLOSED_AFTER_REOPEN_DATE, \n\tclaim_notice_only_date1 AS CLAIM_NOTICE_ONLY_DATE, \n\tclaim_cat_code1 AS CLAIM_CAT_CODE, \n\tclaim_cat_start_date1 AS CLAIM_CAT_START_DATE, \n\tclaim_cat_end_date1 AS CLAIM_CAT_END_DATE, \n\tclaim_num1 AS CLAIM_NUM, \n\treins_notified_date1 AS REINS_NOTIFIED_DATE, \n\tclaim_occurrence_num1 AS CLAIM_OCCURRENCE_NUM, \n\tclaim_violation_citation_descript1 AS CLAIM_VIOLATION_CITATION_DESCRIPT, \n\tclaim_loss_descript1 AS CLAIM_LOSS_DESCRIPT, \n\tclaim_insd_at_fault_code1 AS CLAIM_INSD_AT_FAULT_CODE, \n\tclaim_insd_at_fault_descript AS CLAIM_INSD_AT_FAULT_CODE_DESCRIPT, \n\tclaim_insd_drvr_num1 AS CLAIM_INSD_DRIVER_NUM, \n\tclaim_insd_drvr_ind1 AS CLAIM_INSD_DRIVER_IND, \n\tclaim_offset_onset_ind1 AS CLAIM_OFFSET_ONSET_IND, \n\tclaim_log_note_last_act_date1 AS CLAIM_LOG_NOTE_LAST_ACT_DATE, \n\tnext_diary_date1 AS NEXT_DIARY_DATE, \n\tnext_diary_date_rep1 AS NEXT_DIARY_DATE_REP, \n\teff_from_date_H1 AS PRIM_CLAIM_REP_ASSIGNED_DATE, \n\ttransferred_claim_dvsn_lvl_ind_H1 AS PRIM_CLAIM_REP_TRANSFERRED_CLAIM_DVSN_LVL_IND, \n\ttransferred_claim_dept_lvl_ind_H1 AS PRIM_CLAIM_REP_TRANSFERRED_CLAIM_DEPT_LVL_IND, \n\ttransferred_claim_handling_office_lvl_ind_H1 AS PRIM_CLAIM_REP_TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND, \n\ttransferred_claim_adjuster_lvl_ind_H1 AS PRIM_CLAIM_REP_TRANSFERRED_CLAIM_ADJUSTER_LVL_IND, \n\teff_from_date_E1 AS EXAMINER_ASSIGNED_DATE, \n\ttransferred_claim_dvsn_lvl_ind1 AS EXAMINER_TRANSFERRED_CLAIM_DVSN_LVL_IND, \n\ttransferred_claim_dept_lvl_ind1 AS EXAMINER_TRANSFERRED_CLAIM_DEPT_LVL_IND, \n\ttransferred_claim_handling_office_lvl_ind1 AS EXAMINER_TRANSFERRED_CLAIM_HANDLING_OFFICE_LVL_IND, \n\ttransferred_claim_adjuster_lvl_ind1 AS EXAMINER_TRANSFERRED_CLAIM_ADJUSTER_LVL_IND, \n\terr_flag_bal_txn1 AS ERR_FLAG_BAL_TXN, \n\terr_flag_bal_reins1 AS ERR_FLAG_BAL_REINS, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tclaim_created_by_key1 AS CLAIM_CREATED_BY_KEY, \n\tclaim_occurrence_wc_cat_code_out1 AS WC_CAT_CODE, \n\tPRIMARYWORKGROUP, \n\tSECONDARYWORKGROUP, \n\tLossLocationStateDescription1 AS LOSSLOCATIONSTATEDESCRIPTION, \n\tCLAIMRELATIONSHIPKEY, \n\tCLAIMREPORTEDMETHODDESCRIPTION, \n\tCATALYST, \n\tCAUSEOFDAMAGE, \n\tDAMAGECAUSED, \n\tITEMDAMAGED, \n\tsource_sys_id1 AS SOURCESYSTEMID\n\tFROM UPD_Claim_Occurrence_Dim_INSERT\n),\nSQ_claim_occurrence AS (\n\tselect  claim_occurrence_id as claim_occurrence_pk_id,\r\n\tclaim_occurrence_ak_id as claim_occurrence_ak_id,\r\n\tnext_diary_date , next_diary_date_rep\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence\r\n\twhere modified_date>'@{pipeline().parameters.SELECTION_START_TS}'\r\n\tand created_date<'@{pipeline().parameters.SELECTION_START_TS}'\n),\nExp_Collect_values AS (\n\tSELECT\n\tclaim_occurrence_id,\n\tclaim_occurrence_ak_id,\n\tnext_diary_date,\n\tnext_diary_date_rep,\n\t1 AS o_crrnt_Flag,\n\tSYSDATE AS O_Modified_date\n\tFROM SQ_claim_occurrence\n),\nlkp_claim_occurrence_dim_diary AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tin_crrnt_flg,\n\tedw_claim_occurrence_ak_id,\n\tedw_claim_occurrence_pk_id,\n\tcrrnt_snpsht_flag\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_occurrence_dim_id,\n\t\t\tin_crrnt_flg,\n\t\t\tedw_claim_occurrence_ak_id,\n\t\t\tedw_claim_occurrence_pk_id,\n\t\t\tcrrnt_snpsht_flag\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,edw_claim_occurrence_pk_id,crrnt_snpsht_flag ORDER BY claim_occurrence_dim_id) = 1\n),\nUPD_Claim_occurrence_dim_diary AS (\n\tSELECT\n\tlkp_claim_occurrence_dim_diary.claim_occurrence_dim_id, \n\tExp_Collect_values.next_diary_date, \n\tExp_Collect_values.next_diary_date_rep, \n\tExp_Collect_values.O_Modified_date AS Modified_date\n\tFROM Exp_Collect_values\n\tLEFT JOIN lkp_claim_occurrence_dim_diary\n\tON lkp_claim_occurrence_dim_diary.edw_claim_occurrence_ak_id = Exp_Collect_values.claim_occurrence_ak_id AND lkp_claim_occurrence_dim_diary.edw_claim_occurrence_pk_id = Exp_Collect_values.claim_occurrence_id AND lkp_claim_occurrence_dim_diary.crrnt_snpsht_flag = Exp_Collect_values.o_crrnt_Flag\n),\nclaim_occurrence_dim_UpdateDiary AS (\n\tMERGE INTO claim_occurrence_dim AS T\n\tUSING UPD_Claim_occurrence_dim_diary AS S\n\tON T.claim_occurrence_dim_id = S.claim_occurrence_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.next_diary_date = S.next_diary_date, T.next_diary_date_rep = S.next_diary_date_rep, T.modified_date = S.Modified_date\n),\nSQ_Claim_Occurrence_Dim AS (\n\tSELECT \r\n\tCLAIM_OCCURRENCE_DIM.CLAIM_OCCURRENCE_DIM_ID, \r\n\tCLAIM_OCCURRENCE_DIM.EFF_FROM_DATE, \r\n\tCLAIM_OCCURRENCE_DIM.EFF_TO_DATE, \r\n\tCLAIM_OCCURRENCE_DIM.EDW_CLAIM_OCCURRENCE_AK_ID \r\n\tFROM\r\n\t@{pipeline().parameters.TARGET_TABLE_OWNER}.CLAIM_OCCURRENCE_DIM CLAIM_OCCURRENCE_DIM\r\n\tWHERE \r\n\tEFF_FROM_DATE <> EFF_TO_DATE AND \r\n\tEXISTS\r\n\t(\r\n\tSELECT 1 FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.CLAIM_OCCURRENCE_DIM CLAIM_OCCURRENCE_DIM2 \r\n\tWHERE CRRNT_SNPSHT_FLAG = 1 AND \r\n\tCLAIM_OCCURRENCE_DIM.EDW_CLAIM_OCCURRENCE_AK_ID = CLAIM_OCCURRENCE_DIM2.EDW_CLAIM_OCCURRENCE_AK_ID\r\n\tGROUP BY CLAIM_OCCURRENCE_DIM2.EDW_CLAIM_OCCURRENCE_AK_ID HAVING COUNT(*) > 1\r\n\t)\r\n\tORDER BY \r\n\tCLAIM_OCCURRENCE_DIM.EDW_CLAIM_OCCURRENCE_AK_ID, CLAIM_OCCURRENCE_DIM.EFF_FROM_DATE DESC\n),\nEXP_Lag_Eff_From_Date AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tedw_claim_occurrence_ak_id,\n\teff_from_date,\n\teff_to_date AS orig_eff_to_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tedw_claim_occurrence_ak_id = v_PREV_ROW_occurrence_key, ADD_TO_DATE(v_PREV_ROW_eff_from_date,'SS',-1),\r\n\t-- \torig_eff_to_date)\n\tDECODE(TRUE,\n\tedw_claim_occurrence_ak_id = v_PREV_ROW_occurrence_key, ADD_TO_DATE(v_PREV_ROW_eff_from_date, 'SS', - 1),\n\torig_eff_to_date) AS v_eff_to_date,\n\tv_eff_to_date AS eff_to_date,\n\teff_from_date AS v_PREV_ROW_eff_from_date,\n\tedw_claim_occurrence_ak_id AS v_PREV_ROW_occurrence_key,\n\tSYSDATE AS modified_date,\n\t0 AS crrnt_snpsht_flag\n\tFROM SQ_Claim_Occurrence_Dim\n),\nFIL_Expired_Row AS (\n\tSELECT\n\tclaim_occurrence_dim_id, \n\torig_eff_to_date, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM EXP_Lag_Eff_From_Date\n\tWHERE orig_eff_to_date <> eff_to_date\n),\nUPD_Eff_To_Date AS (\n\tSELECT\n\tclaim_occurrence_dim_id, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM FIL_Expired_Row\n),\nClaim_Occurrence_Dim_Expire_E AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence_dim AS T\n\tUSING UPD_Eff_To_Date AS S\n\tON T.claim_occurrence_dim_id = S.claim_occurrence_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.eff_to_date = S.eff_to_date, T.modified_date = S.modified_date\n),\nSQ_ClaimStory AS (\n\tselect\r\n\tCOD.claim_occurrence_dim_id as claim_occurrence_dim_id,\r\n\tCS.ClaimOccurrenceKey as ClaimOccurrenceKey,\r\n\tCS.Catalyst as Catalyst,\r\n\tCS.CauseOfDamage as CauseOfDamage,\r\n\tCS.DamageCaused as DamageCaused,\r\n\tCS.ItemDamaged as ItemDamaged,\r\n\tCS.ModifiedDate as ModifiedDate\r\n\tfrom \r\n\t@{pipeline().parameters.SOURCE_DATABASE}.dbo.ClaimStory CS\r\n\tinner join dbo.claim_occurrence_dim COD\r\n\ton CS.ClaimOccurrenceKey=COD.claim_occurrence_key \r\n\t-- and COD.crrnt_snpsht_flag=1  -- all records must update not just current\r\n\twhere   \r\n\t(\r\n\tCOD.Catalyst != CS.Catalyst OR\r\n\tCOD.CauseOfDamage != CS.CauseOfDamage OR\r\n\tCOD.DamageCaused != CS.DamageCaused OR\r\n\tCOD.ItemDamaged != CS.ItemDamaged\r\n\t)\r\n\tand CS.ModifiedDate > '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_claim_story_output AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tClaimOccurrenceKey,\n\tCatalyst,\n\tCauseOfDamage,\n\tDamageCaused,\n\tItemDamaged,\n\tCURRENT_TIMESTAMP AS SessionStartTime,\n\tModifiedDate\n\tFROM SQ_ClaimStory\n),\nUPD_UpdateFourWordStory AS (\n\tSELECT\n\tclaim_occurrence_dim_id, \n\tCatalyst, \n\tCauseOfDamage, \n\tDamageCaused, \n\tItemDamaged, \n\tSessionStartTime\n\tFROM EXP_claim_story_output\n),\nclaim_occurrence_dim_UPDATE_ClaimStory AS (\n\tMERGE INTO claim_occurrence_dim AS T\n\tUSING UPD_UpdateFourWordStory AS S\n\tON T.claim_occurrence_dim_id = S.claim_occurrence_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.modified_date = S.SessionStartTime, T.Catalyst = S.Catalyst, T.CauseOfDamage = S.CauseOfDamage, T.DamageCaused = S.DamageCaused, T.ItemDamaged = S.ItemDamaged\n),"
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604491"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "EXCEED AND PMS"
            },
            "SOURCE_DATABASE": {
                "type": "string",
                "defaultValue": "RPT_EDM"
            },
            "TARGET_DATABASE": {
                "type": "string",
                "defaultValue": "WC_DATA_MART"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}