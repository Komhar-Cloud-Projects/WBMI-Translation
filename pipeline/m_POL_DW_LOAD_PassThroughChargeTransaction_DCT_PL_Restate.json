{
    "name": "m_POL_DW_LOAD_PassThroughChargeTransaction_DCT_PL_Restate",
    "properties": {
        "activities": [
            {
                "name": "m_POL_DW_LOAD_PassThroughChargeTransaction_DCT_PL_Re_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_IncludePassThroughOnly AS (\n\tSELECT\n\tRatedCoverageCode\n\tFROM (\n\t\tselect cc.RatedCoverageCode as RatedCoverageCode \r\n\t\tfrom @{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageSummary CS\r\n\t\tinner join @{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageGroup CG\r\n\t\ton CS.CoverageSummaryId=CG.CoverageSummaryId\r\n\t\tinner join @{pipeline().parameters.TARGET_TABLE_OWNER}.ConformedCoverage CC\r\n\t\ton CG.CoverageGroupId=CC.CoverageGroupId\r\n\t\twhere CS.CoverageSummaryCode='PASSTHRU'\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RatedCoverageCode ORDER BY RatedCoverageCode) = 1\n),\nSQ_WorkDCTPLCoverage AS (\n\tselect  \r\n\tB.PolicySymbol,\r\n\tB.PolicyNumber,\r\n\tB.PolicyVersion,\r\n\tB.TransactionCreatedDate,\r\n\tB.TransactionTypeCode,\r\n\tB.PolicyEffectiveDate,\r\n\tB.MeasureName,\r\n\tB.MeasureDetailCode,\r\n\tB.TransactionAmount,\r\n\tB.FullTermPremium,\r\n\tB.TransactionEffectiveDate,\r\n\tB.TransactionIssueDate,\r\n\tB.TransactionReasonCode,\r\n\tB.CoverageCodeKey,\r\n\tB.CoverageSubCd,\r\n\tB.TransactionExpirationDate,\r\n\tW.CreatedDate,\r\n\tW.IterationId,\r\n\tB.ExtractDate\r\n\tfrom\r\n\t(\r\n\tselect  \r\n\tA.PolicySymbol,\r\n\tA.PolicyNumber,\r\n\tA.PolicyVersion,\r\n\tA.TransactionCreatedDate,\r\n\tA.TransactionTypeCode,\r\n\tA.PolicyEffectiveDate,\r\n\tA.MeasureName,\r\n\tA.MeasureDetailCode,\r\n\tSUM(A.TransactionAmount) AS TransactionAmount,\r\n\tSUM(A.FullTermPremium) AS FullTermPremium,\r\n\tA.TransactionEffectiveDate,\r\n\tA.TransactionIssueDate,\r\n\tA.TransactionReasonCode,\r\n\tA.CoverageCodeKey,\r\n\tA.CoverageSubCd,\r\n\tA.ExtractDate,\r\n\tMAX(A.PolicyExpirationDate) as TransactionExpirationDate\r\n\tfrom \r\n\t(\r\n\tselect distinct P.PolicySymbol,\r\n\tP.PolicyNumber,\r\n\tP.PolicyVersion,\r\n\tP.TransactionCreatedDate,\r\n\tP.TransactionTypeCode,\r\n\tP.PolicyEffectiveDate,\r\n\tC.MeasureName,\r\n\tC.MeasureDetailCode,\r\n\tC.TransactionAmount as TransactionAmount,\r\n\tISNULL(C.FullTermPremium,C.TransactionAmount) as FullTermPremium,\r\n\tC.CoverageKey,\r\n\tC.TransactionEffectiveDate,\r\n\tC.TransactionIssueDate,\r\n\tISNULL(C.TransactionReasonCode,'N/A') TransactionReasonCode,\r\n\tC.CoverageCodeKey,\r\n\tISNULL(C.CoverageSubCd,'') CoverageSubCd\r\n\t,P.PolicyExpirationDate\r\n\t,P.ExtractDate\r\n\tfrom DBO.WorkDCTPLPolicy P\r\n\tinner join DBO.WorkDCTPLCoverage C\r\n\ton P.PolicyKey=C.PolicyKey\r\n\tand P.StartDate=C.StartDate\r\n\twhere C.MeasureName in ('Tax')\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t--\r\n\t) A\r\n\tGROUP BY\r\n\tA.PolicySymbol,\r\n\tA.PolicyNumber,\r\n\tA.PolicyVersion,\r\n\tA.TransactionCreatedDate,\r\n\tA.TransactionTypeCode,\r\n\tA.PolicyEffectiveDate,\r\n\tA.MeasureName,\r\n\tA.MeasureDetailCode,\r\n\tA.TransactionEffectiveDate,\r\n\tA.TransactionIssueDate,\r\n\tA.TransactionReasonCode,\r\n\tA.CoverageCodeKey,\r\n\tA.CoverageSubCd,\r\n\tA.ExtractDate\r\n\thaving SUM(A.TransactionAmount)<>0\r\n\t)B\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkDCTDataRepairPolicy W ON W.PolicyKey = B.PolicyNumber + B.PolicyVersion WHERE W.CreatedDate > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\torder by B.PolicySymbol,B.PolicyNumber,B.PolicyVersion,B.TransactionCreatedDate\n),\nEXP_EvaluatePassThrough AS (\n\tSELECT\n\tPolicySymbol,\n\tPolicyNumber,\n\tPolicyVersion,\n\tTransactionCreatedDate,\n\tTransactionTypeCode,\n\tPolicyEffectiveDate,\n\tMeasureName,\n\tMeasureDetailCode,\n\tTransactionAmount,\n\tFullTermPremium,\n\tTransactionEffectiveDate,\n\tTransactionIssueDate,\n\tTransactionReasonCode,\n\tCoverageCodeKey,\n\tCoverageSubCd,\n\tTransactionExpirationDate,\n\t-- *INF*: :LKP.LKP_INCLUDEPASSTHROUGHONLY(CoverageSubCd)\n\tLKP_INCLUDEPASSTHROUGHONLY_CoverageSubCd.RatedCoverageCode AS v_lkp_RatedCoverageCode,\n\t-- *INF*: IIF(ISNULL(v_lkp_RatedCoverageCode),'0','1')\n\tIFF(v_lkp_RatedCoverageCode IS NULL, '0', '1') AS o_OnluPassThroughFlag,\n\tCreatedDate,\n\tIterationId,\n\tExtractDate\n\tFROM SQ_WorkDCTPLCoverage\n\tLEFT JOIN LKP_INCLUDEPASSTHROUGHONLY LKP_INCLUDEPASSTHROUGHONLY_CoverageSubCd\n\tON LKP_INCLUDEPASSTHROUGHONLY_CoverageSubCd.RatedCoverageCode = CoverageSubCd\n\n),\nFIL_LetOnlyPassThrough AS (\n\tSELECT\n\tPolicySymbol, \n\tPolicyNumber, \n\tPolicyVersion, \n\tTransactionCreatedDate, \n\tTransactionTypeCode, \n\tPolicyEffectiveDate, \n\tMeasureName, \n\tMeasureDetailCode, \n\tTransactionAmount, \n\tFullTermPremium, \n\tTransactionEffectiveDate, \n\tTransactionIssueDate, \n\tTransactionReasonCode, \n\tCoverageCodeKey, \n\tCoverageSubCd, \n\tTransactionExpirationDate, \n\to_OnluPassThroughFlag, \n\tCreatedDate, \n\tIterationId, \n\tExtractDate\n\tFROM EXP_EvaluatePassThrough\n\tWHERE o_OnluPassThroughFlag='1'\n),\nEXP_SourceData AS (\n\tSELECT\n\tPolicySymbol,\n\tPolicyNumber,\n\tPolicyVersion,\n\tTransactionCreatedDate,\n\tTransactionTypeCode,\n\t-- *INF*: Decode(TRUE,\r\n\t-- TransactionTypeCode='New','10',\r\n\t-- TransactionTypeCode='Renew','11',\r\n\t-- TransactionTypeCode='Endorse','12',\r\n\t-- TransactionTypeCode='Reinstate','15',\r\n\t-- TransactionTypeCode='Cancel','20',\r\n\t-- TransactionTypeCode='Reissue','30',\r\n\t-- TransactionTypeCode='Rewrite','31',\r\n\t-- '-1'\r\n\t-- )\n\tDecode(TRUE,\n\tTransactionTypeCode = 'New', '10',\n\tTransactionTypeCode = 'Renew', '11',\n\tTransactionTypeCode = 'Endorse', '12',\n\tTransactionTypeCode = 'Reinstate', '15',\n\tTransactionTypeCode = 'Cancel', '20',\n\tTransactionTypeCode = 'Reissue', '30',\n\tTransactionTypeCode = 'Rewrite', '31',\n\t'-1') AS o_standardTransactiontypeCode,\n\tPolicyEffectiveDate,\n\tMeasureName,\n\tMeasureDetailCode,\n\tTransactionAmount,\n\tFullTermPremium,\n\tTransactionEffectiveDate,\n\tTransactionIssueDate,\n\tTransactionReasonCode,\n\tCoverageCodeKey,\n\tCoverageSubCd,\n\tTransactionExpirationDate,\n\t-- *INF*: IIF(ISNULL(ltrim(rtrim(PolicyVersion))) or Length(ltrim(rtrim(PolicyVersion)))=0 or IS_SPACES(PolicyVersion),'00',PolicyVersion)\n\tIFF(ltrim(rtrim(PolicyVersion)) IS NULL OR Length(ltrim(rtrim(PolicyVersion))) = 0 OR IS_SPACES(PolicyVersion), '00', PolicyVersion) AS v_PolicyVersion,\n\tPolicyNumber || v_PolicyVersion AS v_PolicyKey,\n\tv_PolicyKey AS o_PolicyKey,\n\t-- *INF*: MD5(v_PolicyKey||TO_CHAR(TransactionCreatedDate)||CoverageSubCd)\n\tMD5(v_PolicyKey || TO_CHAR(TransactionCreatedDate) || CoverageSubCd) AS o_PassThroughChargeTransactionHashKey,\n\tCreatedDate,\n\tExtractDate,\n\t-- *INF*: ADD_TO_DATE(ADD_TO_DATE(TRUNC(GREATEST(GREATEST(TransactionCreatedDate,TransactionEffectiveDate),ExtractDate), 'MM'),\r\n\t-- 'MM',1),\r\n\t-- 'SS',-1)\r\n\t-- --- Using the CreatedDate from the WorkDCTDataRepairPolicy table we are determing the AccountingDate\n\tADD_TO_DATE(ADD_TO_DATE(TRUNC(GREATEST(GREATEST(TransactionCreatedDate, TransactionEffectiveDate), ExtractDate), 'MM'), 'MM', 1), 'SS', - 1) AS v_PremiumTransactionBookedDate,\n\t-- *INF*: TRUNC(GREATEST(v_PremiumTransactionBookedDate,CreatedDate), 'MM')\r\n\t-- --- Using the CreatedDate from the WorkDCTDataRepairPolicy table we are determing the AccountingDate\n\tTRUNC(GREATEST(v_PremiumTransactionBookedDate, CreatedDate), 'MM') AS o_PremiumTransactionBookedDate,\n\tIterationId,\n\tIterationId + 1 AS LoadSequence,\n\t'Restate' AS NegateRestateCode\n\tFROM FIL_LetOnlyPassThrough\n),\nLKP_GetPolicyAkId AS (\n\tSELECT\n\tPolicyKey,\n\tPolicyAkID\n\tFROM (\n\t\tselect Distinct P.pol_key as PolicyKey\r\n\t\t,P.pol_ak_id as PolicyAkID\r\n\t\tfrom V2.policy P with (nolock)\r\n\t\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkDCTPLPolicy W with (nolock) on W.PolicyNumber=P.pol_num and P.pol_mod=RIGHT('00'+W.PolicyVersion,2)\r\n\t\twhere P.crrnt_snpsht_flag=1\r\n\t\tand P.source_sys_id='DCT'\r\n\t\torder by P.pol_key--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey ORDER BY PolicyKey) = 1\n),\nLKP_PassThroughChargeTransaction_Restate AS (\n\tSELECT\n\tPassThroughChargeTransactionAKID,\n\tPassThroughChargeTransactionHashKey,\n\tLoadSequence,\n\tNegateRestateCode\n\tFROM (\n\t\tSELECT \n\t\t\tPassThroughChargeTransactionAKID,\n\t\t\tPassThroughChargeTransactionHashKey,\n\t\t\tLoadSequence,\n\t\t\tNegateRestateCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.PassThroughChargeTransaction\n\t\tWHERE CurrentSnapshotFlag = 1 AND SourceSystemID = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PassThroughChargeTransactionHashKey,LoadSequence,NegateRestateCode ORDER BY PassThroughChargeTransactionAKID DESC) = 1\n),\nLKP_SupPassThroughChargeType AS (\n\tSELECT\n\tSupPassThroughChargeTypeID,\n\tDCTTaxCode,\n\tin_CoverageSubCd\n\tFROM (\n\t\tselect \r\n\t\tS.SupPassThroughChargeTypeID as SupPassThroughChargeTypeID \r\n\t\t, S.DCTTaxCode as DCTTaxCode\r\n\t\tfrom @{pipeline().parameters.TARGET_TABLE_OWNER}.SupPassThroughChargeType S\r\n\t\twhere S.CurrentSnapshotFlag=1\r\n\t\tand S.SourceSystemID='DCT'\r\n\t\torder by S.DCTTaxCode--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY DCTTaxCode ORDER BY SupPassThroughChargeTypeID) = 1\n),\nLKP_sup_passthrough_transaction_code AS (\n\tSELECT\n\tsup_prem_trans_code_id,\n\tprem_trans_code,\n\tStandardPremiumTransactionCode\n\tFROM (\n\t\tSELECT \n\t\t\tsup_prem_trans_code_id,\n\t\t\tprem_trans_code,\n\t\t\tStandardPremiumTransactionCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_premium_transaction_code\n\t\tWHERE crrnt_snpsht_flag='1' AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY prem_trans_code,StandardPremiumTransactionCode ORDER BY sup_prem_trans_code_id) = 1\n),\nSEQ_PassThroughChargeTransactionAKID AS (\n\tCREATE SEQUENCE SEQ_PassThroughChargeTransactionAKID\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_PassThroughChargeTransaction AS (\n\tSELECT\n\tSEQ_PassThroughChargeTransactionAKID.NEXTVAL AS in_NEXTVAL,\n\tEXP_SourceData.PolicySymbol,\n\tEXP_SourceData.PolicyNumber,\n\tEXP_SourceData.PolicyVersion,\n\tEXP_SourceData.TransactionCreatedDate,\n\tEXP_SourceData.TransactionTypeCode,\n\tEXP_SourceData.PolicyEffectiveDate,\n\tEXP_SourceData.MeasureName,\n\tEXP_SourceData.MeasureDetailCode,\n\tEXP_SourceData.TransactionAmount,\n\tEXP_SourceData.FullTermPremium AS FullTermPremium1,\n\tEXP_SourceData.TransactionEffectiveDate,\n\tEXP_SourceData.TransactionIssueDate,\n\tEXP_SourceData.TransactionReasonCode,\n\tEXP_SourceData.CoverageCodeKey,\n\tEXP_SourceData.CoverageSubCd,\n\tEXP_SourceData.TransactionExpirationDate,\n\tEXP_SourceData.o_PolicyKey AS PolicyKey,\n\tEXP_SourceData.o_PassThroughChargeTransactionHashKey AS in_PassThroughChargeTransactionHashKey,\n\tEXP_SourceData.o_PremiumTransactionBookedDate AS in_PremiumTransactionBookedDate,\n\tLKP_GetPolicyAkId.PolicyAkID AS lkp_PolicyAkID,\n\tLKP_PassThroughChargeTransaction_Restate.PassThroughChargeTransactionAKID AS lkp_PassThroughChargeTransactionAKID,\n\tLKP_SupPassThroughChargeType.SupPassThroughChargeTypeID AS lkp_SupPassThroughChargeTypeID,\n\t'1' AS CurrentSnapshotFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\tTransactionCreatedDate AS EffectiveDate,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS ExpirationDate,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SourceSystemID,\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate,\n\t0 AS LogicalIndicator,\n\t'1' AS LogicalDeleteFlag,\n\t1 AS DuplicateSequence,\n\tin_PassThroughChargeTransactionHashKey AS PassThroughChargeTransactionHashKey,\n\t-- *INF*: IIF(ISNULL(lkp_PassThroughChargeTransactionAKID),in_NEXTVAL,lkp_PassThroughChargeTransactionAKID )\n\tIFF(lkp_PassThroughChargeTransactionAKID IS NULL, in_NEXTVAL, lkp_PassThroughChargeTransactionAKID) AS PassThroughChargeTransactionAKID,\n\t-1 AS StatisticalCoverageAKID,\n\t-- *INF*: IIF(ISNULL(TransactionTypeCode),'N/A',TransactionTypeCode)\n\tIFF(TransactionTypeCode IS NULL, 'N/A', TransactionTypeCode) AS PassThroughChargeTransactionCode,\n\tTransactionCreatedDate AS PassThroughChargeTransactionEnteredDate,\n\tTransactionEffectiveDate AS PassThroughChargeTransactionEffectiveDate,\n\tTransactionExpirationDate AS PassThroughChargeTransactionExpirationDate,\n\tin_PremiumTransactionBookedDate AS PassThroughChargeTransactionBookedDate,\n\tTransactionAmount AS PassThroughChargeTransactionAmount,\n\t0 AS FullTermPremium,\n\tFullTermPremium1 AS FullTaxAmount,\n\t0 AS TaxPercentageRate,\n\tTransactionReasonCode AS ReasonAmendedCode,\n\tLKP_sup_passthrough_transaction_code.sup_prem_trans_code_id AS PassThroughChargeTransactionCodeId,\n\t-- *INF*: IIF(ISNULL(PassThroughChargeTransactionCodeId),-1,PassThroughChargeTransactionCodeId)\n\tIFF(PassThroughChargeTransactionCodeId IS NULL, - 1, PassThroughChargeTransactionCodeId) AS o_PassThroughTransactionCodeId,\n\t-1 AS RiskLocationAKID,\n\t-- *INF*: IIF(ISNULL(lkp_PolicyAkID),-1,lkp_PolicyAkID)\n\tIFF(lkp_PolicyAkID IS NULL, - 1, lkp_PolicyAkID) AS PolicyAKID,\n\t-1 AS SupLGTLineOfInsuranceID,\n\t-1 AS PolicyCoverageAKID,\n\t-1 AS RatingCoverageAKID,\n\t-1 AS SupSurchargeExemptID,\n\t-- *INF*: IIF(ISNULL(lkp_SupPassThroughChargeTypeID),-1,lkp_SupPassThroughChargeTypeID)\n\tIFF(lkp_SupPassThroughChargeTypeID IS NULL, - 1, lkp_SupPassThroughChargeTypeID) AS SupPassThroughChargeTypeID,\n\t0 AS TotalAnnualPremiumSubjectToTax,\n\t-- *INF*: IIF(ISNULL(CoverageSubCd),'N/A',CoverageSubCd)\n\tIFF(CoverageSubCd IS NULL, 'N/A', CoverageSubCd) AS DCTTaxCode,\n\t'Onset' AS OffsetOnsetCode,\n\tEXP_SourceData.IterationId,\n\tIterationId + 1 AS LoadSequence,\n\tEXP_SourceData.NegateRestateCode,\n\t-- *INF*: IIF(ISNULL(lkp_PassThroughChargeTransactionAKID),1,0)\r\n\t-- -- 1 Do Not Filer\r\n\t-- -- 0 Filter\n\tIFF(lkp_PassThroughChargeTransactionAKID IS NULL, 1, 0) AS FilterFlag\n\tFROM EXP_SourceData\n\tLEFT JOIN LKP_GetPolicyAkId\n\tON LKP_GetPolicyAkId.PolicyKey = EXP_SourceData.o_PolicyKey\n\tLEFT JOIN LKP_PassThroughChargeTransaction_Restate\n\tON LKP_PassThroughChargeTransaction_Restate.PassThroughChargeTransactionHashKey = EXP_SourceData.o_PassThroughChargeTransactionHashKey AND LKP_PassThroughChargeTransaction_Restate.LoadSequence = EXP_SourceData.LoadSequence AND LKP_PassThroughChargeTransaction_Restate.NegateRestateCode = EXP_SourceData.NegateRestateCode\n\tLEFT JOIN LKP_SupPassThroughChargeType\n\tON LKP_SupPassThroughChargeType.DCTTaxCode = EXP_SourceData.CoverageSubCd\n\tLEFT JOIN LKP_sup_passthrough_transaction_code\n\tON LKP_sup_passthrough_transaction_code.prem_trans_code = EXP_SourceData.TransactionTypeCode AND LKP_sup_passthrough_transaction_code.StandardPremiumTransactionCode = EXP_SourceData.o_standardTransactiontypeCode\n),\nFIL_Insert_PassThroughCharge AS (\n\tSELECT\n\tCurrentSnapshotFlag, \n\tAuditID, \n\tEffectiveDate, \n\tExpirationDate, \n\tSourceSystemID, \n\tCreatedDate, \n\tModifiedDate, \n\tLogicalIndicator, \n\tLogicalDeleteFlag, \n\tDuplicateSequence, \n\tPassThroughChargeTransactionHashKey, \n\tPassThroughChargeTransactionAKID, \n\tStatisticalCoverageAKID, \n\tPassThroughChargeTransactionCode, \n\tPassThroughChargeTransactionEnteredDate, \n\tPassThroughChargeTransactionEffectiveDate, \n\tPassThroughChargeTransactionExpirationDate, \n\tPassThroughChargeTransactionBookedDate, \n\tPassThroughChargeTransactionAmount, \n\tFullTermPremium, \n\tFullTaxAmount, \n\tTaxPercentageRate, \n\tReasonAmendedCode, \n\to_PassThroughTransactionCodeId AS PassThroughChargeTransactionCodeId, \n\tRiskLocationAKID, \n\tPolicyAKID, \n\tSupLGTLineOfInsuranceID, \n\tPolicyCoverageAKID, \n\tSupSurchargeExemptID, \n\tSupPassThroughChargeTypeID, \n\tTotalAnnualPremiumSubjectToTax, \n\tDCTTaxCode, \n\tOffsetOnsetCode, \n\tLoadSequence, \n\tNegateRestateCode, \n\tFilterFlag, \n\tRatingCoverageAKID\n\tFROM EXP_PassThroughChargeTransaction\n\tWHERE IIF(FilterFlag='1',TRUE,FALSE)\n),\nPassThroughChargeTransaction AS (\n\tINSERT INTO PassThroughChargeTransaction\n\t(CurrentSnapshotFlag, AuditID, EffectiveDate, ExpirationDate, SourceSystemID, CreatedDate, ModifiedDate, LogicalIndicator, LogicalDeleteFlag, DuplicateSequence, PassThroughChargeTransactionHashKey, PassThroughChargeTransactionAKID, StatisticalCoverageAKID, PassThroughChargeTransactionCode, PassThroughChargeTransactionEnteredDate, PassThroughChargeTransactionEffectiveDate, PassThroughChargeTransactionExpirationDate, PassThroughChargeTransactionBookedDate, PassThroughChargeTransactionAmount, FullTermPremium, FullTaxAmount, TaxPercentageRate, ReasonAmendedCode, PassThroughChargeTransactionCodeId, RiskLocationAKID, PolicyAKID, SupLGTLineOfInsuranceID, PolicyCoverageAKID, SupSurchargeExemptID, SupPassThroughChargeTypeID, TotalAnnualPremiumSubjectToTax, DCTTaxCode, OffsetOnsetCode, LoadSequence, NegateRestateCode, RatingCoverageAKID)\n\tSELECT \n\tCURRENTSNAPSHOTFLAG, \n\tAUDITID, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\tSOURCESYSTEMID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tLOGICALINDICATOR, \n\tLOGICALDELETEFLAG, \n\tDUPLICATESEQUENCE, \n\tPASSTHROUGHCHARGETRANSACTIONHASHKEY, \n\tPASSTHROUGHCHARGETRANSACTIONAKID, \n\tSTATISTICALCOVERAGEAKID, \n\tPASSTHROUGHCHARGETRANSACTIONCODE, \n\tPASSTHROUGHCHARGETRANSACTIONENTEREDDATE, \n\tPASSTHROUGHCHARGETRANSACTIONEFFECTIVEDATE, \n\tPASSTHROUGHCHARGETRANSACTIONEXPIRATIONDATE, \n\tPASSTHROUGHCHARGETRANSACTIONBOOKEDDATE, \n\tPASSTHROUGHCHARGETRANSACTIONAMOUNT, \n\tFULLTERMPREMIUM, \n\tFULLTAXAMOUNT, \n\tTAXPERCENTAGERATE, \n\tREASONAMENDEDCODE, \n\tPASSTHROUGHCHARGETRANSACTIONCODEID, \n\tRISKLOCATIONAKID, \n\tPOLICYAKID, \n\tSUPLGTLINEOFINSURANCEID, \n\tPOLICYCOVERAGEAKID, \n\tSUPSURCHARGEEXEMPTID, \n\tSUPPASSTHROUGHCHARGETYPEID, \n\tTOTALANNUALPREMIUMSUBJECTTOTAX, \n\tDCTTAXCODE, \n\tOFFSETONSETCODE, \n\tLOADSEQUENCE, \n\tNEGATERESTATECODE, \n\tRATINGCOVERAGEAKID\n\tFROM FIL_Insert_PassThroughCharge\n),"
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246337"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "904238"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7597733"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/21/2023 09:21:57"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/28/2023 13:30:42"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Stage_Policy"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Policy"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "dbo"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "dbo"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "DCT"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "WC_STAGE"
            },
            "DBCONNECTION_TARGET_LKP": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Policy"
            },
            "TARGET_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "v2"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": ""
            },
            "WHERE_CLAUSE_RC ": {
                "type": "string",
                "defaultValue": ""
            }
        },
        "folder": {
            "name": "Policy DataWarehouse/"
        },
        "annotations": []
    }
}