{
    "name": "m_CMN_DM_Load_CoverageDetailCommercialPropertyDim",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_DM_Load_CoverageDetailCommercialPropertyDim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_CoverageLimit AS (\n\tSELECT\n\tCoverageLimitValue,\n\tPremiumTransactionID,\n\tCoverageLimitType\n\tFROM (\n\t\tselect pt.PremiumTransactionID as PremiumTransactionID,\r\n\t\tcl.CoverageLimitValue as CoverageLimitValue,\r\n\t\tLTRIM(RTRIM(cl.CoverageLimitType)) as CoverageLimitType \r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageLimit cl\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageLimitBridge clb\r\n\t\ton cl.CoverageLimitId=clb.CoverageLimitId\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction pt\r\n\t\ton pt.PremiumTransactionAKId=clb.PremiumTransactionAKId\r\n\t\tWHERE PT.SourceSystemId='DCT' and ( '@{pipeline().parameters.SELECTION_START_TS}'<='01/01/1800 01:00:00' or \r\n\t\texists ( select 1 \r\n\t\t               from @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT2 \r\n\t\t               where PT2.RatingCoverageAKId=PT.RatingCoverageAKId and PT2.CreatedDate>='@{pipeline().parameters.SELECTION_START_TS}'))\r\n\t\tand cl.CoverageLimitType in ('ResponseExpense','DefenseAndLiability')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PremiumTransactionID,CoverageLimitType ORDER BY CoverageLimitValue) = 1\n),\nLKP_SupISOSpecialCauseOfLossCategory AS (\n\tSELECT\n\tISOSpecialCauseOfLossCategoryDescription,\n\tISOSpecialCauseOfLossCategoryCode\n\tFROM (\n\t\tSELECT \n\t\t\tISOSpecialCauseOfLossCategoryDescription,\n\t\t\tISOSpecialCauseOfLossCategoryCode\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupISOSpecialCauseOfLossCategory\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ISOSpecialCauseOfLossCategoryCode ORDER BY ISOSpecialCauseOfLossCategoryDescription) = 1\n),\nSQ_CoverageDetailCommercialProperty AS (\n\tselect distinct cd.CoverageDetailDimId,\r\n\tcd.EffectiveDate,\r\n\tcd.ExpirationDate,\r\n\tcp.CoverageGuid,\r\n\tcp.IsoFireProtectionCode,\r\n\tcp.MultiLocationCreditFactor,\r\n\tcp.PreferredPropertyFactor,\r\n\tsc.SpecialClassGroupCode,\r\n\tsscg.SpecialClassGroupDescription,\r\n\tcp.PremiumTransactionID,\r\n\t'N/A' as CoverageType\r\n\t,cp.SprinklerFlag\r\n\t,cp.ISOCommercialPropertyCauseofLossGroup\r\n\t,cp.ISOCommercialPropertyRatingGroupCode\r\n\t,cp.ISOSpecialCauseOfLossCategoryCode\r\n\t,cp.RateType\r\n\t,cp.CommercialPropertySpecialClass\r\n\t,cp.SourceSystemID\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialProperty cp\r\n\tjoin @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim cd\r\n\ton cp.PremiumTransactionID=cd.EDWPremiumTransactionPKId\r\n\tand cp.SourceSystemID='PMS'\r\n\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage sc\r\n\ton cp.CoverageGuid=sc.CoverageGUID\r\n\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupSpecialClassGroup sscg\r\n\ton sc.SpecialClassGroupCode=sscg.StandardSpecialClassGroupCode and sscg.SourceSystemId='PMS' and sscg.CurrentSnapshotFlag=1\r\n\tWHERE cd.ModifedDate >='@{pipeline().parameters.SELECTION_START_TS}' \r\n\t@{pipeline().parameters.WHERE_CLAUSE_PMS}\r\n\t\r\n\tunion all\r\n\t\r\n\tselect distinct cd.CoverageDetailDimId,\r\n\tcd.EffectiveDate,\r\n\tcd.ExpirationDate,\r\n\tcp.CoverageGuid,\r\n\tcp.IsoFireProtectionCode,\r\n\tcp.MultiLocationCreditFactor,\r\n\tcp.PreferredPropertyFactor,\r\n\trc.SpecialClassGroupCode,\r\n\tsscg.SpecialClassGroupDescription,\r\n\tcp.PremiumTransactionID,\r\n\trc.CoverageType\r\n\t,cp.SprinklerFlag\r\n\t,cp.ISOCommercialPropertyCauseofLossGroup\r\n\t,cp.ISOCommercialPropertyRatingGroupCode\r\n\t,cp.ISOSpecialCauseOfLossCategoryCode\r\n\t,cp.RateType\r\n\t,cp.CommercialPropertySpecialClass\r\n\t,cp.SourceSystemID\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialProperty cp\r\n\tjoin @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim cd\r\n\ton cp.PremiumTransactionID=cd.EDWPremiumTransactionPKId\r\n\tand cp.SourceSystemID='DCT'\r\n\t/* Added PT and Ratingcoverage Join for DAP-879 and comment CoverageGUID join \r\n\t on cp.CoverageGuid=rc.CoverageGUID\r\n\tand rc.CurrentSnapshotFlag=1*/\r\n\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.Premiumtransaction PT\r\n\ton CD.EDWPremiumTransactionPKId=pt.premiumtransactionid\r\n\tand pt.sourcesystemid='DCT'\r\n\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage rc\r\n\ton pt.ratingcoverageakid=rc.ratingcoverageakid\r\n\tand pt.EffectiveDate=rc.EffectiveDate\r\n\tand rc.sourcesystemid='DCT'\r\n\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupSpecialClassGroup sscg\r\n\ton rc.SpecialClassGroupCode=sscg.StandardSpecialClassGroupCode and sscg.SourceSystemId='DCT' and sscg.CurrentSnapshotFlag=1\r\n\tWHERE cd.ModifedDate >='@{pipeline().parameters.SELECTION_START_TS}' \r\n\t@{pipeline().parameters.WHERE_CLAUSE_DCT}\n),\nEXP_GetMetaData AS (\n\tSELECT\n\tCoverageDetailDimId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tEffectiveDate,\n\tExpirationDate,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\tCoverageGuid,\n\tIsoFireProtectionCode AS i_IsoFireProtectionCode,\n\tMultiLocationCreditFactor,\n\tPreferredPropertyFactor,\n\tSpecialClassGroupCode AS i_SpecialClassGroupCode,\n\tSpecialClassGroupDescription AS i_SpecialClassGroupDescription,\n\t-- *INF*: IIF(ISNULL(i_SpecialClassGroupCode), 'N/A', i_SpecialClassGroupCode)\n\tIFF(i_SpecialClassGroupCode IS NULL, 'N/A', i_SpecialClassGroupCode) AS o_SpecialClassGroupCode,\n\t-- *INF*: IIF(ISNULL(i_SpecialClassGroupDescription), 'N/A', i_SpecialClassGroupDescription)\n\tIFF(i_SpecialClassGroupDescription IS NULL, 'N/A', i_SpecialClassGroupDescription) AS o_SpecialClassGroupDescription,\n\ti_IsoFireProtectionCode AS o_IsoFireProtectionCode,\n\tPremiumTransactionID AS i_PremiumTransactionID,\n\tCoverageType AS i_CoverageType,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_CoverageType)) = 'DataCompromise',:LKP.LKP_COVERAGELIMIT(i_PremiumTransactionID,'ResponseExpense'),'N/A')\n\tIFF(LTRIM(RTRIM(i_CoverageType)) = 'DataCompromise', LKP_COVERAGELIMIT_i_PremiumTransactionID_ResponseExpense.CoverageLimitValue, 'N/A') AS v_ResponseExpenseLimit,\n\t-- *INF*: IIF(ISNULL(v_ResponseExpenseLimit),'N/A',v_ResponseExpenseLimit)\n\tIFF(v_ResponseExpenseLimit IS NULL, 'N/A', v_ResponseExpenseLimit) AS o_ResponseExpenseLimit,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_CoverageType)) = 'DataCompromise',:LKP.LKP_COVERAGELIMIT(i_PremiumTransactionID,'DefenseAndLiability'),'N/A')\n\tIFF(LTRIM(RTRIM(i_CoverageType)) = 'DataCompromise', LKP_COVERAGELIMIT_i_PremiumTransactionID_DefenseAndLiability.CoverageLimitValue, 'N/A') AS v_DefenseAndLiabilityLimit,\n\t-- *INF*: IIF(ISNULL(v_DefenseAndLiabilityLimit),'N/A',v_DefenseAndLiabilityLimit)\n\tIFF(v_DefenseAndLiabilityLimit IS NULL, 'N/A', v_DefenseAndLiabilityLimit) AS o_DefenseAndLiabilityLimit,\n\tSprinklerFlag,\n\tISOCommercialPropertyCauseofLossGroup,\n\tISOCommercialPropertyRatingGroupCode,\n\tISOSpecialCauseOfLossCategoryCode,\n\tRateType,\n\tCommercialPropertySpecialClass,\n\tSourceSystemID\n\tFROM SQ_CoverageDetailCommercialProperty\n\tLEFT JOIN LKP_COVERAGELIMIT LKP_COVERAGELIMIT_i_PremiumTransactionID_ResponseExpense\n\tON LKP_COVERAGELIMIT_i_PremiumTransactionID_ResponseExpense.PremiumTransactionID = i_PremiumTransactionID\n\tAND LKP_COVERAGELIMIT_i_PremiumTransactionID_ResponseExpense.CoverageLimitType = 'ResponseExpense'\n\n\tLEFT JOIN LKP_COVERAGELIMIT LKP_COVERAGELIMIT_i_PremiumTransactionID_DefenseAndLiability\n\tON LKP_COVERAGELIMIT_i_PremiumTransactionID_DefenseAndLiability.PremiumTransactionID = i_PremiumTransactionID\n\tAND LKP_COVERAGELIMIT_i_PremiumTransactionID_DefenseAndLiability.CoverageLimitType = 'DefenseAndLiability'\n\n),\nLKP_CoverageDetailCommercialPropertyDim AS (\n\tSELECT\n\tCoverageDetailDimId,\n\tCoverageGuid,\n\tMultiLocationCreditFactor,\n\tPreferredPropertyCreditFactor,\n\tSpecialClassGroupCode,\n\tSpecialClassGroupDescription,\n\tIsoFireProtectionCode,\n\tEffectiveDate,\n\tExpirationDate,\n\tResponseExpenseLimit,\n\tDefenseAndLiabilityLimit,\n\tISOCommercialPropertyCauseofLossGroup,\n\tISOCommercialPropertyRatingGroupCode,\n\tISOCommercialPropertyRatingGroupDescription,\n\tISOSpecialCauseOfLossCategoryCode,\n\tISOSpecialCauseOfLossCategoryDescription,\n\tRateType,\n\tCommercialPropertySpecialClass,\n\ti_CoverageDetailDimId\n\tFROM (\n\t\tSELECT CDCPD.CoverageGuid as CoverageGuid, CDCPD.MultiLocationCreditFactor as MultiLocationCreditFactor, CDCPD.PreferredPropertyCreditFactor as PreferredPropertyCreditFactor, CDCPD.SpecialClassGroupCode as SpecialClassGroupCode, CDCPD.SpecialClassGroupDescription as SpecialClassGroupDescription, CDCPD.IsoFireProtectionCode as IsoFireProtectionCode, CDCPD.EffectiveDate as EffectiveDate, CDCPD.ExpirationDate as ExpirationDate, CDCPD.ResponseExpenseLimit as ResponseExpenseLimit, CDCPD.DefenseAndLiabilityLimit as DefenseAndLiabilityLimit, CDCPD.ISOCommercialPropertyCauseofLossGroup as ISOCommercialPropertyCauseofLossGroup, CDCPD.ISOCommercialPropertyRatingGroupCode as ISOCommercialPropertyRatingGroupCode, CDCPD.ISOCommercialPropertyRatingGroupDescription as ISOCommercialPropertyRatingGroupDescription, CDCPD.ISOSpecialCauseOfLossCategoryCode as ISOSpecialCauseOfLossCategoryCode, CDCPD.ISOSpecialCauseOfLossCategoryDescription as ISOSpecialCauseOfLossCategoryDescription, CDCPD.RateType as RateType, CDCPD.CommercialPropertySpecialClass as CommercialPropertySpecialClass, CDCPD.CoverageDetailDimId as CoverageDetailDimId \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailCommercialPropertyDim CDCPD\r\n\t\tINNER JOIN  @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim CDD \r\n\t\tON CDCPD.CoverageDetailDimId = CDD.CoverageDetailDimId\r\n\t\tINNER JOIN  @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialProperty CP\r\n\t\tON CP.PremiumTransactionID=CDD.EDWPremiumTransactionPKId \r\n\t\tWHERE CDD.ModifedDate >='@{pipeline().parameters.SELECTION_START_TS}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY CoverageDetailDimId ORDER BY CoverageDetailDimId) = 1\n),\nLKP_SupISOCommercialPropertyRatingGroup AS (\n\tSELECT\n\tISOCommercialPropertyRatingGroupDescription,\n\tISOCommercialPropertyRatingGroupCode\n\tFROM (\n\t\tSELECT \n\t\t\tISOCommercialPropertyRatingGroupDescription,\n\t\t\tISOCommercialPropertyRatingGroupCode\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupISOCommercialPropertyRatingGroup\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ISOCommercialPropertyRatingGroupCode ORDER BY ISOCommercialPropertyRatingGroupDescription) = 1\n),\nEXP_DetectChanges AS (\n\tSELECT\n\tLKP_CoverageDetailCommercialPropertyDim.CoverageDetailDimId AS lkp_CoverageDetailDimId,\n\tLKP_CoverageDetailCommercialPropertyDim.CoverageGuid AS lkp_CoverageGuid,\n\tLKP_CoverageDetailCommercialPropertyDim.MultiLocationCreditFactor AS lkp_MultiLocationCreditFactor,\n\tLKP_CoverageDetailCommercialPropertyDim.PreferredPropertyCreditFactor AS lkp_PreferredPropertyCreditFactor,\n\tLKP_CoverageDetailCommercialPropertyDim.SpecialClassGroupCode AS lkp_SpecialClassGroupCode,\n\tLKP_CoverageDetailCommercialPropertyDim.SpecialClassGroupDescription AS lkp_SpecialClassGroupDescription,\n\tLKP_CoverageDetailCommercialPropertyDim.IsoFireProtectionCode AS lkp_IsoFireProtectionCode,\n\tLKP_CoverageDetailCommercialPropertyDim.EffectiveDate AS lkp_EffectiveDate,\n\tLKP_CoverageDetailCommercialPropertyDim.ExpirationDate AS lkp_ExpirationDate,\n\tLKP_CoverageDetailCommercialPropertyDim.ResponseExpenseLimit AS lkp_ResponseExpenseLimit,\n\tLKP_CoverageDetailCommercialPropertyDim.DefenseAndLiabilityLimit AS lkp_DefenseAndLiabilityLimit,\n\tLKP_CoverageDetailCommercialPropertyDim.ISOCommercialPropertyCauseofLossGroup AS lkp_ISOCommercialPropertyCauseofLossGroup,\n\tLKP_CoverageDetailCommercialPropertyDim.ISOCommercialPropertyRatingGroupCode AS lkp_ISOCommercialPropertyRatingGroupCode,\n\tLKP_CoverageDetailCommercialPropertyDim.ISOCommercialPropertyRatingGroupDescription AS lkp_ISOCommercialPropertyRatingGroupDescription,\n\tLKP_CoverageDetailCommercialPropertyDim.ISOSpecialCauseOfLossCategoryCode AS lkp_ISOSpecialCauseOfLossCategoryCode,\n\tLKP_CoverageDetailCommercialPropertyDim.ISOSpecialCauseOfLossCategoryDescription AS lkp_ISOSpecialCauseOfLossCategoryDescription,\n\tLKP_CoverageDetailCommercialPropertyDim.RateType AS lkp_RateType,\n\tLKP_CoverageDetailCommercialPropertyDim.CommercialPropertySpecialClass AS lkp_CommercialPropertySpecialClass,\n\tEXP_GetMetaData.CoverageDetailDimId,\n\tEXP_GetMetaData.o_AuditId AS AuditId,\n\tEXP_GetMetaData.EffectiveDate,\n\tEXP_GetMetaData.ExpirationDate,\n\tEXP_GetMetaData.o_CreatedDate AS CreatedDate,\n\tEXP_GetMetaData.o_ModifiedDate AS ModifiedDate,\n\tEXP_GetMetaData.CoverageGuid,\n\tEXP_GetMetaData.MultiLocationCreditFactor,\n\tEXP_GetMetaData.PreferredPropertyFactor,\n\tEXP_GetMetaData.o_SpecialClassGroupCode AS SpecialClassGroupCode,\n\tEXP_GetMetaData.o_SpecialClassGroupDescription AS SpecialClassGroupDescription,\n\tEXP_GetMetaData.o_IsoFireProtectionCode AS IsoFireProtectionCode,\n\tEXP_GetMetaData.o_ResponseExpenseLimit AS ResponseExpenseLimit,\n\tEXP_GetMetaData.o_DefenseAndLiabilityLimit AS DefenseAndLiabilityLimit,\n\tEXP_GetMetaData.SprinklerFlag,\n\tEXP_GetMetaData.ISOCommercialPropertyCauseofLossGroup AS i_ISOCommercialPropertyCauseofLossGroup,\n\tEXP_GetMetaData.ISOCommercialPropertyRatingGroupCode AS i_ISOCommercialPropertyRatingGroupCode,\n\tLKP_SupISOCommercialPropertyRatingGroup.ISOCommercialPropertyRatingGroupDescription AS i_ISOCPRatingGroupDescription,\n\tEXP_GetMetaData.ISOSpecialCauseOfLossCategoryCode AS i_ISOSpecialCauseOfLossCategoryCode,\n\tEXP_GetMetaData.RateType AS i_RateType,\n\tEXP_GetMetaData.CommercialPropertySpecialClass AS i_CommercialPropertySpecialClass,\n\tEXP_GetMetaData.SourceSystemID AS i_SourceSystemID,\n\t-- *INF*: IIF(isnull(i_ISOCommercialPropertyCauseofLossGroup),'N/A',i_ISOCommercialPropertyCauseofLossGroup)\n\tIFF(i_ISOCommercialPropertyCauseofLossGroup IS NULL, 'N/A', i_ISOCommercialPropertyCauseofLossGroup) AS v_ISOCommercialPropertyCauseofLossGroup,\n\t-- *INF*: IIF(isnull(i_ISOCommercialPropertyRatingGroupCode),'N/A',i_ISOCommercialPropertyRatingGroupCode)\n\tIFF(i_ISOCommercialPropertyRatingGroupCode IS NULL, 'N/A', i_ISOCommercialPropertyRatingGroupCode) AS v_ISOCommercialPropertyRatingGroupCode,\n\t-- *INF*: IIF(isnull(i_ISOCPRatingGroupDescription),'N/A',i_ISOCPRatingGroupDescription)\n\tIFF(i_ISOCPRatingGroupDescription IS NULL, 'N/A', i_ISOCPRatingGroupDescription) AS v_ISOGeneralLiabilityClassGroupDescription,\n\t-- *INF*: IIF(isnull(i_ISOSpecialCauseOfLossCategoryCode),'N/A',i_ISOSpecialCauseOfLossCategoryCode)\n\tIFF(i_ISOSpecialCauseOfLossCategoryCode IS NULL, 'N/A', i_ISOSpecialCauseOfLossCategoryCode) AS v_ISOSpecialCauseOfLossCategoryCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- i_ISOCommercialPropertyCauseofLossGroup='SCL' and not isnull(:LKP.LKP_SupISOSpecialCauseOfLossCategory(i_ISOSpecialCauseOfLossCategoryCode)),:LKP.LKP_SupISOSpecialCauseOfLossCategory(i_ISOSpecialCauseOfLossCategoryCode),'N/A')\n\tDECODE(TRUE,\n\ti_ISOCommercialPropertyCauseofLossGroup = 'SCL' AND NOT LKP_SUPISOSPECIALCAUSEOFLOSSCATEGORY_i_ISOSpecialCauseOfLossCategoryCode.ISOSpecialCauseOfLossCategoryDescription IS NULL, LKP_SUPISOSPECIALCAUSEOFLOSSCATEGORY_i_ISOSpecialCauseOfLossCategoryCode.ISOSpecialCauseOfLossCategoryDescription,\n\t'N/A') AS v_ISOSpecialCauseOfLossCategoryDescription,\n\t-- *INF*: IIF(isnull(i_RateType),'N/A',i_RateType)\n\tIFF(i_RateType IS NULL, 'N/A', i_RateType) AS v_RateType,\n\t-- *INF*: IIF(isnull(i_CommercialPropertySpecialClass),'N/A',i_CommercialPropertySpecialClass)\n\tIFF(i_CommercialPropertySpecialClass IS NULL, 'N/A', i_CommercialPropertySpecialClass) AS v_CommercialPropertySpecialClass,\n\tv_ISOCommercialPropertyCauseofLossGroup AS o_ISOCommercialPropertyCauseofLossGroup,\n\tv_ISOCommercialPropertyRatingGroupCode AS o_ISOCommercialPropertyRatingGroupCode,\n\tv_ISOGeneralLiabilityClassGroupDescription AS o_ISOGeneralLiabilityClassGroupDescription,\n\tv_ISOSpecialCauseOfLossCategoryCode AS o_ISOSpecialCauseOfLossCategoryCode,\n\tv_ISOSpecialCauseOfLossCategoryDescription AS o_ISOSpecialCauseOfLossCategoryDescription,\n\tv_RateType AS o_RateType,\n\tv_CommercialPropertySpecialClass AS o_CommercialPropertySpecialClass,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(lkp_CoverageDetailDimId),'INSERT',\r\n\t-- lkp_CoverageGuid<>CoverageGuid or lkp_MultiLocationCreditFactor<>MultiLocationCreditFactor or lkp_PreferredPropertyCreditFactor<>PreferredPropertyFactor or lkp_SpecialClassGroupCode<>SpecialClassGroupCode or lkp_SpecialClassGroupDescription<>SpecialClassGroupDescription or lkp_IsoFireProtectionCode<>IsoFireProtectionCode OR lkp_EffectiveDate<>EffectiveDate OR lkp_ExpirationDate<>ExpirationDate OR lkp_ResponseExpenseLimit<>ResponseExpenseLimit OR lkp_DefenseAndLiabilityLimit<>DefenseAndLiabilityLimit\r\n\t--  OR lkp_ISOCommercialPropertyCauseofLossGroup<>v_ISOCommercialPropertyCauseofLossGroup\r\n\t--  OR lkp_ISOCommercialPropertyRatingGroupCode<>v_ISOCommercialPropertyRatingGroupCode\r\n\t--  OR lkp_ISOCommercialPropertyRatingGroupDescription<>lkp_ISOCommercialPropertyRatingGroupDescription\r\n\t--  OR lkp_ISOSpecialCauseOfLossCategoryCode<>v_ISOSpecialCauseOfLossCategoryCode\r\n\t-- OR lkp_ISOSpecialCauseOfLossCategoryDescription<>\r\n\t-- v_ISOSpecialCauseOfLossCategoryDescription\r\n\t--  OR lkp_RateType<>v_RateType\r\n\t--  OR lkp_CommercialPropertySpecialClass<>v_CommercialPropertySpecialClass\r\n\t-- , 'UPDATE',\r\n\t-- 'NOCHANGE'\r\n\t-- )\n\tDECODE(TRUE,\n\tlkp_CoverageDetailDimId IS NULL, 'INSERT',\n\tlkp_CoverageGuid <> CoverageGuid OR lkp_MultiLocationCreditFactor <> MultiLocationCreditFactor OR lkp_PreferredPropertyCreditFactor <> PreferredPropertyFactor OR lkp_SpecialClassGroupCode <> SpecialClassGroupCode OR lkp_SpecialClassGroupDescription <> SpecialClassGroupDescription OR lkp_IsoFireProtectionCode <> IsoFireProtectionCode OR lkp_EffectiveDate <> EffectiveDate OR lkp_ExpirationDate <> ExpirationDate OR lkp_ResponseExpenseLimit <> ResponseExpenseLimit OR lkp_DefenseAndLiabilityLimit <> DefenseAndLiabilityLimit OR lkp_ISOCommercialPropertyCauseofLossGroup <> v_ISOCommercialPropertyCauseofLossGroup OR lkp_ISOCommercialPropertyRatingGroupCode <> v_ISOCommercialPropertyRatingGroupCode OR lkp_ISOCommercialPropertyRatingGroupDescription <> lkp_ISOCommercialPropertyRatingGroupDescription OR lkp_ISOSpecialCauseOfLossCategoryCode <> v_ISOSpecialCauseOfLossCategoryCode OR lkp_ISOSpecialCauseOfLossCategoryDescription <> v_ISOSpecialCauseOfLossCategoryDescription OR lkp_RateType <> v_RateType OR lkp_CommercialPropertySpecialClass <> v_CommercialPropertySpecialClass, 'UPDATE',\n\t'NOCHANGE') AS o_ChangeFlag\n\tFROM EXP_GetMetaData\n\tLEFT JOIN LKP_CoverageDetailCommercialPropertyDim\n\tON LKP_CoverageDetailCommercialPropertyDim.CoverageDetailDimId = EXP_GetMetaData.CoverageDetailDimId\n\tLEFT JOIN LKP_SupISOCommercialPropertyRatingGroup\n\tON LKP_SupISOCommercialPropertyRatingGroup.ISOCommercialPropertyRatingGroupCode = EXP_GetMetaData.ISOCommercialPropertyRatingGroupCode\n\tLEFT JOIN LKP_SUPISOSPECIALCAUSEOFLOSSCATEGORY LKP_SUPISOSPECIALCAUSEOFLOSSCATEGORY_i_ISOSpecialCauseOfLossCategoryCode\n\tON LKP_SUPISOSPECIALCAUSEOFLOSSCATEGORY_i_ISOSpecialCauseOfLossCategoryCode.ISOSpecialCauseOfLossCategoryCode = i_ISOSpecialCauseOfLossCategoryCode\n\n),\nRTR_CoverageDetailCommercialPropertyDim AS (\n\tSELECT\n\to_ChangeFlag AS ChangeFlag,\n\tCoverageDetailDimId,\n\tAuditId,\n\tEffectiveDate,\n\tExpirationDate,\n\tCreatedDate,\n\tModifiedDate,\n\tCoverageGuid,\n\tMultiLocationCreditFactor,\n\tPreferredPropertyFactor,\n\tSpecialClassGroupCode,\n\tSpecialClassGroupDescription,\n\tIsoFireProtectionCode,\n\tResponseExpenseLimit,\n\tDefenseAndLiabilityLimit,\n\to_ISOCommercialPropertyCauseofLossGroup AS ISOCommercialPropertyCauseofLossGroup,\n\to_ISOCommercialPropertyRatingGroupCode AS ISOCommercialPropertyRatingGroupCode,\n\to_ISOGeneralLiabilityClassGroupDescription AS ISOCommercialPropertyRatingGroupDescription,\n\to_ISOSpecialCauseOfLossCategoryCode AS ISOSpecialCauseOfLossCategoryCode,\n\to_ISOSpecialCauseOfLossCategoryDescription AS ISOSpecialCauseOfLossCategoryDescription,\n\to_RateType AS RateType,\n\to_CommercialPropertySpecialClass AS CommercialPropertySpecialClass\n\tFROM EXP_DetectChanges\n),\nRTR_CoverageDetailCommercialPropertyDim_INSERT AS (SELECT * FROM RTR_CoverageDetailCommercialPropertyDim WHERE ChangeFlag='INSERT'),\nRTR_CoverageDetailCommercialPropertyDim_UPDATE AS (SELECT * FROM RTR_CoverageDetailCommercialPropertyDim WHERE ChangeFlag='UPDATE'),\nTGT_CoverageDetailCommercialPropertyDim_INSERT AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailCommercialPropertyDim\n\t(CoverageDetailDimId, AuditId, EffectiveDate, ExpirationDate, CreatedDate, ModifiedDate, CoverageGuid, MultiLocationCreditFactor, PreferredPropertyCreditFactor, SpecialClassGroupCode, SpecialClassGroupDescription, IsoFireProtectionCode, ResponseExpenseLimit, DefenseAndLiabilityLimit, ISOCommercialPropertyCauseofLossGroup, ISOCommercialPropertyRatingGroupCode, ISOCommercialPropertyRatingGroupDescription, ISOSpecialCauseOfLossCategoryCode, ISOSpecialCauseOfLossCategoryDescription, RateType, CommercialPropertySpecialClass)\n\tSELECT \n\tCOVERAGEDETAILDIMID, \n\tAUDITID, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tCOVERAGEGUID, \n\tMULTILOCATIONCREDITFACTOR, \n\tPreferredPropertyFactor AS PREFERREDPROPERTYCREDITFACTOR, \n\tSPECIALCLASSGROUPCODE, \n\tSPECIALCLASSGROUPDESCRIPTION, \n\tISOFIREPROTECTIONCODE, \n\tRESPONSEEXPENSELIMIT, \n\tDEFENSEANDLIABILITYLIMIT, \n\tISOCOMMERCIALPROPERTYCAUSEOFLOSSGROUP, \n\tISOCOMMERCIALPROPERTYRATINGGROUPCODE, \n\tISOCOMMERCIALPROPERTYRATINGGROUPDESCRIPTION, \n\tISOSPECIALCAUSEOFLOSSCATEGORYCODE, \n\tISOSPECIALCAUSEOFLOSSCATEGORYDESCRIPTION, \n\tRATETYPE, \n\tCOMMERCIALPROPERTYSPECIALCLASS\n\tFROM RTR_CoverageDetailCommercialPropertyDim_INSERT\n),\nUPD_Existing AS (\n\tSELECT\n\tCoverageDetailDimId, \n\tAuditId, \n\tEffectiveDate, \n\tExpirationDate, \n\tModifiedDate, \n\tCoverageGuid, \n\tMultiLocationCreditFactor, \n\tPreferredPropertyFactor, \n\tSpecialClassGroupCode, \n\tSpecialClassGroupDescription, \n\tIsoFireProtectionCode, \n\tResponseExpenseLimit, \n\tDefenseAndLiabilityLimit, \n\tISOCommercialPropertyCauseofLossGroup AS ISOCommercialPropertyCauseofLossGroup3, \n\tISOCommercialPropertyRatingGroupCode AS ISOCommercialPropertyRatingGroupCode3, \n\tISOCommercialPropertyRatingGroupDescription AS ISOCommercialPropertyRatingGroupDescription3, \n\tISOSpecialCauseOfLossCategoryCode AS ISOSpecialCauseOfLossCategoryCode3, \n\tISOSpecialCauseOfLossCategoryDescription AS ISOSpecialCauseOfLossCategoryDescription3, \n\tRateType AS RateType3, \n\tCommercialPropertySpecialClass AS CommercialPropertySpecialClass3\n\tFROM RTR_CoverageDetailCommercialPropertyDim_UPDATE\n),\nTGT_CoverageDetailCommercialPropertyDim_UPDATE AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailCommercialPropertyDim AS T\n\tUSING UPD_Existing AS S\n\tON \n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.CoverageDetailDimId = S.CoverageDetailDimId, T.AuditId = S.AuditId, T.EffectiveDate = S.EffectiveDate, T.ExpirationDate = S.ExpirationDate, T.ModifiedDate = S.ModifiedDate, T.CoverageGuid = S.CoverageGuid, T.MultiLocationCreditFactor = S.MultiLocationCreditFactor, T.PreferredPropertyCreditFactor = S.PreferredPropertyFactor, T.SpecialClassGroupCode = S.SpecialClassGroupCode, T.SpecialClassGroupDescription = S.SpecialClassGroupDescription, T.IsoFireProtectionCode = S.IsoFireProtectionCode, T.ResponseExpenseLimit = S.ResponseExpenseLimit, T.DefenseAndLiabilityLimit = S.DefenseAndLiabilityLimit, T.ISOCommercialPropertyCauseofLossGroup = S.ISOCommercialPropertyCauseofLossGroup3, T.ISOCommercialPropertyRatingGroupCode = S.ISOCommercialPropertyRatingGroupCode3, T.ISOCommercialPropertyRatingGroupDescription = S.ISOCommercialPropertyRatingGroupDescription3, T.ISOSpecialCauseOfLossCategoryCode = S.ISOSpecialCauseOfLossCategoryCode3, T.ISOSpecialCauseOfLossCategoryDescription = S.ISOSpecialCauseOfLossCategoryDescription3, T.RateType = S.RateType3, T.CommercialPropertySpecialClass = S.CommercialPropertySpecialClass3\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246503"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905513"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604114"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 01:14:33"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 01:30:27"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_DATA_MART_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "WC_DATA_MART"
            },
            "WHERE_CLAUSE_DCT": {
                "type": "string",
                "defaultValue": ""
            },
            "WHERE_CLAUSE_PMS": {
                "type": "string",
                "defaultValue": ""
            }
        },
        "folder": {
            "name": "Common DataMart/"
        },
        "annotations": []
    }
}