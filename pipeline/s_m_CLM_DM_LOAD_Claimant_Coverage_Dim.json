{
    "name": "s_m_CLM_DM_LOAD_Claimant_Coverage_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claimant_Coverage_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Claimant_Coverage_Sources AS (\n\n------------ PRE SQL ----------\ntruncate table dbo.work_claimant_coverage\r\n\r\ninsert dbo.work_claimant_coverage ( CLAIMANT_COV_DET_AK_ID,\r\n                                                                          EFF_FROM_DATE)\r\nSELECT CLAIMANT_COV_DET_AK_ID,EFF_FROM_DATE FROM DBO.CLAIMANT_COVERAGE_DETAIL\r\nWHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\nUNION\r\nSELECT CLAIMANT_COV_DET_AK_ID,EFF_FROM_DATE FROM DBO.CLAIMANT_COVERAGE_DETAIL_CALCULATION\r\nWHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\r\nUNION\r\nSELECT CLAIMANT_COV_DET_AK_ID,EFF_FROM_DATE FROM DBO.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION\r\nWHERE CREATED_DATE>='@{pipeline().parameters.SELECTION_START_TS}'\n----------------------\n\n\n\tSELECT\r\n\tCOV_DET.CLAIMANT_COV_DET_ID,\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID,\r\n\tRTRIM(COV_DET.S3P_UNIT_TYPE_CODE) AS S3P_UNIT_TYPE_CODE,\r\n\tRTRIM(COV_DET.S3P_WC_CLASS_DESCRIPT) AS S3P_WC_CLASS_DESCRIPT,\r\n\tISNULL(COV_DET.LOC_UNIT_NUM,'N/A') AS LOC_UNIT_NUM,\r\n\tISNULL(COV_DET.SUB_LOC_UNIT_NUM,'N/A') AS SUB_LOC_UNIT_NUM,\r\n\tISNULL(COV_DET.INS_LINE,'N/A') AS INS_LINE,\r\n\tISNULL(COV_DET.RISK_UNIT_GRP,'N/A') AS RISK_UNIT_GRP,\r\n\tISNULL(COV_DET.RISK_UNIT_GRP_SEQ_NUM,'N/A') AS RISK_UNIT_GRP_SEQ_NUM,\r\n\tISNULL(COV_DET.RISK_UNIT,'N/A') AS RISK_UNIT,\r\n\tISNULL(COV_DET.RISK_UNIT_SEQ_NUM,'N/A') AS RISK_UNIT_SEQ_NUM,\r\n\tISNULL(RTRIM(COV_DET.MAJOR_PERIL_CODE),'N/A') AS MAJOR_PERIL_CODE,\r\n\tISNULL(COV_DET.MAJOR_PERIL_SEQ,'N/A') AS MAJOR_PERIL_SEQ,\r\n\tRTRIM(COV_DET.PMS_LOSS_DISABILITY) AS PMS_LOSS_DISABILITY,\r\n\tRTRIM(COV_DET.RESERVE_CTGRY) AS RESERVE_CTGRY,\r\n\tRTRIM(COV_DET.CAUSE_OF_LOSS) AS CAUSE_OF_LOSS,\r\n\tISNULL(COV_DET.PMS_TYPE_BUREAU_CODE,'N/A') AS PMS_TYPE_BUREAU_CODE,\r\n\tCOV_DET.CLAIMANT_COV_EFF_DATE,\r\n\tISNULL(COV_DET.S3P_UNIT_DESCRIPT,'N/A') AS S3P_UNIT_DESCRIPT,\r\n\tISNULL(COV_DET.SPEC_PERS_PROP_USE_CODE,'N/A') AS SPEC_PERS_PROP_USE_CODE,\r\n\tISNULL(COV_DET.PKG_DED_AMT,0) AS PKG_DED_AMT,\r\n\tISNULL(COV_DET.PKG_LMT_AMT,0) AS PKG_LMT_AMT,\r\n\tISNULL(COV_DET.UNIT_VEH_REGISTRATION_STATE_CODE,'N/A') AS UNIT_VEH_REGISTRATION_STATE_CODE,\r\n\tISNULL(COV_DET.UNIT_VEH_STATED_AMT,0) AS UNIT_VEH_STATED_AMT,\r\n\tISNULL(COV_DET.UNIT_DAM_DESCRIPT,'N/A') AS UNIT_DAM_DESCRIPT,\r\n\tISNULL(COV_DET.UNIT_VEH_YR,-1) AS UNIT_VEH_YR,\r\n\tISNULL(COV_DET.UNIT_VEH_MAKE,'N/A') AS UNIT_VEH_MAKE,\r\n\tISNULL(COV_DET.UNIT_VIN_NUM,'N/A') AS UNIT_VIN_NUM,\r\n\tISNULL(COV_DET.AUDIT_ID,-1) AS EDW_CCD_AUDIT_ID,\r\n\tDISTINCT_EFF_FROM_DATES.EFF_FROM_DATE,\r\n\tISNULL(COV_DET.SUPINSURANCELINEID,-1) AS SUPINSURANCELINEID,\r\n\tISNULL(COV_DET.SUP_RISK_UNIT_GRP_ID,-1) AS SUP_RISK_UNIT_GRP_ID,\r\n\tISNULL(COV_DET.SUP_RISK_UNIT_ID,-1) AS SUP_RISK_UNIT_ID,\r\n\tISNULL(COV_DET.SUPMAJORPERILID,-1) AS SUPMAJORPERILID,\r\n\tISNULL(COV_DET.CAUSEOFLOSSID,-1) AS CAUSEOFLOSSID,\r\n\tISNULL(COV_DET.SUPTYPEBUREAUCODEID,-1) AS SUPTYPEBUREAUCODEID,\r\n\tCOV_DET.POLICYSOURCEID,\r\n\tISNULL(COV_DET.COVERAGEFORM,'N/A') AS COVERAGEFORM,\r\n\tISNULL(COV_DET.RISKTYPE,'N/A') AS RISKTYPE,\r\n\tISNULL(COV_DET.COVERAGETYPE,'N/A') AS COVERAGETYPE,\r\n\tISNULL(COV_DET.COVERAGEVERSION,'N/A') AS COVERAGEVERSION,\r\n\tISNULL(COV_DET.CLASSCODE,'N/A') AS CLASSCODE,\r\n\tISNULL(COV_DET.SUBLINECODE,'N/A') AS SUBLINECODE,\r\n\tISNULL(COV_DET.TypeOfLoss,'N/A') AS TypeOfLoss,\r\n\tISNULL(COV_DET.ClaimTypeCategory,'N/A') AS ClaimTypeCategory,\r\n\tISNULL(COV_DET.ClaimTypeGroup,'N/A') AS ClaimTypeGroup,\r\n\tISNULL(COV_DET.SubrogationEligibleIndicator,'N/A') AS SubrogationEligibleIndicator,\r\n\tCOV_CALC.CLAIMANT_COV_DET_CALCULATION_ID,\r\n\tCOV_CALC.CLAIMANT_COV_DATE,\r\n\tCOV_CALC.CLAIMANT_COV_DATE_TYPE,\r\n\tCOV_CALC.CLAIMANT_COV_SUPPLEMENTAL_IND,\r\n\tCOV_CALC.CLAIMANT_COV_FINANCIAL_IND,\r\n\tCOV_CALC.CLAIMANT_COV_RECOVERY_IND,\r\n\tCOV_CALC.CLAIMANT_COV_NOTICE_ONLY_IND,\r\n\tCOV_RES_CALC_D.CLAIMANT_COV_DET_RESERVE_CALCULATION_ID  AS CLAIMANT_COV_DET_RESERVE_CALCULATION_ID_D,\r\n\tCOV_RES_CALC_D.RESERVE_DATE_TYPE AS CLAIMANT_COV_DIRECT_LOSS_STATUS_TYPE,\r\n\tCOV_RES_CALC_E.CLAIMANT_COV_DET_RESERVE_CALCULATION_ID AS CLAIMANT_COV_DET_RESERVE_CALCULATION_ID_E,\r\n\tCOV_RES_CALC_E.RESERVE_DATE_TYPE AS CLAIMANT_COV_EXP_STATUS_TYPE,\r\n\tCOV_RES_CALC_S.CLAIMANT_COV_DET_RESERVE_CALCULATION_ID AS CLAIMANT_COV_DET_RESERVE_CALCULATION_ID_S,\r\n\tCOV_RES_CALC_S.RESERVE_DATE_TYPE AS CLAIMANT_COV_SALVAGE_STATUS_TYPE,\r\n\tCOV_RES_CALC_B.CLAIMANT_COV_DET_RESERVE_CALCULATION_ID AS CLAIMANT_COV_DET_RESERVE_CALCULATION_ID_B,\r\n\tCOV_RES_CALC_B.RESERVE_DATE_TYPE AS CLAIMANT_COV_SUBROGATION_STATUS_TYPE,\r\n\tCOV_RES_CALC_R.CLAIMANT_COV_DET_RESERVE_CALCULATION_ID AS CLAIMANT_COV_DET_RESERVE_CALCULATION_ID_R,\r\n\tCOV_RES_CALC_R.RESERVE_DATE_TYPE AS CLAIMANT_COV_OTHER_RECOVERY_STATUS_TYPE\r\n\tFROM\r\n\tdbo.work_claimant_coverage AS DISTINCT_EFF_FROM_DATES\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL COV_DET\r\n\tON DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_DET.EFF_FROM_DATE AND COV_DET.EFF_TO_DATE\r\n\tAND DISTINCT_EFF_FROM_DATES.CLAIMANT_COV_DET_AK_ID = COV_DET.CLAIMANT_COV_DET_AK_ID\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_CALCULATION COV_CALC\r\n\tON DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_CALC.EFF_FROM_DATE AND COV_CALC.EFF_TO_DATE\r\n\tAND COV_DET.CLAIMANT_COV_DET_AK_ID = COV_CALC.CLAIMANT_COV_DET_AK_ID\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION COV_RES_CALC_D ON\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID = COV_RES_CALC_D.CLAIMANT_COV_DET_AK_ID AND COV_RES_CALC_D.FINANCIAL_TYPE_CODE='D'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_RES_CALC_D.EFF_FROM_DATE AND COV_RES_CALC_D.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION COV_RES_CALC_E ON\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID = COV_RES_CALC_E.CLAIMANT_COV_DET_AK_ID AND COV_RES_CALC_E.FINANCIAL_TYPE_CODE='E'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_RES_CALC_E.EFF_FROM_DATE AND COV_RES_CALC_E.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION COV_RES_CALC_S ON\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID = COV_RES_CALC_S.CLAIMANT_COV_DET_AK_ID AND COV_RES_CALC_S.FINANCIAL_TYPE_CODE='S'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_RES_CALC_S.EFF_FROM_DATE AND COV_RES_CALC_S.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION COV_RES_CALC_B ON\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID = COV_RES_CALC_B.CLAIMANT_COV_DET_AK_ID AND COV_RES_CALC_B.FINANCIAL_TYPE_CODE='B'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_RES_CALC_B.EFF_FROM_DATE AND COV_RES_CALC_B.EFF_TO_DATE\r\n\t\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL_RESERVE_CALCULATION COV_RES_CALC_R ON\r\n\tCOV_DET.CLAIMANT_COV_DET_AK_ID = COV_RES_CALC_R.CLAIMANT_COV_DET_AK_ID AND COV_RES_CALC_R.FINANCIAL_TYPE_CODE='R'\r\n\tAND DISTINCT_EFF_FROM_DATES.EFF_FROM_DATE BETWEEN COV_RES_CALC_R.EFF_FROM_DATE AND COV_RES_CALC_R.EFF_TO_DATE\n),\nLKP_Line_Of_Business AS (\n\tSELECT\n\tline_of_business,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSelect\r\n\t\tP.pms_pol_lob_code as line_of_business,\r\n\t\tCCD.claimant_cov_det_ak_id as claimant_cov_det_ak_id \r\n\t\tfrom \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD, \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO, \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO, \r\n\t\tV2.policy P \r\n\t\twhere \r\n\t\tCCD.claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id and \r\n\t\tCPO.claim_occurrence_ak_id = CO.claim_occurrence_ak_id and \r\n\t\tCO.pol_key = P.pol_key and\r\n\t\tCO.crrnt_snpsht_flag='1' and\r\n\t\tP.crrnt_snpsht_flag='1' and\r\n\t\tCPO.crrnt_snpsht_flag='1' and \r\n\t\tCCD.crrnt_snpsht_flag='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY line_of_business DESC) = 1\n),\nLKP_Sup_Claim_Pms_Loss_Disability AS (\n\tSELECT\n\tloss_disability_descript,\n\tin_pms_loss_disability_code,\n\tloss_disability_code\n\tFROM (\n\t\tSELECT \n\t\t\tloss_disability_descript,\n\t\t\tin_pms_loss_disability_code,\n\t\t\tloss_disability_code\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_pms_loss_disability\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY loss_disability_code ORDER BY loss_disability_descript) = 1\n),\nEXP_Claimant_Coverage_Dim AS (\n\tSELECT\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_id AS in_claimant_cov_det_id,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_id), -1, in_claimant_cov_det_id)\r\n\t-- \n\tIFF(in_claimant_cov_det_id IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_id\n\t) AS claimant_cov_det_id_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_calculation_id AS in_claimant_cov_det_calculation_id,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_calculation_id), -1, in_claimant_cov_det_calculation_id)\n\tIFF(in_claimant_cov_det_calculation_id IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_calculation_id\n\t) AS claimant_cov_det_calculation_id_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_reserve_calculation_id_D AS in_claimant_cov_det_reserve_calculation_id_D,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_reserve_calculation_id_D), -1,in_claimant_cov_det_reserve_calculation_id_D )\n\tIFF(in_claimant_cov_det_reserve_calculation_id_D IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_reserve_calculation_id_D\n\t) AS claimant_cov_det_reserve_calculation_id_D_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_date_type AS in_claimant_cov_date_type,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_date_type) OR in_claimant_cov_date_type = 'N/A','N/A',RTRIM(SUBSTR(in_claimant_cov_date_type,2)))\n\tIFF(in_claimant_cov_date_type IS NULL \n\t\tOR in_claimant_cov_date_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(in_claimant_cov_date_type, 2\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_date_type,\n\tv_claimant_cov_date_type AS claimant_cov_date_type_out1,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_direct_loss_status_type,\n\t-- *INF*: IIF(ISNULL(claimant_cov_direct_loss_status_type) OR claimant_cov_direct_loss_status_type = 'N/A','N/A',\r\n\t-- RTRIM(SUBSTR(claimant_cov_direct_loss_status_type,2)))\n\tIFF(claimant_cov_direct_loss_status_type IS NULL \n\t\tOR claimant_cov_direct_loss_status_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(claimant_cov_direct_loss_status_type, 2\n\t\t\t)\n\t\t)\n\t) AS claimant_cov_direct_loss_status_type_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_reserve_calculation_id_E AS in_claimant_cov_det_reserve_calculation_id_E,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_reserve_calculation_id_E), -1,in_claimant_cov_det_reserve_calculation_id_E )\n\tIFF(in_claimant_cov_det_reserve_calculation_id_E IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_reserve_calculation_id_E\n\t) AS claimant_cov_det_reserve_calculation_id_E_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_exp_status_type,\n\t-- *INF*: IIF(ISNULL(claimant_cov_exp_status_type) OR claimant_cov_exp_status_type = 'N/A','N/A',RTRIM(SUBSTR(claimant_cov_exp_status_type,2)))\n\tIFF(claimant_cov_exp_status_type IS NULL \n\t\tOR claimant_cov_exp_status_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(claimant_cov_exp_status_type, 2\n\t\t\t)\n\t\t)\n\t) AS claimant_cov_exp_status_type_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_reserve_calculation_id_S AS in_claimant_cov_det_reserve_calculation_id_S,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_reserve_calculation_id_S), -1,in_claimant_cov_det_reserve_calculation_id_S )\n\tIFF(in_claimant_cov_det_reserve_calculation_id_S IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_reserve_calculation_id_S\n\t) AS claimant_cov_det_reserve_calculation_id_S_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_salvage_status_type,\n\t-- *INF*: IIF(ISNULL(claimant_cov_salvage_status_type) OR claimant_cov_salvage_status_type = 'N/A','N/A',RTRIM(SUBSTR(claimant_cov_salvage_status_type,2)))\n\tIFF(claimant_cov_salvage_status_type IS NULL \n\t\tOR claimant_cov_salvage_status_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(claimant_cov_salvage_status_type, 2\n\t\t\t)\n\t\t)\n\t) AS claimant_cov_salvage_status_type_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_reserve_calculation_id_B AS in_claimant_cov_det_reserve_calculation_id_B,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_reserve_calculation_id_B), -1, in_claimant_cov_det_reserve_calculation_id_B)\n\tIFF(in_claimant_cov_det_reserve_calculation_id_B IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_reserve_calculation_id_B\n\t) AS claimant_cov_det_reserve_calculation_id_B_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_subgrogation_status_type,\n\t-- *INF*: IIF(ISNULL(claimant_cov_subgrogation_status_type) OR claimant_cov_subgrogation_status_type = 'N/A','N/A',RTRIM(SUBSTR(claimant_cov_subgrogation_status_type,2)))\n\tIFF(claimant_cov_subgrogation_status_type IS NULL \n\t\tOR claimant_cov_subgrogation_status_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(claimant_cov_subgrogation_status_type, 2\n\t\t\t)\n\t\t)\n\t) AS claimant_cov_subgrogation_status_type_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_reserve_calculation_id_R AS in_claimant_cov_det_reserve_calculation_id_R,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_det_reserve_calculation_id_R),-1,in_claimant_cov_det_reserve_calculation_id_R)\n\tIFF(in_claimant_cov_det_reserve_calculation_id_R IS NULL,\n\t\t- 1,\n\t\tin_claimant_cov_det_reserve_calculation_id_R\n\t) AS claimant_cov_det_reserve_calculation_id_R_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_other_recovery_status_type,\n\t-- *INF*: IIF(ISNULL(claimant_cov_other_recovery_status_type) OR claimant_cov_other_recovery_status_type = 'N/A','N/A',RTRIM(SUBSTR(claimant_cov_other_recovery_status_type,2)))\n\tIFF(claimant_cov_other_recovery_status_type IS NULL \n\t\tOR claimant_cov_other_recovery_status_type = 'N/A',\n\t\t'N/A',\n\t\tRTRIM(SUBSTR(claimant_cov_other_recovery_status_type, 2\n\t\t\t)\n\t\t)\n\t) AS claimant_cov_other_recovery_status_type_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_supplemental_ind AS in_claimant_cov_supplemental_ind,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_supplemental_ind) OR in_claimant_cov_supplemental_ind = 'N/A','N/A',in_claimant_cov_supplemental_ind)\n\tIFF(in_claimant_cov_supplemental_ind IS NULL \n\t\tOR in_claimant_cov_supplemental_ind = 'N/A',\n\t\t'N/A',\n\t\tin_claimant_cov_supplemental_ind\n\t) AS claimant_cov_supplemental_ind_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_financial_ind AS in_claimant_cov_financial_ind,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_financial_ind) OR in_claimant_cov_financial_ind = 'N/A'\r\n\t-- ,'N/A',in_claimant_cov_financial_ind)\n\tIFF(in_claimant_cov_financial_ind IS NULL \n\t\tOR in_claimant_cov_financial_ind = 'N/A',\n\t\t'N/A',\n\t\tin_claimant_cov_financial_ind\n\t) AS claimant_cov_financial_ind_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_recovery_ind AS in_claimant_cov_recovery_ind,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_recovery_ind) OR in_claimant_cov_recovery_ind = 'N/A','N/A',in_claimant_cov_recovery_ind)\n\tIFF(in_claimant_cov_recovery_ind IS NULL \n\t\tOR in_claimant_cov_recovery_ind = 'N/A',\n\t\t'N/A',\n\t\tin_claimant_cov_recovery_ind\n\t) AS claimant_cov_recovery_ind_out,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_notice_only_ind AS in_claimant_cov_notice_only_ind,\n\t-- *INF*: IIF(ISNULL(in_claimant_cov_notice_only_ind) OR in_claimant_cov_notice_only_ind = 'N/A','N/A',in_claimant_cov_notice_only_ind)\n\tIFF(in_claimant_cov_notice_only_ind IS NULL \n\t\tOR in_claimant_cov_notice_only_ind = 'N/A',\n\t\t'N/A',\n\t\tin_claimant_cov_notice_only_ind\n\t) AS claimant_cov_notice_only_ind_out,\n\tSQ_Claimant_Coverage_Sources.s3p_wc_class_descript AS i_s3p_wc_class_descript,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_s3p_wc_class_descript))) OR IS_SPACES(LTRIM(RTRIM(i_s3p_wc_class_descript))),'N/A',LTRIM(RTRIM(i_s3p_wc_class_descript)))\n\tIFF(LTRIM(RTRIM(i_s3p_wc_class_descript\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(i_s3p_wc_class_descript\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(i_s3p_wc_class_descript\n\t\t\t)\n\t\t))='',\n\t\t'N/A',\n\t\tLTRIM(RTRIM(i_s3p_wc_class_descript\n\t\t\t)\n\t\t)\n\t) AS o_s3p_wc_class_descript,\n\tLKP_Sup_Claim_Pms_Loss_Disability.in_pms_loss_disability_code,\n\t-- *INF*: IIF(ISNULL(in_pms_loss_disability_code),'N/A',in_pms_loss_disability_code)\n\tIFF(in_pms_loss_disability_code IS NULL,\n\t\t'N/A',\n\t\tin_pms_loss_disability_code\n\t) AS o_pms_loss_disability_code,\n\tLKP_Sup_Claim_Pms_Loss_Disability.loss_disability_descript AS lkp_loss_disability_descript,\n\t-- *INF*: IIF(ISNULL(lkp_loss_disability_descript) OR lkp_loss_disability_descript = 'N/A','N/A',lkp_loss_disability_descript)\n\tIFF(lkp_loss_disability_descript IS NULL \n\t\tOR lkp_loss_disability_descript = 'N/A',\n\t\t'N/A',\n\t\tlkp_loss_disability_descript\n\t) AS loss_disability_descript_out,\n\tSQ_Claimant_Coverage_Sources.s3p_unit_descript AS i_s3p_unit_descript,\n\t-- *INF*: IIF(ISNULL(i_s3p_unit_descript),'N/A',i_s3p_unit_descript)\n\tIFF(i_s3p_unit_descript IS NULL,\n\t\t'N/A',\n\t\ti_s3p_unit_descript\n\t) AS o_s3p_unit_descript,\n\tSQ_Claimant_Coverage_Sources.unit_dam_descript AS i_unit_dam_descript,\n\t-- *INF*: IIF(ISNULL(i_unit_dam_descript),'N/A',i_unit_dam_descript)\n\tIFF(i_unit_dam_descript IS NULL,\n\t\t'N/A',\n\t\ti_unit_dam_descript\n\t) AS o_unit_dam_descript,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_date,\n\t-- *INF*: IIF(ISNULL(v_claimant_cov_date_type),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),IIF(v_claimant_cov_date_type= 'OPEN',claimant_cov_date,TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')))\r\n\t-- \r\n\t-- ---DECODE(TRUE, \r\n\t-- --v_claimant_cov_date_type = 'N/A',TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\r\n\t-- --v_claimant_cov_date_type = 'OPEN',claimant_cov_date,\r\n\t-- --(v_claimant_cov_date_type != 'N/A' OR v_claimant_cov_date_type != 'OPEN' ) AND (claimant_cov_det_ak_id = v_prev_row_claimant_cov_det_ak_id), v_prev_row_claimant_cov_open_date)\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(v_claimant_cov_date_type IS NULL,\n\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIFF(v_claimant_cov_date_type = 'OPEN',\n\t\t\tclaimant_cov_date,\n\t\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_open_date,\n\tv_claimant_cov_open_date AS claimant_cov_open_date,\n\t-- *INF*: IIF(ISNULL(v_claimant_cov_date_type),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),IIF(v_claimant_cov_date_type= 'CLOSED',claimant_cov_date,TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')))\r\n\t-- \r\n\t-- -- DECODE(TRUE, \r\n\t-- -- v_claimant_cov_date_type = 'N/A',TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\r\n\t-- -- v_claimant_cov_date_type = 'CLOSED',claimant_cov_date,\r\n\t-- -- (v_claimant_cov_date_type != 'N/A' OR v_claimant_cov_date_type != 'CLOSED' ) AND (claimant_cov_det_ak_id = v_prev_row_claimant_cov_det_ak_id), v_prev_row_claimant_cov_close_date)\n\tIFF(v_claimant_cov_date_type IS NULL,\n\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIFF(v_claimant_cov_date_type = 'CLOSED',\n\t\t\tclaimant_cov_date,\n\t\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_close_date,\n\tv_claimant_cov_close_date AS claimant_cov_close_date,\n\t-- *INF*: IIF(ISNULL(v_claimant_cov_date_type),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),IIF(v_claimant_cov_date_type= 'REOPEN',claimant_cov_date,TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')))\r\n\t-- \r\n\t-- -- DECODE(TRUE, \r\n\t-- -- v_claimant_cov_date_type = 'N/A',TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\r\n\t-- -- v_claimant_cov_date_type = 'REOPEN',claimant_cov_date,\r\n\t-- -- (v_claimant_cov_date_type != 'N/A' OR v_claimant_cov_date_type != 'REOPEN' ) AND (claimant_cov_det_ak_id = v_prev_row_claimant_cov_det_ak_id), v_prev_row_claimant_cov_reopen_date)\n\tIFF(v_claimant_cov_date_type IS NULL,\n\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIFF(v_claimant_cov_date_type = 'REOPEN',\n\t\t\tclaimant_cov_date,\n\t\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_reopen_date,\n\tv_claimant_cov_reopen_date AS claimant_cov_reopen_date,\n\t-- *INF*: IIF(ISNULL(v_claimant_cov_date_type),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),IIF(v_claimant_cov_date_type= 'CLOSEDAFTERREOPEN',claimant_cov_date,TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')))\r\n\t-- \r\n\t-- -- DECODE(TRUE, \r\n\t-- -- v_claimant_cov_date_type = 'N/A',TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\r\n\t-- -- v_claimant_cov_date_type = 'CLOSEDAFTERREOPEN',claimant_cov_date,\r\n\t-- -- (v_claimant_cov_date_type != 'N/A' OR v_claimant_cov_date_type != 'CLOSEDAFTERREOPEN' ) AND (claimant_cov_det_ak_id = v_prev_row_claimant_cov_det_ak_id), v_prev_row_claimant_cov_closed_after_reopen_date)\r\n\t-- -- \r\n\t-- -- \n\tIFF(v_claimant_cov_date_type IS NULL,\n\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIFF(v_claimant_cov_date_type = 'CLOSEDAFTERREOPEN',\n\t\t\tclaimant_cov_date,\n\t\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_closed_after_reopen_date,\n\tv_claimant_cov_closed_after_reopen_date AS claimant_cov_closed_after_reopen_date,\n\t-- *INF*: IIF(ISNULL(v_claimant_cov_date_type),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),IIF(v_claimant_cov_date_type= 'NOTICEONLY',claimant_cov_date,TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,ISNULL(v_claimant_cov_date_type), TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),\r\n\t--    --                                 v_claimant_cov_date_type = 'N/A',TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),\r\n\t--       --                          v_claimant_cov_date_type= 'NOTICEONLY',claimant_cov_date)\r\n\t-- \r\n\t-- \r\n\t-- -- DECODE(TRUE, \r\n\t-- -- v_claimant_cov_date_type = 'N/A' ,TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\r\n\t-- -- v_claimant_cov_date_type = 'NOTICEONLY',claimant_cov_date,\r\n\t-- -- (v_claimant_cov_date_type != 'N/A' OR v_claimant_cov_date_type != 'NOTICEONLY' ) AND (claimant_cov_det_ak_id = v_prev_row_claimant_cov_det_ak_id), v_prev_row_claimant_cov_noticeonly_date)\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(v_claimant_cov_date_type IS NULL,\n\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIFF(v_claimant_cov_date_type = 'NOTICEONLY',\n\t\t\tclaimant_cov_date,\n\t\t\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t\t)\n\t\t)\n\t) AS v_claimant_cov_noticeonly_date,\n\tv_claimant_cov_noticeonly_date AS claimant_cov_noticeonly_date,\n\t1 AS crrnt_snpsht_flag,\n\t-- *INF*: IIF(EDW_CCD_audit_id < 0 , EDW_CCD_audit_id,@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID})\n\tIFF(EDW_CCD_audit_id < 0,\n\t\tEDW_CCD_audit_id,\n\t\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n\t) AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t) AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'\n\t) AS eff_to_date,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\tSQ_Claimant_Coverage_Sources.s3p_unit_type_code AS i_s3p_unit_type_code,\n\t-- *INF*: IIF(ISNULL(i_s3p_unit_type_code),'N/A',i_s3p_unit_type_code)\n\tIFF(i_s3p_unit_type_code IS NULL,\n\t\t'N/A',\n\t\ti_s3p_unit_type_code\n\t) AS o_s3p_unit_type_code,\n\tSQ_Claimant_Coverage_Sources.reserve_ctgry AS i_pms_reserve_ctgry,\n\t-- *INF*: IIF(ISNULL(i_pms_reserve_ctgry),'N/A',i_pms_reserve_ctgry)\n\tIFF(i_pms_reserve_ctgry IS NULL,\n\t\t'N/A',\n\t\ti_pms_reserve_ctgry\n\t) AS o_pms_reserve_ctgry,\n\tSQ_Claimant_Coverage_Sources.cause_of_loss AS i_pms_loss_cause,\n\t-- *INF*: IIF(ISNULL(i_pms_loss_cause),'N/A',i_pms_loss_cause)\n\tIFF(i_pms_loss_cause IS NULL,\n\t\t'N/A',\n\t\ti_pms_loss_cause\n\t) AS o_pms_loss_cause,\n\tSQ_Claimant_Coverage_Sources.eff_from_date AS new_eff_from_date,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_det_ak_id AS i_claimant_cov_det_ak_id,\n\t-- *INF*: IIF(ISNULL(i_claimant_cov_det_ak_id),-1,i_claimant_cov_det_ak_id)\n\tIFF(i_claimant_cov_det_ak_id IS NULL,\n\t\t- 1,\n\t\ti_claimant_cov_det_ak_id\n\t) AS o_claimant_cov_det_ak_id,\n\tSQ_Claimant_Coverage_Sources.major_peril_code,\n\ti_claimant_cov_det_ak_id AS v_prev_row_claimant_cov_det_ak_id,\n\tv_claimant_cov_open_date AS v_prev_row_claimant_cov_open_date,\n\tv_claimant_cov_close_date AS v_prev_row_claimant_cov_close_date,\n\tv_claimant_cov_reopen_date AS v_prev_row_claimant_cov_reopen_date,\n\tv_claimant_cov_closed_after_reopen_date AS v_prev_row_claimant_cov_closed_after_reopen_date,\n\tv_claimant_cov_noticeonly_date AS v_prev_row_claimant_cov_noticeonly_date,\n\tSQ_Claimant_Coverage_Sources.EDW_CCD_audit_id,\n\tLKP_Line_Of_Business.line_of_business,\n\tSQ_Claimant_Coverage_Sources.CauseOfLossID AS i_CauseOfLossID,\n\t-- *INF*: TO_BIGINT(i_CauseOfLossID)\n\tCAST(i_CauseOfLossID AS BIGINT) AS o_CauseOfLossID,\n\tSQ_Claimant_Coverage_Sources.PolicySourceID,\n\tSQ_Claimant_Coverage_Sources.CoverageForm,\n\tSQ_Claimant_Coverage_Sources.RiskType,\n\tSQ_Claimant_Coverage_Sources.CoverageType,\n\tSQ_Claimant_Coverage_Sources.CoverageVersion,\n\tSQ_Claimant_Coverage_Sources.ClassCode,\n\tSQ_Claimant_Coverage_Sources.SublineCode,\n\tSQ_Claimant_Coverage_Sources.ins_line,\n\tSQ_Claimant_Coverage_Sources.risk_unit_grp,\n\tSQ_Claimant_Coverage_Sources.risk_unit_grp_seq_num,\n\tSQ_Claimant_Coverage_Sources.risk_unit,\n\tSQ_Claimant_Coverage_Sources.risk_unit_seq_num,\n\tSQ_Claimant_Coverage_Sources.SupInsuranceLineID,\n\tSQ_Claimant_Coverage_Sources.SupMajorPerilID,\n\tSQ_Claimant_Coverage_Sources.SupTypeBureauCodeID,\n\tSQ_Claimant_Coverage_Sources.sup_risk_unit_grp_id,\n\tSQ_Claimant_Coverage_Sources.sup_risk_unit_id,\n\tSQ_Claimant_Coverage_Sources.pms_type_bureau_code,\n\tSQ_Claimant_Coverage_Sources.major_peril_seq,\n\tSQ_Claimant_Coverage_Sources.claimant_cov_eff_date AS i_claimant_cov_eff_date,\n\t-- *INF*: IIF(ISNULL(i_claimant_cov_eff_date),TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'),i_claimant_cov_eff_date)\n\tIFF(i_claimant_cov_eff_date IS NULL,\n\t\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\ti_claimant_cov_eff_date\n\t) AS o_claimant_cov_eff_date,\n\tSQ_Claimant_Coverage_Sources.unit_veh_registration_state_code,\n\tSQ_Claimant_Coverage_Sources.unit_vin_num,\n\tSQ_Claimant_Coverage_Sources.unit_veh_stated_amt,\n\tSQ_Claimant_Coverage_Sources.unit_veh_yr,\n\tSQ_Claimant_Coverage_Sources.unit_veh_make,\n\tSQ_Claimant_Coverage_Sources.spec_pers_prop_use_code,\n\tSQ_Claimant_Coverage_Sources.pkg_ded_amt,\n\tSQ_Claimant_Coverage_Sources.pkg_lmt_amt,\n\tSQ_Claimant_Coverage_Sources.loc_unit_num,\n\tSQ_Claimant_Coverage_Sources.sub_loc_unit_num,\n\tSQ_Claimant_Coverage_Sources.TypeOfLoss,\n\tSQ_Claimant_Coverage_Sources.ClaimTypeCategory,\n\tSQ_Claimant_Coverage_Sources.ClaimTypeGroup,\n\tSQ_Claimant_Coverage_Sources.SubrogationEligibleIndicator\n\tFROM SQ_Claimant_Coverage_Sources\n\tLEFT JOIN LKP_Line_Of_Business\n\tON LKP_Line_Of_Business.claimant_cov_det_ak_id = SQ_Claimant_Coverage_Sources.claimant_cov_det_ak_id\n\tLEFT JOIN LKP_Sup_Claim_Pms_Loss_Disability\n\tON LKP_Sup_Claim_Pms_Loss_Disability.loss_disability_code = SQ_Claimant_Coverage_Sources.pms_loss_disability\n),\nEXP_Dup_Flag AS (\n\tSELECT\n\tclaimant_cov_det_id_out,\n\tclaimant_cov_det_calculation_id_out,\n\tclaimant_cov_det_reserve_calculation_id_D_out,\n\tclaimant_cov_det_reserve_calculation_id_E_out,\n\tclaimant_cov_det_reserve_calculation_id_S_out,\n\tclaimant_cov_det_reserve_calculation_id_B_out,\n\tclaimant_cov_det_reserve_calculation_id_R_out,\n\t-- *INF*: DECODE(TRUE,claimant_cov_det_id_out=-1 AND claimant_cov_det_calculation_id_out=-1 AND claimant_cov_det_reserve_calculation_id_D_out=-1 AND claimant_cov_det_reserve_calculation_id_E_out=-1 AND claimant_cov_det_reserve_calculation_id_S_out=-1 AND \r\n\t-- claimant_cov_det_reserve_calculation_id_B_out=-1 AND claimant_cov_det_reserve_calculation_id_R_out=-1,'1','0')\n\tDECODE(TRUE,\n\t\tclaimant_cov_det_id_out = - 1 \n\t\tAND claimant_cov_det_calculation_id_out = - 1 \n\t\tAND claimant_cov_det_reserve_calculation_id_D_out = - 1 \n\t\tAND claimant_cov_det_reserve_calculation_id_E_out = - 1 \n\t\tAND claimant_cov_det_reserve_calculation_id_S_out = - 1 \n\t\tAND claimant_cov_det_reserve_calculation_id_B_out = - 1 \n\t\tAND claimant_cov_det_reserve_calculation_id_R_out = - 1, '1',\n\t\t'0'\n\t) AS Dup_Flag\n\tFROM EXP_Claimant_Coverage_Dim\n),\nFIL_INVALID_COMB_RES_NONRES_STATUS AS (\n\tSELECT\n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_id_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_calculation_id_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_reserve_calculation_id_D_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_date_type_out1 AS claimant_cov_date_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_direct_loss_status_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_reserve_calculation_id_E_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_exp_status_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_reserve_calculation_id_S_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_salvage_status_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_reserve_calculation_id_B_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_subgrogation_status_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_det_reserve_calculation_id_R_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_other_recovery_status_type_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_supplemental_ind_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_financial_ind_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_recovery_ind_out, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_notice_only_ind_out, \n\tEXP_Claimant_Coverage_Dim.o_s3p_wc_class_descript AS s3p_wc_class_descript, \n\tEXP_Claimant_Coverage_Dim.o_pms_loss_disability_code AS in_pms_loss_disability_code, \n\tEXP_Claimant_Coverage_Dim.loss_disability_descript_out, \n\tEXP_Claimant_Coverage_Dim.o_s3p_unit_descript AS s3p_unit_descript, \n\tEXP_Claimant_Coverage_Dim.o_unit_dam_descript AS unit_dam_descript, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_open_date, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_close_date, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_reopen_date, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_closed_after_reopen_date, \n\tEXP_Claimant_Coverage_Dim.claimant_cov_noticeonly_date, \n\tEXP_Claimant_Coverage_Dim.crrnt_snpsht_flag, \n\tEXP_Claimant_Coverage_Dim.audit_id, \n\tEXP_Claimant_Coverage_Dim.eff_to_date, \n\tEXP_Claimant_Coverage_Dim.created_date, \n\tEXP_Claimant_Coverage_Dim.modified_date, \n\tEXP_Claimant_Coverage_Dim.o_s3p_unit_type_code AS s3p_unit_type_code1, \n\tEXP_Claimant_Coverage_Dim.o_pms_reserve_ctgry AS pms_reserve_ctgry, \n\tEXP_Claimant_Coverage_Dim.o_pms_loss_cause AS pms_loss_cause, \n\tEXP_Claimant_Coverage_Dim.new_eff_from_date, \n\tEXP_Claimant_Coverage_Dim.o_claimant_cov_det_ak_id AS claimant_cov_det_ak_id, \n\tEXP_Claimant_Coverage_Dim.major_peril_code, \n\tEXP_Claimant_Coverage_Dim.line_of_business, \n\tEXP_Claimant_Coverage_Dim.o_CauseOfLossID AS CauseOfLossID, \n\tEXP_Claimant_Coverage_Dim.PolicySourceID, \n\tEXP_Claimant_Coverage_Dim.CoverageForm, \n\tEXP_Claimant_Coverage_Dim.RiskType, \n\tEXP_Claimant_Coverage_Dim.CoverageType, \n\tEXP_Claimant_Coverage_Dim.CoverageVersion, \n\tEXP_Claimant_Coverage_Dim.ClassCode, \n\tEXP_Claimant_Coverage_Dim.SublineCode, \n\tEXP_Claimant_Coverage_Dim.ins_line, \n\tEXP_Claimant_Coverage_Dim.risk_unit_grp, \n\tEXP_Claimant_Coverage_Dim.risk_unit_grp_seq_num, \n\tEXP_Claimant_Coverage_Dim.risk_unit, \n\tEXP_Claimant_Coverage_Dim.risk_unit_seq_num, \n\tEXP_Claimant_Coverage_Dim.SupInsuranceLineID, \n\tEXP_Claimant_Coverage_Dim.SupMajorPerilID, \n\tEXP_Claimant_Coverage_Dim.SupTypeBureauCodeID, \n\tEXP_Claimant_Coverage_Dim.sup_risk_unit_grp_id, \n\tEXP_Claimant_Coverage_Dim.sup_risk_unit_id, \n\tEXP_Claimant_Coverage_Dim.pms_type_bureau_code, \n\tEXP_Claimant_Coverage_Dim.major_peril_seq, \n\tEXP_Claimant_Coverage_Dim.o_claimant_cov_eff_date AS claimant_cov_eff_date, \n\tEXP_Claimant_Coverage_Dim.unit_veh_registration_state_code, \n\tEXP_Claimant_Coverage_Dim.unit_vin_num, \n\tEXP_Claimant_Coverage_Dim.unit_veh_stated_amt, \n\tEXP_Claimant_Coverage_Dim.unit_veh_yr, \n\tEXP_Claimant_Coverage_Dim.unit_veh_make, \n\tEXP_Claimant_Coverage_Dim.spec_pers_prop_use_code, \n\tEXP_Claimant_Coverage_Dim.pkg_ded_amt, \n\tEXP_Claimant_Coverage_Dim.pkg_lmt_amt, \n\tEXP_Claimant_Coverage_Dim.loc_unit_num, \n\tEXP_Claimant_Coverage_Dim.sub_loc_unit_num, \n\tEXP_Dup_Flag.Dup_Flag, \n\tEXP_Claimant_Coverage_Dim.TypeOfLoss, \n\tEXP_Claimant_Coverage_Dim.ClaimTypeCategory, \n\tEXP_Claimant_Coverage_Dim.ClaimTypeGroup, \n\tEXP_Claimant_Coverage_Dim.SubrogationEligibleIndicator\n\tFROM EXP_Claimant_Coverage_Dim\n\t -- Manually join with EXP_Dup_Flag\n\tWHERE DECODE(TRUE,\r\nSUBSTR(claimant_cov_date_type_out,1,6) = 'CLOSED' AND \r\n(claimant_cov_direct_loss_status_type_out = 'OPEN' OR\r\nclaimant_cov_exp_status_type_out = 'OPEN' OR\r\nclaimant_cov_subgrogation_status_type_out = 'OPEN' OR\r\nclaimant_cov_salvage_status_type_out = 'OPEN' OR\r\nclaimant_cov_other_recovery_status_type_out = 'OPEN' OR \r\nclaimant_cov_direct_loss_status_type_out = 'REOPEN' OR\r\nclaimant_cov_exp_status_type_out = 'REOPEN' OR\r\nclaimant_cov_subgrogation_status_type_out = 'REOPEN' OR\r\nclaimant_cov_salvage_status_type_out = 'REOPEN' OR\r\nclaimant_cov_other_recovery_status_type_out = 'REOPEN'), FALSE,\r\n\r\n\r\n(SUBSTR(claimant_cov_date_type_out,1,4) = 'OPEN' OR SUBSTR(claimant_cov_date_type_out,1,6) = 'REOPEN' OR SUBSTR(claimant_cov_date_type_out,1,6) = 'CLOSED')\r\nAND\r\n(\r\nSUBSTR(claimant_cov_direct_loss_status_type_out,1,6) = 'N/A' AND\r\nSUBSTR(claimant_cov_exp_status_type_out,1,6) = 'N/A' AND\r\nSUBSTR(claimant_cov_subgrogation_status_type_out,1,6) = 'N/A' AND\r\nSUBSTR(claimant_cov_salvage_status_type_out,1,6) = 'N/A' AND\r\nSUBSTR(claimant_cov_other_recovery_status_type_out,1,6) = 'N/A'\r\n), TRUE,\r\n\r\n\r\n(SUBSTR(claimant_cov_date_type_out,1,4) = 'OPEN' OR SUBSTR(claimant_cov_date_type_out,1,6) = 'REOPEN')\r\nAND\r\n(\r\n(SUBSTR(claimant_cov_direct_loss_status_type_out,1,6) = 'CLOSED' OR claimant_cov_direct_loss_status_type_out = 'N/A'  OR claimant_cov_direct_loss_status_type_out = 'NOTICEONLY')\r\nAND\r\n(SUBSTR(claimant_cov_exp_status_type_out,1,6) = 'CLOSED' OR claimant_cov_exp_status_type_out = 'N/A' OR claimant_cov_exp_status_type_out = 'NOTICEONLY')\r\nAND\r\n(SUBSTR(claimant_cov_subgrogation_status_type_out,1,6) = 'CLOSED' OR claimant_cov_subgrogation_status_type_out = 'N/A' OR claimant_cov_subgrogation_status_type_out = 'NOTICEONLY')\r\nAND\r\n(SUBSTR(claimant_cov_salvage_status_type_out,1,6) = 'CLOSED' OR claimant_cov_salvage_status_type_out = 'N/A' OR claimant_cov_salvage_status_type_out = 'NOTICEONLY')\r\nAND\r\n(SUBSTR(claimant_cov_other_recovery_status_type_out,1,6) = 'CLOSED' OR claimant_cov_other_recovery_status_type_out = 'N/A' OR claimant_cov_other_recovery_status_type_out = 'NOTICEONLY')\r\n), FALSE,\r\n\r\n\r\nclaimant_cov_date_type_out = 'NOTICEONLY' AND \r\n(\r\nclaimant_cov_direct_loss_status_type_out = 'OPEN' OR \r\nclaimant_cov_direct_loss_status_type_out = 'REOPEN' OR \r\nSUBSTR(claimant_cov_direct_loss_status_type_out,1,6) = 'CLOSED' OR \r\nclaimant_cov_exp_status_type_out = 'OPEN' OR \r\nclaimant_cov_exp_status_type_out = 'REOPEN' OR \r\nSUBSTR(claimant_cov_exp_status_type_out,1,6) = 'CLOSED' OR \r\nclaimant_cov_subgrogation_status_type_out = 'OPEN' OR \r\nclaimant_cov_subgrogation_status_type_out = 'REOPEN' OR \r\nSUBSTR(claimant_cov_subgrogation_status_type_out,1,6) = 'CLOSED' OR \r\nclaimant_cov_salvage_status_type_out = 'OPEN' OR \r\nclaimant_cov_salvage_status_type_out = 'REOPEN' OR \r\nSUBSTR(claimant_cov_salvage_status_type_out,1,6) = 'CLOSED' OR \r\nclaimant_cov_other_recovery_status_type_out = 'OPEN' OR \r\nclaimant_cov_other_recovery_status_type_out = 'REOPEN' OR \r\nSUBSTR(claimant_cov_other_recovery_status_type_out,1,6) = 'CLOSED'  \r\n)\r\n,FALSE,\r\n\r\nSUBSTR(claimant_cov_date_type_out,1,6) = 'CLOSED' AND\r\nSUBSTR(claimant_cov_direct_loss_status_type_out,1,6) <> 'CLOSED' AND \r\nSUBSTR(claimant_cov_exp_status_type_out,1,6) <> 'CLOSED' AND \r\nSUBSTR(claimant_cov_salvage_status_type_out,1,6) <> 'CLOSED' AND \r\nSUBSTR(claimant_cov_subgrogation_status_type_out,1,6) <> 'CLOSED' AND \r\nSUBSTR(claimant_cov_other_recovery_status_type_out,1,6) <> 'CLOSED' , FALSE, \r\nTRUE) AND Dup_Flag='0'\r\n\r\n//----------------------------------------------------------------------------------------------------\r\n//This expression eliminates any invalid combination of reserve and non-reserve status.\r\n//If CC Status is CLOSED AND if any of the other fin typ code status is either open or reopen then \r\n//filter the row out.\r\n// If CC Status is Open or Reopen AND if any of the other fin typ code status is either open or reopen \r\n//then DON'T filter the row out.\r\n// If CC Status is NOTICEONLY AND all the other fin typ code status also NOTICEONLY or N/A then \r\n//DON'T filter the row out\r\n//If NR Status is Closed and if none of the other fin type status is closed, then filter the row\r\n//----------------------------------------------------------------------------------------------------\n),\nLKP_Sup_CauseOfLoss AS (\n\tSELECT\n\tCauseOfLossName,\n\tCauseOfLossId\n\tFROM (\n\t\tSELECT \n\t\t\tCauseOfLossName,\n\t\t\tCauseOfLossId\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_CauseOfLoss\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY CauseOfLossId ORDER BY CauseOfLossName DESC) = 1\n),\nLKP_Sup_Claim_Reserve_Category AS (\n\tSELECT\n\treserve_ctgry_descript,\n\treserve_ctgry_code\n\tFROM (\n\t\tSELECT \n\t\t\treserve_ctgry_descript,\n\t\t\treserve_ctgry_code\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_reserve_category\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY reserve_ctgry_code ORDER BY reserve_ctgry_descript) = 1\n),\nLKP_Sup_Insurance_Line AS (\n\tSELECT\n\tStandardInsuranceLineDescription,\n\tsup_ins_line_id\n\tFROM (\n\t\tSELECT \n\t\t\tStandardInsuranceLineDescription,\n\t\t\tsup_ins_line_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_insurance_line\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_ins_line_id ORDER BY StandardInsuranceLineDescription) = 1\n),\nLKP_Sup_Major_Peril AS (\n\tSELECT\n\tStandardMajorPerilDescription,\n\tsup_major_peril_id\n\tFROM (\n\t\tSELECT \n\t\t\tStandardMajorPerilDescription,\n\t\t\tsup_major_peril_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_major_peril\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_major_peril_id ORDER BY StandardMajorPerilDescription) = 1\n),\nLKP_Sup_Risk_Unit AS (\n\tSELECT\n\tStandardRiskUnitDescription,\n\tsup_risk_unit_id\n\tFROM (\n\t\tSELECT \n\t\t\tStandardRiskUnitDescription,\n\t\t\tsup_risk_unit_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_risk_unit\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_risk_unit_id ORDER BY StandardRiskUnitDescription) = 1\n),\nLKP_Sup_Risk_Unit_Group AS (\n\tSELECT\n\trisk_unit_grp_descript,\n\tIN_sup_risk_unit_grp_id,\n\tsup_risk_unit_grp_id\n\tFROM (\n\t\tSELECT \n\t\t\trisk_unit_grp_descript,\n\t\t\tIN_sup_risk_unit_grp_id,\n\t\t\tsup_risk_unit_grp_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_risk_unit_group\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_risk_unit_grp_id ORDER BY risk_unit_grp_descript) = 1\n),\nLKP_Sup_Type_Bureau_Code AS (\n\tSELECT\n\tStandardTypeBureauCode,\n\tStandardTypeBureauCodeShortDescription,\n\tStandardTypeBureauCodeLongDescription,\n\tsup_type_bureau_code_id\n\tFROM (\n\t\tSELECT \n\t\t\tStandardTypeBureauCode,\n\t\t\tStandardTypeBureauCodeShortDescription,\n\t\t\tStandardTypeBureauCodeLongDescription,\n\t\t\tsup_type_bureau_code_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_type_bureau_code\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_type_bureau_code_id ORDER BY StandardTypeBureauCode) = 1\n),\nEXP_Verify_Lookup_Results AS (\n\tSELECT\n\tLKP_Sup_CauseOfLoss.CauseOfLossName,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(CauseOfLossName))),'N/A',RTRIM(LTRIM(CauseOfLossName)))\n\tIFF(RTRIM(LTRIM(CauseOfLossName\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(CauseOfLossName\n\t\t\t)\n\t\t)\n\t) AS OUT_CauseOfLossName,\n\tLKP_Sup_Insurance_Line.StandardInsuranceLineDescription,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardInsuranceLineDescription))),'N/A',RTRIM(LTRIM(StandardInsuranceLineDescription)))\n\tIFF(RTRIM(LTRIM(StandardInsuranceLineDescription\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardInsuranceLineDescription\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardInsuranceLineDescription,\n\tLKP_Sup_Major_Peril.StandardMajorPerilDescription,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardMajorPerilDescription))),'N/A',RTRIM(LTRIM(StandardMajorPerilDescription)))\n\tIFF(RTRIM(LTRIM(StandardMajorPerilDescription\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardMajorPerilDescription\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardMajorPerilDescription,\n\tLKP_Sup_Type_Bureau_Code.StandardTypeBureauCode,\n\tLKP_Sup_Type_Bureau_Code.StandardTypeBureauCodeShortDescription,\n\tLKP_Sup_Type_Bureau_Code.StandardTypeBureauCodeLongDescription,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardTypeBureauCode))),'N/A',RTRIM(LTRIM(StandardTypeBureauCode)))\n\tIFF(RTRIM(LTRIM(StandardTypeBureauCode\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardTypeBureauCode\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardTypeBureauCode,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardTypeBureauCodeShortDescription))),'N/A',RTRIM(LTRIM(StandardTypeBureauCodeShortDescription)))\n\tIFF(RTRIM(LTRIM(StandardTypeBureauCodeShortDescription\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardTypeBureauCodeShortDescription\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardTypeBureauCodeShortDescription,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardTypeBureauCodeLongDescription))),'N/A',RTRIM(LTRIM(StandardTypeBureauCodeLongDescription)))\n\tIFF(RTRIM(LTRIM(StandardTypeBureauCodeLongDescription\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardTypeBureauCodeLongDescription\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardTypeBureauCodeLongDescription,\n\tLKP_Sup_Risk_Unit_Group.risk_unit_grp_descript,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(risk_unit_grp_descript))),'N/A',RTRIM(LTRIM(risk_unit_grp_descript)))\n\tIFF(RTRIM(LTRIM(risk_unit_grp_descript\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(risk_unit_grp_descript\n\t\t\t)\n\t\t)\n\t) AS OUT_risk_unit_grp_descript,\n\tLKP_Sup_Risk_Unit.StandardRiskUnitDescription,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(StandardRiskUnitDescription))),'N/A',RTRIM(LTRIM(StandardRiskUnitDescription)))\n\tIFF(RTRIM(LTRIM(StandardRiskUnitDescription\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(StandardRiskUnitDescription\n\t\t\t)\n\t\t)\n\t) AS OUT_StandardRiskUnitDescription,\n\tLKP_Sup_Claim_Reserve_Category.reserve_ctgry_descript,\n\t-- *INF*: IIF(ISNULL(RTRIM(LTRIM(reserve_ctgry_descript))),'N/A',RTRIM(LTRIM(reserve_ctgry_descript)))\n\tIFF(RTRIM(LTRIM(reserve_ctgry_descript\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tRTRIM(LTRIM(reserve_ctgry_descript\n\t\t\t)\n\t\t)\n\t) AS OUT_reserve_ctgry_descript\n\tFROM \n\tLEFT JOIN LKP_Sup_CauseOfLoss\n\tON LKP_Sup_CauseOfLoss.CauseOfLossId = FIL_INVALID_COMB_RES_NONRES_STATUS.CauseOfLossID\n\tLEFT JOIN LKP_Sup_Claim_Reserve_Category\n\tON LKP_Sup_Claim_Reserve_Category.reserve_ctgry_code = FIL_INVALID_COMB_RES_NONRES_STATUS.pms_reserve_ctgry\n\tLEFT JOIN LKP_Sup_Insurance_Line\n\tON LKP_Sup_Insurance_Line.sup_ins_line_id = FIL_INVALID_COMB_RES_NONRES_STATUS.SupInsuranceLineID\n\tLEFT JOIN LKP_Sup_Major_Peril\n\tON LKP_Sup_Major_Peril.sup_major_peril_id = FIL_INVALID_COMB_RES_NONRES_STATUS.SupMajorPerilID\n\tLEFT JOIN LKP_Sup_Risk_Unit\n\tON LKP_Sup_Risk_Unit.sup_risk_unit_id = FIL_INVALID_COMB_RES_NONRES_STATUS.sup_risk_unit_id\n\tLEFT JOIN LKP_Sup_Risk_Unit_Group\n\tON LKP_Sup_Risk_Unit_Group.sup_risk_unit_grp_id = FIL_INVALID_COMB_RES_NONRES_STATUS.sup_risk_unit_grp_id\n\tLEFT JOIN LKP_Sup_Type_Bureau_Code\n\tON LKP_Sup_Type_Bureau_Code.sup_type_bureau_code_id = FIL_INVALID_COMB_RES_NONRES_STATUS.SupTypeBureauCodeID\n),\nLKP_Claim_Total_Loss AS (\n\tSELECT\n\tclaim_total_loss_ak_id,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_total_loss_ak_id,\n\t\t\tclaimant_cov_det_ak_id\n\t\tFROM claim_total_loss\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY claim_total_loss_ak_id) = 1\n),\nEXP_claim_total_loss_ind AS (\n\tSELECT\n\tclaim_total_loss_ak_id,\n\t-- *INF*: IIF(ISNULL(claim_total_loss_ak_id), 'Y', 'N')\n\tIFF(claim_total_loss_ak_id IS NULL,\n\t\t'Y',\n\t\t'N'\n\t) AS claim_total_loss_ind\n\tFROM LKP_Claim_Total_Loss\n),\nLKP_Claimant_Coverage_Dim AS (\n\tSELECT\n\tclaimant_cov_dim_id,\n\tedw_claimant_cov_det_pk_id,\n\tedw_claimant_cov_det_calculation_pk_id,\n\tedw_claimant_cov_det_reserve_calculation_direct_loss_pk_id,\n\tedw_claimant_cov_det_reserve_calculation_exp_pk_id,\n\tedw_claimant_cov_det_reserve_calculation_subrogation_pk_id,\n\tedw_claimant_cov_det_reserve_calculation_salvage_pk_id,\n\tedw_claimant_cov_det_reserve_calculation_other_recovery_pk_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaimant_cov_dim_id,\n\t\t\tedw_claimant_cov_det_pk_id,\n\t\t\tedw_claimant_cov_det_calculation_pk_id,\n\t\t\tedw_claimant_cov_det_reserve_calculation_direct_loss_pk_id,\n\t\t\tedw_claimant_cov_det_reserve_calculation_exp_pk_id,\n\t\t\tedw_claimant_cov_det_reserve_calculation_subrogation_pk_id,\n\t\t\tedw_claimant_cov_det_reserve_calculation_salvage_pk_id,\n\t\t\tedw_claimant_cov_det_reserve_calculation_other_recovery_pk_id\n\t\tFROM claimant_coverage_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_pk_id,edw_claimant_cov_det_calculation_pk_id,edw_claimant_cov_det_reserve_calculation_direct_loss_pk_id,edw_claimant_cov_det_reserve_calculation_exp_pk_id,edw_claimant_cov_det_reserve_calculation_subrogation_pk_id,edw_claimant_cov_det_reserve_calculation_salvage_pk_id,edw_claimant_cov_det_reserve_calculation_other_recovery_pk_id ORDER BY claimant_cov_dim_id) = 1\n),\nLKP_Sup_Claim_Cause_Of_Loss AS (\n\tSELECT\n\tcause_of_loss_long_descript,\n\tmajor_peril_code,\n\tcause_of_loss_code,\n\treserve_ctgry_code\n\tFROM (\n\t\tSELECT \r\n\t\tA.cause_of_loss_long_descript as cause_of_loss_long_descript, \r\n\t\tRTRIM(A.major_peril_code) as major_peril_code, \r\n\t\tRTRIM(A.cause_of_loss_code) as cause_of_loss_code, \r\n\t\tRTRIM(A.reserve_ctgry_code) as reserve_ctgry_code \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_cause_of_loss A\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY major_peril_code,cause_of_loss_code,reserve_ctgry_code ORDER BY cause_of_loss_long_descript) = 1\n),\nLKP_Unit_Type_Desc AS (\n\tSELECT\n\ts3p_unit_type_code1,\n\tcov_unit_code,\n\tcov_unit_descript\n\tFROM (\n\t\tSELECT \r\n\t\tsup_coverage_unit.cov_unit_descript as cov_unit_descript, \r\n\t\tRTRIM(sup_coverage_unit.cov_unit_code) as cov_unit_code \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_coverage_unit sup_coverage_unit\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY cov_unit_code ORDER BY s3p_unit_type_code1) = 1\n),\nRTR_claimant_coverage_dim AS (\n\tSELECT\n\tLKP_Claimant_Coverage_Dim.claimant_cov_dim_id,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_id_out AS in_claimant_cov_det_id,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_calculation_id_out AS in_claimant_cov_det_calculation_id,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_D_out AS in_claimant_cov_det_reserve_calculation_id_D,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_E_out AS in_claimant_cov_det_reserve_calculation_id_E,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_S_out AS in_claimant_cov_det_reserve_calculation_id_S,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_B_out AS in_claimant_cov_det_reserve_calculation_id_B,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_R_out AS in_claimant_cov_det_reserve_calculation_id_R,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_date_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_direct_loss_status_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_exp_status_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_salvage_status_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_subgrogation_status_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_other_recovery_status_type_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_supplemental_ind_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_financial_ind_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_recovery_ind_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_notice_only_ind_out,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.s3p_wc_class_descript,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.in_pms_loss_disability_code,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.loss_disability_descript_out AS in_loss_disability_descript,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_dam_descript,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.s3p_unit_descript AS s3p_unit_description,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_open_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_close_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_reopen_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_closed_after_reopen_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_noticeonly_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.crrnt_snpsht_flag,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.audit_id,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.new_eff_from_date AS eff_from_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.eff_to_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.created_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.modified_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.s3p_unit_type_code1,\n\tLKP_Unit_Type_Desc.cov_unit_descript,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.pms_reserve_ctgry,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.pms_loss_cause,\n\tLKP_Sup_Claim_Cause_Of_Loss.cause_of_loss_long_descript,\n\tEXP_Verify_Lookup_Results.OUT_reserve_ctgry_descript AS reserve_ctgry_descript,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_ak_id,\n\tEXP_claim_total_loss_ind.claim_total_loss_ind,\n\tEXP_Verify_Lookup_Results.OUT_CauseOfLossName AS CauseOfLossName,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.PolicySourceID,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.CoverageForm,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.RiskType,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.CoverageType,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.CoverageVersion,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.ClassCode,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.SublineCode,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.major_peril_code,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.ins_line,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.risk_unit_grp,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.risk_unit_grp_seq_num,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.risk_unit,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.risk_unit_seq_num,\n\tEXP_Verify_Lookup_Results.OUT_StandardInsuranceLineDescription AS StandardInsuranceLineDescription,\n\tEXP_Verify_Lookup_Results.OUT_StandardMajorPerilDescription AS StandardMajorPerilDescription,\n\tEXP_Verify_Lookup_Results.OUT_StandardTypeBureauCodeShortDescription AS StandardTypeBureauCodeShortDescription,\n\tEXP_Verify_Lookup_Results.OUT_StandardTypeBureauCodeLongDescription AS StandardTypeBureauCodeLongDescription,\n\tEXP_Verify_Lookup_Results.OUT_risk_unit_grp_descript AS StandardRiskUnitGroupDescription,\n\tEXP_Verify_Lookup_Results.OUT_StandardRiskUnitDescription AS StandardRiskUnitDescription,\n\tEXP_Verify_Lookup_Results.OUT_StandardTypeBureauCode AS pms_type_bureau_code,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.major_peril_seq,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_eff_date,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_veh_registration_state_code,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_vin_num,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_veh_stated_amt,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_veh_yr,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.unit_veh_make,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.spec_pers_prop_use_code,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.pkg_ded_amt,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.pkg_lmt_amt,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.loc_unit_num,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.sub_loc_unit_num,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.TypeOfLoss,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.ClaimTypeCategory,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.ClaimTypeGroup,\n\tFIL_INVALID_COMB_RES_NONRES_STATUS.SubrogationEligibleIndicator\n\tFROM EXP_Verify_Lookup_Results\n\t -- Manually join with EXP_claim_total_loss_ind\n\t -- Manually join with FIL_INVALID_COMB_RES_NONRES_STATUS\n\tLEFT JOIN LKP_Claimant_Coverage_Dim\n\tON LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_id_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_calculation_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_calculation_id_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_reserve_calculation_direct_loss_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_D_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_reserve_calculation_exp_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_E_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_reserve_calculation_subrogation_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_B_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_reserve_calculation_salvage_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_S_out AND LKP_Claimant_Coverage_Dim.edw_claimant_cov_det_reserve_calculation_other_recovery_pk_id = FIL_INVALID_COMB_RES_NONRES_STATUS.claimant_cov_det_reserve_calculation_id_R_out\n\tLEFT JOIN LKP_Sup_Claim_Cause_Of_Loss\n\tON LKP_Sup_Claim_Cause_Of_Loss.major_peril_code = FIL_INVALID_COMB_RES_NONRES_STATUS.major_peril_code AND LKP_Sup_Claim_Cause_Of_Loss.cause_of_loss_code = FIL_INVALID_COMB_RES_NONRES_STATUS.pms_loss_cause AND LKP_Sup_Claim_Cause_Of_Loss.reserve_ctgry_code = FIL_INVALID_COMB_RES_NONRES_STATUS.pms_reserve_ctgry\n\tLEFT JOIN LKP_Unit_Type_Desc\n\tON LKP_Unit_Type_Desc.cov_unit_code = FIL_INVALID_COMB_RES_NONRES_STATUS.s3p_unit_type_code1\n),\nRTR_claimant_coverage_dim_INSERT AS (SELECT * FROM RTR_claimant_coverage_dim WHERE isnull(claimant_cov_dim_id)),\nRTR_claimant_coverage_dim_DEFAULT1 AS (SELECT * FROM RTR_claimant_coverage_dim WHERE NOT ( (isnull(claimant_cov_dim_id)) )),\nUPD_claimant_coverage_dim_INSERT AS (\n\tSELECT\n\tclaimant_cov_dim_id AS claimant_cov_dim_id1, \n\tin_claimant_cov_det_id AS in_claimant_cov_det_id1, \n\tin_claimant_cov_det_calculation_id AS in_claimant_cov_det_calculation_id1, \n\tin_claimant_cov_det_reserve_calculation_id_D AS in_claimant_cov_det_reserve_calculation_id_D1, \n\tin_claimant_cov_det_reserve_calculation_id_E AS in_claimant_cov_det_reserve_calculation_id_E1, \n\tin_claimant_cov_det_reserve_calculation_id_S AS in_claimant_cov_det_reserve_calculation_id_S1, \n\tin_claimant_cov_det_reserve_calculation_id_B AS in_claimant_cov_det_reserve_calculation_id_B1, \n\tin_claimant_cov_det_reserve_calculation_id_R AS in_claimant_cov_det_reserve_calculation_id_R1, \n\tclaimant_cov_det_ak_id AS claimant_cov_det_ak_id1, \n\tclaimant_cov_date_type_out, \n\tclaimant_cov_direct_loss_status_type_out, \n\tclaimant_cov_exp_status_type_out, \n\tclaimant_cov_salvage_status_type_out, \n\tclaimant_cov_subgrogation_status_type_out, \n\tclaimant_cov_other_recovery_status_type_out, \n\tclaimant_cov_supplemental_ind_out AS claimant_cov_supplemental_ind_out1, \n\tclaimant_cov_financial_ind_out AS claimant_cov_financial_ind_out1, \n\tclaimant_cov_recovery_ind_out AS claimant_cov_recovery_ind_out1, \n\tclaimant_cov_notice_only_ind_out AS claimant_cov_notice_only_ind_out1, \n\ts3p_wc_class_descript AS s3p_wc_class_descript1, \n\ts3p_unit_type_code AS s3p_unit_type_code11, \n\tcov_unit_descript, \n\tpms_reserve_ctgry AS pms_reserve_ctgry1, \n\tpms_loss_cause AS pms_loss_cause1, \n\tcause_of_loss_long_descript AS cause_of_loss_long_descript1, \n\treserve_ctgry_descript AS reserve_ctgry_descript1, \n\tin_pms_loss_disability_code AS in_pms_loss_disability_code1, \n\tin_loss_disability_descript AS lkp_loss_disability_descript1, \n\tunit_dam_descript AS unit_dam_descript1, \n\ts3p_unit_description AS s3p_unit_description1, \n\tclaimant_cov_open_date AS claimant_cov_open_date1, \n\tclaimant_cov_close_date AS claimant_cov_close_date1, \n\tclaimant_cov_reopen_date AS claimant_cov_reopen_date1, \n\tclaimant_cov_closed_after_reopen_date AS claimant_cov_closed_after_reopen_date1, \n\tclaimant_cov_noticeonly_date, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tclaim_total_loss_ind AS claim_total_loss_ind1, \n\tCauseOfLossName AS CauseOfLossName1, \n\tPolicySourceID AS PolicySourceID1, \n\tCoverageForm AS CoverageForm1, \n\tRiskType AS RiskType1, \n\tCoverageType AS CoverageType1, \n\tCoverageVersion AS CoverageVersion1, \n\tClassCode AS ClassCode1, \n\tSublineCode AS SublineCode1, \n\tmajor_peril_code AS major_peril_code1, \n\tins_line AS ins_line1, \n\trisk_unit_grp AS risk_unit_grp1, \n\trisk_unit_grp_seq_num AS risk_unit_grp_seq_num1, \n\trisk_unit AS risk_unit1, \n\trisk_unit_seq_num AS risk_unit_seq_num1, \n\tStandardInsuranceLineDescription AS StandardInsuranceLineDescription1, \n\tStandardMajorPerilDescription AS StandardMajorPerilDescription1, \n\tStandardTypeBureauCodeShortDescription AS StandardTypeBureauCodeShortDescription1, \n\tStandardTypeBureauCodeLongDescription AS StandardTypeBureauCodeLongDescription1, \n\tStandardRiskUnitGroupDescription AS StandardRiskUnitGroupDescription1, \n\tStandardRiskUnitDescription AS StandardRiskUnitDescription1, \n\tpms_type_bureau_code AS pms_type_bureau_code1, \n\tmajor_peril_seq AS major_peril_seq1, \n\tclaimant_cov_eff_date AS claimant_cov_eff_date1, \n\tunit_veh_registration_state_code AS unit_veh_registration_state_code1, \n\tunit_vin_num AS unit_vin_num1, \n\tunit_veh_stated_amt AS unit_veh_stated_amt1, \n\tunit_veh_yr AS unit_veh_yr1, \n\tunit_veh_make AS unit_veh_make1, \n\tspec_pers_prop_use_code AS spec_pers_prop_use_code1, \n\tpkg_ded_amt AS pkg_ded_amt1, \n\tpkg_lmt_amt AS pkg_lmt_amt1, \n\tloc_unit_num AS loc_unit_num1, \n\tsub_loc_unit_num AS sub_loc_unit_num1, \n\tTypeOfLoss, \n\tClaimTypeCategory AS ClaimTypeCategory1, \n\tClaimTypeGroup AS ClaimTypeGroup1, \n\tSubrogationEligibleIndicator AS SubrogationEligibleIndicator1\n\tFROM RTR_claimant_coverage_dim_INSERT\n),\nclaimant_coverage_dim_INSERT AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_dim\n\t(edw_claimant_cov_det_pk_id, edw_claimant_cov_det_calculation_pk_id, edw_claimant_cov_det_reserve_calculation_direct_loss_pk_id, edw_claimant_cov_det_reserve_calculation_exp_pk_id, edw_claimant_cov_det_reserve_calculation_subrogation_pk_id, edw_claimant_cov_det_reserve_calculation_salvage_pk_id, edw_claimant_cov_det_reserve_calculation_other_recovery_pk_id, edw_claimant_cov_det_ak_id, claimant_cov_status_type, claimant_cov_direct_loss_status_type, claimant_cov_exp_status_type, claimant_cov_salvage_status_type, claimant_cov_subrogation_status_type, claimant_cov_other_recovery_status_type, claimant_cov_financial_ind, claimant_cov_supplemental_ind, claimant_cov_recovery_ind, claimant_cov_notice_only_claim_ind, wc_class_descript, unit_type_code, unit_type_descript, unit_descript, cause_of_loss, cause_of_loss_long_descript, reserve_ctgry, reserve_ctgry_descript, loss_disability, loss_disability_descript, unit_dam_descript, claimant_cov_open_date, claimant_cov_close_date, claimant_cov_reopen_date, claimant_cov_closed_after_reopen_date, claimant_cov_notice_only_date, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, claim_total_loss_ind, PolicySourceID, CoverageForm, RiskType, CoverageType, CoverageVersion, ClassCode, SublineCode, InsuranceLineCode, InsuranceLineCodeDescription, MajorPerilCode, MajorPerilCodeDescription, MajorPerilSequenceNumber, TypeBureauCode, TypeBureauCodeShortDescription, TypeBureauCodeLongDescription, RiskUnitGroupCode, RiskUnitGroupCodeDescription, RiskUnitGroupSequenceNumber, RiskUnitCode, RiskUnitCodeDescription, RiskUnitSequenceNumber, CoverageEffectiveDate, LocationUnitNumber, SubLocationUnitNumber, UnitVehicleRegistrationStateCode, UnitVinNumber, UnitVehicleStateAmount, UnitVehicleYear, UnitVehicleMake, SpecialPersonalPropertyUseCode, PackageDeductibleAmount, PackageLimitAmount, TypeOfLoss, ClaimTypeCategory, ClaimTypeGroup, SubrogationEligibleIndicator)\n\tSELECT \n\tin_claimant_cov_det_id1 AS EDW_CLAIMANT_COV_DET_PK_ID, \n\tin_claimant_cov_det_calculation_id1 AS EDW_CLAIMANT_COV_DET_CALCULATION_PK_ID, \n\tin_claimant_cov_det_reserve_calculation_id_D1 AS EDW_CLAIMANT_COV_DET_RESERVE_CALCULATION_DIRECT_LOSS_PK_ID, \n\tin_claimant_cov_det_reserve_calculation_id_E1 AS EDW_CLAIMANT_COV_DET_RESERVE_CALCULATION_EXP_PK_ID, \n\tin_claimant_cov_det_reserve_calculation_id_B1 AS EDW_CLAIMANT_COV_DET_RESERVE_CALCULATION_SUBROGATION_PK_ID, \n\tin_claimant_cov_det_reserve_calculation_id_S1 AS EDW_CLAIMANT_COV_DET_RESERVE_CALCULATION_SALVAGE_PK_ID, \n\tin_claimant_cov_det_reserve_calculation_id_R1 AS EDW_CLAIMANT_COV_DET_RESERVE_CALCULATION_OTHER_RECOVERY_PK_ID, \n\tclaimant_cov_det_ak_id1 AS EDW_CLAIMANT_COV_DET_AK_ID, \n\tclaimant_cov_date_type_out AS CLAIMANT_COV_STATUS_TYPE, \n\tclaimant_cov_direct_loss_status_type_out AS CLAIMANT_COV_DIRECT_LOSS_STATUS_TYPE, \n\tclaimant_cov_exp_status_type_out AS CLAIMANT_COV_EXP_STATUS_TYPE, \n\tclaimant_cov_salvage_status_type_out AS CLAIMANT_COV_SALVAGE_STATUS_TYPE, \n\tclaimant_cov_subgrogation_status_type_out AS CLAIMANT_COV_SUBROGATION_STATUS_TYPE, \n\tclaimant_cov_other_recovery_status_type_out AS CLAIMANT_COV_OTHER_RECOVERY_STATUS_TYPE, \n\tclaimant_cov_financial_ind_out1 AS CLAIMANT_COV_FINANCIAL_IND, \n\tclaimant_cov_supplemental_ind_out1 AS CLAIMANT_COV_SUPPLEMENTAL_IND, \n\tclaimant_cov_recovery_ind_out1 AS CLAIMANT_COV_RECOVERY_IND, \n\tclaimant_cov_notice_only_ind_out1 AS CLAIMANT_COV_NOTICE_ONLY_CLAIM_IND, \n\ts3p_wc_class_descript1 AS WC_CLASS_DESCRIPT, \n\ts3p_unit_type_code11 AS UNIT_TYPE_CODE, \n\tcov_unit_descript AS UNIT_TYPE_DESCRIPT, \n\ts3p_unit_description1 AS UNIT_DESCRIPT, \n\tpms_loss_cause1 AS CAUSE_OF_LOSS, \n\tCauseOfLossName1 AS CAUSE_OF_LOSS_LONG_DESCRIPT, \n\tpms_reserve_ctgry1 AS RESERVE_CTGRY, \n\treserve_ctgry_descript1 AS RESERVE_CTGRY_DESCRIPT, \n\tin_pms_loss_disability_code1 AS LOSS_DISABILITY, \n\tlkp_loss_disability_descript1 AS LOSS_DISABILITY_DESCRIPT, \n\tunit_dam_descript1 AS UNIT_DAM_DESCRIPT, \n\tclaimant_cov_open_date1 AS CLAIMANT_COV_OPEN_DATE, \n\tclaimant_cov_close_date1 AS CLAIMANT_COV_CLOSE_DATE, \n\tclaimant_cov_reopen_date1 AS CLAIMANT_COV_REOPEN_DATE, \n\tclaimant_cov_closed_after_reopen_date1 AS CLAIMANT_COV_CLOSED_AFTER_REOPEN_DATE, \n\tclaimant_cov_noticeonly_date AS CLAIMANT_COV_NOTICE_ONLY_DATE, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tclaim_total_loss_ind1 AS CLAIM_TOTAL_LOSS_IND, \n\tPolicySourceID1 AS POLICYSOURCEID, \n\tCoverageForm1 AS COVERAGEFORM, \n\tRiskType1 AS RISKTYPE, \n\tCoverageType1 AS COVERAGETYPE, \n\tCoverageVersion1 AS COVERAGEVERSION, \n\tClassCode1 AS CLASSCODE, \n\tSublineCode1 AS SUBLINECODE, \n\tins_line1 AS INSURANCELINECODE, \n\tStandardInsuranceLineDescription1 AS INSURANCELINECODEDESCRIPTION, \n\tmajor_peril_code1 AS MAJORPERILCODE, \n\tStandardMajorPerilDescription1 AS MAJORPERILCODEDESCRIPTION, \n\tmajor_peril_seq1 AS MAJORPERILSEQUENCENUMBER, \n\tpms_type_bureau_code1 AS TYPEBUREAUCODE, \n\tStandardTypeBureauCodeShortDescription1 AS TYPEBUREAUCODESHORTDESCRIPTION, \n\tStandardTypeBureauCodeLongDescription1 AS TYPEBUREAUCODELONGDESCRIPTION, \n\trisk_unit_grp1 AS RISKUNITGROUPCODE, \n\tStandardRiskUnitGroupDescription1 AS RISKUNITGROUPCODEDESCRIPTION, \n\trisk_unit_grp_seq_num1 AS RISKUNITGROUPSEQUENCENUMBER, \n\trisk_unit1 AS RISKUNITCODE, \n\tStandardRiskUnitDescription1 AS RISKUNITCODEDESCRIPTION, \n\trisk_unit_seq_num1 AS RISKUNITSEQUENCENUMBER, \n\tclaimant_cov_eff_date1 AS COVERAGEEFFECTIVEDATE, \n\tloc_unit_num1 AS LOCATIONUNITNUMBER, \n\tsub_loc_unit_num1 AS SUBLOCATIONUNITNUMBER, \n\tunit_veh_registration_state_code1 AS UNITVEHICLEREGISTRATIONSTATECODE, \n\tunit_vin_num1 AS UNITVINNUMBER, \n\tunit_veh_stated_amt1 AS UNITVEHICLESTATEAMOUNT, \n\tunit_veh_yr1 AS UNITVEHICLEYEAR, \n\tunit_veh_make1 AS UNITVEHICLEMAKE, \n\tspec_pers_prop_use_code1 AS SPECIALPERSONALPROPERTYUSECODE, \n\tpkg_ded_amt1 AS PACKAGEDEDUCTIBLEAMOUNT, \n\tpkg_lmt_amt1 AS PACKAGELIMITAMOUNT, \n\tTYPEOFLOSS, \n\tClaimTypeCategory1 AS CLAIMTYPECATEGORY, \n\tClaimTypeGroup1 AS CLAIMTYPEGROUP, \n\tSubrogationEligibleIndicator1 AS SUBROGATIONELIGIBLEINDICATOR\n\tFROM UPD_claimant_coverage_dim_INSERT\n),\nUPD_claimant_coverage_dim_UPDATE AS (\n\tSELECT\n\tclaimant_cov_dim_id AS claimant_cov_dim_id2, \n\tin_claimant_cov_det_id AS in_claimant_cov_det_id2, \n\tin_claimant_cov_det_calculation_id AS in_claimant_coverage_calculation_id2, \n\tin_claimant_cov_det_reserve_calculation_id_D AS in_claimant_cov_det_reserve_calculation_id_D2, \n\tin_claimant_cov_det_reserve_calculation_id_E AS in_claimant_cov_det_reserve_calculation_id_E2, \n\tin_claimant_cov_det_reserve_calculation_id_S AS in_claimant_cov_det_reserve_calculation_id_S2, \n\tin_claimant_cov_det_reserve_calculation_id_B AS in_claimant_cov_det_reserve_calculation_id_B2, \n\tin_claimant_cov_det_reserve_calculation_id_R AS in_claimant_cov_det_reserve_calculation_id_R2, \n\tclaimant_cov_date_type_out, \n\tclaimant_cov_direct_loss_status_type_out, \n\tclaimant_cov_exp_status_type_out, \n\tclaimant_cov_salvage_status_type_out, \n\tclaimant_cov_subgrogation_status_type_out, \n\tclaimant_cov_other_recovery_status_type_out, \n\tclaimant_cov_supplemental_ind_out AS claimant_cov_supplemental_ind_out2, \n\tclaimant_cov_financial_ind_out AS claimant_cov_financial_ind_out2, \n\tclaimant_cov_recovery_ind_out AS claimant_cov_recovery_ind_out2, \n\tclaimant_cov_notice_only_ind_out AS claimant_cov_notice_only_ind_out2, \n\ts3p_wc_class_descript AS s3p_wc_class_descript2, \n\tin_pms_loss_disability_code AS in_pms_loss_disability_code2, \n\tin_loss_disability_descript AS lkp_loss_disability_descript2, \n\tunit_dam_descript AS unit_dam_descript2, \n\ts3p_unit_description AS s3p_unit_description2, \n\tclaimant_cov_open_date AS claimant_cov_open_date2, \n\tclaimant_cov_close_date AS claimant_cov_close_date2, \n\tclaimant_cov_reopen_date AS claimant_cov_reopen_date2, \n\tclaimant_cov_closed_after_reopen_date AS claimant_cov_closed_after_reopen_date2, \n\tclaimant_cov_noticeonly_date, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag2, \n\taudit_id AS audit_id2, \n\teff_from_date AS eff_from_date2, \n\teff_to_date AS eff_to_date2, \n\tmodified_date AS modified_date2, \n\ts3p_unit_type_code1 AS s3p_unit_type_code12, \n\tcov_unit_descript, \n\tpms_reserve_ctgry AS pms_reserve_ctgry2, \n\tpms_loss_cause AS pms_loss_cause2, \n\tcause_of_loss_long_descript AS cause_of_loss_long_descript2, \n\treserve_ctgry_descript AS reserve_ctgry_descript2, \n\tclaimant_cov_det_ak_id AS claimant_cov_det_ak_id2, \n\tclaim_total_loss_ind AS claim_total_loss_ind2, \n\tCauseOfLossName AS CauseOfLossName2, \n\tPolicySourceID AS PolicySourceID2, \n\tCoverageForm AS CoverageForm2, \n\tRiskType AS RiskType2, \n\tCoverageType AS CoverageType2, \n\tCoverageVersion AS CoverageVersion2, \n\tClassCode AS ClassCode2, \n\tSublineCode AS SublineCode2, \n\tmajor_peril_code AS major_peril_code2, \n\tins_line AS ins_line2, \n\trisk_unit_grp AS risk_unit_grp2, \n\trisk_unit_grp_seq_num AS risk_unit_grp_seq_num2, \n\trisk_unit AS risk_unit2, \n\trisk_unit_seq_num AS risk_unit_seq_num2, \n\tStandardInsuranceLineDescription AS StandardInsuranceLineDescription2, \n\tStandardMajorPerilDescription AS StandardMajorPerilDescription2, \n\tStandardTypeBureauCodeShortDescription AS StandardTypeBureauCodeShortDescription2, \n\tStandardTypeBureauCodeLongDescription AS StandardTypeBureauCodeLongDescription2, \n\tStandardRiskUnitGroupDescription AS StandardRiskUnitGroupDescription2, \n\tStandardRiskUnitDescription AS StandardRiskUnitDescription2, \n\tpms_type_bureau_code AS pms_type_bureau_code2, \n\tmajor_peril_seq AS major_peril_seq2, \n\tclaimant_cov_eff_date AS claimant_cov_eff_date2, \n\tunit_veh_registration_state_code AS unit_veh_registration_state_code2, \n\tunit_vin_num AS unit_vin_num2, \n\tunit_veh_stated_amt AS unit_veh_stated_amt2, \n\tunit_veh_yr AS unit_veh_yr2, \n\tunit_veh_make AS unit_veh_make2, \n\tspec_pers_prop_use_code AS spec_pers_prop_use_code2, \n\tpkg_ded_amt AS pkg_ded_amt2, \n\tpkg_lmt_amt AS pkg_lmt_amt2, \n\tloc_unit_num AS loc_unit_num2, \n\tsub_loc_unit_num AS sub_loc_unit_num2, \n\tTypeOfLoss, \n\tClaimTypeCategory AS ClaimTypeCategory2, \n\tClaimTypeGroup AS ClaimTypeGroup2, \n\tSubrogationEligibleIndicator AS SubrogationEligibleIndicator2\n\tFROM RTR_claimant_coverage_dim_DEFAULT1\n),\nclaimant_coverage_dim_UPDATE AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_dim AS T\n\tUSING UPD_claimant_coverage_dim_UPDATE AS S\n\tON T.claimant_cov_dim_id = S.claimant_cov_dim_id2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.edw_claimant_cov_det_pk_id = S.in_claimant_cov_det_id2, T.edw_claimant_cov_det_calculation_pk_id = S.in_claimant_coverage_calculation_id2, T.edw_claimant_cov_det_reserve_calculation_direct_loss_pk_id = S.in_claimant_cov_det_reserve_calculation_id_D2, T.edw_claimant_cov_det_reserve_calculation_exp_pk_id = S.in_claimant_cov_det_reserve_calculation_id_E2, T.edw_claimant_cov_det_reserve_calculation_subrogation_pk_id = S.in_claimant_cov_det_reserve_calculation_id_B2, T.edw_claimant_cov_det_reserve_calculation_salvage_pk_id = S.in_claimant_cov_det_reserve_calculation_id_S2, T.edw_claimant_cov_det_reserve_calculation_other_recovery_pk_id = S.in_claimant_cov_det_reserve_calculation_id_R2, T.edw_claimant_cov_det_ak_id = S.claimant_cov_det_ak_id2, T.claimant_cov_status_type = S.claimant_cov_date_type_out, T.claimant_cov_direct_loss_status_type = S.claimant_cov_direct_loss_status_type_out, T.claimant_cov_exp_status_type = S.claimant_cov_exp_status_type_out, T.claimant_cov_salvage_status_type = S.claimant_cov_salvage_status_type_out, T.claimant_cov_subrogation_status_type = S.claimant_cov_subgrogation_status_type_out, T.claimant_cov_other_recovery_status_type = S.claimant_cov_other_recovery_status_type_out, T.claimant_cov_financial_ind = S.claimant_cov_financial_ind_out2, T.claimant_cov_supplemental_ind = S.claimant_cov_supplemental_ind_out2, T.claimant_cov_recovery_ind = S.claimant_cov_recovery_ind_out2, T.claimant_cov_notice_only_claim_ind = S.claimant_cov_notice_only_ind_out2, T.wc_class_descript = S.s3p_wc_class_descript2, T.unit_type_code = S.s3p_unit_type_code12, T.unit_type_descript = S.cov_unit_descript, T.unit_descript = S.s3p_unit_description2, T.cause_of_loss = S.pms_loss_cause2, T.cause_of_loss_long_descript = S.CauseOfLossName2, T.reserve_ctgry = S.pms_reserve_ctgry2, T.reserve_ctgry_descript = S.reserve_ctgry_descript2, T.loss_disability = S.in_pms_loss_disability_code2, T.loss_disability_descript = S.lkp_loss_disability_descript2, T.unit_dam_descript = S.unit_dam_descript2, T.claimant_cov_open_date = S.claimant_cov_open_date2, T.claimant_cov_close_date = S.claimant_cov_close_date2, T.claimant_cov_reopen_date = S.claimant_cov_reopen_date2, T.claimant_cov_closed_after_reopen_date = S.claimant_cov_closed_after_reopen_date2, T.claimant_cov_notice_only_date = S.claimant_cov_noticeonly_date, T.crrnt_snpsht_flag = S.crrnt_snpsht_flag2, T.audit_id = S.audit_id2, T.eff_from_date = S.eff_from_date2, T.eff_to_date = S.eff_to_date2, T.modified_date = S.modified_date2, T.claim_total_loss_ind = S.claim_total_loss_ind2, T.PolicySourceID = S.PolicySourceID2, T.CoverageForm = S.CoverageForm2, T.RiskType = S.RiskType2, T.CoverageType = S.CoverageType2, T.CoverageVersion = S.CoverageVersion2, T.ClassCode = S.ClassCode2, T.SublineCode = S.SublineCode2, T.InsuranceLineCode = S.ins_line2, T.InsuranceLineCodeDescription = S.StandardInsuranceLineDescription2, T.MajorPerilCode = S.major_peril_code2, T.MajorPerilCodeDescription = S.StandardMajorPerilDescription2, T.MajorPerilSequenceNumber = S.major_peril_seq2, T.TypeBureauCode = S.pms_type_bureau_code2, T.TypeBureauCodeShortDescription = S.StandardTypeBureauCodeShortDescription2, T.TypeBureauCodeLongDescription = S.StandardTypeBureauCodeLongDescription2, T.RiskUnitGroupCode = S.risk_unit_grp2, T.RiskUnitGroupCodeDescription = S.StandardRiskUnitGroupDescription2, T.RiskUnitGroupSequenceNumber = S.risk_unit_grp_seq_num2, T.RiskUnitCode = S.risk_unit2, T.RiskUnitCodeDescription = S.StandardRiskUnitDescription2, T.RiskUnitSequenceNumber = S.risk_unit_seq_num2, T.CoverageEffectiveDate = S.claimant_cov_eff_date2, T.LocationUnitNumber = S.loc_unit_num2, T.SubLocationUnitNumber = S.sub_loc_unit_num2, T.UnitVehicleRegistrationStateCode = S.unit_veh_registration_state_code2, T.UnitVinNumber = S.unit_vin_num2, T.UnitVehicleStateAmount = S.unit_veh_stated_amt2, T.UnitVehicleYear = S.unit_veh_yr2, T.UnitVehicleMake = S.unit_veh_make2, T.SpecialPersonalPropertyUseCode = S.spec_pers_prop_use_code2, T.PackageDeductibleAmount = S.pkg_ded_amt2, T.PackageLimitAmount = S.pkg_lmt_amt2, T.TypeOfLoss = S.TypeOfLoss, T.ClaimTypeCategory = S.ClaimTypeCategory2, T.ClaimTypeGroup = S.ClaimTypeGroup2, T.SubrogationEligibleIndicator = S.SubrogationEligibleIndicator2\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604487"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "EXCEED AND PMS"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}