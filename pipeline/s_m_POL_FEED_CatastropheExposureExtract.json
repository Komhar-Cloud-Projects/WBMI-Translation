{
    "name": "s_m_POL_FEED_CatastropheExposureExtract",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_CatastropheExposureExtract",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkCatastropheExposure AS (\n\tSELECT\r\n\tAuditId,\r\n\tCreatedDate,\r\n\tModifiedDate,\r\n\tSourceSystemId,\r\n\tPolicyKey,\r\n\tVehicleNumber,\r\n\tBusinessType,\r\n\tInsuranceReferenceLegalEntityDescription,\r\n\tRatingAddress,\r\n\tRatingCity,\r\n\tRatingStateProvinceAbbreviation,\r\n\tRatingPostalCode,\r\n\tRatingCounty,\r\n\tModelYear,\r\n\tVehiclePremium,\r\n\tVehicleLimit,\r\n\tVehicleDeductible,\r\n\tAdjustedTotalInsuredValue,\r\n\tAgencyCode,\r\n\tStrategicProfitCenterDescription,\r\n\tInsuranceSegmentDescription,\r\n\tPlusPakFlag,\r\n\t'N' as EliteFlag,\r\n\tActualLossSustainedCoverageFlag,\r\n\tInsuredName,\r\n\tCustomerNumber,\r\n\tPolicyEffectiveDate,\r\n\tPolicyExpirationDate,\r\n\tOccupancyCode,\r\n\tSicCode,\r\n\tTerrorismFlag,\r\n\tProcessDate,\r\n\tNULL as LocationNumber,\r\n\tNULL as BuildingNumber,\r\n\tNULL as PolicyBlanketPremium,\r\n\tNULL as PolicyBlanketLimit,\r\n\tNULL as PolicyBlanketDeductible,\r\n\tNULL as ConstructionClass,\r\n\tNULL as YearBuilt,\r\n\tNULL as BuildingPremium,\r\n\tNULL as LocationLimit,\r\n\tNULL as LocationDeductible,\r\n\tNULL as LocationBuildingLimit,\r\n\tNULL as LocationBuildingDeductible,\r\n\tNULL as LocationContentsLimit,\r\n\tNULL as LocationContentsDeductible,\r\n\tNULL as LocationBILimit,\r\n\tNULL as LocationBIDeductible,\r\n\tNULL as AdjustedBuildingLimit,\r\n\tNULL as AdjustedContentsLimit,\r\n\tNULL as AdjustedBILimit,\r\n\tNULL as LocationWindCoverageFlag,\r\n\tNULL as LocationEarthquakeFlag,\r\n\tNULL as LocationEarthquakePremium,\r\n\tNULL as LocationEarthquakeLimit,\r\n\tNULL as LocationEarthquakeDeductible,\r\n\tNULL as LocationPremium\r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkCatastropheExposureVehicle\r\n\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT\r\n\tAuditId,\r\n\tCreatedDate,\r\n\tModifiedDate,\r\n\tSourceSystemId,\r\n\tPolicyKey,\r\n\tNULL as VehicleNumber,\r\n\tBusinessType,\r\n\tInsuranceReferenceLegalEntityDescription,\r\n\tRatingAddress,\r\n\tRatingCity,\r\n\tRatingStateProvinceAbbreviation,\r\n\tRatingPostalCode,\r\n\tRatingCounty,\r\n\tNULL as ModelYear,\r\n\tNULL as VehiclePremium,\r\n\tNULL as VehicleLimit,\r\n\tNULL as VehicleDeductible,\r\n\tAdjustedTotalInsuredValue,\r\n\tAgencyCode,\r\n\tStrategicProfitCenterDescription,\r\n\tInsuranceSegmentDescription,\r\n\tPlusPakFlag,\r\n\tEliteFlag,\r\n\tActualLossSustainedCoverageFlag,\r\n\tInsuredName,\r\n\tCustomerNumber,\r\n\tPolicyEffectiveDate,\r\n\tPolicyExpirationDate,\r\n\tOccupancyCode,\r\n\tSicCode,\r\n\tTerrorismFlag,\r\n\tProcessDate,\r\n\tLocationNumber,\r\n\tBuildingNumber,\r\n\tPolicyBlanketPremium,\r\n\tPolicyBlanketLimit,\r\n\tPolicyBlanketDeductible,\r\n\tConstructionClass,\r\n\tYearBuilt,\r\n\tBuildingPremium,\r\n\tLocationLimit,\r\n\tLocationDeductible,\r\n\tLocationBuildingLimit,\r\n\tLocationBuildingDeductible,\r\n\tLocationContentsLimit,\r\n\tLocationContentsDeductible,\r\n\tLocationBILimit,\r\n\tLocationBIDeductible,\r\n\tAdjustedBuildingLimit,\r\n\tAdjustedContentsLimit,\r\n\tAdjustedBILimit,\r\n\tLocationWindCoverageFlag,\r\n\tLocationEarthquakeFlag,\r\n\tLocationEarthquakePremium,\r\n\tLocationEarthquakeLimit,\r\n\tLocationEarthquakeDeductible,\r\n\tNULL as LocationPremium\r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkCatastropheExposureBuilding\r\n\t\r\n\tUNION ALL\r\n\t\r\n\tSELECT\r\n\tAuditId,\r\n\tCreatedDate,\r\n\tModifiedDate,\r\n\tSourceSystemId,\r\n\tPolicyKey,\r\n\tNULL as VehicleNumber,\r\n\tBusinessType,\r\n\tInsuranceReferenceLegalEntityDescription,\r\n\tRatingAddress,\r\n\tRatingCity,\r\n\tRatingStateProvinceAbbreviation,\r\n\tRatingPostalCode,\r\n\tRatingCounty,\r\n\tNULL as ModelYear,\r\n\tNULL as VehiclePremium,\r\n\tNULL as VehicleLimit,\r\n\tNULL as VehicleDeductible,\r\n\tAdjustedTotalInsuredValue,\r\n\tAgencyCode,\r\n\tStrategicProfitCenterDescription,\r\n\tInsuranceSegmentDescription,\r\n\tPlusPakFlag,\r\n\t'N' as EliteFlag,\r\n\tActualLossSustainedCoverageFlag,\r\n\tInsuredName,\r\n\tCustomerNumber,\r\n\tPolicyEffectiveDate,\r\n\tPolicyExpirationDate,\r\n\tOccupancyCode,\r\n\tSicCode,\r\n\tTerrorismFlag,\r\n\tProcessDate,\r\n\tLocationNumber,\r\n\tNULL as BuildingNumber,\r\n\tNULL as PolicyBlanketPremium,\r\n\tNULL as PolicyBlanketLimit,\r\n\tNULL as PolicyBlanketDeductible,\r\n\tNULL as ConstructionClass,\r\n\tNULL as YearBuilt,\r\n\tNULL as BuildingPremium,\r\n\tLocationLimit,\r\n\tLocationDeductible,\r\n\tNULL as LocationBuildingLimit,\r\n\tNULL as LocationBuildingDeductible,\r\n\tNULL as LocationContentsLimit,\r\n\tNULL as LocationContentsDeductible,\r\n\tNULL as LocationBILimit,\r\n\tNULL as LocationBIDeductible,\r\n\tNULL as AdjustedBuildingLimit,\r\n\tNULL as AdjustedContentsLimit,\r\n\tNULL as AdjustedBILimit,\r\n\tLocationWindCoverageFlag,\r\n\tNULL as LocationEarthquakeFlag,\r\n\tNULL as LocationEarthquakePremium,\r\n\tNULL as LocationEarthquakeLimit,\r\n\tNULL as LocationEarthquakeDeductible,\r\n\tLocationPremium\r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkCatastropheExposureLocation\r\n\t\r\n\t---@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Cal AS (\n\tSELECT\n\tAuditId,\n\tCreatedDate,\n\tModifiedDate,\n\tSourceSystemId,\n\tPolicyKey,\n\tVehicleNumber,\n\tBusinessType,\n\tInsuranceReferenceLegalEntityDescription,\n\tRatingAddress,\n\tRatingCity,\n\tRatingStateProvinceAbbreviation,\n\tRatingPostalCode,\n\tRatingCounty,\n\tModelYear,\n\tVehiclePremium,\n\tVehicleLimit,\n\tVehicleDeductible,\n\tAdjustedTotalInsuredValue,\n\tAgencyCode,\n\tStrategicProfitCenterDescription,\n\tInsuranceSegmentDescription,\n\tPlusPakFlag,\n\tEliteFlag,\n\tActualLossSustainedCoverageFlag,\n\tInsuredName,\n\tCustomerNumber,\n\tPolicyEffectiveDate,\n\tPolicyExpirationDate,\n\tOccupancyCode,\n\tSicCode,\n\tTerrorismFlag,\n\tProcessDate,\n\tLocationNumber,\n\tBuildingNumber,\n\tPolicyBlanketPremium,\n\tPolicyBlanketLimit,\n\tPolicyBlanketDeductible,\n\tConstructionClass,\n\tYearBuilt,\n\tBuildingPremium,\n\tLocationLimit,\n\tLocationDeductible,\n\tLocationBuildingLimit,\n\tLocationBuildingDeductible,\n\tLocationContentsLimit,\n\tLocationContentsDeductible,\n\tLocationBILimit,\n\tLocationBIDeductible,\n\tAdjustedBuildingLimit,\n\tAdjustedContentsLimit,\n\tAdjustedBILimit,\n\tLocationWindCoverageFlag,\n\tLocationEarthquakeFlag,\n\tLocationEarthquakePremium,\n\tLocationEarthquakeLimit,\n\tLocationEarthquakeDeductible,\n\tLocationPremium,\n\tAuditId AS o_AuditId,\n\tCreatedDate AS o_CreatedDate,\n\tModifiedDate AS o_ModifiedDate,\n\tSourceSystemId AS o_SourceSystemId,\n\tInsuranceReferenceLegalEntityDescription AS o_InsuranceReferenceLegalEntityDescription,\n\tPolicyKey AS o_PolicyKey,\n\t-- *INF*: IIF(ISNULL(PolicyBlanketPremium), '', TO_CHAR(PolicyBlanketPremium))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(PolicyBlanketPremium), '', SUBSTR(TO_CHAR(PolicyBlanketPremium),1,12))\n\tIFF(PolicyBlanketPremium IS NULL, '', TO_CHAR(PolicyBlanketPremium)) AS o_PolicyBlanketPremium,\n\t-- *INF*: IIF(ISNULL(PolicyBlanketLimit), '', TO_CHAR(PolicyBlanketLimit))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- ---IIF(ISNULL(PolicyBlanketLimit), '', SUBSTR(TO_CHAR(PolicyBlanketLimit),1,12))\n\tIFF(PolicyBlanketLimit IS NULL, '', TO_CHAR(PolicyBlanketLimit)) AS o_PolicyBlanketLimit,\n\t-- *INF*: IIF(ISNULL(PolicyBlanketDeductible), '', TO_CHAR(PolicyBlanketDeductible))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- ---IIF(ISNULL(PolicyBlanketDeductible), '', SUBSTR(TO_CHAR(PolicyBlanketDeductible),1,12))\n\tIFF(PolicyBlanketDeductible IS NULL, '', TO_CHAR(PolicyBlanketDeductible)) AS o_PolicyBlanketDeductible,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_PolicyForm,\n\t-- *INF*: BusinessType\r\n\t-- --DECODE(TRUE,\r\n\t-- --BusinessType='Commercial Auto', 'CAU',\r\n\t-- --BusinessType='Commercial Property', 'CFR',\r\n\t-- --BusinessType='SBOP', 'BOP',\r\n\t-- --BusinessType='SMARTbusiness', 'BOP',\r\n\t-- --BusinessType='Commercial Inland Marine', 'CIM',\r\n\t-- --BusinessType='Dealers Physical Damage', 'DPD',\r\n\t-- --BusinessType='Garagekeepers Liability', 'GKL',\r\n\t--  --'')\n\tBusinessType AS o_BusinessType,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- BusinessType='Commercial Auto', 'CAU',\r\n\t-- BusinessType='Commercial Property', 'CFR',\r\n\t-- BusinessType='SBOP', 'BOP',\r\n\t-- BusinessType='SMARTbusiness', 'BOP',\r\n\t-- BusinessType='Commercial Inland Marine', 'CIM',\r\n\t-- BusinessType='Dealers Physical Damage', 'DPD',\r\n\t-- BusinessType='Garagekeepers Liability', 'GKL',\r\n\t-- '')\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Auto', 'CAU',\n\t    BusinessType = 'Commercial Property', 'CFR',\n\t    BusinessType = 'SBOP', 'BOP',\n\t    BusinessType = 'SMARTbusiness', 'BOP',\n\t    BusinessType = 'Commercial Inland Marine', 'CIM',\n\t    BusinessType = 'Dealers Physical Damage', 'DPD',\n\t    BusinessType = 'Garagekeepers Liability', 'GKL',\n\t    ''\n\t) AS o_LineOfBusiness,\n\t-- *INF*: IIF(INSTR(LTRIM(RatingAddress), ' ')=0, '', SUBSTR(SUBSTR(RatingAddress, 0, INSTR(LTRIM(RatingAddress), ' ') - 1),0,12))\n\tIFF(\n\t    REGEXP_INSTR(LTRIM(RatingAddress), ' ') = 0, '',\n\t    SUBSTR(SUBSTR(RatingAddress, 0, REGEXP_INSTR(LTRIM(RatingAddress), ' ') - 1), 0, 12)\n\t) AS o_StreetNumber,\n\t-- *INF*: IIF(INSTR(LTRIM(RatingAddress), ' ')=0, RatingAddress, SUBSTR(RatingAddress, INSTR(LTRIM(RatingAddress), ' ') + 1))\n\tIFF(\n\t    REGEXP_INSTR(LTRIM(RatingAddress), ' ') = 0, RatingAddress,\n\t    SUBSTR(RatingAddress, REGEXP_INSTR(LTRIM(RatingAddress), ' ') + 1)\n\t) AS o_StreetName,\n\tRatingCity AS o_City,\n\tRatingStateProvinceAbbreviation AS o_State,\n\tRatingPostalCode AS o_ZipCode,\n\tRatingCounty AS o_County,\n\t-- *INF*: IIF(ISNULL(ConstructionClass), '', ConstructionClass)\n\tIFF(ConstructionClass IS NULL, '', ConstructionClass) AS o_ConstructionClass,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- \r\n\t-- --NULL\n\t'' AS o_OccupancyType,\n\t-- *INF*: IIF(ISNULL(YearBuilt), '', YearBuilt)\n\tIFF(YearBuilt IS NULL, '', YearBuilt) AS o_YearBuilt,\n\t-- *INF*: IIF(ISNULL(ModelYear), '', ModelYear)\n\tIFF(ModelYear IS NULL, '', ModelYear) AS o_ModelYear,\n\t-- *INF*: DECODE(TRUE,BusinessType='Commercial Auto' ,\r\n\t--     IIF(ISNULL(VehiclePremium), '', SUBSTR(TO_CHAR(VehiclePremium),1,12)),\r\n\t-- (BusinessType='Commercial Property' OR BusinessType='SBOP' OR BusinessType='SMARTbusiness'),\r\n\t--     IIF(ISNULL(BuildingPremium), '', SUBSTR(TO_CHAR(BuildingPremium),1,12)),\r\n\t-- (BusinessType='Commercial Inland Marine' OR BusinessType='Dealers Physical Damage' OR BusinessType='Garagekeepers Liability'),\r\n\t--     IIF(ISNULL(LocationPremium), '', SUBSTR(TO_CHAR(LocationPremium),1,12)),\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureVehicle',\r\n\t-- --\tIIF(ISNULL(VehiclePremium), '', SUBSTR(TO_CHAR(VehiclePremium),1,12)),\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureBuilding',\r\n\t-- --\tIIF(ISNULL(BuildingPremium), '', SUBSTR(TO_CHAR(BuildingPremium),1,12)),\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureLocation',\r\n\t-- --\tIIF(ISNULL(LocationPremium), '', SUBSTR(TO_CHAR(LocationPremium),1,12)),\r\n\t-- --\t''\r\n\t-- --\t)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Auto', IFF(\n\t        VehiclePremium IS NULL, '', SUBSTR(TO_CHAR(VehiclePremium), 1, 12)\n\t    ),\n\t    (BusinessType = 'Commercial Property' OR BusinessType = 'SBOP' OR BusinessType = 'SMARTbusiness'), IFF(\n\t        BuildingPremium IS NULL, '', SUBSTR(TO_CHAR(BuildingPremium), 1, 12)\n\t    ),\n\t    (BusinessType = 'Commercial Inland Marine' OR BusinessType = 'Dealers Physical Damage' OR BusinessType = 'Garagekeepers Liability'), IFF(\n\t        LocationPremium IS NULL, '', SUBSTR(TO_CHAR(LocationPremium), 1, 12)\n\t    ),\n\t    ''\n\t) AS o_LocationPremium,\n\t-- *INF*: DECODE(TRUE,BusinessType='Commercial Auto' , \r\n\t--    IIF(ISNULL(VehicleLimit), '', SUBSTR(TO_CHAR(VehicleLimit),1,12)),\r\n\t--     IIF(ISNULL(LocationLimit), '', SUBSTR(TO_CHAR(LocationLimit),1,12))\r\n\t-- )\r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureVehicle',\r\n\t-- --\tIIF(ISNULL(VehicleLimit), '', SUBSTR(TO_CHAR(VehicleLimit),1,12)),\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureBuilding' OR ----CatastropheExposureStageTable='WorkCatastropheExposureLocation',\r\n\t-- --\tIIF(ISNULL(LocationLimit), '', SUBSTR(TO_CHAR(LocationLimit),1,12)),\r\n\t-- --\t''\r\n\t-- --\t)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Auto', IFF(\n\t        VehicleLimit IS NULL, '', SUBSTR(TO_CHAR(VehicleLimit), 1, 12)\n\t    ),\n\t    IFF(\n\t        LocationLimit IS NULL, '', SUBSTR(TO_CHAR(LocationLimit), 1, 12)\n\t    )\n\t) AS o_LocationLimit,\n\t-- *INF*: DECODE(TRUE,BusinessType='Commercial Auto',\r\n\t--     IIF(ISNULL(VehicleDeductible), '', SUBSTR(TO_CHAR(VehicleDeductible),1,12)),\r\n\t--     IIF(ISNULL(LocationDeductible), '', SUBSTR(TO_CHAR(LocationDeductible),1,12))\r\n\t-- )\r\n\t-- --DECODE(TRUE,\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureVehicle',\r\n\t-- --\tIIF(ISNULL(VehicleDeductible), '', SUBSTR(TO_CHAR(VehicleDeductible),1,12)),\r\n\t-- --\tCatastropheExposureStageTable='WorkCatastropheExposureBuilding' OR --CatastropheExposureStageTable='WorkCatastropheExposureLocation',\r\n\t-- --\tIIF(ISNULL(LocationDeductible), '', SUBSTR(TO_CHAR(LocationDeductible),1,12)),\r\n\t-- --\t''\r\n\t-- --\t)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Auto', IFF(\n\t        VehicleDeductible IS NULL, '', SUBSTR(TO_CHAR(VehicleDeductible), 1, 12)\n\t    ),\n\t    IFF(\n\t        LocationDeductible IS NULL, '', SUBSTR(TO_CHAR(LocationDeductible), 1, 12)\n\t    )\n\t) AS o_LocationDeductible,\n\t-- *INF*: IIF(ISNULL(LocationBuildingLimit), '', TO_CHAR(LocationBuildingLimit))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationBuildingLimit), '', SUBSTR(TO_CHAR(LocationBuildingLimit),1,12))\n\tIFF(LocationBuildingLimit IS NULL, '', TO_CHAR(LocationBuildingLimit)) AS o_LocationBuildingLimit,\n\t-- *INF*: IIF(ISNULL(LocationBuildingDeductible), '', TO_CHAR(LocationBuildingDeductible))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationBuildingDeductible), '', SUBSTR(TO_CHAR(LocationBuildingDeductible),1,12))\n\tIFF(LocationBuildingDeductible IS NULL, '', TO_CHAR(LocationBuildingDeductible)) AS o_LocationBuildingDeductible,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_LocationOtherLimit,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- \r\n\t-- --NULL\n\t'' AS o_LocationOtherDeductible,\n\t-- *INF*: IIF(ISNULL(LocationContentsLimit), '', TO_CHAR(LocationContentsLimit))\r\n\t-- \r\n\t-- --IIF(ISNULL(LocationContentsLimit), '', SUBSTR(TO_CHAR(LocationContentsLimit),1,12))\n\tIFF(LocationContentsLimit IS NULL, '', TO_CHAR(LocationContentsLimit)) AS o_LocationContentsLimit,\n\t-- *INF*: IIF(ISNULL(LocationContentsDeductible), '', TO_CHAR(LocationContentsDeductible))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationContentsDeductible), '', SUBSTR(TO_CHAR(LocationContentsDeductible),1,12))\n\tIFF(LocationContentsDeductible IS NULL, '', TO_CHAR(LocationContentsDeductible)) AS o_LocationContentsDeductible,\n\t-- *INF*: IIF(ISNULL(LocationBILimit), '', TO_CHAR(LocationBILimit))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationBILimit), '', SUBSTR(TO_CHAR(LocationBILimit),1,12))\n\tIFF(LocationBILimit IS NULL, '', TO_CHAR(LocationBILimit)) AS o_LocationBILimit,\n\t-- *INF*: IIF(ISNULL(LocationBIDeductible), '', TO_CHAR(LocationBIDeductible))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationBIDeductible), '', SUBSTR(TO_CHAR(LocationBIDeductible),1,12))\n\tIFF(LocationBIDeductible IS NULL, '', TO_CHAR(LocationBIDeductible)) AS o_LocationBIDeductible,\n\t-- *INF*: IIF(ISNULL(AdjustedBuildingLimit), '', TO_CHAR(AdjustedBuildingLimit))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- ---IIF(ISNULL(AdjustedBuildingLimit), '', SUBSTR(TO_CHAR(AdjustedBuildingLimit),1,12))\n\tIFF(AdjustedBuildingLimit IS NULL, '', TO_CHAR(AdjustedBuildingLimit)) AS o_AdjustedBuildingLimit,\n\t-- *INF*: IIF(ISNULL(AdjustedContentsLimit), '', TO_CHAR(AdjustedContentsLimit))\r\n\t-- \r\n\t-- \r\n\t-- ---IIF(ISNULL(AdjustedContentsLimit), '', SUBSTR(TO_CHAR(AdjustedContentsLimit),1,12))\n\tIFF(AdjustedContentsLimit IS NULL, '', TO_CHAR(AdjustedContentsLimit)) AS o_AdjustedContentsLimit,\n\t-- *INF*: IIF(ISNULL(AdjustedBILimit), '', TO_CHAR(AdjustedBILimit))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- ---IIF(ISNULL(AdjustedBILimit), '', SUBSTR(TO_CHAR(AdjustedBILimit),1,12))\n\tIFF(AdjustedBILimit IS NULL, '', TO_CHAR(AdjustedBILimit)) AS o_AdjustedBILimit,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_AdjustedOtherLimit,\n\t-- *INF*: IIF(ISNULL(AdjustedTotalInsuredValue), '', SUBSTR(TO_CHAR(AdjustedTotalInsuredValue),1,12))\n\tIFF(\n\t    AdjustedTotalInsuredValue IS NULL, '', SUBSTR(TO_CHAR(AdjustedTotalInsuredValue), 1, 12)\n\t) AS o_AdjustedTotalInsuredValue,\n\t-- *INF*: IIF ((BusinessType='Commercial Auto'  or\r\n\t-- BusinessType='Commercial Inland Marine' \r\n\t-- ),'',IIF(LocationWindCoverageFlag='T','Y','')\r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DECODE(LocationWindCoverageIndicator,'T',1,'F',0,NULL)\n\tIFF(\n\t    (BusinessType = 'Commercial Auto' or BusinessType = 'Commercial Inland Marine'), '',\n\t    IFF(\n\t        LocationWindCoverageFlag = 'T', 'Y', ''\n\t    )\n\t) AS o_LocationWindCoverageFlag,\n\t-- *INF*: IIF ((BusinessType='Commercial Auto'  or BusinessType='Commercial Inland Marine'  or \r\n\t-- BusinessType='Dealers Physical Damage'  or\r\n\t-- BusinessType='Garagekeepers Liability'),'',IIF(LocationEarthquakeFlag='T','Y','N')\r\n\t-- )\r\n\t-- \r\n\t-- --DECODE(LocationEarthquakeIndicator,'T',1,'F',0,NULL)\n\tIFF(\n\t    (BusinessType = 'Commercial Auto'\n\t    or BusinessType = 'Commercial Inland Marine'\n\t    or BusinessType = 'Dealers Physical Damage'\n\t    or BusinessType = 'Garagekeepers Liability'),\n\t    '',\n\t    IFF(\n\t        LocationEarthquakeFlag = 'T', 'Y', 'N'\n\t    )\n\t) AS o_LocationEarthquakeFlag,\n\t-- *INF*: IIF(ISNULL(LocationEarthquakePremium), '', TO_CHAR(LocationEarthquakePremium))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationEarthquakePremium), '', SUBSTR(TO_CHAR(LocationEarthquakePremium),1,12))\n\tIFF(LocationEarthquakePremium IS NULL, '', TO_CHAR(LocationEarthquakePremium)) AS o_LocationEarthquakePremium,\n\t-- *INF*: IIF(ISNULL(LocationEarthquakeLimit), '', TO_CHAR(LocationEarthquakeLimit))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationEarthquakeLimit), '', SUBSTR(TO_CHAR(LocationEarthquakeLimit),1,12))\n\tIFF(LocationEarthquakeLimit IS NULL, '', TO_CHAR(LocationEarthquakeLimit)) AS o_LocationEarthquakeLimit,\n\t-- *INF*: IIF(ISNULL(LocationEarthquakeDeductible), '', TO_CHAR(LocationEarthquakeDeductible))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(LocationEarthquakeDeductible), '', SUBSTR(TO_CHAR(LocationEarthquakeDeductible),1,12))\n\tIFF(LocationEarthquakeDeductible IS NULL, '', TO_CHAR(LocationEarthquakeDeductible)) AS o_LocationEarthquakeDeductible,\n\tAgencyCode AS o_AgencyCode,\n\tStrategicProfitCenterDescription AS o_StrategicProfitCenterDescription,\n\tInsuranceSegmentDescription AS o_InsuranceSegmentDescription,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- EliteFlag = 'L','L',\r\n\t-- EliteFlag = 'S','S',\r\n\t-- PlusPakFlag = 'T','Y',\r\n\t-- 'N')\r\n\t-- --indicate L for Elite, S for Essential, Y for PlusPak\r\n\t-- --IIF(PlusPakFlag='T','Y','N')\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(PlusPakIndicator,'T',1,'F',0,NULL)\n\tDECODE(\n\t    TRUE,\n\t    EliteFlag = 'L', 'L',\n\t    EliteFlag = 'S', 'S',\n\t    PlusPakFlag = 'T', 'Y',\n\t    'N'\n\t) AS o_PlusPakFlag,\n\t-- *INF*: IIF(ActualLossSustainedCoverageFlag='T','Y','N')\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(ActualLossSustainedCoverageIndicator,'T',1,'F',0,NULL)\n\tIFF(ActualLossSustainedCoverageFlag = 'T', 'Y', 'N') AS o_ActualLossSustainedCoverageFlag,\n\tInsuredName AS o_InsuredName,\n\tCustomerNumber AS o_CustomerNumber,\n\t-- *INF*: SUBSTR(TO_CHAR(PolicyEffectiveDate, 'MM/DD/YYYY HH24:MI:SS'),1,10)\n\tSUBSTR(TO_CHAR(PolicyEffectiveDate, 'MM/DD/YYYY HH24:MI:SS'), 1, 10) AS o_PolicyEffectiveDate,\n\t-- *INF*: SUBSTR(TO_CHAR(PolicyExpirationDate, 'MM/DD/YYYY HH24:MI:SS'),1,10)\n\tSUBSTR(TO_CHAR(PolicyExpirationDate, 'MM/DD/YYYY HH24:MI:SS'), 1, 10) AS o_PolicyExpirationDate,\n\t-- *INF*: DECODE(TRUE, OccupancyCode='N/A', '' ,OccupancyCode)\r\n\t-- \r\n\t-- --OccupancyCode\n\tDECODE(\n\t    TRUE,\n\t    OccupancyCode = 'N/A', '',\n\t    OccupancyCode\n\t) AS o_OccupancyCode,\n\tSicCode AS o_SicCode,\n\t-- *INF*: IIF(TerrorismFlag='T','Y','N')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TerrorismIndicator,'T',1,'F',0,NULL)\n\tIFF(TerrorismFlag = 'T', 'Y', 'N') AS o_TerrorismFlag,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_RoofMaterial,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_RoofYear,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_HailResistiveRoofFlag,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_WindHailLossSettlement,\n\t-- *INF*: ''\r\n\t-- \r\n\t-- --NULL\n\t'' AS o_WindHailDeductibleAmount,\n\t-- *INF*: REPLACECHR(0, SUBSTR(TO_CHAR(ProcessDate, 'YYYY-MM-DD HH24:MI:SS'),1,7), '-', '')\n\tREGEXP_REPLACE(SUBSTR(TO_CHAR(ProcessDate, 'YYYY-MM-DD HH24:MI:SS'), 1, 7),'-','','i') AS o_ProcessDate\n\tFROM SQ_WorkCatastropheExposure\n),\nFIL_Remove_ZeroValue_Limits_Deductibles AS (\n\tSELECT\n\to_AuditId AS AuditId, \n\to_CreatedDate AS CreatedDate, \n\to_ModifiedDate AS ModifiedDate, \n\to_SourceSystemId AS SourceSystemId, \n\to_InsuranceReferenceLegalEntityDescription AS InsuranceReferenceLegalEntityDescription, \n\to_PolicyKey AS PolicyKey, \n\to_PolicyBlanketPremium AS PolicyBlanketPremium, \n\to_PolicyBlanketLimit AS PolicyBlanketLimit, \n\to_PolicyBlanketDeductible AS PolicyBlanketDeductible, \n\to_BusinessType AS BusinessType, \n\tVehicleNumber, \n\to_LineOfBusiness AS LineOfBusiness, \n\tLocationNumber, \n\tBuildingNumber, \n\to_PolicyForm AS PolicyForm, \n\to_StreetNumber AS StreetNumber, \n\to_StreetName AS StreetName, \n\to_City AS City, \n\to_State AS State, \n\to_ZipCode AS ZipCode, \n\to_County AS County, \n\to_ConstructionClass AS ConstructionClass, \n\to_OccupancyType AS OccupancyType, \n\to_YearBuilt AS YearBuilt, \n\to_ModelYear AS ModelYear, \n\to_LocationPremium AS LocationPremium, \n\to_LocationLimit AS LocationLimit, \n\to_LocationDeductible AS LocationDeductible, \n\to_LocationBuildingLimit AS LocationBuildingLimit, \n\to_LocationBuildingDeductible AS LocationBuildingDeductible, \n\to_LocationOtherLimit AS LocationOtherLimit, \n\to_LocationOtherDeductible AS LocationOtherDeductible, \n\to_LocationContentsLimit AS LocationContentsLimit, \n\to_LocationContentsDeductible AS LocationContentsDeductible, \n\to_LocationBILimit AS LocationBILimit, \n\to_LocationBIDeductible AS LocationBIDeductible, \n\to_AdjustedBuildingLimit AS AdjustedBuildingLimit, \n\to_AdjustedContentsLimit AS AdjustedContentsLimit, \n\to_AdjustedBILimit AS AdjustedBILimit, \n\to_AdjustedOtherLimit AS AdjustedOtherLimit, \n\to_AdjustedTotalInsuredValue AS AdjustedTotalInsuredValue, \n\to_LocationWindCoverageFlag AS LocationWindCoverageFlag, \n\to_LocationEarthquakeFlag AS LocationEarthquakeFlag, \n\to_LocationEarthquakePremium AS LocationEarthquakePremium, \n\to_LocationEarthquakeLimit AS LocationEarthquakeLimit, \n\to_LocationEarthquakeDeductible AS LocationEarthquakeDeductible, \n\to_AgencyCode AS AgencyCode, \n\to_StrategicProfitCenterDescription AS StrategicProfitCenterDescription, \n\to_InsuranceSegmentDescription AS InsuranceSegmentDescription, \n\to_PlusPakFlag AS PlusPakFlag, \n\to_ActualLossSustainedCoverageFlag AS ActualLossSustainedCoverageFlag, \n\to_InsuredName AS InsuredName, \n\to_CustomerNumber AS CustomerNumber, \n\to_PolicyEffectiveDate AS PolicyEffectiveDate, \n\to_PolicyExpirationDate AS PolicyExpirationDate, \n\to_OccupancyCode AS OccupancyCode, \n\to_SicCode AS SicCode, \n\to_TerrorismFlag AS TerrorismFlag, \n\to_RoofMaterial AS RoofMaterial, \n\to_RoofYear AS RoofYear, \n\to_HailResistiveRoofFlag AS HailResistiveRoofFlag, \n\to_WindHailLossSettlement AS WindHailLossSettlement, \n\to_WindHailDeductibleAmount AS WindHailDeductibleAmount, \n\to_ProcessDate AS ProcessDate\n\tFROM EXP_Cal\n\tWHERE IIF((PolicyBlanketLimit='0' or PolicyBlanketLimit='')\r\nand (PolicyBlanketDeductible='0' or PolicyBlanketDeductible='')\r\nand (LocationLimit='0' or LocationLimit='')\r\nand (LocationDeductible='0' or LocationDeductible='')\r\nand (LocationBuildingLimit='0' or LocationBuildingLimit='')\r\nand (LocationBuildingDeductible='0' or LocationBuildingDeductible='')\r\nand (LocationOtherLimit='0' or LocationOtherLimit='')\r\nand (LocationOtherDeductible='0' or LocationOtherDeductible='')\r\nand (LocationContentsLimit='0' or LocationContentsLimit='')\r\nand (LocationContentsDeductible='0' or LocationContentsDeductible='')\r\nand (LocationBILimit='0' or LocationBILimit='')\r\nand (LocationBIDeductible='0' or LocationBIDeductible='')\r\nand (AdjustedBuildingLimit='0' or AdjustedBuildingLimit='')\r\nand (AdjustedContentsLimit='0' or AdjustedContentsLimit='')\r\nand (AdjustedBILimit='0' or AdjustedBILimit='')\r\nand (AdjustedOtherLimit='0' or AdjustedOtherLimit='')\r\nand (LocationEarthquakeLimit='0' or LocationEarthquakeLimit='')\r\nand (LocationEarthquakeDeductible='0' or LocationEarthquakeDeductible='')\r\nand (WindHailDeductibleAmount='0' or WindHailDeductibleAmount=''),\r\n0,1)=1\n),\nCatastropheExposureExtract AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CatastropheExposureExtract\n\t(AuditId, CreatedDate, ModifiedDate, SourceSystemId, PolicyKey, LocationNumber, BuildingNumber, VehicleNumber, BusinessType, InsuranceReferenceLegalEntityDescription, PolicyBlanketPremium, PolicyBlanketLimit, PolicyBlanketDeductible, LineOfBusiness, PolicyForm, StreetNumber, StreetName, City, State, ZipCode, County, ConstructionClass, OccupancyType, YearBuilt, ModelYear, LocationPremium, LocationLimit, LocationDeductible, LocationBuildingLimit, LocationBuildingDeductible, LocationOtherLimit, LocationOtherDeductible, LocationContentsLimit, LocationContentsDeductible, LocationBILimit, LocationBIDeductible, AdjustedBuildingLimit, AdjustedContentsLimit, AdjustedBILimit, AdjustedOtherLimit, AdjustedTotalInsuredValue, LocationWindCoverageFlag, LocationEarthquakeFlag, LocationEarthquakePremium, LocationEarthquakeLimit, LocationEarthquakeDeductible, AgencyCode, StrategicProfitCenterDescription, InsuranceSegmentDescription, PlusPakFlag, ActualLossSustainedCoverageFlag, InsuredName, CustomerNumber, PolicyEffectiveDate, PolicyExpirationDate, OccupancyCode, SicCode, TerrorismFlag, RoofMaterial, RoofYear, HailResistiveRoofFlag, WindHailLossSettlement, WindHailDeductibleAmount, ProcessDate)\n\tSELECT \n\tAUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tSOURCESYSTEMID, \n\tPOLICYKEY, \n\tLOCATIONNUMBER, \n\tBUILDINGNUMBER, \n\tVEHICLENUMBER, \n\tBUSINESSTYPE, \n\tINSURANCEREFERENCELEGALENTITYDESCRIPTION, \n\tPOLICYBLANKETPREMIUM, \n\tPOLICYBLANKETLIMIT, \n\tPOLICYBLANKETDEDUCTIBLE, \n\tLINEOFBUSINESS, \n\tPOLICYFORM, \n\tSTREETNUMBER, \n\tSTREETNAME, \n\tCITY, \n\tSTATE, \n\tZIPCODE, \n\tCOUNTY, \n\tCONSTRUCTIONCLASS, \n\tOCCUPANCYTYPE, \n\tYEARBUILT, \n\tMODELYEAR, \n\tLOCATIONPREMIUM, \n\tLOCATIONLIMIT, \n\tLOCATIONDEDUCTIBLE, \n\tLOCATIONBUILDINGLIMIT, \n\tLOCATIONBUILDINGDEDUCTIBLE, \n\tLOCATIONOTHERLIMIT, \n\tLOCATIONOTHERDEDUCTIBLE, \n\tLOCATIONCONTENTSLIMIT, \n\tLOCATIONCONTENTSDEDUCTIBLE, \n\tLOCATIONBILIMIT, \n\tLOCATIONBIDEDUCTIBLE, \n\tADJUSTEDBUILDINGLIMIT, \n\tADJUSTEDCONTENTSLIMIT, \n\tADJUSTEDBILIMIT, \n\tADJUSTEDOTHERLIMIT, \n\tADJUSTEDTOTALINSUREDVALUE, \n\tLOCATIONWINDCOVERAGEFLAG, \n\tLOCATIONEARTHQUAKEFLAG, \n\tLOCATIONEARTHQUAKEPREMIUM, \n\tLOCATIONEARTHQUAKELIMIT, \n\tLOCATIONEARTHQUAKEDEDUCTIBLE, \n\tAGENCYCODE, \n\tSTRATEGICPROFITCENTERDESCRIPTION, \n\tINSURANCESEGMENTDESCRIPTION, \n\tPLUSPAKFLAG, \n\tACTUALLOSSSUSTAINEDCOVERAGEFLAG, \n\tINSUREDNAME, \n\tCUSTOMERNUMBER, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYEXPIRATIONDATE, \n\tOCCUPANCYCODE, \n\tSICCODE, \n\tTERRORISMFLAG, \n\tROOFMATERIAL, \n\tROOFYEAR, \n\tHAILRESISTIVEROOFFLAG, \n\tWINDHAILLOSSSETTLEMENT, \n\tWINDHAILDEDUCTIBLEAMOUNT, \n\tPROCESSDATE\n\tFROM FIL_Remove_ZeroValue_Limits_Deductibles\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}