{
    "name": "s_m_CLM_CMS_Query_Response_File_Onetime_Hist",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_CMS_Query_Response_File_Onetime_Hist",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CMS_Query_Reponse_File AS (\n\n-- TODO Manual --\n\n),\nEXP_default AS (\n\tSELECT\n\tHIC_Number,\n\tLast_Name,\n\tFirst_Name,\n\tDOB,\n\tSex_Code,\n\tEntitlement_Reason,\n\tCurrent_Medicare_PartA_Eff_Date,\n\tCurrent_Medicare_PartA_Termination_Date,\n\tCurrent_Medicare_PartB_Eff_Date,\n\tCurrent_Medicare_PartB_Termination_Date,\n\tMedicare_Beneficiary_Date_Of_Death,\n\tCurrent_Medicare_PartC_Plan_Contractor_Number,\n\tCurrent_Medicare_PartC_Plan_Enrollment_Date,\n\tCurrent_Medicare_PartC_Plan_Termination_Date,\n\tDisposition_Code,\n\tCMS_Document_Control_Number,\n\t@{pipeline().parameters.WBMI_RECEIVED_DT_ONETIME} AS System_Date,\n\tRRE_DCN_1,\n\t-- *INF*: TO_INTEGER(RRE_DCN_1)\n\tCAST(RRE_DCN_1 AS INTEGER) AS RRE_DCN_1_Out,\n\tRRE_DCN_2,\n\tMost_Recent_Medicare_Part_A_Effective_Date,\n\t-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_A_Effective_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_A_Effective_Date,'YYYYMMDD'),NULL)\n\tIFF(\n\t    IS_DATE(Most_Recent_Medicare_Part_A_Effective_Date, 'YYYYMMDD'),\n\t    TO_TIMESTAMP(Most_Recent_Medicare_Part_A_Effective_Date, 'YYYYMMDD'),\n\t    NULL\n\t) AS o_Most_Recent_Medicare_Part_A_Effective_Date,\n\tMost_Recent_Medicare_Part_A_Termination_Date,\n\t-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_A_Termination_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_A_Termination_Date,'YYYYMMDD'),NULL)\n\tIFF(\n\t    IS_DATE(Most_Recent_Medicare_Part_A_Termination_Date, 'YYYYMMDD'),\n\t    TO_TIMESTAMP(Most_Recent_Medicare_Part_A_Termination_Date, 'YYYYMMDD'),\n\t    NULL\n\t) AS o_Most_Recent_Medicare_Part_A_Termination_Date,\n\tMost_Recent_Medicare_Part_B_Effective_Date,\n\t-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_B_Effective_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_B_Effective_Date,'YYYYMMDD'),NULL)\n\tIFF(\n\t    IS_DATE(Most_Recent_Medicare_Part_B_Effective_Date, 'YYYYMMDD'),\n\t    TO_TIMESTAMP(Most_Recent_Medicare_Part_B_Effective_Date, 'YYYYMMDD'),\n\t    NULL\n\t) AS o_Most_Recent_Medicare_Part_B_Effective_Date,\n\tMost_Recent_Medicare_Part_B_Termination_Date,\n\t-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_B_Termination_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_B_Termination_Date,'YYYYMMDD'),NULL)\n\tIFF(\n\t    IS_DATE(Most_Recent_Medicare_Part_B_Termination_Date, 'YYYYMMDD'),\n\t    TO_TIMESTAMP(Most_Recent_Medicare_Part_B_Termination_Date, 'YYYYMMDD'),\n\t    NULL\n\t) AS o_Most_Recent_Medicare_Part_B_Termination_Date\n\tFROM SQ_CMS_Query_Reponse_File\n),\nLKP_Target AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM,\n\tWBMI_RECEIVED_DT\n\tFROM (\n\t\tSELECT \n\t\t\tCMS_DOC_CNTL_NUM,\n\t\t\tWBMI_RECEIVED_DT\n\t\tFROM CMS_QRY_RESPONSE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WBMI_RECEIVED_DT,CMS_DOC_CNTL_NUM ORDER BY CMS_DOC_CNTL_NUM) = 1\n),\nLKP_claim_party_occurrence AS (\n\tSELECT\n\tsource_sys_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_ak_id,\n\tInjured_Party_Id,\n\tRRE_DCN_1\n\tFROM (\n\t\tselect m.injured_party_id as Injured_Party_Id,      \r\n\t\t    cpo.source_sys_id as Source_Sys_Id, \r\n\t\t    cpo.claim_occurrence_ak_id as claim_occurrence_ak_id ,\r\n\t\tcpo.claim_party_ak_id as claim_party_ak_id\r\n\t\tfrom RPT_EDM.dbo.claim_medical m\r\n\t\tjoin RPT_EDM.dbo.claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = m.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1\r\n\t\twhere m.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY Injured_Party_Id ORDER BY source_sys_id) = 1\n),\nRTR_split_records AS (\n\tSELECT\n\tEXP_default.HIC_Number,\n\tEXP_default.Last_Name,\n\tEXP_default.First_Name,\n\tEXP_default.DOB,\n\tEXP_default.Sex_Code,\n\tEXP_default.Entitlement_Reason,\n\tEXP_default.Current_Medicare_PartA_Eff_Date,\n\tEXP_default.Current_Medicare_PartA_Termination_Date,\n\tEXP_default.Current_Medicare_PartB_Eff_Date,\n\tEXP_default.Current_Medicare_PartB_Termination_Date,\n\tEXP_default.Medicare_Beneficiary_Date_Of_Death,\n\tEXP_default.Current_Medicare_PartC_Plan_Contractor_Number,\n\tEXP_default.Current_Medicare_PartC_Plan_Enrollment_Date,\n\tEXP_default.Current_Medicare_PartC_Plan_Termination_Date,\n\tEXP_default.Disposition_Code,\n\tEXP_default.CMS_Document_Control_Number,\n\tEXP_default.System_Date,\n\tEXP_default.RRE_DCN_1_Out,\n\tLKP_claim_party_occurrence.source_sys_id,\n\tLKP_claim_party_occurrence.claim_occurrence_ak_id AS claim_occurrence_id,\n\tLKP_claim_party_occurrence.claim_party_ak_id,\n\tEXP_default.o_Most_Recent_Medicare_Part_A_Effective_Date AS Most_Recent_Medicare_Part_A_Effective_Date,\n\tEXP_default.o_Most_Recent_Medicare_Part_A_Termination_Date AS Most_Recent_Medicare_Part_A_Termination_Date,\n\tEXP_default.o_Most_Recent_Medicare_Part_B_Effective_Date AS Most_Recent_Medicare_Part_B_Effective_Date,\n\tEXP_default.o_Most_Recent_Medicare_Part_B_Termination_Date AS Most_Recent_Medicare_Part_B_Termination_Date,\n\tLKP_Target.CMS_DOC_CNTL_NUM AS lkp_CMS_DOC_CNTL_NUM\n\tFROM EXP_default\n\tLEFT JOIN LKP_Target\n\tON LKP_Target.WBMI_RECEIVED_DT = EXP_default.System_Date AND LKP_Target.CMS_DOC_CNTL_NUM = EXP_default.CMS_Document_Control_Number\n\tLEFT JOIN LKP_claim_party_occurrence\n\tON LKP_claim_party_occurrence.Injured_Party_Id = EXP_default.RRE_DCN_1_Out\n),\nRTR_split_records_EXCEED AS (SELECT * FROM RTR_split_records WHERE source_sys_id <> 'DCT' AND NOT ISNULL(lkp_CMS_DOC_CNTL_NUM)),\nRTR_split_records_DCT AS (SELECT * FROM RTR_split_records WHERE source_sys_id = 'DCT'),\nUPD_Update AS (\n\tSELECT\n\tCMS_Document_Control_Number AS CMS_Document_Control_Number1, \n\tSystem_Date AS System_Date1, \n\tMost_Recent_Medicare_Part_A_Effective_Date AS Most_Recent_Medicare_Part_A_Effective_Date1, \n\tMost_Recent_Medicare_Part_A_Termination_Date AS Most_Recent_Medicare_Part_A_Termination_Date1, \n\tMost_Recent_Medicare_Part_B_Effective_Date AS Most_Recent_Medicare_Part_B_Effective_Date1, \n\tMost_Recent_Medicare_Part_B_Termination_Date AS Most_Recent_Medicare_Part_B_Termination_Date1\n\tFROM RTR_split_records_EXCEED\n),\nCMS_QRY_RESPONSE AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_QRY_RESPONSE AS T\n\tUSING UPD_Update AS S\n\tON T.WBMI_RECEIVED_DT = S.System_Date1\n\tAND T.CMS_DOC_CNTL_NUM = S.CMS_Document_Control_Number1\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.MOST_RECENT_MED_PARTA_EFF_DT = S.Most_Recent_Medicare_Part_A_Effective_Date1, T.MOST_RECENT_MED_PARTA_TER_DT = S.Most_Recent_Medicare_Part_A_Termination_Date1, T.MOST_RECENT_MED_PARTB_EFF_DT = S.Most_Recent_Medicare_Part_B_Effective_Date1, T.MOST_RECENT_MED_PARTB_TER_DT = S.Most_Recent_Medicare_Part_B_Termination_Date1\n),\nSQ_CMS_Query_Reponse_File_Part_C_D AS (\n\n-- TODO Manual --\n\n),\nEXP_PART_C_D AS (\n\tSELECT\n\tCMS_Document_Control_Number,\n\tRRE_DCN_1,\n\t-- *INF*: TO_INTEGER(RRE_DCN_1)\n\tCAST(RRE_DCN_1 AS INTEGER) AS o_RRE_DCN_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_1,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_1,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_1,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_1,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_2,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_2,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_2,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_2,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_3,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_3,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_3,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_3,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_4,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_4,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_4,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_4,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_5,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_5,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_5,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_5,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_6,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_6,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_6,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_6,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_7,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_7,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_7,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_7,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_8,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_8,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_8,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_8,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_9,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_9,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_9,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_9,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_10,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_10,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_10,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_10,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_11,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_11,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_11,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_11,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Number_12,\n\tMost_Recent_Medicare_Part_C_Plan_Enrollment_Date_12,\n\tMost_Recent_Medicare_Part_C_Plan_Termination_Date_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Name_12,\n\tMost_Recent_Medicare_Part_C_Plan_PBP_Number_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_1_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_2_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_City_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_State_12,\n\tMost_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_1,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_1,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_1,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_1,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_2,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_2,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_2,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_2,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_3,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_3,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_3,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_3,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_4,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_4,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_4,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_4,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_5,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_5,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_5,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_5,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_6,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_6,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_6,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_6,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_7,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_7,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_7,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_7,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_8,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_8,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_8,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_8,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_9,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_9,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_9,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_9,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_10,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_10,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_10,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_10,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_11,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_11,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_11,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_11,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Number_12,\n\tMost_Recent_Medicare_Part_D_Plan_Enrollment_Date_12,\n\tMost_Recent_Medicare_Part_D_Plan_Termination_Date_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Name_12,\n\tMost_Recent_Medicare_Part_D_Plan_PBP_Number_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_1_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_2_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_City_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_State_12,\n\tMost_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_12,\n\t'C' AS o_MED_PART_C,\n\t'D' AS o_MED_PART_D,\n\t@{pipeline().parameters.WBMI_RECEIVED_DT_ONETIME} AS o_WBMI_RECEIVED_DT\n\tFROM SQ_CMS_Query_Reponse_File_Part_C_D\n),\nLKP_Parent_Record AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM,\n\tWBMI_RECEIVED_DT\n\tFROM (\n\t\tSELECT \n\t\t\tCMS_DOC_CNTL_NUM,\n\t\t\tWBMI_RECEIVED_DT\n\t\tFROM CMS_QRY_RESPONSE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WBMI_RECEIVED_DT,CMS_DOC_CNTL_NUM ORDER BY CMS_DOC_CNTL_NUM) = 1\n),\nLKP_claim_party_occurrence1 AS (\n\tSELECT\n\tsource_sys_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_ak_id,\n\tInjured_Party_Id,\n\tRRE_DCN_1\n\tFROM (\n\t\tselect m.injured_party_id as Injured_Party_Id,      \r\n\t\t    cpo.source_sys_id as Source_Sys_Id, \r\n\t\t    cpo.claim_occurrence_ak_id as claim_occurrence_ak_id ,\r\n\t\tcpo.claim_party_ak_id as claim_party_ak_id\r\n\t\tfrom RPT_EDM.dbo.claim_medical m\r\n\t\tjoin RPT_EDM.dbo.claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = m.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1\r\n\t\twhere m.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY Injured_Party_Id ORDER BY source_sys_id) = 1\n),\nRTR_split_records_PART_C_D AS (\n\tSELECT\n\tEXP_PART_C_D.CMS_Document_Control_Number,\n\tLKP_claim_party_occurrence1.source_sys_id,\n\tLKP_claim_party_occurrence1.claim_occurrence_ak_id AS claim_occurrence_id,\n\tLKP_claim_party_occurrence1.claim_party_ak_id,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Number_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_11 AS Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_11 AS Most_Recent_Medicare_Part_C_Plan_Termination_Date_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Name_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_11 AS Most_Recent_Medicare_Part_C_Plan_PBP_Number_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Number_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_12 AS Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_12 AS Most_Recent_Medicare_Part_C_Plan_Termination_Date_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Name_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_12 AS Most_Recent_Medicare_Part_C_Plan_PBP_Number_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_1,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_2,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_3,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_4,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_5,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_6,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_7,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_8,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_9,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_10,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Number_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_11 AS Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_11 AS Most_Recent_Medicare_Part_D_Plan_Termination_Date_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Name_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_11 AS Most_Recent_Medicare_Part_D_Plan_PBP_Number_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_111,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Number_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_12 AS Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_12 AS Most_Recent_Medicare_Part_D_Plan_Termination_Date_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Name_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_12 AS Most_Recent_Medicare_Part_D_Plan_PBP_Number_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_121,\n\tEXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_121,\n\tEXP_PART_C_D.o_MED_PART_C,\n\tEXP_PART_C_D.o_MED_PART_D,\n\tLKP_Parent_Record.CMS_DOC_CNTL_NUM AS LKP_CMS_DOC_CNTL_NUM\n\tFROM EXP_PART_C_D\n\tLEFT JOIN LKP_Parent_Record\n\tON LKP_Parent_Record.WBMI_RECEIVED_DT = EXP_PART_C_D.o_WBMI_RECEIVED_DT AND LKP_Parent_Record.CMS_DOC_CNTL_NUM = EXP_PART_C_D.CMS_Document_Control_Number\n\tLEFT JOIN LKP_claim_party_occurrence1\n\tON LKP_claim_party_occurrence1.Injured_Party_Id = EXP_PART_C_D.o_RRE_DCN_1\n),\nRTR_split_records_PART_C_D_EXCEED AS (SELECT * FROM RTR_split_records_PART_C_D WHERE source_sys_id <> 'DCT' AND NOT ISNULL(LKP_CMS_DOC_CNTL_NUM)),\nRTR_split_records_PART_C_D_DCT AS (SELECT * FROM RTR_split_records_PART_C_D WHERE source_sys_id = 'DCT'),\nNRM_CMS_Query_Response_PART_C_D AS (\n),\nEXP_CMS_QRY_RESPONSE_PART_C_D AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM,\n\t@{pipeline().parameters.WBMI_RECEIVED_DT_ONETIME} AS o_WBMI_RECEIVED_DT,\n\tMED_PARTC,\n\tPLAN_CONTRACT_NUM,\n\tENROLL_DATE,\n\t-- *INF*: IIF(IS_DATE(ENROLL_DATE,'YYYYMMDD'),TO_DATE(ENROLL_DATE,'YYYYMMDD'),NULL)\n\tIFF(IS_DATE(ENROLL_DATE, 'YYYYMMDD'), TO_TIMESTAMP(ENROLL_DATE, 'YYYYMMDD'), NULL) AS o_ENROLL_DATE,\n\tTERM_DATE,\n\t-- *INF*: IIF(IS_DATE(TERM_DATE,'YYYYMMDD'),TO_DATE(TERM_DATE,'YYYYMMDD'),NULL)\n\tIFF(IS_DATE(TERM_DATE, 'YYYYMMDD'), TO_TIMESTAMP(TERM_DATE, 'YYYYMMDD'), NULL) AS o_TERM_DATE,\n\tPLAN_CONTRACT_NAME,\n\tPLAN_BENEFIT_PACK_NUM,\n\tPLAN_CONTRACT_ADD1,\n\tPLAN_CONTRACT_ADD2,\n\tPLAN_CONTRACT_CITY,\n\tPLAN_CONTRACT_STATE,\n\tPLAN_CONTRACT_ZIP,\n\tGCID_PLAN_CONTRACT_NUM,\n\t-- *INF*: IIF(MOD(GCID_PLAN_CONTRACT_NUM,12)=0,12,MOD(GCID_PLAN_CONTRACT_NUM,12))\n\tIFF(MOD(GCID_PLAN_CONTRACT_NUM, 12) = 0, 12, MOD(GCID_PLAN_CONTRACT_NUM, 12)) AS o_GCID_PLAN_CONTRACT_NUM\n\tFROM NRM_CMS_Query_Response_PART_C_D\n),\nFIL_CMS_QRY_RESPONSE_PART_C_D AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM, \n\to_WBMI_RECEIVED_DT, \n\tMED_PARTC, \n\tPLAN_CONTRACT_NUM, \n\to_ENROLL_DATE AS ENROLL_DATE, \n\to_TERM_DATE AS TERM_DATE, \n\tPLAN_CONTRACT_NAME, \n\tPLAN_BENEFIT_PACK_NUM, \n\tPLAN_CONTRACT_ADD1, \n\tPLAN_CONTRACT_ADD2, \n\tPLAN_CONTRACT_CITY, \n\tPLAN_CONTRACT_STATE, \n\tPLAN_CONTRACT_ZIP, \n\to_GCID_PLAN_CONTRACT_NUM AS GCID_PLAN_CONTRACT_NUM\n\tFROM EXP_CMS_QRY_RESPONSE_PART_C_D\n\tWHERE IIF(\r\n(LTRIM(RTRIM(PLAN_CONTRACT_NUM)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_NUM)))) OR\r\n(NOT ISNULL(LTRIM(RTRIM(ENROLL_DATE)))) OR\r\n(NOT ISNULL(LTRIM(RTRIM(TERM_DATE)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_NAME)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_NAME)))) OR\r\n(LTRIM(RTRIM(PLAN_BENEFIT_PACK_NUM)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_BENEFIT_PACK_NUM)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_ADD1)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ADD1)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_ADD2)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ADD2)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_CITY)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_CITY)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_STATE)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_STATE)))) OR\r\n(LTRIM(RTRIM(PLAN_CONTRACT_ZIP)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ZIP))))\r\n,TRUE, FALSE)\n),\nLKP_Target_for_Ins_Upd AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM,\n\tWBMI_RECEIVED_DT,\n\tMED_PARTC,\n\tPART_INSTANCE_NUM\n\tFROM (\n\t\tSELECT \n\t\t\tCMS_DOC_CNTL_NUM,\n\t\t\tWBMI_RECEIVED_DT,\n\t\t\tMED_PARTC,\n\t\t\tPART_INSTANCE_NUM\n\t\tFROM CMS_QRY_RESPONSE_PART_C_D\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY CMS_DOC_CNTL_NUM,WBMI_RECEIVED_DT,MED_PARTC,PART_INSTANCE_NUM ORDER BY CMS_DOC_CNTL_NUM) = 1\n),\nRTR_Target_for_Ins_Upd AS (\n\tSELECT\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.CMS_DOC_CNTL_NUM,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.o_WBMI_RECEIVED_DT,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.MED_PARTC,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_NUM,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.ENROLL_DATE,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.TERM_DATE,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_NAME,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_BENEFIT_PACK_NUM,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_ADD1,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_ADD2,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_CITY,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_STATE,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.PLAN_CONTRACT_ZIP,\n\tFIL_CMS_QRY_RESPONSE_PART_C_D.GCID_PLAN_CONTRACT_NUM,\n\tLKP_Target_for_Ins_Upd.CMS_DOC_CNTL_NUM AS lkp_CMS_DOC_CNTL_NUM\n\tFROM FIL_CMS_QRY_RESPONSE_PART_C_D\n\tLEFT JOIN LKP_Target_for_Ins_Upd\n\tON LKP_Target_for_Ins_Upd.CMS_DOC_CNTL_NUM = FIL_CMS_QRY_RESPONSE_PART_C_D.CMS_DOC_CNTL_NUM AND LKP_Target_for_Ins_Upd.WBMI_RECEIVED_DT = FIL_CMS_QRY_RESPONSE_PART_C_D.o_WBMI_RECEIVED_DT AND LKP_Target_for_Ins_Upd.MED_PARTC = FIL_CMS_QRY_RESPONSE_PART_C_D.MED_PARTC AND LKP_Target_for_Ins_Upd.PART_INSTANCE_NUM = FIL_CMS_QRY_RESPONSE_PART_C_D.GCID_PLAN_CONTRACT_NUM\n),\nRTR_Target_for_Ins_Upd_Insert AS (SELECT * FROM RTR_Target_for_Ins_Upd WHERE ISNULL(lkp_CMS_DOC_CNTL_NUM)),\nRTR_Target_for_Ins_Upd_Update AS (SELECT * FROM RTR_Target_for_Ins_Upd WHERE NOT ISNULL(lkp_CMS_DOC_CNTL_NUM)),\nUPD_Target_for_Upd AS (\n\tSELECT\n\tCMS_DOC_CNTL_NUM AS CMS_DOC_CNTL_NUM3, \n\to_WBMI_RECEIVED_DT AS o_WBMI_RECEIVED_DT3, \n\tMED_PARTC AS MED_PARTC3, \n\tPLAN_CONTRACT_NUM AS PLAN_CONTRACT_NUM3, \n\tENROLL_DATE AS ENROLL_DATE3, \n\tTERM_DATE AS TERM_DATE3, \n\tPLAN_CONTRACT_NAME AS PLAN_CONTRACT_NAME3, \n\tPLAN_BENEFIT_PACK_NUM AS PLAN_BENEFIT_PACK_NUM3, \n\tPLAN_CONTRACT_ADD1 AS PLAN_CONTRACT_ADD13, \n\tPLAN_CONTRACT_ADD2 AS PLAN_CONTRACT_ADD23, \n\tPLAN_CONTRACT_CITY AS PLAN_CONTRACT_CITY3, \n\tPLAN_CONTRACT_STATE AS PLAN_CONTRACT_STATE3, \n\tPLAN_CONTRACT_ZIP AS PLAN_CONTRACT_ZIP3, \n\tGCID_PLAN_CONTRACT_NUM AS GCID_PLAN_CONTRACT_NUM3\n\tFROM RTR_Target_for_Ins_Upd_Update\n),\nCMS_QRY_RESPONSE_PART_C_D_Upd AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_QRY_RESPONSE_PART_C_D AS T\n\tUSING UPD_Target_for_Upd AS S\n\tON T.CMS_DOC_CNTL_NUM = S.CMS_DOC_CNTL_NUM3\n\tAND T.WBMI_RECEIVED_DT = S.o_WBMI_RECEIVED_DT3\n\tAND T.MED_PARTC = S.MED_PARTC3\n\tAND T.PART_INSTANCE_NUM = S.GCID_PLAN_CONTRACT_NUM3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.PLAN_CONTRACT_NUM = S.PLAN_CONTRACT_NUM3, T.ENROLL_DATE = S.ENROLL_DATE3, T.TERM_DATE = S.TERM_DATE3, T.PLAN_CONTRACT_NAME = S.PLAN_CONTRACT_NAME3, T.PLAN_BENEFIT_PACK_NUM = S.PLAN_BENEFIT_PACK_NUM3, T.PLAN_CONTRACT_ADD1 = S.PLAN_CONTRACT_ADD13, T.PLAN_CONTRACT_ADD2 = S.PLAN_CONTRACT_ADD23, T.PLAN_CONTRACT_CITY = S.PLAN_CONTRACT_CITY3, T.PLAN_CONTRACT_STATE = S.PLAN_CONTRACT_STATE3, T.PLAN_CONTRACT_ZIP = S.PLAN_CONTRACT_ZIP3\n),\nCMS_QRY_RESPONSE_PART_C_D_Ins AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_QRY_RESPONSE_PART_C_D\n\t(CMS_DOC_CNTL_NUM, WBMI_RECEIVED_DT, MED_PARTC, PART_INSTANCE_NUM, PLAN_CONTRACT_NUM, ENROLL_DATE, TERM_DATE, PLAN_CONTRACT_NAME, PLAN_BENEFIT_PACK_NUM, PLAN_CONTRACT_ADD1, PLAN_CONTRACT_ADD2, PLAN_CONTRACT_CITY, PLAN_CONTRACT_STATE, PLAN_CONTRACT_ZIP)\n\tSELECT \n\tCMS_DOC_CNTL_NUM, \n\to_WBMI_RECEIVED_DT AS WBMI_RECEIVED_DT, \n\tMED_PARTC, \n\tGCID_PLAN_CONTRACT_NUM AS PART_INSTANCE_NUM, \n\tPLAN_CONTRACT_NUM, \n\tENROLL_DATE, \n\tTERM_DATE, \n\tPLAN_CONTRACT_NAME, \n\tPLAN_BENEFIT_PACK_NUM, \n\tPLAN_CONTRACT_ADD AS PLAN_CONTRACT_ADD1, \n\tPLAN_CONTRACT_ADD2, \n\tPLAN_CONTRACT_CITY, \n\tPLAN_CONTRACT_STATE, \n\tPLAN_CONTRACT_ZIP\n\tFROM RTR_Target_for_Ins_Upd_Insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_RECEIVED_DT_ONETIME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}