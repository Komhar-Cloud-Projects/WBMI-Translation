{
    "name": "m_CLM_DM_Checks_and_Balances_Loss_Master_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_Checks_and_Balances_Loss_Master_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_wbmi_checkout_loss_master AS (\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claimant_cov_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claimant_cov_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claimant_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claimant_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claim_occurrence_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claim_occurrence_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with pol_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where pol_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with agency_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where agency_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claim_rep_dim_prim_claim_rep_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claim_rep_dim_prim_claim_rep_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claim_trans_type_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claim_trans_type_dim_id = -1 )LMF\r\n\t\r\n\tUNION \r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with contract_cust_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where contract_cust_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claim_loss_date_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claim_loss_date_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with claim_trans_date_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where claim_trans_date_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with pol_eff_date_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where pol_eff_date_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with pol_exp_date_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where pol_exp_date_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with asl_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where asl_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with asl_prdct_code_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where asl_prdct_code_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with loss_master_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where loss_master_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with strtgc_bus_dvsn_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where strtgc_bus_dvsn_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with prdct_code_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where prdct_code_dim_id = -1 )LMF\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of loss_master_fact_id from Loss_Master_Fact with prdct_code_dim_id as -1 = ' + convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\tFROM (select loss_master_fact_id from Loss_Master_Fact where loss_master_run_date_id = -1 )LMF\n),\nEXP_Loss_master_input AS (\n\tSELECT\n\tcheckout_message AS check_out_message,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\ttarget_name,\n\ttarget_count,\n\t@{pipeline().parameters.WBMI_SESSION_CONTROL_RUN_ID} AS WBMI_SESSION_CONTROL_RUN_ID,\n\t'InformS' AS User_ID,\n\t0 AS Default_Amt,\n\t'W' AS checkout_type\n\tFROM SQ_wbmi_checkout_loss_master\n),\nFIL_ZERO_COUNTS AS (\n\tSELECT\n\tcheck_out_message, \n\tcreated_date, \n\tmodified_date, \n\ttarget_name, \n\ttarget_count, \n\tWBMI_SESSION_CONTROL_RUN_ID, \n\tUser_ID, \n\tDefault_Amt, \n\tcheckout_type\n\tFROM EXP_Loss_master_input\n\tWHERE target_count > 0\n),\nUPD_CHECKOUT_TABLE_INS AS (\n\tSELECT\n\tcheck_out_message, \n\tcreated_date, \n\tmodified_date, \n\ttarget_name, \n\ttarget_count, \n\tWBMI_SESSION_CONTROL_RUN_ID, \n\tUser_ID, \n\tDefault_Amt, \n\tcheckout_type\n\tFROM FIL_ZERO_COUNTS\n),\nwbmi_checkout_loss_master AS (\n\tINSERT INTO wbmi_checkout\n\t(wbmi_session_control_run_id, checkout_type_code, checkout_message, target_name, target_count, created_user_id, created_date, modified_user_id, modified_date)\n\tSELECT \n\tWBMI_SESSION_CONTROL_RUN_ID AS WBMI_SESSION_CONTROL_RUN_ID, \n\tcheckout_type AS CHECKOUT_TYPE_CODE, \n\tcheck_out_message AS CHECKOUT_MESSAGE, \n\tTARGET_NAME, \n\tTARGET_COUNT, \n\tUser_ID AS CREATED_USER_ID, \n\tCREATED_DATE, \n\tUser_ID AS MODIFIED_USER_ID, \n\tMODIFIED_DATE\n\tFROM UPD_CHECKOUT_TABLE_INS\n),\nSQ_wbmi_checkout_loss_master_counts AS (\n\tSELECT 'Count of Total transactions rows from Loss_Master_Fact with Loss Master Run Date as ' + CONVERT(varchar,CD.clndr_date,101) +  ' = '+ convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\t,CD.clndr_date as source_dt\r\n\tFROM \r\n\tloss_master_fact LMF, \r\n\tcalendar_dim CD \r\n\tWHERE LMF.loss_master_run_date_id = CD.clndr_id and clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tGROUP BY CD.clndr_date\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of Direct transactions rows from Loss_Master_Fact with Loss Master Run Date as ' + CONVERT(varchar,CD.clndr_date,101) +  ' = '+ convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\t,CD.clndr_date as source_dt\r\n\tFROM \r\n\tloss_master_fact LMF, \r\n\tclaim_transaction_type_dim CTTD, \r\n\tcalendar_dim CD \r\n\tWHERE \r\n\tCTTD.trans_kind_code='D' \r\n\tand LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tGROUP BY CD.clndr_date\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of Ceded transactions rows from Loss_Master_Fact with Loss Master Run Date as ' + CONVERT(varchar,CD.clndr_date,101) +  ' = '+ convert(varchar,count(*)) as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\t,CD.clndr_date as source_dt\r\n\tFROM \r\n\tloss_master_fact LMF, \r\n\tclaim_transaction_type_dim CTTD, \r\n\tcalendar_dim CD \r\n\tWHERE \r\n\tCTTD.trans_kind_code='C' \r\n\tand LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and CD.clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tGROUP BY CD.clndr_date\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of Direct transactions rows from Loss_Master_Fact with Loss Master Run Date as ' + CONVERT(varchar,CD.clndr_date,101) +  ' with MP 50 = ' +  convert(varchar,count(*))  as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\t,CD.clndr_date as source_dt\r\n\tFROM \r\n\tloss_master_fact LMF, \r\n\tclaim_transaction_type_dim CTTD, \r\n\tcalendar_dim CD,\r\n\tcoverage_dim COV  \r\n\tWHERE \r\n\tCTTD.trans_kind_code='D' \r\n\tand LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.cov_dim_id= COV.cov_dim_id\r\n\tand COV.major_peril_code='050'\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tGROUP BY CD.clndr_date\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Count of Ceded transactions rows from Loss_Master_Fact with Loss Master Run Date as ' + CONVERT(varchar,CD.clndr_date,101) +  ' with MP 50 = ' +  convert(varchar,count(*))  as check_out_message,'Loss_Master_Fact' as target_name, count(*) as target_count\r\n\t,CD.clndr_date as source_dt\r\n\tFROM \r\n\tloss_master_fact LMF, \r\n\tclaim_transaction_type_dim CTTD, \r\n\tcalendar_dim CD,\r\n\tcoverage_dim COV\r\n\tWHERE \r\n\tCTTD.trans_kind_code='C' \r\n\tand LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.cov_dim_id= COV.cov_dim_id\r\n\tand COV.major_peril_code='050'\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tGROUP BY CD.clndr_date\r\n\t\r\n\tUNION\r\n\t\r\n\tSELECT 'Difference between Direct and Ceded transactions Loss_Master_Fact with MP 50 = ' + convert(varchar,\r\n\t(SELECT count(*) FROM \r\n\t(SELECT loss_master_fact_id  FROM loss_master_fact LMF, claim_transaction_type_dim CTTD, calendar_dim CD, coverage_dim COV WHERE \r\n\tLMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and CD.clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tand LMF.cov_dim_id= COV.cov_dim_id and major_peril_code='050'\r\n\tINTERSECT\r\n\tSELECT loss_master_fact_id  FROM loss_master_fact LMF, claim_transaction_type_dim CTTD, calendar_dim CD, coverage_dim COV WHERE \r\n\tCTTD.trans_kind_code='C' and LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and CD.clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tand LMF.cov_dim_id= COV.cov_dim_id and major_peril_code='050'\r\n\t) as I\r\n\t)\r\n\t-\r\n\t(\r\n\tSELECT count(*) FROM \r\n\t(SELECT loss_master_fact_id  FROM loss_master_fact LMF, claim_transaction_type_dim CTTD, calendar_dim CD, coverage_dim COV WHERE \r\n\tLMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and CD.clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tand LMF.cov_dim_id= COV.cov_dim_id and major_peril_code='050'\r\n\tEXCEPT\r\n\tSELECT loss_master_fact_id  FROM loss_master_fact LMF, claim_transaction_type_dim CTTD, calendar_dim CD, coverage_dim COV WHERE \r\n\tCTTD.trans_kind_code='C' and LMF.claim_trans_type_dim_id=CTTD.claim_trans_type_dim_id\r\n\tand LMF.loss_master_run_date_id = CD.clndr_id and CD.clndr_date > DATEADD(Month,-1,'@{pipeline().parameters.SELECTION_START_TS}')\r\n\tand LMF.cov_dim_id= COV.cov_dim_id and major_peril_code='050'\r\n\t) as J\r\n\t)\r\n\t)as check_out_message\r\n\t,'Loss_Master_Fact' as target_name,\r\n\t0 as target_count,\r\n\t'1/1/1800' as source_dt\n),\nEXP_Loss_master_input_counts AS (\n\tSELECT\n\tcheckout_message AS check_out_message,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\ttarget_name,\n\ttarget_count,\n\tsource_dt,\n\t@{pipeline().parameters.WBMI_SESSION_CONTROL_RUN_ID} AS WBMI_SESSION_CONTROL_RUN_ID,\n\t'InformS' AS User_ID,\n\t0 AS Default_Amt,\n\t'C' AS checkout_type\n\tFROM SQ_wbmi_checkout_loss_master_counts\n),\nFIL_ZERO_COUNTS_counts AS (\n\tSELECT\n\tcheck_out_message, \n\tcreated_date, \n\tmodified_date, \n\ttarget_name, \n\ttarget_count, \n\tsource_dt, \n\tWBMI_SESSION_CONTROL_RUN_ID, \n\tUser_ID, \n\tDefault_Amt, \n\tcheckout_type\n\tFROM EXP_Loss_master_input_counts\n\tWHERE target_count > 0\n),\nUPD_CHECKOUT_TABLE_INS_counts AS (\n\tSELECT\n\tcheck_out_message, \n\tcreated_date, \n\tmodified_date, \n\ttarget_name, \n\ttarget_count, \n\tsource_dt, \n\tWBMI_SESSION_CONTROL_RUN_ID, \n\tUser_ID, \n\tDefault_Amt, \n\tcheckout_type\n\tFROM FIL_ZERO_COUNTS_counts\n),\nwbmi_checkout_loss_master_counts AS (\n\tINSERT INTO wbmi_checkout\n\t(wbmi_session_control_run_id, checkout_type_code, checkout_message, target_name, target_count, source_dt, created_user_id, created_date, modified_user_id, modified_date)\n\tSELECT \n\tWBMI_SESSION_CONTROL_RUN_ID AS WBMI_SESSION_CONTROL_RUN_ID, \n\tcheckout_type AS CHECKOUT_TYPE_CODE, \n\tcheck_out_message AS CHECKOUT_MESSAGE, \n\tTARGET_NAME, \n\tTARGET_COUNT, \n\tSOURCE_DT, \n\tUser_ID AS CREATED_USER_ID, \n\tCREATED_DATE, \n\tUser_ID AS MODIFIED_USER_ID, \n\tMODIFIED_DATE\n\tFROM UPD_CHECKOUT_TABLE_INS_counts\n),"
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": ""
        },
        "annotations": []
    }
}