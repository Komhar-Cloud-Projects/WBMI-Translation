{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_ArchWBGLLocationAccountStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_ArchWBGLLocationAccount_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WBGLLocationAccountStage AS (\n\tSELECT\n\t\tWBGLLocationAccountStageId,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tWB_CL_LocationAccountId,\n\t\tWB_GL_LocationAccountId,\n\t\tSessionId,\n\t\tLiabScheduleModCooperationMedicalSetLiabilityValue,\n\t\tLiabScheduleModCooperationMedicalSetCommentValue,\n\t\tSetCommentValue,\n\t\tLiabScheduleModClassificationSetLiabilityValue,\n\t\tLiabScheduleModCooperationSafetySetLiabilityValue,\n\t\tLiabScheduleModCooperationSafetySetCommentValue,\n\t\tLiabScheduleModEmployeesSetCommentValue,\n\t\tLiabScheduleModEmployeesSetLiabilityValue,\n\t\tLiabScheduleModEquipmentSetCommentValue,\n\t\tLiabScheduleModEquipmentSetLiabilityValue,\n\t\tLiabScheduleModLocationInsideSetCommentValue,\n\t\tLiabScheduleModLocationInsideSetLiabilityValue,\n\t\tLiabScheduleModLocationOutsideSetCommentValue,\n\t\tLiabScheduleModLocationOutsideSetLiabilityValue,\n\t\tLiabScheduleModPremisesSetCommentValue,\n\t\tLiabScheduleModPremisesSetLiabilityValue,\n\t\tLiquorPermitNumber,\n\t\tMunicipalAutoRate,\n\t\tMunicipalLiabilityRate,\n\t\tMunicipalMarineRate,\n\t\tMunicipalMinimumRate,\n\t\tMunicipalOtherRate,\n\t\tMunicipalPropertyRate,\n\t\tCountyAutoRate,\n\t\tCountyLiabilityRate,\n\t\tCountyMarineRate,\n\t\tCountyMinimumRate,\n\t\tCountyOtherRate,\n\t\tCountyPropertyRate,\n\t\tGeoTaxConfidence,\n\t\tCertifiedOperationsFactor,\n\t\tNighttimeOperationsFactor,\n\t\tProgramFactor,\n\t\tAssociationFactor,\n\t\tMaximumNumberOfChildren,\n\t\tHoursOpen,\n\t\tOnlyBeforeAndAfterSchoolCare,\n\t\tDogCatCoverage,\n\t\tDogBreedsPresent,\n\t\tOwnAnyBuildings,\n\t\tLeaseAnyBuildingsToOthers,\n\t\tTotalSquareFeetLeasedToOthers,\n\t\tTotalNumberApartments,\n\t\tIndependentContractors,\n\t\tNumberFullTimeBeauticians,\n\t\tNumberPartTimeBeauticians,\n\t\tNumberFullTimeElectrologists,\n\t\tNumberPartTimeElectrologists,\n\t\tNumberFullTimeMassageTherapists,\n\t\tNumberPartTimeMassageTherapists,\n\t\tNumberBeautyInstructors,\n\t\tNumberAquaMassageBeds,\n\t\tNumberSuntanBeds,\n\t\tNumberAirBrushOrSprayOnBooths,\n\t\tNumberHotTubs,\n\t\tNumberCircuitWorkout,\n\t\tOutdoorServiceArea\n\tFROM WBGLLocationAccountStage\n),\nEXPTRANS AS (\n\tSELECT\n\tWBGLLocationAccountStageId,\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tWB_CL_LocationAccountId,\n\tWB_GL_LocationAccountId,\n\tSessionId,\n\tLiabScheduleModCooperationMedicalSetLiabilityValue,\n\tLiabScheduleModCooperationMedicalSetCommentValue,\n\tSetCommentValue,\n\tLiabScheduleModClassificationSetLiabilityValue,\n\tLiabScheduleModCooperationSafetySetLiabilityValue,\n\tLiabScheduleModCooperationSafetySetCommentValue,\n\tLiabScheduleModEmployeesSetCommentValue,\n\tLiabScheduleModEmployeesSetLiabilityValue,\n\tLiabScheduleModEquipmentSetCommentValue,\n\tLiabScheduleModEquipmentSetLiabilityValue,\n\tLiabScheduleModLocationInsideSetCommentValue,\n\tLiabScheduleModLocationInsideSetLiabilityValue,\n\tLiabScheduleModLocationOutsideSetCommentValue,\n\tLiabScheduleModLocationOutsideSetLiabilityValue,\n\tLiabScheduleModPremisesSetCommentValue,\n\tLiabScheduleModPremisesSetLiabilityValue,\n\tLiquorPermitNumber,\n\tMunicipalAutoRate,\n\tMunicipalLiabilityRate,\n\tMunicipalMarineRate,\n\tMunicipalMinimumRate,\n\tMunicipalOtherRate,\n\tMunicipalPropertyRate,\n\tCountyAutoRate,\n\tCountyLiabilityRate,\n\tCountyMarineRate,\n\tCountyMinimumRate,\n\tCountyOtherRate,\n\tCountyPropertyRate,\n\tGeoTaxConfidence,\n\tCertifiedOperationsFactor,\n\tNighttimeOperationsFactor,\n\tProgramFactor,\n\tAssociationFactor,\n\tMaximumNumberOfChildren,\n\tHoursOpen,\n\tOnlyBeforeAndAfterSchoolCare AS i_OnlyBeforeAndAfterSchoolCare,\n\t-- *INF*: IIF(i_OnlyBeforeAndAfterSchoolCare='T','1','0')\n\tIFF(i_OnlyBeforeAndAfterSchoolCare = 'T', '1', '0') AS o_OnlyBeforeAndAfterSchoolCare1,\n\tDogCatCoverage,\n\tDogBreedsPresent AS i_DogBreedsPresent,\n\t-- *INF*: IIF(i_DogBreedsPresent='T','1','0')\n\tIFF(i_DogBreedsPresent = 'T', '1', '0') AS o_DogBreedsPresent,\n\tOwnAnyBuildings AS i_OwnAnyBuildings,\n\t-- *INF*: IIF(i_OwnAnyBuildings='T','1','0')\n\tIFF(i_OwnAnyBuildings = 'T', '1', '0') AS o_OwnAnyBuildings,\n\tLeaseAnyBuildingsToOthers AS i_LeaseAnyBuildingsToOthers,\n\t-- *INF*: IIF(i_LeaseAnyBuildingsToOthers='T','1','0')\n\tIFF(i_LeaseAnyBuildingsToOthers = 'T', '1', '0') AS o_LeaseAnyBuildingsToOthers,\n\tTotalSquareFeetLeasedToOthers,\n\tTotalNumberApartments,\n\tIndependentContractors AS i_IndependentContractors,\n\t-- *INF*: IIF(i_IndependentContractors='T','1','0')\n\tIFF(i_IndependentContractors = 'T', '1', '0') AS o_IndependentContractors,\n\tNumberFullTimeBeauticians,\n\tNumberPartTimeBeauticians,\n\tNumberFullTimeElectrologists,\n\tNumberPartTimeElectrologists,\n\tNumberFullTimeMassageTherapists,\n\tNumberPartTimeMassageTherapists,\n\tNumberBeautyInstructors,\n\tNumberAquaMassageBeds,\n\tNumberSuntanBeds,\n\tNumberAirBrushOrSprayOnBooths,\n\tNumberHotTubs,\n\tNumberCircuitWorkout,\n\tOutdoorServiceArea\n\tFROM SQ_WBGLLocationAccountStage\n),\nArchWBGLLocationAccountStage AS (\n\tINSERT INTO ArchWBGLLocationAccountStage\n\t(ExtractDate, SourceSystemId, AuditId, WBGLLocationAccountStageId, WB_CL_LocationAccountId, WB_GL_LocationAccountId, SessionId, LiabScheduleModCooperationMedicalSetLiabilityValue, LiabScheduleModCooperationMedicalSetCommentValue, SetCommentValue, LiabScheduleModClassificationSetLiabilityValue, LiabScheduleModCooperationSafetySetLiabilityValue, LiabScheduleModCooperationSafetySetCommentValue, LiabScheduleModEmployeesSetCommentValue, LiabScheduleModEmployeesSetLiabilityValue, LiabScheduleModEquipmentSetCommentValue, LiabScheduleModEquipmentSetLiabilityValue, LiabScheduleModLocationInsideSetCommentValue, LiabScheduleModLocationInsideSetLiabilityValue, LiabScheduleModLocationOutsideSetCommentValue, LiabScheduleModLocationOutsideSetLiabilityValue, LiabScheduleModPremisesSetCommentValue, LiabScheduleModPremisesSetLiabilityValue, LiquorPermitNumber, MunicipalAutoRate, MunicipalLiabilityRate, MunicipalMarineRate, MunicipalMinimumRate, MunicipalOtherRate, MunicipalPropertyRate, CountyAutoRate, CountyLiabilityRate, CountyMarineRate, CountyMinimumRate, CountyOtherRate, CountyPropertyRate, GeoTaxConfidence, CertifiedOperationsFactor, NighttimeOperationsFactor, ProgramFactor, AssociationFactor, MaximumNumberOfChildren, HoursOpen, OnlyBeforeAndAfterSchoolCare, DogCatCoverage, DogBreedsPresent, OwnAnyBuildings, LeaseAnyBuildingsToOthers, TotalSquareFeetLeasedToOthers, TotalNumberApartments, IndependentContractors, NumberFullTimeBeauticians, NumberPartTimeBeauticians, NumberFullTimeElectrologists, NumberPartTimeElectrologists, NumberFullTimeMassageTherapists, NumberPartTimeMassageTherapists, NumberBeautyInstructors, NumberAquaMassageBeds, NumberSuntanBeds, NumberAirBrushOrSprayOnBooths, NumberHotTubs, NumberCircuitWorkout, OutdoorServiceArea)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID, \n\tWBGLLOCATIONACCOUNTSTAGEID, \n\tWB_CL_LOCATIONACCOUNTID, \n\tWB_GL_LOCATIONACCOUNTID, \n\tSESSIONID, \n\tLIABSCHEDULEMODCOOPERATIONMEDICALSETLIABILITYVALUE, \n\tLIABSCHEDULEMODCOOPERATIONMEDICALSETCOMMENTVALUE, \n\tSETCOMMENTVALUE, \n\tLIABSCHEDULEMODCLASSIFICATIONSETLIABILITYVALUE, \n\tLIABSCHEDULEMODCOOPERATIONSAFETYSETLIABILITYVALUE, \n\tLIABSCHEDULEMODCOOPERATIONSAFETYSETCOMMENTVALUE, \n\tLIABSCHEDULEMODEMPLOYEESSETCOMMENTVALUE, \n\tLIABSCHEDULEMODEMPLOYEESSETLIABILITYVALUE, \n\tLIABSCHEDULEMODEQUIPMENTSETCOMMENTVALUE, \n\tLIABSCHEDULEMODEQUIPMENTSETLIABILITYVALUE, \n\tLIABSCHEDULEMODLOCATIONINSIDESETCOMMENTVALUE, \n\tLIABSCHEDULEMODLOCATIONINSIDESETLIABILITYVALUE, \n\tLIABSCHEDULEMODLOCATIONOUTSIDESETCOMMENTVALUE, \n\tLIABSCHEDULEMODLOCATIONOUTSIDESETLIABILITYVALUE, \n\tLIABSCHEDULEMODPREMISESSETCOMMENTVALUE, \n\tLIABSCHEDULEMODPREMISESSETLIABILITYVALUE, \n\tLIQUORPERMITNUMBER, \n\tMUNICIPALAUTORATE, \n\tMUNICIPALLIABILITYRATE, \n\tMUNICIPALMARINERATE, \n\tMUNICIPALMINIMUMRATE, \n\tMUNICIPALOTHERRATE, \n\tMUNICIPALPROPERTYRATE, \n\tCOUNTYAUTORATE, \n\tCOUNTYLIABILITYRATE, \n\tCOUNTYMARINERATE, \n\tCOUNTYMINIMUMRATE, \n\tCOUNTYOTHERRATE, \n\tCOUNTYPROPERTYRATE, \n\tGEOTAXCONFIDENCE, \n\tCERTIFIEDOPERATIONSFACTOR, \n\tNIGHTTIMEOPERATIONSFACTOR, \n\tPROGRAMFACTOR, \n\tASSOCIATIONFACTOR, \n\tMAXIMUMNUMBEROFCHILDREN, \n\tHOURSOPEN, \n\to_OnlyBeforeAndAfterSchoolCare1 AS ONLYBEFOREANDAFTERSCHOOLCARE, \n\tDOGCATCOVERAGE, \n\to_DogBreedsPresent AS DOGBREEDSPRESENT, \n\to_OwnAnyBuildings AS OWNANYBUILDINGS, \n\to_LeaseAnyBuildingsToOthers AS LEASEANYBUILDINGSTOOTHERS, \n\tTOTALSQUAREFEETLEASEDTOOTHERS, \n\tTOTALNUMBERAPARTMENTS, \n\to_IndependentContractors AS INDEPENDENTCONTRACTORS, \n\tNUMBERFULLTIMEBEAUTICIANS, \n\tNUMBERPARTTIMEBEAUTICIANS, \n\tNUMBERFULLTIMEELECTROLOGISTS, \n\tNUMBERPARTTIMEELECTROLOGISTS, \n\tNUMBERFULLTIMEMASSAGETHERAPISTS, \n\tNUMBERPARTTIMEMASSAGETHERAPISTS, \n\tNUMBERBEAUTYINSTRUCTORS, \n\tNUMBERAQUAMASSAGEBEDS, \n\tNUMBERSUNTANBEDS, \n\tNUMBERAIRBRUSHORSPRAYONBOOTHS, \n\tNUMBERHOTTUBS, \n\tNUMBERCIRCUITWORKOUT, \n\tOUTDOORSERVICEAREA\n\tFROM EXPTRANS\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}