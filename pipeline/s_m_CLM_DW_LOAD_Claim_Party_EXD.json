{
    "name": "s_m_CLM_DW_LOAD_Claim_Party_EXD",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DW_LOAD_Claim_Party_EXD",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_client_phone_stage AS (\n\tSELECT\n\tciph_phn_nbr,\n\tclient_id,\n\tphn_typ_cd\n\tFROM (\n\t\tSELECT \r\n\t\t\tLTRIM(RTRIM(client_phone_stage.ciph_phn_nbr)) as ciph_phn_nbr, \r\n\t\t\tLTRIM(RTRIM(client_phone_stage.client_id)) as client_id, \r\n\t\t\tLTRIM(RTRIM(client_phone_stage.phn_typ_cd)) as phn_typ_cd \r\n\t\tFROM \r\n\t\t\tclient_phone_stage\r\n\t\tWHERE\r\n\t\t\tCIPH_EXP_DT= '9999-12-31'\r\n\t\tORDER BY \r\n\t\t\tCIPH_PHN_SEQ_NBR, CIPH_EFF_ACY_TS --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY client_id,phn_typ_cd ORDER BY ciph_phn_nbr DESC) = 1\n),\nLKP_CLT_ADR_RELATION_STAGE AS (\n\tSELECT\n\tADR_ID,\n\tCLIENT_ID,\n\tADR_TYP_CD\n\tFROM (\n\t\tSELECT \r\n\t\ta.ADR_ID as ADR_ID, \r\n\t\tLTRIM(RTRIM(a.CLIENT_ID)) as CLIENT_ID, \r\n\t\tLTRIM(RTRIM(a.ADR_TYP_CD)) as ADR_TYP_CD \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.CLT_ADR_RELATION_STAGE a\r\n\t\tWHERE\r\n\t\ta.CIAR_EXP_DT= '9999-12-31'\r\n\t\tORDER BY a.ADR_SEQ_NBR --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY CLIENT_ID,ADR_TYP_CD ORDER BY ADR_ID DESC) = 1\n),\nLKP_CLIENT_TAX_STAGE AS (\n\tSELECT\n\tcitx_tax_id,\n\tclient_id,\n\ttax_type_cd\n\tFROM (\n\t\tSELECT \r\n\t\tltrim(rtrim(a.citx_tax_id)) as citx_tax_id, \t\r\n\t\ta.client_id as client_id, \r\n\t\trtrim(a.tax_type_cd) as tax_type_cd \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.client_tax_stage a\r\n\t\tWHERE expiration_acy_ts = '9999-12-31'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY client_id,tax_type_cd ORDER BY citx_tax_id) = 1\n),\nSQ_CLIENT_TAB_STAGE AS (\n\tSELECT \r\n\tCLIENT_TAB_STAGE.CLIENT_ID, \r\n\tCLIENT_TAB_STAGE.CICL_FST_NM,\r\n\tCLIENT_TAB_STAGE.CICL_LST_NM,\r\n\tCLIENT_TAB_STAGE.CICL_MDL_NM,\r\n\tCLIENT_TAB_STAGE.NM_PFX,\r\n\tCLIENT_TAB_STAGE.NM_SFX,\r\n\tCLIENT_TAB_STAGE.LEG_ENT_CD,\r\n\tCLIENT_TAB_STAGE.CICL_DOB_DT, \r\n\tCLIENT_TAB_STAGE.GENDER_CD, \r\n\tCLIENT_TAB_STAGE.CICL_EFF_ACY_TS,\r\n\tLTRIM(RTRIM(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(CLIENT_TAB_STAGE.CICL_LNG_NM,'$',''),'?',''),'.',''),',',''),'_',''),'/','')))\r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.CLIENT_TAB_STAGE\r\n\tWHERE\r\n\t  CICL_EXP_DT = '9999-12-31'\r\n\t\r\n\t--SELECT \r\n\t--CLIENT_TAB_STAGE.CLIENT_ID, \r\n\t--CLIENT_TAB_STAGE.CICL_FST_NM,\r\n\t--CLIENT_TAB_STAGE.CICL_LST_NM,\r\n\t--CLIENT_TAB_STAGE.CICL_MDL_NM,\r\n\t--CLIENT_TAB_STAGE.NM_PFX,\r\n\t--CLIENT_TAB_STAGE.NM_SFX,\r\n\t--CLIENT_TAB_STAGE.LEG_ENT_CD,\r\n\t--CLIENT_TAB_STAGE.CICL_DOB_DT, \r\n\t--CLIENT_TAB_STAGE.GENDER_CD, \r\n\t--CLIENT_TAB_STAGE.CICL_EFF_ACY_TS,\r\n\t--LTRIM(RTRIM(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(replace(CLIENT_TAB_STAGE.CICL_LNG_NM,'+',''),'-',''),'$',''),'?',''),'.',''),',',''),'_',''),',',''),'/','')))\r\n\t--FROM\r\n\t--@{pipeline().parameters.SOURCE_TABLE_OWNER}.CLIENT_TAB_STAGE\r\n\t--WHERE\r\n\t-- CICL_EXP_DT = '9999-12-31'\n),\nEXP_Values AS (\n\tSELECT\n\tCLIENT_ID,\n\tCICL_FST_NM,\n\tCICL_LST_NM,\n\tCICL_MDL_NM,\n\tNM_PFX,\n\tNM_SFX,\n\tCICL_LNG_NM,\n\tCICL_DOB_DT,\n\tGENDER_CD,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'INHM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHM.ADR_ID AS ADR_ID_INHM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'BSM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSM.ADR_ID AS ADR_ID_BSM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'ALM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALM.ADR_ID AS ADR_ID_ALM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'ALL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALL.ADR_ID AS ADR_ID_ALL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'BSL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSL.ADR_ID AS ADR_ID_BSL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'MAL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_MAL.ADR_ID AS ADR_ID_MAL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'CLM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLM.ADR_ID AS ADR_ID_CLM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'LOC')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LOC.ADR_ID AS ADR_ID_LOC,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'BLM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLM.ADR_ID AS ADR_ID_BLM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PPL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PPL.ADR_ID AS ADR_ID_PPL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'BLRT')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLRT.ADR_ID AS ADR_ID_BLRT,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'BSS')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSS.ADR_ID AS ADR_ID_BSS,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'GL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_GL.ADR_ID AS ADR_ID_GL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'CLL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLL.ADR_ID AS ADR_ID_CLL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'HHA')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_HHA.ADR_ID AS ADR_ID_HHA,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'INHA')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHA.ADR_ID AS ADR_ID_INHA,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'LPE')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPE.ADR_ID AS ADR_ID_LPE,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PMF')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PMF.ADR_ID AS ADR_ID_PMF,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'INHL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHL.ADR_ID AS ADR_ID_INHL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PLG')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLG.ADR_ID AS ADR_ID_PLG,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'TMPM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_TMPM.ADR_ID AS ADR_ID_TMPM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'INWL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWL.ADR_ID AS ADR_ID_INWL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'INWM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWM.ADR_ID AS ADR_ID_INWM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'LPA')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPA.ADR_ID AS ADR_ID_LPA,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PLB')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLB.ADR_ID AS ADR_ID_PLB,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PLL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLL.ADR_ID AS ADR_ID_PLL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PLM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLM.ADR_ID AS ADR_ID_PLM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'PRAD')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PRAD.ADR_ID AS ADR_ID_PRAD,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'SPL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_SPL.ADR_ID AS ADR_ID_SPL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'VCL')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCL.ADR_ID AS ADR_ID_VCL,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'VCM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCM.ADR_ID AS ADR_ID_VCM,\n\t-- *INF*: :LKP.LKP_CLT_ADR_RELATION_STAGE(CLIENT_ID, 'COM')\n\tLKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_COM.ADR_ID AS ADR_ID_COM,\n\tLEG_ENT_CD,\n\tCICL_EFF_ACY_TS\n\tFROM SQ_CLIENT_TAB_STAGE\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHM.ADR_TYP_CD = 'INHM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSM.ADR_TYP_CD = 'BSM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALM.ADR_TYP_CD = 'ALM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_ALL.ADR_TYP_CD = 'ALL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSL.ADR_TYP_CD = 'BSL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_MAL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_MAL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_MAL.ADR_TYP_CD = 'MAL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLM.ADR_TYP_CD = 'CLM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LOC\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LOC.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LOC.ADR_TYP_CD = 'LOC'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLM.ADR_TYP_CD = 'BLM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PPL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PPL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PPL.ADR_TYP_CD = 'PPL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLRT\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLRT.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BLRT.ADR_TYP_CD = 'BLRT'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSS\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSS.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_BSS.ADR_TYP_CD = 'BSS'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_GL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_GL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_GL.ADR_TYP_CD = 'GL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_CLL.ADR_TYP_CD = 'CLL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_HHA\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_HHA.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_HHA.ADR_TYP_CD = 'HHA'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHA\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHA.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHA.ADR_TYP_CD = 'INHA'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPE\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPE.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPE.ADR_TYP_CD = 'LPE'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PMF\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PMF.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PMF.ADR_TYP_CD = 'PMF'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INHL.ADR_TYP_CD = 'INHL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLG\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLG.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLG.ADR_TYP_CD = 'PLG'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_TMPM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_TMPM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_TMPM.ADR_TYP_CD = 'TMPM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWL.ADR_TYP_CD = 'INWL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_INWM.ADR_TYP_CD = 'INWM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPA\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPA.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_LPA.ADR_TYP_CD = 'LPA'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLB\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLB.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLB.ADR_TYP_CD = 'PLB'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLL.ADR_TYP_CD = 'PLL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PLM.ADR_TYP_CD = 'PLM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PRAD\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PRAD.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_PRAD.ADR_TYP_CD = 'PRAD'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_SPL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_SPL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_SPL.ADR_TYP_CD = 'SPL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCL\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCL.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCL.ADR_TYP_CD = 'VCL'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_VCM.ADR_TYP_CD = 'VCM'\n\n\tLEFT JOIN LKP_CLT_ADR_RELATION_STAGE LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_COM\n\tON LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_COM.CLIENT_ID = CLIENT_ID\n\tAND LKP_CLT_ADR_RELATION_STAGE_CLIENT_ID_COM.ADR_TYP_CD = 'COM'\n\n),\nLKP_client_phone_stage_by_priority AS (\n\tSELECT\n\tciph_phn_nbr,\n\tphn_typ_cd,\n\tciph_phn_seq_nbr,\n\tclient_id\n\tFROM (\n\t\tSELECT \r\n\t\t\tLTRIM(RTRIM(client_phone_stage.ciph_phn_nbr)) as ciph_phn_nbr, \r\n\t\t\tLTRIM(RTRIM(client_phone_stage.phn_typ_cd)) as phn_typ_cd,\r\n\t\t\tcase phn_typ_cd\r\n\t\t\t\twhen 'IH' then 1 -- HOME\t\t\r\n\t\t\t\twhen 'BS' then 2 -- Business\r\n\t\t\t\twhen 'IW' then 3 -- WORK\r\n\t\t\t\twhen 'ML' then 4 -- MOBILE\t\t\r\n\t\t\t\twhen 'CP' then 5 -- Contac\r\n\t\t\t\twhen 'HH' then 6 -- HOUSEHOLD\r\n\t\t\t\twhen 'FX' then 7 -- FAX\r\n\t\t\t\twhen 'TF' then 8 -- TOLL FREE\r\n\t\t\t\twhen 'MS' then 9 -- MESSAGES\t\t\r\n\t\t\t\twhen 'IV' then 10 -- VACATION\r\n\t\t\t\twhen 'PG' then 11 -- PAGER\r\n\t\t\t\twhen 'MO' then 12 -- MODEM\r\n\t\t\t\twhen 'EM' then 13 -- Emergency\r\n\t\t\t\twhen 'SS' then 14 -- SHIP-TO-SHORE\r\n\t\t\t\twhen 'AL' then 15 -- not valid for exceed\r\n\t\t\t\telse 99\r\n\t\t\tend as ciph_phn_seq_nbr,\r\n\t\t\tLTRIM(RTRIM(client_phone_stage.client_id)) as client_id\r\n\t\tFROM \r\n\t\t\tclient_phone_stage\r\n\t\tWHERE\r\n\t\t\tCIPH_EXP_DT= '9999-12-31' \r\n\t\tORDER BY \r\n\t\tciph_phn_seq_nbr --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY client_id ORDER BY ciph_phn_nbr) = 1\n),\nEXP_phone AS (\n\tSELECT\n\tciph_phn_nbr,\n\tphn_typ_cd,\n\t-- *INF*: IIF(isnull(ciph_phn_nbr),'N/A',rtrim(ltrim(ciph_phn_nbr)))\r\n\t-- \r\n\t-- \n\tIFF(ciph_phn_nbr IS NULL,\n\t\t'N/A',\n\t\trtrim(ltrim(ciph_phn_nbr\n\t\t\t)\n\t\t)\n\t) AS v_Phone_Num,\n\t-- *INF*: IIF(isnull(phn_typ_cd),'N/A',phn_typ_cd)\n\tIFF(phn_typ_cd IS NULL,\n\t\t'N/A',\n\t\tphn_typ_cd\n\t) AS v_Phone_Type,\n\t-- *INF*: IIF(ISNULL(v_Phone_Num),'N/A',\r\n\t-- REPLACECHR(FALSE,REPLACECHR(FALSE,REPLACECHR(FALSE,v_Phone_Num,'-',''),')',''),'(','')\r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- ---Replace ( ) and - in phone number with blanks so (320)259-0824EXT becomes 3202590824EXT\r\n\t-- \r\n\t-- \n\tIFF(v_Phone_Num IS NULL,\n\t\t'N/A',\n\t\tREGEXP_REPLACE(REGEXP_REPLACE(REGEXP_REPLACE(v_Phone_Num,'-',''),')',''),'(','')\n\t) AS v_Phone,\n\tciph_phn_seq_nbr,\n\t-- *INF*: IIF(v_Phone = 'N/A', 'N/A',SUBSTR(v_Phone,1,10))\r\n\t-- \r\n\t-- --take value before EXT\n\tIFF(v_Phone = 'N/A',\n\t\t'N/A',\n\t\tSUBSTR(v_Phone, 1, 10\n\t\t)\n\t) AS Phone,\n\t-- *INF*: IIF(v_Phone = 'N/A', 'N/A',IIF(LENGTH(SUBSTR(v_Phone,12,7))=0,'N/A', SUBSTR(v_Phone,12,7)))\r\n\t-- \r\n\t-- //Take value after X\r\n\t-- \r\n\t-- \r\n\t-- //Changed to code above do to DAP-399\r\n\t-- //IIF(v_Phone = 'N/A', 'N/A',IIF(LENGTH(SUBSTR(v_Phone,14,5))=0,'N/A', SUBSTR(v_Phone,14,5)))\r\n\t-- ----Take value after EXT\n\tIFF(v_Phone = 'N/A',\n\t\t'N/A',\n\t\tIFF(LENGTH(SUBSTR(v_Phone, 12, 7\n\t\t\t\t)\n\t\t\t) = 0,\n\t\t\t'N/A',\n\t\t\tSUBSTR(v_Phone, 12, 7\n\t\t\t)\n\t\t)\n\t) AS Phone_Extn,\n\t-- *INF*: IIF(ISNULL(v_Phone_Type),'N/A',v_Phone_Type)\n\tIFF(v_Phone_Type IS NULL,\n\t\t'N/A',\n\t\tv_Phone_Type\n\t) AS Phone_Type\n\tFROM LKP_client_phone_stage_by_priority\n),\nLKP_CLIENT_ADDRESS_STAGE_ALL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_ALM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_BLM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_BLRT AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_BSL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_BSM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_BSS AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_CLL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_CLM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_COM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_GL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_HHA AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_INHA AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_INHL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_INHM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_INWL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_INWM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_LOC AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_LPA AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_LPE AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_MAL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PLB AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PLG AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PLL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PLM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PMF AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PPL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_PRAD AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_SPL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_TMPM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_VCL AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_CLIENT_ADDRESS_STAGE_VCM AS (\n\tSELECT\n\tCICA_PST_CD,\n\tST_CD,\n\tCICA_ADR_1,\n\tCICA_ADR_2,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tADR_ID\n\tFROM (\n\t\tSELECT \n\t\t\tCICA_PST_CD,\n\t\t\tST_CD,\n\t\t\tCICA_ADR_1,\n\t\t\tCICA_ADR_2,\n\t\t\tCICA_CIT_NM,\n\t\t\tCICA_CTY,\n\t\t\tADR_ID\n\t\tFROM CLIENT_ADDRESS_STAGE\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ADR_ID ORDER BY CICA_PST_CD) = 1\n),\nLKP_IndividualClientStage AS (\n\tSELECT\n\tCIID_DTH_DT,\n\tCLIENT_ID\n\tFROM (\n\t\tSELECT CLIENT_ID as CLIENT_ID,\r\n\t\t\tCIID_DTH_DT as CIID_DTH_DT, \r\n\t\t\tCIID_EFF_ACY_TS as CIID_EFF_ACY_TS \r\n\t\tFROM dbo.IndividualClientStage\r\n\t\tWHERE CIID_EXP_DT = '9999-12-31'\r\n\t\tORDER BY CIID_EFF_ACY_TS\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY CLIENT_ID ORDER BY CIID_DTH_DT DESC) = 1\n),\nmplt_split_client_tab_long_name AS (WITH\n\tINPUT_long_name AS (\n\t\t\n\t),\n\tEXP_accept_input AS (\n\t\tSELECT\n\t\tlong_name\n\t\tFROM INPUT_long_name\n\t),\n\tEXP_split_name AS (\n\t\tSELECT\n\t\tlong_name,\n\t\t-- *INF*: instr(long_name,'+',1,1,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 1 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 1, 0\n\t\t) AS v_prefix,\n\t\t-- *INF*: instr(long_name,'+',1,2,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 2 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 2, 0\n\t\t) AS v_first,\n\t\t-- *INF*: instr(long_name,'+',1,3,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 3 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 3, 0\n\t\t) AS v_middle,\n\t\t-- *INF*: instr(long_name,'+',1,4,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 4 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 4, 0\n\t\t) AS v_last,\n\t\t-- *INF*: instr(long_name,'+',1,5,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 5 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 5, 0\n\t\t) AS v_suffix,\n\t\t-- *INF*: instr(long_name,'+',1,6,0)\r\n\t\t-- -- we are using instr to find the value \"+\" starting at position 1 and occurrence 6 not case sensitive\n\t\tREGEXP_INSTR(long_name, '+', 1, 6, 0\n\t\t) AS v_end,\n\t\t-- *INF*: ltrim(rtrim(replacestr(0,substr(long_name,v_prefix,v_first - v_prefix),'+','')))\r\n\t\t-- --we use substring to find the characters in long_name starting at the position v_prefix for a length of v_first - v_prefix.  Then we replace the \"+\" which will be the leading character with an empty string and finally we trim it\n\t\tltrim(rtrim(REGEXP_REPLACE(substr(long_name, v_prefix, v_first - v_prefix\n\t\t\t\t),'+','','i')\n\t\t\t)\n\t\t) AS prefix,\n\t\t-- *INF*: ltrim(rtrim(replacestr(0,substr(long_name,v_first,v_middle - v_first),'+','')))\r\n\t\t-- --we use substring to find the characters in long_name starting at the position v_first for a length of v_middle - v_first.  Then we replace the \"+\" which will be the leading character with an empty string and finally we trim it\n\t\tltrim(rtrim(REGEXP_REPLACE(substr(long_name, v_first, v_middle - v_first\n\t\t\t\t),'+','','i')\n\t\t\t)\n\t\t) AS first_name,\n\t\t-- *INF*: ltrim(rtrim(replacestr(0,substr(long_name,v_middle,v_last - v_middle),'+','')))\r\n\t\t-- --we use substring to find the characters in long_name starting at the position v_middle for a length of v_last - v_middle.  Then we replace the \"+\" which will be the leading character with an empty string and finally we trim it\n\t\tltrim(rtrim(REGEXP_REPLACE(substr(long_name, v_middle, v_last - v_middle\n\t\t\t\t),'+','','i')\n\t\t\t)\n\t\t) AS middle_name,\n\t\t-- *INF*: ltrim(rtrim(replacestr(0,substr(long_name,v_last,v_suffix - v_last),'+','')))\r\n\t\t-- --we use substring to find the characters in long_name starting at the position v_last for a length of v_suffix - v_last.  Then we replace the \"+\" which will be the leading character with an empty string and finally we trim it\n\t\tltrim(rtrim(REGEXP_REPLACE(substr(long_name, v_last, v_suffix - v_last\n\t\t\t\t),'+','','i')\n\t\t\t)\n\t\t) AS last_name,\n\t\t-- *INF*: ltrim(rtrim(replacestr(0,substr(long_name,v_suffix,v_end - v_suffix),'+','')))\r\n\t\t-- --we use substring to find the characters in long_name starting at the position v_suffix for a length of v_end - v_suffix.  Then we replace the \"+\" which will be the leading character with an empty string and finally we trim it\n\t\tltrim(rtrim(REGEXP_REPLACE(substr(long_name, v_suffix, v_end - v_suffix\n\t\t\t\t),'+','','i')\n\t\t\t)\n\t\t) AS suffix\n\t\tFROM EXP_accept_input\n\t),\n\tEXP_build_full_name AS (\n\t\tSELECT\n\t\tprefix,\n\t\tfirst_name,\n\t\tmiddle_name,\n\t\tlast_name,\n\t\tsuffix,\n\t\t-- *INF*: rtrim(ltrim(\r\n\t\t-- IIF(length(prefix)>0,prefix || ' ','')\r\n\t\t-- ||\r\n\t\t-- IIF(length(first_name)>0,first_name || ' ','')\r\n\t\t-- ||\r\n\t\t-- IIF(length(middle_name)>0,middle_name || ' ','')\r\n\t\t-- ||\r\n\t\t-- IIF(length(last_name)>0,last_name || ' ','')\r\n\t\t-- ||\r\n\t\t-- IIF(length(suffix)>0,suffix || ' ','')\r\n\t\t-- )\r\n\t\t-- )\n\t\trtrim(ltrim(IFF(length(prefix\n\t\t\t\t\t) > 0,\n\t\t\t\t\tprefix || ' ',\n\t\t\t\t\t''\n\t\t\t\t) || IFF(length(first_name\n\t\t\t\t\t) > 0,\n\t\t\t\t\tfirst_name || ' ',\n\t\t\t\t\t''\n\t\t\t\t) || IFF(length(middle_name\n\t\t\t\t\t) > 0,\n\t\t\t\t\tmiddle_name || ' ',\n\t\t\t\t\t''\n\t\t\t\t) || IFF(length(last_name\n\t\t\t\t\t) > 0,\n\t\t\t\t\tlast_name || ' ',\n\t\t\t\t\t''\n\t\t\t\t) || IFF(length(suffix\n\t\t\t\t\t) > 0,\n\t\t\t\t\tsuffix || ' ',\n\t\t\t\t\t''\n\t\t\t\t)\n\t\t\t)\n\t\t) AS full_name\n\t\tFROM EXP_split_name\n\t),\n\tEXP_accept_output AS (\n\t\tSELECT\n\t\tprefix,\n\t\tfirst_name,\n\t\tmiddle_name,\n\t\tlast_name,\n\t\tsuffix,\n\t\tfull_name\n\t\tFROM EXP_build_full_name\n\t),\n\tOUTPUT_split_name AS (\n\t\tSELECT\n\t\tprefix, \n\t\tfirst_name, \n\t\tmiddle_name, \n\t\tlast_name, \n\t\tsuffix, \n\t\tfull_name\n\t\tFROM EXP_accept_output\n\t),\n),\nEXP_Lkp_Values AS (\n\tSELECT\n\tEXP_Values.CLIENT_ID,\n\tEXP_Values.CICL_FST_NM AS in_CICL_FST_NM,\n\t-- *INF*: iif(isnull(in_CICL_FST_NM),'N/A',\r\n\t--    iif(is_spaces(in_CICL_FST_NM),'N/A',\r\n\t--     rtrim(in_CICL_FST_NM)))\r\n\t-- \r\n\t-- \n\tIFF(in_CICL_FST_NM IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_CICL_FST_NM)>0 AND TRIM(in_CICL_FST_NM)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_CICL_FST_NM\n\t\t\t)\n\t\t)\n\t) AS CICL_FST_NM,\n\tEXP_Values.CICL_LST_NM AS in_CICL_LST_NM,\n\t-- *INF*: iif(isnull(in_CICL_LST_NM),'N/A',\r\n\t--    iif(is_spaces(in_CICL_LST_NM),'N/A',\r\n\t--     rtrim(in_CICL_LST_NM)))\n\tIFF(in_CICL_LST_NM IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_CICL_LST_NM)>0 AND TRIM(in_CICL_LST_NM)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_CICL_LST_NM\n\t\t\t)\n\t\t)\n\t) AS CICL_LST_NM,\n\tEXP_Values.CICL_MDL_NM AS in_CICL_MDL_NM,\n\t-- *INF*: iif(isnull(in_CICL_MDL_NM),'N/A',\r\n\t--    iif(is_spaces(in_CICL_MDL_NM),'N/A',\r\n\t--     rtrim(in_CICL_MDL_NM)))\n\tIFF(in_CICL_MDL_NM IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_CICL_MDL_NM)>0 AND TRIM(in_CICL_MDL_NM)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_CICL_MDL_NM\n\t\t\t)\n\t\t)\n\t) AS CICL_MDL_NM,\n\tEXP_Values.NM_PFX AS in_NM_PFX,\n\t-- *INF*: iif(isnull(in_NM_PFX),'N/A',\r\n\t--    iif(is_spaces(in_NM_PFX),'N/A',\r\n\t--     rtrim(in_NM_PFX)))\r\n\t-- \r\n\t-- \n\tIFF(in_NM_PFX IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_NM_PFX)>0 AND TRIM(in_NM_PFX)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_NM_PFX\n\t\t\t)\n\t\t)\n\t) AS NM_PFX,\n\tEXP_Values.NM_SFX AS in_NM_SFX,\n\t-- *INF*: iif(isnull(in_NM_SFX),'N/A',\r\n\t--    iif(is_spaces(in_NM_SFX),'N/A',\r\n\t--     rtrim(in_NM_SFX)))\n\tIFF(in_NM_SFX IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_NM_SFX)>0 AND TRIM(in_NM_SFX)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_NM_SFX\n\t\t\t)\n\t\t)\n\t) AS NM_SFX,\n\tEXP_Values.CICL_LNG_NM AS in_CICL_LNG_NM,\n\t-- *INF*: iif(isnull(in_CICL_LNG_NM),'N/A',\r\n\t--    iif(is_spaces(in_CICL_LNG_NM),'N/A',\r\n\t--     rtrim(in_CICL_LNG_NM)))\n\tIFF(in_CICL_LNG_NM IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_CICL_LNG_NM)>0 AND TRIM(in_CICL_LNG_NM)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_CICL_LNG_NM\n\t\t\t)\n\t\t)\n\t) AS CICL_LNG_NM,\n\tEXP_Values.CICL_DOB_DT AS in_CICL_DOB_DT,\n\t-- *INF*: iif(isnull(in_CICL_DOB_DT),\r\n\t--    TO_DATE('12/31/2100','MM/DD/YYYY'),\r\n\t--     in_CICL_DOB_DT)\n\tIFF(in_CICL_DOB_DT IS NULL,\n\t\tTO_DATE('12/31/2100', 'MM/DD/YYYY'\n\t\t),\n\t\tin_CICL_DOB_DT\n\t) AS CICL_DOB_DT,\n\tEXP_Values.GENDER_CD AS in_GENDER_CD,\n\t-- *INF*: iif(isnull(in_GENDER_CD),'N/A',\r\n\t--    iif(is_spaces(in_GENDER_CD),'N/A',\r\n\t--     in_GENDER_CD))\n\tIFF(in_GENDER_CD IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_GENDER_CD)>0 AND TRIM(in_GENDER_CD)='',\n\t\t\t'N/A',\n\t\t\tin_GENDER_CD\n\t\t)\n\t) AS GENDER_CD,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.CICA_PST_CD AS CICA_PST_CD_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.ST_CD AS ST_CD_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.CICA_ADR_1 AS CICA_ADR_1_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.CICA_ADR_2 AS CICA_ADR_2_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.CICA_CIT_NM AS CICA_CIT_NM_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_INHM.CICA_CTY AS CICA_CTY_INHM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.CICA_PST_CD AS CICA_PST_CD_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.ST_CD AS ST_CD_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.CICA_ADR_1 AS CICA_ADR_1_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.CICA_ADR_2 AS CICA_ADR_2_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.CICA_CIT_NM AS CICA_CIT_NM_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_BSM.CICA_CTY AS CICA_CTY_BSM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.CICA_PST_CD AS CICA_PST_CD_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.ST_CD AS ST_CD_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.CICA_ADR_1 AS CICA_ADR_1_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.CICA_ADR_2 AS CICA_ADR_2_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.CICA_CIT_NM AS CICA_CIT_NM_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_CLM.CICA_CTY AS CICA_CTY_CLM,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.CICA_PST_CD AS CICA_PST_CD_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.ST_CD AS ST_CD_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.CICA_ADR_1 AS CICA_ADR_1_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.CICA_ADR_2 AS CICA_ADR_2_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.CICA_CIT_NM AS CICA_CIT_NM_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_LOC.CICA_CTY AS CICA_CTY_LOC,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.CICA_PST_CD AS CICA_PST_CD_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.ST_CD AS ST_CD_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.CICA_ADR_1 AS CICA_ADR_1_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.CICA_ADR_2 AS CICA_ADR_2_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.CICA_CIT_NM AS CICA_CIT_NM_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_BLM.CICA_CTY AS CICA_CTY_BLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.CICA_PST_CD AS CICA_PST_CD_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.ST_CD AS ST_CD_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.CICA_ADR_1 AS CICA_ADR_1_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.CICA_ADR_2 AS CICA_ADR_2_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.CICA_CIT_NM AS CICA_CIT_NM_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PPL.CICA_CTY AS CICA_CTY_PPL,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.CICA_PST_CD AS CICA_PST_CD_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.ST_CD AS ST_CD_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.CICA_ADR_1 AS CICA_ADR_1_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.CICA_ADR_2 AS CICA_ADR_2_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.CICA_CIT_NM AS CICA_CIT_NM_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BLRT.CICA_CTY AS CICA_CTY_BLRT,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.CICA_PST_CD AS CICA_PST_CD_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.ST_CD AS ST_CD_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.CICA_ADR_1 AS CICA_ADR_1_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.CICA_ADR_2 AS CICA_ADR_2_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.CICA_CIT_NM AS CICA_CIT_NM_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_BSS.CICA_CTY AS CICA_CTY_BSS,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.CICA_PST_CD AS CICA_PST_CD_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.ST_CD AS ST_CD_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.CICA_ADR_1 AS CICA_ADR_1_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.CICA_ADR_2 AS CICA_ADR_2_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.CICA_CIT_NM AS CICA_CIT_NM_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_GL.CICA_CTY AS CICA_CTY_GL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.CICA_PST_CD AS CICA_PST_CD_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.ST_CD AS ST_CD_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.CICA_ADR_1 AS CICA_ADR_1_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.CICA_ADR_2 AS CICA_ADR_2_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.CICA_CIT_NM AS CICA_CIT_NM_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_CLL.CICA_CTY AS CICA_CTY_CLL,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.CICA_PST_CD AS CICA_PST_CD_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.ST_CD AS ST_CD_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.CICA_ADR_1 AS CICA_ADR_1_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.CICA_ADR_2 AS CICA_ADR_2_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.CICA_CIT_NM AS CICA_CIT_NM_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_HHA.CICA_CTY AS CICA_CTY_HHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.CICA_PST_CD AS CICA_PST_CD_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.ST_CD AS ST_CD_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.CICA_ADR_1 AS CICA_ADR_1_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.CICA_ADR_2 AS CICA_ADR_2_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.CICA_CIT_NM AS CICA_CIT_NM_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_INHA.CICA_CTY AS CICA_CTY_INHA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.CICA_PST_CD AS CICA_PST_CD_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.ST_CD AS ST_CD_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.CICA_ADR_1 AS CICA_ADR_1_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.CICA_ADR_2 AS CICA_ADR_2_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.CICA_CIT_NM AS CICA_CIT_NM_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_LPE.CICA_CTY AS CICA_CTY_LPE,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.CICA_PST_CD AS CICA_PST_CD_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.ST_CD AS ST_CD_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.CICA_ADR_1 AS CICA_ADR_1_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.CICA_ADR_2 AS CICA_ADR_2_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.CICA_CIT_NM AS CICA_CIT_NM_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_PMF.CICA_CTY AS CICA_CTY_PMF,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.CICA_PST_CD AS CICA_PST_CD_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.ST_CD AS ST_CD_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.CICA_ADR_1 AS CICA_ADR_1_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.CICA_ADR_2 AS CICA_ADR_2_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.CICA_CIT_NM AS CICA_CIT_NM_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_INHL.CICA_CTY AS CICA_CTY_INHL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.CICA_PST_CD AS CICA_PST_CD_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.ST_CD AS ST_CD_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.CICA_ADR_1 AS CICA_ADR_1_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.CICA_ADR_2 AS CICA_ADR_2_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.CICA_CIT_NM AS CICA_CIT_NM_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_PLG.CICA_CTY AS CICA_CTY_PLG,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.CICA_PST_CD AS CICA_PST_CD_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.ST_CD AS ST_CD_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.CICA_ADR_1 AS CICA_ADR_1_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.CICA_ADR_2 AS CICA_ADR_2_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.CICA_CIT_NM AS CICA_CIT_NM_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_TMPM.CICA_CTY AS CICA_CTY_TMPM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.CICA_PST_CD AS CICA_PST_CD_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.ST_CD AS ST_CD_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.CICA_ADR_1 AS CICA_ADR_1_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.CICA_ADR_2 AS CICA_ADR_2_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.CICA_CIT_NM AS CICA_CIT_NM_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWL.CICA_CTY AS CICA_CTY_INWL,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.CICA_PST_CD AS CICA_PST_CD_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.ST_CD AS ST_CD_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.CICA_ADR_1 AS CICA_ADR_1_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.CICA_ADR_2 AS CICA_ADR_2_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.CICA_CIT_NM AS CICA_CIT_NM_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_INWM.CICA_CTY AS CICA_CTY_INWM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.CICA_PST_CD AS CICA_PST_CD_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.ST_CD AS ST_CD_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.CICA_ADR_1 AS CICA_ADR_1_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.CICA_ADR_2 AS CICA_ADR_2_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.CICA_CIT_NM AS CICA_CIT_NM_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_ALM.CICA_CTY AS CICA_CTY_ALM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.CICA_PST_CD AS CICA_PST_CD_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.ST_CD AS ST_CD_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.CICA_ADR_1 AS CICA_ADR_1_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.CICA_ADR_2 AS CICA_ADR_2_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.CICA_CIT_NM AS CICA_CIT_NM_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_COM.CICA_CTY AS CICA_CTY_COM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.CICA_PST_CD AS CICA_PST_CD_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.ST_CD AS ST_CD_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.CICA_ADR_1 AS CICA_ADR_1_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.CICA_ADR_2 AS CICA_ADR_2_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.CICA_CIT_NM AS CICA_CIT_NM_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_VCM.CICA_CTY AS CICA_CTY_VCM,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.CICA_PST_CD AS CICA_PST_CD_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.ST_CD AS ST_CD_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.CICA_ADR_1 AS CICA_ADR_1_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.CICA_ADR_2 AS CICA_ADR_2_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.CICA_CIT_NM AS CICA_CIT_NM_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_LPA.CICA_CTY AS CICA_CTY_LPA,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.CICA_PST_CD AS CICA_PST_CD_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.ST_CD AS ST_CD_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.CICA_ADR_1 AS CICA_ADR_1_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.CICA_ADR_2 AS CICA_ADR_2_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.CICA_CIT_NM AS CICA_CIT_NM_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_VCL.CICA_CTY AS CICA_CTY_VCL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.CICA_PST_CD AS CICA_PST_CD_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.ST_CD AS ST_CD_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.CICA_ADR_1 AS CICA_ADR_1_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.CICA_ADR_2 AS CICA_ADR_2_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.CICA_CIT_NM AS CICA_CIT_NM_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_SPL.CICA_CTY AS CICA_CTY_SPL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.CICA_PST_CD AS CICA_PST_CD_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.ST_CD AS ST_CD_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.CICA_ADR_1 AS CICA_ADR_1_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.CICA_ADR_2 AS CICA_ADR_2_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.CICA_CIT_NM AS CICA_CIT_NM_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLM.CICA_CTY AS CICA_CTY_PLM,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.CICA_PST_CD AS CICA_PST_CD_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.ST_CD AS ST_CD_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.CICA_ADR_1 AS CICA_ADR_1_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.CICA_ADR_2 AS CICA_ADR_2_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.CICA_CIT_NM AS CICA_CIT_NM_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLB.CICA_CTY AS CICA_CTY_PLB,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.CICA_PST_CD AS CICA_PST_CD_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.ST_CD AS ST_CD_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.CICA_ADR_1 AS CICA_ADR_1_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.CICA_ADR_2 AS CICA_ADR_2_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.CICA_CIT_NM AS CICA_CIT_NM_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PLL.CICA_CTY AS CICA_CTY_PLL,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.CICA_PST_CD AS CICA_PST_CD_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.ST_CD AS ST_CD_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.CICA_ADR_1 AS CICA_ADR_1_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.CICA_ADR_2 AS CICA_ADR_2_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.CICA_CIT_NM AS CICA_CIT_NM_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_PRAD.CICA_CTY AS CICA_CTY_PRAD,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.CICA_PST_CD AS CICA_PST_CD_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.ST_CD AS ST_CD_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.CICA_ADR_1 AS CICA_ADR_1_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.CICA_ADR_2 AS CICA_ADR_2_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.CICA_CIT_NM AS CICA_CIT_NM_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_ALL.CICA_CTY AS CICA_CTY_ALL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.CICA_PST_CD AS CICA_PST_CD_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.ST_CD AS ST_CD_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.CICA_ADR_1 AS CICA_ADR_1_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.CICA_ADR_2 AS CICA_ADR_2_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.CICA_CIT_NM AS CICA_CIT_NM_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_MAL.CICA_CTY AS CICA_CTY_MAL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.CICA_PST_CD AS CICA_PST_CD_BSL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.ST_CD AS ST_CD_BSL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.CICA_ADR_1 AS CICA_ADR_1_BSL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.CICA_ADR_2 AS CICA_ADR_2_BSL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.CICA_CIT_NM AS CICA_CIT_NM_BSL,\n\tLKP_CLIENT_ADDRESS_STAGE_BSL.CICA_CTY AS CICA_CTY_BSL,\n\t-- *INF*: IIF(\r\n\t-- ISNULL(ltrim(rtrim(CICA_ADR_1_INHM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_BSM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_ALM ))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_ALM )))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_ALL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_ALL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_BSL ))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSL )))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_MAL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_MAL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_CLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_CLM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_LOC))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LOC)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_BLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BLM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PPL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PPL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_BLRT))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BLRT)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_BSS))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSS)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_GL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_GL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_CLL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_CLL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_HHA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_HHA)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_INHA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHA)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_LPE))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LPE)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PMF))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PMF)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_INHL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PLG))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLG)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_TMPM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_TMPM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_INWL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INWL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_INWM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INWM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_LPA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LPA)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PLB))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLB)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PLL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_PRAD))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PRAD)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_SPL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_SPL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_VCL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_VCL)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_VCM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_VCM)))\r\n\t-- AND ISNULL(ltrim(rtrim(CICA_ADR_1_COM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_COM)))\r\n\t-- ,'N/A'\r\n\t-- ,DECODE(TRUE\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_INHM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHM)))),'INHM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_BSM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSM)))),'BSM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_ALL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_ALL)))),'ALL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_BSL ))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSL )))),'BSL' \r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_MAL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_MAL)))),'MAL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_CLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_CLM)))),'CLM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_LOC))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LOC)))),'LOC'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_BLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BLM)))),'BLM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PPL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PPL)))),'PPL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_BLRT))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BLRT)))),'BLRT'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_BSS))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_BSS)))),'BSS'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_GL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_GL)))),'GL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_CLL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_CLL)))),'CLL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_HHA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_HHA)))),'HHA'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_INHA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHA)))),'INHA'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_LPE))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LPE)))),'LPE'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PMF))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PMF)))),'PMF'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_INHL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INHL)))),'INHL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PLG))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLG)))),'PLG'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_TMPM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_TMPM)))),'TMPM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_INWL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INWL)))),'INWL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_INWM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_INWM)))),'INWM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_LPA))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_LPA)))),'LPA'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PLB))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLB)))),'PLB'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PLL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLL)))),'PLL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PLM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PLM)))),'PLM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_PRAD))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_PRAD)))),'PRAD'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_SPL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_SPL)))),'SPL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_VCL))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_VCL)))),'VCL'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_VCM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_VCM)))),'VCM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_COM))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_COM)))),'COM'\r\n\t-- ,NOT (ISNULL(ltrim(rtrim(CICA_ADR_1_ALM ))) AND ISNULL(ltrim(rtrim(CICA_ADR_2_ALM) ))),'ALM '\r\n\t-- ,'N/A')\r\n\t-- )\n\tIFF(ltrim(rtrim(CICA_ADR_1_INHM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_INHM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_BSM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_BSM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_ALM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_ALM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_ALL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_ALL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_BSL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_BSL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_MAL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_MAL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_CLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_CLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_LOC\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_LOC\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_BLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_BLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PPL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PPL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_BLRT\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_BLRT\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_BSS\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_BSS\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_GL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_GL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_CLL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_CLL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_HHA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_HHA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_INHA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_INHA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_LPE\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_LPE\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PMF\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PMF\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_INHL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_INHL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PLG\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PLG\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_TMPM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_TMPM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_INWL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_INWL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_INWM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_INWM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_LPA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_LPA\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PLB\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PLB\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PLL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PLL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PLM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_PRAD\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_PRAD\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_SPL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_SPL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_VCL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_VCL\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_VCM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_VCM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_1_COM\n\t\t\t)\n\t\t) IS NULL \n\t\tAND ltrim(rtrim(CICA_ADR_2_COM\n\t\t\t)\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tDECODE(TRUE,\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_INHM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_INHM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'INHM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_BSM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_BSM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'BSM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_ALL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_ALL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'ALL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_BSL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_BSL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'BSL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_MAL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_MAL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'MAL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_CLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_CLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'CLM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_LOC\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_LOC\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'LOC',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_BLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_BLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'BLM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PPL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PPL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PPL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_BLRT\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_BLRT\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'BLRT',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_BSS\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_BSS\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'BSS',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_GL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_GL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'GL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_CLL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_CLL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'CLL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_HHA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_HHA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'HHA',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_INHA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_INHA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'INHA',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_LPE\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_LPE\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'LPE',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PMF\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PMF\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PMF',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_INHL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_INHL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'INHL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PLG\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PLG\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PLG',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_TMPM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_TMPM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'TMPM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_INWL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_INWL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'INWL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_INWM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_INWM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'INWM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_LPA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_LPA\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'LPA',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PLB\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PLB\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PLB',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PLL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PLL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PLL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PLM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PLM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_PRAD\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_PRAD\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'PRAD',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_SPL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_SPL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'SPL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_VCL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_VCL\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'VCL',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_VCM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_VCM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'VCM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_COM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_COM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'COM',\n\t\tNOT ( ltrim(rtrim(CICA_ADR_1_ALM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t\tAND ltrim(rtrim(CICA_ADR_2_ALM\n\t\t\t\t\t)\n\t\t\t\t) IS NULL \n\t\t\t), 'ALM ',\n\t\t'N/A'\n\t\t)\n\t) AS v_ADR_TYP_CD,\n\t-- *INF*: iif(isnull(v_ADR_TYP_CD),'N/A',\r\n\t--    iif(is_spaces(v_ADR_TYP_CD),'N/A',\r\n\t--     rtrim(v_ADR_TYP_CD)))\n\tIFF(v_ADR_TYP_CD IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_ADR_TYP_CD)>0 AND TRIM(v_ADR_TYP_CD)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_ADR_TYP_CD\n\t\t\t)\n\t\t)\n\t) AS ADR_TYP_CD,\n\t-- *INF*: DECODE( v_ADR_TYP_CD,\r\n\t-- 'INHM',CICA_ADR_1_INHM || CICA_ADR_2_INHM,\r\n\t-- 'BSM',CICA_ADR_1_BSM || CICA_ADR_2_BSM,\r\n\t-- 'ALM',CICA_ADR_1_ALM  || CICA_ADR_2_ALM ,\r\n\t-- 'ALL',CICA_ADR_1_ALL || CICA_ADR_2_ALL,\r\n\t-- 'BSL',CICA_ADR_1_BSL  || CICA_ADR_2_BSL ,\r\n\t-- 'MAL',CICA_ADR_1_MAL || CICA_ADR_2_MAL,\r\n\t-- 'CLM',CICA_ADR_1_CLM || CICA_ADR_2_CLM,\r\n\t-- 'LOC',CICA_ADR_1_LOC || CICA_ADR_2_LOC,\r\n\t-- 'BLM',CICA_ADR_1_BLM || CICA_ADR_2_BLM,\r\n\t-- 'PPL',CICA_ADR_1_PPL || CICA_ADR_2_PPL,\r\n\t-- 'BLRT',CICA_ADR_1_BLRT || CICA_ADR_2_BLRT,\r\n\t-- 'BSS',CICA_ADR_1_BSS || CICA_ADR_2_BSS,\r\n\t-- 'GL',CICA_ADR_1_GL || CICA_ADR_2_GL,\r\n\t-- 'CLL',CICA_ADR_1_CLL || CICA_ADR_2_CLL,\r\n\t-- 'HHA',CICA_ADR_1_HHA || CICA_ADR_2_HHA,\r\n\t-- 'INHA',CICA_ADR_1_INHA || CICA_ADR_2_INHA,\r\n\t-- 'LPE',CICA_ADR_1_LPE || CICA_ADR_2_LPE,\r\n\t-- 'PMF',CICA_ADR_1_PMF || CICA_ADR_2_PMF,\r\n\t-- 'INHL',CICA_ADR_1_INHL || CICA_ADR_2_INHL,\r\n\t-- 'PLG',CICA_ADR_1_PLG || CICA_ADR_2_PLG,\r\n\t-- 'TMPM',CICA_ADR_1_TMPM || CICA_ADR_2_TMPM,\r\n\t-- 'INWL',CICA_ADR_1_INWL || CICA_ADR_2_INWL,\r\n\t-- 'INWM',CICA_ADR_1_INWM || CICA_ADR_2_INWM,\r\n\t-- 'LPA',CICA_ADR_1_LPA || CICA_ADR_2_LPA,\r\n\t-- 'PLB',CICA_ADR_1_PLB || CICA_ADR_2_PLB,\r\n\t-- 'PLL',CICA_ADR_1_PLL || CICA_ADR_2_PLL,\r\n\t-- 'PLM',CICA_ADR_1_PLM || CICA_ADR_2_PLM,\r\n\t-- 'PRAD',CICA_ADR_1_PRAD || CICA_ADR_2_PRAD,\r\n\t-- 'SPL',CICA_ADR_1_SPL || CICA_ADR_2_SPL,\r\n\t-- 'VCL',CICA_ADR_1_VCL || CICA_ADR_2_VCL,\r\n\t-- 'VCM',CICA_ADR_1_VCM || CICA_ADR_2_VCM,\r\n\t-- 'COM',CICA_ADR_1_COM || CICA_ADR_2_COM)\n\tDECODE(v_ADR_TYP_CD,\n\t\t'INHM', CICA_ADR_1_INHM || CICA_ADR_2_INHM,\n\t\t'BSM', CICA_ADR_1_BSM || CICA_ADR_2_BSM,\n\t\t'ALM', CICA_ADR_1_ALM || CICA_ADR_2_ALM,\n\t\t'ALL', CICA_ADR_1_ALL || CICA_ADR_2_ALL,\n\t\t'BSL', CICA_ADR_1_BSL || CICA_ADR_2_BSL,\n\t\t'MAL', CICA_ADR_1_MAL || CICA_ADR_2_MAL,\n\t\t'CLM', CICA_ADR_1_CLM || CICA_ADR_2_CLM,\n\t\t'LOC', CICA_ADR_1_LOC || CICA_ADR_2_LOC,\n\t\t'BLM', CICA_ADR_1_BLM || CICA_ADR_2_BLM,\n\t\t'PPL', CICA_ADR_1_PPL || CICA_ADR_2_PPL,\n\t\t'BLRT', CICA_ADR_1_BLRT || CICA_ADR_2_BLRT,\n\t\t'BSS', CICA_ADR_1_BSS || CICA_ADR_2_BSS,\n\t\t'GL', CICA_ADR_1_GL || CICA_ADR_2_GL,\n\t\t'CLL', CICA_ADR_1_CLL || CICA_ADR_2_CLL,\n\t\t'HHA', CICA_ADR_1_HHA || CICA_ADR_2_HHA,\n\t\t'INHA', CICA_ADR_1_INHA || CICA_ADR_2_INHA,\n\t\t'LPE', CICA_ADR_1_LPE || CICA_ADR_2_LPE,\n\t\t'PMF', CICA_ADR_1_PMF || CICA_ADR_2_PMF,\n\t\t'INHL', CICA_ADR_1_INHL || CICA_ADR_2_INHL,\n\t\t'PLG', CICA_ADR_1_PLG || CICA_ADR_2_PLG,\n\t\t'TMPM', CICA_ADR_1_TMPM || CICA_ADR_2_TMPM,\n\t\t'INWL', CICA_ADR_1_INWL || CICA_ADR_2_INWL,\n\t\t'INWM', CICA_ADR_1_INWM || CICA_ADR_2_INWM,\n\t\t'LPA', CICA_ADR_1_LPA || CICA_ADR_2_LPA,\n\t\t'PLB', CICA_ADR_1_PLB || CICA_ADR_2_PLB,\n\t\t'PLL', CICA_ADR_1_PLL || CICA_ADR_2_PLL,\n\t\t'PLM', CICA_ADR_1_PLM || CICA_ADR_2_PLM,\n\t\t'PRAD', CICA_ADR_1_PRAD || CICA_ADR_2_PRAD,\n\t\t'SPL', CICA_ADR_1_SPL || CICA_ADR_2_SPL,\n\t\t'VCL', CICA_ADR_1_VCL || CICA_ADR_2_VCL,\n\t\t'VCM', CICA_ADR_1_VCM || CICA_ADR_2_VCM,\n\t\t'COM', CICA_ADR_1_COM || CICA_ADR_2_COM\n\t) AS v_CICA_ADR,\n\t-- *INF*: iif(isnull(v_CICA_ADR),'N/A',\r\n\t--    iif(is_spaces(v_CICA_ADR),'N/A',\r\n\t--     rtrim(v_CICA_ADR)))\n\tIFF(v_CICA_ADR IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_CICA_ADR)>0 AND TRIM(v_CICA_ADR)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_CICA_ADR\n\t\t\t)\n\t\t)\n\t) AS CICA_ADR,\n\t-- *INF*: DECODE( v_ADR_TYP_CD,\r\n\t-- 'INHM',CICA_CIT_NM_INHM,\r\n\t-- 'BSM',CICA_CIT_NM_BSM,\r\n\t-- 'ALM',CICA_CIT_NM_ALM ,\r\n\t-- 'ALL',CICA_CIT_NM_ALL,\r\n\t-- 'BSL',CICA_CIT_NM_BSL ,\r\n\t-- 'MAL',CICA_CIT_NM_MAL,\r\n\t-- 'CLM',CICA_CIT_NM_CLM,\r\n\t-- 'LOC',CICA_CIT_NM_LOC,\r\n\t-- 'BLM',CICA_CIT_NM_BLM,\r\n\t-- 'PPL',CICA_CIT_NM_PPL,\r\n\t-- 'BLRT',CICA_CIT_NM_BLRT,\r\n\t-- 'BSS',CICA_CIT_NM_BSS,\r\n\t-- 'GL',CICA_CIT_NM_GL,\r\n\t-- 'CLL',CICA_CIT_NM_CLL,\r\n\t-- 'HHA',CICA_CIT_NM_HHA,\r\n\t-- 'INHA',CICA_CIT_NM_INHA,\r\n\t-- 'LPE',CICA_CIT_NM_LPE,\r\n\t-- 'PMF',CICA_CIT_NM_PMF,\r\n\t-- 'INHL',CICA_CIT_NM_INHL,\r\n\t-- 'PLG',CICA_CIT_NM_PLG,\r\n\t-- 'TMPM',CICA_CIT_NM_TMPM,\r\n\t-- 'INWL',CICA_CIT_NM_INWL,\r\n\t-- 'INWM',CICA_CIT_NM_INWM,\r\n\t-- 'LPA',CICA_CIT_NM_LPA,\r\n\t-- 'PLB',CICA_CIT_NM_PLB,\r\n\t-- 'PLL',CICA_CIT_NM_PLL,\r\n\t-- 'PLM',CICA_CIT_NM_PLM,\r\n\t-- 'PRAD',CICA_CIT_NM_PRAD,\r\n\t-- 'SPL',CICA_CIT_NM_SPL,\r\n\t-- 'VCL',CICA_CIT_NM_VCL,\r\n\t-- 'VCM',CICA_CIT_NM_VCM,\r\n\t-- 'COM',CICA_CIT_NM_COM)\n\tDECODE(v_ADR_TYP_CD,\n\t\t'INHM', CICA_CIT_NM_INHM,\n\t\t'BSM', CICA_CIT_NM_BSM,\n\t\t'ALM', CICA_CIT_NM_ALM,\n\t\t'ALL', CICA_CIT_NM_ALL,\n\t\t'BSL', CICA_CIT_NM_BSL,\n\t\t'MAL', CICA_CIT_NM_MAL,\n\t\t'CLM', CICA_CIT_NM_CLM,\n\t\t'LOC', CICA_CIT_NM_LOC,\n\t\t'BLM', CICA_CIT_NM_BLM,\n\t\t'PPL', CICA_CIT_NM_PPL,\n\t\t'BLRT', CICA_CIT_NM_BLRT,\n\t\t'BSS', CICA_CIT_NM_BSS,\n\t\t'GL', CICA_CIT_NM_GL,\n\t\t'CLL', CICA_CIT_NM_CLL,\n\t\t'HHA', CICA_CIT_NM_HHA,\n\t\t'INHA', CICA_CIT_NM_INHA,\n\t\t'LPE', CICA_CIT_NM_LPE,\n\t\t'PMF', CICA_CIT_NM_PMF,\n\t\t'INHL', CICA_CIT_NM_INHL,\n\t\t'PLG', CICA_CIT_NM_PLG,\n\t\t'TMPM', CICA_CIT_NM_TMPM,\n\t\t'INWL', CICA_CIT_NM_INWL,\n\t\t'INWM', CICA_CIT_NM_INWM,\n\t\t'LPA', CICA_CIT_NM_LPA,\n\t\t'PLB', CICA_CIT_NM_PLB,\n\t\t'PLL', CICA_CIT_NM_PLL,\n\t\t'PLM', CICA_CIT_NM_PLM,\n\t\t'PRAD', CICA_CIT_NM_PRAD,\n\t\t'SPL', CICA_CIT_NM_SPL,\n\t\t'VCL', CICA_CIT_NM_VCL,\n\t\t'VCM', CICA_CIT_NM_VCM,\n\t\t'COM', CICA_CIT_NM_COM\n\t) AS v_CICA_CIT_NM,\n\t-- *INF*: IIF(isnull(v_CICA_CIT_NM),'N/A', \r\n\t-- IIF(is_spaces(v_CICA_CIT_NM),'N/A', \r\n\t--  rtrim(v_CICA_CIT_NM)))\n\tIFF(v_CICA_CIT_NM IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_CICA_CIT_NM)>0 AND TRIM(v_CICA_CIT_NM)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_CICA_CIT_NM\n\t\t\t)\n\t\t)\n\t) AS CICA_CIT_NM,\n\t-- *INF*: DECODE( v_ADR_TYP_CD,\r\n\t-- 'INHM',CICA_CTY_INHM,\r\n\t-- 'BSM',CICA_CTY_BSM,\r\n\t-- 'ALM',CICA_CTY_ALM ,\r\n\t-- 'ALL',CICA_CTY_ALL,\r\n\t-- 'BSL',CICA_CTY_BSL ,\r\n\t-- 'MAL',CICA_CTY_MAL,\r\n\t-- 'CLM',CICA_CTY_CLM,\r\n\t-- 'LOC',CICA_CTY_LOC,\r\n\t-- 'BLM',CICA_CTY_BLM,\r\n\t-- 'PPL',CICA_CTY_PPL,\r\n\t-- 'BLRT',CICA_CTY_BLRT,\r\n\t-- 'BSS',CICA_CTY_BSS,\r\n\t-- 'GL',CICA_CTY_GL,\r\n\t-- 'CLL',CICA_CTY_CLL,\r\n\t-- 'HHA',CICA_CTY_HHA,\r\n\t-- 'INHA',CICA_CTY_INHA,\r\n\t-- 'LPE',CICA_CTY_LPE,\r\n\t-- 'PMF',CICA_CTY_PMF,\r\n\t-- 'INHL',CICA_CTY_INHL,\r\n\t-- 'PLG',CICA_CTY_PLG,\r\n\t-- 'TMPM',CICA_CTY_TMPM,\r\n\t-- 'INWL',CICA_CTY_INWL,\r\n\t-- 'INWM',CICA_CTY_INWM,\r\n\t-- 'LPA',CICA_CTY_LPA,\r\n\t-- 'PLB',CICA_CTY_PLB,\r\n\t-- 'PLL',CICA_CTY_PLL,\r\n\t-- 'PLM',CICA_CTY_PLM,\r\n\t-- 'PRAD',CICA_CTY_PRAD,\r\n\t-- 'SPL',CICA_CTY_SPL,\r\n\t-- 'VCL',CICA_CTY_VCL,\r\n\t-- 'VCM',CICA_CTY_VCM,\r\n\t-- 'COM',CICA_CTY_COM)\n\tDECODE(v_ADR_TYP_CD,\n\t\t'INHM', CICA_CTY_INHM,\n\t\t'BSM', CICA_CTY_BSM,\n\t\t'ALM', CICA_CTY_ALM,\n\t\t'ALL', CICA_CTY_ALL,\n\t\t'BSL', CICA_CTY_BSL,\n\t\t'MAL', CICA_CTY_MAL,\n\t\t'CLM', CICA_CTY_CLM,\n\t\t'LOC', CICA_CTY_LOC,\n\t\t'BLM', CICA_CTY_BLM,\n\t\t'PPL', CICA_CTY_PPL,\n\t\t'BLRT', CICA_CTY_BLRT,\n\t\t'BSS', CICA_CTY_BSS,\n\t\t'GL', CICA_CTY_GL,\n\t\t'CLL', CICA_CTY_CLL,\n\t\t'HHA', CICA_CTY_HHA,\n\t\t'INHA', CICA_CTY_INHA,\n\t\t'LPE', CICA_CTY_LPE,\n\t\t'PMF', CICA_CTY_PMF,\n\t\t'INHL', CICA_CTY_INHL,\n\t\t'PLG', CICA_CTY_PLG,\n\t\t'TMPM', CICA_CTY_TMPM,\n\t\t'INWL', CICA_CTY_INWL,\n\t\t'INWM', CICA_CTY_INWM,\n\t\t'LPA', CICA_CTY_LPA,\n\t\t'PLB', CICA_CTY_PLB,\n\t\t'PLL', CICA_CTY_PLL,\n\t\t'PLM', CICA_CTY_PLM,\n\t\t'PRAD', CICA_CTY_PRAD,\n\t\t'SPL', CICA_CTY_SPL,\n\t\t'VCL', CICA_CTY_VCL,\n\t\t'VCM', CICA_CTY_VCM,\n\t\t'COM', CICA_CTY_COM\n\t) AS v_CICA_CTY,\n\t-- *INF*: iif(isnull(rtrim(v_CICA_CTY)),'N/A',\r\n\t--    iif(is_spaces(v_CICA_CTY),'N/A',\r\n\t--     rtrim(v_CICA_CTY)))\n\tIFF(rtrim(v_CICA_CTY\n\t\t) IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_CICA_CTY)>0 AND TRIM(v_CICA_CTY)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_CICA_CTY\n\t\t\t)\n\t\t)\n\t) AS CICA_CTY,\n\t-- *INF*: DECODE( v_ADR_TYP_CD,\r\n\t-- 'INHM',ST_CD_INHM,\r\n\t-- 'BSM',ST_CD_BSM,\r\n\t-- 'ALM',ST_CD_ALM ,\r\n\t-- 'ALL',ST_CD_ALL,\r\n\t-- 'BSL',ST_CD_BSL ,\r\n\t-- 'MAL',ST_CD_MAL,\r\n\t-- 'CLM',ST_CD_CLM,\r\n\t-- 'LOC',ST_CD_LOC,\r\n\t-- 'BLM',ST_CD_BLM,\r\n\t-- 'PPL',ST_CD_PPL,\r\n\t-- 'BLRT',ST_CD_BLRT,\r\n\t-- 'BSS',ST_CD_BSS,\r\n\t-- 'GL',ST_CD_GL,\r\n\t-- 'CLL',ST_CD_CLL,\r\n\t-- 'HHA',ST_CD_HHA,\r\n\t-- 'INHA',ST_CD_INHA,\r\n\t-- 'LPE',ST_CD_LPE,\r\n\t-- 'PMF',ST_CD_PMF,\r\n\t-- 'INHL',ST_CD_INHL,\r\n\t-- 'PLG',ST_CD_PLG,\r\n\t-- 'TMPM',ST_CD_TMPM,\r\n\t-- 'INWL',ST_CD_INWL,\r\n\t-- 'INWM',ST_CD_INWM,\r\n\t-- 'LPA',ST_CD_LPA,\r\n\t-- 'PLB',ST_CD_PLB,\r\n\t-- 'PLL',ST_CD_PLL,\r\n\t-- 'PLM',ST_CD_PLM,\r\n\t-- 'PRAD',ST_CD_PRAD,\r\n\t-- 'SPL',ST_CD_SPL,\r\n\t-- 'VCL',ST_CD_VCL,\r\n\t-- 'VCM',ST_CD_VCM,\r\n\t-- 'COM',ST_CD_COM)\n\tDECODE(v_ADR_TYP_CD,\n\t\t'INHM', ST_CD_INHM,\n\t\t'BSM', ST_CD_BSM,\n\t\t'ALM', ST_CD_ALM,\n\t\t'ALL', ST_CD_ALL,\n\t\t'BSL', ST_CD_BSL,\n\t\t'MAL', ST_CD_MAL,\n\t\t'CLM', ST_CD_CLM,\n\t\t'LOC', ST_CD_LOC,\n\t\t'BLM', ST_CD_BLM,\n\t\t'PPL', ST_CD_PPL,\n\t\t'BLRT', ST_CD_BLRT,\n\t\t'BSS', ST_CD_BSS,\n\t\t'GL', ST_CD_GL,\n\t\t'CLL', ST_CD_CLL,\n\t\t'HHA', ST_CD_HHA,\n\t\t'INHA', ST_CD_INHA,\n\t\t'LPE', ST_CD_LPE,\n\t\t'PMF', ST_CD_PMF,\n\t\t'INHL', ST_CD_INHL,\n\t\t'PLG', ST_CD_PLG,\n\t\t'TMPM', ST_CD_TMPM,\n\t\t'INWL', ST_CD_INWL,\n\t\t'INWM', ST_CD_INWM,\n\t\t'LPA', ST_CD_LPA,\n\t\t'PLB', ST_CD_PLB,\n\t\t'PLL', ST_CD_PLL,\n\t\t'PLM', ST_CD_PLM,\n\t\t'PRAD', ST_CD_PRAD,\n\t\t'SPL', ST_CD_SPL,\n\t\t'VCL', ST_CD_VCL,\n\t\t'VCM', ST_CD_VCM,\n\t\t'COM', ST_CD_COM\n\t) AS v_ST_CD,\n\t-- *INF*: iif(isnull(v_ST_CD),'N/A',\r\n\t--    iif(is_spaces(v_ST_CD),'N/A',\r\n\t--     rtrim(v_ST_CD)))\n\tIFF(v_ST_CD IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_ST_CD)>0 AND TRIM(v_ST_CD)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_ST_CD\n\t\t\t)\n\t\t)\n\t) AS ST_CD,\n\t-- *INF*: DECODE( v_ADR_TYP_CD,\r\n\t-- 'INHM',CICA_PST_CD_INHM,\r\n\t-- 'BSM',CICA_PST_CD_BSM,\r\n\t-- 'ALM',CICA_PST_CD_ALM ,\r\n\t-- 'ALL',CICA_PST_CD_ALL,\r\n\t-- 'BSL',CICA_PST_CD_BSL ,\r\n\t-- 'MAL',CICA_PST_CD_MAL,\r\n\t-- 'CLM',CICA_PST_CD_CLM,\r\n\t-- 'LOC',CICA_PST_CD_LOC,\r\n\t-- 'BLM',CICA_PST_CD_BLM,\r\n\t-- 'PPL',CICA_PST_CD_PPL,\r\n\t-- 'BLRT',CICA_PST_CD_BLRT,\r\n\t-- 'BSS',CICA_PST_CD_BSS,\r\n\t-- 'GL',CICA_PST_CD_GL,\r\n\t-- 'CLL',CICA_PST_CD_CLL,\r\n\t-- 'HHA',CICA_PST_CD_HHA,\r\n\t-- 'INHA',CICA_PST_CD_INHA,\r\n\t-- 'LPE',CICA_PST_CD_LPE,\r\n\t-- 'PMF',CICA_PST_CD_PMF,\r\n\t-- 'INHL',CICA_PST_CD_INHL,\r\n\t-- 'PLG',CICA_PST_CD_PLG,\r\n\t-- 'TMPM',CICA_PST_CD_TMPM,\r\n\t-- 'INWL',CICA_PST_CD_INWL,\r\n\t-- 'INWM',CICA_PST_CD_INWM,\r\n\t-- 'LPA',CICA_PST_CD_LPA,\r\n\t-- 'PLB',CICA_PST_CD_PLB,\r\n\t-- 'PLL',CICA_PST_CD_PLL,\r\n\t-- 'PLM',CICA_PST_CD_PLM,\r\n\t-- 'PRAD',CICA_PST_CD_PRAD,\r\n\t-- 'SPL',CICA_PST_CD_SPL,\r\n\t-- 'VCL',CICA_PST_CD_VCL,\r\n\t-- 'VCM',CICA_PST_CD_VCM,\r\n\t-- 'COM',CICA_PST_CD_COM)\n\tDECODE(v_ADR_TYP_CD,\n\t\t'INHM', CICA_PST_CD_INHM,\n\t\t'BSM', CICA_PST_CD_BSM,\n\t\t'ALM', CICA_PST_CD_ALM,\n\t\t'ALL', CICA_PST_CD_ALL,\n\t\t'BSL', CICA_PST_CD_BSL,\n\t\t'MAL', CICA_PST_CD_MAL,\n\t\t'CLM', CICA_PST_CD_CLM,\n\t\t'LOC', CICA_PST_CD_LOC,\n\t\t'BLM', CICA_PST_CD_BLM,\n\t\t'PPL', CICA_PST_CD_PPL,\n\t\t'BLRT', CICA_PST_CD_BLRT,\n\t\t'BSS', CICA_PST_CD_BSS,\n\t\t'GL', CICA_PST_CD_GL,\n\t\t'CLL', CICA_PST_CD_CLL,\n\t\t'HHA', CICA_PST_CD_HHA,\n\t\t'INHA', CICA_PST_CD_INHA,\n\t\t'LPE', CICA_PST_CD_LPE,\n\t\t'PMF', CICA_PST_CD_PMF,\n\t\t'INHL', CICA_PST_CD_INHL,\n\t\t'PLG', CICA_PST_CD_PLG,\n\t\t'TMPM', CICA_PST_CD_TMPM,\n\t\t'INWL', CICA_PST_CD_INWL,\n\t\t'INWM', CICA_PST_CD_INWM,\n\t\t'LPA', CICA_PST_CD_LPA,\n\t\t'PLB', CICA_PST_CD_PLB,\n\t\t'PLL', CICA_PST_CD_PLL,\n\t\t'PLM', CICA_PST_CD_PLM,\n\t\t'PRAD', CICA_PST_CD_PRAD,\n\t\t'SPL', CICA_PST_CD_SPL,\n\t\t'VCL', CICA_PST_CD_VCL,\n\t\t'VCM', CICA_PST_CD_VCM,\n\t\t'COM', CICA_PST_CD_COM\n\t) AS v_CICA_PST_CD,\n\t-- *INF*: iif(isnull(v_CICA_PST_CD),'N/A',\r\n\t--    iif(is_spaces(v_CICA_PST_CD),'N/A',\r\n\t--     rtrim(v_CICA_PST_CD)))\n\tIFF(v_CICA_PST_CD IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(v_CICA_PST_CD)>0 AND TRIM(v_CICA_PST_CD)='',\n\t\t\t'N/A',\n\t\t\trtrim(v_CICA_PST_CD\n\t\t\t)\n\t\t)\n\t) AS CICA_PST_CD,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_CLIENT_TAX_STAGE(CLIENT_ID,'SSN')),\r\n\t-- 'N/A',\r\n\t-- ltrim(rtrim(:LKP.LKP_CLIENT_TAX_STAGE(CLIENT_ID,'SSN'))))\r\n\t-- \n\tIFF(LKP_CLIENT_TAX_STAGE_CLIENT_ID_SSN.citx_tax_id IS NULL,\n\t\t'N/A',\n\t\tltrim(rtrim(LKP_CLIENT_TAX_STAGE_CLIENT_ID_SSN.citx_tax_id\n\t\t\t)\n\t\t)\n\t) AS citx_tax_id_ssn,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_CLIENT_TAX_STAGE(CLIENT_ID,'FED')),\r\n\t-- 'N/A',\r\n\t-- :LKP.LKP_CLIENT_TAX_STAGE(CLIENT_ID,'FED'))\n\tIFF(LKP_CLIENT_TAX_STAGE_CLIENT_ID_FED.citx_tax_id IS NULL,\n\t\t'N/A',\n\t\tLKP_CLIENT_TAX_STAGE_CLIENT_ID_FED.citx_tax_id\n\t) AS citx_tax_id_fed,\n\tEXP_phone.Phone,\n\tEXP_phone.Phone_Extn,\n\tEXP_phone.Phone_Type,\n\tEXP_Values.LEG_ENT_CD AS in_LEG_ENT_CD,\n\t-- *INF*: iif(isnull(in_LEG_ENT_CD),'N/A',\r\n\t--    iif(is_spaces(in_LEG_ENT_CD),'N/A',\r\n\t--     rtrim(in_LEG_ENT_CD)))\n\tIFF(in_LEG_ENT_CD IS NULL,\n\t\t'N/A',\n\t\tIFF(LENGTH(in_LEG_ENT_CD)>0 AND TRIM(in_LEG_ENT_CD)='',\n\t\t\t'N/A',\n\t\t\trtrim(in_LEG_ENT_CD\n\t\t\t)\n\t\t)\n\t) AS LEG_ENT_CD,\n\tEXP_Values.CICL_EFF_ACY_TS,\n\t-- *INF*: iif(isnull(CICL_EFF_ACY_TS),\r\n\t--    TO_DATE('01/01/1800','MM/DD/YYYY'),\r\n\t--     CICL_EFF_ACY_TS)\n\tIFF(CICL_EFF_ACY_TS IS NULL,\n\t\tTO_DATE('01/01/1800', 'MM/DD/YYYY'\n\t\t),\n\t\tCICL_EFF_ACY_TS\n\t) AS claim_party_ref_eff_from_date,\n\tmplt_split_client_tab_long_name.prefix AS mplt_prefix,\n\t-- *INF*: IIF(isnull(mplt_prefix) or length(mplt_prefix)=0,'N/A',mplt_prefix)\n\tIFF(mplt_prefix IS NULL \n\t\tOR length(mplt_prefix\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_prefix\n\t) AS mplt_prefix_out,\n\tmplt_split_client_tab_long_name.first_name AS mplt_first_name,\n\t-- *INF*: IIF(isnull(mplt_first_name) or length(mplt_first_name)=0,'N/A',mplt_first_name)\n\tIFF(mplt_first_name IS NULL \n\t\tOR length(mplt_first_name\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_first_name\n\t) AS mplt_first_name_out,\n\tmplt_split_client_tab_long_name.middle_name AS mplt_middle_name,\n\t-- *INF*: IIF(isnull(mplt_middle_name) or length(mplt_middle_name)=0,'N/A',mplt_middle_name)\n\tIFF(mplt_middle_name IS NULL \n\t\tOR length(mplt_middle_name\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_middle_name\n\t) AS mplt_middle_name_out,\n\tmplt_split_client_tab_long_name.last_name AS mplt_last_name,\n\t-- *INF*: IIF(isnull(mplt_last_name) or length(mplt_last_name)=0,'N/A',mplt_last_name)\n\tIFF(mplt_last_name IS NULL \n\t\tOR length(mplt_last_name\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_last_name\n\t) AS mplt_last_name_out,\n\tmplt_split_client_tab_long_name.suffix AS mplt_suffix,\n\t-- *INF*: IIF(isnull(mplt_suffix) or length(mplt_suffix)=0,'N/A',mplt_suffix)\n\tIFF(mplt_suffix IS NULL \n\t\tOR length(mplt_suffix\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_suffix\n\t) AS mplt_suffix_out,\n\tmplt_split_client_tab_long_name.full_name AS mplt_full_name,\n\t-- *INF*: IIF(isnull(mplt_full_name) or length(mplt_full_name)=0,'N/A',mplt_full_name)\n\tIFF(mplt_full_name IS NULL \n\t\tOR length(mplt_full_name\n\t\t) = 0,\n\t\t'N/A',\n\t\tmplt_full_name\n\t) AS mplt_full_name_out,\n\tLKP_IndividualClientStage.CIID_DTH_DT,\n\t-- *INF*: IIF(ISNULL(CIID_DTH_DT) OR CIID_DTH_DT > TO_DATE('12/31/2999','MM/DD/YYYY'), \r\n\t-- \t\tTO_DATE('12/31/2999','MM/DD/YYYY'), \r\n\t-- \tCIID_DTH_DT)\n\tIFF(CIID_DTH_DT IS NULL \n\t\tOR CIID_DTH_DT > TO_DATE('12/31/2999', 'MM/DD/YYYY'\n\t\t),\n\t\tTO_DATE('12/31/2999', 'MM/DD/YYYY'\n\t\t),\n\t\tCIID_DTH_DT\n\t) AS v_CIID_DTH_DT,\n\tv_CIID_DTH_DT AS o_CIID_DTH_DT\n\tFROM EXP_Values\n\t -- Manually join with EXP_phone\n\t -- Manually join with mplt_split_client_tab_long_name\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_ALL\n\tON LKP_CLIENT_ADDRESS_STAGE_ALL.ADR_ID = EXP_Values.ADR_ID_ALL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_ALM\n\tON LKP_CLIENT_ADDRESS_STAGE_ALM.ADR_ID = EXP_Values.ADR_ID_ALM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_BLM\n\tON LKP_CLIENT_ADDRESS_STAGE_BLM.ADR_ID = EXP_Values.ADR_ID_BLM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_BLRT\n\tON LKP_CLIENT_ADDRESS_STAGE_BLRT.ADR_ID = EXP_Values.ADR_ID_BLRT\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_BSL\n\tON LKP_CLIENT_ADDRESS_STAGE_BSL.ADR_ID = EXP_Values.ADR_ID_BSL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_BSM\n\tON LKP_CLIENT_ADDRESS_STAGE_BSM.ADR_ID = EXP_Values.ADR_ID_BSM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_BSS\n\tON LKP_CLIENT_ADDRESS_STAGE_BSS.ADR_ID = EXP_Values.ADR_ID_BSS\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_CLL\n\tON LKP_CLIENT_ADDRESS_STAGE_CLL.ADR_ID = EXP_Values.ADR_ID_CLL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_CLM\n\tON LKP_CLIENT_ADDRESS_STAGE_CLM.ADR_ID = EXP_Values.ADR_ID_CLM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_COM\n\tON LKP_CLIENT_ADDRESS_STAGE_COM.ADR_ID = EXP_Values.ADR_ID_COM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_GL\n\tON LKP_CLIENT_ADDRESS_STAGE_GL.ADR_ID = EXP_Values.ADR_ID_GL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_HHA\n\tON LKP_CLIENT_ADDRESS_STAGE_HHA.ADR_ID = EXP_Values.ADR_ID_HHA\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_INHA\n\tON LKP_CLIENT_ADDRESS_STAGE_INHA.ADR_ID = EXP_Values.ADR_ID_INHA\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_INHL\n\tON LKP_CLIENT_ADDRESS_STAGE_INHL.ADR_ID = EXP_Values.ADR_ID_INHL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_INHM\n\tON LKP_CLIENT_ADDRESS_STAGE_INHM.ADR_ID = EXP_Values.ADR_ID_INHM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_INWL\n\tON LKP_CLIENT_ADDRESS_STAGE_INWL.ADR_ID = EXP_Values.ADR_ID_INWL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_INWM\n\tON LKP_CLIENT_ADDRESS_STAGE_INWM.ADR_ID = EXP_Values.ADR_ID_INWM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_LOC\n\tON LKP_CLIENT_ADDRESS_STAGE_LOC.ADR_ID = EXP_Values.ADR_ID_LOC\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_LPA\n\tON LKP_CLIENT_ADDRESS_STAGE_LPA.ADR_ID = EXP_Values.ADR_ID_LPA\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_LPE\n\tON LKP_CLIENT_ADDRESS_STAGE_LPE.ADR_ID = EXP_Values.ADR_ID_LPE\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_MAL\n\tON LKP_CLIENT_ADDRESS_STAGE_MAL.ADR_ID = EXP_Values.ADR_ID_MAL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PLB\n\tON LKP_CLIENT_ADDRESS_STAGE_PLB.ADR_ID = EXP_Values.ADR_ID_PLB\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PLG\n\tON LKP_CLIENT_ADDRESS_STAGE_PLG.ADR_ID = EXP_Values.ADR_ID_PLG\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PLL\n\tON LKP_CLIENT_ADDRESS_STAGE_PLL.ADR_ID = EXP_Values.ADR_ID_PLL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PLM\n\tON LKP_CLIENT_ADDRESS_STAGE_PLM.ADR_ID = EXP_Values.ADR_ID_PLM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PMF\n\tON LKP_CLIENT_ADDRESS_STAGE_PMF.ADR_ID = EXP_Values.ADR_ID_PMF\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PPL\n\tON LKP_CLIENT_ADDRESS_STAGE_PPL.ADR_ID = EXP_Values.ADR_ID_PPL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_PRAD\n\tON LKP_CLIENT_ADDRESS_STAGE_PRAD.ADR_ID = EXP_Values.ADR_ID_PRAD\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_SPL\n\tON LKP_CLIENT_ADDRESS_STAGE_SPL.ADR_ID = EXP_Values.ADR_ID_SPL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_TMPM\n\tON LKP_CLIENT_ADDRESS_STAGE_TMPM.ADR_ID = EXP_Values.ADR_ID_TMPM\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_VCL\n\tON LKP_CLIENT_ADDRESS_STAGE_VCL.ADR_ID = EXP_Values.ADR_ID_VCL\n\tLEFT JOIN LKP_CLIENT_ADDRESS_STAGE_VCM\n\tON LKP_CLIENT_ADDRESS_STAGE_VCM.ADR_ID = EXP_Values.ADR_ID_VCM\n\tLEFT JOIN LKP_IndividualClientStage\n\tON LKP_IndividualClientStage.CLIENT_ID = EXP_Values.CLIENT_ID\n\tLEFT JOIN LKP_CLIENT_TAX_STAGE LKP_CLIENT_TAX_STAGE_CLIENT_ID_SSN\n\tON LKP_CLIENT_TAX_STAGE_CLIENT_ID_SSN.client_id = CLIENT_ID\n\tAND LKP_CLIENT_TAX_STAGE_CLIENT_ID_SSN.tax_type_cd = 'SSN'\n\n\tLEFT JOIN LKP_CLIENT_TAX_STAGE LKP_CLIENT_TAX_STAGE_CLIENT_ID_FED\n\tON LKP_CLIENT_TAX_STAGE_CLIENT_ID_FED.client_id = CLIENT_ID\n\tAND LKP_CLIENT_TAX_STAGE_CLIENT_ID_FED.tax_type_cd = 'FED'\n\n),\nLKP_Claim_Party AS (\n\tSELECT\n\tclaim_party_id,\n\tclaim_party_ak_id,\n\tclaim_party_full_name,\n\tclaim_party_first_name,\n\tclaim_party_last_name,\n\tclaim_party_mid_name,\n\tclaim_party_name_prfx,\n\tclaim_party_name_sfx,\n\tclaim_party_addr,\n\tclaim_party_city,\n\tclaim_party_county,\n\tclaim_party_state,\n\tclaim_party_zip,\n\taddr_type,\n\ttax_ssn_id,\n\ttax_fed_id,\n\tclaim_party_birthdate,\n\tclaim_party_gndr,\n\tph_num,\n\tph_extension,\n\tph_type,\n\tlgl_ent_code,\n\tclaim_party_ref_eff_from_date,\n\tclaim_party_death_date,\n\tclaim_party_key\n\tFROM (\n\t\tSELECT a.claim_party_id as claim_party_id, \r\n\t\ta.claim_party_ak_id as claim_party_ak_id, \r\n\t\ta.claim_party_full_name as claim_party_full_name, \r\n\t\ta.claim_party_first_name as claim_party_first_name, \r\n\t\ta.claim_party_last_name as claim_party_last_name, \r\n\t\ta.claim_party_mid_name as claim_party_mid_name, \r\n\t\ta.claim_party_name_prfx as claim_party_name_prfx, \r\n\t\ta.claim_party_name_sfx as claim_party_name_sfx, \r\n\t\ta.claim_party_addr as claim_party_addr, \r\n\t\ta.claim_party_city as claim_party_city, \r\n\t\ta.claim_party_county as claim_party_county, \r\n\t\ta.claim_party_state as claim_party_state, \r\n\t\ta.claim_party_zip as claim_party_zip, \r\n\t\ta.addr_type as addr_type, \r\n\t\ta.tax_ssn_id as tax_ssn_id, \r\n\t\ta.tax_fed_id as tax_fed_id, \r\n\t\ta.claim_party_birthdate as claim_party_birthdate, \r\n\t\ta.claim_party_gndr as claim_party_gndr, \r\n\t\ta.ph_num as ph_num, \r\n\t\ta.ph_extension as ph_extension, \r\n\t\ta.ph_type as ph_type, \r\n\t\ta.lgl_ent_code as lgl_ent_code, \r\n\t\ta.claim_party_ref_eff_from_date as claim_party_ref_eff_from_date, \r\n\t\ta.claim_party_death_date as claim_party_death_date, \r\n\t\ta.claim_party_key as claim_party_key \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party a\r\n\t\tINNER JOIN @{pipeline().parameters.STAGING_DATABASE}.@{pipeline().parameters.TARGET_TABLE_OWNER}.client_tab_stage b\r\n\t\ton a.claim_party_key = b.CLIENT_ID\r\n\t\tWHERE  a.source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'  AND a.crrnt_snpsht_flag = 1\r\n\t\tORDER BY claim_party_key --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_key ORDER BY claim_party_id) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tEXP_Lkp_Values.CLIENT_ID,\n\tEXP_Lkp_Values.mplt_first_name_out AS CICL_FST_NM,\n\tEXP_Lkp_Values.mplt_last_name_out AS CICL_LST_NM,\n\tEXP_Lkp_Values.mplt_middle_name_out AS CICL_MDL_NM,\n\tEXP_Lkp_Values.mplt_prefix_out AS NM_PFX,\n\tEXP_Lkp_Values.mplt_suffix_out AS NM_SFX,\n\tEXP_Lkp_Values.CICL_LNG_NM,\n\tEXP_Lkp_Values.mplt_full_name_out AS FULL_NAME,\n\tEXP_Lkp_Values.ADR_TYP_CD,\n\tEXP_Lkp_Values.CICA_ADR,\n\tEXP_Lkp_Values.CICA_CIT_NM,\n\tEXP_Lkp_Values.CICA_CTY,\n\tEXP_Lkp_Values.ST_CD,\n\tEXP_Lkp_Values.CICA_PST_CD,\n\tEXP_Lkp_Values.citx_tax_id_ssn,\n\tEXP_Lkp_Values.citx_tax_id_fed,\n\tEXP_Lkp_Values.CICL_DOB_DT,\n\tEXP_Lkp_Values.GENDER_CD,\n\tEXP_Lkp_Values.Phone,\n\tEXP_Lkp_Values.Phone_Extn,\n\tEXP_Lkp_Values.Phone_Type,\n\tEXP_Lkp_Values.LEG_ENT_CD,\n\tEXP_Lkp_Values.claim_party_ref_eff_from_date,\n\tEXP_Lkp_Values.o_CIID_DTH_DT AS CIID_DTH_DT,\n\tLKP_Claim_Party.claim_party_id AS lkp_claim_party_id,\n\tLKP_Claim_Party.claim_party_ak_id AS lkp_claim_party_ak_id,\n\tLKP_Claim_Party.claim_party_full_name AS lkp_claim_party_full_name,\n\tLKP_Claim_Party.claim_party_first_name AS lkp_claim_party_first_name,\n\tLKP_Claim_Party.claim_party_last_name AS lkp_claim_party_last_name,\n\tLKP_Claim_Party.claim_party_mid_name AS lkp_claim_party_mid_name,\n\tLKP_Claim_Party.claim_party_name_prfx AS lkp_claim_party_name_prfx,\n\tLKP_Claim_Party.claim_party_name_sfx AS lkp_claim_party_name_sfx,\n\tLKP_Claim_Party.claim_party_addr AS lkp_claimant_addr,\n\tLKP_Claim_Party.claim_party_city AS lkp_claimant_city,\n\tLKP_Claim_Party.claim_party_county AS lkp_claimant_county,\n\tLKP_Claim_Party.claim_party_state AS lkp_claimant_state,\n\tLKP_Claim_Party.claim_party_zip AS lkp_claimant_zip,\n\tLKP_Claim_Party.addr_type AS lkp_addr_type,\n\tLKP_Claim_Party.tax_ssn_id AS lkp_tax_ssn_id,\n\tLKP_Claim_Party.tax_fed_id AS lkp_tax_fed_id,\n\tLKP_Claim_Party.claim_party_birthdate AS lkp_claim_party_birthdate,\n\tLKP_Claim_Party.claim_party_gndr AS lkp_claim_party_gndr,\n\tLKP_Claim_Party.ph_num AS lkp_ph_num,\n\tLKP_Claim_Party.ph_extension AS lkp_ph_extension,\n\tLKP_Claim_Party.ph_type AS lkp_ph_type,\n\tLKP_Claim_Party.lgl_ent_code AS lkp_lgl_ent_code,\n\tLKP_Claim_Party.claim_party_ref_eff_from_date AS lkp_claim_party_ref_eff_from_date,\n\tLKP_Claim_Party.claim_party_death_date AS lkp_claim_party_death_date,\n\t0 AS logical_flag,\n\t1 AS Crrnt_Snpsht_Flag,\n\t-- *INF*: iif(isnull(lkp_claim_party_id),'NEW',\r\n\t-- \tiif (\r\n\t-- \t(ltrim(rtrim(CICL_FST_NM)) <> ltrim(rtrim(lkp_claim_party_first_name))) or\r\n\t-- \t(ltrim(rtrim(CICL_LST_NM)) <> ltrim(rtrim(lkp_claim_party_last_name))) or\r\n\t-- \t(ltrim(rtrim(CICL_MDL_NM)) <> ltrim(rtrim(lkp_claim_party_mid_name))) or\r\n\t-- \t(ltrim(rtrim(NM_PFX)) <> ltrim(rtrim(lkp_claim_party_name_prfx))) or\r\n\t-- \t(ltrim(rtrim(NM_SFX)) <> ltrim(rtrim(lkp_claim_party_name_sfx))) or\r\n\t-- \t(ltrim(rtrim(CICA_ADR)) <> ltrim(rtrim(lkp_claimant_addr) )) or\r\n\t-- \t(ltrim(rtrim(CICA_CTY)) <> ltrim(rtrim(lkp_claimant_county) )) or\r\n\t-- \t(ltrim(rtrim(CICA_CIT_NM)) <>  ltrim(rtrim(lkp_claimant_city))) or\r\n\t-- \t(ltrim(rtrim(ST_CD)) <> ltrim(rtrim(lkp_claimant_state))) or\r\n\t-- \t(ltrim(rtrim(CICA_PST_CD)) <> ltrim(rtrim(lkp_claimant_zip))) or\r\n\t--       (ltrim(rtrim(citx_tax_id_ssn)) <>  ltrim(rtrim(lkp_tax_ssn_id))) or\r\n\t--       (ltrim(rtrim(citx_tax_id_fed)) <> ltrim(rtrim(lkp_tax_fed_id))) or\r\n\t--       (CICL_DOB_DT <>  lkp_claim_party_birthdate) or\r\n\t--       (ltrim(rtrim(GENDER_CD)) <> ltrim(rtrim(lkp_claim_party_gndr))) or\r\n\t--       (ltrim(rtrim(Phone)) <> ltrim(rtrim(lkp_ph_num))) or\r\n\t--       (ltrim(rtrim(Phone_Extn)) <> ltrim(rtrim(lkp_ph_extension))) or\r\n\t--       (ltrim(rtrim(Phone_Type)) <> ltrim(rtrim(lkp_ph_type))) or\r\n\t--       (ltrim(rtrim(LEG_ENT_CD)) <> ltrim(rtrim(lkp_lgl_ent_code))) or\r\n\t-- \t(ltrim(rtrim(ADR_TYP_CD)) <> ltrim(rtrim(lkp_addr_type)))  or\r\n\t-- \tclaim_party_ref_eff_from_date <> lkp_claim_party_ref_eff_from_date\r\n\t-- or\r\n\t-- \tCIID_DTH_DT <> lkp_claim_party_death_date, \r\n\t-- \t'UPDATE',\r\n\t-- \t'NOCHANGE'))\n\tIFF(lkp_claim_party_id IS NULL,\n\t\t'NEW',\n\t\tIFF(( ltrim(rtrim(CICL_FST_NM\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_first_name\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICL_LST_NM\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_last_name\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICL_MDL_NM\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_mid_name\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(NM_PFX\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_name_prfx\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(NM_SFX\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_name_sfx\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICA_ADR\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claimant_addr\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICA_CTY\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claimant_county\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICA_CIT_NM\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claimant_city\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(ST_CD\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claimant_state\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(CICA_PST_CD\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claimant_zip\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(citx_tax_id_ssn\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_tax_ssn_id\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(citx_tax_id_fed\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_tax_fed_id\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( CICL_DOB_DT <> lkp_claim_party_birthdate \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(GENDER_CD\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_claim_party_gndr\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(Phone\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_ph_num\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(Phone_Extn\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_ph_extension\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(Phone_Type\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_ph_type\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(LEG_ENT_CD\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_lgl_ent_code\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR ( ltrim(rtrim(ADR_TYP_CD\n\t\t\t\t\t)\n\t\t\t\t) <> ltrim(rtrim(lkp_addr_type\n\t\t\t\t\t)\n\t\t\t\t) \n\t\t\t) \n\t\t\tOR claim_party_ref_eff_from_date <> lkp_claim_party_ref_eff_from_date \n\t\t\tOR CIID_DTH_DT <> lkp_claim_party_death_date,\n\t\t\t'UPDATE',\n\t\t\t'NOCHANGE'\n\t\t)\n\t) AS v_Changed_Flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Audit_Id,\n\t-- *INF*: IIF(v_Changed_Flag='NEW',\r\n\t-- \tTO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'),\r\n\t-- \tSYSDATE)\n\tIFF(v_Changed_Flag = 'NEW',\n\t\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tSYSDATE\n\t) AS Eff_From_Date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'\n\t) AS Eff_To_Date,\n\tv_Changed_Flag AS Changed_Flag,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID,\n\tSYSDATE AS Created_Date,\n\tSYSDATE AS Modified_Date\n\tFROM EXP_Lkp_Values\n\tLEFT JOIN LKP_Claim_Party\n\tON LKP_Claim_Party.claim_party_key = EXP_Lkp_Values.CLIENT_ID\n),\nFIL_Insert AS (\n\tSELECT\n\tlkp_claim_party_ak_id, \n\tCLIENT_ID, \n\tCICL_FST_NM, \n\tCICL_LST_NM, \n\tCICL_MDL_NM, \n\tNM_PFX, \n\tNM_SFX, \n\tFULL_NAME, \n\tADR_TYP_CD, \n\tCICA_ADR, \n\tCICA_CIT_NM, \n\tCICA_CTY, \n\tST_CD, \n\tCICA_PST_CD, \n\tcitx_tax_id_ssn, \n\tcitx_tax_id_fed, \n\tCICL_DOB_DT, \n\tGENDER_CD, \n\tlogical_flag, \n\tCrrnt_Snpsht_Flag, \n\tAudit_Id, \n\tEff_From_Date, \n\tEff_To_Date, \n\tSOURCE_SYSTEM_ID, \n\tCreated_Date, \n\tModified_Date, \n\tChanged_Flag, \n\tPhone, \n\tPhone_Extn, \n\tPhone_Type, \n\tLEG_ENT_CD, \n\tclaim_party_ref_eff_from_date, \n\tCIID_DTH_DT\n\tFROM EXP_Detect_Changes\n\tWHERE Changed_Flag='NEW'  OR Changed_Flag='UPDATE'\n),\nSEQ_claim_party AS (\n\tCREATE SEQUENCE SEQ_claim_party\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_Determine_AK AS (\n\tSELECT\n\tlkp_claim_party_ak_id,\n\t-- *INF*: IIF(Changed_Flag='NEW',\r\n\t-- NEXTVAL,\r\n\t-- lkp_claim_party_ak_id)\n\tIFF(Changed_Flag = 'NEW',\n\t\tNEXTVAL,\n\t\tlkp_claim_party_ak_id\n\t) AS claim_party_ak_id,\n\tCLIENT_ID,\n\tCICL_FST_NM,\n\tCICL_LST_NM,\n\tCICL_MDL_NM,\n\tNM_PFX,\n\tNM_SFX,\n\tFULL_NAME,\n\tADR_TYP_CD,\n\tCICA_ADR,\n\tCICA_CIT_NM,\n\tCICA_CTY,\n\tST_CD,\n\tCICA_PST_CD,\n\tcitx_tax_id_ssn,\n\tcitx_tax_id_fed,\n\tCICL_DOB_DT,\n\tGENDER_CD,\n\tlogical_flag,\n\tCrrnt_Snpsht_Flag,\n\tAudit_Id,\n\tEff_From_Date,\n\tEff_To_Date,\n\tSOURCE_SYSTEM_ID,\n\tCreated_Date,\n\tModified_Date,\n\tChanged_Flag,\n\tPhone,\n\tPhone_Extn,\n\tPhone_Type,\n\tLEG_ENT_CD,\n\tclaim_party_ref_eff_from_date,\n\tCIID_DTH_DT,\n\tSEQ_claim_party.NEXTVAL\n\tFROM FIL_Insert\n),\nclaim_party_Insert AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party\n\t(claim_party_ak_id, claim_party_key, claim_party_full_name, claim_party_first_name, claim_party_last_name, claim_party_mid_name, claim_party_name_prfx, claim_party_name_sfx, claim_party_addr, claim_party_city, claim_party_county, claim_party_state, claim_party_zip, addr_type, tax_ssn_id, tax_fed_id, claim_party_birthdate, claim_party_gndr, logical_flag, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date, ph_num, ph_extension, ph_type, lgl_ent_code, claim_party_ref_eff_from_date, claim_party_death_date)\n\tSELECT \n\tCLAIM_PARTY_AK_ID, \n\tCLIENT_ID AS CLAIM_PARTY_KEY, \n\tFULL_NAME AS CLAIM_PARTY_FULL_NAME, \n\tCICL_FST_NM AS CLAIM_PARTY_FIRST_NAME, \n\tCICL_LST_NM AS CLAIM_PARTY_LAST_NAME, \n\tCICL_MDL_NM AS CLAIM_PARTY_MID_NAME, \n\tNM_PFX AS CLAIM_PARTY_NAME_PRFX, \n\tNM_SFX AS CLAIM_PARTY_NAME_SFX, \n\tCICA_ADR AS CLAIM_PARTY_ADDR, \n\tCICA_CIT_NM AS CLAIM_PARTY_CITY, \n\tCICA_CTY AS CLAIM_PARTY_COUNTY, \n\tST_CD AS CLAIM_PARTY_STATE, \n\tCICA_PST_CD AS CLAIM_PARTY_ZIP, \n\tADR_TYP_CD AS ADDR_TYPE, \n\tcitx_tax_id_ssn AS TAX_SSN_ID, \n\tcitx_tax_id_fed AS TAX_FED_ID, \n\tCICL_DOB_DT AS CLAIM_PARTY_BIRTHDATE, \n\tGENDER_CD AS CLAIM_PARTY_GNDR, \n\tLOGICAL_FLAG, \n\tCrrnt_Snpsht_Flag AS CRRNT_SNPSHT_FLAG, \n\tAudit_Id AS AUDIT_ID, \n\tEff_From_Date AS EFF_FROM_DATE, \n\tEff_To_Date AS EFF_TO_DATE, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYS_ID, \n\tCreated_Date AS CREATED_DATE, \n\tModified_Date AS MODIFIED_DATE, \n\tPhone AS PH_NUM, \n\tPhone_Extn AS PH_EXTENSION, \n\tPhone_Type AS PH_TYPE, \n\tLEG_ENT_CD AS LGL_ENT_CODE, \n\tCLAIM_PARTY_REF_EFF_FROM_DATE, \n\tCIID_DTH_DT AS CLAIM_PARTY_DEATH_DATE\n\tFROM EXP_Determine_AK\n),\nSQ_claim_party AS (\n\tSELECT \r\n\ta.claim_party_id, \r\n\ta.claim_party_key, \r\n\ta.eff_from_date, \r\n\ta.eff_to_date \r\n\tFROM\r\n\t @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party a\r\n\tWHERE \r\n\t a.source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' and\r\n\t EXISTS(SELECT 1\t\t\t\r\n\t\t\tFROM  @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party b\r\n\t\t\tWHERE source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'  AND crrnt_snpsht_flag = 1\r\n\t\t\tAND a.claim_party_key = b.claim_party_key\r\n\t\t\tGROUP BY claim_party_key\r\n\t\t\tHAVING COUNT(*) > 1)\r\n\tORDER BY claim_party_key, eff_from_date  DESC--\n),\nEXP_Lag_eff_from_date AS (\n\tSELECT\n\tclaim_party_id,\n\tclaim_party_key,\n\teff_from_date,\n\teff_to_date AS orig_eff_to_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tclaim_party_key = v_PREV_ROW_party_key, ADD_TO_DATE(v_PREV_ROW_eff_from_date,'SS',-1),\r\n\t-- \torig_eff_to_date)\n\tDECODE(TRUE,\n\t\tclaim_party_key = v_PREV_ROW_party_key, DATEADD(SECOND,- 1,v_PREV_ROW_eff_from_date),\n\t\torig_eff_to_date\n\t) AS v_eff_to_date,\n\tv_eff_to_date AS eff_to_date,\n\teff_from_date AS v_PREV_ROW_eff_from_date,\n\tclaim_party_key AS v_PREV_ROW_party_key,\n\tSYSDATE AS modified_date,\n\t0 AS crrnt_snpsht_flag\n\tFROM SQ_claim_party\n),\nFIL_FirstRowInAKGroup AS (\n\tSELECT\n\tclaim_party_id, \n\torig_eff_to_date, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM EXP_Lag_eff_from_date\n\tWHERE orig_eff_to_date <> eff_to_date\r\n\r\n--If these two dates equal each other we are dealing with the first row in an AK group.  This row\r\n--does not need to be expired or updated for any reason thus it can be filtered out\r\n-- but we must source it to capture the eff_from_date of this row \r\n--so that we can properly expire the subsequent row\n),\nUPD_Claim_Party AS (\n\tSELECT\n\tclaim_party_id, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM FIL_FirstRowInAKGroup\n),\nclaim_party_Update AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party AS T\n\tUSING UPD_Claim_Party AS S\n\tON T.claim_party_id = S.claim_party_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.eff_to_date = S.eff_to_date, T.modified_date = S.modified_date\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "STAGING_DATABASE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataWarehouse/"
        },
        "annotations": []
    }
}