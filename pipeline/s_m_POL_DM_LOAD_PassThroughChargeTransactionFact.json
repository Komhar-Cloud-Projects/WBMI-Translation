{
    "name": "s_m_POL_DM_LOAD_PassThroughChargeTransactionFact",
    "properties": {
        "activities": [
            {
                "name": "m_POL_DM_LOAD_PassThroughChargeTransactionFact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Calender_Dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id DESC) = 1\n),\nLKP_InsuranceReferenceDim AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tEnterpriseGroupCode,\n\tInsuranceReferenceLegalEntityCode,\n\tStrategicProfitCenterCode,\n\tInsuranceSegmentCode,\n\tPolicyOfferingCode,\n\tProductCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRatingPlanCode\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceReferenceDimId,\n\t\t\tEnterpriseGroupCode,\n\t\t\tInsuranceReferenceLegalEntityCode,\n\t\t\tStrategicProfitCenterCode,\n\t\t\tInsuranceSegmentCode,\n\t\t\tPolicyOfferingCode,\n\t\t\tProductCode,\n\t\t\tInsuranceReferenceLineOfBusinessCode,\n\t\t\tRatingPlanCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceDim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EnterpriseGroupCode,InsuranceReferenceLegalEntityCode,StrategicProfitCenterCode,InsuranceSegmentCode,PolicyOfferingCode,ProductCode,InsuranceReferenceLineOfBusinessCode,RatingPlanCode ORDER BY InsuranceReferenceDimId) = 1\n),\nSQ_PassThroughChargeTransaction_AndFact_Physical_Deletes AS (\n\tSELECT \r\n\tPTCTF.PassThroughChargeTransactionFactID\r\n\tFROM @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PassThroughChargeTransaction PTCT\r\n\tinner join \r\n\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.@{pipeline().parameters.TARGET_TABLE_NAME} PTCTF\r\n\ton PTCT.PassThroughChargeTransactionID=PTCTF.EDWPassThroughChargeTransactionPkId\r\n\tWHERE\r\n\tPTCT.PassThroughChargeTransactionEnteredDate>='01-01-1998'\r\n\tAND PTCT.ModifiedDate>='@{pipeline().parameters.SELECTION_START_TS}' \r\n\tAND PTCT.CurrentSnapshotFlag='0'\n),\nEXP_pass_through AS (\n\tSELECT\n\tPassThroughChargeTransactionFactID\n\tFROM SQ_PassThroughChargeTransaction_AndFact_Physical_Deletes\n),\nUPD_Delete_expired_records AS (\n\tSELECT\n\tPassThroughChargeTransactionFactID\n\tFROM EXP_pass_through\n),\nTGT_PassThroughChargeTransactionFact_DEL AS (\n\tDELETE FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.@{pipeline().parameters.TARGET_TABLE_NAME}\n\tWHERE (PassThroughChargeTransactionFactID) IN (SELECT  PASSTHROUGHCHARGETRANSACTIONFACTID FROM UPD_Delete_expired_records)\n),\nSQ_PassThroughChargeTransaction AS (\n\tSELECT distinct \r\n\tPTCT.PassThroughChargeTransactionID , \r\n\tPTCT.StatisticalCoverageAKID , \r\n\tPTCT.PassThroughChargeTransactionEnteredDate ,\r\n\tPTCT.PassThroughChargeTransactionEffectiveDate , \r\n\tPTCT.PassThroughChargeTransactionExpirationDate ,\r\n\tPTCT.PassThroughChargeTransactionBookedDate , \r\n\tPTCT.PassThroughChargeTransactionAmount , \r\n\tPTCT.FullTaxAmount , \r\n\tPTCT.TaxPercentageRate ,\r\n\tPTCT.ReasonAmendedCode , \r\n\tPTCT.PassThroughChargeTransactionCodeId ,\r\n\tSC.MajorPerilCode ,\r\n\tPOL.contract_cust_ak_id ,\r\n\tPOL.AgencyAKId , \r\n\tPTCT.PolicyAKID ,\r\n\tPC.InsuranceLine , \r\n\tPTCT.SupPassThroughChargeTypeID , \r\n\tPTCT.TotalAnnualPremiumSubjectToTax , \r\n\tRL.RiskLocationHashKey ,\r\n\tProduct.ProductCode , \r\n\tPolicyOffering.PolicyOfferingCode ,\r\n\tInsuranceReferenceLineOfBusiness.InsuranceReferenceLineOfBusinessCode , \r\n\tEnterpriseGroup.EnterpriseGroupCode , \r\n\tInsuranceReferenceLegalEntity.InsuranceReferenceLegalEntityCode ,\r\n\tStrategicProfitCenter.StrategicProfitCenterCode , \r\n\tInsuranceSegment.InsuranceSegmentCode,\r\n\tRPDT.RatingPlanCode,\r\n\tPTCT.SupLGTLineOfInsuranceID\r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.PassThroughChargeTransaction PTCT\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\tON PTCT.StatisticalCoverageAKID=SC.StatisticalCoverageAKID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\tON PC.PolicyCoverageAKID=SC.PolicyCoverageAKID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\tON PC.RiskLocationAKID=RL.RiskLocationAKID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy POL\r\n\tON RL.PolicyAKID=POL.pol_ak_id \r\n\tand POL.crrnt_snpsht_flag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.Product \r\n\tON Product.ProductAKId=SC.ProductAKId \r\n\tAND Product.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyOffering \r\n\tON PolicyOffering.PolicyOfferingAKId=POL.PolicyOfferingAKId \r\n\tAND PolicyOffering.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLineOfBusiness \r\n\tON InsuranceReferenceLineOfBusiness.InsuranceReferenceLineOfBusinessAKId=SC.InsuranceReferenceLineOfBusinessAKId \r\n\tAND InsuranceReferenceLineOfBusiness.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter \r\n\tON POL.StrategicProfitCenterAKId=StrategicProfitCenter.StrategicProfitCenterAKId \r\n\tAND StrategicProfitCenter.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment \r\n\tON InsuranceSegment.InsuranceSegmentAKId=POL.InsuranceSegmentAKId \r\n\tAND InsuranceSegment.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.EnterpriseGroup \r\n\tON EnterpriseGroup.EnterpriseGroupId=StrategicProfitCenter.EnterpriseGroupId \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity \r\n\tON InsuranceReferenceLegalEntity.InsuranceReferenceLegalEntityId=StrategicProfitCenter.InsuranceReferenceLegalEntityId \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingPlan RPDT\r\n\ton PC.RatingPlanAKId=RPDT.RatingPlanAKId and RPDT.CurrentSnapshotFlag=1\r\n\tWHERE\r\n\tPOL.source_sys_id='PMS'\r\n\tAND PTCT.PassThroughChargeTransactionEnteredDate>='01-01-1998' \r\n\t--AND PTCT.CREATEDDATE>='@{pipeline().parameters.SELECTION_START_TS}' \r\n\tAND PTCT.CurrentSnapshotFlag='1' AND NOT EXISTS (\r\n\tSELECT 1 FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PassThroughChargeTransactionFact PTCTF\r\n\tWHERE PTCT.PassThroughChargeTransactionID=PTCTF.EDWPassThroughChargeTransactionPkId)\r\n\t\r\n\tUNION ALL \r\n\t\r\n\tSELECT distinct \r\n\tPTCT.PassThroughChargeTransactionID , \r\n\tPTCT.StatisticalCoverageAKID , \r\n\tPTCT.PassThroughChargeTransactionEnteredDate ,\r\n\tPTCT.PassThroughChargeTransactionEffectiveDate , \r\n\tPTCT.PassThroughChargeTransactionExpirationDate ,\r\n\tPTCT.PassThroughChargeTransactionBookedDate , \r\n\tPTCT.PassThroughChargeTransactionAmount , \r\n\tPTCT.FullTaxAmount , \r\n\tPTCT.TaxPercentageRate ,\r\n\tPTCT.ReasonAmendedCode , \r\n\tPTCT.PassThroughChargeTransactionCodeId ,\r\n\t'N/A' AS MajorPerilCode ,\r\n\tPOL.contract_cust_ak_id ,\r\n\tPOL.AgencyAKId , \r\n\tPTCT.PolicyAKID ,\r\n\tPC.InsuranceLine , \r\n\tPTCT.SupPassThroughChargeTypeID , \r\n\tPTCT.TotalAnnualPremiumSubjectToTax , \r\n\tRL.RiskLocationHashKey ,\r\n\t'N/A' AS ProductCode , \r\n\tPolicyOffering.PolicyOfferingCode ,\r\n\t'N/A' AS InsuranceReferenceLineOfBusinessCode , \r\n\tEnterpriseGroup.EnterpriseGroupCode , \r\n\tInsuranceReferenceLegalEntity.InsuranceReferenceLegalEntityCode ,\r\n\tStrategicProfitCenter.StrategicProfitCenterCode , \r\n\tInsuranceSegment.InsuranceSegmentCode,\r\n\tRPDT.RatingPlanCode,\r\n\tPTCT.SupLGTLineOfInsuranceID\r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.PassThroughChargeTransaction PTCT\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\tON PC.PolicyCoverageAKID=PTCT.PolicyCoverageAKID \r\n\tAND PC.CurrentSnapshotFlag=1\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\tON PC.RiskLocationAKID=RL.RiskLocationAKID \r\n\tand RL.CurrentSnapshotFlag=1 \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy POL\r\n\tON PTCT.PolicyAKID=POL.pol_ak_id \r\n\tand POL.crrnt_snpsht_flag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyOffering \r\n\tON PolicyOffering.PolicyOfferingAKId=POL.PolicyOfferingAKId \r\n\tAND PolicyOffering.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter \r\n\tON POL.StrategicProfitCenterAKId=StrategicProfitCenter.StrategicProfitCenterAKId \r\n\tAND StrategicProfitCenter.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment \r\n\tON InsuranceSegment.InsuranceSegmentAKId=POL.InsuranceSegmentAKId \r\n\tAND InsuranceSegment.CurrentSnapshotFlag=1 \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.EnterpriseGroup \r\n\tON EnterpriseGroup.EnterpriseGroupId=StrategicProfitCenter.EnterpriseGroupId \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity \r\n\tON InsuranceReferenceLegalEntity.InsuranceReferenceLegalEntityId=StrategicProfitCenter.InsuranceReferenceLegalEntityId \r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingPlan RPDT\r\n\ton PC.RatingPlanAKId=RPDT.RatingPlanAKId and RPDT.CurrentSnapshotFlag=1\r\n\tWHERE\r\n\tPOL.source_sys_id='DCT'\r\n\t--AND PTCT.CREATEDDATE>='@{pipeline().parameters.SELECTION_START_TS}' \r\n\tAND PTCT.CurrentSnapshotFlag='1' AND NOT EXISTS (\r\n\tSELECT 1 FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PassThroughChargeTransactionFact PTCTF\r\n\tWHERE PTCT.PassThroughChargeTransactionID=PTCTF.EDWPassThroughChargeTransactionPkId)\n),\nExp_get_data AS (\n\tSELECT\n\tPassThroughChargeTransactionID,\n\tStatisticalCoverageAKID,\n\tPassThroughChargeTransactionEnteredDate,\n\tPassThroughChargeTransactionEffectiveDate,\n\tPassThroughChargeTransactionExpirationDate,\n\tPassThroughChargeTransactionBookedDate,\n\tPassThroughChargeTransactionAmount,\n\tFullTaxAmount,\n\tTaxPercentageRate,\n\tReasonAmendedCode,\n\tPassThroughChargeTransactionCodeId,\n\tMajorPerilCode,\n\tcontract_cust_ak_id,\n\tAgencyAkId,\n\tPolicyAKID,\n\tInsuranceLine,\n\tSupPassThroughChargeTypeID,\n\tTotalAnnualPremiumSubjectToTax,\n\tRiskLocationHashKey,\n\tProductCode AS i_ProductCode,\n\tPolicyOfferingCode AS i_PolicyOfferingCode,\n\tInsuranceReferenceLineOfBusinessCode AS i_InsuranceReferenceLineOfBusinessCode,\n\tEnterpriseGroupCode AS i_EnterpriseGroupCode,\n\tInsuranceReferenceLegalEntityCode AS i_InsuranceReferenceLegalEntityCode,\n\tStrategicProfitCenterCode AS i_StrategicProfitCenterCode,\n\tInsuranceSegmentCode AS i_InsuranceSegmentCode,\n\tRatingPlanCode AS i_RatingPlanCode,\n\tSupLGTLineOfInsuranceID,\n\t-- *INF*: IIF(NOT ISNULL(i_ProductCode), i_ProductCode, '000')\n\tIFF(i_ProductCode IS NOT NULL, i_ProductCode, '000') AS ProductCode,\n\t-- *INF*: IIF(NOT ISNULL(i_PolicyOfferingCode), i_PolicyOfferingCode, '000')\n\tIFF(i_PolicyOfferingCode IS NOT NULL, i_PolicyOfferingCode, '000') AS PolicyOfferingCode,\n\t-- *INF*: IIF(NOT ISNULL(i_InsuranceReferenceLineOfBusinessCode), i_InsuranceReferenceLineOfBusinessCode, '000')\n\tIFF(\n\t    i_InsuranceReferenceLineOfBusinessCode IS NOT NULL, i_InsuranceReferenceLineOfBusinessCode,\n\t    '000'\n\t) AS InsuranceReferenceLineOfBusinessCode,\n\t-- *INF*: IIF(NOT ISNULL(i_EnterpriseGroupCode), i_EnterpriseGroupCode, '1')\n\tIFF(i_EnterpriseGroupCode IS NOT NULL, i_EnterpriseGroupCode, '1') AS EnterpriseGroupCode,\n\t-- *INF*: IIF(NOT ISNULL(i_InsuranceReferenceLegalEntityCode), i_InsuranceReferenceLegalEntityCode, '1')\n\tIFF(\n\t    i_InsuranceReferenceLegalEntityCode IS NOT NULL, i_InsuranceReferenceLegalEntityCode, '1'\n\t) AS InsuranceReferenceLegalEntityCode,\n\t-- *INF*: IIF(NOT ISNULL(i_StrategicProfitCenterCode), i_StrategicProfitCenterCode, '6')\n\tIFF(i_StrategicProfitCenterCode IS NOT NULL, i_StrategicProfitCenterCode, '6') AS StrategicProfitCenterCode,\n\t-- *INF*: IIF(NOT ISNULL(i_InsuranceSegmentCode), i_InsuranceSegmentCode, 'N/A')\n\tIFF(i_InsuranceSegmentCode IS NOT NULL, i_InsuranceSegmentCode, 'N/A') AS InsuranceSegmentCode,\n\t-- *INF*: IIF(ISNULL(i_RatingPlanCode), '1', i_RatingPlanCode)\n\tIFF(i_RatingPlanCode IS NULL, '1', i_RatingPlanCode) AS RatingPlanCode\n\tFROM SQ_PassThroughChargeTransaction\n),\nLKP_SupLGTLineOfInsurance AS (\n\tSELECT\n\tStandardLGTLineOfInsuranceCode,\n\tSupLGTLineOfInsuranceId,\n\tIn_SupLGTLineOfInsuranceID\n\tFROM (\n\t\tSELECT \n\t\t\tStandardLGTLineOfInsuranceCode,\n\t\t\tSupLGTLineOfInsuranceId,\n\t\t\tIn_SupLGTLineOfInsuranceID\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupLGTLineOfInsurance\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SupLGTLineOfInsuranceId ORDER BY StandardLGTLineOfInsuranceCode) = 1\n),\nLKP_LGTLineOfInsuranceDim AS (\n\tSELECT\n\tLGTLineOfInsuranceDimId,\n\tLGTLineOfInsuranceCode\n\tFROM (\n\t\tSELECT \n\t\t\tLGTLineOfInsuranceDimId,\n\t\t\tLGTLineOfInsuranceCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.LGTLineOfInsuranceDim\n\t\tWHERE CurrentSnapshotFlag='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY LGTLineOfInsuranceCode ORDER BY LGTLineOfInsuranceDimId) = 1\n),\nLKP_SupPassThroughChargeType AS (\n\tSELECT\n\tPassThroughChargeType,\n\tIN_SupPassThroughChargeTypeID1,\n\tSupPassThroughChargeTypeID\n\tFROM (\n\t\tSELECT \n\t\t\tPassThroughChargeType,\n\t\t\tIN_SupPassThroughChargeTypeID1,\n\t\t\tSupPassThroughChargeTypeID\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.SupPassThroughChargeType\n\t\tWHERE CurrentSnapShotFlag='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SupPassThroughChargeTypeID ORDER BY PassThroughChargeType) = 1\n),\nLKP_Sup_Reason_Amended_Code AS (\n\tSELECT\n\tStandardReasonAmendedCode,\n\trsn_amended_code\n\tFROM (\n\t\tSELECT \n\t\t\tStandardReasonAmendedCode,\n\t\t\trsn_amended_code\n\t\tFROM Sup_Reason_Amended_Code\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY rsn_amended_code ORDER BY StandardReasonAmendedCode) = 1\n),\nlkp_sup_premim_transaction_code AS (\n\tSELECT\n\tStandardPremiumTransactionCode,\n\tsup_prem_trans_code_id\n\tFROM (\n\t\tSELECT\r\n\t\tsup_premium_transaction_code.sup_prem_trans_code_id as sup_prem_trans_code_id,\r\n\t\tsup_premium_transaction_code.StandardPremiumTransactionCode as StandardPremiumTransactionCode\r\n\t\tFROM sup_premium_transaction_code\r\n\t\twhere sup_premium_transaction_code.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_prem_trans_code_id ORDER BY StandardPremiumTransactionCode DESC) = 1\n),\nLKP_PassThroughChargeTransactionTypeDim AS (\n\tSELECT\n\tPassThroughChargeTransactionTypeDimID,\n\tPassThroughChargeTransactionCode,\n\tReasonAmendedCode,\n\tPassThroughChargeType\n\tFROM (\n\t\tSELECT \n\t\t\tPassThroughChargeTransactionTypeDimID,\n\t\t\tPassThroughChargeTransactionCode,\n\t\t\tReasonAmendedCode,\n\t\t\tPassThroughChargeType\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.PassThroughChargeTransactionTypeDim\n\t\tWHERE CurrentSnapshotFlag='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PassThroughChargeTransactionCode,ReasonAmendedCode,PassThroughChargeType ORDER BY PassThroughChargeTransactionTypeDimID) = 1\n),\nLKP_RiskLocationDim AS (\n\tSELECT\n\tRiskLocationDimID,\n\tRiskLocationHashKey\n\tFROM (\n\t\tSELECT \n\t\t\tRiskLocationDimID,\n\t\t\tRiskLocationHashKey\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.RiskLocationDim\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RiskLocationHashKey ORDER BY RiskLocationDimID) = 1\n),\nLKP_V3_AgencyDim AS (\n\tSELECT\n\tAgencyDimID,\n\tEDWAgencyAKID\n\tFROM (\n\t\tSELECT \n\t\t\tAgencyDimID,\n\t\t\tEDWAgencyAKID\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER_V3}.AgencyDim\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID ORDER BY AgencyDimID) = 1\n),\nLKP_contract_customer_dim AS (\n\tSELECT\n\tcontract_cust_dim_id,\n\tedw_contract_cust_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tcontract_cust_dim_id,\n\t\t\tedw_contract_cust_ak_id\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.contract_customer_dim\n\t\tWHERE crrnt_snpsht_flag ='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id ORDER BY contract_cust_dim_id) = 1\n),\nLKP_policy_dim AS (\n\tSELECT\n\tpol_dim_id,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_sym,\n\tedw_pol_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tpol_dim_id,\n\t\t\tpol_eff_date,\n\t\t\tpol_exp_date,\n\t\t\tpol_cancellation_date,\n\t\t\tpol_sym,\n\t\t\tedw_pol_ak_id\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.policy_dim\n\t\tWHERE crrnt_snpsht_flag ='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_ak_id ORDER BY pol_dim_id) = 1\n),\nEXP_FinalizeIDs AS (\n\tSELECT\n\tLKP_RiskLocationDim.RiskLocationDimID AS in_RiskLocationDimID,\n\tLKP_V3_AgencyDim.AgencyDimID AS in_agency_dim_id,\n\tLKP_contract_customer_dim.contract_cust_dim_id AS in_contract_cust_dim_id,\n\tLKP_policy_dim.pol_dim_id AS in_pol_dim_id,\n\tLKP_policy_dim.pol_eff_date AS in_pol_eff_date,\n\tLKP_policy_dim.pol_exp_date AS in_pol_exp_date,\n\tLKP_policy_dim.pol_cancellation_date AS in_pol_cancellation_date,\n\tLKP_policy_dim.pol_sym AS in_pol_sym,\n\tLKP_PassThroughChargeTransactionTypeDim.PassThroughChargeTransactionTypeDimID AS in_PassThroughChargeTransactionTypeDimID,\n\tLKP_LGTLineOfInsuranceDim.LGTLineOfInsuranceDimId AS in_LGTLineOfInsuranceDimId,\n\tExp_get_data.PassThroughChargeTransactionID AS in_PassThroughChargeTransactionID,\n\tExp_get_data.PassThroughChargeTransactionEnteredDate AS in_PassThroughChargeTransactionEnteredDate,\n\tExp_get_data.PassThroughChargeTransactionEffectiveDate AS in_PassThroughChargeTransactionEffectiveDate,\n\tExp_get_data.PassThroughChargeTransactionExpirationDate AS in_PassThroughChargeTransactionExpirationDate,\n\tExp_get_data.PassThroughChargeTransactionBookedDate AS in_PassThroughChargeTransactionBookedDate,\n\tExp_get_data.PassThroughChargeTransactionAmount AS in_PassThroughChargeTransactionAmount,\n\tExp_get_data.FullTaxAmount AS in_FullTaxAmount,\n\tExp_get_data.TaxPercentageRate AS in_TaxPercentageRate,\n\tExp_get_data.MajorPerilCode AS in_MajorPerilCode,\n\tExp_get_data.TotalAnnualPremiumSubjectToTax AS in_TotalAnnualPremiumSubjectToTax,\n\tExp_get_data.ProductCode AS in_ProductCode,\n\tExp_get_data.PolicyOfferingCode AS in_PolicyOfferingCode,\n\tExp_get_data.InsuranceReferenceLineOfBusinessCode AS in_InsuranceReferenceLineOfBusinessCode,\n\tExp_get_data.EnterpriseGroupCode AS in_EnterpriseGroupCode,\n\tExp_get_data.InsuranceReferenceLegalEntityCode AS in_InsuranceReferenceLegalEntityCode,\n\tExp_get_data.StrategicProfitCenterCode AS in_StrategicProfitCenterCode,\n\tExp_get_data.InsuranceSegmentCode AS in_InsuranceSegmentCode,\n\tExp_get_data.RatingPlanCode AS in_RatingPlanCode,\n\t-- *INF*: :LKP.LKP_INSURANCEREFERENCEDIM(in_ProductCode,in_PolicyOfferingCode,in_InsuranceReferenceLineOfBusinessCode,in_EnterpriseGroupCode,in_InsuranceReferenceLegalEntityCode,in_StrategicProfitCenterCode,in_InsuranceSegmentCode,in_RatingPlanCode)\n\tLKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceDimId AS v_InsuranceReferenceDimId,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_pol_cancellation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_cancellation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_cancellation_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_PassThroughChargeTransactionEffectiveDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEffectiveDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_PassThroughChargeTransactionEffectiveDateID,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_PassThroughChargeTransactionExpirationDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionExpirationDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_PassThroughChargeTransactionExpirationDateID,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_PassThroughChargeTransactionBookedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionBookedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_PassThroughChargeTransactionBookedDateID,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE(TO_CHAR(in_PassThroughChargeTransactionEnteredDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEnteredDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_PassThroughChargeTransactionEnteredDateID,\n\t-- *INF*: :LKP.LKP_INSURANCEREFERENCEDIM(in_ProductCode,in_PolicyOfferingCode,'300',in_EnterpriseGroupCode,in_InsuranceReferenceLegalEntityCode,in_StrategicProfitCenterCode,in_InsuranceSegmentCode, in_RatingPlanCode)\n\tLKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceDimId AS v_InsuranceReferenceDimId_300,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS out_AuditId,\n\tin_PassThroughChargeTransactionID AS out_PassThroughChargeTransactionID,\n\t-- *INF*: IIF(ISNULL(in_agency_dim_id),-1,in_agency_dim_id)\n\tIFF(in_agency_dim_id IS NULL, - 1, in_agency_dim_id) AS out_agency_dim_id,\n\t-- *INF*: IIF(ISNULL(in_pol_dim_id),-1,in_pol_dim_id)\n\tIFF(in_pol_dim_id IS NULL, - 1, in_pol_dim_id) AS out_pol_dim_id,\n\t-- *INF*: IIF(ISNULL(in_contract_cust_dim_id),-1,in_contract_cust_dim_id)\n\tIFF(in_contract_cust_dim_id IS NULL, - 1, in_contract_cust_dim_id) AS out_contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(in_RiskLocationDimID),-1,in_RiskLocationDimID)\n\tIFF(in_RiskLocationDimID IS NULL, - 1, in_RiskLocationDimID) AS out_RiskLocationDimID,\n\t-- *INF*: -1\r\n\t-- --wreq-9642 removed lookup on statisticalcoveragedim table\n\t- 1 AS out_StatisticalCoverageDimID,\n\t-- *INF*: IIF(ISNULL(in_PassThroughChargeTransactionTypeDimID),-1,in_PassThroughChargeTransactionTypeDimID)\n\tIFF(\n\t    in_PassThroughChargeTransactionTypeDimID IS NULL, - 1,\n\t    in_PassThroughChargeTransactionTypeDimID\n\t) AS out_PassThroughChargeTransactionTypeDimID,\n\t-- *INF*: IIF(ISNULL(v_pol_eff_date),-1,v_pol_eff_date)\n\tIFF(v_pol_eff_date IS NULL, - 1, v_pol_eff_date) AS out_PolicyEffectiveDateID,\n\t-- *INF*: IIF(ISNULL(v_pol_exp_date),-1,v_pol_exp_date)\n\tIFF(v_pol_exp_date IS NULL, - 1, v_pol_exp_date) AS out_PolicyExpirationDateID,\n\t-- *INF*: IIF(ISNULL(v_PassThroughChargeTransactionEffectiveDateID),-1,v_PassThroughChargeTransactionEffectiveDateID)\n\tIFF(\n\t    v_PassThroughChargeTransactionEffectiveDateID IS NULL, - 1,\n\t    v_PassThroughChargeTransactionEffectiveDateID\n\t) AS out_PassThroughChargeTransactionEffectiveDateID,\n\t-- *INF*: IIF(ISNULL(v_PassThroughChargeTransactionExpirationDateID),-1,v_PassThroughChargeTransactionExpirationDateID)\n\tIFF(\n\t    v_PassThroughChargeTransactionExpirationDateID IS NULL, - 1,\n\t    v_PassThroughChargeTransactionExpirationDateID\n\t) AS out_PassThroughChargeTransactionExpirationDateID,\n\t-- *INF*: IIF(ISNULL(v_PassThroughChargeTransactionBookedDateID),-1,v_PassThroughChargeTransactionBookedDateID)\n\tIFF(\n\t    v_PassThroughChargeTransactionBookedDateID IS NULL, - 1,\n\t    v_PassThroughChargeTransactionBookedDateID\n\t) AS out_PassThroughChargeTransactionBookedDateID,\n\t-- *INF*: IIF(ISNULL(v_PassThroughChargeTransactionEnteredDateID),-1,v_PassThroughChargeTransactionEnteredDateID)\n\tIFF(\n\t    v_PassThroughChargeTransactionEnteredDateID IS NULL, - 1,\n\t    v_PassThroughChargeTransactionEnteredDateID\n\t) AS out_PassThroughChargeTransactionEnteredDateID,\n\tin_FullTaxAmount AS out_FullTaxAmount,\n\tin_TaxPercentageRate AS out_TaxPercentageRate,\n\tin_PassThroughChargeTransactionAmount AS out_PassThroughChargeTransactionAmount,\n\t-- *INF*: IIF(ISNULL(v_pol_cancellation_date),-1,v_pol_cancellation_date)\n\tIFF(v_pol_cancellation_date IS NULL, - 1, v_pol_cancellation_date) AS out_PolicyCancellationDateID,\n\t-1 AS out_asl_dim_id,\n\t-- *INF*: IIF(ISNULL(in_LGTLineOfInsuranceDimId),-1,in_LGTLineOfInsuranceDimId)\n\tIFF(in_LGTLineOfInsuranceDimId IS NULL, - 1, in_LGTLineOfInsuranceDimId) AS out_LGTLineOfInsuranceDimId,\n\tin_TotalAnnualPremiumSubjectToTax AS out_TotalAnnualPremiumSubjectToTax,\n\t-- *INF*: IIF(ISNULL(v_InsuranceReferenceDimId),-1,v_InsuranceReferenceDimId)\n\tIFF(v_InsuranceReferenceDimId IS NULL, - 1, v_InsuranceReferenceDimId) AS out_InsuranceReferenceDimId\n\tFROM Exp_get_data\n\tLEFT JOIN LKP_LGTLineOfInsuranceDim\n\tON LKP_LGTLineOfInsuranceDim.LGTLineOfInsuranceCode = LKP_SupLGTLineOfInsurance.StandardLGTLineOfInsuranceCode\n\tLEFT JOIN LKP_PassThroughChargeTransactionTypeDim\n\tON LKP_PassThroughChargeTransactionTypeDim.PassThroughChargeTransactionCode = lkp_sup_premim_transaction_code.StandardPremiumTransactionCode AND LKP_PassThroughChargeTransactionTypeDim.ReasonAmendedCode = LKP_Sup_Reason_Amended_Code.StandardReasonAmendedCode AND LKP_PassThroughChargeTransactionTypeDim.PassThroughChargeType = LKP_SupPassThroughChargeType.PassThroughChargeType\n\tLEFT JOIN LKP_RiskLocationDim\n\tON LKP_RiskLocationDim.RiskLocationHashKey = Exp_get_data.RiskLocationHashKey\n\tLEFT JOIN LKP_V3_AgencyDim\n\tON LKP_V3_AgencyDim.EDWAgencyAKID = Exp_get_data.AgencyAkId\n\tLEFT JOIN LKP_contract_customer_dim\n\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = Exp_get_data.contract_cust_ak_id\n\tLEFT JOIN LKP_policy_dim\n\tON LKP_policy_dim.edw_pol_ak_id = Exp_get_data.PolicyAKID\n\tLEFT JOIN LKP_INSURANCEREFERENCEDIM LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode\n\tON LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.EnterpriseGroupCode = in_ProductCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceLegalEntityCode = in_PolicyOfferingCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.StrategicProfitCenterCode = in_InsuranceReferenceLineOfBusinessCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceSegmentCode = in_EnterpriseGroupCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.PolicyOfferingCode = in_InsuranceReferenceLegalEntityCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.ProductCode = in_StrategicProfitCenterCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceLineOfBusinessCode = in_InsuranceSegmentCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_in_InsuranceReferenceLineOfBusinessCode_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.RatingPlanCode = in_RatingPlanCode\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_cancellation_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_pol_cancellation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_pol_cancellation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEffectiveDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEffectiveDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_PassThroughChargeTransactionEffectiveDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionExpirationDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionExpirationDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_PassThroughChargeTransactionExpirationDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionBookedDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionBookedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_PassThroughChargeTransactionBookedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEnteredDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_TO_DATE_TO_CHAR_in_PassThroughChargeTransactionEnteredDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(TO_CHAR(in_PassThroughChargeTransactionEnteredDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_INSURANCEREFERENCEDIM LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode\n\tON LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.EnterpriseGroupCode = in_ProductCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceLegalEntityCode = in_PolicyOfferingCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.StrategicProfitCenterCode = '300'\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceSegmentCode = in_EnterpriseGroupCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.PolicyOfferingCode = in_InsuranceReferenceLegalEntityCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.ProductCode = in_StrategicProfitCenterCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.InsuranceReferenceLineOfBusinessCode = in_InsuranceSegmentCode\n\tAND LKP_INSURANCEREFERENCEDIM_in_ProductCode_in_PolicyOfferingCode_300_in_EnterpriseGroupCode_in_InsuranceReferenceLegalEntityCode_in_StrategicProfitCenterCode_in_InsuranceSegmentCode_in_RatingPlanCode.RatingPlanCode = in_RatingPlanCode\n\n),\nTGT_PassThroughChargeTransactionFact_INS AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.@{pipeline().parameters.TARGET_TABLE_NAME};\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.@{pipeline().parameters.TARGET_TABLE_NAME}\n\t(AuditId, EDWPassThroughChargeTransactionPkId, AgencyDimID, PolicyDimID, ContractCustomerDimID, RiskLocationDimID, StatisticalCoverageDimID, PassThroughChargeTransactionTypeDimID, PolicyEffectiveDateID, PolicyExpirationDateID, PassThroughChargeTransactionEffectiveDateId, PassThroughChargeTransactionExpirationDateId, PassThroughChargeTransactionBookedDateId, PassThroughChargeTransactionEnteredDateId, FullTaxAmount, TaxPercentageRate, PassThroughChargeTransactionAmount, PolicyCancellationDateID, asl_dim_id, LGTLineOfInsuranceDimId, TotalAnnualPremiumSubjectToTax, InsuranceReferenceDimId)\n\tSELECT \n\tout_AuditId AS AUDITID, \n\tout_PassThroughChargeTransactionID AS EDWPASSTHROUGHCHARGETRANSACTIONPKID, \n\tout_agency_dim_id AS AGENCYDIMID, \n\tout_pol_dim_id AS POLICYDIMID, \n\tout_contract_cust_dim_id AS CONTRACTCUSTOMERDIMID, \n\tout_RiskLocationDimID AS RISKLOCATIONDIMID, \n\tout_StatisticalCoverageDimID AS STATISTICALCOVERAGEDIMID, \n\tout_PassThroughChargeTransactionTypeDimID AS PASSTHROUGHCHARGETRANSACTIONTYPEDIMID, \n\tout_PolicyEffectiveDateID AS POLICYEFFECTIVEDATEID, \n\tout_PolicyExpirationDateID AS POLICYEXPIRATIONDATEID, \n\tout_PassThroughChargeTransactionEffectiveDateID AS PASSTHROUGHCHARGETRANSACTIONEFFECTIVEDATEID, \n\tout_PassThroughChargeTransactionExpirationDateID AS PASSTHROUGHCHARGETRANSACTIONEXPIRATIONDATEID, \n\tout_PassThroughChargeTransactionBookedDateID AS PASSTHROUGHCHARGETRANSACTIONBOOKEDDATEID, \n\tout_PassThroughChargeTransactionEnteredDateID AS PASSTHROUGHCHARGETRANSACTIONENTEREDDATEID, \n\tout_FullTaxAmount AS FULLTAXAMOUNT, \n\tout_TaxPercentageRate AS TAXPERCENTAGERATE, \n\tout_PassThroughChargeTransactionAmount AS PASSTHROUGHCHARGETRANSACTIONAMOUNT, \n\tout_PolicyCancellationDateID AS POLICYCANCELLATIONDATEID, \n\tout_asl_dim_id AS ASL_DIM_ID, \n\tout_LGTLineOfInsuranceDimId AS LGTLINEOFINSURANCEDIMID, \n\tout_TotalAnnualPremiumSubjectToTax AS TOTALANNUALPREMIUMSUBJECTTOTAX, \n\tout_InsuranceReferenceDimId AS INSURANCEREFERENCEDIMID\n\tFROM EXP_FinalizeIDs\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER_V3": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataMart/"
        },
        "annotations": []
    }
}