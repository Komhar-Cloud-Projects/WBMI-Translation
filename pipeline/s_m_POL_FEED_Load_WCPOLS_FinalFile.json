{
    "name": "s_m_POL_FEED_Load_WCPOLS_FinalFile",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_FinalFile",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WCPOLS_Record01 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ExperienceRatingCode)+\r\n\tmax(InterstateRiskIDNumber)+\r\n\tmax(PolicyExpirationDate)+\r\n\tmax(ThirdPartyEntityFederalEmployerIdentificationNumber)+\r\n\tmax(TypeOfCoverageIDCode)+\r\n\tmax(EmployeeLeasingPolicyTypeCode)+\r\n\tmax(PolicyTermCode)+\r\n\tmax(PriorPolicyNumberIdentifier)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(LegalNatureOfInsuredCode)+\r\n\tmax(TypeOfPlanIDCode)+\r\n\tmax(WrapUpOwnerControlledInsuranceProgramCode)+\r\n\tmax(BusinessSegmentIdentifier)+\r\n\tmax(PolicyMinimumPremiumAmount)+\r\n\tmax(PolicyMinimumPremiumStateCode)+\r\n\tmax(PolicyEstimatedStandardPremiumTotal)+\r\n\tmax(PolicyDepositPremiumAmount)+\r\n\tmax(AuditFrequencyCode)+\r\n\tmax(BillingFrequencyCode)+\r\n\tmax(RetrospectiveRatingCode)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount)+\r\n\tmax(NameOfProducer)+\r\n\tmax(AssignedRiskBinderNumberFirstSevenPositions)+\r\n\tmax(GroupCoverageStatusCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(OriginalCarrierCode)+\r\n\tmax(OriginalPolicyNumberIdentifier)+\r\n\tmax(OriginalPolicyEffectiveDate)+\r\n\tmax(TextForOtherLegalNatureOfInsured)+\r\n\tmax(AssignmentDate)+\r\n\tmax(AssignedRiskBinderNumberLastElevenPositions)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate),\r\n\tmax(WCTrackHistoryID) WCTrackHistoryID From (\r\n\tSelect WCPols01RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExperienceRatingCode' and C.FieldName='ExperienceRatingCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExperienceRatingCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExperienceRatingCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ExperienceRatingCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExperienceRatingCode' and C.FieldName='ExperienceRatingCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ExperienceRatingCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='InterstateRiskIDNumber' and C.FieldName='InterstateRiskIDNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.InterstateRiskIDNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.InterstateRiskIDNumber,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.InterstateRiskIDNumber,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='InterstateRiskIDNumber' and C.FieldName='InterstateRiskIDNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end InterstateRiskIDNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyExpirationDate' and C.FieldName='PolicyExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyExpirationDate' and C.FieldName='PolicyExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyExpirationDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdPartyEntityFederalEmployerIdentificationNumber' and C.FieldName='ThirdPartyEntityFederalEmployerIdentificationNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdPartyEntityFederalEmployerIdentificationNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdPartyEntityFederalEmployerIdentificationNumber,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.ThirdPartyEntityFederalEmployerIdentificationNumber,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdPartyEntityFederalEmployerIdentificationNumber' and C.FieldName='ThirdPartyEntityFederalEmployerIdentificationNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end ThirdPartyEntityFederalEmployerIdentificationNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TypeOfCoverageIDCode' and C.FieldName='TypeOfCoverageIDCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TypeOfCoverageIDCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TypeOfCoverageIDCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.TypeOfCoverageIDCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TypeOfCoverageIDCode' and C.FieldName='TypeOfCoverageIDCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end TypeOfCoverageIDCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployeeLeasingPolicyTypeCode' and C.FieldName='EmployeeLeasingPolicyTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployeeLeasingPolicyTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployeeLeasingPolicyTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.EmployeeLeasingPolicyTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployeeLeasingPolicyTypeCode' and C.FieldName='EmployeeLeasingPolicyTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end EmployeeLeasingPolicyTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyTermCode' and C.FieldName='PolicyTermCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyTermCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyTermCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.PolicyTermCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyTermCode' and C.FieldName='PolicyTermCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end PolicyTermCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PriorPolicyNumberIdentifier' and C.FieldName='PriorPolicyNumberIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PriorPolicyNumberIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PriorPolicyNumberIdentifier,'')+replicate(' ',18),18) else Right(replicate('0',18)+ISNULL(A.PriorPolicyNumberIdentifier,''),18) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PriorPolicyNumberIdentifier' and C.FieldName='PriorPolicyNumberIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',18) else replicate('0',18) end\r\n\tend end PriorPolicyNumberIdentifier,\r\n\treplicate(' ',11) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LegalNatureOfInsuredCode' and C.FieldName='LegalNatureOfInsuredCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LegalNatureOfInsuredCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LegalNatureOfInsuredCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.LegalNatureOfInsuredCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LegalNatureOfInsuredCode' and C.FieldName='LegalNatureOfInsuredCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end LegalNatureOfInsuredCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TypeOfPlanIDCode' and C.FieldName='TypeOfPlanIDCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TypeOfPlanIDCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TypeOfPlanIDCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.TypeOfPlanIDCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TypeOfPlanIDCode' and C.FieldName='TypeOfPlanIDCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end TypeOfPlanIDCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='WrapUpOwnerControlledInsuranceProgramCode' and C.FieldName='WrapUpOwnerControlledInsuranceProgramCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.WrapUpOwnerControlledInsuranceProgramCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.WrapUpOwnerControlledInsuranceProgramCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.WrapUpOwnerControlledInsuranceProgramCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='WrapUpOwnerControlledInsuranceProgramCode' and C.FieldName='WrapUpOwnerControlledInsuranceProgramCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end WrapUpOwnerControlledInsuranceProgramCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BusinessSegmentIdentifier' and C.FieldName='BusinessSegmentIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BusinessSegmentIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BusinessSegmentIdentifier,'')+replicate(' ',7),7) else Right(replicate('0',7)+ISNULL(A.BusinessSegmentIdentifier,''),7) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BusinessSegmentIdentifier' and C.FieldName='BusinessSegmentIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',7) else replicate('0',7) end\r\n\tend end BusinessSegmentIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyMinimumPremiumAmount' and C.FieldName='PolicyMinimumPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyMinimumPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyMinimumPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PolicyMinimumPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyMinimumPremiumAmount' and C.FieldName='PolicyMinimumPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PolicyMinimumPremiumAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyMinimumPremiumStateCode' and C.FieldName='PolicyMinimumPremiumStateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyMinimumPremiumStateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyMinimumPremiumStateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.PolicyMinimumPremiumStateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyMinimumPremiumStateCode' and C.FieldName='PolicyMinimumPremiumStateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end PolicyMinimumPremiumStateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyEstimatedStandardPremiumTotal' and C.FieldName='PolicyEstimatedStandardPremiumTotal' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyEstimatedStandardPremiumTotal or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyEstimatedStandardPremiumTotal,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PolicyEstimatedStandardPremiumTotal,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyEstimatedStandardPremiumTotal' and C.FieldName='PolicyEstimatedStandardPremiumTotal' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PolicyEstimatedStandardPremiumTotal,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyDepositPremiumAmount' and C.FieldName='PolicyDepositPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyDepositPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyDepositPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PolicyDepositPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyDepositPremiumAmount' and C.FieldName='PolicyDepositPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PolicyDepositPremiumAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AuditFrequencyCode' and C.FieldName='AuditFrequencyCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AuditFrequencyCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AuditFrequencyCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.AuditFrequencyCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AuditFrequencyCode' and C.FieldName='AuditFrequencyCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end AuditFrequencyCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BillingFrequencyCode' and C.FieldName='BillingFrequencyCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BillingFrequencyCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BillingFrequencyCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BillingFrequencyCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BillingFrequencyCode' and C.FieldName='BillingFrequencyCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BillingFrequencyCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectiveRatingCode' and C.FieldName='RetrospectiveRatingCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectiveRatingCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectiveRatingCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.RetrospectiveRatingCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectiveRatingCode' and C.FieldName='RetrospectiveRatingCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end RetrospectiveRatingCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount' and C.FieldName='EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfProducer' and C.FieldName='NameOfProducer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfProducer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfProducer,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.NameOfProducer,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfProducer' and C.FieldName='NameOfProducer' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end NameOfProducer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AssignedRiskBinderNumberFirstSevenPositions' and C.FieldName='AssignedRiskBinderNumberFirstSevenPositions' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AssignedRiskBinderNumberFirstSevenPositions or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AssignedRiskBinderNumberFirstSevenPositions,'')+replicate(' ',7),7) else Right(replicate('0',7)+ISNULL(A.AssignedRiskBinderNumberFirstSevenPositions,''),7) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AssignedRiskBinderNumberFirstSevenPositions' and C.FieldName='AssignedRiskBinderNumberFirstSevenPositions' then case when C.FieldDataType in ('A','AN') then replicate(' ',7) else replicate('0',7) end\r\n\tend end AssignedRiskBinderNumberFirstSevenPositions,\r\n\tcase \r\n\twhen B.COLUMN_NAME='GroupCoverageStatusCode' and C.FieldName='GroupCoverageStatusCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.GroupCoverageStatusCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.GroupCoverageStatusCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.GroupCoverageStatusCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='GroupCoverageStatusCode' and C.FieldName='GroupCoverageStatusCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end GroupCoverageStatusCode,\r\n\treplicate(' ',1) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='OriginalCarrierCode' and C.FieldName='OriginalCarrierCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.OriginalCarrierCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.OriginalCarrierCode,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.OriginalCarrierCode,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='OriginalCarrierCode' and C.FieldName='OriginalCarrierCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end OriginalCarrierCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='OriginalPolicyNumberIdentifier' and C.FieldName='OriginalPolicyNumberIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.OriginalPolicyNumberIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.OriginalPolicyNumberIdentifier,'')+replicate(' ',18),18) else Right(replicate('0',18)+ISNULL(A.OriginalPolicyNumberIdentifier,''),18) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='OriginalPolicyNumberIdentifier' and C.FieldName='OriginalPolicyNumberIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',18) else replicate('0',18) end\r\n\tend end OriginalPolicyNumberIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='OriginalPolicyEffectiveDate' and C.FieldName='OriginalPolicyEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.OriginalPolicyEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.OriginalPolicyEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.OriginalPolicyEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='OriginalPolicyEffectiveDate' and C.FieldName='OriginalPolicyEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end OriginalPolicyEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TextForOtherLegalNatureOfInsured' and C.FieldName='TextForOtherLegalNatureOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TextForOtherLegalNatureOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TextForOtherLegalNatureOfInsured,'')+replicate(' ',20),20) else Right(replicate('0',20)+ISNULL(A.TextForOtherLegalNatureOfInsured,''),20) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TextForOtherLegalNatureOfInsured' and C.FieldName='TextForOtherLegalNatureOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',20) else replicate('0',20) end\r\n\tend end TextForOtherLegalNatureOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AssignmentDate' and C.FieldName='AssignmentDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AssignmentDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AssignmentDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.AssignmentDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AssignmentDate' and C.FieldName='AssignmentDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end AssignmentDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AssignedRiskBinderNumberLastElevenPositions' and C.FieldName='AssignedRiskBinderNumberLastElevenPositions' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AssignedRiskBinderNumberLastElevenPositions or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AssignedRiskBinderNumberLastElevenPositions,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.AssignedRiskBinderNumberLastElevenPositions,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AssignedRiskBinderNumberLastElevenPositions' and C.FieldName='AssignedRiskBinderNumberLastElevenPositions' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end AssignedRiskBinderNumberLastElevenPositions,\r\n\treplicate(' ',2) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols01Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols01Record'\r\n\tand c.TableName='WCPols01Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols01RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ExperienceRatingCode)+\r\n\tmax(InterstateRiskIDNumber)+\r\n\tmax(PolicyExpirationDate)+\r\n\tmax(ThirdPartyEntityFederalEmployerIdentificationNumber)+\r\n\tmax(TypeOfCoverageIDCode)+\r\n\tmax(EmployeeLeasingPolicyTypeCode)+\r\n\tmax(PolicyTermCode)+\r\n\tmax(PriorPolicyNumberIdentifier)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(LegalNatureOfInsuredCode)+\r\n\tmax(TypeOfPlanIDCode)+\r\n\tmax(WrapUpOwnerControlledInsuranceProgramCode)+\r\n\tmax(BusinessSegmentIdentifier)+\r\n\tmax(PolicyMinimumPremiumAmount)+\r\n\tmax(PolicyMinimumPremiumStateCode)+\r\n\tmax(PolicyEstimatedStandardPremiumTotal)+\r\n\tmax(PolicyDepositPremiumAmount)+\r\n\tmax(AuditFrequencyCode)+\r\n\tmax(BillingFrequencyCode)+\r\n\tmax(RetrospectiveRatingCode)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByAccidentEachAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByDiseasePolicyLimitAmount)+\r\n\tmax(EmployerLiabilityLimitAmountBodilyInjuryByDiseaseEachEmployeeAmount)+\r\n\tmax(NameOfProducer)+\r\n\tmax(AssignedRiskBinderNumberFirstSevenPositions)+\r\n\tmax(GroupCoverageStatusCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(OriginalCarrierCode)+\r\n\tmax(OriginalPolicyNumberIdentifier)+\r\n\tmax(OriginalPolicyEffectiveDate)+\r\n\tmax(TextForOtherLegalNatureOfInsured)+\r\n\tmax(AssignmentDate)+\r\n\tmax(AssignedRiskBinderNumberLastElevenPositions)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record01 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData,\n\tWCTrackHistoryID\n\tFROM SQ_WCPOLS_Record01\n),\nSQ_WCPOLS_Record02 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(NameTypeCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(ProfessionalEmployerOrganizationOrClientCompanyCode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(FederalEmployerIdentificationNumber)+\r\n\tmax(ContinuationSequenceNumber)+\r\n\tmax(LegalNatureOfEntityCode)+\r\n\tmax(StateCode01)+\r\n\tmax(StateUnemploymentNumber01)+\r\n\tmax(StateCode02)+\r\n\tmax(StateUnemploymentNumber02)+\r\n\tmax(StateCode03)+\r\n\tmax(StateUnemploymentNumber03)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(StateUnemploymentNumberRecordSequenceNumber)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols02RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameTypeCode' and C.FieldName='NameTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.NameTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameTypeCode' and C.FieldName='NameTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end NameTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkIdentifier,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NameLinkIdentifier,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NameLinkIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ProfessionalEmployerOrganizationOrClientCompanyCode' and C.FieldName='ProfessionalEmployerOrganizationOrClientCompanyCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ProfessionalEmployerOrganizationOrClientCompanyCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ProfessionalEmployerOrganizationOrClientCompanyCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ProfessionalEmployerOrganizationOrClientCompanyCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ProfessionalEmployerOrganizationOrClientCompanyCode' and C.FieldName='ProfessionalEmployerOrganizationOrClientCompanyCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ProfessionalEmployerOrganizationOrClientCompanyCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',90),90) else Right(replicate('0',90)+ISNULL(A.NameOfInsured,''),90) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',90) else replicate('0',90) end\r\n\tend end NameOfInsured,\r\n\treplicate(' ',6) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FederalEmployerIdentificationNumber' and C.FieldName='FederalEmployerIdentificationNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FederalEmployerIdentificationNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FederalEmployerIdentificationNumber,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.FederalEmployerIdentificationNumber,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FederalEmployerIdentificationNumber' and C.FieldName='FederalEmployerIdentificationNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end FederalEmployerIdentificationNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ContinuationSequenceNumber' and C.FieldName='ContinuationSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ContinuationSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ContinuationSequenceNumber,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ContinuationSequenceNumber,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ContinuationSequenceNumber' and C.FieldName='ContinuationSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ContinuationSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LegalNatureOfEntityCode' and C.FieldName='LegalNatureOfEntityCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LegalNatureOfEntityCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LegalNatureOfEntityCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.LegalNatureOfEntityCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LegalNatureOfEntityCode' and C.FieldName='LegalNatureOfEntityCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end LegalNatureOfEntityCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode01' and C.FieldName='StateCode01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode01,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode01,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode01' and C.FieldName='StateCode01' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateUnemploymentNumber01' and C.FieldName='StateUnemploymentNumber01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateUnemploymentNumber01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateUnemploymentNumber01,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.StateUnemploymentNumber01,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateUnemploymentNumber01' and C.FieldName='StateUnemploymentNumber01' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end StateUnemploymentNumber01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode02' and C.FieldName='StateCode02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode02,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode02,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode02' and C.FieldName='StateCode02' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateUnemploymentNumber02' and C.FieldName='StateUnemploymentNumber02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateUnemploymentNumber02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateUnemploymentNumber02,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.StateUnemploymentNumber02,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateUnemploymentNumber02' and C.FieldName='StateUnemploymentNumber02' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end StateUnemploymentNumber02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode03' and C.FieldName='StateCode03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode03,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode03,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode03' and C.FieldName='StateCode03' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode03,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateUnemploymentNumber03' and C.FieldName='StateUnemploymentNumber03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateUnemploymentNumber03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateUnemploymentNumber03,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.StateUnemploymentNumber03,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateUnemploymentNumber03' and C.FieldName='StateUnemploymentNumber03' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end StateUnemploymentNumber03,\r\n\treplicate(' ',34) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateUnemploymentNumberRecordSequenceNumber' and C.FieldName='StateUnemploymentNumberRecordSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateUnemploymentNumberRecordSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateUnemploymentNumberRecordSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateUnemploymentNumberRecordSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateUnemploymentNumberRecordSequenceNumber' and C.FieldName='StateUnemploymentNumberRecordSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateUnemploymentNumberRecordSequenceNumber,\r\n\treplicate(' ',20) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkCounterIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkCounterIdentifier,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.NameLinkCounterIdentifier,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end NameLinkCounterIdentifier,\r\n\treplicate(' ',17) ReservedForFutureUse5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols02Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols02Record'\r\n\tand c.TableName='WCPols02Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols02RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(NameTypeCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(ProfessionalEmployerOrganizationOrClientCompanyCode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(FederalEmployerIdentificationNumber)+\r\n\tmax(ContinuationSequenceNumber)+\r\n\tmax(LegalNatureOfEntityCode)+\r\n\tmax(StateCode01)+\r\n\tmax(StateUnemploymentNumber01)+\r\n\tmax(StateCode02)+\r\n\tmax(StateUnemploymentNumber02)+\r\n\tmax(StateCode03)+\r\n\tmax(StateUnemploymentNumber03)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(StateUnemploymentNumberRecordSequenceNumber)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record02 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record02\n),\nSQ_WCPOLS_Record03 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(AddressTypeCode)+\r\n\tmax(ForeignAddressIndicator)+\r\n\tmax(AddressStructureCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForLocationCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PhoneNumberOfInsured)+\r\n\tmax(NumberOfEmployees)+\r\n\tmax(IndustryCode)+\r\n\tmax(GeographicArea)+\r\n\tmax(EmailAddress)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(CountryCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols03RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressTypeCode' and C.FieldName='AddressTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.AddressTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressTypeCode' and C.FieldName='AddressTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end AddressTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ForeignAddressIndicator' and C.FieldName='ForeignAddressIndicator' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ForeignAddressIndicator or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ForeignAddressIndicator,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ForeignAddressIndicator,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ForeignAddressIndicator' and C.FieldName='ForeignAddressIndicator' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ForeignAddressIndicator,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStructureCode' and C.FieldName='AddressStructureCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStructureCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStructureCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.AddressStructureCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStructureCode' and C.FieldName='AddressStructureCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end AddressStructureCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStreet or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStreet,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.AddressStreet,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end AddressStreet,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressCity or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressCity,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.AddressCity,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end AddressCity,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressState or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressState,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.AddressState,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end AddressState,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressZipCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressZipCode,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.AddressZipCode,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end AddressZipCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkIdentifier,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NameLinkIdentifier,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NameLinkIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCodeLink or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCodeLink,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCodeLink,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCodeLink,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposureRecordLinkForLocationCode' and C.FieldName='ExposureRecordLinkForLocationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposureRecordLinkForLocationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposureRecordLinkForLocationCode,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.ExposureRecordLinkForLocationCode,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposureRecordLinkForLocationCode' and C.FieldName='ExposureRecordLinkForLocationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end ExposureRecordLinkForLocationCode,\r\n\treplicate(' ',25) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PhoneNumberOfInsured' and C.FieldName='PhoneNumberOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PhoneNumberOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PhoneNumberOfInsured,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PhoneNumberOfInsured,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PhoneNumberOfInsured' and C.FieldName='PhoneNumberOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PhoneNumberOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NumberOfEmployees' and C.FieldName='NumberOfEmployees' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NumberOfEmployees or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NumberOfEmployees,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.NumberOfEmployees,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NumberOfEmployees' and C.FieldName='NumberOfEmployees' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end NumberOfEmployees,\r\n\tcase \r\n\twhen B.COLUMN_NAME='IndustryCode' and C.FieldName='IndustryCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.IndustryCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.IndustryCode,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.IndustryCode,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='IndustryCode' and C.FieldName='IndustryCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end IndustryCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='GeographicArea' and C.FieldName='GeographicArea' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.GeographicArea or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.GeographicArea,'')+replicate(' ',16),16) else Right(replicate('0',16)+ISNULL(A.GeographicArea,''),16) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='GeographicArea' and C.FieldName='GeographicArea' then case when C.FieldDataType in ('A','AN') then replicate(' ',16) else replicate('0',16) end\r\n\tend end GeographicArea,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmailAddress' and C.FieldName='EmailAddress' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmailAddress or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmailAddress,'')+replicate(' ',39),39) else Right(replicate('0',39)+ISNULL(A.EmailAddress,''),39) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmailAddress' and C.FieldName='EmailAddress' then case when C.FieldDataType in ('A','AN') then replicate(' ',39) else replicate('0',39) end\r\n\tend end EmailAddress,\r\n\treplicate(' ',3) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CountryCode' and C.FieldName='CountryCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CountryCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CountryCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.CountryCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CountryCode' and C.FieldName='CountryCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end CountryCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkCounterIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkCounterIdentifier,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.NameLinkCounterIdentifier,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end NameLinkCounterIdentifier,\r\n\treplicate(' ',18) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols03Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols03Record'\r\n\tand c.TableName='WCPols03Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols03RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(AddressTypeCode)+\r\n\tmax(ForeignAddressIndicator)+\r\n\tmax(AddressStructureCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForLocationCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PhoneNumberOfInsured)+\r\n\tmax(NumberOfEmployees)+\r\n\tmax(IndustryCode)+\r\n\tmax(GeographicArea)+\r\n\tmax(EmailAddress)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(CountryCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record03 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record03\n),\nSQ_WCPOLS_Record03_INIAMO AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(AddressTypeCode)+\r\n\tmax(ForeignAddressIndicator)+\r\n\tmax(AddressStructureCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForLocationCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PhoneNumberOfInsured)+\r\n\tmax(NumberOfEmployees)+\r\n\tmax(IndustryCode)+\r\n\tmax(GeographicArea)+\r\n\tmax(EmailAddress)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(CountryCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols03RecordINIAMOID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressTypeCode' and C.FieldName='AddressTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.AddressTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressTypeCode' and C.FieldName='AddressTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end AddressTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ForeignAddressIndicator' and C.FieldName='ForeignAddressIndicator' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ForeignAddressIndicator or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ForeignAddressIndicator,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ForeignAddressIndicator,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ForeignAddressIndicator' and C.FieldName='ForeignAddressIndicator' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ForeignAddressIndicator,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStructureCode' and C.FieldName='AddressStructureCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStructureCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStructureCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.AddressStructureCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStructureCode' and C.FieldName='AddressStructureCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end AddressStructureCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStreet or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStreet,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.AddressStreet,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end AddressStreet,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressCity or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressCity,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.AddressCity,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end AddressCity,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressState or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressState,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.AddressState,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end AddressState,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressZipCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressZipCode,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.AddressZipCode,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end AddressZipCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkIdentifier,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NameLinkIdentifier,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NameLinkIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCodeLink or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCodeLink,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCodeLink,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCodeLink,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposureRecordLinkForLocationCode' and C.FieldName='ExposureRecordLinkForLocationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposureRecordLinkForLocationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposureRecordLinkForLocationCode,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.ExposureRecordLinkForLocationCode,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposureRecordLinkForLocationCode' and C.FieldName='ExposureRecordLinkForLocationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end ExposureRecordLinkForLocationCode,\r\n\treplicate(' ',25) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PhoneNumberOfInsured' and C.FieldName='PhoneNumberOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PhoneNumberOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PhoneNumberOfInsured,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PhoneNumberOfInsured,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PhoneNumberOfInsured' and C.FieldName='PhoneNumberOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PhoneNumberOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NumberOfEmployees' and C.FieldName='NumberOfEmployees' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NumberOfEmployees or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NumberOfEmployees,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.NumberOfEmployees,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NumberOfEmployees' and C.FieldName='NumberOfEmployees' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end NumberOfEmployees,\r\n\tcase \r\n\twhen B.COLUMN_NAME='IndustryCode' and C.FieldName='IndustryCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.IndustryCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.IndustryCode,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.IndustryCode,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='IndustryCode' and C.FieldName='IndustryCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end IndustryCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='GeographicArea' and C.FieldName='GeographicArea' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.GeographicArea or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.GeographicArea,'')+replicate(' ',16),16) else Right(replicate('0',16)+ISNULL(A.GeographicArea,''),16) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='GeographicArea' and C.FieldName='GeographicArea' then case when C.FieldDataType in ('A','AN') then replicate(' ',16) else replicate('0',16) end\r\n\tend end GeographicArea,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmailAddress' and C.FieldName='EmailAddress' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmailAddress or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmailAddress,'')+replicate(' ',39),39) else Right(replicate('0',39)+ISNULL(A.EmailAddress,''),39) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmailAddress' and C.FieldName='EmailAddress' then case when C.FieldDataType in ('A','AN') then replicate(' ',39) else replicate('0',39) end\r\n\tend end EmailAddress,\r\n\treplicate(' ',3) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CountryCode' and C.FieldName='CountryCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CountryCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CountryCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.CountryCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CountryCode' and C.FieldName='CountryCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end CountryCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkCounterIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkCounterIdentifier,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.NameLinkCounterIdentifier,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end NameLinkCounterIdentifier,\r\n\treplicate(' ',18) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols03RecordINIAMO A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols03Record'\r\n\tand c.TableName='WCPols03Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols03RecordINIAMOID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(AddressTypeCode)+\r\n\tmax(ForeignAddressIndicator)+\r\n\tmax(AddressStructureCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForLocationCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PhoneNumberOfInsured)+\r\n\tmax(NumberOfEmployees)+\r\n\tmax(IndustryCode)+\r\n\tmax(GeographicArea)+\r\n\tmax(EmailAddress)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(CountryCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record03_INIAMO AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record03_INIAMO\n),\nSQ_WCPOLS_Record04 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(StateAddDeleteCode)+\r\n\tmax(ClaimAdministratorFEIN)+\r\n\tmax(IndependentDCORiskIDNumberFileNumberAccountNumber)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(CarrierCode)+\r\n\tmax(ExperienceModificationFactorMeritRatingFactor)+\r\n\tmax(ExperienceModificationStatusCode)+\r\n\tmax(ExperienceModificationPlanTypeCode)+\r\n\tmax(OtherIndividualRiskRatingFactor)+\r\n\tmax(InsurerPremiumDeviationFactor)+\r\n\tmax(TypeOfPremiumDeviationCode)+\r\n\tmax(EstimatedStateStandardPremiumTotal)+\r\n\tmax(ExpenseConstantAmount)+\r\n\tmax(LossConstantAmount)+\r\n\tmax(PremiumDiscountAmount)+\r\n\tmax(ProRatedExpenseConstantAmountReasonCode)+\r\n\tmax(ProRatedMinimumPremiumAmountReasonCode)+\r\n\tmax(ReasonStateWasAddedToThePolicyCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(ExperienceModificationEffectiveDate)+\r\n\tmax(AnniversaryRatingDate)+\r\n\tmax(AssignedRiskAdjustmentProgramFactor)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PremiumAdjustmentPeriodCode)+\r\n\tmax(TypeOfNonStandardIDCode)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols04Record@{pipeline().parameters.RECORD_04_TABLENAMEID}, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateAddDeleteCode' and C.FieldName='StateAddDeleteCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateAddDeleteCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateAddDeleteCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.StateAddDeleteCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateAddDeleteCode' and C.FieldName='StateAddDeleteCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end StateAddDeleteCode,\r\n\t--This case statement was added to replace replicate(' ',9) ReservedForFutureUse1 so that we could utilize this location for the newly added ClaimAdministratorFEIN number\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClaimAdministratorFEIN' and C.FieldName='ClaimAdministratorFEIN' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClaimAdministratorFEIN or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClaimAdministratorFEIN,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.ClaimAdministratorFEIN,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClaimAdministratorFEIN' and C.FieldName='ClaimAdministratorFEIN' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end ClaimAdministratorFEIN,\r\n\tcase \r\n\twhen B.COLUMN_NAME='IndependentDCORiskIDNumberFileNumberAccountNumber' and C.FieldName='IndependentDCORiskIDNumberFileNumberAccountNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.IndependentDCORiskIDNumberFileNumberAccountNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.IndependentDCORiskIDNumberFileNumberAccountNumber,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.IndependentDCORiskIDNumberFileNumberAccountNumber,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='IndependentDCORiskIDNumberFileNumberAccountNumber' and C.FieldName='IndependentDCORiskIDNumberFileNumberAccountNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end IndependentDCORiskIDNumberFileNumberAccountNumber,\r\n\treplicate(' ',15) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierCode' and C.FieldName='CarrierCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierCode,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.CarrierCode,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierCode' and C.FieldName='CarrierCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end CarrierCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExperienceModificationFactorMeritRatingFactor' and C.FieldName='ExperienceModificationFactorMeritRatingFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExperienceModificationFactorMeritRatingFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExperienceModificationFactorMeritRatingFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ExperienceModificationFactorMeritRatingFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExperienceModificationFactorMeritRatingFactor' and C.FieldName='ExperienceModificationFactorMeritRatingFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ExperienceModificationFactorMeritRatingFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExperienceModificationStatusCode' and C.FieldName='ExperienceModificationStatusCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExperienceModificationStatusCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExperienceModificationStatusCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ExperienceModificationStatusCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExperienceModificationStatusCode' and C.FieldName='ExperienceModificationStatusCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ExperienceModificationStatusCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExperienceModificationPlanTypeCode' and C.FieldName='ExperienceModificationPlanTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExperienceModificationPlanTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExperienceModificationPlanTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ExperienceModificationPlanTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExperienceModificationPlanTypeCode' and C.FieldName='ExperienceModificationPlanTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ExperienceModificationPlanTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='OtherIndividualRiskRatingFactor' and C.FieldName='OtherIndividualRiskRatingFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.OtherIndividualRiskRatingFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.OtherIndividualRiskRatingFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.OtherIndividualRiskRatingFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='OtherIndividualRiskRatingFactor' and C.FieldName='OtherIndividualRiskRatingFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end OtherIndividualRiskRatingFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='InsurerPremiumDeviationFactor' and C.FieldName='InsurerPremiumDeviationFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.InsurerPremiumDeviationFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.InsurerPremiumDeviationFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.InsurerPremiumDeviationFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='InsurerPremiumDeviationFactor' and C.FieldName='InsurerPremiumDeviationFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end InsurerPremiumDeviationFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TypeOfPremiumDeviationCode' and C.FieldName='TypeOfPremiumDeviationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TypeOfPremiumDeviationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TypeOfPremiumDeviationCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.TypeOfPremiumDeviationCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TypeOfPremiumDeviationCode' and C.FieldName='TypeOfPremiumDeviationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end TypeOfPremiumDeviationCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedStateStandardPremiumTotal' and C.FieldName='EstimatedStateStandardPremiumTotal' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedStateStandardPremiumTotal or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedStateStandardPremiumTotal,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedStateStandardPremiumTotal,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedStateStandardPremiumTotal' and C.FieldName='EstimatedStateStandardPremiumTotal' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedStateStandardPremiumTotal,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExpenseConstantAmount' and C.FieldName='ExpenseConstantAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExpenseConstantAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExpenseConstantAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.ExpenseConstantAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExpenseConstantAmount' and C.FieldName='ExpenseConstantAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end ExpenseConstantAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LossConstantAmount' and C.FieldName='LossConstantAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LossConstantAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LossConstantAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.LossConstantAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LossConstantAmount' and C.FieldName='LossConstantAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end LossConstantAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PremiumDiscountAmount' and C.FieldName='PremiumDiscountAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PremiumDiscountAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PremiumDiscountAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PremiumDiscountAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PremiumDiscountAmount' and C.FieldName='PremiumDiscountAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PremiumDiscountAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ProRatedExpenseConstantAmountReasonCode' and C.FieldName='ProRatedExpenseConstantAmountReasonCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ProRatedExpenseConstantAmountReasonCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ProRatedExpenseConstantAmountReasonCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ProRatedExpenseConstantAmountReasonCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ProRatedExpenseConstantAmountReasonCode' and C.FieldName='ProRatedExpenseConstantAmountReasonCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ProRatedExpenseConstantAmountReasonCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ProRatedMinimumPremiumAmountReasonCode' and C.FieldName='ProRatedMinimumPremiumAmountReasonCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ProRatedMinimumPremiumAmountReasonCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ProRatedMinimumPremiumAmountReasonCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ProRatedMinimumPremiumAmountReasonCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ProRatedMinimumPremiumAmountReasonCode' and C.FieldName='ProRatedMinimumPremiumAmountReasonCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ProRatedMinimumPremiumAmountReasonCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ReasonStateWasAddedToThePolicyCode' and C.FieldName='ReasonStateWasAddedToThePolicyCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ReasonStateWasAddedToThePolicyCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ReasonStateWasAddedToThePolicyCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ReasonStateWasAddedToThePolicyCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ReasonStateWasAddedToThePolicyCode' and C.FieldName='ReasonStateWasAddedToThePolicyCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ReasonStateWasAddedToThePolicyCode,\r\n\treplicate(' ',3) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExperienceModificationEffectiveDate' and C.FieldName='ExperienceModificationEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExperienceModificationEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExperienceModificationEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.ExperienceModificationEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExperienceModificationEffectiveDate' and C.FieldName='ExperienceModificationEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end ExperienceModificationEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AnniversaryRatingDate' and C.FieldName='AnniversaryRatingDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AnniversaryRatingDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AnniversaryRatingDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.AnniversaryRatingDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AnniversaryRatingDate' and C.FieldName='AnniversaryRatingDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end AnniversaryRatingDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AssignedRiskAdjustmentProgramFactor' and C.FieldName='AssignedRiskAdjustmentProgramFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AssignedRiskAdjustmentProgramFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AssignedRiskAdjustmentProgramFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.AssignedRiskAdjustmentProgramFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AssignedRiskAdjustmentProgramFactor' and C.FieldName='AssignedRiskAdjustmentProgramFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end AssignedRiskAdjustmentProgramFactor,\r\n\treplicate(' ',16) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PremiumAdjustmentPeriodCode' and C.FieldName='PremiumAdjustmentPeriodCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PremiumAdjustmentPeriodCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PremiumAdjustmentPeriodCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.PremiumAdjustmentPeriodCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PremiumAdjustmentPeriodCode' and C.FieldName='PremiumAdjustmentPeriodCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end PremiumAdjustmentPeriodCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TypeOfNonStandardIDCode' and C.FieldName='TypeOfNonStandardIDCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TypeOfNonStandardIDCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TypeOfNonStandardIDCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.TypeOfNonStandardIDCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TypeOfNonStandardIDCode' and C.FieldName='TypeOfNonStandardIDCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end TypeOfNonStandardIDCode,\r\n\treplicate(' ',100) ReservedForFutureUse5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols04Record@{pipeline().parameters.RECORD_04_TABLENAME} A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols04Record'\r\n\tand c.TableName='WCPols04Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols04Record@{pipeline().parameters.RECORD_04_TABLENAMEID}, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(StateAddDeleteCode)+\r\n\tmax(ClaimAdministratorFEIN)+\r\n\tmax(IndependentDCORiskIDNumberFileNumberAccountNumber)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(CarrierCode)+\r\n\tmax(ExperienceModificationFactorMeritRatingFactor)+\r\n\tmax(ExperienceModificationStatusCode)+\r\n\tmax(ExperienceModificationPlanTypeCode)+\r\n\tmax(OtherIndividualRiskRatingFactor)+\r\n\tmax(InsurerPremiumDeviationFactor)+\r\n\tmax(TypeOfPremiumDeviationCode)+\r\n\tmax(EstimatedStateStandardPremiumTotal)+\r\n\tmax(ExpenseConstantAmount)+\r\n\tmax(LossConstantAmount)+\r\n\tmax(PremiumDiscountAmount)+\r\n\tmax(ProRatedExpenseConstantAmountReasonCode)+\r\n\tmax(ProRatedMinimumPremiumAmountReasonCode)+\r\n\tmax(ReasonStateWasAddedToThePolicyCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(ExperienceModificationEffectiveDate)+\r\n\tmax(AnniversaryRatingDate)+\r\n\tmax(AssignedRiskAdjustmentProgramFactor)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(PremiumAdjustmentPeriodCode)+\r\n\tmax(TypeOfNonStandardIDCode)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record04 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record04\n),\nSQ_WCPOLS_Record05 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(ClassificationCode)+\r\n\tmax(ClassificationUseCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(ClassificationWordingSuffix)+\r\n\tmax(ExposureActExposureCoverageCode)+\r\n\tmax(ManualChargedRate)+\r\n\tmax(ExposurePeriodEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EstimatedExposureAmount)+\r\n\tmax(EstimatedPremiumAmount)+\r\n\tmax(ExposurePeriodCode)+\r\n\tmax(ClassificationWording)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForExposureCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(NumberOfPiecesOfApparatus)+\r\n\tmax(NumberOfVolunteers)+\r\n\tmax(PolicySurchargeFactor)+\r\n\tmax(PlanPremiumAdjustmentFactor)+\r\n\tmax(ReservedForFutureUse6)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols05RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationCode' and C.FieldName='ClassificationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationCode,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ClassificationCode,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationCode' and C.FieldName='ClassificationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ClassificationCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationUseCode' and C.FieldName='ClassificationUseCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationUseCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationUseCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ClassificationUseCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationUseCode' and C.FieldName='ClassificationUseCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ClassificationUseCode,\r\n\treplicate(' ',9) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationWordingSuffix' and C.FieldName='ClassificationWordingSuffix' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationWordingSuffix or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationWordingSuffix,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.ClassificationWordingSuffix,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationWordingSuffix' and C.FieldName='ClassificationWordingSuffix' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end ClassificationWordingSuffix,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposureActExposureCoverageCode' and C.FieldName='ExposureActExposureCoverageCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposureActExposureCoverageCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposureActExposureCoverageCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.ExposureActExposureCoverageCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposureActExposureCoverageCode' and C.FieldName='ExposureActExposureCoverageCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end ExposureActExposureCoverageCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ManualChargedRate' and C.FieldName='ManualChargedRate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ManualChargedRate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ManualChargedRate,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.ManualChargedRate,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ManualChargedRate' and C.FieldName='ManualChargedRate' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end ManualChargedRate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposurePeriodEffectiveDate' and C.FieldName='ExposurePeriodEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposurePeriodEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposurePeriodEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.ExposurePeriodEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposurePeriodEffectiveDate' and C.FieldName='ExposurePeriodEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end ExposurePeriodEffectiveDate,\r\n\treplicate(' ',10) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedExposureAmount' and C.FieldName='EstimatedExposureAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedExposureAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedExposureAmount,'')+replicate(' ',12),12) else Right(replicate('0',12)+ISNULL(A.EstimatedExposureAmount,''),12) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedExposureAmount' and C.FieldName='EstimatedExposureAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',12) else replicate('0',12) end\r\n\tend end EstimatedExposureAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedPremiumAmount' and C.FieldName='EstimatedPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedPremiumAmount' and C.FieldName='EstimatedPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedPremiumAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposurePeriodCode' and C.FieldName='ExposurePeriodCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposurePeriodCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposurePeriodCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ExposurePeriodCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposurePeriodCode' and C.FieldName='ExposurePeriodCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ExposurePeriodCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationWording' and C.FieldName='ClassificationWording' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationWording or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationWording,'')+replicate(' ',101),101) else Right(replicate('0',101)+ISNULL(A.ClassificationWording,''),101) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationWording' and C.FieldName='ClassificationWording' then case when C.FieldDataType in ('A','AN') then replicate(' ',101) else replicate('0',101) end\r\n\tend end ClassificationWording,\r\n\treplicate(' ',2) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkIdentifier,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NameLinkIdentifier,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkIdentifier' and C.FieldName='NameLinkIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NameLinkIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCodeLink or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCodeLink,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCodeLink,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCodeLink' and C.FieldName='StateCodeLink' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCodeLink,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExposureRecordLinkForExposureCode' and C.FieldName='ExposureRecordLinkForExposureCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExposureRecordLinkForExposureCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExposureRecordLinkForExposureCode,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.ExposureRecordLinkForExposureCode,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExposureRecordLinkForExposureCode' and C.FieldName='ExposureRecordLinkForExposureCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end ExposureRecordLinkForExposureCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameLinkCounterIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameLinkCounterIdentifier,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.NameLinkCounterIdentifier,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameLinkCounterIdentifier' and C.FieldName='NameLinkCounterIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end NameLinkCounterIdentifier,\r\n\treplicate(' ',28) ReservedForFutureUse5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NumberOfPiecesOfApparatus' and C.FieldName='NumberOfPiecesOfApparatus' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NumberOfPiecesOfApparatus or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NumberOfPiecesOfApparatus,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NumberOfPiecesOfApparatus,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NumberOfPiecesOfApparatus' and C.FieldName='NumberOfPiecesOfApparatus' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NumberOfPiecesOfApparatus,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NumberOfVolunteers' and C.FieldName='NumberOfVolunteers' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NumberOfVolunteers or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NumberOfVolunteers,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.NumberOfVolunteers,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NumberOfVolunteers' and C.FieldName='NumberOfVolunteers' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end NumberOfVolunteers,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicySurchargeFactor' and C.FieldName='PolicySurchargeFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicySurchargeFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicySurchargeFactor,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.PolicySurchargeFactor,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicySurchargeFactor' and C.FieldName='PolicySurchargeFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end PolicySurchargeFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PlanPremiumAdjustmentFactor' and C.FieldName='PlanPremiumAdjustmentFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PlanPremiumAdjustmentFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PlanPremiumAdjustmentFactor,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.PlanPremiumAdjustmentFactor,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PlanPremiumAdjustmentFactor' and C.FieldName='PlanPremiumAdjustmentFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end PlanPremiumAdjustmentFactor,\r\n\treplicate(' ',9) ReservedForFutureUse6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols05Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols05Record'\r\n\tand c.TableName='WCPols05Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols05RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(ClassificationCode)+\r\n\tmax(ClassificationUseCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(ClassificationWordingSuffix)+\r\n\tmax(ExposureActExposureCoverageCode)+\r\n\tmax(ManualChargedRate)+\r\n\tmax(ExposurePeriodEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EstimatedExposureAmount)+\r\n\tmax(EstimatedPremiumAmount)+\r\n\tmax(ExposurePeriodCode)+\r\n\tmax(ClassificationWording)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(NameLinkIdentifier)+\r\n\tmax(StateCodeLink)+\r\n\tmax(ExposureRecordLinkForExposureCode)+\r\n\tmax(NameLinkCounterIdentifier)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(NumberOfPiecesOfApparatus)+\r\n\tmax(NumberOfVolunteers)+\r\n\tmax(PolicySurchargeFactor)+\r\n\tmax(PlanPremiumAdjustmentFactor)+\r\n\tmax(ReservedForFutureUse6)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record05 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record05\n),\nSQ_WCPOLS_Record06 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(InclusionExclusionCode)+\r\n\tmax(StateCode01)+\r\n\tmax(StateCode02)+\r\n\tmax(StateCode03)+\r\n\tmax(StateCode04)+\r\n\tmax(StateCode05)+\r\n\tmax(StateCode06)+\r\n\tmax(StateCode07)+\r\n\tmax(StateCode08)+\r\n\tmax(StateCode09)+\r\n\tmax(StateCode10)+\r\n\tmax(StateCode11)+\r\n\tmax(StateCode12)+\r\n\tmax(StateCode13)+\r\n\tmax(StateCode14)+\r\n\tmax(StateCode15)+\r\n\tmax(StateCode16)+\r\n\tmax(StateCode17)+\r\n\tmax(StateCode18)+\r\n\tmax(StateCode19)+\r\n\tmax(StateCode20)+\r\n\tmax(StateCode21)+\r\n\tmax(StateCode22)+\r\n\tmax(StateCode23)+\r\n\tmax(StateCode24)+\r\n\tmax(StateCode25)+\r\n\tmax(StateCode26)+\r\n\tmax(StateCode27)+\r\n\tmax(StateCode28)+\r\n\tmax(StateCode29)+\r\n\tmax(StateCode30)+\r\n\tmax(StateCode31)+\r\n\tmax(StateCode32)+\r\n\tmax(StateCode33)+\r\n\tmax(StateCode34)+\r\n\tmax(StateCode35)+\r\n\tmax(StateCode36)+\r\n\tmax(StateCode37)+\r\n\tmax(StateCode38)+\r\n\tmax(StateCode39)+\r\n\tmax(StateCode40)+\r\n\tmax(StateCode41)+\r\n\tmax(StateCode42)+\r\n\tmax(StateCode43)+\r\n\tmax(StateCode44)+\r\n\tmax(StateCode45)+\r\n\tmax(StateCode46)+\r\n\tmax(StateCode47)+\r\n\tmax(StateCode48)+\r\n\tmax(StateCode49)+\r\n\tmax(StateCode50)+\r\n\tmax(StateCode51)+\r\n\tmax(StateCode52)+\r\n\tmax(StateCode53)+\r\n\tmax(StateCode54)+\r\n\tmax(StateCode55)+\r\n\tmax(StateCode56)+\r\n\tmax(StateCode57)+\r\n\tmax(StateCode58)+\r\n\tmax(StateCode59)+\r\n\tmax(StateCode60)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols06RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='InclusionExclusionCode' and C.FieldName='InclusionExclusionCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.InclusionExclusionCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.InclusionExclusionCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.InclusionExclusionCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='InclusionExclusionCode' and C.FieldName='InclusionExclusionCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end InclusionExclusionCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode01' and C.FieldName='StateCode01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode01,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode01,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode01' and C.FieldName='StateCode01' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode02' and C.FieldName='StateCode02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode02,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode02,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode02' and C.FieldName='StateCode02' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode03' and C.FieldName='StateCode03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode03,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode03,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode03' and C.FieldName='StateCode03' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode03,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode04' and C.FieldName='StateCode04' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode04 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode04,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode04,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode04' and C.FieldName='StateCode04' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode04,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode05' and C.FieldName='StateCode05' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode05 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode05,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode05,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode05' and C.FieldName='StateCode05' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode05,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode06' and C.FieldName='StateCode06' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode06 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode06,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode06,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode06' and C.FieldName='StateCode06' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode06,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode07' and C.FieldName='StateCode07' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode07 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode07,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode07,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode07' and C.FieldName='StateCode07' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode07,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode08' and C.FieldName='StateCode08' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode08 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode08,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode08,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode08' and C.FieldName='StateCode08' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode08,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode09' and C.FieldName='StateCode09' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode09 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode09,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode09,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode09' and C.FieldName='StateCode09' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode09,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode10,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode10,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode11,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode11,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode12 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode12,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode12,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode12,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode13 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode13,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode13,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode13,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode14 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode14,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode14,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode14,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode15 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode15,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode15,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode15,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode16 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode16,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode16,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode16,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode17 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode17,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode17,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode17,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode18 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode18,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode18,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode18,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode19 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode19,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode19,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode19,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode20 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode20,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode20,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode20,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode21 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode21,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode21,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode21,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode22 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode22,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode22,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode22,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode23 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode23,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode23,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode23,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode24 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode24,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode24,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode24,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode25 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode25,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode25,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode25,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode26' and C.FieldName='StateCode26' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode26 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode26,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode26,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode26' and C.FieldName='StateCode26' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode26,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode27' and C.FieldName='StateCode27' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode27 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode27,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode27,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode27' and C.FieldName='StateCode27' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode27,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode28' and C.FieldName='StateCode28' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode28 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode28,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode28,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode28' and C.FieldName='StateCode28' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode28,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode29' and C.FieldName='StateCode29' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode29 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode29,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode29,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode29' and C.FieldName='StateCode29' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode29,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode30' and C.FieldName='StateCode30' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode30 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode30,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode30,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode30' and C.FieldName='StateCode30' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode30,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode31' and C.FieldName='StateCode31' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode31 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode31,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode31,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode31' and C.FieldName='StateCode31' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode31,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode32' and C.FieldName='StateCode32' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode32 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode32,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode32,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode32' and C.FieldName='StateCode32' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode32,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode33' and C.FieldName='StateCode33' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode33 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode33,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode33,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode33' and C.FieldName='StateCode33' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode33,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode34' and C.FieldName='StateCode34' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode34 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode34,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode34,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode34' and C.FieldName='StateCode34' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode34,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode35' and C.FieldName='StateCode35' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode35 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode35,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode35,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode35' and C.FieldName='StateCode35' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode35,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode36' and C.FieldName='StateCode36' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode36 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode36,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode36,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode36' and C.FieldName='StateCode36' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode36,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode37' and C.FieldName='StateCode37' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode37 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode37,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode37,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode37' and C.FieldName='StateCode37' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode37,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode38' and C.FieldName='StateCode38' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode38 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode38,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode38,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode38' and C.FieldName='StateCode38' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode38,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode39' and C.FieldName='StateCode39' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode39 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode39,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode39,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode39' and C.FieldName='StateCode39' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode39,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode40' and C.FieldName='StateCode40' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode40 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode40,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode40,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode40' and C.FieldName='StateCode40' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode40,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode41' and C.FieldName='StateCode41' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode41 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode41,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode41,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode41' and C.FieldName='StateCode41' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode41,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode42' and C.FieldName='StateCode42' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode42 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode42,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode42,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode42' and C.FieldName='StateCode42' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode42,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode43' and C.FieldName='StateCode43' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode43 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode43,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode43,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode43' and C.FieldName='StateCode43' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode43,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode44' and C.FieldName='StateCode44' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode44 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode44,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode44,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode44' and C.FieldName='StateCode44' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode44,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode45' and C.FieldName='StateCode45' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode45 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode45,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode45,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode45' and C.FieldName='StateCode45' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode45,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode46' and C.FieldName='StateCode46' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode46 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode46,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode46,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode46' and C.FieldName='StateCode46' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode46,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode47' and C.FieldName='StateCode47' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode47 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode47,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode47,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode47' and C.FieldName='StateCode47' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode47,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode48' and C.FieldName='StateCode48' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode48 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode48,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode48,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode48' and C.FieldName='StateCode48' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode48,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode49' and C.FieldName='StateCode49' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode49 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode49,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode49,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode49' and C.FieldName='StateCode49' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode49,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode50' and C.FieldName='StateCode50' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode50 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode50,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode50,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode50' and C.FieldName='StateCode50' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode50,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode51' and C.FieldName='StateCode51' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode51 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode51,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode51,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode51' and C.FieldName='StateCode51' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode51,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode52' and C.FieldName='StateCode52' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode52 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode52,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode52,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode52' and C.FieldName='StateCode52' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode52,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode53' and C.FieldName='StateCode53' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode53 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode53,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode53,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode53' and C.FieldName='StateCode53' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode53,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode54' and C.FieldName='StateCode54' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode54 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode54,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode54,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode54' and C.FieldName='StateCode54' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode54,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode55' and C.FieldName='StateCode55' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode55 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode55,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode55,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode55' and C.FieldName='StateCode55' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode55,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode56' and C.FieldName='StateCode56' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode56 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode56,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode56,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode56' and C.FieldName='StateCode56' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode56,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode57' and C.FieldName='StateCode57' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode57 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode57,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode57,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode57' and C.FieldName='StateCode57' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode57,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode58' and C.FieldName='StateCode58' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode58 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode58,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode58,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode58' and C.FieldName='StateCode58' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode58,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode59' and C.FieldName='StateCode59' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode59 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode59,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode59,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode59' and C.FieldName='StateCode59' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode59,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode60' and C.FieldName='StateCode60' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode60 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode60,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode60,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode60' and C.FieldName='StateCode60' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode60,\r\n\treplicate(' ',120) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols06Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols06Record'\r\n\tand c.TableName='WCPols06Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols06RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(InclusionExclusionCode)+\r\n\tmax(StateCode01)+\r\n\tmax(StateCode02)+\r\n\tmax(StateCode03)+\r\n\tmax(StateCode04)+\r\n\tmax(StateCode05)+\r\n\tmax(StateCode06)+\r\n\tmax(StateCode07)+\r\n\tmax(StateCode08)+\r\n\tmax(StateCode09)+\r\n\tmax(StateCode10)+\r\n\tmax(StateCode11)+\r\n\tmax(StateCode12)+\r\n\tmax(StateCode13)+\r\n\tmax(StateCode14)+\r\n\tmax(StateCode15)+\r\n\tmax(StateCode16)+\r\n\tmax(StateCode17)+\r\n\tmax(StateCode18)+\r\n\tmax(StateCode19)+\r\n\tmax(StateCode20)+\r\n\tmax(StateCode21)+\r\n\tmax(StateCode22)+\r\n\tmax(StateCode23)+\r\n\tmax(StateCode24)+\r\n\tmax(StateCode25)+\r\n\tmax(StateCode26)+\r\n\tmax(StateCode27)+\r\n\tmax(StateCode28)+\r\n\tmax(StateCode29)+\r\n\tmax(StateCode30)+\r\n\tmax(StateCode31)+\r\n\tmax(StateCode32)+\r\n\tmax(StateCode33)+\r\n\tmax(StateCode34)+\r\n\tmax(StateCode35)+\r\n\tmax(StateCode36)+\r\n\tmax(StateCode37)+\r\n\tmax(StateCode38)+\r\n\tmax(StateCode39)+\r\n\tmax(StateCode40)+\r\n\tmax(StateCode41)+\r\n\tmax(StateCode42)+\r\n\tmax(StateCode43)+\r\n\tmax(StateCode44)+\r\n\tmax(StateCode45)+\r\n\tmax(StateCode46)+\r\n\tmax(StateCode47)+\r\n\tmax(StateCode48)+\r\n\tmax(StateCode49)+\r\n\tmax(StateCode50)+\r\n\tmax(StateCode51)+\r\n\tmax(StateCode52)+\r\n\tmax(StateCode53)+\r\n\tmax(StateCode54)+\r\n\tmax(StateCode55)+\r\n\tmax(StateCode56)+\r\n\tmax(StateCode57)+\r\n\tmax(StateCode58)+\r\n\tmax(StateCode59)+\r\n\tmax(StateCode60)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record06 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record06\n),\nSQ_WCPOLS_Record07 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber01)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier01)+\r\n\tmax(CarrierVersionIdentifier01)+\r\n\tmax(EndorsementNumber02)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier02)+\r\n\tmax(CarrierVersionIdentifier02)+\r\n\tmax(EndorsementNumber03)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier03)+\r\n\tmax(CarrierVersionIdentifier03)+\r\n\tmax(EndorsementNumber04)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier04)+\r\n\tmax(CarrierVersionIdentifier04)+\r\n\tmax(EndorsementNumber05)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier05)+\r\n\tmax(CarrierVersionIdentifier05)+\r\n\tmax(EndorsementNumber06)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier06)+\r\n\tmax(CarrierVersionIdentifier06)+\r\n\tmax(EndorsementNumber07)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier07)+\r\n\tmax(CarrierVersionIdentifier07)+\r\n\tmax(EndorsementNumber08)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier08)+\r\n\tmax(CarrierVersionIdentifier08)+\r\n\tmax(EndorsementNumber09)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier09)+\r\n\tmax(CarrierVersionIdentifier09)+\r\n\tmax(EndorsementNumber10)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier10)+\r\n\tmax(CarrierVersionIdentifier10)+\r\n\tmax(EndorsementNumber11)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier11)+\r\n\tmax(CarrierVersionIdentifier11)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate) From (\r\n\tSelect WCPols07RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber01' and C.FieldName='EndorsementNumber01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber01,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber01,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber01' and C.FieldName='EndorsementNumber01' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier01' and C.FieldName='BureauVersionIdentifierEditionIdentifier01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier01,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier01,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier01' and C.FieldName='BureauVersionIdentifierEditionIdentifier01' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier01' and C.FieldName='CarrierVersionIdentifier01' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier01 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier01,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier01,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier01' and C.FieldName='CarrierVersionIdentifier01' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier01,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber02' and C.FieldName='EndorsementNumber02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber02,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber02,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber02' and C.FieldName='EndorsementNumber02' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier02' and C.FieldName='BureauVersionIdentifierEditionIdentifier02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier02,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier02,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier02' and C.FieldName='BureauVersionIdentifierEditionIdentifier02' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier02' and C.FieldName='CarrierVersionIdentifier02' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier02 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier02,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier02,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier02' and C.FieldName='CarrierVersionIdentifier02' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier02,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber03' and C.FieldName='EndorsementNumber03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber03,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber03,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber03' and C.FieldName='EndorsementNumber03' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber03,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier03' and C.FieldName='BureauVersionIdentifierEditionIdentifier03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier03,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier03,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier03' and C.FieldName='BureauVersionIdentifierEditionIdentifier03' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier03,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier03' and C.FieldName='CarrierVersionIdentifier03' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier03 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier03,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier03,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier03' and C.FieldName='CarrierVersionIdentifier03' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier03,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber04' and C.FieldName='EndorsementNumber04' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber04 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber04,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber04,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber04' and C.FieldName='EndorsementNumber04' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber04,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier04' and C.FieldName='BureauVersionIdentifierEditionIdentifier04' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier04 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier04,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier04,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier04' and C.FieldName='BureauVersionIdentifierEditionIdentifier04' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier04,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier04' and C.FieldName='CarrierVersionIdentifier04' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier04 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier04,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier04,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier04' and C.FieldName='CarrierVersionIdentifier04' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier04,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber05' and C.FieldName='EndorsementNumber05' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber05 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber05,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber05,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber05' and C.FieldName='EndorsementNumber05' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber05,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier05' and C.FieldName='BureauVersionIdentifierEditionIdentifier05' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier05 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier05,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier05,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier05' and C.FieldName='BureauVersionIdentifierEditionIdentifier05' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier05,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier05' and C.FieldName='CarrierVersionIdentifier05' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier05 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier05,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier05,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier05' and C.FieldName='CarrierVersionIdentifier05' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier05,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber06' and C.FieldName='EndorsementNumber06' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber06 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber06,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber06,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber06' and C.FieldName='EndorsementNumber06' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber06,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier06' and C.FieldName='BureauVersionIdentifierEditionIdentifier06' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier06 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier06,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier06,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier06' and C.FieldName='BureauVersionIdentifierEditionIdentifier06' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier06,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier06' and C.FieldName='CarrierVersionIdentifier06' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier06 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier06,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier06,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier06' and C.FieldName='CarrierVersionIdentifier06' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier06,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber07' and C.FieldName='EndorsementNumber07' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber07 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber07,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber07,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber07' and C.FieldName='EndorsementNumber07' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber07,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier07' and C.FieldName='BureauVersionIdentifierEditionIdentifier07' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier07 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier07,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier07,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier07' and C.FieldName='BureauVersionIdentifierEditionIdentifier07' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier07,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier07' and C.FieldName='CarrierVersionIdentifier07' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier07 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier07,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier07,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier07' and C.FieldName='CarrierVersionIdentifier07' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier07,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber08' and C.FieldName='EndorsementNumber08' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber08 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber08,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber08,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber08' and C.FieldName='EndorsementNumber08' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber08,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier08' and C.FieldName='BureauVersionIdentifierEditionIdentifier08' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier08 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier08,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier08,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier08' and C.FieldName='BureauVersionIdentifierEditionIdentifier08' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier08,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier08' and C.FieldName='CarrierVersionIdentifier08' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier08 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier08,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier08,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier08' and C.FieldName='CarrierVersionIdentifier08' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier08,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber09' and C.FieldName='EndorsementNumber09' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber09 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber09,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber09,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber09' and C.FieldName='EndorsementNumber09' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber09,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier09' and C.FieldName='BureauVersionIdentifierEditionIdentifier09' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier09 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier09,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier09,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier09' and C.FieldName='BureauVersionIdentifierEditionIdentifier09' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier09,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier09' and C.FieldName='CarrierVersionIdentifier09' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier09 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier09,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier09,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier09' and C.FieldName='CarrierVersionIdentifier09' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier09,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber10' and C.FieldName='EndorsementNumber10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber10,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber10,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber10' and C.FieldName='EndorsementNumber10' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier10' and C.FieldName='BureauVersionIdentifierEditionIdentifier10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier10,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier10,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier10' and C.FieldName='BureauVersionIdentifierEditionIdentifier10' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier10' and C.FieldName='CarrierVersionIdentifier10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier10,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier10,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier10' and C.FieldName='CarrierVersionIdentifier10' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber11' and C.FieldName='EndorsementNumber11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber11,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber11,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber11' and C.FieldName='EndorsementNumber11' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier11' and C.FieldName='BureauVersionIdentifierEditionIdentifier11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier11,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier11,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier11' and C.FieldName='BureauVersionIdentifierEditionIdentifier11' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier11' and C.FieldName='CarrierVersionIdentifier11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier11,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier11,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier11' and C.FieldName='CarrierVersionIdentifier11' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier11,\r\n\treplicate(' ',18) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyChangeEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeEffectiveDate' and C.FieldName='PolicyChangeEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType and (D.WCPOLSCode=A.PolicyChangeExpirationDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyChangeExpirationDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.PolicyChangeExpirationDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyChangeExpirationDate' and C.FieldName='PolicyChangeExpirationDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end PolicyChangeExpirationDate\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols07Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols07Record'\r\n\tand c.TableName='WCPols07Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols07RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber01)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier01)+\r\n\tmax(CarrierVersionIdentifier01)+\r\n\tmax(EndorsementNumber02)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier02)+\r\n\tmax(CarrierVersionIdentifier02)+\r\n\tmax(EndorsementNumber03)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier03)+\r\n\tmax(CarrierVersionIdentifier03)+\r\n\tmax(EndorsementNumber04)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier04)+\r\n\tmax(CarrierVersionIdentifier04)+\r\n\tmax(EndorsementNumber05)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier05)+\r\n\tmax(CarrierVersionIdentifier05)+\r\n\tmax(EndorsementNumber06)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier06)+\r\n\tmax(CarrierVersionIdentifier06)+\r\n\tmax(EndorsementNumber07)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier07)+\r\n\tmax(CarrierVersionIdentifier07)+\r\n\tmax(EndorsementNumber08)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier08)+\r\n\tmax(CarrierVersionIdentifier08)+\r\n\tmax(EndorsementNumber09)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier09)+\r\n\tmax(CarrierVersionIdentifier09)+\r\n\tmax(EndorsementNumber10)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier10)+\r\n\tmax(CarrierVersionIdentifier10)+\r\n\tmax(EndorsementNumber11)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier11)+\r\n\tmax(CarrierVersionIdentifier11)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(PolicyChangeEffectiveDate)+\r\n\tmax(PolicyChangeExpirationDate)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record07 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record07\n),\nSQ_WCPOLS_Record08 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(CancellationReinstatementIDCode)+\r\n\tmax(CancellationTypeCode)+\r\n\tmax(ReasonForCancellationCode)+\r\n\tmax(ReinstatementTypeCode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(AddressOfInsured)+\r\n\tmax(NatureOfInsured)+\r\n\tmax(CancellationMailedtoInsuredDate)+\r\n\tmax(CancellationReinstatementTransactionSequenceNumber)+\r\n\tmax(ReasonForReinstatementCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(CorrespondingCancellationEffectiveDate)+\r\n\tmax(CancellationReinstatementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2),\r\n\tmax(WCTrackHistoryID) WCTrackHistoryID From (\r\n\tSelect WCPols08Record@{pipeline().parameters.RECORD_08_TABLENAMEID}, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CancellationReinstatementIDCode' and C.FieldName='CancellationReinstatementIDCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CancellationReinstatementIDCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CancellationReinstatementIDCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.CancellationReinstatementIDCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CancellationReinstatementIDCode' and C.FieldName='CancellationReinstatementIDCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end CancellationReinstatementIDCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CancellationTypeCode' and C.FieldName='CancellationTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CancellationTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CancellationTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.CancellationTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CancellationTypeCode' and C.FieldName='CancellationTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end CancellationTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ReasonForCancellationCode' and C.FieldName='ReasonForCancellationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ReasonForCancellationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ReasonForCancellationCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.ReasonForCancellationCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ReasonForCancellationCode' and C.FieldName='ReasonForCancellationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end ReasonForCancellationCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ReinstatementTypeCode' and C.FieldName='ReinstatementTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ReinstatementTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ReinstatementTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.ReinstatementTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ReinstatementTypeCode' and C.FieldName='ReinstatementTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end ReinstatementTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',90),90) else Right(replicate('0',90)+ISNULL(A.NameOfInsured,''),90) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',90) else replicate('0',90) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfInsured' and C.FieldName='AddressOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfInsured,'')+replicate(' ',90),90) else Right(replicate('0',90)+ISNULL(A.AddressOfInsured,''),90) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfInsured' and C.FieldName='AddressOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',90) else replicate('0',90) end\r\n\tend end AddressOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NatureOfInsured' and C.FieldName='NatureOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NatureOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NatureOfInsured,'')+replicate(' ',20),20) else Right(replicate('0',20)+ISNULL(A.NatureOfInsured,''),20) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NatureOfInsured' and C.FieldName='NatureOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',20) else replicate('0',20) end\r\n\tend end NatureOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CancellationMailedtoInsuredDate' and C.FieldName='CancellationMailedtoInsuredDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CancellationMailedtoInsuredDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CancellationMailedtoInsuredDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.CancellationMailedtoInsuredDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CancellationMailedtoInsuredDate' and C.FieldName='CancellationMailedtoInsuredDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end CancellationMailedtoInsuredDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CancellationReinstatementTransactionSequenceNumber' and C.FieldName='CancellationReinstatementTransactionSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CancellationReinstatementTransactionSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CancellationReinstatementTransactionSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.CancellationReinstatementTransactionSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CancellationReinstatementTransactionSequenceNumber' and C.FieldName='CancellationReinstatementTransactionSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end CancellationReinstatementTransactionSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ReasonForReinstatementCode' and C.FieldName='ReasonForReinstatementCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ReasonForReinstatementCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ReasonForReinstatementCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.ReasonForReinstatementCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ReasonForReinstatementCode' and C.FieldName='ReasonForReinstatementCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end ReasonForReinstatementCode,\r\n\treplicate(' ',20) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CorrespondingCancellationEffectiveDate' and C.FieldName='CorrespondingCancellationEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CorrespondingCancellationEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CorrespondingCancellationEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.CorrespondingCancellationEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CorrespondingCancellationEffectiveDate' and C.FieldName='CorrespondingCancellationEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end CorrespondingCancellationEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CancellationReinstatementEffectiveDate' and C.FieldName='CancellationReinstatementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CancellationReinstatementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CancellationReinstatementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.CancellationReinstatementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CancellationReinstatementEffectiveDate' and C.FieldName='CancellationReinstatementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end CancellationReinstatementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse2\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols08Record@{pipeline().parameters.RECORD_08_TABLENAME} A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols08Record'\r\n\tand c.TableName='WCPols08Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols08Record@{pipeline().parameters.RECORD_08_TABLENAMEID}, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(CancellationReinstatementIDCode)+\r\n\tmax(CancellationTypeCode)+\r\n\tmax(ReasonForCancellationCode)+\r\n\tmax(ReinstatementTypeCode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(AddressOfInsured)+\r\n\tmax(NatureOfInsured)+\r\n\tmax(CancellationMailedtoInsuredDate)+\r\n\tmax(CancellationReinstatementTransactionSequenceNumber)+\r\n\tmax(ReasonForReinstatementCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(CorrespondingCancellationEffectiveDate)+\r\n\tmax(CancellationReinstatementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record08 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData,\n\tWCTrackHistoryID\n\tFROM SQ_WCPOLS_Record08\n),\nSQ_WCPOLS_Record09 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(AnniversaryRatingDate)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPols09RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AnniversaryRatingDate' and C.FieldName='AnniversaryRatingDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AnniversaryRatingDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AnniversaryRatingDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.AnniversaryRatingDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AnniversaryRatingDate' and C.FieldName='AnniversaryRatingDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end AnniversaryRatingDate,\r\n\treplicate(' ',178) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols09Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols09Record'\r\n\tand c.TableName='WCPols09Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols09RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(AnniversaryRatingDate)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record09 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record09\n),\nSQ_WCPols15Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(RetrospectivePremiumOptionCode)+\r\n\tmax(LossLimitationAmount)+\r\n\tmax(LossConversionFactor)+\r\n\tmax(HazardGroupCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(TaxMultiplierFactorStateOtherthanFClasses)+\r\n\tmax(TaxMultiplierFactorFederalFClassesOnly)+\r\n\tmax(TaxMultiplierFactorWeightedAverageTaxMultiplierFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorFirstFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorSecondFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorThirdFactor)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(MinimumRetrospectivePremiumFactor)+\r\n\tmax(MaximumRetrospectivePremiumFactor)+\r\n\tmax(BasicPremiumFactor50pct)+\r\n\tmax(BasicPremiumFactor100pct)+\r\n\tmax(BasicPremiumFactor150pct)+\r\n\tmax(EstimatedStandardPremiumAmount50pct)+\r\n\tmax(EstimatedStandardPremiumAmount100pct)+\r\n\tmax(EstimatedStandardPremiumAmount150pct)+\r\n\tmax(ExcessLossFactorStateOtherthanFClasses)+\r\n\tmax(ExcessLossFactorFederalFClassesOnly)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(RetrospectiveRatingPlanEffectiveDate)+\r\n\tmax(OtherPolicyNumberIdentifier)+\r\n\tmax(AddendumFormNumber)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse6) From (\r\n\tSelect WCPols15RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectivePremiumOptionCode' and C.FieldName='RetrospectivePremiumOptionCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectivePremiumOptionCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectivePremiumOptionCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.RetrospectivePremiumOptionCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectivePremiumOptionCode' and C.FieldName='RetrospectivePremiumOptionCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end RetrospectivePremiumOptionCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LossLimitationAmount' and C.FieldName='LossLimitationAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LossLimitationAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LossLimitationAmount,'')+replicate(' ',7),7) else Right(replicate('0',7)+ISNULL(A.LossLimitationAmount,''),7) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LossLimitationAmount' and C.FieldName='LossLimitationAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',7) else replicate('0',7) end\r\n\tend end LossLimitationAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LossConversionFactor' and C.FieldName='LossConversionFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LossConversionFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LossConversionFactor,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.LossConversionFactor,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LossConversionFactor' and C.FieldName='LossConversionFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end LossConversionFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='HazardGroupCode' and C.FieldName='HazardGroupCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.HazardGroupCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.HazardGroupCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.HazardGroupCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='HazardGroupCode' and C.FieldName='HazardGroupCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end HazardGroupCode,\r\n\treplicate(' ',24) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TaxMultiplierFactorStateOtherthanFClasses' and C.FieldName='TaxMultiplierFactorStateOtherthanFClasses' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TaxMultiplierFactorStateOtherthanFClasses or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TaxMultiplierFactorStateOtherthanFClasses,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.TaxMultiplierFactorStateOtherthanFClasses,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TaxMultiplierFactorStateOtherthanFClasses' and C.FieldName='TaxMultiplierFactorStateOtherthanFClasses' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end TaxMultiplierFactorStateOtherthanFClasses,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TaxMultiplierFactorFederalFClassesOnly' and C.FieldName='TaxMultiplierFactorFederalFClassesOnly' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TaxMultiplierFactorFederalFClassesOnly or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TaxMultiplierFactorFederalFClassesOnly,'')+replicate(' ',7),7) else Right(replicate('0',7)+ISNULL(A.TaxMultiplierFactorFederalFClassesOnly,''),7) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TaxMultiplierFactorFederalFClassesOnly' and C.FieldName='TaxMultiplierFactorFederalFClassesOnly' then case when C.FieldDataType in ('A','AN') then replicate(' ',7) else replicate('0',7) end\r\n\tend end TaxMultiplierFactorFederalFClassesOnly,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TaxMultiplierFactorWeightedAverageTaxMultiplierFactor' and C.FieldName='TaxMultiplierFactorWeightedAverageTaxMultiplierFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TaxMultiplierFactorWeightedAverageTaxMultiplierFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TaxMultiplierFactorWeightedAverageTaxMultiplierFactor,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.TaxMultiplierFactorWeightedAverageTaxMultiplierFactor,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TaxMultiplierFactorWeightedAverageTaxMultiplierFactor' and C.FieldName='TaxMultiplierFactorWeightedAverageTaxMultiplierFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end TaxMultiplierFactorWeightedAverageTaxMultiplierFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectiveDevelopmentFactorFirstFactor' and C.FieldName='RetrospectiveDevelopmentFactorFirstFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectiveDevelopmentFactorFirstFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectiveDevelopmentFactorFirstFactor,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RetrospectiveDevelopmentFactorFirstFactor,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectiveDevelopmentFactorFirstFactor' and C.FieldName='RetrospectiveDevelopmentFactorFirstFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RetrospectiveDevelopmentFactorFirstFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectiveDevelopmentFactorSecondFactor' and C.FieldName='RetrospectiveDevelopmentFactorSecondFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectiveDevelopmentFactorSecondFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectiveDevelopmentFactorSecondFactor,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RetrospectiveDevelopmentFactorSecondFactor,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectiveDevelopmentFactorSecondFactor' and C.FieldName='RetrospectiveDevelopmentFactorSecondFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RetrospectiveDevelopmentFactorSecondFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectiveDevelopmentFactorThirdFactor' and C.FieldName='RetrospectiveDevelopmentFactorThirdFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectiveDevelopmentFactorThirdFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectiveDevelopmentFactorThirdFactor,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RetrospectiveDevelopmentFactorThirdFactor,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectiveDevelopmentFactorThirdFactor' and C.FieldName='RetrospectiveDevelopmentFactorThirdFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RetrospectiveDevelopmentFactorThirdFactor,\r\n\treplicate(' ',3) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MinimumRetrospectivePremiumFactor' and C.FieldName='MinimumRetrospectivePremiumFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MinimumRetrospectivePremiumFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MinimumRetrospectivePremiumFactor,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.MinimumRetrospectivePremiumFactor,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MinimumRetrospectivePremiumFactor' and C.FieldName='MinimumRetrospectivePremiumFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end MinimumRetrospectivePremiumFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MaximumRetrospectivePremiumFactor' and C.FieldName='MaximumRetrospectivePremiumFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MaximumRetrospectivePremiumFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MaximumRetrospectivePremiumFactor,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.MaximumRetrospectivePremiumFactor,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MaximumRetrospectivePremiumFactor' and C.FieldName='MaximumRetrospectivePremiumFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end MaximumRetrospectivePremiumFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasicPremiumFactor50pct' and C.FieldName='BasicPremiumFactor50pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasicPremiumFactor50pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasicPremiumFactor50pct,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.BasicPremiumFactor50pct,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasicPremiumFactor50pct' and C.FieldName='BasicPremiumFactor50pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end BasicPremiumFactor50pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasicPremiumFactor100pct' and C.FieldName='BasicPremiumFactor100pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasicPremiumFactor100pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasicPremiumFactor100pct,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.BasicPremiumFactor100pct,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasicPremiumFactor100pct' and C.FieldName='BasicPremiumFactor100pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end BasicPremiumFactor100pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasicPremiumFactor150pct' and C.FieldName='BasicPremiumFactor150pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasicPremiumFactor150pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasicPremiumFactor150pct,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.BasicPremiumFactor150pct,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasicPremiumFactor150pct' and C.FieldName='BasicPremiumFactor150pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end BasicPremiumFactor150pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedStandardPremiumAmount50pct' and C.FieldName='EstimatedStandardPremiumAmount50pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedStandardPremiumAmount50pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedStandardPremiumAmount50pct,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedStandardPremiumAmount50pct,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedStandardPremiumAmount50pct' and C.FieldName='EstimatedStandardPremiumAmount50pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedStandardPremiumAmount50pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedStandardPremiumAmount100pct' and C.FieldName='EstimatedStandardPremiumAmount100pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedStandardPremiumAmount100pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedStandardPremiumAmount100pct,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedStandardPremiumAmount100pct,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedStandardPremiumAmount100pct' and C.FieldName='EstimatedStandardPremiumAmount100pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedStandardPremiumAmount100pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedStandardPremiumAmount150pct' and C.FieldName='EstimatedStandardPremiumAmount150pct' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedStandardPremiumAmount150pct or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedStandardPremiumAmount150pct,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedStandardPremiumAmount150pct,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedStandardPremiumAmount150pct' and C.FieldName='EstimatedStandardPremiumAmount150pct' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedStandardPremiumAmount150pct,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExcessLossFactorStateOtherthanFClasses' and C.FieldName='ExcessLossFactorStateOtherthanFClasses' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExcessLossFactorStateOtherthanFClasses or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExcessLossFactorStateOtherthanFClasses,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ExcessLossFactorStateOtherthanFClasses,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExcessLossFactorStateOtherthanFClasses' and C.FieldName='ExcessLossFactorStateOtherthanFClasses' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ExcessLossFactorStateOtherthanFClasses,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ExcessLossFactorFederalFClassesOnly' and C.FieldName='ExcessLossFactorFederalFClassesOnly' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ExcessLossFactorFederalFClassesOnly or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ExcessLossFactorFederalFClassesOnly,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ExcessLossFactorFederalFClassesOnly,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ExcessLossFactorFederalFClassesOnly' and C.FieldName='ExcessLossFactorFederalFClassesOnly' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ExcessLossFactorFederalFClassesOnly,\r\n\treplicate(' ',3) ReservedForFutureUse4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RetrospectiveRatingPlanEffectiveDate' and C.FieldName='RetrospectiveRatingPlanEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RetrospectiveRatingPlanEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RetrospectiveRatingPlanEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.RetrospectiveRatingPlanEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RetrospectiveRatingPlanEffectiveDate' and C.FieldName='RetrospectiveRatingPlanEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end RetrospectiveRatingPlanEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='OtherPolicyNumberIdentifier' and C.FieldName='OtherPolicyNumberIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.OtherPolicyNumberIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.OtherPolicyNumberIdentifier,'')+replicate(' ',18),18) else Right(replicate('0',18)+ISNULL(A.OtherPolicyNumberIdentifier,''),18) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='OtherPolicyNumberIdentifier' and C.FieldName='OtherPolicyNumberIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',18) else replicate('0',18) end\r\n\tend end OtherPolicyNumberIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddendumFormNumber' and C.FieldName='AddendumFormNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddendumFormNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddendumFormNumber,'')+replicate(' ',12),12) else Right(replicate('0',12)+ISNULL(A.AddendumFormNumber,''),12) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddendumFormNumber' and C.FieldName='AddendumFormNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',12) else replicate('0',12) end\r\n\tend end AddendumFormNumber,\r\n\treplicate(' ',2) ReservedForFutureUse5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse6\r\n\t\r\n\tfrom WCPols15Record A\r\n\tinner join WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols15Record'\r\n\tand c.TableName='WCPols15Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols15RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(RetrospectivePremiumOptionCode)+\r\n\tmax(LossLimitationAmount)+\r\n\tmax(LossConversionFactor)+\r\n\tmax(HazardGroupCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(TaxMultiplierFactorStateOtherthanFClasses)+\r\n\tmax(TaxMultiplierFactorFederalFClassesOnly)+\r\n\tmax(TaxMultiplierFactorWeightedAverageTaxMultiplierFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorFirstFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorSecondFactor)+\r\n\tmax(RetrospectiveDevelopmentFactorThirdFactor)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(MinimumRetrospectivePremiumFactor)+\r\n\tmax(MaximumRetrospectivePremiumFactor)+\r\n\tmax(BasicPremiumFactor50pct)+\r\n\tmax(BasicPremiumFactor100pct)+\r\n\tmax(BasicPremiumFactor150pct)+\r\n\tmax(EstimatedStandardPremiumAmount50pct)+\r\n\tmax(EstimatedStandardPremiumAmount100pct)+\r\n\tmax(EstimatedStandardPremiumAmount150pct)+\r\n\tmax(ExcessLossFactorStateOtherthanFClasses)+\r\n\tmax(ExcessLossFactorFederalFClassesOnly)+\r\n\tmax(ReservedForFutureUse4)+\r\n\tmax(RetrospectiveRatingPlanEffectiveDate)+\r\n\tmax(OtherPolicyNumberIdentifier)+\r\n\tmax(AddendumFormNumber)+\r\n\tmax(ReservedForFutureUse5)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse6)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record15 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols15Record\n),\nSQ_WCPols18Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount)+\r\n\tmax(ScheduleStateCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols18RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount' and C.FieldName='EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount' and C.FieldName='EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ScheduleStateCode' and C.FieldName='ScheduleStateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ScheduleStateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ScheduleStateCode,'')+replicate(' ',100),100) else Right(replicate('0',100)+ISNULL(A.ScheduleStateCode,''),100) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ScheduleStateCode' and C.FieldName='ScheduleStateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',100) else replicate('0',100) end\r\n\tend end ScheduleStateCode,\r\n\treplicate(' ',64) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols18Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols18Record'\r\n\tand c.TableName='WCPols18Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols18RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(EmployerLiabilityLimitAmountFederalBodilyInjuryByAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountFederalBodilyInjuryByDiseaseAmount)+\r\n\tmax(ScheduleStateCode)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record18 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols18Record\n),\nSQ_WCPols19Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor)+\r\n\tmax(StateCode2)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2)+\r\n\tmax(StateCode3)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3)+\r\n\tmax(StateCode4)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4)+\r\n\tmax(StateCode5)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5)+\r\n\tmax(StateCode6)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6)+\r\n\tmax(StateCode7)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7)+\r\n\tmax(StateCode8)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8)+\r\n\tmax(StateCode9)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9)+\r\n\tmax(StateCode10)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10)+\r\n\tmax(StateCode11)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11)+\r\n\tmax(StateCode12)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12)+\r\n\tmax(StateCode13)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13)+\r\n\tmax(StateCode14)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14)+\r\n\tmax(StateCode15)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15)+\r\n\tmax(StateCode16)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16)+\r\n\tmax(StateCode17)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17)+\r\n\tmax(StateCode18)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18)+\r\n\tmax(StateCode19)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19)+\r\n\tmax(StateCode20)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20)+\r\n\tmax(StateCode21)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21)+\r\n\tmax(StateCode22)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22)+\r\n\tmax(StateCode23)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23)+\r\n\tmax(StateCode24)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24)+\r\n\tmax(StateCode25)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols19RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode2,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode2,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode3,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode3,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode4,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode4,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode5,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode5,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode6,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode6,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode7' and C.FieldName='StateCode7' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode7 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode7,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode7,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode7' and C.FieldName='StateCode7' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode7,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode8' and C.FieldName='StateCode8' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode8 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode8,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode8,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode8' and C.FieldName='StateCode8' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode8,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode9' and C.FieldName='StateCode9' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode9 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode9,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode9,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode9' and C.FieldName='StateCode9' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode9,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode10,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode10,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode11,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode11,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode12 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode12,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode12,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode12,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode13 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode13,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode13,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode13,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode14 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode14,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode14,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode14,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode15 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode15,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode15,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode15,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode16 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode16,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode16,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode16,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode17 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode17,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode17,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode17,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode18 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode18,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode18,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode18,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode19 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode19,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode19,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode19,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode20 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode20,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode20,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode20,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode21 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode21,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode21,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode21,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode22 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode22,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode22,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode22,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode23 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode23,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode23,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode23,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode24 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode24,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode24,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode24,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode25 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode25,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode25,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode25,\r\n\tcase \r\n\twhen B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25' and C.FieldName='UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25,\r\n\treplicate(' ',34) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols19Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols19Record'\r\n\tand c.TableName='WCPols19Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols19RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor)+\r\n\tmax(StateCode2)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor2)+\r\n\tmax(StateCode3)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor3)+\r\n\tmax(StateCode4)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor4)+\r\n\tmax(StateCode5)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor5)+\r\n\tmax(StateCode6)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor6)+\r\n\tmax(StateCode7)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor7)+\r\n\tmax(StateCode8)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor8)+\r\n\tmax(StateCode9)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor9)+\r\n\tmax(StateCode10)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor10)+\r\n\tmax(StateCode11)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor11)+\r\n\tmax(StateCode12)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor12)+\r\n\tmax(StateCode13)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor13)+\r\n\tmax(StateCode14)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor14)+\r\n\tmax(StateCode15)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor15)+\r\n\tmax(StateCode16)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor16)+\r\n\tmax(StateCode17)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor17)+\r\n\tmax(StateCode18)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor18)+\r\n\tmax(StateCode19)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor19)+\r\n\tmax(StateCode20)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor20)+\r\n\tmax(StateCode21)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor21)+\r\n\tmax(StateCode22)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor22)+\r\n\tmax(StateCode23)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor23)+\r\n\tmax(StateCode24)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor24)+\r\n\tmax(StateCode25)+\r\n\tmax(UnitedStatesLongshoreAndHarborWorkersCoveragePercentageFactor25)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record19 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols19Record\n),\nSQ_WCPOLS_Record21 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount)+\r\n\tmax(TransportationWagesMaintenanceAndCurePremiumAmount)+\r\n\tmax(WorkDescription)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols21RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount' and C.FieldName='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount' and C.FieldName='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount' and C.FieldName='EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TransportationWagesMaintenanceAndCurePremiumAmount' and C.FieldName='TransportationWagesMaintenanceAndCurePremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TransportationWagesMaintenanceAndCurePremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TransportationWagesMaintenanceAndCurePremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.TransportationWagesMaintenanceAndCurePremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TransportationWagesMaintenanceAndCurePremiumAmount' and C.FieldName='TransportationWagesMaintenanceAndCurePremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end TransportationWagesMaintenanceAndCurePremiumAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='WorkDescription' and C.FieldName='WorkDescription' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.WorkDescription or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.WorkDescription,'')+replicate(' ',120),120) else Right(replicate('0',120)+ISNULL(A.WorkDescription,''),120) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='WorkDescription' and C.FieldName='WorkDescription' then case when C.FieldDataType in ('A','AN') then replicate(' ',120) else replicate('0',120) end\r\n\tend end WorkDescription,\r\n\treplicate(' ',32) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.EndorsementSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end EndorsementSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols21Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols21Record'\r\n\tand c.TableName='WCPols21Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols21RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(EmployerLiabilityLimitAmountMaritimeBodilyInjuryByAccidentAmount)+\r\n\tmax(EmployerLiabilityLimitAmountMaritimeBodilyInjuryByDiseaseAmount)+\r\n\tmax(TransportationWagesMaintenanceAndCurePremiumAmount)+\r\n\tmax(WorkDescription)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record21 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record21\n),\nSQ_WCPols23Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfVessel)+\r\n\tmax(WorkersCompensationLaw)+\r\n\tmax(DescriptionOfWork)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols23RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfVessel' and C.FieldName='NameOfVessel' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfVessel or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfVessel,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfVessel,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfVessel' and C.FieldName='NameOfVessel' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfVessel,\r\n\tcase \r\n\twhen B.COLUMN_NAME='WorkersCompensationLaw' and C.FieldName='WorkersCompensationLaw' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.WorkersCompensationLaw or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.WorkersCompensationLaw,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.WorkersCompensationLaw,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='WorkersCompensationLaw' and C.FieldName='WorkersCompensationLaw' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end WorkersCompensationLaw,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptionOfWork' and C.FieldName='DescriptionOfWork' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptionOfWork or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptionOfWork,'')+replicate(' ',40),40) else Right(replicate('0',40)+ISNULL(A.DescriptionOfWork,''),40) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptionOfWork' and C.FieldName='DescriptionOfWork' then case when C.FieldDataType in ('A','AN') then replicate(' ',40) else replicate('0',40) end\r\n\tend end DescriptionOfWork,\r\n\treplicate(' ',72) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.EndorsementSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end EndorsementSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols23Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols23Record'\r\n\tand c.TableName='WCPols23Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols23RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfVessel)+\r\n\tmax(WorkersCompensationLaw)+\r\n\tmax(DescriptionOfWork)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record23 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols23Record\n),\nSQ_WCPols24Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfAlternateEmployer)+\r\n\tmax(AddressOfAlternateEmployer)+\r\n\tmax(StateOfSpecialTemporaryEmployment)+\r\n\tmax(NameOfContractOrProject)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols24RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfAlternateEmployer' and C.FieldName='NameOfAlternateEmployer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfAlternateEmployer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfAlternateEmployer,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfAlternateEmployer,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfAlternateEmployer' and C.FieldName='NameOfAlternateEmployer' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfAlternateEmployer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfAlternateEmployer' and C.FieldName='AddressOfAlternateEmployer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfAlternateEmployer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfAlternateEmployer,'')+replicate(' ',52),52) else Right(replicate('0',52)+ISNULL(A.AddressOfAlternateEmployer,''),52) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfAlternateEmployer' and C.FieldName='AddressOfAlternateEmployer' then case when C.FieldDataType in ('A','AN') then replicate(' ',52) else replicate('0',52) end\r\n\tend end AddressOfAlternateEmployer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateOfSpecialTemporaryEmployment' and C.FieldName='StateOfSpecialTemporaryEmployment' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateOfSpecialTemporaryEmployment or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateOfSpecialTemporaryEmployment,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateOfSpecialTemporaryEmployment,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateOfSpecialTemporaryEmployment' and C.FieldName='StateOfSpecialTemporaryEmployment' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateOfSpecialTemporaryEmployment,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfContractOrProject' and C.FieldName='NameOfContractOrProject' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfContractOrProject or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfContractOrProject,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.NameOfContractOrProject,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfContractOrProject' and C.FieldName='NameOfContractOrProject' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end NameOfContractOrProject,\r\n\treplicate(' ',18) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.EndorsementSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end EndorsementSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols24Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols24Record'\r\n\tand c.TableName='WCPols24Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols24RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfAlternateEmployer)+\r\n\tmax(AddressOfAlternateEmployer)+\r\n\tmax(StateOfSpecialTemporaryEmployment)+\r\n\tmax(NameOfContractOrProject)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record24 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols24Record\n),\nSQ_WCPols25Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(AddressNotCovered)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols25RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressNotCovered' and C.FieldName='AddressNotCovered' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressNotCovered or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressNotCovered,'')+replicate(' ',120),120) else Right(replicate('0',120)+ISNULL(A.AddressNotCovered,''),120) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressNotCovered' and C.FieldName='AddressNotCovered' then case when C.FieldDataType in ('A','AN') then replicate(' ',120) else replicate('0',120) end\r\n\tend end AddressNotCovered,\r\n\treplicate(' ',62) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.EndorsementSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end EndorsementSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols25Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols25Record'\r\n\tand c.TableName='WCPols25Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols25RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(AddressNotCovered)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record25 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols25Record\n),\nSQ_WCPols29Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(IdentifyEmployees)+\r\n\tmax(StateOfEmployment)+\r\n\tmax(DesignatedWorkersCompensationLawOrDescription)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols29RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='IdentifyEmployees' and C.FieldName='IdentifyEmployees' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.IdentifyEmployees or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.IdentifyEmployees,'')+replicate(' ',100),100) else Right(replicate('0',100)+ISNULL(A.IdentifyEmployees,''),100) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='IdentifyEmployees' and C.FieldName='IdentifyEmployees' then case when C.FieldDataType in ('A','AN') then replicate(' ',100) else replicate('0',100) end\r\n\tend end IdentifyEmployees,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateOfEmployment' and C.FieldName='StateOfEmployment' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateOfEmployment or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateOfEmployment,'')+replicate(' ',40),40) else Right(replicate('0',40)+ISNULL(A.StateOfEmployment,''),40) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateOfEmployment' and C.FieldName='StateOfEmployment' then case when C.FieldDataType in ('A','AN') then replicate(' ',40) else replicate('0',40) end\r\n\tend end StateOfEmployment,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DesignatedWorkersCompensationLawOrDescription' and C.FieldName='DesignatedWorkersCompensationLawOrDescription' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DesignatedWorkersCompensationLawOrDescription or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DesignatedWorkersCompensationLawOrDescription,'')+replicate(' ',40),40) else Right(replicate('0',40)+ISNULL(A.DesignatedWorkersCompensationLawOrDescription,''),40) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DesignatedWorkersCompensationLawOrDescription' and C.FieldName='DesignatedWorkersCompensationLawOrDescription' then case when C.FieldDataType in ('A','AN') then replicate(' ',40) else replicate('0',40) end\r\n\tend end DesignatedWorkersCompensationLawOrDescription,\r\n\treplicate(' ',2) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementSequenceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementSequenceNumber,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.EndorsementSequenceNumber,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementSequenceNumber' and C.FieldName='EndorsementSequenceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end EndorsementSequenceNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols29Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols29Record'\r\n\tand c.TableName='WCPols29Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols29RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(IdentifyEmployees)+\r\n\tmax(StateOfEmployment)+\r\n\tmax(DesignatedWorkersCompensationLawOrDescription)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(EndorsementSequenceNumber)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record29 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols29Record\n),\nSQ_WCPols30Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(FirstPremiumDiscountLayer)+\r\n\tmax(FirstPremiumDiscountPercentage)+\r\n\tmax(SecondNextPremiumDiscountLayer)+\r\n\tmax(SecondNextPremiumDiscountPercentage)+\r\n\tmax(ThirdNextPremiumDiscountLayer)+\r\n\tmax(ThirdNextPremiumDiscountPercentage)+\r\n\tmax(BalancePremiumDiscountLayer)+\r\n\tmax(BalancePremiumDiscountPercentage)+\r\n\tmax(AveragePercentageDiscount)+\r\n\tmax(StateCode2)+\r\n\tmax(FirstPremiumDiscountLayer2)+\r\n\tmax(FirstPremiumDiscountPercentage2)+\r\n\tmax(SecondNextPremiumDiscountLayer2)+\r\n\tmax(SecondNextPremiumDiscountPercentage2)+\r\n\tmax(ThirdNextPremiumDiscountLayer2)+\r\n\tmax(ThirdNextPremiumDiscountPercentage2)+\r\n\tmax(BalancePremiumDiscountLayer2)+\r\n\tmax(BalancePremiumDiscountPercentage2)+\r\n\tmax(StateCode3)+\r\n\tmax(FirstPremiumDiscountLayer3)+\r\n\tmax(FirstPremiumDiscountPercentage3)+\r\n\tmax(SecondNextPremiumDiscountLayer3)+\r\n\tmax(SecondNextPremiumDiscountPercentage3)+\r\n\tmax(ThirdNextPremiumDiscountLayer3)+\r\n\tmax(ThirdNextPremiumDiscountPercentage3)+\r\n\tmax(BalancePremiumDiscountLayer3)+\r\n\tmax(BalancePremiumDiscountPercentage3)+\r\n\tmax(StateCode4)+\r\n\tmax(FirstPremiumDiscountLayer4)+\r\n\tmax(FirstPremiumDiscountPercentage4)+\r\n\tmax(SecondNextPremiumDiscountLayer4)+\r\n\tmax(SecondNextPremiumDiscountPercentage4)+\r\n\tmax(ThirdNextPremiumDiscountLayer4)+\r\n\tmax(ThirdNextPremiumDiscountPercentage4)+\r\n\tmax(BalancePremiumDiscountLayer4)+\r\n\tmax(BalancePremiumDiscountPercentage4)+\r\n\tmax(StateCode5)+\r\n\tmax(FirstPremiumDiscountLayer5)+\r\n\tmax(FirstPremiumDiscountPercentage5)+\r\n\tmax(SecondNextPremiumDiscountLayer5)+\r\n\tmax(SecondNextPremiumDiscountPercentage5)+\r\n\tmax(ThirdNextPremiumDiscountLayer5)+\r\n\tmax(ThirdNextPremiumDiscountPercentage5)+\r\n\tmax(BalancePremiumDiscountLayer5)+\r\n\tmax(BalancePremiumDiscountPercentage5)+\r\n\tmax(StateCode6)+\r\n\tmax(FirstPremiumDiscountLayer6)+\r\n\tmax(FirstPremiumDiscountPercentage6)+\r\n\tmax(SecondNextPremiumDiscountLayer6)+\r\n\tmax(SecondNextPremiumDiscountPercentage6)+\r\n\tmax(ThirdNextPremiumDiscountLayer6)+\r\n\tmax(ThirdNextPremiumDiscountPercentage6)+\r\n\tmax(BalancePremiumDiscountLayer6)+\r\n\tmax(BalancePremiumDiscountPercentage6)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols30RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer' and C.FieldName='FirstPremiumDiscountLayer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer' and C.FieldName='FirstPremiumDiscountLayer' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage' and C.FieldName='FirstPremiumDiscountPercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage' and C.FieldName='FirstPremiumDiscountPercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer' and C.FieldName='SecondNextPremiumDiscountLayer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer' and C.FieldName='SecondNextPremiumDiscountLayer' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage' and C.FieldName='SecondNextPremiumDiscountPercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage' and C.FieldName='SecondNextPremiumDiscountPercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer' and C.FieldName='ThirdNextPremiumDiscountLayer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer' and C.FieldName='ThirdNextPremiumDiscountLayer' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage' and C.FieldName='ThirdNextPremiumDiscountPercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage' and C.FieldName='ThirdNextPremiumDiscountPercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer' and C.FieldName='BalancePremiumDiscountLayer' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer' and C.FieldName='BalancePremiumDiscountLayer' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage' and C.FieldName='BalancePremiumDiscountPercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage' and C.FieldName='BalancePremiumDiscountPercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AveragePercentageDiscount' and C.FieldName='AveragePercentageDiscount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AveragePercentageDiscount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AveragePercentageDiscount,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.AveragePercentageDiscount,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AveragePercentageDiscount' and C.FieldName='AveragePercentageDiscount' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end AveragePercentageDiscount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode2,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode2,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer2' and C.FieldName='FirstPremiumDiscountLayer2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer2' and C.FieldName='FirstPremiumDiscountLayer2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage2' and C.FieldName='FirstPremiumDiscountPercentage2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage2,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage2,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage2' and C.FieldName='FirstPremiumDiscountPercentage2' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer2' and C.FieldName='SecondNextPremiumDiscountLayer2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer2' and C.FieldName='SecondNextPremiumDiscountLayer2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage2' and C.FieldName='SecondNextPremiumDiscountPercentage2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage2,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage2,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage2' and C.FieldName='SecondNextPremiumDiscountPercentage2' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer2' and C.FieldName='ThirdNextPremiumDiscountLayer2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer2' and C.FieldName='ThirdNextPremiumDiscountLayer2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage2' and C.FieldName='ThirdNextPremiumDiscountPercentage2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage2,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage2,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage2' and C.FieldName='ThirdNextPremiumDiscountPercentage2' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer2' and C.FieldName='BalancePremiumDiscountLayer2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer2' and C.FieldName='BalancePremiumDiscountLayer2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage2' and C.FieldName='BalancePremiumDiscountPercentage2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage2,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage2,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage2' and C.FieldName='BalancePremiumDiscountPercentage2' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode3,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode3,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer3' and C.FieldName='FirstPremiumDiscountLayer3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer3' and C.FieldName='FirstPremiumDiscountLayer3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage3' and C.FieldName='FirstPremiumDiscountPercentage3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage3,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage3,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage3' and C.FieldName='FirstPremiumDiscountPercentage3' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer3' and C.FieldName='SecondNextPremiumDiscountLayer3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer3' and C.FieldName='SecondNextPremiumDiscountLayer3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage3' and C.FieldName='SecondNextPremiumDiscountPercentage3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage3,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage3,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage3' and C.FieldName='SecondNextPremiumDiscountPercentage3' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer3' and C.FieldName='ThirdNextPremiumDiscountLayer3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer3' and C.FieldName='ThirdNextPremiumDiscountLayer3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage3' and C.FieldName='ThirdNextPremiumDiscountPercentage3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage3,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage3,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage3' and C.FieldName='ThirdNextPremiumDiscountPercentage3' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer3' and C.FieldName='BalancePremiumDiscountLayer3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer3' and C.FieldName='BalancePremiumDiscountLayer3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage3' and C.FieldName='BalancePremiumDiscountPercentage3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage3,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage3,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage3' and C.FieldName='BalancePremiumDiscountPercentage3' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode4,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode4,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer4' and C.FieldName='FirstPremiumDiscountLayer4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer4,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer4,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer4' and C.FieldName='FirstPremiumDiscountLayer4' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage4' and C.FieldName='FirstPremiumDiscountPercentage4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage4,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage4,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage4' and C.FieldName='FirstPremiumDiscountPercentage4' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer4' and C.FieldName='SecondNextPremiumDiscountLayer4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer4,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer4,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer4' and C.FieldName='SecondNextPremiumDiscountLayer4' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage4' and C.FieldName='SecondNextPremiumDiscountPercentage4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage4,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage4,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage4' and C.FieldName='SecondNextPremiumDiscountPercentage4' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer4' and C.FieldName='ThirdNextPremiumDiscountLayer4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer4,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer4,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer4' and C.FieldName='ThirdNextPremiumDiscountLayer4' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage4' and C.FieldName='ThirdNextPremiumDiscountPercentage4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage4,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage4,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage4' and C.FieldName='ThirdNextPremiumDiscountPercentage4' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer4' and C.FieldName='BalancePremiumDiscountLayer4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer4,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer4,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer4' and C.FieldName='BalancePremiumDiscountLayer4' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage4' and C.FieldName='BalancePremiumDiscountPercentage4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage4,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage4,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage4' and C.FieldName='BalancePremiumDiscountPercentage4' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode5,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode5,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer5' and C.FieldName='FirstPremiumDiscountLayer5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer5,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer5,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer5' and C.FieldName='FirstPremiumDiscountLayer5' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage5' and C.FieldName='FirstPremiumDiscountPercentage5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage5,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage5,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage5' and C.FieldName='FirstPremiumDiscountPercentage5' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer5' and C.FieldName='SecondNextPremiumDiscountLayer5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer5,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer5,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer5' and C.FieldName='SecondNextPremiumDiscountLayer5' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage5' and C.FieldName='SecondNextPremiumDiscountPercentage5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage5,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage5,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage5' and C.FieldName='SecondNextPremiumDiscountPercentage5' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer5' and C.FieldName='ThirdNextPremiumDiscountLayer5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer5,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer5,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer5' and C.FieldName='ThirdNextPremiumDiscountLayer5' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage5' and C.FieldName='ThirdNextPremiumDiscountPercentage5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage5,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage5,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage5' and C.FieldName='ThirdNextPremiumDiscountPercentage5' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer5' and C.FieldName='BalancePremiumDiscountLayer5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer5,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer5,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer5' and C.FieldName='BalancePremiumDiscountLayer5' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage5' and C.FieldName='BalancePremiumDiscountPercentage5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage5,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage5,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage5' and C.FieldName='BalancePremiumDiscountPercentage5' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode6,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode6,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountLayer6' and C.FieldName='FirstPremiumDiscountLayer6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountLayer6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountLayer6,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.FirstPremiumDiscountLayer6,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountLayer6' and C.FieldName='FirstPremiumDiscountLayer6' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end FirstPremiumDiscountLayer6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FirstPremiumDiscountPercentage6' and C.FieldName='FirstPremiumDiscountPercentage6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FirstPremiumDiscountPercentage6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FirstPremiumDiscountPercentage6,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.FirstPremiumDiscountPercentage6,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FirstPremiumDiscountPercentage6' and C.FieldName='FirstPremiumDiscountPercentage6' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end FirstPremiumDiscountPercentage6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountLayer6' and C.FieldName='SecondNextPremiumDiscountLayer6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountLayer6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountLayer6,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.SecondNextPremiumDiscountLayer6,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountLayer6' and C.FieldName='SecondNextPremiumDiscountLayer6' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end SecondNextPremiumDiscountLayer6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='SecondNextPremiumDiscountPercentage6' and C.FieldName='SecondNextPremiumDiscountPercentage6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.SecondNextPremiumDiscountPercentage6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.SecondNextPremiumDiscountPercentage6,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.SecondNextPremiumDiscountPercentage6,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='SecondNextPremiumDiscountPercentage6' and C.FieldName='SecondNextPremiumDiscountPercentage6' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end SecondNextPremiumDiscountPercentage6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountLayer6' and C.FieldName='ThirdNextPremiumDiscountLayer6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountLayer6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountLayer6,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ThirdNextPremiumDiscountLayer6,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountLayer6' and C.FieldName='ThirdNextPremiumDiscountLayer6' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ThirdNextPremiumDiscountLayer6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage6' and C.FieldName='ThirdNextPremiumDiscountPercentage6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ThirdNextPremiumDiscountPercentage6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ThirdNextPremiumDiscountPercentage6,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.ThirdNextPremiumDiscountPercentage6,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ThirdNextPremiumDiscountPercentage6' and C.FieldName='ThirdNextPremiumDiscountPercentage6' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end ThirdNextPremiumDiscountPercentage6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountLayer6' and C.FieldName='BalancePremiumDiscountLayer6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountLayer6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountLayer6,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.BalancePremiumDiscountLayer6,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountLayer6' and C.FieldName='BalancePremiumDiscountLayer6' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end BalancePremiumDiscountLayer6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BalancePremiumDiscountPercentage6' and C.FieldName='BalancePremiumDiscountPercentage6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BalancePremiumDiscountPercentage6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BalancePremiumDiscountPercentage6,'')+replicate(' ',3),3) else Right(replicate('0',3)+ISNULL(A.BalancePremiumDiscountPercentage6,''),3) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BalancePremiumDiscountPercentage6' and C.FieldName='BalancePremiumDiscountPercentage6' then case when C.FieldDataType in ('A','AN') then replicate(' ',3) else replicate('0',3) end\r\n\tend end BalancePremiumDiscountPercentage6,\r\n\treplicate(' ',1) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols30Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols30Record'\r\n\tand c.TableName='WCPols30Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols30RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(FirstPremiumDiscountLayer)+\r\n\tmax(FirstPremiumDiscountPercentage)+\r\n\tmax(SecondNextPremiumDiscountLayer)+\r\n\tmax(SecondNextPremiumDiscountPercentage)+\r\n\tmax(ThirdNextPremiumDiscountLayer)+\r\n\tmax(ThirdNextPremiumDiscountPercentage)+\r\n\tmax(BalancePremiumDiscountLayer)+\r\n\tmax(BalancePremiumDiscountPercentage)+\r\n\tmax(AveragePercentageDiscount)+\r\n\tmax(StateCode2)+\r\n\tmax(FirstPremiumDiscountLayer2)+\r\n\tmax(FirstPremiumDiscountPercentage2)+\r\n\tmax(SecondNextPremiumDiscountLayer2)+\r\n\tmax(SecondNextPremiumDiscountPercentage2)+\r\n\tmax(ThirdNextPremiumDiscountLayer2)+\r\n\tmax(ThirdNextPremiumDiscountPercentage2)+\r\n\tmax(BalancePremiumDiscountLayer2)+\r\n\tmax(BalancePremiumDiscountPercentage2)+\r\n\tmax(StateCode3)+\r\n\tmax(FirstPremiumDiscountLayer3)+\r\n\tmax(FirstPremiumDiscountPercentage3)+\r\n\tmax(SecondNextPremiumDiscountLayer3)+\r\n\tmax(SecondNextPremiumDiscountPercentage3)+\r\n\tmax(ThirdNextPremiumDiscountLayer3)+\r\n\tmax(ThirdNextPremiumDiscountPercentage3)+\r\n\tmax(BalancePremiumDiscountLayer3)+\r\n\tmax(BalancePremiumDiscountPercentage3)+\r\n\tmax(StateCode4)+\r\n\tmax(FirstPremiumDiscountLayer4)+\r\n\tmax(FirstPremiumDiscountPercentage4)+\r\n\tmax(SecondNextPremiumDiscountLayer4)+\r\n\tmax(SecondNextPremiumDiscountPercentage4)+\r\n\tmax(ThirdNextPremiumDiscountLayer4)+\r\n\tmax(ThirdNextPremiumDiscountPercentage4)+\r\n\tmax(BalancePremiumDiscountLayer4)+\r\n\tmax(BalancePremiumDiscountPercentage4)+\r\n\tmax(StateCode5)+\r\n\tmax(FirstPremiumDiscountLayer5)+\r\n\tmax(FirstPremiumDiscountPercentage5)+\r\n\tmax(SecondNextPremiumDiscountLayer5)+\r\n\tmax(SecondNextPremiumDiscountPercentage5)+\r\n\tmax(ThirdNextPremiumDiscountLayer5)+\r\n\tmax(ThirdNextPremiumDiscountPercentage5)+\r\n\tmax(BalancePremiumDiscountLayer5)+\r\n\tmax(BalancePremiumDiscountPercentage5)+\r\n\tmax(StateCode6)+\r\n\tmax(FirstPremiumDiscountLayer6)+\r\n\tmax(FirstPremiumDiscountPercentage6)+\r\n\tmax(SecondNextPremiumDiscountLayer6)+\r\n\tmax(SecondNextPremiumDiscountPercentage6)+\r\n\tmax(ThirdNextPremiumDiscountLayer6)+\r\n\tmax(ThirdNextPremiumDiscountPercentage6)+\r\n\tmax(BalancePremiumDiscountLayer6)+\r\n\tmax(BalancePremiumDiscountPercentage6)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record30 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols30Record\n),\nSQ_WCPols36Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfPerson)+\r\n\tmax(NameOfOrganization)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols36RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPerson' and C.FieldName='NameOfPerson' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPerson or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPerson,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfPerson,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPerson' and C.FieldName='NameOfPerson' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfPerson,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfOrganization' and C.FieldName='NameOfOrganization' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfOrganization or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfOrganization,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfOrganization,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfOrganization' and C.FieldName='NameOfOrganization' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfOrganization,\r\n\treplicate(' ',64) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols36Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols36Record'\r\n\tand c.TableName='WCPols36Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols36RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfPerson)+\r\n\tmax(NameOfOrganization)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record36 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols36Record\n),\nSQ_WCPols37Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(DescriptorCode)+\r\n\tmax(NameOfPersonToBeIncluded)+\r\n\tmax(StateCode)+\r\n\tmax(DescriptorCode2)+\r\n\tmax(NameOfPersonToBeIncluded2)+\r\n\tmax(StateCode2)+\r\n\tmax(DescriptorCode3)+\r\n\tmax(NameOfPersonToBeIncluded3)+\r\n\tmax(StateCode3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols37RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode' and C.FieldName='DescriptorCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode' and C.FieldName='DescriptorCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeIncluded' and C.FieldName='NameOfPersonToBeIncluded' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeIncluded or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeIncluded,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.NameOfPersonToBeIncluded,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeIncluded' and C.FieldName='NameOfPersonToBeIncluded' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end NameOfPersonToBeIncluded,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode2' and C.FieldName='DescriptorCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode2,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode2,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode2' and C.FieldName='DescriptorCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeIncluded2' and C.FieldName='NameOfPersonToBeIncluded2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeIncluded2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeIncluded2,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.NameOfPersonToBeIncluded2,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeIncluded2' and C.FieldName='NameOfPersonToBeIncluded2' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end NameOfPersonToBeIncluded2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode2,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode2,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode3' and C.FieldName='DescriptorCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode3,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode3,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode3' and C.FieldName='DescriptorCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeIncluded3' and C.FieldName='NameOfPersonToBeIncluded3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeIncluded3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeIncluded3,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.NameOfPersonToBeIncluded3,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeIncluded3' and C.FieldName='NameOfPersonToBeIncluded3' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end NameOfPersonToBeIncluded3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode3,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode3,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode3,\r\n\treplicate(' ',25) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols37Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols37Record'\r\n\tand c.TableName='WCPols37Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols37RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(DescriptorCode)+\r\n\tmax(NameOfPersonToBeIncluded)+\r\n\tmax(StateCode)+\r\n\tmax(DescriptorCode2)+\r\n\tmax(NameOfPersonToBeIncluded2)+\r\n\tmax(StateCode2)+\r\n\tmax(DescriptorCode3)+\r\n\tmax(NameOfPersonToBeIncluded3)+\r\n\tmax(StateCode3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record37 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols37Record\n),\nSQ_WCPols38Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(DescriptorCode)+\r\n\tmax(NameOfPersonToBeExcluded)+\r\n\tmax(DescriptorCode2)+\r\n\tmax(NameOfPersonToBeExcluded2)+\r\n\tmax(DescriptorCode3)+\r\n\tmax(NameOfPersonToBeExcluded3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols38RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode' and C.FieldName='DescriptorCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode' and C.FieldName='DescriptorCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeExcluded' and C.FieldName='NameOfPersonToBeExcluded' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeExcluded or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeExcluded,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfPersonToBeExcluded,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeExcluded' and C.FieldName='NameOfPersonToBeExcluded' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfPersonToBeExcluded,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode2' and C.FieldName='DescriptorCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode2,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode2,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode2' and C.FieldName='DescriptorCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeExcluded2' and C.FieldName='NameOfPersonToBeExcluded2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeExcluded2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeExcluded2,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfPersonToBeExcluded2,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeExcluded2' and C.FieldName='NameOfPersonToBeExcluded2' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfPersonToBeExcluded2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DescriptorCode3' and C.FieldName='DescriptorCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DescriptorCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DescriptorCode3,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.DescriptorCode3,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DescriptorCode3' and C.FieldName='DescriptorCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end DescriptorCode3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfPersonToBeExcluded3' and C.FieldName='NameOfPersonToBeExcluded3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfPersonToBeExcluded3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfPersonToBeExcluded3,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfPersonToBeExcluded3,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfPersonToBeExcluded3' and C.FieldName='NameOfPersonToBeExcluded3' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfPersonToBeExcluded3,\r\n\treplicate(' ',1) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols38Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols38Record'\r\n\tand c.TableName='WCPols38Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols38RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(DescriptorCode)+\r\n\tmax(NameOfPersonToBeExcluded)+\r\n\tmax(DescriptorCode2)+\r\n\tmax(NameOfPersonToBeExcluded2)+\r\n\tmax(DescriptorCode3)+\r\n\tmax(NameOfPersonToBeExcluded3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record38 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols38Record\n),\nSQ_WCPols40Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(StateCode2)+\r\n\tmax(StateCode3)+\r\n\tmax(StateCode4)+\r\n\tmax(StateCode5)+\r\n\tmax(StateCode6)+\r\n\tmax(StateCode7)+\r\n\tmax(StateCode8)+\r\n\tmax(StateCode9)+\r\n\tmax(StateCode10)+\r\n\tmax(StateCode11)+\r\n\tmax(StateCode12)+\r\n\tmax(StateCode13)+\r\n\tmax(StateCode14)+\r\n\tmax(StateCode15)+\r\n\tmax(StateCode16)+\r\n\tmax(StateCode17)+\r\n\tmax(StateCode18)+\r\n\tmax(StateCode19)+\r\n\tmax(StateCode20)+\r\n\tmax(StateCode21)+\r\n\tmax(StateCode22)+\r\n\tmax(StateCode23)+\r\n\tmax(StateCode24)+\r\n\tmax(StateCode25)+\r\n\tmax(StateCode26)+\r\n\tmax(StateCode27)+\r\n\tmax(StateCode28)+\r\n\tmax(StateCode29)+\r\n\tmax(StateCode30)+\r\n\tmax(StateCode31)+\r\n\tmax(StateCode32)+\r\n\tmax(StateCode33)+\r\n\tmax(StateCode34)+\r\n\tmax(StateCode35)+\r\n\tmax(StateCode36)+\r\n\tmax(StateCode37)+\r\n\tmax(StateCode38)+\r\n\tmax(StateCode39)+\r\n\tmax(StateCode40)+\r\n\tmax(StateCode41)+\r\n\tmax(StateCode42)+\r\n\tmax(StateCode43)+\r\n\tmax(StateCode44)+\r\n\tmax(StateCode45)+\r\n\tmax(StateCode46)+\r\n\tmax(StateCode47)+\r\n\tmax(StateCode48)+\r\n\tmax(StateCode49)+\r\n\tmax(StateCode50)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols40RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode2,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode2,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode2' and C.FieldName='StateCode2' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode3,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode3,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode3' and C.FieldName='StateCode3' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode4 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode4,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode4,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode4' and C.FieldName='StateCode4' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode4,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode5 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode5,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode5,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode5' and C.FieldName='StateCode5' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode5,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode6 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode6,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode6,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode6' and C.FieldName='StateCode6' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode6,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode7' and C.FieldName='StateCode7' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode7 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode7,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode7,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode7' and C.FieldName='StateCode7' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode7,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode8' and C.FieldName='StateCode8' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode8 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode8,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode8,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode8' and C.FieldName='StateCode8' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode8,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode9' and C.FieldName='StateCode9' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode9 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode9,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode9,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode9' and C.FieldName='StateCode9' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode9,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode10 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode10,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode10,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode10' and C.FieldName='StateCode10' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode10,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode11 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode11,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode11,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode11' and C.FieldName='StateCode11' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode11,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode12 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode12,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode12,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode12' and C.FieldName='StateCode12' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode12,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode13 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode13,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode13,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode13' and C.FieldName='StateCode13' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode13,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode14 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode14,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode14,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode14' and C.FieldName='StateCode14' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode14,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode15 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode15,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode15,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode15' and C.FieldName='StateCode15' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode15,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode16 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode16,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode16,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode16' and C.FieldName='StateCode16' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode16,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode17 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode17,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode17,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode17' and C.FieldName='StateCode17' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode17,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode18 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode18,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode18,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode18' and C.FieldName='StateCode18' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode18,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode19 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode19,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode19,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode19' and C.FieldName='StateCode19' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode19,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode20 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode20,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode20,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode20' and C.FieldName='StateCode20' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode20,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode21 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode21,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode21,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode21' and C.FieldName='StateCode21' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode21,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode22 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode22,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode22,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode22' and C.FieldName='StateCode22' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode22,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode23 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode23,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode23,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode23' and C.FieldName='StateCode23' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode23,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode24 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode24,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode24,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode24' and C.FieldName='StateCode24' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode24,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode25 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode25,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode25,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode25' and C.FieldName='StateCode25' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode25,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode26' and C.FieldName='StateCode26' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode26 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode26,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode26,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode26' and C.FieldName='StateCode26' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode26,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode27' and C.FieldName='StateCode27' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode27 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode27,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode27,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode27' and C.FieldName='StateCode27' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode27,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode28' and C.FieldName='StateCode28' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode28 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode28,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode28,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode28' and C.FieldName='StateCode28' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode28,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode29' and C.FieldName='StateCode29' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode29 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode29,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode29,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode29' and C.FieldName='StateCode29' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode29,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode30' and C.FieldName='StateCode30' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode30 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode30,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode30,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode30' and C.FieldName='StateCode30' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode30,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode31' and C.FieldName='StateCode31' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode31 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode31,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode31,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode31' and C.FieldName='StateCode31' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode31,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode32' and C.FieldName='StateCode32' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode32 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode32,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode32,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode32' and C.FieldName='StateCode32' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode32,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode33' and C.FieldName='StateCode33' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode33 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode33,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode33,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode33' and C.FieldName='StateCode33' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode33,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode34' and C.FieldName='StateCode34' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode34 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode34,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode34,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode34' and C.FieldName='StateCode34' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode34,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode35' and C.FieldName='StateCode35' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode35 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode35,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode35,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode35' and C.FieldName='StateCode35' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode35,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode36' and C.FieldName='StateCode36' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode36 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode36,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode36,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode36' and C.FieldName='StateCode36' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode36,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode37' and C.FieldName='StateCode37' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode37 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode37,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode37,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode37' and C.FieldName='StateCode37' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode37,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode38' and C.FieldName='StateCode38' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode38 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode38,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode38,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode38' and C.FieldName='StateCode38' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode38,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode39' and C.FieldName='StateCode39' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode39 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode39,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode39,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode39' and C.FieldName='StateCode39' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode39,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode40' and C.FieldName='StateCode40' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode40 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode40,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode40,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode40' and C.FieldName='StateCode40' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode40,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode41' and C.FieldName='StateCode41' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode41 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode41,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode41,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode41' and C.FieldName='StateCode41' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode41,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode42' and C.FieldName='StateCode42' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode42 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode42,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode42,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode42' and C.FieldName='StateCode42' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode42,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode43' and C.FieldName='StateCode43' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode43 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode43,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode43,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode43' and C.FieldName='StateCode43' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode43,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode44' and C.FieldName='StateCode44' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode44 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode44,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode44,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode44' and C.FieldName='StateCode44' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode44,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode45' and C.FieldName='StateCode45' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode45 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode45,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode45,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode45' and C.FieldName='StateCode45' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode45,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode46' and C.FieldName='StateCode46' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode46 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode46,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode46,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode46' and C.FieldName='StateCode46' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode46,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode47' and C.FieldName='StateCode47' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode47 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode47,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode47,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode47' and C.FieldName='StateCode47' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode47,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode48' and C.FieldName='StateCode48' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode48 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode48,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode48,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode48' and C.FieldName='StateCode48' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode48,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode49' and C.FieldName='StateCode49' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode49 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode49,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode49,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode49' and C.FieldName='StateCode49' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode49,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode50' and C.FieldName='StateCode50' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode50 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode50,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode50,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode50' and C.FieldName='StateCode50' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode50,\r\n\treplicate(' ',84) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols40Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols40Record'\r\n\tand c.TableName='WCPols40Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols40RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateCode)+\r\n\tmax(StateCode2)+\r\n\tmax(StateCode3)+\r\n\tmax(StateCode4)+\r\n\tmax(StateCode5)+\r\n\tmax(StateCode6)+\r\n\tmax(StateCode7)+\r\n\tmax(StateCode8)+\r\n\tmax(StateCode9)+\r\n\tmax(StateCode10)+\r\n\tmax(StateCode11)+\r\n\tmax(StateCode12)+\r\n\tmax(StateCode13)+\r\n\tmax(StateCode14)+\r\n\tmax(StateCode15)+\r\n\tmax(StateCode16)+\r\n\tmax(StateCode17)+\r\n\tmax(StateCode18)+\r\n\tmax(StateCode19)+\r\n\tmax(StateCode20)+\r\n\tmax(StateCode21)+\r\n\tmax(StateCode22)+\r\n\tmax(StateCode23)+\r\n\tmax(StateCode24)+\r\n\tmax(StateCode25)+\r\n\tmax(StateCode26)+\r\n\tmax(StateCode27)+\r\n\tmax(StateCode28)+\r\n\tmax(StateCode29)+\r\n\tmax(StateCode30)+\r\n\tmax(StateCode31)+\r\n\tmax(StateCode32)+\r\n\tmax(StateCode33)+\r\n\tmax(StateCode34)+\r\n\tmax(StateCode35)+\r\n\tmax(StateCode36)+\r\n\tmax(StateCode37)+\r\n\tmax(StateCode38)+\r\n\tmax(StateCode39)+\r\n\tmax(StateCode40)+\r\n\tmax(StateCode41)+\r\n\tmax(StateCode42)+\r\n\tmax(StateCode43)+\r\n\tmax(StateCode44)+\r\n\tmax(StateCode45)+\r\n\tmax(StateCode46)+\r\n\tmax(StateCode47)+\r\n\tmax(StateCode48)+\r\n\tmax(StateCode49)+\r\n\tmax(StateCode50)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record40 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols40Record\n),\nSQ_WCPOLS_Record42 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(ContingentModificationEffectiveDate)+\r\n\tmax(ContingentExperienceModificationFactor)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPols42RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ContingentModificationEffectiveDate' and C.FieldName='ContingentModificationEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ContingentModificationEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ContingentModificationEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.ContingentModificationEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ContingentModificationEffectiveDate' and C.FieldName='ContingentModificationEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end ContingentModificationEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ContingentExperienceModificationFactor' and C.FieldName='ContingentExperienceModificationFactor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ContingentExperienceModificationFactor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ContingentExperienceModificationFactor,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ContingentExperienceModificationFactor,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ContingentExperienceModificationFactor' and C.FieldName='ContingentExperienceModificationFactor' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ContingentExperienceModificationFactor,\r\n\treplicate(' ',174) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols42Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols42Record'\r\n\tand c.TableName='WCPols42Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols42RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(ContingentModificationEffectiveDate)+\r\n\tmax(ContingentExperienceModificationFactor)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record42 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record42\n),\nSQ_WCPOLS_Record43 AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(LossesSubjectToDeductibleCode)+\r\n\tmax(BasisOfDeductibleCalculationCode)+\r\n\tmax(DeductiblePercentage)+\r\n\tmax(DeductibleAmountPerClaimAccident)+\r\n\tmax(DeductibleAmountAggregate)+\r\n\tmax(PremiumReductionPercentage)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPols43RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LossesSubjectToDeductibleCode' and C.FieldName='LossesSubjectToDeductibleCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LossesSubjectToDeductibleCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LossesSubjectToDeductibleCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.LossesSubjectToDeductibleCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LossesSubjectToDeductibleCode' and C.FieldName='LossesSubjectToDeductibleCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end LossesSubjectToDeductibleCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasisOfDeductibleCalculationCode' and C.FieldName='BasisOfDeductibleCalculationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasisOfDeductibleCalculationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasisOfDeductibleCalculationCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.BasisOfDeductibleCalculationCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasisOfDeductibleCalculationCode' and C.FieldName='BasisOfDeductibleCalculationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end BasisOfDeductibleCalculationCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DeductiblePercentage' and C.FieldName='DeductiblePercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DeductiblePercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DeductiblePercentage,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.DeductiblePercentage,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DeductiblePercentage' and C.FieldName='DeductiblePercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end DeductiblePercentage,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DeductibleAmountPerClaimAccident' and C.FieldName='DeductibleAmountPerClaimAccident' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DeductibleAmountPerClaimAccident or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DeductibleAmountPerClaimAccident,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.DeductibleAmountPerClaimAccident,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DeductibleAmountPerClaimAccident' and C.FieldName='DeductibleAmountPerClaimAccident' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end DeductibleAmountPerClaimAccident,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DeductibleAmountAggregate' and C.FieldName='DeductibleAmountAggregate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DeductibleAmountAggregate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DeductibleAmountAggregate,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.DeductibleAmountAggregate,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DeductibleAmountAggregate' and C.FieldName='DeductibleAmountAggregate' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end DeductibleAmountAggregate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PremiumReductionPercentage' and C.FieldName='PremiumReductionPercentage' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PremiumReductionPercentage or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PremiumReductionPercentage,'')+replicate(' ',5),5) else Right(replicate('0',5)+ISNULL(A.PremiumReductionPercentage,''),5) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PremiumReductionPercentage' and C.FieldName='PremiumReductionPercentage' then case when C.FieldDataType in ('A','AN') then replicate(' ',5) else replicate('0',5) end\r\n\tend end PremiumReductionPercentage,\r\n\treplicate(' ',155) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols43Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols43Record'\r\n\tand c.TableName='WCPols43Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols43RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(LossesSubjectToDeductibleCode)+\r\n\tmax(BasisOfDeductibleCalculationCode)+\r\n\tmax(DeductiblePercentage)+\r\n\tmax(DeductibleAmountPerClaimAccident)+\r\n\tmax(DeductibleAmountAggregate)+\r\n\tmax(PremiumReductionPercentage)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record43 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPOLS_Record43\n),\nSQ_WCPols44Record AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateAbbreviation)+\r\n\tmax(BasisOfAuditNoncomplianceCharge)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier)+\r\n\tmax(StateAbbreviation2)+\r\n\tmax(BasisOfAuditNoncomplianceCharge2)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier2)+\r\n\tmax(StateAbbreviation3)+\r\n\tmax(BasisOfAuditNoncomplianceCharge3)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPols44RecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\treplicate(' ',2) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateAbbreviation' and C.FieldName='StateAbbreviation' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateAbbreviation or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateAbbreviation,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateAbbreviation,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateAbbreviation' and C.FieldName='StateAbbreviation' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateAbbreviation,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge' and C.FieldName='BasisOfAuditNoncomplianceCharge' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasisOfAuditNoncomplianceCharge or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasisOfAuditNoncomplianceCharge,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.BasisOfAuditNoncomplianceCharge,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge' and C.FieldName='BasisOfAuditNoncomplianceCharge' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end BasisOfAuditNoncomplianceCharge,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MaximumAuditNoncomplianceChargeMultiplier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end MaximumAuditNoncomplianceChargeMultiplier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateAbbreviation2' and C.FieldName='StateAbbreviation2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateAbbreviation2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateAbbreviation2,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateAbbreviation2,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateAbbreviation2' and C.FieldName='StateAbbreviation2' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateAbbreviation2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge2' and C.FieldName='BasisOfAuditNoncomplianceCharge2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasisOfAuditNoncomplianceCharge2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasisOfAuditNoncomplianceCharge2,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.BasisOfAuditNoncomplianceCharge2,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge2' and C.FieldName='BasisOfAuditNoncomplianceCharge2' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end BasisOfAuditNoncomplianceCharge2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier2' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier2' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MaximumAuditNoncomplianceChargeMultiplier2 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier2,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier2,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier2' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier2' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end MaximumAuditNoncomplianceChargeMultiplier2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateAbbreviation3' and C.FieldName='StateAbbreviation3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateAbbreviation3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateAbbreviation3,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateAbbreviation3,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateAbbreviation3' and C.FieldName='StateAbbreviation3' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateAbbreviation3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge3' and C.FieldName='BasisOfAuditNoncomplianceCharge3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BasisOfAuditNoncomplianceCharge3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BasisOfAuditNoncomplianceCharge3,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.BasisOfAuditNoncomplianceCharge3,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BasisOfAuditNoncomplianceCharge3' and C.FieldName='BasisOfAuditNoncomplianceCharge3' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end BasisOfAuditNoncomplianceCharge3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier3' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier3' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MaximumAuditNoncomplianceChargeMultiplier3 or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier3,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.MaximumAuditNoncomplianceChargeMultiplier3,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MaximumAuditNoncomplianceChargeMultiplier3' and C.FieldName='MaximumAuditNoncomplianceChargeMultiplier3' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end MaximumAuditNoncomplianceChargeMultiplier3,\r\n\treplicate(' ',16) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols44Record A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPols44Record'\r\n\tand c.TableName='WCPols44Record'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPols44RecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(StateAbbreviation)+\r\n\tmax(BasisOfAuditNoncomplianceCharge)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier)+\r\n\tmax(StateAbbreviation2)+\r\n\tmax(BasisOfAuditNoncomplianceCharge2)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier2)+\r\n\tmax(StateAbbreviation3)+\r\n\tmax(BasisOfAuditNoncomplianceCharge3)+\r\n\tmax(MaximumAuditNoncomplianceChargeMultiplier3)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_Record44 AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPols44Record\n),\nSQ_WCPolsEBRecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfOriginalCarrier)+\r\n\tmax(NameOfNewCarrier)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPolsEBRecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfOriginalCarrier' and C.FieldName='NameOfOriginalCarrier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfOriginalCarrier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfOriginalCarrier,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.NameOfOriginalCarrier,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfOriginalCarrier' and C.FieldName='NameOfOriginalCarrier' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end NameOfOriginalCarrier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfNewCarrier' and C.FieldName='NameOfNewCarrier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfNewCarrier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfNewCarrier,'')+replicate(' ',100),100) else Right(replicate('0',100)+ISNULL(A.NameOfNewCarrier,''),100) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfNewCarrier' and C.FieldName='NameOfNewCarrier' then case when C.FieldDataType in ('A','AN') then replicate(' ',100) else replicate('0',100) end\r\n\tend end NameOfNewCarrier,\r\n\treplicate(' ',54) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPolsEBRecord A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsEBRecord'\r\n\tand c.TableName='WCPolsEBRecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsEBRecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfOriginalCarrier)+\r\n\tmax(NameOfNewCarrier)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordEB AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsEBRecord\n),\nSQ_WCPolsECRecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfClientOrNameOfLaborContractor)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipcode)+\r\n\tmax(FederalEmployerIdentificationNumber)+\r\n\tmax(ClientPremiumAmount)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPolsECRecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfClientOrNameOfLaborContractor' and C.FieldName='NameOfClientOrNameOfLaborContractor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfClientOrNameOfLaborContractor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfClientOrNameOfLaborContractor,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfClientOrNameOfLaborContractor,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfClientOrNameOfLaborContractor' and C.FieldName='NameOfClientOrNameOfLaborContractor' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfClientOrNameOfLaborContractor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStreet or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStreet,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.AddressStreet,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end AddressStreet,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressCity or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressCity,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.AddressCity,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end AddressCity,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressState or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressState,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.AddressState,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end AddressState,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressZipcode' and C.FieldName='AddressZipcode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressZipcode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressZipcode,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.AddressZipcode,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressZipcode' and C.FieldName='AddressZipcode' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end AddressZipcode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FederalEmployerIdentificationNumber' and C.FieldName='FederalEmployerIdentificationNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FederalEmployerIdentificationNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FederalEmployerIdentificationNumber,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.FederalEmployerIdentificationNumber,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FederalEmployerIdentificationNumber' and C.FieldName='FederalEmployerIdentificationNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end FederalEmployerIdentificationNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClientPremiumAmount' and C.FieldName='ClientPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClientPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClientPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.ClientPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClientPremiumAmount' and C.FieldName='ClientPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end ClientPremiumAmount,\r\n\treplicate(' ',4) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPolsECRecord A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsECRecord'\r\n\tand c.TableName='WCPolsECRecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsECRecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfClientOrNameOfLaborContractor)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipcode)+\r\n\tmax(FederalEmployerIdentificationNumber)+\r\n\tmax(ClientPremiumAmount)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordEC AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsECRecord\n),\nSQ_WCPolsEDRecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfEmployeeLeasingCompany)+\r\n\tmax(NameOfClient)+\r\n\tmax(TerminationEffectiveDate)+\r\n\tmax(EntitiesReceivingThisForm)+\r\n\tmax(DateSent)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2) From (\r\n\tSelect WCPolsEDRecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfEmployeeLeasingCompany' and C.FieldName='NameOfEmployeeLeasingCompany' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfEmployeeLeasingCompany or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfEmployeeLeasingCompany,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfEmployeeLeasingCompany,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfEmployeeLeasingCompany' and C.FieldName='NameOfEmployeeLeasingCompany' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfEmployeeLeasingCompany,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfClient' and C.FieldName='NameOfClient' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfClient or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfClient,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfClient,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfClient' and C.FieldName='NameOfClient' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfClient,\r\n\tcase \r\n\twhen B.COLUMN_NAME='TerminationEffectiveDate' and C.FieldName='TerminationEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.TerminationEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.TerminationEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.TerminationEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='TerminationEffectiveDate' and C.FieldName='TerminationEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end TerminationEffectiveDate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EntitiesReceivingThisForm' and C.FieldName='EntitiesReceivingThisForm' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EntitiesReceivingThisForm or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EntitiesReceivingThisForm,'')+replicate(' ',52),52) else Right(replicate('0',52)+ISNULL(A.EntitiesReceivingThisForm,''),52) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EntitiesReceivingThisForm' and C.FieldName='EntitiesReceivingThisForm' then case when C.FieldDataType in ('A','AN') then replicate(' ',52) else replicate('0',52) end\r\n\tend end EntitiesReceivingThisForm,\r\n\tcase \r\n\twhen B.COLUMN_NAME='DateSent' and C.FieldName='DateSent' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.DateSent or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.DateSent,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.DateSent,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='DateSent' and C.FieldName='DateSent' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end DateSent,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse2\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPolsEDRecord A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsEDRecord'\r\n\tand c.TableName='WCPolsEDRecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsEDRecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfEmployeeLeasingCompany)+\r\n\tmax(NameOfClient)+\r\n\tmax(TerminationEffectiveDate)+\r\n\tmax(EntitiesReceivingThisForm)+\r\n\tmax(DateSent)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordED AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsEDRecord\n),\nSQ_WCPolsEIRecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfLaborContractor)+\r\n\tmax(PolicyNumberOfLaborContractor)+\r\n\tmax(FEINOfLaborContractor)+\r\n\tmax(AddressOfLaborContractorStreet)+\r\n\tmax(AddressOfLaborContractorCity)+\r\n\tmax(AddressOfLaborContractorState)+\r\n\tmax(AddressOfLaborContractorZipcode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2) From (\r\n\tSelect WCPolsEIRecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfLaborContractor' and C.FieldName='NameOfLaborContractor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfLaborContractor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfLaborContractor,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.NameOfLaborContractor,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfLaborContractor' and C.FieldName='NameOfLaborContractor' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end NameOfLaborContractor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='PolicyNumberOfLaborContractor' and C.FieldName='PolicyNumberOfLaborContractor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.PolicyNumberOfLaborContractor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.PolicyNumberOfLaborContractor,'')+replicate(' ',18),18) else Right(replicate('0',18)+ISNULL(A.PolicyNumberOfLaborContractor,''),18) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='PolicyNumberOfLaborContractor' and C.FieldName='PolicyNumberOfLaborContractor' then case when C.FieldDataType in ('A','AN') then replicate(' ',18) else replicate('0',18) end\r\n\tend end PolicyNumberOfLaborContractor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='FEINOfLaborContractor' and C.FieldName='FEINOfLaborContractor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.FEINOfLaborContractor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.FEINOfLaborContractor,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.FEINOfLaborContractor,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='FEINOfLaborContractor' and C.FieldName='FEINOfLaborContractor' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end FEINOfLaborContractor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfLaborContractorStreet' and C.FieldName='AddressOfLaborContractorStreet' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfLaborContractorStreet or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfLaborContractorStreet,'')+replicate(' ',56),56) else Right(replicate('0',56)+ISNULL(A.AddressOfLaborContractorStreet,''),56) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfLaborContractorStreet' and C.FieldName='AddressOfLaborContractorStreet' then case when C.FieldDataType in ('A','AN') then replicate(' ',56) else replicate('0',56) end\r\n\tend end AddressOfLaborContractorStreet,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfLaborContractorCity' and C.FieldName='AddressOfLaborContractorCity' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfLaborContractorCity or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfLaborContractorCity,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.AddressOfLaborContractorCity,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfLaborContractorCity' and C.FieldName='AddressOfLaborContractorCity' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end AddressOfLaborContractorCity,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfLaborContractorState' and C.FieldName='AddressOfLaborContractorState' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfLaborContractorState or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfLaborContractorState,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.AddressOfLaborContractorState,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfLaborContractorState' and C.FieldName='AddressOfLaborContractorState' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end AddressOfLaborContractorState,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressOfLaborContractorZipcode' and C.FieldName='AddressOfLaborContractorZipcode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressOfLaborContractorZipcode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressOfLaborContractorZipcode,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.AddressOfLaborContractorZipcode,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressOfLaborContractorZipcode' and C.FieldName='AddressOfLaborContractorZipcode' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end AddressOfLaborContractorZipcode,\r\n\t\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tleft(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34)\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse2\r\n\tfrom dbo.WCPolsEIRecord A\r\n\tinner join dbo.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join dbo.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsEIRecord'\r\n\tand c.TableName='WCPolsEIRecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsEIRecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfLaborContractor)+\r\n\tmax(PolicyNumberOfLaborContractor)+\r\n\tmax(FEINOfLaborContractor)+\r\n\tmax(AddressOfLaborContractorStreet)+\r\n\tmax(AddressOfLaborContractorCity)+\r\n\tmax(AddressOfLaborContractorState)+\r\n\tmax(AddressOfLaborContractorZipcode)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse2)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordEI AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsEIRecord\n),\nSQ_WCPolsHARecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfIndependentContractor)+\r\n\tmax(ClassificationCode)+\r\n\tmax(ClassificationWording)+\r\n\tmax(EstimatedExposureAmount)+\r\n\tmax(RateChargedRate)+\r\n\tmax(MinimumPremiumAmount)+\r\n\tmax(EstimatedAnnualPremiumAmount)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3) From (\r\n\tSelect WCPolsHARecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfIndependentContractor' and C.FieldName='NameOfIndependentContractor' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfIndependentContractor or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfIndependentContractor,'')+replicate(' ',90),90) else Right(replicate('0',90)+ISNULL(A.NameOfIndependentContractor,''),90) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfIndependentContractor' and C.FieldName='NameOfIndependentContractor' then case when C.FieldDataType in ('A','AN') then replicate(' ',90) else replicate('0',90) end\r\n\tend end NameOfIndependentContractor,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationCode' and C.FieldName='ClassificationCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationCode,'')+replicate(' ',4),4) else Right(replicate('0',4)+ISNULL(A.ClassificationCode,''),4) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationCode' and C.FieldName='ClassificationCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',4) else replicate('0',4) end\r\n\tend end ClassificationCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClassificationWording' and C.FieldName='ClassificationWording' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClassificationWording or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClassificationWording,'')+replicate(' ',47),47) else Right(replicate('0',47)+ISNULL(A.ClassificationWording,''),47) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClassificationWording' and C.FieldName='ClassificationWording' then case when C.FieldDataType in ('A','AN') then replicate(' ',47) else replicate('0',47) end\r\n\tend end ClassificationWording,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedExposureAmount' and C.FieldName='EstimatedExposureAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedExposureAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedExposureAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedExposureAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedExposureAmount' and C.FieldName='EstimatedExposureAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedExposureAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RateChargedRate' and C.FieldName='RateChargedRate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RateChargedRate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RateChargedRate,'')+replicate(' ',7),7) else Right(replicate('0',7)+ISNULL(A.RateChargedRate,''),7) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RateChargedRate' and C.FieldName='RateChargedRate' then case when C.FieldDataType in ('A','AN') then replicate(' ',7) else replicate('0',7) end\r\n\tend end RateChargedRate,\r\n\tcase \r\n\twhen B.COLUMN_NAME='MinimumPremiumAmount' and C.FieldName='MinimumPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.MinimumPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.MinimumPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.MinimumPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='MinimumPremiumAmount' and C.FieldName='MinimumPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end MinimumPremiumAmount,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EstimatedAnnualPremiumAmount' and C.FieldName='EstimatedAnnualPremiumAmount' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EstimatedAnnualPremiumAmount or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EstimatedAnnualPremiumAmount,'')+replicate(' ',10),10) else Right(replicate('0',10)+ISNULL(A.EstimatedAnnualPremiumAmount,''),10) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EstimatedAnnualPremiumAmount' and C.FieldName='EstimatedAnnualPremiumAmount' then case when C.FieldDataType in ('A','AN') then replicate(' ',10) else replicate('0',10) end\r\n\tend end EstimatedAnnualPremiumAmount,\r\n\treplicate(' ',6) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse3\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPolsHARecord A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsHARecord'\r\n\tand c.TableName='WCPolsHARecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsHARecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfIndependentContractor)+\r\n\tmax(ClassificationCode)+\r\n\tmax(ClassificationWording)+\r\n\tmax(EstimatedExposureAmount)+\r\n\tmax(RateChargedRate)+\r\n\tmax(MinimumPremiumAmount)+\r\n\tmax(EstimatedAnnualPremiumAmount)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse3)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordHA AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsHARecord\n),\nSQ_WCPolsHCRecord AS (\n\tSelect max(LinkData) LinkData,\r\n\tmax(RecordTypeCode) RecordTypeCode,\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfClient)+\r\n\tmax(LeasingAddressTypeCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(ClientFederalEmployerIdentificationNumber)+\r\n\tmax(ClientsUnemploymentInsuranceNumber)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4) From (\r\n\tSelect WCPolsHCRecordID, \r\n\tA.WCTrackHistoryID,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LinkData or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LinkData,'')+replicate(' ',43),43) else Right(replicate('0',43)+ISNULL(A.LinkData,''),43) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LinkData' and C.FieldName='LinkData' then case when C.FieldDataType in ('A','AN') then replicate(' ',43) else replicate('0',43) end\r\n\tend end LinkData,\r\n\tcase \r\n\twhen B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.StateCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.StateCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.StateCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='StateCode' and C.FieldName='StateCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end StateCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.RecordTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.RecordTypeCode,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.RecordTypeCode,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='RecordTypeCode' and C.FieldName='RecordTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end RecordTypeCode,\r\n\treplicate(' ',3) ReservedForFutureUse1,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementNumber,'')+replicate(' ',8),8) else Right(replicate('0',8)+ISNULL(A.EndorsementNumber,''),8) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementNumber' and C.FieldName='EndorsementNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',8) else replicate('0',8) end\r\n\tend end EndorsementNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.BureauVersionIdentifierEditionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.BureauVersionIdentifierEditionIdentifier,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.BureauVersionIdentifierEditionIdentifier,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='BureauVersionIdentifierEditionIdentifier' and C.FieldName='BureauVersionIdentifierEditionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end BureauVersionIdentifierEditionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.CarrierVersionIdentifier or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.CarrierVersionIdentifier,'')+replicate(' ',11),11) else Right(replicate('0',11)+ISNULL(A.CarrierVersionIdentifier,''),11) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='CarrierVersionIdentifier' and C.FieldName='CarrierVersionIdentifier' then case when C.FieldDataType in ('A','AN') then replicate(' ',11) else replicate('0',11) end\r\n\tend end CarrierVersionIdentifier,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfClient' and C.FieldName='NameOfClient' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfClient or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfClient,'')+replicate(' ',50),50) else Right(replicate('0',50)+ISNULL(A.NameOfClient,''),50) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfClient' and C.FieldName='NameOfClient' then case when C.FieldDataType in ('A','AN') then replicate(' ',50) else replicate('0',50) end\r\n\tend end NameOfClient,\r\n\tcase \r\n\twhen B.COLUMN_NAME='LeasingAddressTypeCode' and C.FieldName='LeasingAddressTypeCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.LeasingAddressTypeCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.LeasingAddressTypeCode,'')+replicate(' ',1),1) else Right(replicate('0',1)+ISNULL(A.LeasingAddressTypeCode,''),1) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='LeasingAddressTypeCode' and C.FieldName='LeasingAddressTypeCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',1) else replicate('0',1) end\r\n\tend end LeasingAddressTypeCode,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressStreet or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressStreet,'')+replicate(' ',60),60) else Right(replicate('0',60)+ISNULL(A.AddressStreet,''),60) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressStreet' and C.FieldName='AddressStreet' then case when C.FieldDataType in ('A','AN') then replicate(' ',60) else replicate('0',60) end\r\n\tend end AddressStreet,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressCity or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressCity,'')+replicate(' ',30),30) else Right(replicate('0',30)+ISNULL(A.AddressCity,''),30) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressCity' and C.FieldName='AddressCity' then case when C.FieldDataType in ('A','AN') then replicate(' ',30) else replicate('0',30) end\r\n\tend end AddressCity,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressState or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressState,'')+replicate(' ',2),2) else Right(replicate('0',2)+ISNULL(A.AddressState,''),2) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressState' and C.FieldName='AddressState' then case when C.FieldDataType in ('A','AN') then replicate(' ',2) else replicate('0',2) end\r\n\tend end AddressState,\r\n\tcase \r\n\twhen B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.AddressZipCode or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.AddressZipCode,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.AddressZipCode,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='AddressZipCode' and C.FieldName='AddressZipCode' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end AddressZipCode,\r\n\treplicate(' ',2) ReservedForFutureUse2,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClientFederalEmployerIdentificationNumber' and C.FieldName='ClientFederalEmployerIdentificationNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClientFederalEmployerIdentificationNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClientFederalEmployerIdentificationNumber,'')+replicate(' ',9),9) else Right(replicate('0',9)+ISNULL(A.ClientFederalEmployerIdentificationNumber,''),9) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClientFederalEmployerIdentificationNumber' and C.FieldName='ClientFederalEmployerIdentificationNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',9) else replicate('0',9) end\r\n\tend end ClientFederalEmployerIdentificationNumber,\r\n\tcase \r\n\twhen B.COLUMN_NAME='ClientsUnemploymentInsuranceNumber' and C.FieldName='ClientsUnemploymentInsuranceNumber' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.ClientsUnemploymentInsuranceNumber or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.ClientsUnemploymentInsuranceNumber,'')+replicate(' ',15),15) else Right(replicate('0',15)+ISNULL(A.ClientsUnemploymentInsuranceNumber,''),15) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='ClientsUnemploymentInsuranceNumber' and C.FieldName='ClientsUnemploymentInsuranceNumber' then case when C.FieldDataType in ('A','AN') then replicate(' ',15) else replicate('0',15) end\r\n\tend end ClientsUnemploymentInsuranceNumber,\r\n\treplicate(' ',6) ReservedForFutureUse3,\r\n\tcase \r\n\twhen B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.NameOfInsured or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.NameOfInsured,'')+replicate(' ',34),34) else Right(replicate('0',34)+ISNULL(A.NameOfInsured,''),34) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='NameOfInsured' and C.FieldName='NameOfInsured' then case when C.FieldDataType in ('A','AN') then replicate(' ',34) else replicate('0',34) end\r\n\tend end NameOfInsured,\r\n\tcase \r\n\twhen B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' and F.TransactionCode=D.WCPOLSTransactionType and E.TransactionType=D.SourceTransactionType  and (D.WCPOLSCode=A.EndorsementEffectiveDate or D.WCPOLSCode is null) then\r\n\tcase when C.FieldDataType in ('A','AN') then left(ISNULL(A.EndorsementEffectiveDate,'')+replicate(' ',6),6) else Right(replicate('0',6)+ISNULL(A.EndorsementEffectiveDate,''),6) end\r\n\telse \r\n\tcase when B.COLUMN_NAME='EndorsementEffectiveDate' and C.FieldName='EndorsementEffectiveDate' then case when C.FieldDataType in ('A','AN') then replicate(' ',6) else replicate('0',6) end\r\n\tend end EndorsementEffectiveDate,\r\n\treplicate(' ',6)ReservedForFutureUse4\r\n\t\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPolsHCRecord A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkWCTrackHistory  E\r\n\ton A.WCTrackHistoryID=E.WCTrackHistoryID\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.WCPols00Record F\r\n\ton A.WCTrackHistoryID=F.WCTrackHistoryID\r\n\tinner join INFORMATION_SCHEMA.COLUMNS B\r\n\ton 1=1\r\n\tinner join SupWCPOLSFieldNeeded C\r\n\ton B.TABLE_NAME=C.TableName\r\n\tand B.COLUMN_NAME=C.FieldName\r\n\tLeft join SUPWCPOLSAllCombinations D\r\n\ton B.TABLE_NAME=D.TableName\r\n\tand case when B.COLUMN_NAME like 'StateCode%' and B.COLUMN_NAME not in ('StateCodeLink') then 'StateCode' else B.COLUMN_NAME end=D.FieldName\r\n\tand D.FinalFileName='@{pipeline().parameters.FILENAME}'\r\n\twhere B.TABLE_NAME='WCPolsHCRecord'\r\n\tand c.TableName='WCPolsHCRecord'\r\n\tand A.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand E.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand F.Auditid=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tand (('@{pipeline().parameters.FILENAME}'='NCCI' and E.NCCIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='WI' and E.WIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MI' and E.MIRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='MN' and E.MNRequiredFlag=1) OR\r\n\t('@{pipeline().parameters.FILENAME}'='NC' and E.NCRequiredFlag=1))\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\t) A\r\n\tgroup by A.WCPolsHCRecordID, A.WCTrackHistoryID\r\n\thaving ltrim(rtrim(replace(\r\n\tmax(LinkData)+\r\n\tmax(StateCode)+\r\n\tmax(RecordTypeCode)+\r\n\tmax(ReservedForFutureUse1)+\r\n\tmax(EndorsementNumber)+\r\n\tmax(BureauVersionIdentifierEditionIdentifier)+\r\n\tmax(CarrierVersionIdentifier)+\r\n\tmax(NameOfClient)+\r\n\tmax(LeasingAddressTypeCode)+\r\n\tmax(AddressStreet)+\r\n\tmax(AddressCity)+\r\n\tmax(AddressState)+\r\n\tmax(AddressZipCode)+\r\n\tmax(ReservedForFutureUse2)+\r\n\tmax(ClientFederalEmployerIdentificationNumber)+\r\n\tmax(ClientsUnemploymentInsuranceNumber)+\r\n\tmax(ReservedForFutureUse3)+\r\n\tmax(NameOfInsured)+\r\n\tmax(EndorsementEffectiveDate)+\r\n\tmax(ReservedForFutureUse4)\r\n\t,'0','')))<>''\n),\nEXP_DataCollect_RecordHC AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData\n\tFROM SQ_WCPolsHCRecord\n),\nU_Records AS (\n\tSELECT LinkData, RecordTypeCode, Data, WCTrackHistoryID\n\tFROM EXP_DataCollect_Record01\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record02\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record03\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record04\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record05\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record06\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record07\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data, WCTrackHistoryID\n\tFROM EXP_DataCollect_Record08\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record09\n\tUNION\n\tSELEC\n\tFROM \n\tUNION\n\tSELEC\n\tFROM \n\tUNION\n\tSELEC\n\tFROM \n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record21\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record42\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record43\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record03_INIAMO\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record15\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record18\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record19\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record23\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record24\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record25\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record29\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record30\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record36\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record37\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record38\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record40\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_Record44\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordEB\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordEC\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordED\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordHA\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordHC\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data\n\tFROM EXP_DataCollect_RecordEI\n),\nEXP_RecordCount AS (\n\tSELECT\n\tLinkData,\n\tRecordTypeCode,\n\tData,\n\t-- *INF*: ReplaceChr( 0, Data, '[]', chr(39))\r\n\t-- \r\n\t-- --REPLACESTR(1,Data ,chr(96) ,chr(39))\n\tREGEXP_REPLACE(Data,'[]',chr(39),'i') AS o_Data,\n\tWCTrackHistoryID,\n\t-- *INF*: IIF(RecordTypeCode='01',1+v_HeaderCount,v_HeaderCount)\n\tIFF(RecordTypeCode = '01', 1 + v_HeaderCount, v_HeaderCount) AS v_HeaderCount,\n\tv_HeaderCount AS HeaderCount,\n\t1+v_RecordCount AS v_RecordCount,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(@{pipeline().parameters.FILENAME},'MI','WI','MN','NC'),v_RecordCount+1,\r\n\t-- v_RecordCount)\n\tDECODE(\n\t    TRUE,\n\t    @{pipeline().parameters.FILENAME} IN ('MI','WI','MN','NC'), v_RecordCount + 1,\n\t    v_RecordCount\n\t) AS RecordCount,\n\t1 AS Srt\n\tFROM U_Records\n),\nLKP_TransactionDate AS (\n\tSELECT\n\tTransactionDate,\n\tLinkData\n\tFROM (\n\t\tselect \r\n\t\tB.TransactionDate as TransactionDate, \r\n\t\tA.WCTrackHistoryID as WCTrackHistoryID,\r\n\t\tA.LinkData as LinkData\r\n\t\tFROM \r\n\t\tWCPols00Record A inner join WorkWCPolicy B on \r\n\t\t\tA.WCTrackHistoryID=B.WCTrackHistoryID\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY LinkData ORDER BY TransactionDate) = 1\n),\nAGG_RecordCounts AS (\n\tSELECT\n\tEXP_RecordCount.HeaderCount,\n\t-- *INF*: max(HeaderCount)\n\tmax(HeaderCount) AS o_HeaderCount,\n\tEXP_RecordCount.RecordCount,\n\t-- *INF*: max(RecordCount)\n\tmax(RecordCount) AS o_RecordCount,\n\tLKP_TransactionDate.TransactionDate,\n\t-- *INF*: MIN(TransactionDate)\n\tMIN(TransactionDate) AS MinTransactionDate,\n\t-- *INF*: Max(TransactionDate)\n\tMax(TransactionDate) AS MaxTransactionDate,\n\t1 AS JoinField\n\tFROM EXP_RecordCount\n\tLEFT JOIN LKP_TransactionDate\n\tON LKP_TransactionDate.LinkData = EXP_RecordCount.LinkData\n\tGROUP BY \n),\nSQ_SupWCPOLS AS (\n\tSELECT TOP 1 SupWCPOLS.SupWCPOLSID \r\n\tFROM\r\n\t SupWCPOLS\n),\nEXP_Record99_Input AS (\n\tSELECT\n\tSupWCPOLSID,\n\t1 AS JoinField\n\tFROM SQ_SupWCPOLS\n),\nJNR_ForceRecord99 AS (SELECT\n\tAGG_RecordCounts.o_HeaderCount, \n\tAGG_RecordCounts.o_RecordCount, \n\tAGG_RecordCounts.MinTransactionDate, \n\tAGG_RecordCounts.MaxTransactionDate, \n\tAGG_RecordCounts.JoinField, \n\tEXP_Record99_Input.JoinField AS JoinField1\n\tFROM AGG_RecordCounts\n\tRIGHT OUTER JOIN EXP_Record99_Input\n\tON EXP_Record99_Input.JoinField = AGG_RecordCounts.JoinField\n),\nEXP_Record99 AS (\n\tSELECT\n\to_HeaderCount AS i_HeaderCount,\n\to_RecordCount AS i_RecordCount,\n\t-- *INF*: IIF(ISNULL(i_HeaderCount),0,i_HeaderCount)\n\tIFF(i_HeaderCount IS NULL, 0, i_HeaderCount) AS v_HeaderCount,\n\t-- *INF*: IIF(ISNULL(i_RecordCount),0,i_RecordCount)\n\tIFF(i_RecordCount IS NULL, 0, i_RecordCount) AS v_RecordCount,\n\tMinTransactionDate AS i_MinTransactionDate,\n\tMaxTransactionDate AS i_MaxTransactionDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_MinTransactionDate), TO_CHAR(SESSSTARTTIME,'YYYYMMDD'),\r\n\t-- TO_CHAR(i_MinTransactionDate,'YYYYMMDD')\r\n\t-- )\n\tDECODE(\n\t    TRUE,\n\t    i_MinTransactionDate IS NULL, TO_CHAR(SESSSTARTTIME, 'YYYYMMDD'),\n\t    TO_CHAR(i_MinTransactionDate, 'YYYYMMDD')\n\t) AS v_MinTransactionDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_MaxTransactionDate),TO_CHAR(SESSSTARTTIME,'YYYYMMDD'),\r\n\t-- TO_CHAR(i_MaxTransactionDate,'YYYYMMDD')\r\n\t-- )\n\tDECODE(\n\t    TRUE,\n\t    i_MaxTransactionDate IS NULL, TO_CHAR(SESSSTARTTIME, 'YYYYMMDD'),\n\t    TO_CHAR(i_MaxTransactionDate, 'YYYYMMDD')\n\t) AS v_MaxTransactionDate,\n\t-- *INF*: lpad('',45,' ')\n\tlpad('', 45, ' ') AS v_LinkData,\n\tv_LinkData AS LinkData,\n\t'99' AS v_RecordTypeCode,\n\tv_RecordTypeCode AS RecordTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- @{pipeline().parameters.FILENAME} = 'NCCI',v_LinkData||v_RecordTypeCode||lpad(to_char(v_RecordCount),10,'0')||lpad(to_char(v_HeaderCount),8,'0')||lpad('',235,' '),\r\n\t--  v_LinkData||v_RecordTypeCode||lpad(to_char(v_RecordCount),10,'0')||lpad(to_char(v_HeaderCount),8,'0')||v_MinTransactionDate||v_MaxTransactionDate||lpad('',219,' ')\r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- -- if NCCI then no min/max date else add min max date and decrease padding at the end\n\tDECODE(\n\t    TRUE,\n\t    @{pipeline().parameters.FILENAME} = 'NCCI', v_LinkData || v_RecordTypeCode || lpad(to_char(v_RecordCount), 10, '0') || lpad(to_char(v_HeaderCount), 8, '0') || lpad('', 235, ' '),\n\t    v_LinkData || v_RecordTypeCode || lpad(to_char(v_RecordCount), 10, '0') || lpad(to_char(v_HeaderCount), 8, '0') || v_MinTransactionDate || v_MaxTransactionDate || lpad('', 219, ' ')\n\t) AS Data,\n\t2 AS Srt\n\tFROM JNR_ForceRecord99\n),\nEXP_ETR AS (\n\tSELECT\n\to_HeaderCount AS IN_RecordCount,\n\t-- *INF*: lpad('',45,' ')\n\tlpad('', 45, ' ') AS o_LinkData,\n\t'00' AS o_RecordTypeCode,\n\t-- *INF*: LPAD('$!+WORKCOMP+!$',14,' ')\n\tLPAD('$!+WORKCOMP+!$', 14, ' ') AS v_Label,\n\t-- *INF*: LPAD('CDXSubmission@WBMI.com',31,' ')\n\tLPAD('CDXSubmission@WBMI.com', 31, ' ') AS v_DataProviderContactEmailAddress,\n\t'  ' AS v_RecordTypeCode,\n\t'WCP' AS v_DataTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- @{pipeline().parameters.FILENAME}='WI','00048',\r\n\t-- @{pipeline().parameters.FILENAME}='MI','00021',\r\n\t-- @{pipeline().parameters.FILENAME}='MN','00022',\r\n\t-- @{pipeline().parameters.FILENAME}='NC','00032',\r\n\t-- LPAD('',5,' ')\r\n\t-- )\n\tDECODE(\n\t    TRUE,\n\t    @{pipeline().parameters.FILENAME} = 'WI', '00048',\n\t    @{pipeline().parameters.FILENAME} = 'MI', '00021',\n\t    @{pipeline().parameters.FILENAME} = 'MN', '00022',\n\t    @{pipeline().parameters.FILENAME} = 'NC', '00032',\n\t    LPAD('', 5, ' ')\n\t) AS v_DataReceiverCode,\n\t-- *INF*: SET_DATE_PART(SYSDATE,'MM',1)\n\tDATEADD(MONTH,1-DATE_PART(MONTH,CURRENT_TIMESTAMP),CURRENT_TIMESTAMP) AS v_Month,\n\t-- *INF*: SET_DATE_PART(v_Month,'DD',1)\n\tDATEADD(DAY,1-DATE_PART(DAY,v_Month),v_Month) AS v_Date,\n\t-- *INF*: SUBSTR(GET_DATE_PART(SYSDATE,'YY'),3,2)||LPAD(DATE_DIFF(SYSDATE,v_Date,'DDD')+1,3,'0')||'V'||@{pipeline().parameters.TRANSMISSION_NUMBER}\n\tSUBSTR(DATE_PART(CURRENT_TIMESTAMP, 'YY'), 3, 2) || LPAD(DATEDIFF(DAY,CURRENT_TIMESTAMP,v_Date) + 1, 3, '0') || 'V' || @{pipeline().parameters.TRANSMISSION_NUMBER} AS v_TransmissionVersionIdentifier,\n\t-- *INF*: LPAD(@{pipeline().parameters.SUBMISSION_TYPE_CODE},1,' ')\r\n\t-- \r\n\t-- --typically will be T for test or S for standard; R used for resubmissions after file rejections\n\tLPAD(@{pipeline().parameters.SUBMISSION_TYPE_CODE}, 1, ' ') AS v_SubmissionTypeCode,\n\t-- *INF*: LPAD(@{pipeline().parameters.SUBMISSION_REPLACEMENT_IDENTIFIER},8,' ')\n\tLPAD(@{pipeline().parameters.SUBMISSION_REPLACEMENT_IDENTIFIER}, 8, ' ') AS v_SubmissionReplacementIdentifier,\n\t'17124' AS v_DataProviderCode,\n\t-- *INF*: LPAD('Sheila Smiley',25,' ')\n\tLPAD('Sheila Smiley', 25, ' ') AS v_NameOfDataProviderContact,\n\t' ' AS v_ReservedForFutureUse,\n\t'2623385152' AS v_PhoneNumber,\n\t-- *INF*: LPAD('',6,' ')\n\tLPAD('', 6, ' ') AS v_PhoneNumberExtension,\n\t-- *INF*: LPAD('',10,' ')\n\tLPAD('', 10, ' ') AS v_FaxNumber,\n\t-- *INF*: TO_CHAR(SYSDATE,'YYYYMMDD')\n\tTO_CHAR(CURRENT_TIMESTAMP, 'YYYYMMDD') AS v_ProcessedDate,\n\t-- *INF*: LPAD('1900 S 18th Avenue',60,' ')\n\tLPAD('1900 S 18th Avenue', 60, ' ') AS v_AddressOfContactStreet,\n\t-- *INF*: LPAD('West Bend',30,' ')\n\tLPAD('West Bend', 30, ' ') AS v_AddressOfContactCity,\n\t'WI' AS v_AddressOfContactState,\n\t-- *INF*: LPAD('53095',9,' ')\n\tLPAD('53095', 9, ' ') AS v_AddressOfContactZipCode,\n\t'C' AS v_DataProviderTypeCode,\n\t-- *INF*: LPAD('',9,' ')\n\tLPAD('', 9, ' ') AS v_ThirdPartyEntityFederalEmployerIdentificationNumber,\n\t' ' AS v_ReservedForFutureUse2,\n\t-- *INF*: LPAD('',101,' ')\n\tLPAD('', 101, ' ') AS v_ReservedForFutureUse3,\n\t-- *INF*: SUBSTR(v_Label||v_DataProviderContactEmailAddress||v_RecordTypeCode||v_DataTypeCode||v_DataReceiverCode||v_TransmissionVersionIdentifier||v_SubmissionTypeCode||v_SubmissionReplacementIdentifier||v_DataProviderCode||v_NameOfDataProviderContact||v_ReservedForFutureUse||v_PhoneNumber||v_PhoneNumberExtension||v_FaxNumber||v_ProcessedDate||v_AddressOfContactStreet||v_AddressOfContactCity||v_AddressOfContactState||v_AddressOfContactZipCode||v_DataProviderTypeCode||v_ThirdPartyEntityFederalEmployerIdentificationNumber||v_ReservedForFutureUse2||v_ReservedForFutureUse3,1,300)\r\n\t-- \r\n\t-- \n\tSUBSTR(v_Label || v_DataProviderContactEmailAddress || v_RecordTypeCode || v_DataTypeCode || v_DataReceiverCode || v_TransmissionVersionIdentifier || v_SubmissionTypeCode || v_SubmissionReplacementIdentifier || v_DataProviderCode || v_NameOfDataProviderContact || v_ReservedForFutureUse || v_PhoneNumber || v_PhoneNumberExtension || v_FaxNumber || v_ProcessedDate || v_AddressOfContactStreet || v_AddressOfContactCity || v_AddressOfContactState || v_AddressOfContactZipCode || v_DataProviderTypeCode || v_ThirdPartyEntityFederalEmployerIdentificationNumber || v_ReservedForFutureUse2 || v_ReservedForFutureUse3, 1, 300) AS o_DATA,\n\t0 AS o_Srt\n\tFROM JNR_ForceRecord99\n),\nFIL_ETR_RECORD AS (\n\tSELECT\n\to_LinkData AS LinkData, \n\to_RecordTypeCode AS RecordTypeCode, \n\to_DATA AS DATA, \n\to_Srt AS Srt\n\tFROM EXP_ETR\n\tWHERE IN(@{pipeline().parameters.FILENAME},'MI','WI','MN','NC')\n),\nU_Data AS (\n\tSELECT LinkData, RecordTypeCode, o_Data AS Data, Srt\n\tFROM EXP_RecordCount\n\tUNION\n\tSELECT LinkData, RecordTypeCode, Data, Srt\n\tFROM EXP_Record99\n\tUNION\n\tSELECT LinkData, RecordTypeCode, DATA AS Data, Srt\n\tFROM FIL_ETR_RECORD\n),\nSRT_Data AS (\n\tSELECT\n\tSrt, \n\tLinkData, \n\tRecordTypeCode, \n\tData\n\tFROM U_Data\n\tORDER BY Srt ASC, LinkData ASC, RecordTypeCode ASC\n),\nEXP_FileName AS (\n\tSELECT\n\tData,\n\t-- *INF*: @{pipeline().parameters.FILENAME_PREFIX}||lpad('21',5,'0')||'_'||to_char(SESSSTARTTIME,'YYYYMMDDHH24MI')||'.'||@{pipeline().parameters.FILE_EXTENSION}\n\t@{pipeline().parameters.FILENAME_PREFIX} || lpad('21', 5, '0') || '_' || to_char(SESSSTARTTIME, 'YYYYMMDDHH24MI') || '.' || @{pipeline().parameters.FILE_EXTENSION} AS v_MI_FileName,\n\t-- *INF*: @{pipeline().parameters.FILENAME_PREFIX}||lpad('48',5,'0')||'_'||to_char(SESSSTARTTIME,'YYYYMMDDHH24MI')||'.'||@{pipeline().parameters.FILE_EXTENSION}\n\t@{pipeline().parameters.FILENAME_PREFIX} || lpad('48', 5, '0') || '_' || to_char(SESSSTARTTIME, 'YYYYMMDDHH24MI') || '.' || @{pipeline().parameters.FILE_EXTENSION} AS v_WI_FileName,\n\t-- *INF*: @{pipeline().parameters.FILENAME_PREFIX}||lpad('22',5,'0')||'_'||to_char(SESSSTARTTIME,'YYYYMMDDHH24MI')||'.'||@{pipeline().parameters.FILE_EXTENSION}\n\t@{pipeline().parameters.FILENAME_PREFIX} || lpad('22', 5, '0') || '_' || to_char(SESSSTARTTIME, 'YYYYMMDDHH24MI') || '.' || @{pipeline().parameters.FILE_EXTENSION} AS v_MN_FileName,\n\t-- *INF*: @{pipeline().parameters.FILENAME_PREFIX}||lpad('32',5,'0')||'_'||to_char(SESSSTARTTIME,'YYYYMMDDHH24MI')||'.'||@{pipeline().parameters.FILE_EXTENSION}\n\t@{pipeline().parameters.FILENAME_PREFIX} || lpad('32', 5, '0') || '_' || to_char(SESSSTARTTIME, 'YYYYMMDDHH24MI') || '.' || @{pipeline().parameters.FILE_EXTENSION} AS v_NC_FileName,\n\t-- *INF*: @{pipeline().parameters.FILENAME_PREFIX}||to_char(SESSSTARTTIME,'MMDDYYYY')||'.'||@{pipeline().parameters.FILE_EXTENSION}\n\t@{pipeline().parameters.FILENAME_PREFIX} || to_char(SESSSTARTTIME, 'MMDDYYYY') || '.' || @{pipeline().parameters.FILE_EXTENSION} AS v_NCCI_FileName,\n\t-- *INF*: Decode(TRUE,\r\n\t-- @{pipeline().parameters.FILENAME}='MI',v_MI_FileName,\r\n\t-- @{pipeline().parameters.FILENAME}='MN',v_MN_FileName,\r\n\t-- @{pipeline().parameters.FILENAME}='WI',v_WI_FileName,\r\n\t-- @{pipeline().parameters.FILENAME}='NC',v_NC_FileName,\r\n\t-- v_NCCI_FileName)\n\tDecode(\n\t    TRUE,\n\t    @{pipeline().parameters.FILENAME} = 'MI', v_MI_FileName,\n\t    @{pipeline().parameters.FILENAME} = 'MN', v_MN_FileName,\n\t    @{pipeline().parameters.FILENAME} = 'WI', v_WI_FileName,\n\t    @{pipeline().parameters.FILENAME} = 'NC', v_NC_FileName,\n\t    v_NCCI_FileName\n\t) AS o_FileName\n\tFROM SRT_Data\n),\nWCPOLS_DataFile AS (\n\tINSERT INTO WCPOLS_DataFile\n\t(Data, FileName)\n\tSELECT \n\tDATA, \n\to_FileName AS FILENAME\n\tFROM EXP_FileName\n),\nEXP_Reconciliation AS (\n\tSELECT\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\t-- *INF*: RPAD(@{pipeline().parameters.FILENAME},10,' ')\n\tRPAD(@{pipeline().parameters.FILENAME}, 10, ' ') AS BureauName,\n\tLinkData,\n\t-- *INF*: SUBSTR(LinkData,6,9)\n\tSUBSTR(LinkData, 6, 9) AS PolicyKey,\n\t-- *INF*: SUBSTR(LinkData,42,2)\n\tSUBSTR(LinkData, 42, 2) AS TransactionCode,\n\tRecordTypeCode,\n\tWCTrackHistoryID\n\tFROM EXP_RecordCount\n),\nFIL_ReconciliationData AS (\n\tSELECT\n\tAuditID, \n\tBureauName, \n\tLinkData, \n\tPolicyKey, \n\tTransactionCode, \n\tRecordTypeCode, \n\tWCTrackHistoryID\n\tFROM EXP_Reconciliation\n\tWHERE IN(RecordTypeCode,'01','08')\n),\nSQ_WorkWCTrackHistory AS (\n\tSelect distinct B.LinkData as LinkData,\r\n\tA.HistoryID as HistoryID,\r\n\tA.WCTrackHistoryID as WCTrackHistoryID\r\n\tfrom WorkWCTrackHistory A\r\n\tinner join WCPols00Record B\r\n\ton A.WCTrackHistoryID=B.WCTrackHistoryID\r\n\tand A.Auditid=B.AuditId\r\n\twhere A.AuditID=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n),\nJNR_ReconciliationData AS (SELECT\n\tSQ_WorkWCTrackHistory.LinkData AS LinkData_TrackHistory, \n\tSQ_WorkWCTrackHistory.HistoryID AS HistoryID_TrackHistory, \n\tSQ_WorkWCTrackHistory.WCTrackHistoryID AS WCTrackHistoryID_TrackHistory, \n\tFIL_ReconciliationData.AuditID, \n\tFIL_ReconciliationData.BureauName, \n\tFIL_ReconciliationData.LinkData, \n\tFIL_ReconciliationData.PolicyKey, \n\tFIL_ReconciliationData.TransactionCode, \n\tFIL_ReconciliationData.RecordTypeCode, \n\tFIL_ReconciliationData.WCTrackHistoryID\n\tFROM SQ_WorkWCTrackHistory\n\tINNER JOIN FIL_ReconciliationData\n\tON FIL_ReconciliationData.LinkData = SQ_WorkWCTrackHistory.LinkData AND FIL_ReconciliationData.WCTrackHistoryID = SQ_WorkWCTrackHistory.WCTrackHistoryID\n),\nAGG_RemoveDuplicates AS (\n\tSELECT\n\tAuditID,\n\tBureauName,\n\tLinkData,\n\tPolicyKey,\n\tTransactionCode,\n\tRecordTypeCode,\n\tHistoryID_TrackHistory AS HistoryID\n\tFROM JNR_ReconciliationData\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY BureauName, PolicyKey, HistoryID ORDER BY NULL) = 1\n),\nEXP_ReconciliationID AS (\n\tSELECT\n\tv_Counter+1 AS v_Counter,\n\tv_Counter AS ReconciliationID,\n\tAuditID,\n\tBureauName,\n\tPolicyKey,\n\tTransactionCode,\n\tHistoryID\n\tFROM AGG_RemoveDuplicates\n),\nWCPOLS_Reconciliation_File AS (\n\tINSERT INTO WCPOLS_Reconciliation_File\n\t(ReconciliationID, AuditID, BureauName, PolicyKey, TransactionType, HistoryID)\n\tSELECT \n\tRECONCILIATIONID, \n\tAUDITID, \n\tBUREAUNAME, \n\tPOLICYKEY, \n\tTransactionCode AS TRANSACTIONTYPE, \n\tHISTORYID\n\tFROM EXP_ReconciliationID\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "FILENAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "RECORD_04_TABLENAMEID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "RECORD_04_TABLENAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "RECORD_08_TABLENAMEID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "RECORD_08_TABLENAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TRANSMISSION_NUMBER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SUBMISSION_TYPE_CODE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SUBMISSION_REPLACEMENT_IDENTIFIER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "FILENAME_PREFIX": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "FILE_EXTENSION": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}