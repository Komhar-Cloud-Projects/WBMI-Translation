WITH
SQ_vehicle AS (
	SELECT
		veh_seq,
		policy_num,
		policy_sym,
		policy_mod,
		policy_mco,
		cov_part_type_code,
		veh_num,
		garage_street,
		garage_city,
		garage_state_type_code,
		garage_zip_type_code,
		garage_county_type_code,
		territory,
		year,
		make,
		model,
		veh_id,
		veh_sym,
		cost_or_stated_amt,
		body_veh_type_code,
		veh_usage_type_code,
		registration_state_type_code,
		num_of_mile_from_work_school,
		num_of_day_veh_use_per_week,
		performance_type_code,
		surcharge_type_code,
		garage_flag,
		total_annual_mileage,
		class,
		cc,
		anti_lock_flag,
		veh_cov_type_code,
		credit_exist_ins_exp_date,
		corp_own_flag,
		four_or_less_flag,
		corp_own_veh_pers_use_flag,
		public_or_livery_convey_flag,
		perm_assign_to_insd_flag,
		corp_own_veh_oper_by_insd_flag,
		used_for_insd_occupation_flag,
		standard_gross_weight_flag,
		custom_type_code,
		camper_type_code,
		custom_built_flag,
		mc_extended_forks_flag,
		compete_flag,
		anti_theft_type_code,
		anti_theft_category,
		window_id_system_flag,
		hood_lock_latching_flag,
		not_sole_own_by_insd_flag,
		exst_damage_flag,
		damage_type_code,
		other_loss_flag,
		kept_at_school_flag,
		street_park_flag,
		tour_cycle_disc_flag,
		visited_status_type_code,
		inside_city_limit_flag,
		mh_used_to_from_work_flag,
		mh_pickup_camper_flag,
		mh_converted_bus_flag,
		rt_perm_park_flag,
		rt_park_over_six_flag,
		add_int_na_flag,
		auto_loan_lease_flag,
		modified_date,
		modified_user_id,
		pif_vehicle_name,
		pif_anti_theft_discount_points,
		endorsement_vehicle_view_code,
		veh_bus_use_descript,
		bus_name_on_title,
		veh_sym_entered,
		cdr_cov_flag,
		prv_titled_flag,
		titled_date,
		anti_theft_flag,
		pif_veh_usage_type_code,
		pif_cdr_cov_flag,
		pif_disc_ctgry,
		pif_vehicle_age,
		veh_modified_flag,
		restoration_complete_flag,
		strokes_code,
		veh_status_type_code,
		snowmobile_hazard_flag,
		pif_auto_loan_lease_flag,
		manually_entered_make_flag,
		manually_entered_model_flag,
		manually_entered_veh_sym_flag,
		pif_num_of_mile_from_work_school,
		veh_sym_override_flag,
		pif_num_of_day_veh_use_per_week,
		pif_total_annual_mileage,
		delete_rsn_type_code,
		delete_rsn_other_descript,
		Pif_veh_cov_type_code,
		pif_anti_theft_category,
		pif_anti_theft_flag,
		leased_flag
	FROM vehicle
),
EXP_VEHICLE AS (
	SELECT
	veh_seq,
	policy_num,
	policy_sym,
	policy_mod,
	policy_mco,
	cov_part_type_code,
	veh_num,
	garage_street,
	garage_city,
	garage_state_type_code,
	garage_zip_type_code,
	garage_county_type_code,
	territory,
	year,
	make,
	model,
	veh_id,
	veh_sym,
	cost_or_stated_amt,
	body_veh_type_code,
	veh_usage_type_code,
	registration_state_type_code,
	num_of_mile_from_work_school,
	num_of_day_veh_use_per_week,
	performance_type_code,
	surcharge_type_code,
	garage_flag,
	total_annual_mileage,
	class,
	cc,
	anti_lock_flag,
	veh_cov_type_code,
	credit_exist_ins_exp_date,
	corp_own_flag,
	four_or_less_flag,
	corp_own_veh_pers_use_flag,
	public_or_livery_convey_flag,
	perm_assign_to_insd_flag,
	corp_own_veh_oper_by_insd_flag,
	used_for_insd_occupation_flag,
	standard_gross_weight_flag,
	custom_type_code,
	camper_type_code,
	custom_built_flag,
	mc_extended_forks_flag,
	compete_flag,
	anti_theft_type_code,
	anti_theft_category,
	window_id_system_flag,
	hood_lock_latching_flag,
	not_sole_own_by_insd_flag,
	exst_damage_flag,
	damage_type_code,
	other_loss_flag,
	kept_at_school_flag,
	street_park_flag,
	tour_cycle_disc_flag,
	visited_status_type_code,
	inside_city_limit_flag,
	mh_used_to_from_work_flag,
	mh_pickup_camper_flag,
	mh_converted_bus_flag,
	rt_perm_park_flag,
	rt_park_over_six_flag,
	add_int_na_flag,
	auto_loan_lease_flag,
	modified_date,
	modified_user_id,
	pif_vehicle_name,
	pif_anti_theft_discount_points,
	endorsement_vehicle_view_code,
	veh_bus_use_descript,
	bus_name_on_title,
	veh_sym_entered,
	cdr_cov_flag,
	titled_date,
	anti_theft_flag,
	pif_veh_usage_type_code,
	pif_cdr_cov_flag,
	pif_disc_ctgry,
	pif_vehicle_age,
	veh_modified_flag,
	restoration_complete_flag,
	strokes_code,
	veh_status_type_code,
	snowmobile_hazard_flag,
	pif_auto_loan_lease_flag,
	manually_entered_make_flag,
	manually_entered_model_flag,
	manually_entered_veh_sym_flag,
	pif_num_of_mile_from_work_school,
	veh_sym_override_flag,
	pif_num_of_day_veh_use_per_week,
	pif_total_annual_mileage,
	delete_rsn_type_code,
	delete_rsn_other_descript,
	Pif_veh_cov_type_code,
	pif_anti_theft_category,
	pif_anti_theft_flag,
	leased_flag,
	SYSDATE AS EXTRACT_DATE,
	SYSDATE AS AS_OF_DATE,
	'' AS RECORD_COUNT,
	@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID
	FROM SQ_vehicle
),
vehicle_plines_stage AS (
	TRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.vehicle_plines_stage;
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.vehicle_plines_stage
	(veh_seq, policy_num, policy_sym, policy_mod, policy_mco, cov_part_type_code, veh_num, garage_street, garage_city, garage_state_type_code, garage_zip_type_code, garage_county_type_code, territory, year, make, model, veh_id, veh_sym, cost_or_stated_amt, body_veh_type_code, veh_usage_type_code, registration_state_type_code, num_of_mile_from_work_school, num_of_day_veh_use_per_week, performance_type_code, surcharge_type_code, garage_flag, total_annual_mileage, class, cc, anti_lock_flag, veh_cov_type_code, credit_exist_ins_exp_date, corp_own_flag, four_or_less_flag, corp_own_veh_pers_use_flag, public_or_livery_convey_flag, perm_assign_to_insd_flag, corp_own_veh_oper_by_insd_flag, used_for_insd_occupation_flag, standard_gross_weight_flag, custom_type_code, camper_type_code, custom_built_flag, mc_extended_forks_flag, compete_flag, anti_theft_type_code, anti_theft_category, window_id_system_flag, hood_lock_latching_flag, not_sole_own_by_insd_flag, exst_damage_flag, damage_type_code, other_loss_flag, kept_at_school_flag, street_park_flag, tour_cycle_disc_flag, visited_status_type_code, inside_city_limit_flag, mh_used_to_from_work_flag, mh_pickup_camper_flag, mh_converted_bus_flag, rt_perm_park_flag, rt_park_over_six_flag, add_int_na_flag, auto_loan_lease_flag, modified_date, modified_user_id, pif_vehicle_name, pif_anti_theft_discount_points, endorsement_vehicle_view_code, veh_bus_use_descript, bus_name_on_title, veh_sym_entered, cdr_cov_flag, titled_date, anti_theft_flag, pif_veh_usage_type_code, pif_cdr_cov_flag, pif_disc_ctgry, pif_vehicle_age, veh_modified_flag, restoration_complete_flag, strokes_code, veh_status_type_code, snowmobile_hazard_flag, pif_auto_loan_lease_flag, manually_entered_make_flag, manually_entered_model_flag, manually_entered_veh_sym_flag, pif_num_of_mile_from_work_school, veh_sym_override_flag, pif_num_of_day_veh_use_per_week, pif_total_annual_mileage, delete_rsn_type_code, delete_rsn_other_descript, Pif_veh_cov_type_code, pif_anti_theft_category, pif_anti_theft_flag, leased_flag, extract_date, as_of_date, record_count, source_system_id)
	SELECT 
	VEH_SEQ, 
	POLICY_NUM, 
	POLICY_SYM, 
	POLICY_MOD, 
	POLICY_MCO, 
	COV_PART_TYPE_CODE, 
	VEH_NUM, 
	GARAGE_STREET, 
	GARAGE_CITY, 
	GARAGE_STATE_TYPE_CODE, 
	GARAGE_ZIP_TYPE_CODE, 
	GARAGE_COUNTY_TYPE_CODE, 
	TERRITORY, 
	YEAR, 
	MAKE, 
	MODEL, 
	VEH_ID, 
	VEH_SYM, 
	COST_OR_STATED_AMT, 
	BODY_VEH_TYPE_CODE, 
	VEH_USAGE_TYPE_CODE, 
	REGISTRATION_STATE_TYPE_CODE, 
	NUM_OF_MILE_FROM_WORK_SCHOOL, 
	NUM_OF_DAY_VEH_USE_PER_WEEK, 
	PERFORMANCE_TYPE_CODE, 
	SURCHARGE_TYPE_CODE, 
	GARAGE_FLAG, 
	TOTAL_ANNUAL_MILEAGE, 
	CLASS, 
	CC, 
	ANTI_LOCK_FLAG, 
	VEH_COV_TYPE_CODE, 
	CREDIT_EXIST_INS_EXP_DATE, 
	CORP_OWN_FLAG, 
	FOUR_OR_LESS_FLAG, 
	CORP_OWN_VEH_PERS_USE_FLAG, 
	PUBLIC_OR_LIVERY_CONVEY_FLAG, 
	PERM_ASSIGN_TO_INSD_FLAG, 
	CORP_OWN_VEH_OPER_BY_INSD_FLAG, 
	USED_FOR_INSD_OCCUPATION_FLAG, 
	STANDARD_GROSS_WEIGHT_FLAG, 
	CUSTOM_TYPE_CODE, 
	CAMPER_TYPE_CODE, 
	CUSTOM_BUILT_FLAG, 
	MC_EXTENDED_FORKS_FLAG, 
	COMPETE_FLAG, 
	ANTI_THEFT_TYPE_CODE, 
	ANTI_THEFT_CATEGORY, 
	WINDOW_ID_SYSTEM_FLAG, 
	HOOD_LOCK_LATCHING_FLAG, 
	NOT_SOLE_OWN_BY_INSD_FLAG, 
	EXST_DAMAGE_FLAG, 
	DAMAGE_TYPE_CODE, 
	OTHER_LOSS_FLAG, 
	KEPT_AT_SCHOOL_FLAG, 
	STREET_PARK_FLAG, 
	TOUR_CYCLE_DISC_FLAG, 
	VISITED_STATUS_TYPE_CODE, 
	INSIDE_CITY_LIMIT_FLAG, 
	MH_USED_TO_FROM_WORK_FLAG, 
	MH_PICKUP_CAMPER_FLAG, 
	MH_CONVERTED_BUS_FLAG, 
	RT_PERM_PARK_FLAG, 
	RT_PARK_OVER_SIX_FLAG, 
	ADD_INT_NA_FLAG, 
	AUTO_LOAN_LEASE_FLAG, 
	MODIFIED_DATE, 
	MODIFIED_USER_ID, 
	PIF_VEHICLE_NAME, 
	PIF_ANTI_THEFT_DISCOUNT_POINTS, 
	ENDORSEMENT_VEHICLE_VIEW_CODE, 
	VEH_BUS_USE_DESCRIPT, 
	BUS_NAME_ON_TITLE, 
	VEH_SYM_ENTERED, 
	CDR_COV_FLAG, 
	TITLED_DATE, 
	ANTI_THEFT_FLAG, 
	PIF_VEH_USAGE_TYPE_CODE, 
	PIF_CDR_COV_FLAG, 
	PIF_DISC_CTGRY, 
	PIF_VEHICLE_AGE, 
	VEH_MODIFIED_FLAG, 
	RESTORATION_COMPLETE_FLAG, 
	STROKES_CODE, 
	VEH_STATUS_TYPE_CODE, 
	SNOWMOBILE_HAZARD_FLAG, 
	PIF_AUTO_LOAN_LEASE_FLAG, 
	MANUALLY_ENTERED_MAKE_FLAG, 
	MANUALLY_ENTERED_MODEL_FLAG, 
	MANUALLY_ENTERED_VEH_SYM_FLAG, 
	PIF_NUM_OF_MILE_FROM_WORK_SCHOOL, 
	VEH_SYM_OVERRIDE_FLAG, 
	PIF_NUM_OF_DAY_VEH_USE_PER_WEEK, 
	PIF_TOTAL_ANNUAL_MILEAGE, 
	DELETE_RSN_TYPE_CODE, 
	DELETE_RSN_OTHER_DESCRIPT, 
	PIF_VEH_COV_TYPE_CODE, 
	PIF_ANTI_THEFT_CATEGORY, 
	PIF_ANTI_THEFT_FLAG, 
	LEASED_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID
	FROM EXP_VEHICLE
),