{
    "name": "s_m_FEED_Load_ISS_Extract_File_Auto_RemoveDupOnsetOffset",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_ISS_Extract_File_Auto_RemoveDupOnsetOffset",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_ISSCA_Loss AS (\n\t--Select Loss Records ASIS\r\n\tSELECT ISSCommercialAutoExtract.ISSCommercialAutoExtractID, ISSCommercialAutoExtract.AuditId, ISSCommercialAutoExtract.CreatedDate, ISSCommercialAutoExtract.EDWPremiumMasterCalculationPKId, ISSCommercialAutoExtract.EDWLossMasterCalculationPKId, ISSCommercialAutoExtract.TypeBureauCode, ISSCommercialAutoExtract.BureauLineOfInsurance, ISSCommercialAutoExtract.BureauCompanyNumber, ISSCommercialAutoExtract.StateProvinceCode, ISSCommercialAutoExtract.PremiumMasterRunDate, ISSCommercialAutoExtract.LossMasterRunDate, ISSCommercialAutoExtract.PolicyKey, ISSCommercialAutoExtract.PremiumMasterClassCode, ISSCommercialAutoExtract.LossMasterClassCode, ISSCommercialAutoExtract.ClaimNumber, ISSCommercialAutoExtract.ClaimantNumber, ISSCommercialAutoExtract.RiskTerritoryCode, ISSCommercialAutoExtract.PolicyEffectiveDate, ISSCommercialAutoExtract.CauseOfLoss, ISSCommercialAutoExtract.DeductibleAmount, ISSCommercialAutoExtract.CoverageCode, ISSCommercialAutoExtract.SublineCode, ISSCommercialAutoExtract.PackageModificationAdjustmentGroupDescription, ISSCommercialAutoExtract.PremiumMasterDirectWrittenPremiumAmount, ISSCommercialAutoExtract.PaidLossAmount, ISSCommercialAutoExtract.OutstandingLossAmount, ISSCommercialAutoExtract.PolicyExpirationDate, ISSCommercialAutoExtract.InceptionToDatePaidLossAmount, ISSCommercialAutoExtract.ClaimantCoverageDetailId, ISSCommercialAutoExtract.AnnualStatementLineNumber, ISSCommercialAutoExtract.ZipPostalCode, ISSCommercialAutoExtract.DeductibleIndicatorCode, ISSCommercialAutoExtract.PolicyLowerLimit, ISSCommercialAutoExtract.PolicyUpperLimit, ISSCommercialAutoExtract.TerminalZoneCode, ISSCommercialAutoExtract.WrittenExposure, ISSCommercialAutoExtract.PaidAllocatedLossAdjustmentExpenseAmount, ISSCommercialAutoExtract.OutstandingAllocatedLossAdjustmentExpenseAmount, ISSCommercialAutoExtract.ClaimLossDate, ISSCommercialAutoExtract.TransactionEffectiveDate, ISSCommercialAutoExtract.CoverageGroupCode, ISSCommercialAutoExtract.VehicleNumber, ISSCommercialAutoExtract.IncludeUIM,\r\n\tISSCommercialAutoExtract.RatingZoneCode\r\n\tFROM\r\n\t ISSCommercialAutoExtract\r\n\tWHERE ISSCommercialAutoExtract.EDWLossMasterCalculationPKId<>-1\r\n\t @{pipeline().parameters.WHERE_CLAUSE_LOSS}\n),\nEXP_Loss AS (\n\tSELECT\n\tISSCommercialAutoExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM SQ_ISSCA_Loss\n),\nSQ_ISSCA_PremiumUnique AS (\n\tWITH prem_unique\r\n\tAS\r\n\t(SELECT\r\n\t\t\tCONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PolicyKey, PremiumMasterClassCode,\r\n\t\t\tClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode,\r\n\t\t\tPackageModificationAdjustmentGroupDescription,\r\n\t\t\tPolicyExpirationDate, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit,\r\n\t\t\tPolicyUpperLimit, TerminalZoneCode, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM, RatingZoneCode) AS concct\r\n\t\t\t,COUNT(*) count\r\n\t\tFROM ISSCommercialAutoExtract\r\n\t\tWHERE EDWPremiumMasterCalculationPKId <> -1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\r\n\t\tGROUP BY CONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PolicyKey, PremiumMasterClassCode,\r\n\t\tClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode,\r\n\t\tPackageModificationAdjustmentGroupDescription,\r\n\t\tPolicyExpirationDate, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit,\r\n\t\tPolicyUpperLimit, TerminalZoneCode, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM, RatingZoneCode)\r\n\t\tHAVING COUNT(*) = 1)\r\n\t\r\n\tSELECT DISTINCT\r\n\t\tISSCommercialAutoExtract.ISSCommercialAutoExtractID\r\n\t\t,ISSCommercialAutoExtract.AuditId\r\n\t\t,ISSCommercialAutoExtract.CreatedDate\r\n\t\t,ISSCommercialAutoExtract.EDWPremiumMasterCalculationPKId\r\n\t\t,ISSCommercialAutoExtract.EDWLossMasterCalculationPKId\r\n\t\t,ISSCommercialAutoExtract.TypeBureauCode\r\n\t\t,ISSCommercialAutoExtract.BureauLineOfInsurance\r\n\t\t,ISSCommercialAutoExtract.BureauCompanyNumber\r\n\t\t,ISSCommercialAutoExtract.StateProvinceCode\r\n\t\t,ISSCommercialAutoExtract.PremiumMasterRunDate\r\n\t\t,ISSCommercialAutoExtract.LossMasterRunDate\r\n\t\t,ISSCommercialAutoExtract.PolicyKey\r\n\t\t,ISSCommercialAutoExtract.PremiumMasterClassCode\r\n\t\t,ISSCommercialAutoExtract.LossMasterClassCode\r\n\t\t,ISSCommercialAutoExtract.ClaimNumber\r\n\t\t,ISSCommercialAutoExtract.ClaimantNumber\r\n\t\t,ISSCommercialAutoExtract.RiskTerritoryCode\r\n\t\t,ISSCommercialAutoExtract.PolicyEffectiveDate\r\n\t\t,ISSCommercialAutoExtract.CauseOfLoss\r\n\t\t,ISSCommercialAutoExtract.DeductibleAmount\r\n\t\t,ISSCommercialAutoExtract.CoverageCode\r\n\t\t,ISSCommercialAutoExtract.SublineCode\r\n\t\t,ISSCommercialAutoExtract.PackageModificationAdjustmentGroupDescription\r\n\t\t,ISSCommercialAutoExtract.PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,ISSCommercialAutoExtract.PaidLossAmount\r\n\t\t,ISSCommercialAutoExtract.OutstandingLossAmount\r\n\t\t,ISSCommercialAutoExtract.PolicyExpirationDate\r\n\t\t,ISSCommercialAutoExtract.InceptionToDatePaidLossAmount\r\n\t\t,ISSCommercialAutoExtract.ClaimantCoverageDetailId\r\n\t\t,ISSCommercialAutoExtract.AnnualStatementLineNumber\r\n\t\t,ISSCommercialAutoExtract.ZipPostalCode\r\n\t\t,ISSCommercialAutoExtract.DeductibleIndicatorCode\r\n\t\t,ISSCommercialAutoExtract.PolicyLowerLimit\r\n\t\t,ISSCommercialAutoExtract.PolicyUpperLimit\r\n\t\t,ISSCommercialAutoExtract.TerminalZoneCode\r\n\t\t,ISSCommercialAutoExtract.WrittenExposure\r\n\t\t,ISSCommercialAutoExtract.PaidAllocatedLossAdjustmentExpenseAmount\r\n\t\t,ISSCommercialAutoExtract.OutstandingAllocatedLossAdjustmentExpenseAmount\r\n\t\t,ISSCommercialAutoExtract.ClaimLossDate\r\n\t\t,ISSCommercialAutoExtract.TransactionEffectiveDate\r\n\t\t,ISSCommercialAutoExtract.CoverageGroupCode\r\n\t\t,ISSCommercialAutoExtract.VehicleNumber\r\n\t\t,ISSCommercialAutoExtract.IncludeUIM\r\n\t\t,ISSCommercialAutoExtract.RatingZoneCode\r\n\tFROM ISSCommercialAutoExtract\r\n\tJOIN prem_unique b\r\n\t\tON (CONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PolicyKey, PremiumMasterClassCode,\r\n\t\t\tClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode,\r\n\t\t\tPackageModificationAdjustmentGroupDescription,\r\n\t\t\tPolicyExpirationDate, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit,\r\n\t\t\tPolicyUpperLimit, TerminalZoneCode, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM, RatingZoneCode) = b.concct)\r\n\tWHERE ISSCommercialAutoExtract.EDWPremiumMasterCalculationPKId <> -1\r\n\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\n),\nEXP_PremiumUnique AS (\n\tSELECT\n\tISSCommercialAutoExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM SQ_ISSCA_PremiumUnique\n),\nSQ_ISSCA_Premium_Dup AS (\n\tWITH ROLLUP_TABLE_TEMP\r\n\tAS\r\n\t(SELECT\r\n\t\t\tSUM(PremiumMasterDirectWrittenPremiumAmount) ROLL_UP_DWP_AMT\r\n\t\t\t,MAX(ISSCommercialAutoExtractID) MAX_ISS_KEY\r\n\t\tFROM ISSCommercialAutoExtract\r\n\t\tWHERE EDWPremiumMasterCalculationPKId <> -1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\r\n\t\tGROUP BY CONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PolicyKey, PremiumMasterClassCode,\r\n\t\tClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode,\r\n\t\tPackageModificationAdjustmentGroupDescription,\r\n\t\tPolicyExpirationDate, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit,\r\n\t\tPolicyUpperLimit, TerminalZoneCode, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber,IncludeUIM, RatingZoneCode)\r\n\t\tHAVING COUNT(1) > 1\r\n\t\tAND SUM(PremiumMasterDirectWrittenPremiumAmount) <> 0\r\n\t)\r\n\t\r\n\tSELECT\r\n\t\tISSCommercialAutoExtract.ISSCommercialAutoExtractID\r\n\t\t,ISSCommercialAutoExtract.AuditId\r\n\t\t,ISSCommercialAutoExtract.CreatedDate\r\n\t\t,ISSCommercialAutoExtract.EDWPremiumMasterCalculationPKId\r\n\t\t,ISSCommercialAutoExtract.EDWLossMasterCalculationPKId\r\n\t\t,ISSCommercialAutoExtract.TypeBureauCode\r\n\t\t,ISSCommercialAutoExtract.BureauLineOfInsurance\r\n\t\t,ISSCommercialAutoExtract.BureauCompanyNumber\r\n\t\t,ISSCommercialAutoExtract.StateProvinceCode\r\n\t\t,ISSCommercialAutoExtract.PremiumMasterRunDate\r\n\t\t,ISSCommercialAutoExtract.LossMasterRunDate\r\n\t\t,ISSCommercialAutoExtract.PolicyKey\r\n\t\t,ISSCommercialAutoExtract.PremiumMasterClassCode\r\n\t\t,ISSCommercialAutoExtract.LossMasterClassCode\r\n\t\t,ISSCommercialAutoExtract.ClaimNumber\r\n\t\t,ISSCommercialAutoExtract.ClaimantNumber\r\n\t\t,ISSCommercialAutoExtract.RiskTerritoryCode\r\n\t\t,ISSCommercialAutoExtract.PolicyEffectiveDate\r\n\t\t,ISSCommercialAutoExtract.CauseOfLoss\r\n\t\t,ISSCommercialAutoExtract.DeductibleAmount\r\n\t\t,ISSCommercialAutoExtract.CoverageCode\r\n\t\t,ISSCommercialAutoExtract.SublineCode\r\n\t\t,ISSCommercialAutoExtract.PackageModificationAdjustmentGroupDescription\r\n\t\t,ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT AS PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,ISSCommercialAutoExtract.PaidLossAmount\r\n\t\t,ISSCommercialAutoExtract.OutstandingLossAmount\r\n\t\t,ISSCommercialAutoExtract.PolicyExpirationDate\r\n\t\t,ISSCommercialAutoExtract.InceptionToDatePaidLossAmount\r\n\t\t,ISSCommercialAutoExtract.ClaimantCoverageDetailId\r\n\t\t,ISSCommercialAutoExtract.AnnualStatementLineNumber\r\n\t\t,ISSCommercialAutoExtract.ZipPostalCode\r\n\t\t,ISSCommercialAutoExtract.DeductibleIndicatorCode\r\n\t\t,ISSCommercialAutoExtract.PolicyLowerLimit\r\n\t\t,ISSCommercialAutoExtract.PolicyUpperLimit\r\n\t\t,ISSCommercialAutoExtract.TerminalZoneCode\r\n\t\t,ISSCommercialAutoExtract.WrittenExposure\r\n\t\t,ISSCommercialAutoExtract.PaidAllocatedLossAdjustmentExpenseAmount\r\n\t\t,ISSCommercialAutoExtract.OutstandingAllocatedLossAdjustmentExpenseAmount\r\n\t\t,ISSCommercialAutoExtract.ClaimLossDate\r\n\t\t,ISSCommercialAutoExtract.TransactionEffectiveDate\r\n\t\t,ISSCommercialAutoExtract.CoverageGroupCode\r\n\t\t,ISSCommercialAutoExtract.VehicleNumber\r\n\t\t,ISSCommercialAutoExtract.IncludeUIM\r\n\t\t,ISSCommercialAutoExtract.RatingZoneCode\r\n\tFROM ROLLUP_TABLE_TEMP\r\n\tINNER JOIN ISSCommercialAutoExtract\r\n\t\tON ISSCommercialAutoExtractId = ROLLUP_TABLE_TEMP.MAX_ISS_KEY\n),\nEXP_Premium_Dup AS (\n\tSELECT\n\tISSCommercialAutoExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM SQ_ISSCA_Premium_Dup\n),\nUnion AS (\n\tSELECT ISSCommercialAutoExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit, PolicyUpperLimit, RatingZoneCode, TerminalZoneCode, WrittenExposure, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM\n\tFROM EXP_PremiumUnique\n\tUNION\n\tSELECT ISSCommercialAutoExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit, PolicyUpperLimit, RatingZoneCode, TerminalZoneCode, WrittenExposure, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM\n\tFROM EXP_Loss\n\tUNION\n\tSELECT ISSCommercialAutoExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit, PolicyUpperLimit, RatingZoneCode, TerminalZoneCode, WrittenExposure, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM\n\tFROM EXP_Premium_Dup\n),\nEXP_Get_Values AS (\n\tSELECT\n\tISSCommercialAutoExtractId AS WorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM Union\n),\nRTR_CL_PL AS (\n\tSELECT\n\tWorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tVehicleModelYear,\n\tDefensiveDriverCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM EXP_Get_Values\n),\nRTR_CL_PL_CL AS (SELECT * FROM RTR_CL_PL WHERE IN(TypeBureauCode,'AL','AN','AP','N/A','CommercialAuto')),\nRTR_CL_PL_PL AS (SELECT * FROM RTR_CL_PL WHERE IN(TypeBureauCode,'RL','RN','RP')),\nEXP_Target_PL AS (\n\tSELECT\n\t-- *INF*: TRUNC(SYSDATE,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_Auto_PL_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_Auto_PL_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\tWorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tVehicleModelYear,\n\tDefensiveDriverCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM RTR_CL_PL_PL\n),\nSRT_ISSFlatFILE_Auto_PL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tDeductibleAmount, \n\tCoverageCode, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailId, \n\tAnnualStatementLineNumber, \n\tZipPostalCode, \n\tDeductibleIndicatorCode, \n\tPolicyLowerLimit, \n\tPolicyUpperLimit, \n\tRatingZoneCode, \n\tTerminalZoneCode, \n\tWrittenExposure, \n\tPaidAllocatedLossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tClaimLossDate, \n\tTransactionEffectiveDate, \n\tCoverageGroupCode, \n\tVehicleNumber, \n\tIncludeUIM\n\tFROM EXP_Target_PL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, CoverageCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_Auto_PL AS (\n\tINSERT INTO ISSFlatFile_Auto\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit, PolicyUpperLimit, RatingZoneCode, TerminalZoneCode, WrittenExposure, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tDEDUCTIBLEAMOUNT, \n\tCOVERAGECODE, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tZIPPOSTALCODE, \n\tDEDUCTIBLEINDICATORCODE, \n\tPOLICYLOWERLIMIT, \n\tPOLICYUPPERLIMIT, \n\tRATINGZONECODE, \n\tTERMINALZONECODE, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tCLAIMLOSSDATE, \n\tTRANSACTIONEFFECTIVEDATE, \n\tCOVERAGEGROUPCODE, \n\tVEHICLENUMBER, \n\tINCLUDEUIM\n\tFROM SRT_ISSFlatFILE_Auto_PL\n),\nEXP_Target_CL AS (\n\tSELECT\n\t-- *INF*: TRUNC(SYSDATE,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_Auto_CL_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_Auto_CL_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\tWorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tZipPostalCode,\n\tDeductibleIndicatorCode,\n\tVehicleModelYear,\n\tDefensiveDriverCode,\n\tPolicyLowerLimit,\n\tPolicyUpperLimit,\n\tRatingZoneCode,\n\tTerminalZoneCode,\n\tWrittenExposure,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimLossDate,\n\tTransactionEffectiveDate,\n\tCoverageGroupCode,\n\tVehicleNumber,\n\tIncludeUIM\n\tFROM RTR_CL_PL_CL\n),\nSRT_ISSFlatFile_Auto_CL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tDeductibleAmount, \n\tCoverageCode, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailId, \n\tAnnualStatementLineNumber, \n\tZipPostalCode, \n\tDeductibleIndicatorCode, \n\tPolicyLowerLimit, \n\tPolicyUpperLimit, \n\tRatingZoneCode, \n\tTerminalZoneCode, \n\tWrittenExposure, \n\tPaidAllocatedLossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tClaimLossDate, \n\tTransactionEffectiveDate, \n\tCoverageGroupCode, \n\tVehicleNumber, \n\tIncludeUIM\n\tFROM EXP_Target_CL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, CoverageCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_Auto_CL AS (\n\tINSERT INTO ISSFlatFile_Auto\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, ZipPostalCode, DeductibleIndicatorCode, PolicyLowerLimit, PolicyUpperLimit, RatingZoneCode, TerminalZoneCode, WrittenExposure, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ClaimLossDate, TransactionEffectiveDate, CoverageGroupCode, VehicleNumber, IncludeUIM)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tDEDUCTIBLEAMOUNT, \n\tCOVERAGECODE, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tZIPPOSTALCODE, \n\tDEDUCTIBLEINDICATORCODE, \n\tPOLICYLOWERLIMIT, \n\tPOLICYUPPERLIMIT, \n\tRATINGZONECODE, \n\tTERMINALZONECODE, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tCLAIMLOSSDATE, \n\tTRANSACTIONEFFECTIVEDATE, \n\tCOVERAGEGROUPCODE, \n\tVEHICLENUMBER, \n\tINCLUDEUIM\n\tFROM SRT_ISSFlatFile_Auto_CL\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WHERE_CLAUSE_LOSS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_PREMIUM": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}