{
    "name": "m_CMN_DM_Load_InsuranceReferenceCoverageDim",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_DM_Load_InsuranceReferenceCoverageDim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CoverageSummary AS (\n\tSELECT SC.InsuranceLineCode InsuranceLineCode\r\n\t,SC.InsuranceLineDescription InsuranceLineDescription\r\n\t,CC.CoverageCode CoverageCode\r\n\t,CC.CoverageDescription CoverageDescription\r\n\t,CG.CoverageGroupCode CoverageGroupCode\r\n\t,CG.CoverageGroupDescription CoverageGroupDescription\r\n\t,CS.CoverageSummaryCode CoverageSummaryCode\r\n\t,CS.CoverageSummaryDescription CoverageSummaryDescription\r\n\t,SC.DctRiskTypeCode DctRiskTypeCode\r\n\t,SC.DctCoverageTypeCode DctCoverageTypeCode\r\n\t,SC.PmsRiskUnitGroupCode PmsRiskUnitGroupCode\r\n\t,SC.PmsRiskUnitGroupDescription PmsRiskUnitGroupDescription\r\n\t,SC.PmsRiskUnitCode PmsRiskUnitCode\r\n\t,SC.PmsRiskUnitDescription PmsRiskUnitDescription\r\n\t,SC.PmsMajorPerilCode PmsMajorPerilCode\r\n\t,SC.PmsMajorPerilDescription PmsMajorPerilDescription\r\n\t,SC.PmsProductTypeCode PmsProductTypeCode\r\n\t,SC.DctPerilGroup DctPerilGroup\r\n\t,SC.DctSubCoverageTypeCode DctSubCoverageTypeCode\r\n\t,SC.DctCoverageVersion DctCoverageVersion\r\n\t,SC.LossHistoryCode\r\n\t,SC.LossHistoryDescription\r\n\t,SC.ISOMajorCrimeGroup\r\n\t,CC.RatedCoverageCode RatedCoverageCode \r\n\t,CC.RatedCoverageDescription RatedCoverageDescription \r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageSummary CS\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageGroup CG\r\n\tON CS.CoverageSummaryId=CG.CoverageSummaryId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.ConformedCoverage CC\r\n\tON CG.CoverageGroupId=CC.CoverageGroupId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.SystemCoverage SC\r\n\tON CC.ConformedCoverageId=SC.ConformedCoverageId\n),\nLKP_InsuranceReferenceCoverageDim AS (\n\tSELECT\n\tInsuranceReferenceCoverageDimId,\n\tCoverageGroupCode,\n\tCoverageSummaryCode,\n\tCoverageGroupDescription,\n\tCoverageSummaryDescription,\n\tCoverageCode,\n\tCoverageDescription,\n\tInsuranceLineDescription,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilDescription,\n\tLossHistoryCode,\n\tLossHistoryDescription,\n\tISOMajorCrimeGroup,\n\tRatedCoverageCode,\n\tRatedCoverageDescription,\n\tInsuranceLineCode,\n\tDctCoverageTypeCode,\n\tDctSubCoverageTypeCode,\n\tDctRiskTypeCode,\n\tDctPerilGroup,\n\tDctCoverageVersion,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitCode,\n\tPmsMajorPerilCode,\n\tPmsProductTypeCode\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceReferenceCoverageDimId,\n\t\t\tCoverageGroupCode,\n\t\t\tCoverageSummaryCode,\n\t\t\tCoverageGroupDescription,\n\t\t\tCoverageSummaryDescription,\n\t\t\tCoverageCode,\n\t\t\tCoverageDescription,\n\t\t\tInsuranceLineDescription,\n\t\t\tPmsRiskUnitGroupDescription,\n\t\t\tPmsRiskUnitDescription,\n\t\t\tPmsMajorPerilDescription,\n\t\t\tLossHistoryCode,\n\t\t\tLossHistoryDescription,\n\t\t\tISOMajorCrimeGroup,\n\t\t\tRatedCoverageCode,\n\t\t\tRatedCoverageDescription,\n\t\t\tInsuranceLineCode,\n\t\t\tDctCoverageTypeCode,\n\t\t\tDctSubCoverageTypeCode,\n\t\t\tDctRiskTypeCode,\n\t\t\tDctPerilGroup,\n\t\t\tDctCoverageVersion,\n\t\t\tPmsRiskUnitGroupCode,\n\t\t\tPmsRiskUnitCode,\n\t\t\tPmsMajorPerilCode,\n\t\t\tPmsProductTypeCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceLineCode,DctCoverageTypeCode,DctSubCoverageTypeCode,DctRiskTypeCode,DctPerilGroup,DctCoverageVersion,PmsRiskUnitGroupCode,PmsRiskUnitCode,PmsMajorPerilCode,PmsProductTypeCode ORDER BY InsuranceReferenceCoverageDimId) = 1\n),\nEXP_Detect_Changes_Add_MetaData AS (\n\tSELECT\n\tLKP_InsuranceReferenceCoverageDim.InsuranceReferenceCoverageDimId AS lkp_InsuranceReferenceCoverageDimId,\n\tLKP_InsuranceReferenceCoverageDim.CoverageGroupCode AS lkp_CoverageGroupCode,\n\tLKP_InsuranceReferenceCoverageDim.CoverageSummaryCode AS lkp_CoverageSummaryCode,\n\tLKP_InsuranceReferenceCoverageDim.CoverageGroupDescription AS lkp_CoverageGroupDescription,\n\tLKP_InsuranceReferenceCoverageDim.CoverageSummaryDescription AS lkp_CoverageSummaryDescription,\n\tLKP_InsuranceReferenceCoverageDim.CoverageCode AS lkp_CoverageCode,\n\tLKP_InsuranceReferenceCoverageDim.CoverageDescription AS lkp_CoverageDescription,\n\tLKP_InsuranceReferenceCoverageDim.InsuranceLineDescription AS lkp_InsuranceLineDescription,\n\tLKP_InsuranceReferenceCoverageDim.PmsRiskUnitGroupDescription AS lkp_PmsRiskUnitGroupDescription,\n\tLKP_InsuranceReferenceCoverageDim.PmsRiskUnitDescription AS lkp_PmsRiskUnitDescription,\n\tLKP_InsuranceReferenceCoverageDim.PmsMajorPerilDescription AS lkp_PmsMajorPerilDescription,\n\tLKP_InsuranceReferenceCoverageDim.LossHistoryCode AS lkp_LossHistoryCode,\n\tLKP_InsuranceReferenceCoverageDim.LossHistoryDescription AS lkp_LossHistoryDescription,\n\tLKP_InsuranceReferenceCoverageDim.ISOMajorCrimeGroup AS lkp_ISOMajorCrimeGroup,\n\tLKP_InsuranceReferenceCoverageDim.RatedCoverageCode AS lkp_RatedCoverageCode,\n\tLKP_InsuranceReferenceCoverageDim.RatedCoverageDescription AS lkp_RatedCoverageDescription,\n\tSQ_CoverageSummary.InsuranceLineCode AS i_InsuranceLineCode,\n\tSQ_CoverageSummary.InsuranceLineDescription AS i_InsuranceLineDescription,\n\tSQ_CoverageSummary.CoverageCode AS i_CoverageCode,\n\tSQ_CoverageSummary.CoverageDescription AS i_CoverageDescription,\n\tSQ_CoverageSummary.CoverageGroupCode AS i_CoverageGroupCode,\n\tSQ_CoverageSummary.CoverageGroupDescription AS i_CoverageGroupDescription,\n\tSQ_CoverageSummary.CoverageSummaryCode AS i_CoverageSummaryCode,\n\tSQ_CoverageSummary.CoverageSummaryDescription AS i_CoverageSummaryDescription,\n\tSQ_CoverageSummary.DctRiskTypeCode AS i_DctRiskTypeCode,\n\tSQ_CoverageSummary.DctCoverageTypeCode AS i_DctCoverageTypeCode,\n\tSQ_CoverageSummary.PmsRiskUnitGroupCode AS i_PmsRiskUnitGroupCode,\n\tSQ_CoverageSummary.PmsRiskUnitGroupDescription AS i_PmsRiskUnitGroupDescription,\n\tSQ_CoverageSummary.PmsRiskUnitCode AS i_PmsRiskUnitCode,\n\tSQ_CoverageSummary.PmsRiskUnitDescription AS i_PmsRiskUnitDescription,\n\tSQ_CoverageSummary.PmsMajorPerilCode AS i_PmsMajorPerilCode,\n\tSQ_CoverageSummary.PmsMajorPerilDescription AS i_PmsMajorPerilDescription,\n\tSQ_CoverageSummary.PmsProductTypeCode AS i_PmsProductTypeCode,\n\tSQ_CoverageSummary.DctPerilGroup AS i_DctPerilGroup,\n\tSQ_CoverageSummary.DctSubCoverageTypeCode AS i_DctSubCoverageTypeCode,\n\tSQ_CoverageSummary.DctCoverageVersion AS i_DctCoverageVersion,\n\tSQ_CoverageSummary.LossHistoryCode AS i_LossHistoryCode,\n\tSQ_CoverageSummary.LossHistoryDescription AS i_LossHistoryDescription,\n\tSQ_CoverageSummary.ISOMajorCrimeGroup AS i_ISOMajorCrimeGroup,\n\tSQ_CoverageSummary.RatedCoverageCode AS i_RatedCoverageCode,\n\tSQ_CoverageSummary.RatedCoverageDescription AS i_RatedCoverageDescription,\n\tlkp_InsuranceReferenceCoverageDimId AS o_InsuranceReferenceCoverageDimId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditID,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\ti_InsuranceLineCode AS o_InsuranceLineCode,\n\ti_InsuranceLineDescription AS o_InsuranceLineDescription,\n\ti_CoverageCode AS o_CoverageCode,\n\ti_CoverageDescription AS o_CoverageDescription,\n\ti_CoverageGroupCode AS o_CoverageGroupCode,\n\ti_CoverageGroupDescription AS o_CoverageGroupDescription,\n\ti_CoverageSummaryCode AS o_CoverageSummaryCode,\n\ti_CoverageSummaryDescription AS o_CoverageSummaryDescription,\n\ti_DctRiskTypeCode AS o_DctRiskTypeCode,\n\ti_DctCoverageTypeCode AS o_DctCoverageTypeCode,\n\ti_PmsRiskUnitGroupCode AS o_PmsRiskUnitGroupCode,\n\ti_PmsRiskUnitGroupDescription AS o_PmsRiskUnitGroupDescription,\n\ti_PmsRiskUnitCode AS o_PmsRiskUnitCode,\n\ti_PmsRiskUnitDescription AS o_PmsRiskUnitDescription,\n\ti_PmsMajorPerilCode AS o_PmsMajorPerilCode,\n\ti_PmsMajorPerilDescription AS o_PmsMajorPerilDescription,\n\ti_PmsProductTypeCode AS o_PmsProductTypeCode,\n\ti_DctPerilGroup AS o_DctPerilGroup,\n\ti_DctSubCoverageTypeCode AS o_DctSubCoverageTypeCode,\n\ti_DctCoverageVersion AS o_DctCoverageVersion,\n\ti_LossHistoryCode AS o_LossHistoryCode,\n\ti_LossHistoryDescription AS o_LossHistoryDescription,\n\t-- *INF*: IIF(ISNULL(i_ISOMajorCrimeGroup)OR IS_SPACES(i_ISOMajorCrimeGroup)OR LENGTH(i_ISOMajorCrimeGroup)=0,'N/A',LTRIM(RTRIM(i_ISOMajorCrimeGroup)))\n\tIFF(i_ISOMajorCrimeGroup IS NULL OR IS_SPACES(i_ISOMajorCrimeGroup) OR LENGTH(i_ISOMajorCrimeGroup) = 0, 'N/A', LTRIM(RTRIM(i_ISOMajorCrimeGroup))) AS o_ISOMajorCrimeGroup,\n\ti_RatedCoverageCode AS o_RatedCoverageCode,\n\ti_RatedCoverageDescription AS o_RatedCoverageDescription,\n\t-- *INF*: Decode(TRUE,\r\n\t-- IsNull(lkp_InsuranceReferenceCoverageDimId), 'Insert', \r\n\t-- lkp_CoverageCode=i_CoverageCode\r\n\t-- AND lkp_CoverageGroupCode=i_CoverageGroupCode\r\n\t-- AND lkp_CoverageSummaryCode=i_CoverageSummaryCode\r\n\t-- AND lkp_InsuranceLineDescription=i_InsuranceLineDescription\r\n\t-- AND lkp_CoverageDescription=i_CoverageDescription\r\n\t-- AND lkp_CoverageGroupDescription=i_CoverageGroupDescription\r\n\t-- AND lkp_CoverageSummaryDescription=i_CoverageSummaryDescription\r\n\t-- AND lkp_PmsRiskUnitGroupDescription=i_PmsRiskUnitGroupDescription\r\n\t-- AND lkp_PmsRiskUnitDescription=i_PmsRiskUnitDescription\r\n\t-- AND lkp_PmsMajorPerilDescription=i_PmsMajorPerilDescription\r\n\t-- AND lkp_LossHistoryCode=i_LossHistoryCode\r\n\t-- AND lkp_LossHistoryDescription=i_LossHistoryDescription\r\n\t-- AND lkp_ISOMajorCrimeGroup=i_ISOMajorCrimeGroup \r\n\t-- AND lkp_RatedCoverageCode=i_RatedCoverageCode\r\n\t-- AND lkp_RatedCoverageDescription=i_RatedCoverageDescription\r\n\t-- ,'Ignore','Update')\n\tDecode(TRUE,\n\tlkp_InsuranceReferenceCoverageDimId IS NULL, 'Insert',\n\tlkp_CoverageCode = i_CoverageCode AND lkp_CoverageGroupCode = i_CoverageGroupCode AND lkp_CoverageSummaryCode = i_CoverageSummaryCode AND lkp_InsuranceLineDescription = i_InsuranceLineDescription AND lkp_CoverageDescription = i_CoverageDescription AND lkp_CoverageGroupDescription = i_CoverageGroupDescription AND lkp_CoverageSummaryDescription = i_CoverageSummaryDescription AND lkp_PmsRiskUnitGroupDescription = i_PmsRiskUnitGroupDescription AND lkp_PmsRiskUnitDescription = i_PmsRiskUnitDescription AND lkp_PmsMajorPerilDescription = i_PmsMajorPerilDescription AND lkp_LossHistoryCode = i_LossHistoryCode AND lkp_LossHistoryDescription = i_LossHistoryDescription AND lkp_ISOMajorCrimeGroup = i_ISOMajorCrimeGroup AND lkp_RatedCoverageCode = i_RatedCoverageCode AND lkp_RatedCoverageDescription = i_RatedCoverageDescription, 'Ignore',\n\t'Update') AS o_InsertUpdateOrIgnore\n\tFROM SQ_CoverageSummary\n\tLEFT JOIN LKP_InsuranceReferenceCoverageDim\n\tON LKP_InsuranceReferenceCoverageDim.InsuranceLineCode = SQ_CoverageSummary.InsuranceLineCode AND LKP_InsuranceReferenceCoverageDim.DctCoverageTypeCode = SQ_CoverageSummary.DctCoverageTypeCode AND LKP_InsuranceReferenceCoverageDim.DctSubCoverageTypeCode = SQ_CoverageSummary.DctSubCoverageTypeCode AND LKP_InsuranceReferenceCoverageDim.DctRiskTypeCode = SQ_CoverageSummary.DctRiskTypeCode AND LKP_InsuranceReferenceCoverageDim.DctPerilGroup = SQ_CoverageSummary.DctPerilGroup AND LKP_InsuranceReferenceCoverageDim.DctCoverageVersion = SQ_CoverageSummary.DctCoverageVersion AND LKP_InsuranceReferenceCoverageDim.PmsRiskUnitGroupCode = SQ_CoverageSummary.PmsRiskUnitGroupCode AND LKP_InsuranceReferenceCoverageDim.PmsRiskUnitCode = SQ_CoverageSummary.PmsRiskUnitCode AND LKP_InsuranceReferenceCoverageDim.PmsMajorPerilCode = SQ_CoverageSummary.PmsMajorPerilCode AND LKP_InsuranceReferenceCoverageDim.PmsProductTypeCode = SQ_CoverageSummary.PmsProductTypeCode\n),\nRTR_Classify_Insert_Update AS (\n\tSELECT\n\to_InsuranceReferenceCoverageDimId AS InsuranceReferenceCoverageDimId,\n\to_AuditID AS AuditID,\n\to_CreatedDate AS CreatedDate,\n\to_ModifiedDate AS ModifiedDate,\n\to_InsuranceLineCode AS InsuranceLineCode,\n\to_InsuranceLineDescription AS InsuranceLineDescription,\n\to_CoverageCode AS CoverageCode,\n\to_CoverageDescription AS CoverageDescription,\n\to_CoverageGroupCode AS CoverageGroupCode,\n\to_CoverageGroupDescription AS CoverageGroupDescription,\n\to_CoverageSummaryCode AS CoverageSummaryCode,\n\to_CoverageSummaryDescription AS CoverageSummaryDescription,\n\to_DctRiskTypeCode AS DctRiskTypeCode,\n\to_DctCoverageTypeCode AS DctCoverageTypeCode,\n\to_PmsRiskUnitGroupCode AS PmsRiskUnitGroupCode,\n\to_PmsRiskUnitGroupDescription AS PmsRiskUnitGroupDescription,\n\to_PmsRiskUnitCode AS PmsRiskUnitCode,\n\to_PmsRiskUnitDescription AS PmsRiskUnitDescription,\n\to_PmsMajorPerilCode AS PmsMajorPerilCode,\n\to_PmsMajorPerilDescription AS PmsMajorPerilDescription,\n\to_PmsProductTypeCode AS PmsProductTypeCode,\n\to_DctPerilGroup AS DctPerilGroup,\n\to_DctSubCoverageTypeCode AS DctSubCoverageTypeCode,\n\to_DctCoverageVersion AS DctCoverageVersion,\n\to_LossHistoryCode AS LossHistoryCode,\n\to_LossHistoryDescription AS LossHistoryDescription,\n\to_ISOMajorCrimeGroup AS ISOMajorCrimeGroup,\n\to_RatedCoverageCode AS RatedCoverageCode,\n\to_RatedCoverageDescription AS RatedCoverageDescription,\n\to_InsertUpdateOrIgnore AS InsertUpdateOrIgnore\n\tFROM EXP_Detect_Changes_Add_MetaData\n),\nRTR_Classify_Insert_Update_INSERT AS (SELECT * FROM RTR_Classify_Insert_Update WHERE InsertUpdateOrIgnore='Insert'),\nRTR_Classify_Insert_Update_UPDATE AS (SELECT * FROM RTR_Classify_Insert_Update WHERE InsertUpdateOrIgnore='Update'),\nUPD_InsuranceReferenceCoverageDim_Insert AS (\n\tSELECT\n\tAuditID AS AuditId, \n\tCreatedDate AS CreateDate, \n\tModifiedDate AS ModifedDate, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup AS ISOMajorCrimeGroup1, \n\tRatedCoverageCode, \n\tRatedCoverageDescription\n\tFROM RTR_Classify_Insert_Update_INSERT\n),\nInsuranceReferenceCoverageDim_Insert AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim\n\t(AuditId, CreateDate, ModifedDate, InsuranceLineCode, InsuranceLineDescription, CoverageCode, CoverageDescription, CoverageGroupCode, CoverageGroupDescription, CoverageSummaryCode, CoverageSummaryDescription, DctRiskTypeCode, DctCoverageTypeCode, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, DctPerilGroup, PmsProductTypeCode, DctSubCoverageTypeCode, DctCoverageVersion, LossHistoryCode, LossHistoryDescription, ISOMajorCrimeGroup, RatedCoverageCode, RatedCoverageDescription)\n\tSELECT \n\tAUDITID, \n\tCREATEDATE, \n\tMODIFEDDATE, \n\tINSURANCELINECODE, \n\tINSURANCELINEDESCRIPTION, \n\tCOVERAGECODE, \n\tCOVERAGEDESCRIPTION, \n\tCOVERAGEGROUPCODE, \n\tCOVERAGEGROUPDESCRIPTION, \n\tCOVERAGESUMMARYCODE, \n\tCOVERAGESUMMARYDESCRIPTION, \n\tDCTRISKTYPECODE, \n\tDCTCOVERAGETYPECODE, \n\tPMSRISKUNITGROUPCODE, \n\tPMSRISKUNITGROUPDESCRIPTION, \n\tPMSRISKUNITCODE, \n\tPMSRISKUNITDESCRIPTION, \n\tPMSMAJORPERILCODE, \n\tPMSMAJORPERILDESCRIPTION, \n\tDCTPERILGROUP, \n\tPMSPRODUCTTYPECODE, \n\tDCTSUBCOVERAGETYPECODE, \n\tDCTCOVERAGEVERSION, \n\tLOSSHISTORYCODE, \n\tLOSSHISTORYDESCRIPTION, \n\tISOMajorCrimeGroup1 AS ISOMAJORCRIMEGROUP, \n\tRATEDCOVERAGECODE, \n\tRATEDCOVERAGEDESCRIPTION\n\tFROM UPD_InsuranceReferenceCoverageDim_Insert\n),\nUPD_InsuranceReferenceCoverageDim_Update AS (\n\tSELECT\n\tInsuranceReferenceCoverageDimId, \n\tAuditID AS AuditId, \n\tModifiedDate AS ModifedDate, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup AS ISOMajorCrimeGroup3, \n\tRatedCoverageCode, \n\tRatedCoverageDescription\n\tFROM RTR_Classify_Insert_Update_UPDATE\n),\nInsuranceReferenceCoverageDim_Update AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim AS T\n\tUSING UPD_InsuranceReferenceCoverageDim_Update AS S\n\tON T.InsuranceReferenceCoverageDimId = S.InsuranceReferenceCoverageDimId\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.AuditId = S.AuditId, T.ModifedDate = S.ModifedDate, T.InsuranceLineCode = S.InsuranceLineCode, T.InsuranceLineDescription = S.InsuranceLineDescription, T.CoverageCode = S.CoverageCode, T.CoverageDescription = S.CoverageDescription, T.CoverageGroupCode = S.CoverageGroupCode, T.CoverageGroupDescription = S.CoverageGroupDescription, T.CoverageSummaryCode = S.CoverageSummaryCode, T.CoverageSummaryDescription = S.CoverageSummaryDescription, T.DctRiskTypeCode = S.DctRiskTypeCode, T.DctCoverageTypeCode = S.DctCoverageTypeCode, T.PmsRiskUnitGroupCode = S.PmsRiskUnitGroupCode, T.PmsRiskUnitGroupDescription = S.PmsRiskUnitGroupDescription, T.PmsRiskUnitCode = S.PmsRiskUnitCode, T.PmsRiskUnitDescription = S.PmsRiskUnitDescription, T.PmsMajorPerilCode = S.PmsMajorPerilCode, T.PmsMajorPerilDescription = S.PmsMajorPerilDescription, T.DctPerilGroup = S.DctPerilGroup, T.PmsProductTypeCode = S.PmsProductTypeCode, T.DctSubCoverageTypeCode = S.DctSubCoverageTypeCode, T.DctCoverageVersion = S.DctCoverageVersion, T.LossHistoryCode = S.LossHistoryCode, T.LossHistoryDescription = S.LossHistoryDescription, T.ISOMajorCrimeGroup = S.ISOMajorCrimeGroup3, T.RatedCoverageCode = S.RatedCoverageCode, T.RatedCoverageDescription = S.RatedCoverageDescription\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246503"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905513"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604113"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 01:14:33"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 01:30:27"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_DATA_MART_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            }
        },
        "folder": {
            "name": "Common DataMart/"
        },
        "annotations": []
    }
}