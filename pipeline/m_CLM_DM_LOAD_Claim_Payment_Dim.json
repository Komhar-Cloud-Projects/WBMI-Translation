{
    "name": "m_CLM_DM_LOAD_Claim_Payment_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Payment_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Claim_Party_Occurrence_Payment AS (\n\tSELECT\n\tclaim_party_occurrence_ak_id,\n\tclaim_pay_ak_id,\n\tpayee_type\n\tFROM (\n\t\tSELECT \r\n\t\ta.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id\r\n\t\t, a.claim_pay_ak_id as claim_pay_ak_id\r\n\t\t, a.payee_type as payee_type \r\n\t\tFROM claim_party_occurrence_payment a\r\n\t\twhere a.payee_type IN ('P','N/A')\r\n\t\tand a.crrnt_snpsht_flag = 1\r\n\t\t\r\n\t\t-- 'P' FOR EXCEED AND 'N/A' FOR PMS\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,payee_type ORDER BY claim_party_occurrence_ak_id) = 1\n),\nLKP_Claim_Party_Occurrence AS (\n\tSELECT\n\tclaim_party_role_code,\n\tclaim_party_occurrence_ak_id\n\tFROM (\n\t\tSELECT \r\n\t\ta.claim_party_role_code as claim_party_role_code\r\n\t\t, a.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id \r\n\t\tFROM claim_party_occurrence a\r\n\t\twhere crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id ORDER BY claim_party_role_code) = 1\n),\nSQ_claim_payment AS (\n\tSELECT DISTINCT\r\n\tCPA.claim_pay_id\r\n\t, CPA.claim_pay_ak_id\r\n\t, CPA.claim_pay_num\r\n\t, CPA.micro_ecd_draft_num\r\n\t, CPA.bank_acct_num\r\n\t, CPA.pay_delete_ind\r\n\t, CPA.total_pay_amt\r\n\t, CPA.pay_issued_date\r\n\t, CPA.pay_cashed_date\r\n\t, CPA.pay_to_code\r\n\t, CPA.payee_note\r\n\t, CPA.pay_ind\r\n\t, CPA.pay_type_code\r\n\t, CPA.pay_entry_oper_id\r\n\t, CPA.pay_entry_oper_role_code\r\n\t, CPA.pay_disbursement_date\r\n\t, CPA.pay_disbursement_status\r\n\t, CPA.pay_disbursement_loc_code\r\n\t, CPA.reported_to_irs_ind\r\n\t, CPA.pay_voided_date\r\n\t, CPA.pay_reposted_date\r\n\t, CPA.new_claim_num\r\n\t, CPA.new_draft_num\r\n\t, CPA.payee_phrase_code\r\n\t, CPA.pay_to_the_order_of_name\r\n\t, CPA.memo_phrase_code\r\n\t, CPA.memo_phrase_comment\r\n\t, CPA.mail_to_code\r\n\t, CPA.mail_to_name\r\n\t, CPA.mail_to_addr\r\n\t, CPA.mail_to_city\r\n\t, CPA.mail_to_state\r\n\t, CPA.mail_to_zip\r\n\t, CPA.source_sys_id\r\n\t, CPA.prim_payee_name\r\n\t, CPA.add_payee_name1\r\n\t, CPA.add_payee_name2\r\n\t, CPA.add_payee_name3\r\n\t, CPA.add_payee_name4\r\n\t, CPA.add_payee_name5\r\n\t, CPA.add_payee_name6\r\n\t, CP.claim_party_addr\r\n\t, CP.claim_party_city\r\n\t, CP.claim_party_county\r\n\t, CP.claim_party_state\r\n\t, CP.claim_party_zip\r\n\t, CP.addr_type\r\n\t, CP.tax_ssn_id\r\n\t, CP.tax_fed_id\r\n\t, CPA.eff_from_date\r\n\t, CPOP.claim_party_occurrence_pay_id\r\n\t, CPOP.PAYEE_TYPE\r\n\t, CPOP.PAYEE_CODE\r\n\t, CPOP.CLAIM_PAYEE_SEQ_NUM\r\n\t, CPA.sup_payment_system_id\r\n\t, CPA.sup_payment_method_id \r\n\t, CPA.approval_status\r\n\t, CPA.approval_by_user_id\r\n\t, CPA.approval_date\r\n\t, CPA.denial_reason\r\n\t, CPA.special_processing\r\n\t, CPA.payee_category\r\n\t, CPA.sup_claim_payment_workflow_id\r\n\t,CPA.attached_document_count\r\n\tFROM claim_payment CPA\r\n\tinner join claim_party_occurrence_payment CPOP with (nolock) on CPOP.claim_pay_ak_id = CPA.claim_pay_ak_id \r\n\t\tand CPOP.crrnt_snpsht_flag = 1 and CPOP.payee_type <> 'A'\t\r\n\tinner join claim_party_occurrence CPO with (nolock) on CPO.claim_party_occurrence_ak_id = CPOP.claim_party_occurrence_ak_id \r\n\t\tand CPO.crrnt_snpsht_flag = 1\r\n\tinner join claim_party CP with (nolock) on CP.claim_party_ak_id = CPO.claim_party_ak_id \r\n\t\tand CP.crrnt_snpsht_flag = 1\r\n\tinner join claim_occurrence CO with (nolock) on CPO.claim_occurrence_ak_id = CO.claim_occurrence_ak_id \r\n\t\tand CO.crrnt_snpsht_flag = 1\r\n\twhere (\r\n\t\tCPA.MODIFIED_DATE >=  '@{pipeline().parameters.SELECTION_START_TS}' or\r\n\t\tCP.MODIFIED_DATE >=  '@{pipeline().parameters.SELECTION_START_TS}' or\r\n\t\tCPOP.MODIFIED_DATE >=  '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t)\n),\nEXP_get_values AS (\n\tSELECT\n\tclaim_pay_id,\n\tclaim_pay_ak_id,\n\tclaim_pay_num,\n\tmicro_ecd_draft_num,\n\tbank_acct_num,\n\tpay_delete_ind,\n\ttotal_pay_amt,\n\tpay_issued_date,\n\tpay_cashed_date,\n\tpay_to_code AS IN_pay_to_code,\n\t-- *INF*: IIF(ISNULL(IN_pay_to_code) OR LENGTH(LTRIM(RTRIM(IN_pay_to_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_to_code)) )\n\tIFF(IN_pay_to_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_pay_to_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_to_code))) AS pay_to_code,\n\tpayee_note,\n\tpay_ind,\n\tpay_type_code AS IN_pay_type_code,\n\t-- *INF*: IIF(ISNULL(IN_pay_type_code) OR LENGTH(LTRIM(RTRIM(IN_pay_type_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_type_code)) )\n\tIFF(IN_pay_type_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_pay_type_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_type_code))) AS pay_type_code,\n\tpay_entry_oper_id,\n\tpay_entry_oper_role_code AS IN_pay_entry_oper_role_code,\n\t-- *INF*: IIF(ISNULL(IN_pay_entry_oper_role_code) OR LENGTH(LTRIM(RTRIM(IN_pay_entry_oper_role_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_entry_oper_role_code)) )\n\tIFF(IN_pay_entry_oper_role_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_pay_entry_oper_role_code))) = 0, 'N/A', LTRIM(RTRIM(IN_pay_entry_oper_role_code))) AS pay_entry_oper_role_code,\n\tpay_disbursement_date,\n\tpay_disbursement_status,\n\tpay_disbursement_loc_code,\n\treported_to_irs_ind,\n\tpay_voided_date,\n\tpay_reposted_date,\n\tnew_claim_num,\n\tnew_draft_num,\n\tpayee_phrase_code AS IN_payee_phrase_code,\n\t-- *INF*: IIF(ISNULL(IN_payee_phrase_code) OR LENGTH(LTRIM(RTRIM(IN_payee_phrase_code))) = 0, 'N/A', LTRIM(RTRIM(IN_payee_phrase_code)) )\n\tIFF(IN_payee_phrase_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_payee_phrase_code))) = 0, 'N/A', LTRIM(RTRIM(IN_payee_phrase_code))) AS payee_phrase_code,\n\tpay_to_the_order_of_name,\n\tmemo_phrase_code AS IN_memo_phrase_code,\n\t-- *INF*: IIF(ISNULL(IN_memo_phrase_code) OR LENGTH(LTRIM(RTRIM(IN_memo_phrase_code))) = 0, 'N/A', LTRIM(RTRIM(IN_memo_phrase_code)) )\n\tIFF(IN_memo_phrase_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_memo_phrase_code))) = 0, 'N/A', LTRIM(RTRIM(IN_memo_phrase_code))) AS memo_phrase_code,\n\tmemo_phrase_comment,\n\tmail_to_code AS IN_mail_to_code,\n\t-- *INF*: IIF(ISNULL(IN_mail_to_code) OR LENGTH(LTRIM(RTRIM(IN_mail_to_code))) = 0, 'N/A', LTRIM(RTRIM(IN_mail_to_code)) )\n\tIFF(IN_mail_to_code IS NULL OR LENGTH(LTRIM(RTRIM(IN_mail_to_code))) = 0, 'N/A', LTRIM(RTRIM(IN_mail_to_code))) AS mail_to_code,\n\tmail_to_name,\n\tmail_to_addr,\n\tmail_to_city,\n\tmail_to_state,\n\tmail_to_zip,\n\tsource_sys_id,\n\t-- *INF*: DECODE(source_sys_id\r\n\t--     , 'EXCEED', 'P'\r\n\t--     , 'DCT', 'P'\r\n\t-- -- otherwise default to\r\n\t--     , 'N/A'\r\n\t-- )\r\n\t-- \r\n\t-- -- was IIF(source_sys_id = 'EXCEED', 'P', 'N/A')\n\tDECODE(source_sys_id,\n\t'EXCEED', 'P',\n\t'DCT', 'P',\n\t'N/A') AS v_payee_type,\n\tv_payee_type AS payee_type,\n\tprim_payee_name,\n\tadd_payee_name1,\n\tadd_payee_name2,\n\tadd_payee_name3,\n\tadd_payee_name4,\n\tadd_payee_name5,\n\tadd_payee_name6,\n\t-- *INF*: :LKP.LKP_CLAIM_PARTY_OCCURRENCE(:LKP.LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT(claim_pay_ak_id,v_payee_type))\n\tLKP_CLAIM_PARTY_OCCURRENCE_LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type.claim_party_role_code AS claim_party_role_code,\n\t-- *INF*: iif(isnull(claim_party_role_code)\r\n\t-- ,'N/A'\r\n\t-- ,claim_party_role_code)\n\tIFF(claim_party_role_code IS NULL, 'N/A', claim_party_role_code) AS o_claim_party_role_code,\n\tclaim_party_addr,\n\tclaim_party_city,\n\tclaim_party_county,\n\tclaim_party_state,\n\tclaim_party_zip,\n\taddr_type,\n\ttax_ssn_id,\n\ttax_fed_id,\n\t-- *INF*: IIF(tax_ssn_id = 'N/A',tax_fed_id,tax_ssn_id)\n\tIFF(tax_ssn_id = 'N/A', tax_fed_id, tax_ssn_id) AS Tax_id,\n\teff_from_date2,\n\tclaim_party_occurrence_pay_id,\n\tpayee_type AS payee_type1,\n\tpayee_code,\n\tclaim_payee_seq_num,\n\tsup_payment_system_id,\n\tsup_payment_method_id,\n\tapproval_status,\n\tapproval_by_user_id,\n\tapproval_date,\n\tdenial_reason,\n\tspecial_processing,\n\tpayee_category,\n\tsup_claim_payment_workflow_id,\n\tattached_document_count\n\tFROM SQ_claim_payment\n\tLEFT JOIN LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type\n\tON LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type.claim_pay_ak_id = claim_pay_ak_id\n\tAND LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type.payee_type = v_payee_type\n\n\tLEFT JOIN LKP_CLAIM_PARTY_OCCURRENCE LKP_CLAIM_PARTY_OCCURRENCE_LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type\n\tON LKP_CLAIM_PARTY_OCCURRENCE_LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type.claim_party_occurrence_ak_id = LKP_CLAIM_PARTY_OCCURRENCE_PAYMENT_claim_pay_ak_id_v_payee_type.claim_party_occurrence_ak_id\n\n),\nLKP_Pay_disbursement_status_description AS (\n\tSELECT\n\tpay_disbursement_status_descript,\n\tpay_disbursement_status\n\tFROM (\n\t\tSELECT \n\t\t\tpay_disbursement_status_descript,\n\t\t\tpay_disbursement_status\n\t\tFROM sup_claim_payment_disbursement_status\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pay_disbursement_status ORDER BY pay_disbursement_status_descript) = 1\n),\nLKP_sup_claim_mail_to_code AS (\n\tSELECT\n\tmail_to_code_descript,\n\tmail_to_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_mail_to_code.mail_to_code_descript)) as mail_to_code_descript, LTRIM(RTRIM(sup_claim_mail_to_code.mail_to_code)) as mail_to_code\r\n\t\t FROM sup_claim_mail_to_code\r\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY mail_to_code ORDER BY mail_to_code_descript) = 1\n),\nLKP_sup_claim_memo_phrase AS (\n\tSELECT\n\tmemo_phrase_descript,\n\tmemo_phrase_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_memo_phrase.memo_phrase_descript)) as memo_phrase_descript, LTRIM(RTRIM(sup_claim_memo_phrase.memo_phrase_code)) as memo_phrase_code \r\n\t\tFROM sup_claim_memo_phrase\r\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY memo_phrase_code ORDER BY memo_phrase_descript) = 1\n),\nLKP_sup_claim_party_role_code_desc AS (\n\tSELECT\n\tclaim_party_role_descript,\n\tclaim_party_role_code\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_party_role_descript,\n\t\t\tclaim_party_role_code\n\t\tFROM sup_claim_party_role_code\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_role_code ORDER BY claim_party_role_descript) = 1\n),\nLKP_sup_claim_payee_phrase AS (\n\tSELECT\n\tpayee_phrase_descript,\n\tpayee_phrase_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_payee_phrase.payee_phrase_descript)) as payee_phrase_descript, LTRIM(RTRIM(sup_claim_payee_phrase.payee_phrase_code)) as payee_phrase_code \r\n\t\tFROM sup_claim_payee_phrase\r\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY payee_phrase_code ORDER BY payee_phrase_descript) = 1\n),\nLKP_sup_claim_payment_entry_operator_role_code AS (\n\tSELECT\n\tpay_entry_oper_role_code_descript,\n\tpay_entry_oper_role_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_payment_entry_operator_role_code.pay_entry_oper_role_code_descript)) as pay_entry_oper_role_code_descript, LTRIM(RTRIM(sup_claim_payment_entry_operator_role_code.pay_entry_oper_role_code)) as pay_entry_oper_role_code FROM sup_claim_payment_entry_operator_role_code\r\n\t\twhere crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pay_entry_oper_role_code ORDER BY pay_entry_oper_role_code_descript) = 1\n),\nLKP_sup_claim_payment_type_code AS (\n\tSELECT\n\tpay_type_code_descript,\n\tpay_type_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_payment_type_code.pay_type_code_descript)) as pay_type_code_descript, \r\n\t\tLTRIM(RTRIM(sup_claim_payment_type_code.pay_type_code)) as pay_type_code FROM sup_claim_payment_type_code\r\n\t\twhere crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pay_type_code ORDER BY pay_type_code_descript) = 1\n),\nLKP_sup_claim_payment_workflow AS (\n\tSELECT\n\tpayment_workflow,\n\tsup_claim_payment_workflow_id\n\tFROM (\n\t\tSELECT \n\t\t\tpayment_workflow,\n\t\t\tsup_claim_payment_workflow_id\n\t\tFROM sup_claim_payment_workflow\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_claim_payment_workflow_id ORDER BY payment_workflow) = 1\n),\nLKP_sup_pay_to_code AS (\n\tSELECT\n\tpay_to_code_descript,\n\tpay_to_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_pay_to_code.pay_to_code_descript)) as pay_to_code_descript, LTRIM(RTRIM(sup_claim_pay_to_code.pay_to_code)) as pay_to_code \r\n\t\tFROM sup_claim_pay_to_code\r\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pay_to_code ORDER BY pay_to_code_descript) = 1\n),\nLKP_sup_payment_method AS (\n\tSELECT\n\tpayment_method,\n\tsup_payment_method_id\n\tFROM (\n\t\tSELECT \n\t\t\tpayment_method,\n\t\t\tsup_payment_method_id\n\t\tFROM sup_payment_method\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_payment_method_id ORDER BY payment_method) = 1\n),\nLKP_sup_payment_system AS (\n\tSELECT\n\tpayment_system,\n\tsup_payment_system_id\n\tFROM (\n\t\tSELECT \n\t\t\tpayment_system,\n\t\t\tsup_payment_system_id\n\t\tFROM sup_payment_system\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY sup_payment_system_id ORDER BY payment_system) = 1\n),\nEXP_get_descriptions AS (\n\tSELECT\n\tEXP_get_values.claim_pay_id,\n\tEXP_get_values.claim_party_occurrence_pay_id,\n\tEXP_get_values.claim_pay_ak_id,\n\tEXP_get_values.claim_pay_num,\n\tEXP_get_values.micro_ecd_draft_num,\n\tEXP_get_values.bank_acct_num,\n\tEXP_get_values.pay_delete_ind,\n\tEXP_get_values.total_pay_amt,\n\tEXP_get_values.pay_issued_date,\n\tEXP_get_values.pay_cashed_date,\n\tEXP_get_values.pay_to_code,\n\tLKP_sup_pay_to_code.pay_to_code_descript AS IN_pay_to_code_descript,\n\t-- *INF*: IIF(ISNULL(IN_pay_to_code_descript), 'N/A', IN_pay_to_code_descript)\n\tIFF(IN_pay_to_code_descript IS NULL, 'N/A', IN_pay_to_code_descript) AS pay_to_code_descript,\n\tEXP_get_values.payee_note,\n\tEXP_get_values.pay_ind,\n\tEXP_get_values.pay_type_code,\n\tLKP_sup_claim_payment_type_code.pay_type_code_descript AS IN_pay_type_code_descript,\n\t-- *INF*: IIF(ISNULL(IN_pay_type_code_descript), 'N/A', IN_pay_type_code_descript)\n\tIFF(IN_pay_type_code_descript IS NULL, 'N/A', IN_pay_type_code_descript) AS pay_type_code_descript,\n\tEXP_get_values.pay_entry_oper_id,\n\tEXP_get_values.pay_entry_oper_role_code,\n\tLKP_sup_claim_payment_entry_operator_role_code.pay_entry_oper_role_code_descript AS IN_pay_entry_oper_role_code_descript,\n\t-- *INF*: IIF(ISNULL(IN_pay_entry_oper_role_code_descript), 'N/A', IN_pay_entry_oper_role_code_descript)\n\tIFF(IN_pay_entry_oper_role_code_descript IS NULL, 'N/A', IN_pay_entry_oper_role_code_descript) AS pay_entry_oper_role_code_descript,\n\tEXP_get_values.pay_disbursement_date,\n\tEXP_get_values.pay_disbursement_status,\n\tLKP_Pay_disbursement_status_description.pay_disbursement_status_descript,\n\t-- *INF*: iif(isnull(pay_disbursement_status_descript),'N/A',pay_disbursement_status_descript)\n\tIFF(pay_disbursement_status_descript IS NULL, 'N/A', pay_disbursement_status_descript) AS o_pay_disbursement_status_descript,\n\tEXP_get_values.pay_disbursement_loc_code,\n\tEXP_get_values.reported_to_irs_ind,\n\tEXP_get_values.pay_voided_date,\n\tEXP_get_values.pay_reposted_date,\n\tEXP_get_values.new_claim_num,\n\tEXP_get_values.new_draft_num,\n\tEXP_get_values.payee_phrase_code,\n\tLKP_sup_claim_payee_phrase.payee_phrase_descript AS IN_payee_phrase_descript,\n\t-- *INF*: IIF(ISNULL(IN_payee_phrase_descript), 'N/A', IN_payee_phrase_descript)\n\tIFF(IN_payee_phrase_descript IS NULL, 'N/A', IN_payee_phrase_descript) AS payee_phrase_descript,\n\tEXP_get_values.pay_to_the_order_of_name,\n\tEXP_get_values.memo_phrase_code,\n\tLKP_sup_claim_memo_phrase.memo_phrase_descript AS IN_memo_phrase_descript,\n\t-- *INF*: IIF(ISNULL(IN_memo_phrase_descript), 'N/A', IN_memo_phrase_descript)\n\tIFF(IN_memo_phrase_descript IS NULL, 'N/A', IN_memo_phrase_descript) AS memo_phrase_descript,\n\tEXP_get_values.memo_phrase_comment,\n\tEXP_get_values.mail_to_code,\n\tLKP_sup_claim_mail_to_code.mail_to_code_descript AS IN_mail_to_code_descript,\n\t-- *INF*: IIF(ISNULL(IN_mail_to_code_descript), 'N/A', IN_mail_to_code_descript)\n\tIFF(IN_mail_to_code_descript IS NULL, 'N/A', IN_mail_to_code_descript) AS mail_to_code_descript,\n\tEXP_get_values.mail_to_name,\n\tEXP_get_values.mail_to_addr,\n\tEXP_get_values.mail_to_city,\n\tEXP_get_values.mail_to_state,\n\tEXP_get_values.mail_to_zip,\n\tEXP_get_values.payee_type1 AS payee_type,\n\tEXP_get_values.claim_payee_seq_num,\n\tEXP_get_values.payee_code,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tEXP_get_values.eff_from_date2 AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\tEXP_get_values.prim_payee_name,\n\tEXP_get_values.add_payee_name1,\n\tEXP_get_values.add_payee_name2,\n\tEXP_get_values.add_payee_name3,\n\tEXP_get_values.add_payee_name4,\n\tEXP_get_values.add_payee_name5,\n\tEXP_get_values.add_payee_name6,\n\tEXP_get_values.o_claim_party_role_code AS claim_party_role_code,\n\tLKP_sup_claim_party_role_code_desc.claim_party_role_descript,\n\t-- *INF*: iif(isnull(claim_party_role_descript)\r\n\t-- ,'N/A'\r\n\t-- ,claim_party_role_descript)\n\tIFF(claim_party_role_descript IS NULL, 'N/A', claim_party_role_descript) AS claim_party_role_descript_out,\n\tEXP_get_values.claim_party_addr,\n\tEXP_get_values.claim_party_city,\n\tEXP_get_values.claim_party_county,\n\tEXP_get_values.claim_party_state,\n\tEXP_get_values.claim_party_zip,\n\tEXP_get_values.addr_type,\n\tEXP_get_values.Tax_id AS tax_ssn_id,\n\tLKP_sup_payment_system.payment_system AS in_payment_system,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_system)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_system) AS o_payment_system,\n\tLKP_sup_payment_method.payment_method AS in_payment_method,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_method)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_method) AS o_payment_method,\n\tEXP_get_values.approval_status,\n\tEXP_get_values.approval_by_user_id,\n\tEXP_get_values.approval_date,\n\tEXP_get_values.denial_reason,\n\tEXP_get_values.special_processing,\n\tEXP_get_values.payee_category,\n\tLKP_sup_claim_payment_workflow.payment_workflow AS in_payment_workflow,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_workflow)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_payment_workflow) AS o_payment_workflow,\n\tEXP_get_values.attached_document_count,\n\t-- *INF*: iif(isnull(attached_document_count),0,attached_document_count)\n\tIFF(attached_document_count IS NULL, 0, attached_document_count) AS o_attached_document_count\n\tFROM EXP_get_values\n\tLEFT JOIN LKP_Pay_disbursement_status_description\n\tON LKP_Pay_disbursement_status_description.pay_disbursement_status = EXP_get_values.pay_disbursement_status\n\tLEFT JOIN LKP_sup_claim_mail_to_code\n\tON LKP_sup_claim_mail_to_code.mail_to_code = EXP_get_values.mail_to_code\n\tLEFT JOIN LKP_sup_claim_memo_phrase\n\tON LKP_sup_claim_memo_phrase.memo_phrase_code = EXP_get_values.memo_phrase_code\n\tLEFT JOIN LKP_sup_claim_party_role_code_desc\n\tON LKP_sup_claim_party_role_code_desc.claim_party_role_code = EXP_get_values.o_claim_party_role_code\n\tLEFT JOIN LKP_sup_claim_payee_phrase\n\tON LKP_sup_claim_payee_phrase.payee_phrase_code = EXP_get_values.payee_phrase_code\n\tLEFT JOIN LKP_sup_claim_payment_entry_operator_role_code\n\tON LKP_sup_claim_payment_entry_operator_role_code.pay_entry_oper_role_code = EXP_get_values.pay_entry_oper_role_code\n\tLEFT JOIN LKP_sup_claim_payment_type_code\n\tON LKP_sup_claim_payment_type_code.pay_type_code = EXP_get_values.pay_type_code\n\tLEFT JOIN LKP_sup_claim_payment_workflow\n\tON LKP_sup_claim_payment_workflow.sup_claim_payment_workflow_id = EXP_get_values.sup_claim_payment_workflow_id\n\tLEFT JOIN LKP_sup_pay_to_code\n\tON LKP_sup_pay_to_code.pay_to_code = EXP_get_values.pay_to_code\n\tLEFT JOIN LKP_sup_payment_method\n\tON LKP_sup_payment_method.sup_payment_method_id = EXP_get_values.sup_payment_method_id\n\tLEFT JOIN LKP_sup_payment_system\n\tON LKP_sup_payment_system.sup_payment_system_id = EXP_get_values.sup_payment_system_id\n),\nLKP_claim_payment_dim AS (\n\tSELECT\n\tclaim_pay_dim_id,\n\tedw_claim_pay_pk_id,\n\tedw_claim_party_occurrence_pay_pk_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_dim_id,\n\t\t\tedw_claim_pay_pk_id,\n\t\t\tedw_claim_party_occurrence_pay_pk_id\n\t\tFROM claim_payment_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_pay_pk_id,edw_claim_party_occurrence_pay_pk_id ORDER BY claim_pay_dim_id) = 1\n),\nRTR_claim_payment_dim AS (\n\tSELECT\n\tEXP_get_descriptions.claim_pay_id,\n\tLKP_claim_payment_dim.claim_pay_dim_id,\n\tEXP_get_descriptions.claim_party_occurrence_pay_id,\n\tEXP_get_descriptions.claim_pay_ak_id,\n\tEXP_get_descriptions.claim_pay_num,\n\tEXP_get_descriptions.micro_ecd_draft_num,\n\tEXP_get_descriptions.bank_acct_num,\n\tEXP_get_descriptions.pay_delete_ind,\n\tEXP_get_descriptions.total_pay_amt,\n\tEXP_get_descriptions.pay_issued_date,\n\tEXP_get_descriptions.pay_cashed_date,\n\tEXP_get_descriptions.pay_to_code,\n\tEXP_get_descriptions.payee_note,\n\tEXP_get_descriptions.pay_ind,\n\tEXP_get_descriptions.pay_type_code,\n\tEXP_get_descriptions.pay_type_code_descript,\n\tEXP_get_descriptions.pay_entry_oper_id,\n\tEXP_get_descriptions.pay_entry_oper_role_code,\n\tEXP_get_descriptions.pay_entry_oper_role_code_descript,\n\tEXP_get_descriptions.pay_disbursement_date,\n\tEXP_get_descriptions.pay_disbursement_status,\n\tEXP_get_descriptions.o_pay_disbursement_status_descript,\n\tEXP_get_descriptions.reported_to_irs_ind,\n\tEXP_get_descriptions.pay_voided_date,\n\tEXP_get_descriptions.pay_reposted_date,\n\tEXP_get_descriptions.pay_to_code_descript,\n\tEXP_get_descriptions.new_claim_num,\n\tEXP_get_descriptions.new_draft_num,\n\tEXP_get_descriptions.payee_phrase_code,\n\tEXP_get_descriptions.payee_phrase_descript,\n\tEXP_get_descriptions.pay_to_the_order_of_name,\n\tEXP_get_descriptions.memo_phrase_code,\n\tEXP_get_descriptions.memo_phrase_descript,\n\tEXP_get_descriptions.memo_phrase_comment,\n\tEXP_get_descriptions.mail_to_code,\n\tEXP_get_descriptions.mail_to_code_descript,\n\tEXP_get_descriptions.mail_to_name,\n\tEXP_get_descriptions.mail_to_addr,\n\tEXP_get_descriptions.mail_to_city,\n\tEXP_get_descriptions.mail_to_state,\n\tEXP_get_descriptions.mail_to_zip,\n\tEXP_get_descriptions.payee_type,\n\tEXP_get_descriptions.claim_payee_seq_num,\n\tEXP_get_descriptions.payee_code,\n\tEXP_get_descriptions.crrnt_snpsht_flag,\n\tEXP_get_descriptions.audit_id,\n\tEXP_get_descriptions.eff_from_date,\n\tEXP_get_descriptions.eff_to_date,\n\tEXP_get_descriptions.created_date,\n\tEXP_get_descriptions.modified_date,\n\tEXP_get_descriptions.prim_payee_name,\n\tEXP_get_descriptions.add_payee_name1,\n\tEXP_get_descriptions.add_payee_name2,\n\tEXP_get_descriptions.add_payee_name3,\n\tEXP_get_descriptions.add_payee_name4,\n\tEXP_get_descriptions.add_payee_name5,\n\tEXP_get_descriptions.add_payee_name6,\n\tEXP_get_descriptions.claim_party_role_code,\n\tEXP_get_descriptions.claim_party_role_descript_out AS claim_party_role_descript,\n\tEXP_get_descriptions.claim_party_addr,\n\tEXP_get_descriptions.claim_party_city,\n\tEXP_get_descriptions.claim_party_county,\n\tEXP_get_descriptions.claim_party_state,\n\tEXP_get_descriptions.claim_party_zip,\n\tEXP_get_descriptions.addr_type,\n\tEXP_get_descriptions.tax_ssn_id,\n\tEXP_get_descriptions.o_payment_system AS payment_system,\n\tEXP_get_descriptions.o_payment_method AS payment_method,\n\tEXP_get_descriptions.approval_status,\n\tEXP_get_descriptions.approval_by_user_id,\n\tEXP_get_descriptions.approval_date,\n\tEXP_get_descriptions.denial_reason,\n\tEXP_get_descriptions.special_processing,\n\tEXP_get_descriptions.payee_category,\n\tEXP_get_descriptions.o_payment_workflow AS payment_workflow,\n\tEXP_get_descriptions.o_attached_document_count AS O_attached_document_count\n\tFROM EXP_get_descriptions\n\tLEFT JOIN LKP_claim_payment_dim\n\tON LKP_claim_payment_dim.edw_claim_pay_pk_id = EXP_get_descriptions.claim_pay_id AND LKP_claim_payment_dim.edw_claim_party_occurrence_pay_pk_id = EXP_get_descriptions.claim_party_occurrence_pay_id\n),\nRTR_claim_payment_dim_Insert AS (SELECT * FROM RTR_claim_payment_dim WHERE ISNULL(claim_pay_dim_id)),\nRTR_claim_payment_dim_Update AS (SELECT * FROM RTR_claim_payment_dim WHERE NOT ISNULL(claim_pay_dim_id)),\nUPD_claim_payment_dim_insert AS (\n\tSELECT\n\tclaim_pay_id AS claim_pay_id1, \n\tclaim_party_occurrence_pay_id AS claim_party_occurrence_pay_id1, \n\tclaim_pay_ak_id AS claim_pay_ak_id1, \n\tclaim_pay_num AS claim_pay_num1, \n\tmicro_ecd_draft_num AS micro_ecd_draft_num1, \n\tbank_acct_num AS bank_acct_num1, \n\tpay_delete_ind AS pay_delete_ind1, \n\ttotal_pay_amt AS total_pay_amt1, \n\tpay_issued_date AS pay_issued_date1, \n\tpay_cashed_date AS pay_cashed_date1, \n\tpay_to_code AS pay_to_code1, \n\tpay_to_code_descript AS pay_to_code_descript1, \n\tpayee_note AS payee_note1, \n\tpay_ind AS pay_ind1, \n\tpay_type_code AS pay_type_code1, \n\tpay_type_code_descript AS pay_type_code_descript1, \n\tpay_entry_oper_id AS pay_entry_oper_id1, \n\tpay_entry_oper_role_code AS pay_entry_oper_role_code1, \n\tpay_entry_oper_role_code_descript AS pay_entry_oper_role_code_descript1, \n\tpay_disbursement_date AS pay_disbursement_date1, \n\tpay_disbursement_status AS pay_disbursement_status1, \n\to_pay_disbursement_status_descript AS o_pay_disbursement_status_descript1, \n\treported_to_irs_ind AS reported_to_irs_ind1, \n\tpay_voided_date AS pay_voided_date1, \n\tpay_reposted_date AS pay_reposted_date1, \n\tnew_claim_num AS new_claim_num1, \n\tnew_draft_num AS new_draft_num1, \n\tpayee_phrase_code AS payee_phrase_code1, \n\tpayee_phrase_descript AS payee_phrase_descript1, \n\tpay_to_the_order_of_name, \n\tmemo_phrase_code AS memo_phrase_code1, \n\tmemo_phrase_descript AS memo_phrase_descript1, \n\tmemo_phrase_comment AS memo_phrase_comment1, \n\tmail_to_code AS mail_to_code1, \n\tmail_to_code_descript AS mail_to_code_descript1, \n\tmail_to_name AS mail_to_name1, \n\tmail_to_addr AS mail_to_addr1, \n\tmail_to_city AS mail_to_city1, \n\tmail_to_state AS mail_to_state1, \n\tmail_to_zip AS mail_to_zip1, \n\tpayee_type AS payee_type1, \n\tclaim_payee_seq_num AS claim_payee_seq_num1, \n\tpayee_code AS payee_code1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tprim_payee_name AS prim_payee_name1, \n\tadd_payee_name AS add_payee_name1, \n\tadd_payee_name2 AS add_payee_name21, \n\tadd_payee_name3 AS add_payee_name31, \n\tadd_payee_name4 AS add_payee_name41, \n\tadd_payee_name5 AS add_payee_name51, \n\tadd_payee_name6 AS add_payee_name61, \n\tclaim_party_role_code AS claim_party_role_code1, \n\tclaim_party_role_descript AS claim_party_role_descript1, \n\tclaim_party_addr AS claim_party_addr1, \n\tclaim_party_city AS claim_party_city1, \n\tclaim_party_county AS claim_party_county1, \n\tclaim_party_state AS claim_party_state1, \n\tclaim_party_zip AS claim_party_zip1, \n\taddr_type AS addr_type1, \n\ttax_ssn_id AS tax_ssn_id1, \n\tpayment_system, \n\tpayment_method, \n\tapproval_status AS approval_status1, \n\tapproval_by_user_id AS approval_by_user_id1, \n\tapproval_date AS approval_date1, \n\tdenial_reason AS denial_reason1, \n\tspecial_processing AS special_processing1, \n\tpayee_category AS payee_category1, \n\tpayment_workflow AS payment_workflow1, \n\tO_attached_document_count\n\tFROM RTR_claim_payment_dim_Insert\n),\nclaim_payment_dim_insert AS (\n\tINSERT INTO claim_payment_dim\n\t(edw_claim_pay_pk_id, edw_claim_party_occurrence_pay_pk_id, edw_claim_pay_ak_id, claim_pay_num, micro_ecd_draft_num, bank_acct_num, pay_delete_ind, total_pay_amt, pay_issued_date, pay_cashed_date, pay_to_code, pay_to_code_descript, payee_note, pay_ind, pay_type_code, pay_type_code_descript, pay_entry_oper_id, pay_entry_oper_role_code, pay_entry_oper_role_code_descript, pay_disbursement_date, pay_disbursement_status, reported_to_irs_ind, pay_voided_date, pay_reposted_date, new_claim_num, new_draft_num, payee_phrase_code, payee_phrase_code_descript, pay_to_the_order_of_name, memo_phrase_code, memo_phrase_code_descript, memo_phrase_comment, mail_to_code, mail_to_code_descript, mail_to_name, mail_to_addr, mail_to_city, mail_to_state, mail_to_zip, payee_type, claim_payee_seq_num, payee_code, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, prim_payee_name, add_payee_name1, add_payee_name2, add_payee_name3, add_payee_name4, add_payee_name5, add_payee_name6, prim_payee_role_code, prim_payee_role_code_descript, prim_payee_addr, prim_payee_city, prim_payee_county, prim_payee_state, prim_payee_zip, prim_payee_addr_type, prim_payee_tax_id, pay_disbursement_status_descript, payment_system, payment_method, approval_status, approval_by_user_id, approval_date, denial_reason, special_processing, payee_category, payment_workflow, attached_document_count)\n\tSELECT \n\tclaim_pay_id1 AS EDW_CLAIM_PAY_PK_ID, \n\tclaim_party_occurrence_pay_id1 AS EDW_CLAIM_PARTY_OCCURRENCE_PAY_PK_ID, \n\tclaim_pay_ak_id1 AS EDW_CLAIM_PAY_AK_ID, \n\tclaim_pay_num1 AS CLAIM_PAY_NUM, \n\tmicro_ecd_draft_num1 AS MICRO_ECD_DRAFT_NUM, \n\tbank_acct_num1 AS BANK_ACCT_NUM, \n\tpay_delete_ind1 AS PAY_DELETE_IND, \n\ttotal_pay_amt1 AS TOTAL_PAY_AMT, \n\tpay_issued_date1 AS PAY_ISSUED_DATE, \n\tpay_cashed_date1 AS PAY_CASHED_DATE, \n\tpay_to_code1 AS PAY_TO_CODE, \n\tpay_to_code_descript1 AS PAY_TO_CODE_DESCRIPT, \n\tpayee_note1 AS PAYEE_NOTE, \n\tpay_ind1 AS PAY_IND, \n\tpay_type_code1 AS PAY_TYPE_CODE, \n\tpay_type_code_descript1 AS PAY_TYPE_CODE_DESCRIPT, \n\tpay_entry_oper_id1 AS PAY_ENTRY_OPER_ID, \n\tpay_entry_oper_role_code1 AS PAY_ENTRY_OPER_ROLE_CODE, \n\tpay_entry_oper_role_code_descript1 AS PAY_ENTRY_OPER_ROLE_CODE_DESCRIPT, \n\tpay_disbursement_date1 AS PAY_DISBURSEMENT_DATE, \n\tpay_disbursement_status1 AS PAY_DISBURSEMENT_STATUS, \n\treported_to_irs_ind1 AS REPORTED_TO_IRS_IND, \n\tpay_voided_date1 AS PAY_VOIDED_DATE, \n\tpay_reposted_date1 AS PAY_REPOSTED_DATE, \n\tnew_claim_num1 AS NEW_CLAIM_NUM, \n\tnew_draft_num1 AS NEW_DRAFT_NUM, \n\tpayee_phrase_code1 AS PAYEE_PHRASE_CODE, \n\tpayee_phrase_descript1 AS PAYEE_PHRASE_CODE_DESCRIPT, \n\tPAY_TO_THE_ORDER_OF_NAME, \n\tmemo_phrase_code1 AS MEMO_PHRASE_CODE, \n\tmemo_phrase_descript1 AS MEMO_PHRASE_CODE_DESCRIPT, \n\tmemo_phrase_comment1 AS MEMO_PHRASE_COMMENT, \n\tmail_to_code1 AS MAIL_TO_CODE, \n\tmail_to_code_descript1 AS MAIL_TO_CODE_DESCRIPT, \n\tmail_to_name1 AS MAIL_TO_NAME, \n\tmail_to_addr1 AS MAIL_TO_ADDR, \n\tmail_to_city1 AS MAIL_TO_CITY, \n\tmail_to_state1 AS MAIL_TO_STATE, \n\tmail_to_zip1 AS MAIL_TO_ZIP, \n\tpayee_type1 AS PAYEE_TYPE, \n\tclaim_payee_seq_num1 AS CLAIM_PAYEE_SEQ_NUM, \n\tpayee_code1 AS PAYEE_CODE, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tprim_payee_name1 AS PRIM_PAYEE_NAME, \n\tADD_PAYEE_NAME1, \n\tadd_payee_name21 AS ADD_PAYEE_NAME2, \n\tadd_payee_name31 AS ADD_PAYEE_NAME3, \n\tadd_payee_name41 AS ADD_PAYEE_NAME4, \n\tadd_payee_name51 AS ADD_PAYEE_NAME5, \n\tadd_payee_name61 AS ADD_PAYEE_NAME6, \n\tclaim_party_role_code1 AS PRIM_PAYEE_ROLE_CODE, \n\tclaim_party_role_descript1 AS PRIM_PAYEE_ROLE_CODE_DESCRIPT, \n\tclaim_party_addr1 AS PRIM_PAYEE_ADDR, \n\tclaim_party_city1 AS PRIM_PAYEE_CITY, \n\tclaim_party_county1 AS PRIM_PAYEE_COUNTY, \n\tclaim_party_state1 AS PRIM_PAYEE_STATE, \n\tclaim_party_zip1 AS PRIM_PAYEE_ZIP, \n\taddr_type1 AS PRIM_PAYEE_ADDR_TYPE, \n\ttax_ssn_id1 AS PRIM_PAYEE_TAX_ID, \n\to_pay_disbursement_status_descript1 AS PAY_DISBURSEMENT_STATUS_DESCRIPT, \n\tPAYMENT_SYSTEM, \n\tPAYMENT_METHOD, \n\tapproval_status1 AS APPROVAL_STATUS, \n\tapproval_by_user_id1 AS APPROVAL_BY_USER_ID, \n\tapproval_date1 AS APPROVAL_DATE, \n\tdenial_reason1 AS DENIAL_REASON, \n\tspecial_processing1 AS SPECIAL_PROCESSING, \n\tpayee_category1 AS PAYEE_CATEGORY, \n\tpayment_workflow1 AS PAYMENT_WORKFLOW, \n\tO_attached_document_count AS ATTACHED_DOCUMENT_COUNT\n\tFROM UPD_claim_payment_dim_insert\n),\nUPD_claim_payment_dim_update AS (\n\tSELECT\n\tclaim_pay_dim_id AS claim_pay_dim_id3, \n\tclaim_party_occurrence_pay_id AS claim_party_occurrence_pay_id3, \n\tclaim_pay_ak_id AS claim_pay_ak_id3, \n\tclaim_pay_num AS claim_pay_num3, \n\tmicro_ecd_draft_num AS micro_ecd_draft_num3, \n\tbank_acct_num AS bank_acct_num3, \n\tpay_delete_ind AS pay_delete_ind3, \n\ttotal_pay_amt AS total_pay_amt3, \n\tpay_issued_date AS pay_issued_date3, \n\tpay_cashed_date AS pay_cashed_date3, \n\tpay_to_code AS pay_to_code3, \n\tpay_to_code_descript AS pay_to_code_descript3, \n\tpayee_note AS payee_note3, \n\tpay_ind AS pay_ind3, \n\tpay_type_code AS pay_type_code3, \n\tpay_type_code_descript AS pay_type_code_descript3, \n\tpay_entry_oper_id AS pay_entry_oper_id3, \n\tpay_entry_oper_role_code AS pay_entry_oper_role_code3, \n\tpay_entry_oper_role_code_descript AS pay_entry_oper_role_code_descript3, \n\tpay_disbursement_date AS pay_disbursement_date3, \n\tpay_disbursement_status AS pay_disbursement_status3, \n\to_pay_disbursement_status_descript AS o_pay_disbursement_status_descript3, \n\treported_to_irs_ind AS reported_to_irs_ind3, \n\tpay_voided_date AS pay_voided_date3, \n\tpay_reposted_date AS pay_reposted_date3, \n\tnew_claim_num AS new_claim_num3, \n\tnew_draft_num AS new_draft_num3, \n\tpayee_phrase_code AS payee_phrase_code3, \n\tpayee_phrase_descript AS payee_phrase_descript3, \n\tpay_to_the_order_of_name, \n\tmemo_phrase_code AS memo_phrase_code3, \n\tmemo_phrase_descript AS memo_phrase_descript3, \n\tmemo_phrase_comment AS memo_phrase_comment3, \n\tmail_to_code AS mail_to_code3, \n\tmail_to_code_descript AS mail_to_code_descript3, \n\tmail_to_name AS mail_to_name3, \n\tmail_to_addr AS mail_to_addr3, \n\tmail_to_city AS mail_to_city3, \n\tmail_to_state AS mail_to_state3, \n\tmail_to_zip AS mail_to_zip3, \n\tpayee_type AS payee_type3, \n\tclaim_payee_seq_num AS claim_payee_seq_num3, \n\tpayee_code AS payee_code3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_date AS eff_from_date3, \n\teff_to_date AS eff_to_date3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3, \n\tprim_payee_name AS prim_payee_name3, \n\tadd_payee_name1, \n\tadd_payee_name2 AS add_payee_name23, \n\tadd_payee_name AS add_payee_name33, \n\tadd_payee_name4 AS add_payee_name43, \n\tadd_payee_name5 AS add_payee_name53, \n\tadd_payee_name6 AS add_payee_name63, \n\tclaim_party_role_code AS claim_party_role_code3, \n\tclaim_party_role_descript AS claim_party_role_descript3, \n\tclaim_party_addr AS claim_party_addr3, \n\tclaim_party_city AS claim_party_city3, \n\tclaim_party_county AS claim_party_county3, \n\tclaim_party_state AS claim_party_state3, \n\tclaim_party_zip AS claim_party_zip3, \n\taddr_type AS addr_type3, \n\ttax_ssn_id AS tax_ssn_id3, \n\tpayment_system, \n\tpayment_method, \n\tapproval_status AS approval_status3, \n\tapproval_by_user_id AS approval_by_user_id3, \n\tapproval_date AS approval_date3, \n\tdenial_reason AS denial_reason3, \n\tspecial_processing AS special_processing3, \n\tpayee_category AS payee_category3, \n\tpayment_workflow AS payment_workflow3, \n\tO_attached_document_count\n\tFROM RTR_claim_payment_dim_Update\n),\nclaim_payment_dim_update AS (\n\tMERGE INTO claim_payment_dim AS T\n\tUSING UPD_claim_payment_dim_update AS S\n\tON T.claim_pay_dim_id = S.claim_pay_dim_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.claim_pay_num = S.claim_pay_num3, T.micro_ecd_draft_num = S.micro_ecd_draft_num3, T.bank_acct_num = S.bank_acct_num3, T.pay_delete_ind = S.pay_delete_ind3, T.total_pay_amt = S.total_pay_amt3, T.pay_issued_date = S.pay_issued_date3, T.pay_cashed_date = S.pay_cashed_date3, T.pay_to_code = S.pay_to_code3, T.pay_to_code_descript = S.pay_to_code_descript3, T.payee_note = S.payee_note3, T.pay_ind = S.pay_ind3, T.pay_type_code = S.pay_type_code3, T.pay_type_code_descript = S.pay_type_code_descript3, T.pay_entry_oper_id = S.pay_entry_oper_id3, T.pay_entry_oper_role_code = S.pay_entry_oper_role_code3, T.pay_entry_oper_role_code_descript = S.pay_entry_oper_role_code_descript3, T.pay_disbursement_date = S.pay_disbursement_date3, T.pay_disbursement_status = S.pay_disbursement_status3, T.reported_to_irs_ind = S.reported_to_irs_ind3, T.pay_voided_date = S.pay_voided_date3, T.pay_reposted_date = S.pay_reposted_date3, T.new_claim_num = S.new_claim_num3, T.new_draft_num = S.new_draft_num3, T.payee_phrase_code = S.payee_phrase_code3, T.payee_phrase_code_descript = S.payee_phrase_descript3, T.pay_to_the_order_of_name = S.pay_to_the_order_of_name, T.memo_phrase_code = S.memo_phrase_code3, T.memo_phrase_code_descript = S.memo_phrase_descript3, T.memo_phrase_comment = S.memo_phrase_comment3, T.mail_to_code = S.mail_to_code3, T.mail_to_code_descript = S.mail_to_code_descript3, T.mail_to_name = S.mail_to_name3, T.mail_to_addr = S.mail_to_addr3, T.mail_to_city = S.mail_to_city3, T.mail_to_state = S.mail_to_state3, T.mail_to_zip = S.mail_to_zip3, T.payee_type = S.payee_type3, T.claim_payee_seq_num = S.claim_payee_seq_num3, T.payee_code = S.payee_code3, T.audit_id = S.audit_id3, T.modified_date = S.modified_date3, T.prim_payee_name = S.prim_payee_name3, T.add_payee_name1 = S.add_payee_name1, T.add_payee_name2 = S.add_payee_name23, T.add_payee_name3 = S.add_payee_name33, T.add_payee_name4 = S.add_payee_name43, T.add_payee_name5 = S.add_payee_name53, T.add_payee_name6 = S.add_payee_name63, T.prim_payee_role_code = S.claim_party_role_code3, T.prim_payee_role_code_descript = S.claim_party_role_descript3, T.prim_payee_addr = S.claim_party_addr3, T.prim_payee_city = S.claim_party_city3, T.prim_payee_county = S.claim_party_county3, T.prim_payee_state = S.claim_party_state3, T.prim_payee_zip = S.claim_party_zip3, T.prim_payee_addr_type = S.addr_type3, T.prim_payee_tax_id = S.tax_ssn_id3, T.pay_disbursement_status_descript = S.o_pay_disbursement_status_descript3, T.payment_system = S.payment_system, T.payment_method = S.payment_method, T.approval_status = S.approval_status3, T.approval_by_user_id = S.approval_by_user_id3, T.approval_date = S.approval_date3, T.denial_reason = S.denial_reason3, T.special_processing = S.special_processing3, T.payee_category = S.payee_category3, T.payment_workflow = S.payment_workflow3, T.attached_document_count = S.O_attached_document_count\n),"
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604472"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}