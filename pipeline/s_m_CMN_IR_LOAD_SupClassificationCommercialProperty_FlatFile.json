{
    "name": "s_m_CMN_IR_LOAD_SupClassificationCommercialProperty_FlatFile",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_IR_LOAD_SupClassificationCommercialProperty_Fl_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CommPropClass AS (\n\n-- TODO Manual --\n\n),\nEXP_DefaultValues AS (\n\tSELECT\n\tLine_of_Business_Abbreviation AS LineofBusinessAbbreviation,\n\tRating_State_Code AS RatingStateCode,\n\tClass_Effective_Date AS ClassEffectiveDate,\n\tClass_Expiration_Date AS ClassExpirationDate,\n\tClass_Code AS ClassCode,\n\tClass_Description AS ClassDescription,\n\tClass_Code_Originating_Organization AS ClassCodeOriginatingOrganization,\n\tISO_CP_Rating_Group AS ISOCPRatingGroup,\n\tProperty_Special_Class AS PropertySpecialClass,\n\tNotes,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(LineofBusinessAbbreviation))) OR IS_SPACES(LTRIM(RTRIM(LineofBusinessAbbreviation))) OR LENGTH(LTRIM(RTRIM(LineofBusinessAbbreviation)))=0,'N/A',LTRIM(RTRIM(LineofBusinessAbbreviation)))\n\tIFF(LTRIM(RTRIM(LineofBusinessAbbreviation\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(LineofBusinessAbbreviation\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(LineofBusinessAbbreviation\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(LineofBusinessAbbreviation\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(LineofBusinessAbbreviation\n\t\t\t)\n\t\t)\n\t) AS o_LineofBusinessAbbreviation,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(RatingStateCode))) OR IS_SPACES(LTRIM(RTRIM(RatingStateCode))) OR LENGTH(LTRIM(RTRIM(RatingStateCode)))=0,'N/A',LTRIM(RTRIM(RatingStateCode)))\n\tIFF(LTRIM(RTRIM(RatingStateCode\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(RatingStateCode\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(RatingStateCode\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(RatingStateCode\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(RatingStateCode\n\t\t\t)\n\t\t)\n\t) AS o_RatingStateCode,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ClassEffectiveDate))) \r\n\t-- OR IS_SPACES(LTRIM(RTRIM(ClassEffectiveDate))) \r\n\t-- OR LENGTH(LTRIM(RTRIM(ClassEffectiveDate)))=0\r\n\t-- OR LTRIM(RTRIM(ClassEffectiveDate))='1900-01-01', TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'),TO_DATE(LTRIM(RTRIM(ClassEffectiveDate)), 'YYYY-MM-DD'))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(i_ClassEffectiveDate) OR i_ClassEffectiveDate=TO_DATE('01/01/1900 00:00:00','MM/DD/YYYY HH24:MI:SS'),'01/01/1800 01:00:00', TO_CHAR(i_ClassEffectiveDate,'MM/DD/YYYY HH24:MI:SS'))\n\tIFF(LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0 \n\t\tOR LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t)\n\t\t) = '1900-01-01',\n\t\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tTO_DATE(LTRIM(RTRIM(ClassEffectiveDate\n\t\t\t\t)\n\t\t\t), 'YYYY-MM-DD'\n\t\t)\n\t) AS o_ClassEffectiveDate,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ClassExpirationDate))) \r\n\t-- OR IS_SPACES(LTRIM(RTRIM(ClassExpirationDate)))\r\n\t-- OR LENGTH(LTRIM(RTRIM(ClassExpirationDate)))=0\r\n\t-- OR LTRIM(RTRIM(ClassExpirationDate))='2999-01-01', TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS'),TO_DATE(LTRIM(RTRIM(ClassExpirationDate)), 'YYYY-MM-DD'))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(i_ClassExpirationDate) OR i_ClassExpirationDate=TO_DATE('01/01/2999 00:00:00','MM/DD/YYYY HH24:MI:SS'),'12/31/2100 23:59:59', TO_CHAR(i_ClassExpirationDate,'MM/DD/YYYY HH24:MI:SS'))\n\tIFF(LTRIM(RTRIM(ClassExpirationDate\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ClassExpirationDate\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ClassExpirationDate\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ClassExpirationDate\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0 \n\t\tOR LTRIM(RTRIM(ClassExpirationDate\n\t\t\t)\n\t\t) = '2999-01-01',\n\t\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tTO_DATE(LTRIM(RTRIM(ClassExpirationDate\n\t\t\t\t)\n\t\t\t), 'YYYY-MM-DD'\n\t\t)\n\t) AS o_ClassExpirationDate,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ClassCode))) OR IS_SPACES(LTRIM(RTRIM(ClassCode))) OR LENGTH(LTRIM(RTRIM(ClassCode)))=0,'N/A',LTRIM(RTRIM(ClassCode)))\n\tIFF(LTRIM(RTRIM(ClassCode\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ClassCode\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ClassCode\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ClassCode\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(ClassCode\n\t\t\t)\n\t\t)\n\t) AS o_ClassCode,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ClassDescription))) OR IS_SPACES(LTRIM(RTRIM(ClassDescription))) OR LENGTH(LTRIM(RTRIM(ClassDescription)))=0,'N/A',LTRIM(RTRIM(ClassDescription)))\n\tIFF(LTRIM(RTRIM(ClassDescription\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ClassDescription\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ClassDescription\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ClassDescription\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(ClassDescription\n\t\t\t)\n\t\t)\n\t) AS o_ClassDescription,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ClassCodeOriginatingOrganization))) OR IS_SPACES(LTRIM(RTRIM(ClassCodeOriginatingOrganization))) OR LENGTH(LTRIM(RTRIM(ClassCodeOriginatingOrganization)))=0,'N/A',LTRIM(RTRIM(ClassCodeOriginatingOrganization)))\n\tIFF(LTRIM(RTRIM(ClassCodeOriginatingOrganization\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ClassCodeOriginatingOrganization\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ClassCodeOriginatingOrganization\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ClassCodeOriginatingOrganization\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(ClassCodeOriginatingOrganization\n\t\t\t)\n\t\t)\n\t) AS o_ClassCodeOriginatingOrganization,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(ISOCPRatingGroup))) OR IS_SPACES(LTRIM(RTRIM(ISOCPRatingGroup))) OR LENGTH(LTRIM(RTRIM(ISOCPRatingGroup)))=0,'N/A',LTRIM(RTRIM(ISOCPRatingGroup)))\n\tIFF(LTRIM(RTRIM(ISOCPRatingGroup\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(ISOCPRatingGroup\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(ISOCPRatingGroup\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(ISOCPRatingGroup\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(ISOCPRatingGroup\n\t\t\t)\n\t\t)\n\t) AS o_ISOCPRatingGroup,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(PropertySpecialClass))) OR IS_SPACES(LTRIM(RTRIM(PropertySpecialClass))) OR LENGTH(LTRIM(RTRIM(PropertySpecialClass)))=0,'N/A',LTRIM(RTRIM(PropertySpecialClass)))\n\tIFF(LTRIM(RTRIM(PropertySpecialClass\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(PropertySpecialClass\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(PropertySpecialClass\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(PropertySpecialClass\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(PropertySpecialClass\n\t\t\t)\n\t\t)\n\t) AS o_PropertySpecialClass,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(Notes))) OR IS_SPACES(LTRIM(RTRIM(Notes))) OR LENGTH(LTRIM(RTRIM(Notes)))=0,'N/A',LTRIM(RTRIM(Notes)))\n\tIFF(LTRIM(RTRIM(Notes\n\t\t\t)\n\t\t) IS NULL \n\t\tOR LENGTH(LTRIM(RTRIM(Notes\n\t\t\t)\n\t\t))>0 AND TRIM(LTRIM(RTRIM(Notes\n\t\t\t)\n\t\t))='' \n\t\tOR LENGTH(LTRIM(RTRIM(Notes\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0,\n\t\t'N/A',\n\t\tLTRIM(RTRIM(Notes\n\t\t\t)\n\t\t)\n\t) AS o_Notes\n\tFROM SQ_CommPropClass\n),\nEXP_CalculateData AS (\n\tSELECT\n\to_LineofBusinessAbbreviation AS i_LineofBusinessAbbreviation,\n\to_RatingStateCode AS i_RatingStateCode,\n\to_ClassEffectiveDate AS i_ClassEffectiveDate,\n\to_ClassExpirationDate AS i_ClassExpirationDate,\n\to_ClassCode AS i_ClassCode,\n\to_ClassDescription AS i_ClassDescription,\n\to_ClassCodeOriginatingOrganization AS i_ClassCodeOriginatingOrganization,\n\to_ISOCPRatingGroup AS i_ISOCPRatingGroup,\n\to_PropertySpecialClass AS i_PropertySpecialClass,\n\to_Notes AS i_Notes,\n\t-- *INF*: LTRIM(RTRIM(i_LineofBusinessAbbreviation))\n\tLTRIM(RTRIM(i_LineofBusinessAbbreviation\n\t\t)\n\t) AS o_LineofBusinessAbbreviation,\n\ti_ClassEffectiveDate AS o_ClassEffectiveDate,\n\ti_ClassExpirationDate AS o_ClassExpirationDate,\n\ti_RatingStateCode AS o_RatingStateCode,\n\t-- *INF*: i_ClassCode\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --LPAD(i_ClassCode,6,'0')\n\ti_ClassCode AS o_ClassCode,\n\t-- *INF*: LTRIM(RTRIM(REPLACESTR(1,i_ClassDescription,'\"','')))\n\tLTRIM(RTRIM(REGEXP_REPLACE(i_ClassDescription,'\"','')\n\t\t)\n\t) AS o_ClassDescription,\n\t-- *INF*: LTRIM(RTRIM(i_ClassCodeOriginatingOrganization))\n\tLTRIM(RTRIM(i_ClassCodeOriginatingOrganization\n\t\t)\n\t) AS o_ClassCodeOriginatingOrganization,\n\t-- *INF*: LTRIM(RTRIM(IIF(i_ISOCPRatingGroup!='N/A',LPAD(i_ISOCPRatingGroup,2,'0'),i_ISOCPRatingGroup)))\n\tLTRIM(RTRIM(IFF(i_ISOCPRatingGroup != 'N/A',\n\t\t\t\tLPAD(i_ISOCPRatingGroup, 2, '0'\n\t\t\t\t),\n\t\t\t\ti_ISOCPRatingGroup\n\t\t\t)\n\t\t)\n\t) AS o_ISOCPRatingGroup,\n\t-- *INF*: LTRIM(RTRIM(IIF(i_PropertySpecialClass!='N/A',LPAD(i_PropertySpecialClass,2,'0'),i_PropertySpecialClass)))\n\tLTRIM(RTRIM(IFF(i_PropertySpecialClass != 'N/A',\n\t\t\t\tLPAD(i_PropertySpecialClass, 2, '0'\n\t\t\t\t),\n\t\t\t\ti_PropertySpecialClass\n\t\t\t)\n\t\t)\n\t) AS o_PropertySpecialClass\n\tFROM EXP_DefaultValues\n),\nEXP_UpdateOrInsert AS (\n\tSELECT\n\to_ClassEffectiveDate AS ClassEffectiveDate,\n\to_ClassExpirationDate AS ClassExpirationDate,\n\to_LineofBusinessAbbreviation AS LineofBusinessAbbreviation,\n\to_RatingStateCode AS RatingStateCode,\n\to_ClassCode AS ClassCode,\n\to_ClassDescription AS ClassDescription,\n\to_ClassCodeOriginatingOrganization AS ClassCodeOriginatingOrganization,\n\to_ISOCPRatingGroup AS ISOCPRatingGroup,\n\to_PropertySpecialClass AS PropertySpecialClass,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate\n\tFROM EXP_CalculateData\n),\nSupClassificationCommercialProperty_IR AS (\n\tTRUNCATE TABLE SupClassificationCommercialProperty;\n\tINSERT INTO SupClassificationCommercialProperty\n\t(AuditId, CreatedDate, ModifiedDate, LineOfBusinessAbbreviation, RatingStateCode, EffectiveDate, ExpirationDate, ClassCode, ClassDescription, OriginatingOrganizationCode, ISOCPRatingGroup, CommercialPropertySpecialClass)\n\tSELECT \n\to_AuditId AS AUDITID, \n\to_CreatedDate AS CREATEDDATE, \n\to_ModifiedDate AS MODIFIEDDATE, \n\tLineofBusinessAbbreviation AS LINEOFBUSINESSABBREVIATION, \n\tRATINGSTATECODE, \n\tClassEffectiveDate AS EFFECTIVEDATE, \n\tClassExpirationDate AS EXPIRATIONDATE, \n\tCLASSCODE, \n\tCLASSDESCRIPTION, \n\tClassCodeOriginatingOrganization AS ORIGINATINGORGANIZATIONCODE, \n\tISOCPRATINGGROUP, \n\tPropertySpecialClass AS COMMERCIALPROPERTYSPECIALCLASS\n\tFROM EXP_UpdateOrInsert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246484"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905454"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7603032"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/29/2023 22:02:48"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 22:02:41"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": ""
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_InsuranceReference_Policy"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "dbo"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "dbo"
            },
            "INPUTFILENAME": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\Classification\\CommPropClass.csv"
            }
        },
        "folder": {
            "name": "Common DataWarehouse/"
        },
        "annotations": []
    }
}