WITH
SQ_PIF_42GM_stage AS (
	SELECT
		pif_42gm_stage_id AS PIF_42GM_stage_id,
		pif_symbol AS PIF_SYMBOL,
		pif_policy_number AS PIF_POLICY_NUMBER,
		pif_module AS PIF_MODULE,
		ipfc4m_rec_length AS IPFC4M_REC_LENGTH,
		ipfc4m_action_code AS IPFC4M_ACTION_CODE,
		ipfc4m_file_id AS IPFC4M_FILE_ID,
		ipfc4m_segment_id AS IPFC4M_SEGMENT_ID,
		ipfc4m_segment_level_code AS IPFC4M_SEGMENT_LEVEL_CODE,
		ipfc4m_segment_part_code AS IPFC4M_SEGMENT_PART_CODE,
		ipfc4m_sub_part_code AS IPFC4M_SUB_PART_CODE,
		ipfc4m_insurance_line AS IPFC4M_INSURANCE_LINE,
		ipfc4m_location_number AS IPFC4M_LOCATION_NUMBER,
		ipfc4m_sub_location_number AS IPFC4M_SUB_LOCATION_NUMBER,
		ipfc4m_risk_unit_group AS IPFC4M_RISK_UNIT_GROUP,
		ipfc4m_class_code_group AS IPFC4M_CLASS_CODE_GROUP,
		ipfc4m_class_code_member AS IPFC4M_CLASS_CODE_MEMBER,
		ipfc4m_risk_unit AS IPFC4M_RISK_UNIT,
		ipfc4m_risk_sequence AS IPFC4M_RISK_SEQUENCE,
		ipfc4m_risk_type_ind AS IPFC4M_RISK_TYPE_IND,
		ipfc4m_year_item_effective AS IPFC4M_YEAR_ITEM_EFFECTIVE,
		ipfc4m_month_item_effective AS IPFC4M_MONTH_ITEM_EFFECTIVE,
		ipfc4m_day_item_effective AS IPFC4M_DAY_ITEM_EFFECTIVE,
		ipfc4m_loss_year AS IPFC4M_LOSS_YEAR,
		ipfc4m_loss_month AS IPFC4M_LOSS_MONTH,
		ipfc4m_loss_day AS IPFC4M_LOSS_DAY,
		ipfc4m_loss_occurence AS IPFC4M_LOSS_OCCURENCE,
		ipfc4m_loss_claimant AS IPFC4M_LOSS_CLAIMANT,
		ipfc4m_remark_length AS IPFC4M_REMARK_LENGTH,
		ipfc4m_use_code AS IPFC4M_USE_CODE,
		ipfc4m_sequence_use_code AS IPFC4M_SEQUENCE_USE_CODE,
		ipfc4m_year_process AS IPFC4M_YEAR_PROCESS,
		ipfc4m_month_process AS IPFC4M_MONTH_PROCESS,
		ipfc4m_day_process AS IPFC4M_DAY_PROCESS,
		ipfc4m_year_change_entry AS IPFC4M_YEAR_CHANGE_ENTRY,
		ipfc4m_month_change_entry AS IPFC4M_MONTH_CHANGE_ENTRY,
		ipfc4m_day_change_entry AS IPFC4M_DAY_CHANGE_ENTRY,
		ipfc4m_sequence_change_entry AS IPFC4M_SEQUENCE_CHANGE_ENTRY,
		ipfc4m_segment_status AS IPFC4M_SEGMENT_STATUS,
		ipfc4m_entry_operator AS IPFC4M_ENTRY_OPERATOR,
		ipfc4m_rsk_rmk_verbg AS IPFC4M_RSK_RMK_VERBG,
		ipfc4m_offset_onset_ind AS IPFC4M_OFFSET_ONSET_IND,
		ipfc4m_pms_future_use_4m AS IPFC4M_PMS_FUTURE_USE_4M,
		ipfc4m_yr2000_cust_use AS IPFC4M_YR2000_CUST_USE,
		ipfc4m_cust_spl_use_4m AS IPFC4M_CUST_SPL_USE_4M,
		inf_action,
		inf_timestamp,
		logical_flag,
		extract_date AS EXTRACT_DATE,
		as_of_date AS AS_OF_DATE,
		record_count AS RECORD_COUNT,
		source_system_id AS SOURCE_SYSTEM_ID
	FROM PIF_42GM_stage
),
EXP_arch_PIF_42GM_stage AS (
	SELECT
	PIF_42GM_stage_id,
	PIF_SYMBOL,
	PIF_POLICY_NUMBER,
	PIF_MODULE,
	IPFC4M_REC_LENGTH,
	IPFC4M_ACTION_CODE,
	IPFC4M_FILE_ID,
	IPFC4M_SEGMENT_ID,
	IPFC4M_SEGMENT_LEVEL_CODE,
	IPFC4M_SEGMENT_PART_CODE,
	IPFC4M_SUB_PART_CODE,
	IPFC4M_INSURANCE_LINE,
	IPFC4M_LOCATION_NUMBER,
	IPFC4M_SUB_LOCATION_NUMBER,
	IPFC4M_RISK_UNIT_GROUP,
	IPFC4M_CLASS_CODE_GROUP,
	IPFC4M_CLASS_CODE_MEMBER,
	IPFC4M_RISK_UNIT,
	IPFC4M_RISK_SEQUENCE,
	IPFC4M_RISK_TYPE_IND,
	IPFC4M_YEAR_ITEM_EFFECTIVE,
	IPFC4M_MONTH_ITEM_EFFECTIVE,
	IPFC4M_DAY_ITEM_EFFECTIVE,
	IPFC4M_LOSS_YEAR,
	IPFC4M_LOSS_MONTH,
	IPFC4M_LOSS_DAY,
	IPFC4M_LOSS_OCCURENCE,
	IPFC4M_LOSS_CLAIMANT,
	IPFC4M_REMARK_LENGTH,
	IPFC4M_USE_CODE,
	IPFC4M_SEQUENCE_USE_CODE,
	IPFC4M_YEAR_PROCESS,
	IPFC4M_MONTH_PROCESS,
	IPFC4M_DAY_PROCESS,
	IPFC4M_YEAR_CHANGE_ENTRY,
	IPFC4M_MONTH_CHANGE_ENTRY,
	IPFC4M_DAY_CHANGE_ENTRY,
	IPFC4M_SEQUENCE_CHANGE_ENTRY,
	IPFC4M_SEGMENT_STATUS,
	IPFC4M_ENTRY_OPERATOR,
	IPFC4M_RSK_RMK_VERBG,
	IPFC4M_OFFSET_ONSET_IND,
	IPFC4M_PMS_FUTURE_USE_4M,
	IPFC4M_YR2000_CUST_USE,
	IPFC4M_CUST_SPL_USE_4M,
	inf_action,
	inf_timestamp,
	logical_flag,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_PIF_42GM_stage
),
arch_PIF_42GM_stage AS (
	INSERT INTO arch_PIF_42GM_stage
	(pif_42gm_stage_id, pif_symbol, pif_policy_number, pif_module, ipfc4m_rec_length, ipfc4m_action_code, ipfc4m_file_id, ipfc4m_segment_id, ipfc4m_segment_level_code, ipfc4m_segment_part_code, ipfc4m_sub_part_code, ipfc4m_insurance_line, ipfc4m_location_number, ipfc4m_sub_location_number, ipfc4m_risk_unit_group, ipfc4m_class_code_group, ipfc4m_class_code_member, ipfc4m_risk_unit, ipfc4m_risk_sequence, ipfc4m_risk_type_ind, ipfc4m_year_item_effective, ipfc4m_month_item_effective, ipfc4m_day_item_effective, ipfc4m_loss_year, ipfc4m_loss_month, ipfc4m_loss_day, ipfc4m_loss_occurence, ipfc4m_loss_claimant, ipfc4m_remark_length, ipfc4m_use_code, ipfc4m_sequence_use_code, ipfc4m_year_process, ipfc4m_month_process, ipfc4m_day_process, ipfc4m_year_change_entry, ipfc4m_month_change_entry, ipfc4m_day_change_entry, ipfc4m_sequence_change_entry, ipfc4m_segment_status, ipfc4m_entry_operator, ipfc4m_rsk_rmk_verbg, ipfc4m_offset_onset_ind, ipfc4m_pms_future_use_4m, ipfc4m_yr2000_cust_use, ipfc4m_cust_spl_use_4m, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	PIF_42GM_stage_id AS PIF_42GM_STAGE_ID, 
	PIF_SYMBOL AS PIF_SYMBOL, 
	PIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, 
	PIF_MODULE AS PIF_MODULE, 
	IPFC4M_REC_LENGTH AS IPFC4M_REC_LENGTH, 
	IPFC4M_ACTION_CODE AS IPFC4M_ACTION_CODE, 
	IPFC4M_FILE_ID AS IPFC4M_FILE_ID, 
	IPFC4M_SEGMENT_ID AS IPFC4M_SEGMENT_ID, 
	IPFC4M_SEGMENT_LEVEL_CODE AS IPFC4M_SEGMENT_LEVEL_CODE, 
	IPFC4M_SEGMENT_PART_CODE AS IPFC4M_SEGMENT_PART_CODE, 
	IPFC4M_SUB_PART_CODE AS IPFC4M_SUB_PART_CODE, 
	IPFC4M_INSURANCE_LINE AS IPFC4M_INSURANCE_LINE, 
	IPFC4M_LOCATION_NUMBER AS IPFC4M_LOCATION_NUMBER, 
	IPFC4M_SUB_LOCATION_NUMBER AS IPFC4M_SUB_LOCATION_NUMBER, 
	IPFC4M_RISK_UNIT_GROUP AS IPFC4M_RISK_UNIT_GROUP, 
	IPFC4M_CLASS_CODE_GROUP AS IPFC4M_CLASS_CODE_GROUP, 
	IPFC4M_CLASS_CODE_MEMBER AS IPFC4M_CLASS_CODE_MEMBER, 
	IPFC4M_RISK_UNIT AS IPFC4M_RISK_UNIT, 
	IPFC4M_RISK_SEQUENCE AS IPFC4M_RISK_SEQUENCE, 
	IPFC4M_RISK_TYPE_IND AS IPFC4M_RISK_TYPE_IND, 
	IPFC4M_YEAR_ITEM_EFFECTIVE AS IPFC4M_YEAR_ITEM_EFFECTIVE, 
	IPFC4M_MONTH_ITEM_EFFECTIVE AS IPFC4M_MONTH_ITEM_EFFECTIVE, 
	IPFC4M_DAY_ITEM_EFFECTIVE AS IPFC4M_DAY_ITEM_EFFECTIVE, 
	IPFC4M_LOSS_YEAR AS IPFC4M_LOSS_YEAR, 
	IPFC4M_LOSS_MONTH AS IPFC4M_LOSS_MONTH, 
	IPFC4M_LOSS_DAY AS IPFC4M_LOSS_DAY, 
	IPFC4M_LOSS_OCCURENCE AS IPFC4M_LOSS_OCCURENCE, 
	IPFC4M_LOSS_CLAIMANT AS IPFC4M_LOSS_CLAIMANT, 
	IPFC4M_REMARK_LENGTH AS IPFC4M_REMARK_LENGTH, 
	IPFC4M_USE_CODE AS IPFC4M_USE_CODE, 
	IPFC4M_SEQUENCE_USE_CODE AS IPFC4M_SEQUENCE_USE_CODE, 
	IPFC4M_YEAR_PROCESS AS IPFC4M_YEAR_PROCESS, 
	IPFC4M_MONTH_PROCESS AS IPFC4M_MONTH_PROCESS, 
	IPFC4M_DAY_PROCESS AS IPFC4M_DAY_PROCESS, 
	IPFC4M_YEAR_CHANGE_ENTRY AS IPFC4M_YEAR_CHANGE_ENTRY, 
	IPFC4M_MONTH_CHANGE_ENTRY AS IPFC4M_MONTH_CHANGE_ENTRY, 
	IPFC4M_DAY_CHANGE_ENTRY AS IPFC4M_DAY_CHANGE_ENTRY, 
	IPFC4M_SEQUENCE_CHANGE_ENTRY AS IPFC4M_SEQUENCE_CHANGE_ENTRY, 
	IPFC4M_SEGMENT_STATUS AS IPFC4M_SEGMENT_STATUS, 
	IPFC4M_ENTRY_OPERATOR AS IPFC4M_ENTRY_OPERATOR, 
	IPFC4M_RSK_RMK_VERBG AS IPFC4M_RSK_RMK_VERBG, 
	IPFC4M_OFFSET_ONSET_IND AS IPFC4M_OFFSET_ONSET_IND, 
	IPFC4M_PMS_FUTURE_USE_4M AS IPFC4M_PMS_FUTURE_USE_4M, 
	IPFC4M_YR2000_CUST_USE AS IPFC4M_YR2000_CUST_USE, 
	IPFC4M_CUST_SPL_USE_4M AS IPFC4M_CUST_SPL_USE_4M, 
	INF_ACTION, 
	INF_TIMESTAMP, 
	LOGICAL_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_arch_PIF_42GM_stage
),