{
    "name": "m_CLM_DM_UPDATE_Claim_Loss_Transaction_Fact_ASL",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_UPDATE_Claim_Loss_Transaction_Fact_ASL",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_claim_reinsurance_transaction AS (\n\tSELECT\r\n\tCRT.source_sys_id, \r\n\tCRT.claimant_cov_det_ak_id, \r\n\tCRT.sar_id, \r\n\tCRT.claim_reins_financial_type_code, \r\n\tCRT.trans_ctgry_code, \r\n\tCLTF.claim_loss_trans_fact_id,\r\n\tCLTF.claim_trans_type_dim_id as wc_stage_pk_id,\r\n\tCLTF.InsuranceReferenceDimId,\r\n\tCLTF.AgencyDimId,\r\n\tCLTF.SalesDivisionDimId,\r\n\tCLTF.InsuranceReferenceCoverageDimId,\r\n\tCLTF.CoverageDetailDimId \r\n\tFROM   \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_reinsurance_transaction CRT,\r\n\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF   \r\n\tWHERE  \r\n\t \tCRT.claim_reins_trans_id = CLTF.edw_claim_reins_trans_pk_id \r\n\t       AND CRT.crrnt_snpsht_flag = 1\r\n\t       AND \r\n\t\t\t(CLTF.asl_dim_id in (0,-1) or \r\n\t\t\tCLTF.asl_prdct_code_dim_id in (0,-1) or \r\n\t\t\tCLTF.loss_master_dim_id in (0,-1) or\r\n\t\t\tCLTF.prdct_code_dim_id in (0,-1)\r\n\t\t\t)\n),\nEXP_reinsurance_input AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tsar_id,\n\tclaim_reins_financial_type_code,\n\ttrans_ctgry_code,\n\tsource_sys_id,\n\tclaim_loss_trans_fact_id,\n\t-1 AS default_id,\n\t'N/A' AS default_value,\n\t0 AS default_amount,\n\tSYSDATE AS default_date,\n\tclaim_trans_type_dim_id AS claim_loss_fact_trans_type_dim_id,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId\n\tFROM SQ_claim_reinsurance_transaction\n),\nSQ_claim_transaction_PMSClaims AS (\n\tSELECT \r\n\tCT.claimant_cov_det_ak_id, \r\n\tCT.claim_pay_ak_id, \r\n\tCT.sar_id, \r\n\tCT.financial_type_code, \r\n\tCT.trans_code, \r\n\tCT.trans_date, \r\n\tCT.trans_ctgry_code, \r\n\tCT.trans_amt, \r\n\tCT.trans_hist_amt, \r\n\tCT.source_sys_id, \r\n\tCLTF.claim_loss_trans_fact_id,\r\n\tCLTF.claim_trans_type_dim_id as wc_stage_pk_id,\r\n\tCLTF.InsuranceReferenceDimId,\r\n\tCLTF.AgencyDimId,\r\n\tCLTF.SalesDivisionDimId,\r\n\tCLTF.InsuranceReferenceCoverageDimId,\r\n\tCLTF.CoverageDetailDimId \r\n\tFROM   \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_transaction CT,\r\n\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF  ,\r\n\t     @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.policy_dim PD \r\n\tWHERE  \r\n\t CT.claim_trans_id = CLTF.edw_claim_trans_pk_id \r\n\t AND CLTF.pol_dim_id = PD.pol_dim_id    AND CT.crrnt_snpsht_flag = 1\r\n\t      AND \r\n\t\t\t(CLTF.asl_dim_id in (0,-1) or \r\n\t\t\tCLTF.asl_prdct_code_dim_id in (0,-1) or \r\n\t\t\tCLTF.loss_master_dim_id in (0,-1) or\r\n\t\t\tCLTF.prdct_code_dim_id in (0,-1)\r\n\t\t\t)\r\n\tAND PD.pol_sym <> '000' \r\n\t---- Reading Claim transactions of PMS policies.\r\n\t\r\n\tUNION \r\n\t\r\n\t--- Dummy Transactions mappings delete the rows from claim_loss_transaction_fact with audit_id < 0. So we need to insert Major_Peril 50 --- rows on a daily basis. Below query pull the rows from Claim_transaction and Claim_loss_Transaction_fact \r\n\t\r\n\tSELECT \r\n\tCT.claimant_cov_det_ak_id, \r\n\tCT.claim_pay_ak_id, \r\n\tCT.sar_id, \r\n\tCT.financial_type_code, \r\n\tCT.trans_code, \r\n\tCT.trans_date, \r\n\tCT.trans_ctgry_code, \r\n\tCT.trans_amt, \r\n\tCT.trans_hist_amt, \r\n\tCT.source_sys_id, \r\n\tCLTF.claim_loss_trans_fact_id,\r\n\tCLTF.claim_trans_type_dim_id as wc_stage_pk_id,\r\n\tCLTF.InsuranceReferenceDimId,\r\n\tCLTF.AgencyDimId,\r\n\tCLTF.SalesDivisionDimId,\r\n\tCLTF.InsuranceReferenceCoverageDimId,\r\n\tCLTF.CoverageDetailDimId\r\n\tFROM\r\n\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF , \r\n\t@{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.VW_claim_transaction CT , \r\n\t@{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\tWHERE CLTF.edw_claim_trans_pk_id = CT.claim_trans_id\r\n\tAND CT.claimant_cov_det_ak_id = CCD.claimant_cov_det_ak_id\r\n\tAND CCD.major_peril_code = '050' AND CLTF.audit_id > 0\n),\nEXP_source_input AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tclaim_pay_ak_id,\n\tsar_id,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tsource_sys_id,\n\tclaim_loss_trans_fact_id,\n\tclaim_trans_type_dim_id AS claim_loss_fact_trans_type_dim_id,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId\n\tFROM SQ_claim_transaction_PMSClaims\n),\nUnion AS (\n\tSELECT claimant_cov_det_ak_id, claim_pay_ak_id, sar_id, claim_loss_trans_fact_id, financial_type_code, trans_code, trans_date, trans_ctgry_code, trans_amt, trans_hist_amt, source_sys_id, claim_loss_fact_trans_type_dim_id AS claim_loss_trans_type_dim_id, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId\n\tFROM EXP_source_input\n\tUNION\n\tSELECT claimant_cov_det_ak_id, default_id AS claim_pay_ak_id, sar_id, claim_loss_trans_fact_id, default_value AS financial_type_code, default_value AS trans_code, default_date AS trans_date, default_value AS trans_ctgry_code, default_amount AS trans_amt, default_amount AS trans_hist_amt, source_sys_id, claim_loss_fact_trans_type_dim_id AS claim_loss_trans_type_dim_id, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId\n\tFROM EXP_reinsurance_input\n),\nEXP_merged_union_input_source AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tclaim_pay_ak_id,\n\tsar_id,\n\tclaim_loss_trans_fact_id,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tsource_sys_id,\n\tclaim_loss_trans_type_dim_id,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\r\n\t-- \r\n\t-- \n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date_12312100,\n\tv_trans_date_12312100 AS trans_date_12312100,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId\n\tFROM Union\n),\nLKP_Claimant_Coverage_Detail_PMSClaims AS (\n\tSELECT\n\tpol_ak_id,\n\tpol_key,\n\tmco,\n\tpol_eff_date,\n\tpms_pol_lob_code,\n\tClassOfBusiness,\n\tvariation_code,\n\tClaim_Loss_Date,\n\tloc_unit_num,\n\tsub_loc_unit_num,\n\tins_line,\n\trisk_unit_grp,\n\trisk_unit_grp_seq_num,\n\trisk_unit,\n\trisk_unit_seq_num,\n\trisk_type_ind,\n\tmajor_peril_code,\n\tmajor_peril_seq,\n\tpms_loss_disability,\n\treserve_ctgry,\n\tcause_of_loss,\n\tpms_type_exposure,\n\tpms_type_bureau_code,\n\tclaimant_cov_det_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \r\n\t\tP.pol_ak_id as pol_ak_id,\r\n\t\tP.pol_key             AS pol_key,\r\n\t\tP.mco                    AS mco,\r\n\t\tP.pol_eff_date        AS pol_eff_date,\r\n\t\tP.pms_pol_lob_code    AS pms_pol_lob_code,\r\n\t\tP.ClassOfBusiness as ClassOfBusiness,\r\n\t\tP.variation_code      AS variation_code,\r\n\t\tCO.claim_loss_date as Claim_Loss_Date,  \r\n\t\tAb.loc_unit_num                 AS Loc_unit_num, \r\n\t\tAb.sub_loc_unit_num             AS Sub_loc_unit_num,\r\n\t\tAb.ins_line                     AS Ins_line,  \r\n\t\tAb.risk_unit_grp                AS Risk_unit_grp, \r\n\t\tAb.risk_unit_grp_seq_num        AS Risk_unit_grp_seq_num,  \r\n\t\tAb.risk_unit                    AS Risk_unit, \r\n\t\tAb.risk_unit_seq_num            AS Risk_unit_seq_num, \r\n\t\tAb.risk_type_ind                AS Risk_type_ind,\r\n\t\tAb.major_peril_code             AS Major_peril_code,  \r\n\t\tAb.major_peril_seq              AS Major_peril_seq, \r\n\t\tAb.pms_loss_disability          AS Pms_loss_disability,  \r\n\t\tAb.reserve_ctgry                AS Reserve_ctgry, \r\n\t\tAb.cause_of_loss                AS Cause_of_loss, \r\n\t\tAb.pms_type_exposure            AS Pms_type_exposure,  \r\n\t\tAb.pms_type_bureau_code         AS Pms_type_bureau_code, \r\n\t\tAb.claimant_cov_det_ak_id       AS Claimant_cov_det_ak_id, \r\n\t\tAb.eff_from_date                AS Eff_from_date,  \r\n\t\tAb.eff_to_date                  AS Eff_to_date \r\n\t\tFROM DBO.CLAIMANT_COVERAGE_DETAIL Ab \r\n\t\tINNER JOIN dbo.claim_party_occurrence CPO ON CPO.claim_party_occurrence_ak_id = AB.claim_party_occurrence_ak_id and CPO.crrnt_snpsht_flag=1\r\n\t\tINNER JOIN dbo.claim_occurrence CO on CPO.claim_occurrence_ak_id = CO.claim_occurrence_ak_id and CO.crrnt_snpsht_flag =1\r\n\t\tINNER JOIN V2.policy P on P.pol_ak_id  = CO.pol_key_ak_id and P.crrnt_snpsht_flag = 1\r\n\t\tWHERE ab.PolicySourceID IN ('ESU','PMS')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY pol_ak_id) = 1\n),\nEXP_policy_claim_attribute_outputs AS (\n\tSELECT\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pol_ak_id,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pol_key,\n\t-- *INF*: substr(pol_key,1,3)\n\tsubstr(pol_key, 1, 3) AS pol_symbol,\n\t-- *INF*: substr(pol_key,4,7)\n\tsubstr(pol_key, 4, 7) AS pol_number,\n\t-- *INF*: substr(pol_key,11,2)\n\tsubstr(pol_key, 11, 2) AS pol_mod,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.mco,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pol_eff_date,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pms_pol_lob_code,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.ClassOfBusiness AS pif_clb,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.variation_code,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.Claim_Loss_Date AS claim_loss_date,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.loc_unit_num,\n\t-- *INF*: IIF(loc_unit_num = 'N/A','0000',loc_unit_num)\r\n\t-- \r\n\t-- \r\n\t-- --Adding new rules for Personal Lines policy as the coverage EDW is incorrect.\r\n\t-- ----IIF(loc_unit_num = 'N/A','0000',loc_unit_num)\r\n\t-- \r\n\t-- -----IIF(loc_unit_num = 'N/A','0000',\r\n\t--     --   IIF(SUBSTR(Policy_key,1,1)='H' and SUBSTR(Policy_key,4,1) = '5','0000',loc_unit_num)\r\n\t--        ---)\n\tIFF(loc_unit_num = 'N/A', '0000', loc_unit_num) AS loc_unit_num_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.sub_loc_unit_num,\n\t-- *INF*: IIF(sub_loc_unit_num='N/A','000',sub_loc_unit_num)\n\tIFF(sub_loc_unit_num = 'N/A', '000', sub_loc_unit_num) AS sub_loc_unit_num_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.ins_line,\n\t-- *INF*: IIF(ins_line = 'N/A','NA',ins_line)\n\tIFF(ins_line = 'N/A', 'NA', ins_line) AS ins_line_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.risk_unit_grp,\n\t-- *INF*: IIF(risk_unit_grp = 'N/A','000',risk_unit_grp)\n\tIFF(risk_unit_grp = 'N/A', '000', risk_unit_grp) AS risk_unit_grp_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.risk_unit_grp_seq_num,\n\t-- *INF*: IIF(LENGTH(RTRIM(risk_unit_grp_seq_num))<3,LPAD(RTRIM(risk_unit_grp_seq_num),3,'0'),risk_unit_grp_seq_num)\n\tIFF(LENGTH(RTRIM(risk_unit_grp_seq_num)) < 3, LPAD(RTRIM(risk_unit_grp_seq_num), 3, '0'), risk_unit_grp_seq_num) AS v_risk_unit_grp_seq_num,\n\t-- *INF*: IIF(SUBSTR(v_risk_unit_grp_seq_num,1,2)='N/','NA',SUBSTR(v_risk_unit_grp_seq_num,1,2))\n\tIFF(SUBSTR(v_risk_unit_grp_seq_num, 1, 2) = 'N/', 'NA', SUBSTR(v_risk_unit_grp_seq_num, 1, 2)) AS risk_unit_grp_seq_num_first2_pos,\n\t-- *INF*: IIF(SUBSTR(v_risk_unit_grp_seq_num,3,1)='A','N',SUBSTR(v_risk_unit_grp_seq_num,3,1))\n\tIFF(SUBSTR(v_risk_unit_grp_seq_num, 3, 1) = 'A', 'N', SUBSTR(v_risk_unit_grp_seq_num, 3, 1)) AS risk_unit_grp_seq_num_last_pos,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.risk_unit,\n\t-- *INF*: RTRIM(risk_unit)\n\tRTRIM(risk_unit) AS risk_unit_out,\n\t-- *INF*: SUBSTR(risk_unit,1,3)\r\n\t-- \r\n\t-- \r\n\t-- ---IIF(source_sys_id = 'PMS',SUBSTR(risk_unit,1,3),\r\n\t-- ---IIF(SUBSTR(Policy_key,1,1)='H' and SUBSTR(Policy_key,4,1) = '5',loc_unit_num,SUBSTR(risk_unit,1,3)))\r\n\t-- \r\n\t-- ---SUBSTR(risk_unit,1,3)\n\tSUBSTR(risk_unit, 1, 3) AS v_risk_unit_first3,\n\t-- *INF*: IIF(LENGTH(RTRIM(LTRIM(SUBSTR(risk_unit,4,3))))<3,\r\n\t-- RPAD(RTRIM(LTRIM(SUBSTR(risk_unit,4,3))),3,'0'), RTRIM(LTRIM(SUBSTR(risk_unit,4,3)))\r\n\t-- )\n\tIFF(LENGTH(RTRIM(LTRIM(SUBSTR(risk_unit, 4, 3)))) < 3, RPAD(RTRIM(LTRIM(SUBSTR(risk_unit, 4, 3))), 3, '0'), RTRIM(LTRIM(SUBSTR(risk_unit, 4, 3)))) AS v_risk_unit_last3,\n\tv_risk_unit_first3 || v_risk_unit_last3 AS v_risk_unit_complete,\n\tv_risk_unit_complete AS risk_unit_complete,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.risk_unit_seq_num,\n\t-- *INF*: IIF(risk_unit_seq_num ='0' and risk_type_ind = 'N/A','00',\r\n\t-- IIF(LENGTH(risk_unit_seq_num)=1 and risk_unit_seq_num <> '0' and risk_type_ind = 'N/A', risk_unit_seq_num || '0',risk_unit_seq_num || risk_type_ind ))\n\tIFF(risk_unit_seq_num = '0' AND risk_type_ind = 'N/A', '00', IFF(LENGTH(risk_unit_seq_num) = 1 AND risk_unit_seq_num <> '0' AND risk_type_ind = 'N/A', risk_unit_seq_num || '0', risk_unit_seq_num || risk_type_ind)) AS risk_unit_seq_num_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.risk_type_ind,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.major_peril_code,\n\t-- *INF*: IIF(major_peril_code='N/A','000',major_peril_code)\n\tIFF(major_peril_code = 'N/A', '000', major_peril_code) AS major_peril_code_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.major_peril_seq,\n\t-- *INF*: IIF(major_peril_seq='N/A','00',major_peril_seq)\n\tIFF(major_peril_seq = 'N/A', '00', major_peril_seq) AS major_peril_seq_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pms_loss_disability,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.reserve_ctgry,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.cause_of_loss,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pms_type_exposure,\n\t-- *INF*: IIF(pms_type_exposure = 'N/A','000',pms_type_exposure)\n\tIFF(pms_type_exposure = 'N/A', '000', pms_type_exposure) AS pms_type_exposure_out,\n\tLKP_Claimant_Coverage_Detail_PMSClaims.pms_type_bureau_code,\n\tEXP_merged_union_input_source.claimant_cov_det_ak_id,\n\tEXP_merged_union_input_source.claim_pay_ak_id,\n\tEXP_merged_union_input_source.sar_id,\n\tEXP_merged_union_input_source.claim_loss_trans_fact_id,\n\tEXP_merged_union_input_source.financial_type_code,\n\tEXP_merged_union_input_source.trans_code,\n\tEXP_merged_union_input_source.trans_date,\n\tEXP_merged_union_input_source.trans_ctgry_code,\n\tEXP_merged_union_input_source.trans_amt,\n\tEXP_merged_union_input_source.trans_hist_amt,\n\tEXP_merged_union_input_source.source_sys_id,\n\tEXP_merged_union_input_source.claim_loss_trans_type_dim_id,\n\tEXP_merged_union_input_source.InsuranceReferenceDimId,\n\tEXP_merged_union_input_source.AgencyDimId,\n\tEXP_merged_union_input_source.SalesDivisionDimId,\n\tEXP_merged_union_input_source.InsuranceReferenceCoverageDimId,\n\tEXP_merged_union_input_source.CoverageDetailDimId\n\tFROM EXP_merged_union_input_source\n\tLEFT JOIN LKP_Claimant_Coverage_Detail_PMSClaims\n\tON LKP_Claimant_Coverage_Detail_PMSClaims.claimant_cov_det_ak_id = EXP_merged_union_input_source.claimant_cov_det_ak_id AND LKP_Claimant_Coverage_Detail_PMSClaims.eff_from_date <= EXP_merged_union_input_source.trans_date_12312100 AND LKP_Claimant_Coverage_Detail_PMSClaims.eff_to_date >= EXP_merged_union_input_source.trans_date_12312100\n),\nmplt_Coverage_Temp_Policy_Transaction_Attributes AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_Values AS (\n\t\tSELECT\n\t\tpol_ak_id,\n\t\tloss_id,\n\t\tins_line,\n\t\t-- *INF*: RTRIM(ins_line)\n\t\tRTRIM(ins_line) AS ins_line_out,\n\t\tloc_unit_num,\n\t\t-- *INF*: RTRIM(loc_unit_num)\n\t\tRTRIM(loc_unit_num) AS loc_unit_num1,\n\t\tsub_loc_unit_num,\n\t\t-- *INF*: RTRIM(sub_loc_unit_num)\n\t\tRTRIM(sub_loc_unit_num) AS sub_loc_unit_num1,\n\t\trisk_unit_grp,\n\t\t-- *INF*: RTRIM(risk_unit_grp)\n\t\tRTRIM(risk_unit_grp) AS risk_unit_grp1,\n\t\trisk_unit_grp_seq_num_First_2pos,\n\t\t-- *INF*: RTRIM(risk_unit_grp_seq_num_First_2pos)\n\t\tRTRIM(risk_unit_grp_seq_num_First_2pos) AS risk_unit_grp_seq_num_First_2pos1,\n\t\trisk_unit_grp_seq_num_last_pos,\n\t\t-- *INF*: RTRIM(risk_unit_grp_seq_num_last_pos)\n\t\tRTRIM(risk_unit_grp_seq_num_last_pos) AS risk_unit_grp_seq_num_last_pos1,\n\t\trisk_unit_complete,\n\t\t-- *INF*: RTRIM(risk_unit_complete)\n\t\tRTRIM(risk_unit_complete) AS risk_unit_complete1,\n\t\trisk_unit_seq_num,\n\t\t-- *INF*: RTRIM(risk_unit_seq_num)\n\t\tRTRIM(risk_unit_seq_num) AS risk_unit_seq_num1,\n\t\tpms_type_exposure,\n\t\t-- *INF*: RTRIM(pms_type_exposure)\n\t\tRTRIM(pms_type_exposure) AS pms_type_exposure1,\n\t\tmajor_peril_code,\n\t\t-- *INF*: RTRIM(major_peril_code)\n\t\tRTRIM(major_peril_code) AS major_peril_code1,\n\t\tmajor_peril_seq,\n\t\t-- *INF*: RTRIM(major_peril_seq)\n\t\tRTRIM(major_peril_seq) AS major_peril_seq1,\n\t\tClaim_loss_date\n\t\tFROM INPUT\n\t),\n\tLKP_Coverage_Temp_Policy_Transaction AS (\n\t\tSELECT\n\t\tcov_ak_id,\n\t\ttemp_pol_trans_ak_id,\n\t\tpol_ak_id,\n\t\tsar_id,\n\t\tins_line,\n\t\tloc_unit_num,\n\t\tsub_loc_unit_num,\n\t\trisk_unit_grp,\n\t\trisk_unit_grp_seq_num_First_2pos,\n\t\trisk_unit_grp_seq_num_lastpos,\n\t\trisk_unit,\n\t\trisk_unit_seq_num,\n\t\tmajor_peril_code,\n\t\tmajor_peril_seq_num,\n\t\tpms_type_exposure,\n\t\tcov_eff_date,\n\t\ttype_bureau_code,\n\t\trisk_state_prov_code,\n\t\trisk_zip_code,\n\t\tterr_code,\n\t\ttax_loc,\n\t\tclass_code,\n\t\texposure,\n\t\tsub_line_code,\n\t\tsource_sar_asl,\n\t\tsource_sar_prdct_line,\n\t\tsource_sar_sp_use_code,\n\t\tsource_statistical_code,\n\t\tsection_code,\n\t\trsn_amended_code,\n\t\tpart_code,\n\t\trating_date_ind\n\t\tFROM (\n\t\t\tSELECT  C.cov_ak_id                     AS cov_ak_id,  \r\n\t\t\tTPT.temp_pol_trans_ak_id   AS temp_pol_trans_ak_id,  \r\n\t\t\tCASE  C.pms_type_exposure WHEN 'N/A' THEN '000' ELSE RTRIM(C.pms_type_exposure)   END AS pms_type_exposure,  \r\n\t\t\tC.type_bureau_code              AS type_bureau_code,  \r\n\t\t\tTPT.risk_state_prov_code        AS risk_state_prov_code,  \r\n\t\t\tTPT.risk_zip_code               AS risk_zip_code,  \r\n\t\t\tTPT.terr_code                   AS terr_code,  \r\n\t\t\tTPT.tax_loc                     AS tax_loc,  \r\n\t\t\tTPT.class_code                  AS class_code,  \r\n\t\t\tTPT.exposure                      AS exposure,  \r\n\t\t\tTPT.sub_line_code               AS sub_line_code,  \r\n\t\t\tTPT.source_sar_asl              AS source_sar_asl,  \r\n\t\t\tTPT.source_sar_prdct_line       AS source_sar_prdct_line,  \r\n\t\t\tTPT.source_sar_sp_use_code\t AS source_sar_sp_use_code,  \r\n\t\t\tTPT.source_statistical_code     AS source_statistical_code,  \r\n\t\t\tTPT.section_code                AS section_code,  \r\n\t\t\tTPT.rsn_amended_code            AS rsn_amended_code,  \r\n\t\t\tTPT.part_code                   AS part_code,  \r\n\t\t\tRTRIM(TPT.rating_date_ind)        AS rating_date_ind,  \r\n\t\t\tC.pol_ak_id                     AS pol_ak_id,  \r\n\t\t\tTPT.sar_id                      AS sar_id,  \r\n\t\t\tCASE C.ins_line WHEN 'N/A' THEN 'NA' ELSE RTRIM(C.ins_line) END AS ins_line,  \r\n\t\t\tCASE  C.loc_unit_num  WHEN 'N/A' THEN '0000' ELSE RTRIM(C.loc_unit_num)  END AS loc_unit_num,  \r\n\t\t\tCASE  C.sub_loc_unit_num  WHEN 'N/A' THEN '000' ELSE RTRIM(C.sub_loc_unit_num)   END AS sub_loc_unit_num,  \r\n\t\t\tCASE  C.risk_unit_grp   WHEN 'N/A' THEN '000' ELSE RTRIM(C.risk_unit_grp)    END AS risk_unit_grp,  \r\n\t\t\tCASE  SUBSTRING(C.risk_unit_grp_seq_num,1,2)   WHEN 'N/' THEN 'NA' ELSE SUBSTRING(C.risk_unit_grp_seq_num,1,2) END AS risk_unit_grp_seq_num_First_2pos,  \r\n\t\t\tCASE  SUBSTRING(C.risk_unit_grp_seq_num,3,1)   WHEN 'A' THEN 'N' ELSE SUBSTRING(C.risk_unit_grp_seq_num,3,1) END AS risk_unit_grp_seq_num_lastpos,  \r\n\t\t\tRTRIM(C.risk_unit)               AS risk_unit,  \r\n\t\t\tCASE   C.risk_unit_seq_num   WHEN 'N/A' THEN '00' ELSE  RTRIM(C.risk_unit_seq_num)    END AS risk_unit_seq_num,  \r\n\t\t\tRTRIM(C.major_peril_code)              AS major_peril_code,  \r\n\t\t\tRTRIM(C.major_peril_seq_num)           AS major_peril_seq_num,  \r\n\t\t\tC.cov_eff_date                  AS cov_eff_date \r\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.coverage C \r\n\t\t\tINNER JOIN @{pipeline().parameters.TARGET_TABLE_OWNER}.temp_policy_transaction TPT ON C.cov_ak_id = TPT.cov_ak_id AND C.crrnt_snpsht_flag = 1 AND TPT.crrnt_snpsht_flag = 1\r\n\t\t\tINNER JOIN @{pipeline().parameters.TARGET_TABLE_OWNER}.Claim_Occurrence CO ON CO.pol_key_ak_id = C.pol_ak_id and CO.crrnt_snpsht_flag = 1\r\n\t\t\tINNER JOIN @{pipeline().parameters.TARGET_TABLE_OWNER}.Claim_Party_Occurrence CPO ON CPO.Claim_Occurrence_ak_id = CO.Claim_Occurrence_ak_id and CPO.crrnt_snpsht_flag = 1\r\n\t\t\tINNER JOIN @{pipeline().parameters.TARGET_TABLE_OWNER}.Claimant_Coverage_Detail CCD ON CCD.Claim_Party_Occurrence_ak_id = CPO.Claim_Party_Occurrence_ak_id and CCD.crrnt_snpsht_flag = 1\r\n\t\t\tAND RTRIM(C.risk_unit) = CCD.Risk_unit AND RTRIM(C.major_peril_code)  = CCD.major_peril_code\r\n\t\t\tORDER BY TPT.temp_pol_trans_ak_id   --\r\n\t\t\t\r\n\t\t\t--- Order By clause is important in this Lookup Override because how the data is retrieved is important\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,sar_id,ins_line,loc_unit_num,sub_loc_unit_num,risk_unit_grp,risk_unit_grp_seq_num_First_2pos,risk_unit_grp_seq_num_lastpos,risk_unit,risk_unit_seq_num,major_peril_code,major_peril_seq_num,cov_eff_date ORDER BY cov_ak_id DESC) = 1\n\t),\n\tEXP_Lkp_Values AS (\n\t\tSELECT\n\t\tLKP_Coverage_Temp_Policy_Transaction.temp_pol_trans_ak_id,\n\t\tLKP_Coverage_Temp_Policy_Transaction.cov_ak_id,\n\t\tLKP_Coverage_Temp_Policy_Transaction.pol_ak_id,\n\t\tLKP_Coverage_Temp_Policy_Transaction.sar_id,\n\t\tLKP_Coverage_Temp_Policy_Transaction.ins_line,\n\t\tLKP_Coverage_Temp_Policy_Transaction.loc_unit_num,\n\t\tLKP_Coverage_Temp_Policy_Transaction.sub_loc_unit_num,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_unit_grp,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_unit_grp_seq_num_First_2pos,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_unit_grp_seq_num_lastpos,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_unit,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_unit_seq_num,\n\t\tLKP_Coverage_Temp_Policy_Transaction.major_peril_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.major_peril_seq_num,\n\t\tLKP_Coverage_Temp_Policy_Transaction.pms_type_exposure,\n\t\tLKP_Coverage_Temp_Policy_Transaction.cov_eff_date,\n\t\tLKP_Coverage_Temp_Policy_Transaction.type_bureau_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_state_prov_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.risk_zip_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.terr_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.tax_loc,\n\t\tLKP_Coverage_Temp_Policy_Transaction.class_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.exposure,\n\t\tLKP_Coverage_Temp_Policy_Transaction.sub_line_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.source_sar_asl,\n\t\tLKP_Coverage_Temp_Policy_Transaction.source_sar_prdct_line,\n\t\tLKP_Coverage_Temp_Policy_Transaction.source_sar_sp_use_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.source_statistical_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.section_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.rsn_amended_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.part_code,\n\t\tLKP_Coverage_Temp_Policy_Transaction.rating_date_ind,\n\t\tEXP_Values.Claim_loss_date\n\t\tFROM EXP_Values\n\t\tLEFT JOIN LKP_Coverage_Temp_Policy_Transaction\n\t\tON LKP_Coverage_Temp_Policy_Transaction.pol_ak_id = EXP_Values.pol_ak_id AND LKP_Coverage_Temp_Policy_Transaction.sar_id = EXP_Values.loss_id AND LKP_Coverage_Temp_Policy_Transaction.ins_line = EXP_Values.ins_line_out AND LKP_Coverage_Temp_Policy_Transaction.loc_unit_num = EXP_Values.loc_unit_num1 AND LKP_Coverage_Temp_Policy_Transaction.sub_loc_unit_num = EXP_Values.sub_loc_unit_num1 AND LKP_Coverage_Temp_Policy_Transaction.risk_unit_grp = EXP_Values.risk_unit_grp1 AND LKP_Coverage_Temp_Policy_Transaction.risk_unit_grp_seq_num_First_2pos = EXP_Values.risk_unit_grp_seq_num_First_2pos1 AND LKP_Coverage_Temp_Policy_Transaction.risk_unit_grp_seq_num_lastpos = EXP_Values.risk_unit_grp_seq_num_last_pos1 AND LKP_Coverage_Temp_Policy_Transaction.risk_unit = EXP_Values.risk_unit_complete1 AND LKP_Coverage_Temp_Policy_Transaction.risk_unit_seq_num = EXP_Values.risk_unit_seq_num1 AND LKP_Coverage_Temp_Policy_Transaction.major_peril_code = EXP_Values.major_peril_code1 AND LKP_Coverage_Temp_Policy_Transaction.major_peril_seq_num = EXP_Values.major_peril_seq1 AND LKP_Coverage_Temp_Policy_Transaction.cov_eff_date <= EXP_Values.Claim_loss_date\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_ak_id AS cov_ak_id_Out, \n\t\tpol_ak_id AS pol_ak_id_Out, \n\t\ttemp_pol_trans_ak_id, \n\t\tsar_id AS loss_id_Out, \n\t\tins_line AS ins_line_Out, \n\t\tloc_unit_num AS loc_unit_num_Out, \n\t\tsub_loc_unit_num AS sub_loc_unit_num_Out, \n\t\trisk_unit_grp AS risk_unit_grp_Out, \n\t\trisk_unit_grp_seq_num_First_2pos AS risk_unit_grp_seq_num_First_2pos_Out, \n\t\trisk_unit_grp_seq_num_lastpos AS risk_unit_grp_seq_num_last_pos_Out, \n\t\trisk_unit AS risk_unit_complete_Out, \n\t\trisk_unit_seq_num AS risk_unit_seq_num_Out, \n\t\tmajor_peril_code AS major_peril_code_Out, \n\t\tmajor_peril_seq_num AS major_peril_seq_Out, \n\t\tpms_type_exposure AS pms_type_exposure_Out, \n\t\tcov_eff_date AS cov_eff_date_Out, \n\t\ttype_bureau_code AS type_bureau_code_Out, \n\t\trisk_state_prov_code AS risk_state_prov_code_Out, \n\t\trisk_zip_code AS risk_zip_code_Out, \n\t\tterr_code AS terr_code_Out, \n\t\ttax_loc AS tax_loc_Out, \n\t\tclass_code AS class_code_Out, \n\t\texposure AS exposure_Out, \n\t\tsub_line_code AS sub_line_code_Out, \n\t\tsource_sar_asl AS source_sar_asl_Out, \n\t\tsource_sar_prdct_line AS source_sar_prdct_line_Out, \n\t\tsource_sar_sp_use_code, \n\t\tsource_statistical_code AS source_statistical_code_Out, \n\t\tsource_statistical_line AS source_statistical_line_Out, \n\t\tsection_code AS section_code_Out, \n\t\trsn_amended_code AS rsn_amended_code_Out, \n\t\tpart_code AS part_code_Out, \n\t\trating_date_ind, \n\t\tClaim_loss_date AS Claim_loss_date_Out\n\t\tFROM EXP_Lkp_Values\n\t),\n),\nEXP_Transform_Statistical_Codes AS (\n\tSELECT\n\tsource_statistical_code_Out AS statistical_code,\n\ttype_bureau_code_Out AS Type_Bureau,\n\tclass_code_Out AS sar_class_code,\n\t-- *INF*: statistical_code\r\n\t-- \r\n\t-- --DECODE(TRUE, Type_Bureau = 'BE', ' '  || statistical_code,\r\n\t-- --Type_Bureau = 'BF', ' '  || statistical_code,\r\n\t-- --Type_Bureau = 'RP' AND major_peril = '145', ' '  || statistical_code,\r\n\t-- --Type_Bureau = 'RL' AND major_peril = '114', '  '  || statistical_code,\r\n\t-- --Type_Bureau = 'RL' AND major_peril = '119', '     '  || statistical_code,\r\n\t-- --statistical_code)\r\n\t-- \r\n\t-- ---- Had to introduce space at the begining of the field because of LTRIM(RTRIM)) to statistical codes in Temp_Policy_transaction Table.\n\tstatistical_code AS v_statistical_code,\n\t'D' AS v_stat_plan_id,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,1,1))=0,' ',SUBSTR(v_statistical_code,1,1))\r\n\t-- \r\n\t-- ----8/18/2011 Uma Bollu - Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 1, 1)) = 0, ' ', SUBSTR(v_statistical_code, 1, 1)) AS v_pos_1,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,2,1))=0,' ',SUBSTR(v_statistical_code,2,1))\r\n\t-- \r\n\t-- ----Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 2, 1)) = 0, ' ', SUBSTR(v_statistical_code, 2, 1)) AS v_pos_2,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,3,1))=0,' ',SUBSTR(v_statistical_code,3,1))\r\n\t-- \r\n\t-- ----Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 3, 1)) = 0, ' ', SUBSTR(v_statistical_code, 3, 1)) AS v_pos_3,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,4,1))=0,' ',SUBSTR(v_statistical_code,4,1))\r\n\t-- \r\n\t-- ----Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 4, 1)) = 0, ' ', SUBSTR(v_statistical_code, 4, 1)) AS v_pos_4,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,5,1))=0,' ',SUBSTR(v_statistical_code,5,1))\r\n\t-- \r\n\t-- ----8/18/2011 Uma Bollu - Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 5, 1)) = 0, ' ', SUBSTR(v_statistical_code, 5, 1)) AS v_pos_5,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,6,1))=0,' ',SUBSTR(v_statistical_code,6,1))\r\n\t-- \r\n\t-- \r\n\t-- ----8/18/2011 Uma Bollu - Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 6, 1)) = 0, ' ', SUBSTR(v_statistical_code, 6, 1)) AS v_pos_6,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,7,1))=0,' ',SUBSTR(v_statistical_code,7,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 7, 1)) = 0, ' ', SUBSTR(v_statistical_code, 7, 1)) AS v_pos_7,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,8,1))=0,' ',SUBSTR(v_statistical_code,8,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 8, 1)) = 0, ' ', SUBSTR(v_statistical_code, 8, 1)) AS v_pos_8,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,9,1))=0,' ',SUBSTR(v_statistical_code,9,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 9, 1)) = 0, ' ', SUBSTR(v_statistical_code, 9, 1)) AS v_pos_9,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,10,1))=0,' ',SUBSTR(v_statistical_code,10,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 10, 1)) = 0, ' ', SUBSTR(v_statistical_code, 10, 1)) AS v_pos_10,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,11,1))=0,' ',SUBSTR(v_statistical_code,11,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 11, 1)) = 0, ' ', SUBSTR(v_statistical_code, 11, 1)) AS v_pos_11,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,12,1))=0,' ',SUBSTR(v_statistical_code,12,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 12, 1)) = 0, ' ', SUBSTR(v_statistical_code, 12, 1)) AS v_pos_12,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,13,1))=0,' ',SUBSTR(v_statistical_code,13,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 13, 1)) = 0, ' ', SUBSTR(v_statistical_code, 13, 1)) AS v_pos_13,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,14,1))=0,' ',SUBSTR(v_statistical_code,14,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 14, 1)) = 0, ' ', SUBSTR(v_statistical_code, 14, 1)) AS v_pos_14,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,15,1))=0,' ',SUBSTR(v_statistical_code,15,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 15, 1)) = 0, ' ', SUBSTR(v_statistical_code, 15, 1)) AS v_pos_15,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,16,1))=0,' ',SUBSTR(v_statistical_code,16,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 16, 1)) = 0, ' ', SUBSTR(v_statistical_code, 16, 1)) AS v_pos_16,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,17,1))=0,' ',SUBSTR(v_statistical_code,17,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 17, 1)) = 0, ' ', SUBSTR(v_statistical_code, 17, 1)) AS v_pos_17,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,18,1))=0,' ',SUBSTR(v_statistical_code,18,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 18, 1)) = 0, ' ', SUBSTR(v_statistical_code, 18, 1)) AS v_pos_18,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,19,1))=0,' ',SUBSTR(v_statistical_code,19,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 19, 1)) = 0, ' ', SUBSTR(v_statistical_code, 19, 1)) AS v_pos_19,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,20,1))=0,' ',SUBSTR(v_statistical_code,20,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 20, 1)) = 0, ' ', SUBSTR(v_statistical_code, 20, 1)) AS v_pos_20,\n\t-- *INF*: DECODE(TRUE,Type_Bureau='RP','0',\r\n\t-- LENGTH(SUBSTR(v_statistical_code,21,1))=0,' ',SUBSTR(v_statistical_code,21,1))\r\n\t-- --IIF(LENGTH(SUBSTR(v_statistical_code,21,1))=0,' ',SUBSTR(v_statistical_code,21,1))\r\n\t-- \r\n\t-- \r\n\t-- --- Statistical Code field is initialised at the begining of the WMM01A0 module to all spaces but since it is a sign field for Type Bureau of RP, these are defaulted to '0'\n\tDECODE(TRUE,\n\tType_Bureau = 'RP', '0',\n\tLENGTH(SUBSTR(v_statistical_code, 21, 1)) = 0, ' ',\n\tSUBSTR(v_statistical_code, 21, 1)) AS v_pos_21,\n\t-- *INF*: DECODE(TRUE,Type_Bureau='RP','0',\r\n\t-- LENGTH(SUBSTR(v_statistical_code,22,1))=0,' ',SUBSTR(v_statistical_code,22,1))\r\n\t-- \r\n\t-- --IIF(LENGTH(SUBSTR(v_statistical_code,22,1))=0,' ',SUBSTR(v_statistical_code,22,1))\r\n\t-- \r\n\t-- --- Statistical Code field is initialised at the begining of the WMM01A0 module to all spaces but since it is a sign field for Type Bureau of RP, these are defaulted to '0'\n\tDECODE(TRUE,\n\tType_Bureau = 'RP', '0',\n\tLENGTH(SUBSTR(v_statistical_code, 22, 1)) = 0, ' ',\n\tSUBSTR(v_statistical_code, 22, 1)) AS v_pos_22,\n\t-- *INF*: DECODE(TRUE,Type_Bureau='RP','0',\r\n\t-- LENGTH(SUBSTR(v_statistical_code,23,1))=0,' ',SUBSTR(v_statistical_code,23,1))\r\n\t-- \r\n\t-- --IIF(LENGTH(SUBSTR(v_statistical_code,23,1))=0,' ',SUBSTR(v_statistical_code,23,1))\r\n\t-- \r\n\t-- --- Statistical Code field is initialised at the begining of the WMM01A0 module to all spaces but since it is a sign field for Type Bureau of RP, these are defaulted to '0'\n\tDECODE(TRUE,\n\tType_Bureau = 'RP', '0',\n\tLENGTH(SUBSTR(v_statistical_code, 23, 1)) = 0, ' ',\n\tSUBSTR(v_statistical_code, 23, 1)) AS v_pos_23,\n\t-- *INF*: DECODE(TRUE,Type_Bureau='RP','0',\r\n\t-- LENGTH(SUBSTR(v_statistical_code,24,1))=0,' ',SUBSTR(v_statistical_code,24,1))\r\n\t-- \r\n\t-- --IIF(LENGTH(SUBSTR(v_statistical_code,24,1))=0,' ',SUBSTR(v_statistical_code,24,1))\r\n\t-- \r\n\t-- --- Statistical Code field is initialised at the begining of the WMM01A0 module to all spaces but since it is a sign field for Type Bureau of RP, these are defaulted to '0'\n\tDECODE(TRUE,\n\tType_Bureau = 'RP', '0',\n\tLENGTH(SUBSTR(v_statistical_code, 24, 1)) = 0, ' ',\n\tSUBSTR(v_statistical_code, 24, 1)) AS v_pos_24,\n\t-- *INF*: DECODE(TRUE,Type_Bureau='RP','{',\r\n\t-- LENGTH(SUBSTR(v_statistical_code,25,1))=0,' ',SUBSTR(v_statistical_code,25,1))\r\n\t-- \r\n\t-- --- IN COBOL \"{\" represents a  +ve sign and \"}\" is -ve sign, since this is base rate for Type_Bureau RP is a sign field so COBOL creates \"{\". Replicating the COBOL logic.\r\n\t-- \r\n\t-- --- Statistical Code field is initialised at the begining of the WMM01A0 module to all spaces but since it is a sign field for Type Bureau of RP, these are defaulted to '{'\r\n\t-- \r\n\t-- --IIF(LENGTH(SUBSTR(v_statistical_code,25,1))=0,' ',SUBSTR(v_statistical_code,25,1))\n\tDECODE(TRUE,\n\tType_Bureau = 'RP', '{',\n\tLENGTH(SUBSTR(v_statistical_code, 25, 1)) = 0, ' ',\n\tSUBSTR(v_statistical_code, 25, 1)) AS v_pos_25,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,26,1))=0,' ',SUBSTR(v_statistical_code,26,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 26, 1)) = 0, ' ', SUBSTR(v_statistical_code, 26, 1)) AS v_pos_26,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,27,1))=0,' ',SUBSTR(v_statistical_code,27,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 27, 1)) = 0, ' ', SUBSTR(v_statistical_code, 27, 1)) AS v_pos_27,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,28,1))=0,' ',SUBSTR(v_statistical_code,28,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 28, 1)) = 0, ' ', SUBSTR(v_statistical_code, 28, 1)) AS v_pos_28,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,29,1))=0,' ',SUBSTR(v_statistical_code,29,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 29, 1)) = 0, ' ', SUBSTR(v_statistical_code, 29, 1)) AS v_pos_29,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,30,1))=0,' ',SUBSTR(v_statistical_code,30,1))\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 30, 1)) = 0, ' ', SUBSTR(v_statistical_code, 30, 1)) AS v_pos_30,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,31,1))=0,' ',SUBSTR(v_statistical_code,31,1))\r\n\t-- \r\n\t-- ----8/18/2011 Uma Bollu - Introducing Blank Space intentionally as PIF_4514_Stage has spaces but when we add this data into EDW we do a LTRIM, RTRIM so this Target Lookup finds a match but this Statistical Code calculation we need spaces because of the logic which re-arranges the fields and this is very important for Bureau Reporting etc.\n\tIFF(LENGTH(SUBSTR(v_statistical_code, 31, 1)) = 0, ' ', SUBSTR(v_statistical_code, 31, 1)) AS v_pos_31,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,32,1))=0,' ',SUBSTR(v_statistical_code,32,1))\r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 32, 1)) = 0, ' ', SUBSTR(v_statistical_code, 32, 1)) AS v_pos_32,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,33,1))=0,' ',SUBSTR(v_statistical_code,33,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 33, 1)) = 0, ' ', SUBSTR(v_statistical_code, 33, 1)) AS v_pos_33,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,34,1))=0,' ',SUBSTR(v_statistical_code,34,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 34, 1)) = 0, ' ', SUBSTR(v_statistical_code, 34, 1)) AS v_pos_34,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,35,1))=0,' ',SUBSTR(v_statistical_code,35,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 35, 1)) = 0, ' ', SUBSTR(v_statistical_code, 35, 1)) AS v_pos_35,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,36,1))=0,' ',SUBSTR(v_statistical_code,36,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 36, 1)) = 0, ' ', SUBSTR(v_statistical_code, 36, 1)) AS v_pos_36,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,37,1))=0,' ',SUBSTR(v_statistical_code,37,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 37, 1)) = 0, ' ', SUBSTR(v_statistical_code, 37, 1)) AS v_pos_37,\n\t-- *INF*: IIF(LENGTH(SUBSTR(v_statistical_code,38,1))=0,' ',SUBSTR(v_statistical_code,38,1))\r\n\t-- \r\n\t-- \n\tIFF(LENGTH(SUBSTR(v_statistical_code, 38, 1)) = 0, ' ', SUBSTR(v_statistical_code, 38, 1)) AS v_pos_38,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS Generic,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Code_AC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Codes_AI,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_26 || '       ' || v_pos_25 || v_pos_23  || v_pos_24  || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22)\r\n\t-- \r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_26 || '       ' || v_pos_25 || v_pos_23 || v_pos_24 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 ) AS v_Stat_Codes_AL,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_8 || v_pos_9 || v_pos_10  || v_pos_11|| v_pos_20 || v_pos_21  || \r\n\t-- '             ' ||  v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19  )\r\n\t-- \r\n\t--  -----It has a Filler of 13 spaces\r\n\t-- --- I have checked this code this is fine\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_20 || v_pos_21 || '             ' || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 ) AS v_Stat_Codes_AN,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 ||\r\n\t-- '      ' || v_pos_14 || v_pos_23  || v_pos_24  || '  '  ||  v_pos_26  || v_pos_27  || v_pos_28  || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || '      ' || v_pos_14 || v_pos_23 || v_pos_24 || '  ' || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 ) AS v_Stat_Codes_AP,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_11 || v_pos_10 || \r\n\t--   v_pos_12 || v_pos_13 )\r\n\t-- \r\n\t-- --- Verified the logic\r\n\t-- \n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_11 || v_pos_10 || v_pos_12 || v_pos_13 ) AS v_Stat_Codes_A2,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_11 || v_pos_12 )\r\n\t-- \r\n\t-- --- Verified logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_11 || v_pos_12 ) AS v_Stat_Codes_A3,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 ||\r\n\t-- '           '  ||  v_pos_22 || v_pos_29 || '  ' || v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28)\r\n\t-- \r\n\t-- --- Verified logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || '           ' || v_pos_22 || v_pos_29 || '  ' || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 ) AS v_Stat_Codes_BB,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17  || v_pos_20  || v_pos_27  || v_pos_28  || v_pos_29 || '    ' ||v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26 )\r\n\t-- \r\n\t-- \r\n\t-- -- Verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_20 || v_pos_27 || v_pos_28 || v_pos_29 || '    ' || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 ) AS v_Stat_Codes_BC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_5  || v_pos_6 || v_pos_7)\r\n\t-- \r\n\t-- --- Verified logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_5 || v_pos_6 || v_pos_7 ) AS v_Stat_Codes_BD,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 ||  v_pos_6 || v_pos_7 || '                    ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13)\r\n\t-- \r\n\t-- \r\n\t--  ---  Verified Logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_6 || v_pos_7 || '                    ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 ) AS v_Stat_Codes_BE,\n\t-- *INF*: ('  '  || v_pos_4  || v_pos_5 || ' ' || v_pos_14 || '  ' || v_pos_15 || v_pos_16 || '   ' ||  v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || '     ' || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22 || '   ')\r\n\t-- \r\n\t-- \r\n\t-- --8/22/2011 - Added 2 spaces in the beginning. In COBOL, statitistical code field is initialised to spaces at the start of reformatting. If there is no code to move certain fields then the spaces stay as it is except other fileds are layed out over spaces.\r\n\t-- --- Verified the logic\r\n\t-- \n\t( '  ' || v_pos_4 || v_pos_5 || ' ' || v_pos_14 || '  ' || v_pos_15 || v_pos_16 || '   ' || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || '     ' || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || '   ' ) AS v_Stat_Codes_BF,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_4  || v_pos_5)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_4 || v_pos_5 ) AS v_Stat_Codes_BP,\n\t-- *INF*: (v_pos_1 || v_pos_2 )\r\n\t-- \r\n\t-- --- Verified the logic\n\t( v_pos_1 || v_pos_2 ) AS v_Stat_Codes_BI,\n\t-- *INF*: v_pos_1\r\n\t-- \r\n\t-- -- verified the logic\n\tv_pos_1 AS v_Stat_Codes_BL,\n\t-- *INF*: (SUBSTR(sar_class_code,1,3) || '  ' || v_pos_18  ||  v_pos_19 || v_pos_1 ||  ' ' ||  v_pos_2 || v_pos_3 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 \r\n\t-- || '    ' ||  v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34 || v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28 || '   ' )\r\n\t-- \r\n\t-- --- Verfied the logic\n\t( SUBSTR(sar_class_code, 1, 3) || '  ' || v_pos_18 || v_pos_19 || v_pos_1 || ' ' || v_pos_2 || v_pos_3 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || '    ' || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || '   ' ) AS v_Stat_Codes_BM,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || '      '  ||  v_pos_8 || v_pos_9 || '           ' || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19)\r\n\t-- \r\n\t--  ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || '      ' || v_pos_8 || v_pos_9 || '           ' || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 ) AS v_Stat_Codes_BT,\n\t-- *INF*: (v_pos_1 || v_pos_2 || '      '  || v_pos_9 || v_pos_10 || v_pos_17 || v_pos_18 ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || '      ' || v_pos_9 || v_pos_10 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 ) AS v_Stat_Codes_B2,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17)\r\n\t-- \r\n\t-- ----- verified the logic\r\n\t-- \n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 ) AS v_Stat_Codes_CC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || \r\n\t--  v_pos_17 || v_pos_18  || ' ' ||  v_pos_20 || '              ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_17 || v_pos_18 || ' ' || v_pos_20 || '              ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Codes_CF,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\r\n\t-- \r\n\t-- ---- Generic \r\n\t-- -- No Change from Input copybook to Output\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Code_CR,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_6 || v_pos_7 || ' '  || v_pos_9 || '  ' || v_pos_12 || ' ' || v_pos_14 || v_pos_15 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_6 || v_pos_7 || ' ' || v_pos_9 || '  ' || v_pos_12 || ' ' || v_pos_14 || v_pos_15 ) AS v_Stat_Codes_CI,\n\t-- *INF*: (v_pos_1 || v_pos_4  || v_pos_6 || v_pos_7 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_4 || v_pos_6 || v_pos_7 ) AS v_Stat_Codes_CL,\n\t-- *INF*: ('  ' || v_pos_1 || v_pos_2 || v_pos_5  || v_pos_6 || v_pos_7)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( '  ' || v_pos_1 || v_pos_2 || v_pos_5 || v_pos_6 || v_pos_7 ) AS v_Stat_Codes_CP,\n\t-- *INF*: (v_pos_3 || v_pos_4  || v_pos_5 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_3 || v_pos_4 || v_pos_5 ) AS v_Stat_Codes_CN,\n\t-- *INF*: v_pos_1\r\n\t-- \r\n\t-- -----\n\tv_pos_1 AS v_Stat_Codes_EI,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_6 || v_pos_7 || '                   ' ||v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16)\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- --- 19 spaces\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_7 || '                   ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Codes_EQ,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 ) AS v_Stat_Codes_FC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 \r\n\t-- || '                  ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 )\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- ---- 18 Spaces\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || '                  ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Codes_FF,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 ) AS v_Stat_Codes_FM,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || '                   ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16)\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- --- 19 spaces\r\n\t-- \n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || '                   ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 ) AS v_Stat_Codes_FO,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 ) AS v_Stat_Codes_FP,\n\t-- *INF*: (v_pos_1 || v_pos_2 || ' ' || v_pos_3 || '  ' || v_pos_6 || v_pos_7 || '   ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 ||\r\n\t-- '       ' || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22 || '   ')\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || ' ' || v_pos_3 || '  ' || v_pos_6 || v_pos_7 || '   ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || '       ' || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || '   ' ) AS v_Stat_Codes_FT,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_12 || v_pos_13 || '                '  || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9)\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- -- 17 Spaces\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_12 || v_pos_13 || '                ' || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 ) AS v_Stat_Codes_GI,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_6 || v_pos_7 || v_pos_4  || v_pos_5  || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || '      ' || v_pos_13 || v_pos_29  || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19 ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_6 || v_pos_7 || v_pos_4 || v_pos_5 || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || '      ' || v_pos_13 || v_pos_29 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 ) AS v_Stat_Codes_GL,\n\t-- *INF*: (v_pos_1 || '           '  ||   v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7)\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- \n\t( v_pos_1 || '           ' || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 ) AS v_Stat_Codes_GP,\n\t-- *INF*: (v_pos_1 || '                       ' || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_11 || v_pos_12 || v_pos_13)\r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- --- 23 spaces\r\n\t-- \r\n\t-- \r\n\t-- \n\t( v_pos_1 || '                       ' || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_11 || v_pos_12 || v_pos_13 ) AS v_Stat_Codes_GS,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_10 || ' ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_18  ||  v_pos_19  \r\n\t-- || ' ' || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || '                ')\r\n\t-- \r\n\t-- \r\n\t-- ---- verified the logic\r\n\t-- --- 16 Spaces at the end\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_10 || ' ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_18 || v_pos_19 || ' ' || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || '                ' ) AS v_Stat_Codes_HO,\n\t-- *INF*: ('        ' || v_pos_11 || v_pos_12 || '               '  || v_pos_4  || v_pos_5  || v_pos_6  || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_14 || v_pos_15 || v_pos_17)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( '        ' || v_pos_11 || v_pos_12 || '               ' || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_14 || v_pos_15 || v_pos_17 ) AS v_Stat_Codes_IM,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  || v_pos_24  || v_pos_25  || v_pos_26 || v_pos_28  || v_pos_29  || v_pos_30 || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 ) AS v_Stat_Codes_JR,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  )\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 ) AS v_Stat_Codes_ME,\n\t-- *INF*: (v_pos_1 || ' '  || v_pos_3 || v_pos_4  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_10 || ' ' ||  v_pos_11 || v_pos_12 || v_pos_13 || '  ' || v_pos_18  || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || ' ' || '                ' ) \r\n\t-- \r\n\t-- --- need logic for stat-plan -id\r\n\t-- ---- 16 Spaces at the end\n\t( v_pos_1 || ' ' || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_10 || ' ' || v_pos_11 || v_pos_12 || v_pos_13 || '  ' || v_pos_18 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || ' ' || '                ' ) AS v_Stat_Codes_MH,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || '                  '  || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7)\r\n\t-- \r\n\t--  --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || '                  ' || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 ) AS v_Stat_Codes_MI,\n\t-- *INF*: (v_pos_6 || v_pos_7 || v_pos_3 || v_pos_4  || v_pos_2 || '      ' || v_pos_1 || '        ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || ' ' ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24 )\r\n\t-- \r\n\t--  --- verified the logic\n\t( v_pos_6 || v_pos_7 || v_pos_3 || v_pos_4 || v_pos_2 || '      ' || v_pos_1 || '        ' || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || ' ' || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 ) AS v_Stat_Codes_ML,\n\t-- *INF*: -- No Stats code in the Output Copybook just the policy_type logic\n\t'' AS v_Stat_Codes_MP,\n\t-- *INF*: (SUBSTR(sar_class_code,1,3) || v_pos_17 || v_pos_18 ||  v_pos_19  || v_pos_1 || v_pos_2 || v_pos_3 || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || '   ' || '       ' || '      ' )\r\n\t-- \r\n\t-- --- Need to look at complete logic\r\n\t-- \n\t( SUBSTR(sar_class_code, 1, 3) || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_1 || v_pos_2 || v_pos_3 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || '   ' || '       ' || '      ' ) AS v_Stat_Codes_M2,\n\t-- *INF*: ( '                 ' || v_stat_plan_id)\r\n\t-- \r\n\t-- ----verified the logic\n\t( '                 ' || v_stat_plan_id ) AS v_Stat_Codes_NE,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  ||  v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_19)\r\n\t-- \r\n\t-- --- Verified the Logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_19 ) AS v_Stat_Codes_PC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || ' ' || v_pos_19  || v_pos_20  ||  v_pos_21)\r\n\t-- \r\n\t-- --- verified the logic\r\n\t--  \n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || ' ' || v_pos_19 || v_pos_20 || v_pos_21 ) AS v_Stat_Codes_PH,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Code_PF,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Code_PI,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Code_PL,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 ||  v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 ) AS v_Stat_Codes_PM,\n\t-- *INF*: (v_pos_1 || v_pos_2)\r\n\t-- \r\n\t-- --- verified the logic\r\n\t-- \n\t( v_pos_1 || v_pos_2 ) AS v_Stat_Codes_RB,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 ) AS v_Stat_Codes_RG,\n\t-- *INF*: (v_pos_1 || v_pos_2)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 ) AS v_Stat_Codes_RI,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 ) AS v_Stat_Codes_RL,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_8 || v_pos_9 || v_pos_10)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_8 || v_pos_9 || v_pos_10 ) AS v_Stat_Codes_RM,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || ' ' || \r\n\t-- v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21 || v_pos_22 ||  v_pos_23  || v_pos_24)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || ' ' || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 ) AS v_Stat_Codes_RN,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29 || v_pos_30 || v_pos_31|| v_pos_33 || v_pos_34  ||  v_pos_35  || v_pos_32)\r\n\t-- \r\n\t-- ----\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_32 ) AS v_Stat_Codes_RP,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5 )\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 ) AS v_Stat_Codes_RQ,\n\t-- *INF*: (v_pos_1 || ' ' || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 )\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || ' ' || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 ) AS v_Stat_Codes_SM,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_6 || v_pos_8 || v_pos_11 || v_pos_9)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_6 || v_pos_8 || v_pos_11 || v_pos_9 ) AS v_Stat_Codes_TH,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 \r\n\t-- || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19\r\n\t-- ||  v_pos_22  ||  v_pos_23  || v_pos_24 || '       ' || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36)\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_22 || v_pos_23 || v_pos_24 || '       ' || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 ) AS v_Stat_Codes_VL,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19 \r\n\t--  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30 || ' ' || v_pos_32  ||  v_pos_33\r\n\t-- || v_pos_34  ||  v_pos_35  || v_pos_36 )\r\n\t-- \r\n\t-- --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || ' ' || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 ) AS v_Stat_Codes_VP,\n\t-- *INF*: ('   ' || v_pos_4  || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12  || ' ' || v_pos_14 || v_pos_15 || '              ' \r\n\t-- || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34 || v_pos_35)\r\n\t-- \r\n\t-- --- verified the logic\n\t( '   ' || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || ' ' || v_pos_14 || v_pos_15 || '              ' || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 ) AS v_Stat_Codes_VN,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  \r\n\t-- || ' ' || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || '    ' || v_pos_36 || v_pos_37  || v_pos_38)\r\n\t-- \r\n\t-- ---- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || ' ' || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || '    ' || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Codes_VC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31)\r\n\t-- \r\n\t--  --- verified the logic\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 ) AS v_Stat_Codes_WC,\n\t-- *INF*: (v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4  || v_pos_5  || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18  ||  v_pos_19  || v_pos_20  ||  v_pos_21  ||  v_pos_22  ||  v_pos_23  || v_pos_24  || v_pos_25  || v_pos_26  || v_pos_27  || v_pos_28  || v_pos_29  || v_pos_30  || v_pos_31 || v_pos_32  ||  v_pos_33  || v_pos_34  ||  v_pos_35  || v_pos_36 || v_pos_37  || v_pos_38)\n\t( v_pos_1 || v_pos_2 || v_pos_3 || v_pos_4 || v_pos_5 || v_pos_6 || v_pos_7 || v_pos_8 || v_pos_9 || v_pos_10 || v_pos_11 || v_pos_12 || v_pos_13 || v_pos_14 || v_pos_15 || v_pos_16 || v_pos_17 || v_pos_18 || v_pos_19 || v_pos_20 || v_pos_21 || v_pos_22 || v_pos_23 || v_pos_24 || v_pos_25 || v_pos_26 || v_pos_27 || v_pos_28 || v_pos_29 || v_pos_30 || v_pos_31 || v_pos_32 || v_pos_33 || v_pos_34 || v_pos_35 || v_pos_36 || v_pos_37 || v_pos_38 ) AS v_Stat_Code_WP,\n\t-- *INF*: ('   ' || v_pos_1 || v_pos_2 || '            ' || v_stat_plan_id)\r\n\t-- \r\n\t-- --8/19/2011 Added v_stat_plan_id\r\n\t-- --- need to bring stat plan_id\r\n\t--  --- verified the logic but need stat plan id\r\n\t-- \n\t( '   ' || v_pos_1 || v_pos_2 || '            ' || v_stat_plan_id ) AS v_Stat_Codes_WL,\n\t-- *INF*: DECODE(Type_Bureau, 'AC', v_Stat_Code_AC, 'AI', v_Stat_Codes_AI, 'AL', v_Stat_Codes_AL, 'AN', v_Stat_Codes_AN, 'AP', v_Stat_Codes_AP, 'A2', v_Stat_Codes_A2, 'A3', v_Stat_Codes_A3, 'BB', v_Stat_Codes_BB, 'BC', v_Stat_Codes_BC, 'BD', v_Stat_Codes_BD, 'BE', v_Stat_Codes_BE, 'BF', v_Stat_Codes_BF, 'BP', v_Stat_Codes_BP, 'BI', v_Stat_Codes_BI, 'BL', v_Stat_Codes_BL, 'BM', v_Stat_Codes_BM, 'BT', v_Stat_Codes_BT, 'B2', v_Stat_Codes_B2, 'CC', v_Stat_Codes_CC, 'CF', v_Stat_Codes_CF, 'CI', v_Stat_Codes_CI, 'CL', v_Stat_Codes_CL, 'CN', v_Stat_Codes_CN, 'CP', v_Stat_Codes_CP, 'EI', v_Stat_Codes_EI, 'EQ', v_Stat_Codes_EQ, 'FC', v_Stat_Codes_FC, 'FF', v_Stat_Codes_FF, 'FM', v_Stat_Codes_FM, 'FO', v_Stat_Codes_FO, 'FP', v_Stat_Codes_FP, 'FT', v_Stat_Codes_FT, 'GI', v_Stat_Codes_GI, 'GL', v_Stat_Codes_GL, 'GP', v_Stat_Codes_GP, 'GS', v_Stat_Codes_GS, 'HO', v_Stat_Codes_HO, 'IM', v_Stat_Codes_IM, 'JR', v_Stat_Codes_JR, 'ME', v_Stat_Codes_ME, 'MH', v_Stat_Codes_MH, 'MI', v_Stat_Codes_MI, 'ML',\r\n\t-- v_Stat_Codes_ML, 'MP', v_Stat_Codes_MP, 'M2', v_Stat_Codes_M2, 'NE', v_Stat_Codes_NE, 'PC', v_Stat_Codes_PC, 'PH', v_Stat_Codes_PH, 'PM', v_Stat_Codes_PM, 'RB', v_Stat_Codes_RB, 'RG', v_Stat_Codes_RG, 'RI', v_Stat_Codes_RI, 'RL', v_Stat_Codes_RL, 'RM', v_Stat_Codes_RM, 'RN', v_Stat_Codes_RN, 'RP', v_Stat_Codes_RP, 'RQ', v_Stat_Codes_RQ, 'SM', v_Stat_Codes_SM, 'TH', v_Stat_Codes_TH, 'VL', v_Stat_Codes_VL, 'VP', v_Stat_Codes_VP, 'VN', v_Stat_Codes_VN, 'VC', v_Stat_Codes_VC, 'WC', v_Stat_Codes_WC, 'WL', v_Stat_Codes_WL,\r\n\t-- 'CR', v_Stat_Code_CR, 'PF', v_Stat_Code_PF,'PI', v_Stat_Code_PI, 'PL', v_Stat_Code_PL,\r\n\t-- 'WP', v_Stat_Code_WP,v_statistical_code) \n\tDECODE(Type_Bureau,\n\t'AC', v_Stat_Code_AC,\n\t'AI', v_Stat_Codes_AI,\n\t'AL', v_Stat_Codes_AL,\n\t'AN', v_Stat_Codes_AN,\n\t'AP', v_Stat_Codes_AP,\n\t'A2', v_Stat_Codes_A2,\n\t'A3', v_Stat_Codes_A3,\n\t'BB', v_Stat_Codes_BB,\n\t'BC', v_Stat_Codes_BC,\n\t'BD', v_Stat_Codes_BD,\n\t'BE', v_Stat_Codes_BE,\n\t'BF', v_Stat_Codes_BF,\n\t'BP', v_Stat_Codes_BP,\n\t'BI', v_Stat_Codes_BI,\n\t'BL', v_Stat_Codes_BL,\n\t'BM', v_Stat_Codes_BM,\n\t'BT', v_Stat_Codes_BT,\n\t'B2', v_Stat_Codes_B2,\n\t'CC', v_Stat_Codes_CC,\n\t'CF', v_Stat_Codes_CF,\n\t'CI', v_Stat_Codes_CI,\n\t'CL', v_Stat_Codes_CL,\n\t'CN', v_Stat_Codes_CN,\n\t'CP', v_Stat_Codes_CP,\n\t'EI', v_Stat_Codes_EI,\n\t'EQ', v_Stat_Codes_EQ,\n\t'FC', v_Stat_Codes_FC,\n\t'FF', v_Stat_Codes_FF,\n\t'FM', v_Stat_Codes_FM,\n\t'FO', v_Stat_Codes_FO,\n\t'FP', v_Stat_Codes_FP,\n\t'FT', v_Stat_Codes_FT,\n\t'GI', v_Stat_Codes_GI,\n\t'GL', v_Stat_Codes_GL,\n\t'GP', v_Stat_Codes_GP,\n\t'GS', v_Stat_Codes_GS,\n\t'HO', v_Stat_Codes_HO,\n\t'IM', v_Stat_Codes_IM,\n\t'JR', v_Stat_Codes_JR,\n\t'ME', v_Stat_Codes_ME,\n\t'MH', v_Stat_Codes_MH,\n\t'MI', v_Stat_Codes_MI,\n\t'ML', v_Stat_Codes_ML,\n\t'MP', v_Stat_Codes_MP,\n\t'M2', v_Stat_Codes_M2,\n\t'NE', v_Stat_Codes_NE,\n\t'PC', v_Stat_Codes_PC,\n\t'PH', v_Stat_Codes_PH,\n\t'PM', v_Stat_Codes_PM,\n\t'RB', v_Stat_Codes_RB,\n\t'RG', v_Stat_Codes_RG,\n\t'RI', v_Stat_Codes_RI,\n\t'RL', v_Stat_Codes_RL,\n\t'RM', v_Stat_Codes_RM,\n\t'RN', v_Stat_Codes_RN,\n\t'RP', v_Stat_Codes_RP,\n\t'RQ', v_Stat_Codes_RQ,\n\t'SM', v_Stat_Codes_SM,\n\t'TH', v_Stat_Codes_TH,\n\t'VL', v_Stat_Codes_VL,\n\t'VP', v_Stat_Codes_VP,\n\t'VN', v_Stat_Codes_VN,\n\t'VC', v_Stat_Codes_VC,\n\t'WC', v_Stat_Codes_WC,\n\t'WL', v_Stat_Codes_WL,\n\t'CR', v_Stat_Code_CR,\n\t'PF', v_Stat_Code_PF,\n\t'PI', v_Stat_Code_PI,\n\t'PL', v_Stat_Code_PL,\n\t'WP', v_Stat_Code_WP,\n\tv_statistical_code) AS V_Formatted_Stat_Codes,\n\t-- *INF*: SUBSTR(V_Formatted_Stat_Codes,1,25)\n\tSUBSTR(V_Formatted_Stat_Codes, 1, 25) AS Formatted_Stat_Codes,\n\t-- *INF*: SUBSTR(V_Formatted_Stat_Codes,26,9)\n\tSUBSTR(V_Formatted_Stat_Codes, 26, 9) AS Formatted_Stat_Codes_26_34,\n\t-- *INF*: SUBSTR(V_Formatted_Stat_Codes,35,4)\n\tSUBSTR(V_Formatted_Stat_Codes, 35, 4) AS Formatted_Stat_Codes_34_38,\n\t-- *INF*: DECODE(Type_Bureau,'AI', (v_pos_11 || v_pos_12),\r\n\t-- 'AL', (v_pos_15  ||  v_pos_16),\r\n\t-- 'AN',(v_pos_12 || v_pos_13),\r\n\t-- 'AP',(v_pos_12 || v_pos_13),\r\n\t-- 'A2',(v_pos_8 || v_pos_9),\r\n\t-- 'A3',(v_pos_8 || v_pos_9),\r\n\t-- 'BB',(v_pos_20 || v_pos_21),\r\n\t-- 'BC',(v_pos_18 || v_pos_19),\r\n\t-- 'BE', ( v_pos_4  || v_pos_5),\r\n\t-- 'BF', (v_pos_1  ||  v_pos_2),\r\n\t-- 'BP', (' '  ||  v_pos_2),\r\n\t-- 'BI', (v_pos_3 ||  v_pos_4),\r\n\t-- 'BL', (v_pos_3  ||  v_pos_4),\r\n\t-- 'BM',(v_pos_20 || v_pos_21),\r\n\t-- 'BT', (v_pos_11  ||  v_pos_12),\r\n\t-- 'B2',(v_pos_14  ||  v_pos_15),\r\n\t-- 'CF', (v_pos_8  || v_pos_9),\r\n\t-- 'CI',(v_pos_3  ||  v_pos_4),\r\n\t-- 'CN', (v_pos_1  ||  v_pos_2),\r\n\t-- 'CP', (v_pos_3  ||  v_pos_4),\r\n\t-- 'EI', (v_pos_2  ||  v_pos_3),\r\n\t-- 'EQ', (v_pos_8  || v_pos_9),\r\n\t-- 'FF', (v_pos_8  || v_pos_9),\r\n\t-- 'FI', (v_pos_1  ||  v_pos_2),\r\n\t-- 'FM', (v_pos_6  ||  v_pos_7),\r\n\t-- 'FO', (v_pos_8  || v_pos_9),\r\n\t-- 'FP', (v_pos_2  ||  v_pos_3),\r\n\t-- 'FT', (v_pos_4  ||  v_pos_5),\r\n\t-- 'GI', (v_pos_10  ||  v_pos_11),\r\n\t-- 'GL',(v_pos_20 || v_pos_21),\r\n\t-- 'GM', (v_pos_1  ||  v_pos_2),\r\n\t-- 'GP', (v_pos_8  || v_pos_9),\r\n\t-- 'GS',(v_pos_3  ||  v_pos_4),\r\n\t-- 'II', (v_pos_1  ||  v_pos_2),\r\n\t-- 'IM', (v_pos_1  ||  v_pos_2),\r\n\t-- 'MI',(v_pos_10  ||  v_pos_11),\r\n\t-- 'ML', (v_pos_16  ||  v_pos_17),\r\n\t-- 'MP', (v_pos_1  ||  v_pos_2),\r\n\t-- 'M2', (v_pos_15  ||  v_pos_16),'  ')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(Type_Bureau,\n\t'AI', ( v_pos_11 || v_pos_12 ),\n\t'AL', ( v_pos_15 || v_pos_16 ),\n\t'AN', ( v_pos_12 || v_pos_13 ),\n\t'AP', ( v_pos_12 || v_pos_13 ),\n\t'A2', ( v_pos_8 || v_pos_9 ),\n\t'A3', ( v_pos_8 || v_pos_9 ),\n\t'BB', ( v_pos_20 || v_pos_21 ),\n\t'BC', ( v_pos_18 || v_pos_19 ),\n\t'BE', ( v_pos_4 || v_pos_5 ),\n\t'BF', ( v_pos_1 || v_pos_2 ),\n\t'BP', ( ' ' || v_pos_2 ),\n\t'BI', ( v_pos_3 || v_pos_4 ),\n\t'BL', ( v_pos_3 || v_pos_4 ),\n\t'BM', ( v_pos_20 || v_pos_21 ),\n\t'BT', ( v_pos_11 || v_pos_12 ),\n\t'B2', ( v_pos_14 || v_pos_15 ),\n\t'CF', ( v_pos_8 || v_pos_9 ),\n\t'CI', ( v_pos_3 || v_pos_4 ),\n\t'CN', ( v_pos_1 || v_pos_2 ),\n\t'CP', ( v_pos_3 || v_pos_4 ),\n\t'EI', ( v_pos_2 || v_pos_3 ),\n\t'EQ', ( v_pos_8 || v_pos_9 ),\n\t'FF', ( v_pos_8 || v_pos_9 ),\n\t'FI', ( v_pos_1 || v_pos_2 ),\n\t'FM', ( v_pos_6 || v_pos_7 ),\n\t'FO', ( v_pos_8 || v_pos_9 ),\n\t'FP', ( v_pos_2 || v_pos_3 ),\n\t'FT', ( v_pos_4 || v_pos_5 ),\n\t'GI', ( v_pos_10 || v_pos_11 ),\n\t'GL', ( v_pos_20 || v_pos_21 ),\n\t'GM', ( v_pos_1 || v_pos_2 ),\n\t'GP', ( v_pos_8 || v_pos_9 ),\n\t'GS', ( v_pos_3 || v_pos_4 ),\n\t'II', ( v_pos_1 || v_pos_2 ),\n\t'IM', ( v_pos_1 || v_pos_2 ),\n\t'MI', ( v_pos_10 || v_pos_11 ),\n\t'ML', ( v_pos_16 || v_pos_17 ),\n\t'MP', ( v_pos_1 || v_pos_2 ),\n\t'M2', ( v_pos_15 || v_pos_16 ),\n\t'  ') AS V_Policy_Type,\n\tV_Policy_Type AS Policy_Type,\n\t-- *INF*: SUBSTR(sar_class_code,1,3)\n\tSUBSTR(sar_class_code, 1, 3) AS v_sar_class_3,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN (Type_Bureau,'BP','FP','BF','FT'),V_Policy_Type)\n\tDECODE(TRUE,\n\tIN(Type_Bureau, 'BP', 'FP', 'BF', 'FT'), V_Policy_Type) AS v_type_policy_45,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- Type_Bureau='BP',v_pos_2,\r\n\t-- Type_Bureau='BF',v_pos_2,\r\n\t-- Type_Bureau='FP',' ',\r\n\t-- Type_Bureau='FT',' '  )\n\tDECODE(TRUE,\n\tType_Bureau = 'BP', v_pos_2,\n\tType_Bureau = 'BF', v_pos_2,\n\tType_Bureau = 'FP', ' ',\n\tType_Bureau = 'FT', ' ') AS v_type_of_bond_6,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  IN(Type_Bureau,'BP','BF','FP','FT'),v_sar_class_3  || v_type_policy_45 || v_type_of_bond_6,\r\n\t-- sar_class_code)\n\tDECODE(TRUE,\n\tIN(Type_Bureau, 'BP', 'BF', 'FP', 'FT'), v_sar_class_3 || v_type_policy_45 || v_type_of_bond_6,\n\tsar_class_code) AS v_hold_sar_class_code,\n\tv_hold_sar_class_code AS sar_class_code_out\n\tFROM mplt_Coverage_Temp_Policy_Transaction_Attributes\n),\nLKP_gtamTM08_stage AS (\n\tSELECT\n\tcoverage_code,\n\tmajor_peril\n\tFROM (\n\t\tSELECT gtam_tm08_stage.coverage_code as coverage_code, \r\n\t\tRTRIM(gtam_tm08_stage.major_peril) as major_peril \r\n\t\tFROM gtam_tm08_stage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY major_peril ORDER BY coverage_code DESC) = 1\n),\nEXP_Derive_Values AS (\n\tSELECT\n\tEXP_policy_claim_attribute_outputs.pol_symbol AS Policy_Symbol,\n\tEXP_policy_claim_attribute_outputs.ins_line,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(ins_line)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(ins_line) AS ins_line_Out,\n\tEXP_policy_claim_attribute_outputs.loc_unit_num_out AS loc_unit_num,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(loc_unit_num)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(loc_unit_num) AS loc_unit_num_out,\n\tEXP_policy_claim_attribute_outputs.risk_unit_grp_out AS risk_unit_grp,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(risk_unit_grp)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(risk_unit_grp) AS risk_unit_grp_out,\n\tEXP_policy_claim_attribute_outputs.risk_unit_out AS risk_unit,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(risk_unit)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(risk_unit) AS risk_unit_out,\n\tEXP_policy_claim_attribute_outputs.major_peril_code_out AS major_peril_code_source,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(major_peril_code_source)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(major_peril_code_source) AS major_peril_code_out,\n\tEXP_policy_claim_attribute_outputs.cause_of_loss,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(cause_of_loss)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(cause_of_loss) AS cause_of_loss_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.type_bureau_code_Out AS type_bureau_code,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.risk_state_prov_code_Out AS risk_state_prov_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(risk_state_prov_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(risk_state_prov_code) AS risk_state_prov_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.risk_zip_code_Out AS risk_zip_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(risk_zip_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(risk_zip_code) AS risk_zip_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.terr_code_Out AS terr_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(terr_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(terr_code) AS terr_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.tax_loc_Out AS tax_loc,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRING_NUMERIC(tax_loc)\n\t:UDF.DEFAULT_VALUE_FOR_STRING_NUMERIC(tax_loc) AS tax_loc_Out,\n\tEXP_Transform_Statistical_Codes.sar_class_code_out AS class_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(class_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(class_code) AS class_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.exposure_Out AS exposure,\n\t-- *INF*: IIF(isnull(exposure),0,exposure)\n\tIFF(exposure IS NULL, 0, exposure) AS exposure_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.sub_line_code_Out AS sub_line_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sub_line_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sub_line_code) AS sub_line_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.source_sar_asl_Out AS source_sar_asl,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_asl)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_asl) AS source_sar_asl_Out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.source_sar_prdct_line_Out AS source_sar_prdct_line,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_prdct_line)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_prdct_line) AS source_sar_prdct_line_Out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.source_sar_sp_use_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_sp_use_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_sar_sp_use_code) AS source_sar_sp_use_code_out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.source_statistical_code_Out,\n\tmplt_Coverage_Temp_Policy_Transaction_Attributes.source_statistical_line_Out AS source_statistical_line_Out_unused,\n\tEXP_Transform_Statistical_Codes.Formatted_Stat_Codes AS source_statistical_code1,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code1)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code1) AS source_statistical_code1_out,\n\tEXP_Transform_Statistical_Codes.Formatted_Stat_Codes_26_34 AS source_statistical_code2,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code2)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code2) AS source_statistical_code2_out,\n\tEXP_Transform_Statistical_Codes.Formatted_Stat_Codes_34_38 AS source_statistical_code3,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code3)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(source_statistical_code3) AS source_statistical_code3_out,\n\t-- *INF*: DECODE(TRUE,IN( type_bureau_code,'AL','LP','AI','LI','RL'), '100',\r\n\t-- IN( type_bureau_code,'GS','GM','RG'),'400',\r\n\t-- IN( type_bureau_code,'WC','WP'),'500',\r\n\t-- IN( type_bureau_code,'GL','GI','GN','RQ'),'600',\r\n\t-- IN( type_bureau_code,'FF','FM','BF','BP','FT','FP'),'711',\r\n\t-- IN( type_bureau_code,'BD'),'722',\r\n\t-- IN( type_bureau_code,'BI','BT','RB'),'800')\n\tDECODE(TRUE,\n\tIN(type_bureau_code, 'AL', 'LP', 'AI', 'LI', 'RL'), '100',\n\tIN(type_bureau_code, 'GS', 'GM', 'RG'), '400',\n\tIN(type_bureau_code, 'WC', 'WP'), '500',\n\tIN(type_bureau_code, 'GL', 'GI', 'GN', 'RQ'), '600',\n\tIN(type_bureau_code, 'FF', 'FM', 'BF', 'BP', 'FT', 'FP'), '711',\n\tIN(type_bureau_code, 'BD'), '722',\n\tIN(type_bureau_code, 'BI', 'BT', 'RB'), '800') AS V_Statistical_Line,\n\t-- *INF*: IIF(ISNULL(V_Statistical_Line),'N/A',V_Statistical_Line)\n\tIFF(V_Statistical_Line IS NULL, 'N/A', V_Statistical_Line) AS Statistical_Line,\n\tEXP_Transform_Statistical_Codes.Policy_Type AS policy_type,\n\tLKP_gtamTM08_stage.coverage_code,\n\t-- *INF*: IIF(ISNULL(coverage_code),'N/A',coverage_code)\n\tIFF(coverage_code IS NULL, 'N/A', coverage_code) AS coverage_code_out,\n\t-1 AS Default_Id,\n\t'N/A' AS Default_NA,\n\t-- *INF*: SUBSTR(source_sar_prdct_line,1,2)\n\tSUBSTR(source_sar_prdct_line, 1, 2) AS statistical_brkdwn_line,\n\tEXP_policy_claim_attribute_outputs.mco,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(mco)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(mco) AS mco_out,\n\tEXP_policy_claim_attribute_outputs.pol_eff_date,\n\tEXP_policy_claim_attribute_outputs.pms_pol_lob_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(pms_pol_lob_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(pms_pol_lob_code) AS pms_pol_lob_code_out,\n\tEXP_policy_claim_attribute_outputs.pif_clb,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(pif_clb)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(pif_clb) AS pif_clb_out,\n\tEXP_policy_claim_attribute_outputs.variation_code,\n\t-- *INF*: IIF(IN(pms_pol_lob_code,'ACA','AFA','APA','ATA','ACJ','AFJ','APJ'),'6',variation_code)\n\tIFF(IN(pms_pol_lob_code, 'ACA', 'AFA', 'APA', 'ATA', 'ACJ', 'AFJ', 'APJ'), '6', variation_code) AS variation_code_out,\n\tEXP_policy_claim_attribute_outputs.claimant_cov_det_ak_id,\n\tEXP_policy_claim_attribute_outputs.pms_type_bureau_code,\n\tEXP_policy_claim_attribute_outputs.claim_loss_trans_fact_id AS claim_loss_transaction_fact_id,\n\tEXP_policy_claim_attribute_outputs.financial_type_code,\n\tEXP_policy_claim_attribute_outputs.trans_code,\n\tEXP_policy_claim_attribute_outputs.trans_date,\n\tEXP_policy_claim_attribute_outputs.trans_ctgry_code,\n\tEXP_policy_claim_attribute_outputs.trans_amt,\n\tEXP_policy_claim_attribute_outputs.trans_hist_amt,\n\tEXP_policy_claim_attribute_outputs.source_sys_id,\n\tEXP_policy_claim_attribute_outputs.claim_loss_trans_type_dim_id AS claim_loss_fact_trans_type_dim_id,\n\tEXP_policy_claim_attribute_outputs.InsuranceReferenceDimId,\n\tEXP_policy_claim_attribute_outputs.AgencyDimId,\n\tEXP_policy_claim_attribute_outputs.SalesDivisionDimId,\n\tEXP_policy_claim_attribute_outputs.InsuranceReferenceCoverageDimId,\n\tEXP_policy_claim_attribute_outputs.CoverageDetailDimId\n\tFROM EXP_Transform_Statistical_Codes\n\t -- Manually join with EXP_policy_claim_attribute_outputs\n\t -- Manually join with mplt_Coverage_Temp_Policy_Transaction_Attributes\n\tLEFT JOIN LKP_gtamTM08_stage\n\tON LKP_gtamTM08_stage.major_peril = EXP_policy_claim_attribute_outputs.major_peril_code_out\n),\nEXP_converge AS (\n\tSELECT\n\trisk_state_prov_code_out AS risk_state_prov_code1,\n\t-- *INF*: ltrim(rtrim(risk_state_prov_code1))\n\tltrim(rtrim(risk_state_prov_code1)) AS risk_state_prov_code_out,\n\trisk_zip_code_out AS risk_zip_code1,\n\t-- *INF*: rtrim(ltrim(risk_zip_code1))\n\trtrim(ltrim(risk_zip_code1)) AS risk_zip_code_out,\n\tterr_code_out AS terr_code1,\n\t-- *INF*: ltrim(rtrim(terr_code1))\n\tltrim(rtrim(terr_code1)) AS terr_code_out,\n\ttax_loc_Out AS tax_loc1,\n\t-- *INF*: rtrim(ltrim(tax_loc1))\n\trtrim(ltrim(tax_loc1)) AS tax_loc_out,\n\tclass_code_out AS class_code1,\n\t-- *INF*: rtrim(ltrim(class_code1))\n\trtrim(ltrim(class_code1)) AS class_code_out,\n\texposure_out AS exposure,\n\tsub_line_code_out AS sub_line_code1,\n\t-- *INF*: rtrim(ltrim(sub_line_code1))\n\trtrim(ltrim(sub_line_code1)) AS sub_line_code_out,\n\tsource_sar_asl_Out AS source_sar_asl1,\n\t-- *INF*: rtrim(ltrim(source_sar_asl1))\n\trtrim(ltrim(source_sar_asl1)) AS source_sar_asl_out,\n\tsource_sar_prdct_line_Out AS source_sar_prdct_line1,\n\t-- *INF*: rtrim(ltrim(source_sar_prdct_line1))\n\trtrim(ltrim(source_sar_prdct_line1)) AS source_sar_prdct_line_out,\n\tsource_sar_sp_use_code_out AS source_sar_sp_use_code1,\n\t-- *INF*: rtrim(ltrim(source_sar_sp_use_code1))\n\trtrim(ltrim(source_sar_sp_use_code1)) AS source_sar_sp_use_code_out,\n\tsource_statistical_code_Out AS source_statistical_code,\n\tsource_statistical_code1_out AS statistical_code1,\n\t-- *INF*: ltrim(rtrim(statistical_code1))\n\tltrim(rtrim(statistical_code1)) AS statistical_code1_out,\n\tsource_statistical_code2_out AS statistical_code2,\n\t-- *INF*: ltrim(rtrim(statistical_code2))\n\tltrim(rtrim(statistical_code2)) AS statistical_code2_out,\n\tsource_statistical_code3_out AS statistical_code3,\n\t-- *INF*: ltrim(rtrim(statistical_code3))\n\tltrim(rtrim(statistical_code3)) AS statistical_code3_out,\n\tStatistical_Line AS source_statistical_line,\n\t-- *INF*: ltrim(rtrim(source_statistical_line))\n\tltrim(rtrim(source_statistical_line)) AS source_statistical_line_out,\n\tvariation_code_out AS variation_code,\n\t-- *INF*: ltrim(rtrim(variation_code))\n\tltrim(rtrim(variation_code)) AS variation_code_out,\n\tDefault_NA AS auto_reins_facility,\n\t-- *INF*: ltrim(rtrim(auto_reins_facility))\n\tltrim(rtrim(auto_reins_facility)) AS auto_reins_facility_out,\n\tstatistical_brkdwn_line AS statistical_brkdwn_line1,\n\t-- *INF*: rtrim(ltrim(statistical_brkdwn_line1))\n\trtrim(ltrim(statistical_brkdwn_line1)) AS statistical_brkdwn_line_out,\n\tpolicy_type AS Policy_Type,\n\t-- *INF*: --IIF(ISNULL(Policy_Type),'N/A',Policy_Type)\r\n\t-- -- go back to UDF\r\n\t-- :UDF.DEFAULT_VALUE_FOR_STRINGS(Policy_Type)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(Policy_Type) AS policy_type_out,\n\tcoverage_code_out AS coverage_code_in,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(coverage_code_in)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(coverage_code_in) AS coverage_code_out\n\tFROM EXP_Derive_Values\n),\nLKP_loss_master_dim AS (\n\tSELECT\n\tloss_master_dim_id,\n\trisk_state_prov_code,\n\trisk_zip_code,\n\tterr_code,\n\ttax_loc,\n\tclass_code,\n\texposure,\n\tsub_line_code,\n\tsource_sar_asl,\n\tsource_sar_prdct_line,\n\tsource_sar_sp_use_code,\n\tsource_statistical_line,\n\tvariation_code,\n\tpol_type,\n\tauto_reins_facility,\n\tstatistical_brkdwn_line,\n\tstatistical_code1,\n\tstatistical_code2,\n\tstatistical_code3,\n\tloss_master_cov_code\n\tFROM (\n\t\tSELECT loss_master_dim.loss_master_dim_id      AS loss_master_dim_id,\r\n\t\t       ltrim(rtrim(loss_master_dim.risk_state_prov_code))    AS risk_state_prov_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.risk_zip_code))           AS risk_zip_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.terr_code))               AS terr_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.tax_loc))                 AS tax_loc,\r\n\t\t       ltrim(rtrim(loss_master_dim.class_code))              AS class_code,\r\n\t\t       loss_master_dim.exposure                AS exposure,\r\n\t\t       ltrim(rtrim(loss_master_dim.sub_line_code))           AS sub_line_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_asl))          AS source_sar_asl,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_prdct_line))   AS source_sar_prdct_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_sp_use_code))  AS source_sar_sp_use_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_statistical_line)) AS source_statistical_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.variation_code))          AS variation_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.pol_type))                AS pol_type,\r\n\t\t       ltrim(rtrim(loss_master_dim.auto_reins_facility))     AS auto_reins_facility,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_brkdwn_line)) AS statistical_brkdwn_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code1))       AS statistical_code1,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code2))       AS statistical_code2,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code3))       AS statistical_code3,\r\n\t\t       ltrim(rtrim(loss_master_dim.loss_master_cov_code))    AS loss_master_cov_code\r\n\t\tFROM   loss_master_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY risk_state_prov_code,risk_zip_code,terr_code,tax_loc,class_code,exposure,sub_line_code,source_sar_asl,source_sar_prdct_line,source_sar_sp_use_code,source_statistical_line,variation_code,pol_type,auto_reins_facility,statistical_brkdwn_line,statistical_code1,statistical_code2,statistical_code3,loss_master_cov_code ORDER BY loss_master_dim_id DESC) = 1\n),\nmplt_hierarchy_product_mapping AS (WITH\n\tINPUT_hierarchy_product_input AS (\n\t\t\n\t),\n\tEXP_input AS (\n\t\tSELECT\n\t\tSymbol AS symbol,\n\t\t-- *INF*: iif(symbol <> 'N/A',substr(symbol,1,2),symbol)\n\t\tIFF(symbol <> 'N/A', substr(symbol, 1, 2), symbol) AS symbol_2pos,\n\t\tClass_of_Business AS class_of_business,\n\t\tLine_of_Business AS line_of_business,\n\t\tInsurance_Line AS insurance_line,\n\t\tType_Bureau AS type_bureau,\n\t\tMajor_Peril AS major_peril,\n\t\tClass_Code AS class_code,\n\t\tSub_Line AS sub_line,\n\t\tRisk_Unit_Group AS risk_unit_group,\n\t\tEff_Date AS eff_date\n\t\tFROM INPUT_hierarchy_product_input\n\t),\n\tEXP_apply_product_rules AS (\n\t\tSELECT\n\t\tsymbol_2pos,\n\t\tclass_of_business,\n\t\tline_of_business,\n\t\tinsurance_line,\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\tclass_code,\n\t\tsub_line,\n\t\trisk_unit_group,\n\t\teff_date,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IN(symbol_2pos,'CP','NS') AND insurance_line='GL' AND IN(major_peril,'530','599') AND RTRIM(class_code)='99999' AND IN(sub_line,'334','336'),'320',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CP','NS') AND type_bureau='IM','550',\r\n\t\t-- \r\n\t\t-- symbol_2pos='CP' AND insurance_line='GL' AND sub_line='365','380',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos, 'CP','NS') AND insurance_line='GL' AND IN(major_peril,'599','919') AND IN(risk_unit_group,'345','367'),'300',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos, 'CP','NS') AND insurance_line='GL' AND IN(major_peril,'530','540','919','599') AND RTRIM(class_code) <>'99999' AND NOT IN(risk_unit_group,'345','346','355','900','901','367','286','365'),'300',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CF','CP','NS') AND IN(insurance_line,'BM','CF','CG','CR','GS','N/A') AND NOT IN(type_bureau,'AL','AP','AN','GL','IM'),'500',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'BC','BD','BG','BH','CA','CP','NB','NS','NA','XX') AND IN(insurance_line,'N/A','CA')  AND IN(type_bureau,'AL','AP','AN'),'200',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CP','NS') AND insurance_line='GL' AND risk_unit_group='355','370',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'BA','BB','XX') AND IN(line_of_business,'BOP','BO') AND NOT IN(insurance_line,'CA'),'400',\r\n\t\t-- \r\n\t\t-- symbol_2pos='CM' AND insurance_line='GL' AND IN(risk_unit_group,'901','902','903'),'360',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CP','NS') AND insurance_line='GL'  AND risk_unit_group='345','365',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CU','NU','CP','UC') AND type_bureau='GL' AND IN(major_peril,'517'),'900',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'BC','BD') AND IN(insurance_line,'CF','GL','CR','IM','CG','N/A') ,'410',\r\n\t\t-- \r\n\t\t-- symbol_2pos='CP' AND insurance_line='GL'  AND risk_unit_group='346','321',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'NA','NB') AND IN(insurance_line,'CF','GL','CR','IM','CG'),'430',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'BG','BH','GG') AND IN(insurance_line,'CF','GL','CR','IM','GA','CG','N/A'),'420',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NF' AND IN(class_of_business,'XN','XO','XP','XQ'),'620',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CD','CM') AND IN(risk_unit_group,'367','900'),'350',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'BA','BB') AND insurance_line='GL' AND IN(risk_unit_group,'110','111'),'200',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'CP','NS') AND insurance_line='GA','340',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'HH','HA','HB','HX','IB','IP','PA','PX','XX') AND IN(type_bureau,'PH','PI','PL','PQ','MS'),'800',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NF' AND class_of_business = '9','510',\r\n\t\t-- \r\n\t\t-- ----IN(Line_of_Business,'APV','ASV','FP','HP','IMP'),'810',  'Personal Lines Monoline',\r\n\t\t-- \r\n\t\t-- symbol_2pos='BO','450',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'GL','XX') AND IN(major_peril,'084','085'),'300',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NN','310',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NK','311',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NE','330',\r\n\t\t-- \r\n\t\t-- major_peril='032','100',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NC','610',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NJ','630',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NL','640',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NM','650',\r\n\t\t-- \r\n\t\t-- symbol_2pos='NO','660',\r\n\t\t-- \r\n\t\t-- symbol_2pos='FF','510',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'FL','FP') AND IN(type_bureau,'PF','PQ','MS'),'820',\r\n\t\t-- \r\n\t\t-- symbol_2pos='HH' AND type_bureau='PF','820',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'HH','PA','PM','PP','PS','PT','HA','XX','XA') AND IN(type_bureau,'RL','RP','RN'),'850',\r\n\t\t-- \r\n\t\t-- IN(symbol_2pos,'HH','UP','HX','XX') AND type_bureau ='GL' AND major_peril='017','890',\r\n\t\t-- \r\n\t\t-- '000')\n\t\tDECODE(TRUE,\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GL' AND IN(major_peril, '530', '599') AND RTRIM(class_code) = '99999' AND IN(sub_line, '334', '336'), '320',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND type_bureau = 'IM', '550',\n\t\tsymbol_2pos = 'CP' AND insurance_line = 'GL' AND sub_line = '365', '380',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GL' AND IN(major_peril, '599', '919') AND IN(risk_unit_group, '345', '367'), '300',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GL' AND IN(major_peril, '530', '540', '919', '599') AND RTRIM(class_code) <> '99999' AND NOT IN(risk_unit_group, '345', '346', '355', '900', '901', '367', '286', '365'), '300',\n\t\tIN(symbol_2pos, 'CF', 'CP', 'NS') AND IN(insurance_line, 'BM', 'CF', 'CG', 'CR', 'GS', 'N/A') AND NOT IN(type_bureau, 'AL', 'AP', 'AN', 'GL', 'IM'), '500',\n\t\tIN(symbol_2pos, 'BC', 'BD', 'BG', 'BH', 'CA', 'CP', 'NB', 'NS', 'NA', 'XX') AND IN(insurance_line, 'N/A', 'CA') AND IN(type_bureau, 'AL', 'AP', 'AN'), '200',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GL' AND risk_unit_group = '355', '370',\n\t\tIN(symbol_2pos, 'BA', 'BB', 'XX') AND IN(line_of_business, 'BOP', 'BO') AND NOT IN(insurance_line, 'CA'), '400',\n\t\tsymbol_2pos = 'CM' AND insurance_line = 'GL' AND IN(risk_unit_group, '901', '902', '903'), '360',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GL' AND risk_unit_group = '345', '365',\n\t\tIN(symbol_2pos, 'CU', 'NU', 'CP', 'UC') AND type_bureau = 'GL' AND IN(major_peril, '517'), '900',\n\t\tIN(symbol_2pos, 'BC', 'BD') AND IN(insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG', 'N/A'), '410',\n\t\tsymbol_2pos = 'CP' AND insurance_line = 'GL' AND risk_unit_group = '346', '321',\n\t\tIN(symbol_2pos, 'NA', 'NB') AND IN(insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG'), '430',\n\t\tIN(symbol_2pos, 'BG', 'BH', 'GG') AND IN(insurance_line, 'CF', 'GL', 'CR', 'IM', 'GA', 'CG', 'N/A'), '420',\n\t\tsymbol_2pos = 'NF' AND IN(class_of_business, 'XN', 'XO', 'XP', 'XQ'), '620',\n\t\tIN(symbol_2pos, 'CD', 'CM') AND IN(risk_unit_group, '367', '900'), '350',\n\t\tIN(symbol_2pos, 'BA', 'BB') AND insurance_line = 'GL' AND IN(risk_unit_group, '110', '111'), '200',\n\t\tIN(symbol_2pos, 'CP', 'NS') AND insurance_line = 'GA', '340',\n\t\tIN(symbol_2pos, 'HH', 'HA', 'HB', 'HX', 'IB', 'IP', 'PA', 'PX', 'XX') AND IN(type_bureau, 'PH', 'PI', 'PL', 'PQ', 'MS'), '800',\n\t\tsymbol_2pos = 'NF' AND class_of_business = '9', '510',\n\t\tsymbol_2pos = 'BO', '450',\n\t\tIN(symbol_2pos, 'GL', 'XX') AND IN(major_peril, '084', '085'), '300',\n\t\tsymbol_2pos = 'NN', '310',\n\t\tsymbol_2pos = 'NK', '311',\n\t\tsymbol_2pos = 'NE', '330',\n\t\tmajor_peril = '032', '100',\n\t\tsymbol_2pos = 'NC', '610',\n\t\tsymbol_2pos = 'NJ', '630',\n\t\tsymbol_2pos = 'NL', '640',\n\t\tsymbol_2pos = 'NM', '650',\n\t\tsymbol_2pos = 'NO', '660',\n\t\tsymbol_2pos = 'FF', '510',\n\t\tIN(symbol_2pos, 'FL', 'FP') AND IN(type_bureau, 'PF', 'PQ', 'MS'), '820',\n\t\tsymbol_2pos = 'HH' AND type_bureau = 'PF', '820',\n\t\tIN(symbol_2pos, 'HH', 'PA', 'PM', 'PP', 'PS', 'PT', 'HA', 'XX', 'XA') AND IN(type_bureau, 'RL', 'RP', 'RN'), '850',\n\t\tIN(symbol_2pos, 'HH', 'UP', 'HX', 'XX') AND type_bureau = 'GL' AND major_peril = '017', '890',\n\t\t'000') AS v_product_code,\n\t\tv_product_code AS product_code_out\n\t\tFROM EXP_input\n\t),\n\tLKP_product_code_dim AS (\n\t\tSELECT\n\t\tprdct_code_dim_id,\n\t\tprdct_code,\n\t\tprdct_code_descript,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tproduct_code_dim.prdct_code_dim_id as prdct_code_dim_id,\r\n\t\t\tproduct_code_dim.prdct_code as prdct_code, \r\n\t\t\tproduct_code_dim.prdct_code_descript as prdct_code_descript, product_code_dim.eff_from_date as eff_from_date, \r\n\t\t\tproduct_code_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tproduct_code_dim\r\n\t\t\twhere\r\n\t\t\tcrrnt_snpsht_flag=1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY prdct_code,eff_from_date,eff_to_date ORDER BY prdct_code_dim_id) = 1\n\t),\n\tEXP_validate_dim_id AS (\n\t\tSELECT\n\t\tprdct_code_dim_id,\n\t\t-- *INF*: IIF(isnull(prdct_code_dim_id),-1,prdct_code_dim_id)\n\t\tIFF(prdct_code_dim_id IS NULL, - 1, prdct_code_dim_id) AS prdct_code_dim_id_out,\n\t\tprdct_code_descript,\n\t\t-- *INF*: IIF(isnull(prdct_code_descript),'N/A',rtrim(ltrim(prdct_code_descript)))\n\t\tIFF(prdct_code_descript IS NULL, 'N/A', rtrim(ltrim(prdct_code_descript))) AS prdct_code_descript_out,\n\t\tprdct_code,\n\t\t-- *INF*: IIF(isnull(prdct_code),'N/A',rtrim(ltrim(prdct_code)))\n\t\tIFF(prdct_code IS NULL, 'N/A', rtrim(ltrim(prdct_code))) AS prdct_code_out\n\t\tFROM LKP_product_code_dim\n\t),\n\tOUTPUT_hierarchy_product_code AS (\n\t\tSELECT\n\t\tprdct_code_out AS code, \n\t\tprdct_code_descript_out AS name, \n\t\tprdct_code_dim_id_out AS prdct_code_dim_id\n\t\tFROM EXP_validate_dim_id\n\t),\n),\nEXP_prepare_ASL_input AS (\n\tSELECT\n\tEXP_Derive_Values.Policy_Symbol AS pol_sym,\n\tEXP_Derive_Values.mco_out AS mco,\n\tEXP_Derive_Values.pif_clb_out AS pif_clb,\n\tEXP_Derive_Values.pms_pol_lob_code_out AS pms_pol_lob_code,\n\tEXP_Derive_Values.major_peril_code_out AS major_peril_code,\n\tEXP_Derive_Values.pms_type_bureau_code AS type_bureau_code,\n\tEXP_Derive_Values.risk_unit_grp_out AS risk_unit_grp,\n\tEXP_Derive_Values.risk_unit_out AS risk_unit,\n\tEXP_Derive_Values.loc_unit_num_out AS loc_unit_num,\n\tEXP_Derive_Values.cause_of_loss_out AS cause_of_loss,\n\tLKP_loss_master_dim.loss_master_dim_id AS lkp_loss_master_dim_id,\n\t-- *INF*: IIF(isnull(lkp_loss_master_dim_id),-1,lkp_loss_master_dim_id)\n\tIFF(lkp_loss_master_dim_id IS NULL, - 1, lkp_loss_master_dim_id) AS loss_master_dim_id,\n\t-- *INF*: Decode(TRUE,\r\n\t-- substr(pol_sym,1,1)='N','N',\r\n\t-- in(substr(pol_sym,1,1),'R','S','T') and pms_pol_lob_code='WCP','N',\r\n\t-- in(substr(pol_sym,1,1),'A','J','L'),'A',\r\n\t-- 'W')\n\tDecode(TRUE,\n\tsubstr(pol_sym, 1, 1) = 'N', 'N',\n\tin(substr(pol_sym, 1, 1), 'R', 'S', 'T') AND pms_pol_lob_code = 'WCP', 'N',\n\tin(substr(pol_sym, 1, 1), 'A', 'J', 'L'), 'A',\n\t'W') AS reporting_dvsn_code,\n\tEXP_Derive_Values.sub_line_code_out,\n\tEXP_Derive_Values.class_code_out,\n\tEXP_Derive_Values.claimant_cov_det_ak_id,\n\tEXP_Derive_Values.claim_loss_transaction_fact_id,\n\tEXP_Derive_Values.financial_type_code,\n\tEXP_Derive_Values.trans_code,\n\tEXP_Derive_Values.trans_date,\n\tEXP_Derive_Values.trans_ctgry_code,\n\tEXP_Derive_Values.trans_amt,\n\tEXP_Derive_Values.trans_hist_amt,\n\tEXP_Derive_Values.source_sys_id,\n\tmplt_hierarchy_product_mapping.prdct_code_dim_id,\n\tEXP_Derive_Values.claim_loss_fact_trans_type_dim_id,\n\tEXP_Derive_Values.pol_eff_date,\n\tEXP_Derive_Values.InsuranceReferenceDimId,\n\tEXP_Derive_Values.AgencyDimId,\n\tEXP_Derive_Values.SalesDivisionDimId,\n\tEXP_Derive_Values.InsuranceReferenceCoverageDimId,\n\tEXP_Derive_Values.CoverageDetailDimId\n\tFROM EXP_Derive_Values\n\t -- Manually join with mplt_hierarchy_product_mapping\n\tLEFT JOIN LKP_loss_master_dim\n\tON LKP_loss_master_dim.risk_state_prov_code = EXP_converge.risk_state_prov_code_out AND LKP_loss_master_dim.risk_zip_code = EXP_converge.risk_zip_code_out AND LKP_loss_master_dim.terr_code = EXP_converge.terr_code_out AND LKP_loss_master_dim.tax_loc = EXP_converge.tax_loc_out AND LKP_loss_master_dim.class_code = EXP_converge.class_code_out AND LKP_loss_master_dim.exposure = EXP_converge.exposure AND LKP_loss_master_dim.sub_line_code = EXP_converge.sub_line_code_out AND LKP_loss_master_dim.source_sar_asl = EXP_converge.source_sar_asl_out AND LKP_loss_master_dim.source_sar_prdct_line = EXP_converge.source_sar_prdct_line_out AND LKP_loss_master_dim.source_sar_sp_use_code = EXP_converge.source_sar_sp_use_code_out AND LKP_loss_master_dim.source_statistical_line = EXP_converge.source_statistical_line_out AND LKP_loss_master_dim.variation_code = EXP_converge.variation_code_out AND LKP_loss_master_dim.pol_type = EXP_converge.policy_type_out AND LKP_loss_master_dim.auto_reins_facility = EXP_converge.auto_reins_facility_out AND LKP_loss_master_dim.statistical_brkdwn_line = EXP_converge.statistical_brkdwn_line_out AND LKP_loss_master_dim.statistical_code1 = EXP_converge.statistical_code1_out AND LKP_loss_master_dim.statistical_code2 = EXP_converge.statistical_code2_out AND LKP_loss_master_dim.statistical_code3 = EXP_converge.statistical_code3_out AND LKP_loss_master_dim.loss_master_cov_code = EXP_converge.coverage_code_out\n),\nmplt_ASL_Policy_Symbol_Changes AS (WITH\n\tIN_ASL_Policy_Symbol_Changes AS (\n\t\t\n\t),\n\tEXP_accept_inputs AS (\n\t\tSELECT\n\t\tsymbol,\n\t\tline_of_business,\n\t\tmaster_co_number,\n\t\tmajor_peril,\n\t\ttype_bureau\n\t\tFROM IN_ASL_Policy_Symbol_Changes\n\t),\n\tEXP_3000_check_sys38_policy AS (\n\t\tSELECT\n\t\tsymbol,\n\t\tline_of_business,\n\t\tmaster_co_number,\n\t\tmajor_peril,\n\t\ttype_bureau,\n\t\t-- *INF*: decode(substr(symbol,1,2) ,\r\n\t\t-- 'HX',1,\r\n\t\t-- 'PX',1,\r\n\t\t-- 'WM',1,\r\n\t\t-- 'WX',1,\r\n\t\t-- 'XA',1,\r\n\t\t-- 'XX',1, \r\n\t\t-- 'DU',1,\r\n\t\t-- 0)\n\t\tdecode(substr(symbol, 1, 2),\n\t\t'HX', 1,\n\t\t'PX', 1,\n\t\t'WM', 1,\n\t\t'WX', 1,\n\t\t'XA', 1,\n\t\t'XX', 1,\n\t\t'DU', 1,\n\t\t0) AS symbol_change,\n\t\t-- *INF*: substr(symbol,3,1)\n\t\tsubstr(symbol, 3, 1) AS v_symbol_3,\n\t\t-- *INF*: IIF(symbol_change=1,\r\n\t\t-- \tDECODE(TRUE,\r\n\t\t-- \t\tline_of_business='HAP' and type_bureau !='GL', 'HH',\r\n\t\t-- \t\tline_of_business='APV','PA',\r\n\t\t-- \t\trtrim(ltrim(line_of_business))='HP' and master_co_number='06','HA',\r\n\t\t-- \t\trtrim(ltrim(line_of_business))='HP' and master_co_number='05', 'HB',\r\n\t\t-- \t\tline_of_business='IMP','IP',\r\n\t\t-- \t\tline_of_business='HAP' and type_bureau='GL' , 'HH',\r\n\t\t-- \t\trtrim(ltrim(line_of_business))='GL' and major_peril='017','UP', \r\n\t\t-- \tsubstr(symbol,1,2)\r\n\t\t-- \t)\r\n\t\t--   ,substr(symbol,1,2)\r\n\t\t-- )\r\n\t\t-- \r\n\t\t-- --IIF(line_of_business='HAP' and type_bureau !='GL', 'HH',\r\n\t\t-- --\tIIF(line_of_business='APV','PA',\r\n\t\t-- --\t\tIIF(rtrim(ltrim(line_of_business))='HP' and master_co_number='06','HA',\r\n\t\t-- --\t\t\tIIF(rtrim(ltrim(line_of_business))='HP' and master_co_number='05', 'HB',\r\n\t\t-- --\t\t\t\tIIF(line_of_business='IMP','IP',\r\n\t\t-- --\t\t\t\t\tIIF(line_of_business='HAP' and type_bureau='GL' , 'HH',\r\n\t\t-- --\t\t\t\t\t\tIIF(rtrim(ltrim(line_of_business))='GL' and major_peril='017','UP', \r\n\t\t-- --\t\t\t\t\t\tsubstr(symbol,1,2))\r\n\t\t-- --\t\t\t\t\t)\r\n\t\t-- --\t\t\t\t)\r\n\t\t-- --\t\t\t)\r\n\t\t-- --\t\t)\r\n\t\t-- --\t)\r\n\t\t-- --)\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(symbol_change = 1, DECODE(TRUE,\n\t\tline_of_business = 'HAP' AND type_bureau != 'GL', 'HH',\n\t\tline_of_business = 'APV', 'PA',\n\t\trtrim(ltrim(line_of_business)) = 'HP' AND master_co_number = '06', 'HA',\n\t\trtrim(ltrim(line_of_business)) = 'HP' AND master_co_number = '05', 'HB',\n\t\tline_of_business = 'IMP', 'IP',\n\t\tline_of_business = 'HAP' AND type_bureau = 'GL', 'HH',\n\t\trtrim(ltrim(line_of_business)) = 'GL' AND major_peril = '017', 'UP',\n\t\tsubstr(symbol, 1, 2)), substr(symbol, 1, 2)) AS v_symbol_1_2,\n\t\t-- *INF*: IIF(symbol_change=1,\r\n\t\t-- \tIIF(line_of_business='HAP' and type_bureau='GL', '017',major_peril)\r\n\t\t-- ,major_peril)\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(symbol_change = 1, IFF(line_of_business = 'HAP' AND type_bureau = 'GL', '017', major_peril), major_peril) AS v_major_peril,\n\t\t-- *INF*: IIF(symbol_change=1,\r\n\t\t-- \tIIF(rtrim(ltrim(line_of_business))='GL' and major_peril='017','GL',type_bureau)\r\n\t\t-- ,type_bureau)\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(symbol_change = 1, IFF(rtrim(ltrim(line_of_business)) = 'GL' AND major_peril = '017', 'GL', type_bureau), type_bureau) AS v_type_bureau,\n\t\t-- *INF*: concat(v_symbol_1_2,v_symbol_3)\n\t\tconcat(v_symbol_1_2, v_symbol_3) AS symbol_out,\n\t\tv_major_peril AS major_peril_out,\n\t\tv_type_bureau AS type_bureau_out\n\t\tFROM EXP_accept_inputs\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tsymbol_out AS symbol, \n\t\tmajor_peril_out AS major_peril, \n\t\ttype_bureau_out AS type_bureau\n\t\tFROM EXP_3000_check_sys38_policy\n\t),\n),\nEXP_asl_mapplet_bridge AS (\n\tSELECT\n\tsymbol1 AS symbol,\n\tmajor_peril1 AS major_peril,\n\ttype_bureau1 AS type_bureau\n\tFROM mplt_ASL_Policy_Symbol_Changes\n),\nmplt_ASL_WBC8827B_Product_Coverage_Codes AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_accept_inputs AS (\n\t\tSELECT\n\t\tsymbol,\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\tunit_number,\n\t\tlocation_number,\n\t\tclass_of_business,\n\t\tsubline,\n\t\tclass_code,\n\t\trisk_unit_group,\n\t\tloss_cause,\n\t\tnsi_indicator,\n\t\tpolicy_effective_date,\n\t\t-- *INF*: IIF(ISNULL(policy_effective_date),TO_DATE('01/01/1800','MM/DD/YYYY'),policy_effective_date)\n\t\tIFF(policy_effective_date IS NULL, TO_DATE('01/01/1800', 'MM/DD/YYYY'), policy_effective_date) AS policy_effective_date_out,\n\t\t-- *INF*: TO_DATE('06/01/2012 00:00:00','MM/DD/YYYY HH24:MI:SS')\r\n\t\t-- \r\n\t\t-- -- prod 3017 6/1/2012 is the date for applying new earthquake coverages\n\t\tTO_DATE('06/01/2012 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AS CL_EQ_EFF_Date\n\t\tFROM INPUT\n\t),\n\tEXP_evaluate_step_1 AS (\n\t\tSELECT\n\t\tsymbol,\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\tunit_number,\n\t\tlocation_number,\n\t\tclass_of_business,\n\t\tsubline,\n\t\tclass_code,\n\t\trisk_unit_group,\n\t\tloss_cause,\n\t\tnsi_indicator,\n\t\tpolicy_effective_date_out AS policy_effective_date,\n\t\tCL_EQ_EFF_Date,\n\t\t-- *INF*: substr(risk_unit_group,1,3)\n\t\tsubstr(risk_unit_group, 1, 3) AS v_risk_unit_group_1_3,\n\t\t-- *INF*: substr(symbol,1,2)\n\t\tsubstr(symbol, 1, 2) AS v_symbol_pos_1_2,\n\t\tv_symbol_pos_1_2 AS symbol_pos_1_2_out,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='PF' and (in(major_peril,'081','280',@{pipeline().parameters.MP_210_211},@{pipeline().parameters.MP_249_250})),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PF' AND ( in(major_peril, '081', '280', @{pipeline().parameters.MP_210_211}, @{pipeline().parameters.MP_249_250}) ), 1, 0) AS v_home_and_highway_fire_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='PF' and in(major_peril,@{pipeline().parameters.MP_220_230}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PF' AND in(major_peril, @{pipeline().parameters.MP_220_230}), 1, 0) AS v_home_and_highway_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='PH' and in(major_peril,'002','097','911','914'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PH' AND in(major_peril, '002', '097', '911', '914'), 1, 0) AS v_home_and_highway_homeowners_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and  type_bureau='PI' and in( major_peril,'042','062','200','201','206'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PI' AND in(major_peril, '042', '062', '200', '201', '206'), 1, 0) AS v_home_and_highway_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='PQ' and in(major_peril,@{pipeline().parameters.MP_260_261}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PQ' AND in(major_peril, @{pipeline().parameters.MP_260_261}), 1, 0) AS v_home_and_highway_earthquake_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='PL',1,0) \n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'PL', 1, 0) AS v_home_and_highway_personal_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and  type_bureau='GL' and major_peril='017',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'GL' AND major_peril = '017', 1, 0) AS v_home_and_highway_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH'  and in(type_bureau,'RL','RP','RN') and in(major_peril,'150',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143}),1,0) \n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_home_and_highway_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HH' and type_bureau='RP' and in(major_peril,'168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HH' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_home_and_highway_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='PP' and in(type_bureau,'RL','RP','RN') and in(major_peril,'150',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PP' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_preferred_auto_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='PP' and type_bureau='RP' and in(major_peril,'168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PP' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_preferred_auto_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='PA' and in(type_bureau,'RL','RP','RN') and in(major_peril,'150',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PA' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_select_auto_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='PA' and type_bureau='RP' and in(major_peril,'168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PA' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_select_auto_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HB' and type_bureau='NB' and in(major_peril,@{pipeline().parameters.MP_220_230}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'NB' AND in(major_peril, @{pipeline().parameters.MP_220_230}), 1, 0) AS v_standard_homeowners_allied_lined_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HB' and  type_bureau='PH' and major_peril='002',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'PH' AND major_peril = '002', 1, 0) AS v_standard_homeowners_homeowners_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HB' and type_bureau='PI' and in(major_peril,'042','044','062','200','201','206'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'PI' AND in(major_peril, '042', '044', '062', '200', '201', '206'), 1, 0) AS v_standard_homeowners_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HB' and type_bureau='PQ' and in(major_peril,@{pipeline().parameters.MP_260_261}),1,0)\r\n\t\t-- \n\t\tIFF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'PQ' AND in(major_peril, @{pipeline().parameters.MP_260_261}), 1, 0) AS v_standard_homeowners_earthquake_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'PL',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HB' AND type_bureau = 'PL', 1, 0) AS v_standard_homeowners_personal_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='HA' and type_bureau='NB' and in(major_peril,@{pipeline().parameters.MP_220_230}),1,0)\r\n\t\t-- \n\t\tIFF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'NB' AND in(major_peril, @{pipeline().parameters.MP_220_230}), 1, 0) AS v_select_homeowners_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PH' AND\r\n\t\t--               major_peril = '002',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PH' AND major_peril = '002', 1, 0) AS v_select_homeowners_homeowners_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PI' AND in(major_peril,'042','044','062',                     '200','201','206'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PI' AND in(major_peril, '042', '044', '062', '200', '201', '206'), 1, 0) AS v_select_homeowners_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PQ' AND in(major_peril,@{pipeline().parameters.MP_260_261}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PQ' AND in(major_peril, @{pipeline().parameters.MP_260_261}), 1, 0) AS v_select_homeowners_earthquake_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PL',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'HA' AND type_bureau = 'PL', 1, 0) AS v_select_homeowners_personal_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2 , 'FP' ,'FL') AND type_bureau = 'PF' AND\r\n\t\t--               in(major_peril ,'081',@{pipeline().parameters.MP_210_211},@{pipeline().parameters.MP_249_250}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'FP', 'FL') AND type_bureau = 'PF' AND in(major_peril, '081', @{pipeline().parameters.MP_210_211}, @{pipeline().parameters.MP_249_250}), 1, 0) AS v_dwelling_fire_fire_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2, 'FP','FL') AND in(type_bureau,'PF','NB') AND in(major_peril,@{pipeline().parameters.MP_220_230}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'FP', 'FL') AND in(type_bureau, 'PF', 'NB') AND in(major_peril, @{pipeline().parameters.MP_220_230}), 1, 0) AS v_dwelling_fire_allied_lines_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'FP','FL') AND type_bureau = 'PQ' AND in(major_peril,@{pipeline().parameters.MP_260_261}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'FP', 'FL') AND type_bureau = 'PQ' AND in(major_peril, @{pipeline().parameters.MP_260_261}), 1, 0) AS v_dwelling_fire_earthquake_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'IP' AND type_bureau= 'PI',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'IP' AND type_bureau = 'PI', 1, 0) AS v_personal_inland_marine_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'IP' AND type_bureau = 'PL',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'IP' AND type_bureau = 'PL', 1, 0) AS v_personal_inland_marine_personal_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PM' AND\r\n\t\t--               in(type_bureau,'RL','RP','RN') AND\r\n\t\t--               in(major_peril,'150',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PM' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_motorcycle_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PM' AND type_bureau = 'RP' AND\r\n\t\t--  in(major_peril, '168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PM' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_motorcycle_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'IB' AND type_bureau = 'PI',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'IB' AND type_bureau = 'PI', 1, 0) AS v_boatowners_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'IB' AND type_bureau = 'PL',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'IB' AND type_bureau = 'PL', 1, 0) AS v_boatowners_personal_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PS' AND\r\n\t\t--               in(type_bureau,'RL', 'RP', 'RN') AND\r\n\t\t--              in(major_peril,'150',@{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PS' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_alternative_one_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PS' AND type_bureau = 'RP' AND\r\n\t\t-- in(major_peril, '168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PS' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_alternative_one_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PT' AND\r\n\t\t--               in(type_bureau,'RL','RP','RN') AND\r\n\t\t--               in(major_peril,'150',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PT' AND in(type_bureau, 'RL', 'RP', 'RN') AND in(major_peril, '150', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_alternative_one_star_pp_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'PT' AND type_bureau = 'RP' AND\r\n\t\t-- in(major_peril,'168','169','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_163},@{pipeline().parameters.MP_170_178}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'PT' AND type_bureau = 'RP' AND in(major_peril, '168', '169', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_163}, @{pipeline().parameters.MP_170_178}), 1, 0) AS v_alternative_one_star_pp_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2, 'BC','BD','CP','BG','BH','GG','CA') AND\r\n\t\t--  in(type_bureau,'AN','AL') AND\r\n\t\t--  in(major_peril ,'150','599',@{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143},@{pipeline().parameters.MP_930_931}) AND \r\n\t\t-- NOT in(subline,@{pipeline().parameters.GARAGE_SUBLINES}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD', 'CP', 'BG', 'BH', 'GG', 'CA') AND in(type_bureau, 'AN', 'AL') AND in(major_peril, '150', '599', @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}, @{pipeline().parameters.MP_930_931}) AND NOT in(subline, @{pipeline().parameters.GARAGE_SUBLINES}), 1, 0) AS v_commercial_auto_commercial_auto_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2, 'NA','NB','NS') AND\r\n\t\t--               in(type_bureau, 'AN','AL') AND\r\n\t\t--               in(major_peril,'150','599',@{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143},@{pipeline().parameters.MP_930_931}) AND\r\n\t\t--  NOT in(subline,@{pipeline().parameters.GARAGE_SUBLINES}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND in(type_bureau, 'AN', 'AL') AND in(major_peril, '150', '599', @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}, @{pipeline().parameters.MP_930_931}) AND NOT in(subline, @{pipeline().parameters.GARAGE_SUBLINES}), 1, 0) AS v_commercial_auto_commercial_auto_liability_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD','CP','BG','BH','GG') AND\r\n\t\t--          in(type_bureau,'AN','AL') AND\r\n\t\t--          in(major_peril,'150','599',@{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143},@{pipeline().parameters.MP_930_931}) \t   AND\r\n\t\t--          in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--          unit_number = '999' AND\r\n\t\t--          (is_spaces(location_number) = 1 OR rtrim(ltrim(location_number)) = '0000' ),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD', 'CP', 'BG', 'BH', 'GG') AND in(type_bureau, 'AN', 'AL') AND in(major_peril, '150', '599', @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}, @{pipeline().parameters.MP_930_931}) AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND unit_number = '999' AND ( is_spaces(location_number) = 1 OR rtrim(ltrim(location_number)) = '0000' ), 1, 0) AS v_commercial_auto_commercial_auto_liability_garage_veh_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB','NS') AND\r\n\t\t--         in(type_bureau,'AN','AL') AND\r\n\t\t--         in(major_peril,'150','599',@{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_140_143},@{pipeline().parameters.MP_930_931}) AND\r\n\t\t--         in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--         unit_number = '999' AND\r\n\t\t--          (is_spaces(location_number) OR rtrim(ltrim(location_number))='0000'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND in(type_bureau, 'AN', 'AL') AND in(major_peril, '150', '599', @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_140_143}, @{pipeline().parameters.MP_930_931}) AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND unit_number = '999' AND ( is_spaces(location_number) OR rtrim(ltrim(location_number)) = '0000' ), 1, 0) AS v_commercial_auto_commercial_auto_liability_garage_veh_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD','CP','BG','BH','GG','CA','GA') AND\r\n\t\t--               type_bureau = 'AP' AND\r\n\t\t--               NOT in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--              in (major_peril,'132','147','177','178',@{pipeline().parameters.MP_145_146},@{pipeline().parameters.MP_148_160},@{pipeline().parameters.MP_163_166},@{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD', 'CP', 'BG', 'BH', 'GG', 'CA', 'GA') AND type_bureau = 'AP' AND NOT in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '132', '147', '177', '178', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160}, @{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}), 1, 0) AS v_commercial_auto_comm_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB','NS') AND\r\n\t\t--        type_bureau = 'AP' AND\r\n\t\t--        NOT in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--        in(major_peril,'132','147','177','178',@{pipeline().parameters.MP_145_146},@{pipeline().parameters.MP_148_160},@{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND type_bureau = 'AP' AND NOT in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '132', '147', '177', '178', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160}, @{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}), 1, 0) AS v_commercial_auto_comm_auto_physical_damage_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2, 'BC','BD','CP','BG','BH','GG') AND\r\n\t\t--         type_bureau = 'AP' AND\r\n\t\t--         in(major_peril,'132','147','177','178',@{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160},@{pipeline().parameters.MP_163_166},@{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270}) AND\r\n\t\t--          in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--          unit_number = '999' AND\r\n\t\t--           (is_spaces(location_number)=1 OR rtrim(ltrim(location_number))= '0000'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD', 'CP', 'BG', 'BH', 'GG') AND type_bureau = 'AP' AND in(major_peril, '132', '147', '177', '178', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160}, @{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}) AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND unit_number = '999' AND ( is_spaces(location_number) = 1 OR rtrim(ltrim(location_number)) = '0000' ), 1, 0) AS v_commercial_auto_comm_auto_physical_damage_garage_veh_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2, 'NA','NB','NS') AND\r\n\t\t--         type_bureau = 'AP' AND\r\n\t\t--         in(major_peril,'132','147','177','178',@{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160}, @{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270}) AND\r\n\t\t--               in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--              unit_number = '999' AND\r\n\t\t--               (is_spaces(location_number)=1 OR  rtrim(ltrim(location_number))= '0000'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND type_bureau = 'AP' AND in(major_peril, '132', '147', '177', '178', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_160}, @{pipeline().parameters.MP_163_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}) AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND unit_number = '999' AND ( is_spaces(location_number) = 1 OR rtrim(ltrim(location_number)) = '0000' ), 1, 0) AS v_commercial_auto_comm_auto_physical_damage_garage_veh_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='CP' and in(type_bureau,'AN','AL') and in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) and in(major_peril,'599',@{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND in(type_bureau, 'AN', 'AL') AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '599', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_garage_liability_commercial_auto_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2='NS' and in(type_bureau,'AN','AL') and in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) and in(major_peril,'599',@{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND in(type_bureau, 'AN', 'AL') AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '599', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_garage_liability_commercial_auto_liability_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2= 'CP' AND\r\n\t\t--        type_bureau = 'AP' AND \r\n\t\t--       in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--       in(major_peril,'132','177','178',@{pipeline().parameters.MP_145_159},@{pipeline().parameters.MP_165_166},@{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270})\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'AP' AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '132', '177', '178', @{pipeline().parameters.MP_145_159}, @{pipeline().parameters.MP_165_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}), 1, 0) AS v_garage_liability_commercial_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF (v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--         type_bureau = 'AP' AND \r\n\t\t--        in(subline,@{pipeline().parameters.GARAGE_SUBLINES}) AND\r\n\t\t--        in(major_peril,'132','177','178',@{pipeline().parameters.MP_145_159},@{pipeline().parameters.MP_165_166},@{pipeline().parameters.MP_170_173},@{pipeline().parameters.MP_269_270}) ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'AP' AND in(subline, @{pipeline().parameters.GARAGE_SUBLINES}) AND in(major_peril, '132', '177', '178', @{pipeline().parameters.MP_145_159}, @{pipeline().parameters.MP_165_166}, @{pipeline().parameters.MP_170_173}, @{pipeline().parameters.MP_269_270}), 1, 0) AS v_garage_liability_commercial_auto_physical_damage_nsi,\n\t\t-- *INF*: IIF(in(substr(symbol,1,1),'V','W','Y') AND\r\n\t\t--          in(type_bureau,'WC','WP'),1,0)\n\t\tIFF(in(substr(symbol, 1, 1), 'V', 'W', 'Y') AND in(type_bureau, 'WC', 'WP'), 1, 0) AS v_workers_comp_total_non_pool_workers_comp_wbm,\n\t\t-- *INF*: IIF(in(substr(symbol,1,1),'R','S','T') AND\r\n\t\t--        in(type_bureau,'WC','WP'),1,0)\n\t\tIFF(in(substr(symbol, 1, 1), 'R', 'S', 'T') AND in(type_bureau, 'WC', 'WP'), 1, 0) AS v_workers_comp_total_non_pool_workers_comp_nsi,\n\t\t-- *INF*: IIF(in(substr(symbol,1,1),'A','J','L') AND\r\n\t\t--        in(type_bureau,'WC','WP'),1,0)\n\t\tIFF(in(substr(symbol, 1, 1), 'A', 'J', 'L') AND in(type_bureau, 'WC', 'WP'), 1, 0) AS v_workers_comp_total_non_pool_workers_comp_argent,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t--        NOT in(class_of_business,'I','O') AND\r\n\t\t-- \t in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t-- \tpolicy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND NOT in(class_of_business, 'I', 'O') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_commercial_property_earthquake_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599','919') AND\r\n\t\t--        NOT in(class_of_business,'I','O'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_commercial_property_fire_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--         type_bureau = 'CF' AND\r\n\t\t--         in(major_peril, '415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t-- \t  in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t-- \t  policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_commercial_property_earthquake_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--         type_bureau = 'CF' AND\r\n\t\t--         in(major_peril, '415','463','490','496','498','599','919'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919'), 1, 0) AS v_commercial_property_fire_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2 ,'CP','PX','SM') AND\r\n\t\t--         in(type_bureau,'CF','NB','GS') AND\r\n\t\t--          in(major_peril,'425','426','435','220','455','480','599','227') AND\r\n\t\t--          NOT in(class_of_business,'I','O'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'PX', 'SM') AND in(type_bureau, 'CF', 'NB', 'GS') AND in(major_peril, '425', '426', '435', '220', '455', '480', '599', '227') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_commercial_property_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--        in(type_bureau,'CF','NB','GS') AND\r\n\t\t--        in(major_peril,'425','426','435','220','455','480','599','227'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND in(type_bureau, 'CF', 'NB', 'GS') AND in(major_peril, '425', '426', '435', '220', '455', '480', '599', '227'), 1, 0) AS v_commercial_property_allied_lines_nsi,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599' ,'919','425','426','435','455','480') AND\r\n\t\t--        class_of_business = 'I' AND\r\n\t\t--        in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--        policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND class_of_business = 'I' AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_metalworkers_earthquake_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599' ,'919') AND\r\n\t\t--        class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919') AND class_of_business = 'I', 1, 0) AS v_metalworkers_fire_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--        in(type_bureau,'CF','NB','GS') AND\r\n\t\t--        in(major_peril,'425','426','435','455','480') AND\r\n\t\t--         class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND in(type_bureau, 'CF', 'NB', 'GS') AND in(major_peril, '425', '426', '435', '455', '480') AND class_of_business = 'I', 1, 0) AS v_metalworkers_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--       type_bureau = 'IM' AND\r\n\t\t--       in(major_peril,'551','599','919') AND\r\n\t\t--       class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919') AND class_of_business = 'I', 1, 0) AS v_metalworkers_inland_marine_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599','919') AND\r\n\t\t--        in(subline,@{pipeline().parameters.SUB_325_335},@{pipeline().parameters.SUB_342_350}) AND\r\n\t\t--        class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND in(major_peril, '530', '599', '919') AND in(subline, @{pipeline().parameters.SUB_325_335}, @{pipeline().parameters.SUB_342_350}) AND class_of_business = 'I', 1, 0) AS v_metalworkers_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--       in(major_peril,'530','550','599') AND\r\n\t\t--       in(subline,'336','365') AND\r\n\t\t--       class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND in(major_peril, '530', '550', '599') AND in(subline, '336', '365') AND class_of_business = 'I', 1, 0) AS v_metalworkers_products_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CM' AND type_bureau = 'GL' AND\r\n\t\t--              major_peril = '540' AND\r\n\t\t--              subline = '336' AND \r\n\t\t--              class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CM' AND type_bureau = 'GL' AND major_peril = '540' AND subline = '336' AND class_of_business = 'I', 1, 0) AS v_metalworkers_claims_made_product_liability_wbm,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'CP','FF') AND\r\n\t\t--         in(type_bureau,'FT','CR') AND\r\n\t\t--         in(major_peril,'566','016') AND\r\n\t\t--         class_of_business = 'I',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'FF') AND in(type_bureau, 'FT', 'CR') AND in(major_peril, '566', '016') AND class_of_business = 'I', 1, 0) AS v_metalworkers_fidelity_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'565','599') AND\r\n\t\t--       class_of_business = 'I',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '565', '599') AND class_of_business = 'I', 1, 0) AS v_metalworkers_burglary_and_theft_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril, '415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t--        class_of_business = 'O' AND\r\n\t\t--        in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--        policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND class_of_business = 'O' AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_woodworkers_earthquake_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril, '415','463','490','496','498','599','919') AND\r\n\t\t--        class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919') AND class_of_business = 'O', 1, 0) AS v_woodworkers_fire_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--      in(type_bureau,'CF','NB','GS') AND\r\n\t\t--      in(major_peril,'425','426','435','455','480') AND\r\n\t\t--      class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND in(type_bureau, 'CF', 'NB', 'GS') AND in(major_peril, '425', '426', '435', '455', '480') AND class_of_business = 'O', 1, 0) AS v_woodworkers_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--       type_bureau = 'IM' AND\r\n\t\t--       in(major_peril,'551','599','919') AND\r\n\t\t--       class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919') AND class_of_business = 'O', 1, 0) AS v_woodworkers_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--       in(major_peril,'530','599','919') AND\r\n\t\t--       in(subline,@{pipeline().parameters.SUB_325_335},@{pipeline().parameters.SUB_342_350}) AND\r\n\t\t--       class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND in(major_peril, '530', '599', '919') AND in(subline, @{pipeline().parameters.SUB_325_335}, @{pipeline().parameters.SUB_342_350}) AND class_of_business = 'O', 1, 0) AS v_woodworkers_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND \r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--      in(major_peril,'530','550','599') AND\r\n\t\t--      in(subline,'336','365') AND\r\n\t\t--      class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND in(major_peril, '530', '550', '599') AND in(subline, '336', '365') AND class_of_business = 'O', 1, 0) AS v_woodworkers_products_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CM' AND \r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--       major_peril = '540' AND\r\n\t\t--       subline = '336' AND \r\n\t\t--       class_of_business = 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CM' AND type_bureau = 'GL' AND major_peril = '540' AND subline = '336' AND class_of_business = 'O', 1, 0) AS v_woodworkers_claims_made_product_liability_wbm,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'CP','FF') AND\r\n\t\t--         in(type_bureau,'FT','CR') AND\r\n\t\t--         in (major_peril,'566','016') AND\r\n\t\t--         class_of_business = 'O',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'FF') AND in(type_bureau, 'FT', 'CR') AND in(major_peril, '566', '016') AND class_of_business = 'O', 1, 0) AS v_woodworkers_fidelity_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'565','599') AND\r\n\t\t--       class_of_business= 'O',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '565', '599') AND class_of_business = 'O', 1, 0) AS v_woodworkers_burglary_and_theft_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'CP','GL','SM','XX') AND\r\n\t\t--         type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599','084','085','919') AND\r\n\t\t--        in(subline,@{pipeline().parameters.SUB_313_315},@{pipeline().parameters.SUB_325_335},@{pipeline().parameters.SUB_342_350}) AND\r\n\t\t--        NOT in(class_of_business,'I','O'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'GL', 'SM', 'XX') AND type_bureau = 'GL' AND in(major_peril, '530', '599', '084', '085', '919') AND in(subline, @{pipeline().parameters.SUB_313_315}, @{pipeline().parameters.SUB_325_335}, @{pipeline().parameters.SUB_342_350}) AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_general_liability_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--         type_bureau = 'GL' AND\r\n\t\t--         in(major_peril,'530','599','084','085','919') AND\r\n\t\t--         in(subline,@{pipeline().parameters.SUB_313_315},@{pipeline().parameters.SUB_325_335},@{pipeline().parameters.SUB_342_350}),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'GL' AND in(major_peril, '530', '599', '084', '085', '919') AND in(subline, @{pipeline().parameters.SUB_313_315}, @{pipeline().parameters.SUB_325_335}, @{pipeline().parameters.SUB_342_350}), 1, 0) AS v_general_liability_general_liability_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','550','599') AND\r\n\t\t--        in(subline,'336','365') AND\r\n\t\t--        not in(class_of_business,'I','O'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'GL' AND in(major_peril, '530', '550', '599') AND in(subline, '336', '365') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_general_liability_products_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','550','599') AND\r\n\t\t--        in(subline,'336','365'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND type_bureau = 'GL' AND in(major_peril, '530', '550', '599') AND in(subline, '336', '365'), 1, 0) AS v_smart_products_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599') AND\r\n\t\t--        subline = '336',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'GL' AND in(major_peril, '530', '599') AND subline = '336', 1, 0) AS v_general_liability_products_liability_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CM' AND\r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--       major_peril = '540' AND\r\n\t\t--       subline = '336' AND\r\n\t\t--       not in(class_of_business,'I','O'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CM' AND type_bureau = 'GL' AND major_peril = '540' AND subline = '336' AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_general_liability_claims_made_product_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NE','NS') AND\r\n\t\t--             type_bureau = 'GL' AND\r\n\t\t--            major_peril = '540' AND\r\n\t\t--            subline= '336',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NE', 'NS') AND type_bureau = 'GL' AND major_peril = '540' AND subline = '336', 1, 0) AS v_general_liability_claims_made_product_liability_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--       type_bureau= 'GL' AND\r\n\t\t--      major_peril= '540' AND\r\n\t\t--      subline= '334',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'GL' AND major_peril = '540' AND subline = '334', 1, 0) AS v_general_liability_claims_made_general_liability_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'CP','SM') AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'566','016') AND\r\n\t\t--       not in(class_of_business,'I','O'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'SM') AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '566', '016') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_crime_fidelity_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'566','016'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '566', '016'), 1, 0) AS v_smart_fidelity_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'566','016'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '566', '016'), 1, 0) AS v_crime_fidelity_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'CP','SM') AND\r\n\t\t--        in(type_bureau,'FT','BT','CR') AND\r\n\t\t--        in(major_peril,'565','599','015') AND\r\n\t\t--        not in(class_of_business,'I','O'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'SM') AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '565', '599', '015') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_crime_burglary_and_theft_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--       in(type_bureau,'FT','BT','CR') AND\r\n\t\t--       in(major_peril,'565','599','015'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND in(type_bureau, 'FT', 'BT', 'CR') AND in(major_peril, '565', '599', '015'), 1, 0) AS v_crime_burglary_and_theft_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CP' AND\r\n\t\t--       type_bureau = 'IM' AND\r\n\t\t--       in(major_peril,'551','599','919') AND\r\n\t\t--       not in(class_of_business,'I','O'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CP' AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919') AND NOT in(class_of_business, 'I', 'O'), 1, 0) AS v_commercial_im_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NS' AND\r\n\t\t--       type_bureau = 'IM' AND\r\n\t\t--       in(major_peril,'551','599','919'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NS' AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919'), 1, 0) AS v_commercial_im_inland_marine_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BA','BB') AND\r\n\t\t--        in(type_bureau,'BB','BC','BE','NB') AND\r\n\t\t--        in(major_peril,'903','904','905','908'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB') AND in(type_bureau, 'BB', 'BC', 'BE', 'NB') AND in(major_peril, '903', '904', '905', '908'), 1, 0) AS v_bop_cmp_property_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BA','BB') AND\r\n\t\t--        type_bureau = 'BC' AND\r\n\t\t--        major_peril = '919',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB') AND type_bureau = 'BC' AND major_peril = '919', 1, 0) AS v_bop_unnamed_R13905,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'BA','BB','XA','XX') AND\r\n\t\t--         in(type_bureau,'BB','BC','BE','NB') AND\r\n\t\t--         in(major_peril,'599',@{pipeline().parameters.MP_901_904}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB', 'XA', 'XX') AND in(type_bureau, 'BB', 'BC', 'BE', 'NB') AND in(major_peril, '599', @{pipeline().parameters.MP_901_904}), 1, 0) AS v_bop_cmp_property_liability_peril_901_904_and_599_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BA','BB','XA') AND\r\n\t\t--        in(type_bureau,'BE','B2') AND\r\n\t\t--        in(major_peril,'907','065','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB', 'XA') AND in(type_bureau, 'BE', 'B2') AND in(major_peril, '907', '065', '919'), 1, 0) AS v_bop_cmp_liability_wbm,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--         type_bureau = 'CF' AND\r\n\t\t--         in(major_peril,'415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t-- in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t-- policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_cbop_earthquake_wbm,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--         type_bureau = 'CF' AND\r\n\t\t--         in(major_peril,'415','463','490','496','498','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919'), 1, 0) AS v_cbop_fire_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--       type_bureau = 'CF' AND\r\n\t\t--       in(major_peril,'415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t--       in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--       policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_smart_earthquake_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--       type_bureau = 'CF' AND\r\n\t\t--       in(major_peril,'415','463','490','496','498','599','919'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919'), 1, 0) AS v_smart_fire_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--              type_bureau = 'CF' AND\r\n\t\t--              in(major_peril,'415','463','490','496','498','599','919','425','426','435','455','480') AND\r\n\t\t--              in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--              policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_sbop_earthquake_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--              type_bureau = 'CF' AND\r\n\t\t--              in(major_peril,'415','463','490','496','498','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919'), 1, 0) AS v_sbop_fire_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--        in(type_bureau,'CF','GS') AND\r\n\t\t--        in(major_peril,'425','426','435','455','480'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND in(type_bureau, 'CF', 'GS') AND in(major_peril, '425', '426', '435', '455', '480'), 1, 0) AS v_cbop_allied_lines_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--       in(type_bureau,'CF','GS') AND\r\n\t\t--       in(major_peril,'425','426','435','455','480'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND in(type_bureau, 'CF', 'GS') AND in(major_peril, '425', '426', '435', '455', '480'), 1, 0) AS v_smart_allied_lines_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--        in(type_bureau,'CF','GS') AND\r\n\t\t--        in(major_peril,'425','426','435','455','480'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND in(type_bureau, 'CF', 'GS') AND in(major_peril, '425', '426', '435', '455', '480'), 1, 0) AS v_sbop_allied_lines_nsi,\n\t\t-- *INF*:  IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--         type_bureau = 'CF' AND\r\n\t\t--         major_peril = '066',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'CF' AND major_peril = '066', 1, 0) AS v_cbop_cmp_property_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--        type_bureau = 'IM' AND\r\n\t\t--        in(major_peril,'551','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919'), 1, 0) AS v_cbop_inland_marine_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--        type_bureau = 'IM' AND\r\n\t\t--        in(major_peril,'551','599','919'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919'), 1, 0) AS v_smart_inland_marine_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--        type_bureau = 'IM' AND\r\n\t\t--        in(major_peril,'551','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919'), 1, 0) AS v_sbop_inland_marine_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599','067','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'GL' AND in(major_peril, '530', '599', '067', '919'), 1, 0) AS v_cbop_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599','919'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND type_bureau = 'GL' AND in(major_peril, '530', '599', '919'), 1, 0) AS v_smart_general_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        in(major_peril,'530','599','067','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND type_bureau = 'GL' AND in(major_peril, '530', '599', '067', '919'), 1, 0) AS v_sbop_general_liability_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--        type_bureau = 'FT' AND\r\n\t\t--         major_peril = '566',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND type_bureau = 'FT' AND major_peril = '566', 1, 0) AS v_cbop_fidelity_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--        type_bureau = 'FT' AND\r\n\t\t--        major_peril = '566',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND type_bureau = 'FT' AND major_peril = '566', 1, 0) AS v_sbop_fidelity_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD') AND\r\n\t\t--        in(type_bureau,'FT','BT') AND\r\n\t\t--        in(major_peril,'565','599'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD') AND in(type_bureau, 'FT', 'BT') AND in(major_peril, '565', '599'), 1, 0) AS v_cbop_burglary_and_theft_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--       in(type_bureau,'CR','FT','BT') AND\r\n\t\t--       in(major_peril,'565','599'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND in(type_bureau, 'CR', 'FT', 'BT') AND in(major_peril, '565', '599'), 1, 0) AS v_smart_burglary_and_theft_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB') AND\r\n\t\t--        in(type_bureau,'FT','BT') AND\r\n\t\t--        in(major_peril,'565','599'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB') AND in(type_bureau, 'FT', 'BT') AND in(major_peril, '565', '599'), 1, 0) AS v_sbop_burglary_and_theft_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599','919','425','426','435','455','480',@{pipeline().parameters.MP_901_904}) AND\r\n\t\t--        in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--       policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919', '425', '426', '435', '455', '480', @{pipeline().parameters.MP_901_904}) AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_gbop_earthquake_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND \r\n\t\t--        type_bureau = 'CF' AND\r\n\t\t--        in(major_peril,'415','463','490','496','498','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND type_bureau = 'CF' AND in(major_peril, '415', '463', '490', '496', '498', '599', '919'), 1, 0) AS v_gbop_fire_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND\r\n\t\t--        in(type_bureau,'CF','GS') AND\r\n\t\t--        in(major_peril,'425' ,'426','435','455','480'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND in(type_bureau, 'CF', 'GS') AND in(major_peril, '425', '426', '435', '455', '480'), 1, 0) AS v_gbop_allied_lines_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND \r\n\t\t--        type_bureau = 'IM' AND\r\n\t\t--        in(major_peril,'551','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND type_bureau = 'IM' AND in(major_peril, '551', '599', '919'), 1, 0) AS v_gbop_inland_marine_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND \r\n\t\t--       type_bureau = 'GL' AND\r\n\t\t--       in(major_peril,'530','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND type_bureau = 'GL' AND in(major_peril, '530', '599', '919'), 1, 0) AS v_gbop_general_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH','GG','XX') AND\r\n\t\t--         in(type_bureau,'AN','AL') AND\r\n\t\t--         in(major_peril,'599',@{pipeline().parameters.MP_100_130},@{pipeline().parameters.MP_271_274},@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH', 'GG', 'XX') AND in(type_bureau, 'AN', 'AL') AND in(major_peril, '599', @{pipeline().parameters.MP_100_130}, @{pipeline().parameters.MP_271_274}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_gbop_commercial_auto_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND\r\n\t\t--        in(type_bureau,'CF','NB','BC','BE') AND\r\n\t\t--        in(major_peril,@{pipeline().parameters.MP_901_904}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND in(type_bureau, 'CF', 'NB', 'BC', 'BE') AND in(major_peril, @{pipeline().parameters.MP_901_904}), 1, 0) AS v_gbop_cmp_property_liability_peril_901_904_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND\r\n\t\t--        type_bureau = 'BE' AND \r\n\t\t--        major_peril = '907',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND type_bureau = 'BE' AND major_peril = '907', 1, 0) AS v_gbop_cmp_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH','GG') AND\r\n\t\t--        type_bureau = 'AP' AND\r\n\t\t--         in(major_peril,'269',@{pipeline().parameters.MP_145_160},@{pipeline().parameters.MP_165_166},@{pipeline().parameters.MP_170_173}),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH', 'GG') AND type_bureau = 'AP' AND in(major_peril, '269', @{pipeline().parameters.MP_145_160}, @{pipeline().parameters.MP_165_166}, @{pipeline().parameters.MP_170_173}), 1, 0) AS v_gbop_comm_auto_physical_damage_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND\r\n\t\t--         in( type_bureau,'FT','BT') AND\r\n\t\t--         major_peril = '566',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND in(type_bureau, 'FT', 'BT') AND major_peril = '566', 1, 0) AS v_gbop_fidelity_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BG','BH') AND\r\n\t\t--        in(type_bureau,'FT','BT') AND\r\n\t\t--        in(major_peril,'565','599'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BG', 'BH') AND in(type_bureau, 'FT', 'BT') AND in(major_peril, '565', '599'), 1, 0) AS v_gbop_burglary_and_theft_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'UP' AND \r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        major_peril = '017',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'UP' AND type_bureau = 'GL' AND major_peril = '017', 1, 0) AS v_personal_umbrella_general_liability_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'CP','UC','CU') AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--        major_peril = '517',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CP', 'UC', 'CU') AND type_bureau = 'GL' AND major_peril = '517', 1, 0) AS v_commercial_umbrella_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NU' AND\r\n\t\t--         type_bureau = 'GL' AND\r\n\t\t--         major_peril = '517',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NU' AND type_bureau = 'GL' AND major_peril = '517', 1, 0) AS v_commercial_umbrella_general_liability_nsi,\n\t\t-- *INF*: IIF(symbol= 'ZZZ',1,0)\n\t\tIFF(symbol = 'ZZZ', 1, 0) AS v_workers_comp_pool_total_workers_comp_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NF' AND\r\n\t\t--         in(major_peril,'566','599'),1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NF' AND in(major_peril, '566', '599'), 1, 0) AS v_fidelity_bonds_fidelity_nsi,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NF' AND\r\n\t\t--        major_peril = '565',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NF' AND major_peril = '565', 1, 0) AS v_fidelity_bonds_burgulary_and_theft_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NC','NJ','NL','NO','NM'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NC', 'NJ', 'NL', 'NO', 'NM'), 1, 0) AS v_surety_bonds_surety_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'CD','CM') AND\r\n\t\t--        in(subline,'345','334') AND\r\n\t\t--        in(major_peril,'540','599','919'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'CD', 'CM') AND in(subline, '345', '334') AND in(major_peril, '540', '599', '919'), 1, 0) AS v_d_and_o_claims_made_general_liability_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'CM',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'CM', 1, 0) AS v_epli_general_liability_claims_made_wbm,\n\t\t-- *INF*: IIF(v_symbol_pos_1_2 = 'NE',1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'NE', 1, 0) AS v_epli_general_liability_claims_made_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BC','BD','BG','BH','CP') AND\r\n\t\t--         major_peril = '540' AND\r\n\t\t--         type_bureau = 'GL' AND\r\n\t\t--         (\r\n\t\t--         in(substr(class_code,1,5),'22222','22250') OR\r\n\t\t--         in(substr(risk_unit_group,1,3),'366','367')\r\n\t\t--         )\r\n\t\t-- \t ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BC', 'BD', 'BG', 'BH', 'CP') AND major_peril = '540' AND type_bureau = 'GL' AND ( in(substr(class_code, 1, 5), '22222', '22250') OR in(substr(risk_unit_group, 1, 3), '366', '367') ), 1, 0) AS v_epli_general_liability_claims_made_cpp_cbop_wbm,\n\t\t-- *INF*:  IIF(v_symbol_pos_1_2 = 'BO' AND\r\n\t\t--        in(major_peril,'540','541') AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--       (\r\n\t\t--        in(substr(class_code,1,5),'22222','22250') OR\r\n\t\t--        in(substr(risk_unit_group,1,3),'366','367')\r\n\t\t--        )\r\n\t\t--        ,1,0)\n\t\tIFF(v_symbol_pos_1_2 = 'BO' AND in(major_peril, '540', '541') AND type_bureau = 'GL' AND ( in(substr(class_code, 1, 5), '22222', '22250') OR in(substr(risk_unit_group, 1, 3), '366', '367') ), 1, 0) AS v_smart_general_liability_claims_made_smart_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB','NS') AND\r\n\t\t--        major_peril = '540' AND\r\n\t\t--        type_bureau = 'GL' AND\r\n\t\t--       (\r\n\t\t--        in(substr(class_code,1,5),'22222','22250') OR\r\n\t\t--        in(substr(risk_unit_group,1,3),'366','367')\r\n\t\t--        )\r\n\t\t--        ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND major_peril = '540' AND type_bureau = 'GL' AND ( in(substr(class_code, 1, 5), '22222', '22250') OR in(substr(risk_unit_group, 1, 3), '366', '367') ), 1, 0) AS v_epli_general_liability_claims_made_cpp_sbop_nsi,\n\t\t-- *INF*: IIF(major_peril = '540' AND\r\n\t\t--        type_bureau = 'BE' AND\r\n\t\t--        in(substr(risk_unit_group,1,3),'366','367'),1,0)\n\t\tIFF(major_peril = '540' AND type_bureau = 'BE' AND in(substr(risk_unit_group, 1, 3), '366', '367'), 1, 0) AS v_epli_general_liability_claims_made_bop_wbm,\n\t\t-- *INF*: IIF(major_peril = '540' AND\r\n\t\t--        type_bureau = 'AL' AND\r\n\t\t--        in(substr(risk_unit_group,1,3),'417','418'),1,0)\n\t\tIFF(major_peril = '540' AND type_bureau = 'AL' AND in(substr(risk_unit_group, 1, 3), '417', '418'), 1, 0) AS v_epli_general_liability_claims_made_gbop_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NK','NN'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NK', 'NN'), 1, 0) AS v_d_and_o_claims_made_general_liability_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BA','BB','BC','BD','BG','BH','BO','CP') AND\r\n\t\t--        in(type_bureau,'CF','BE','BM') AND\r\n\t\t--        in(major_peril,'570','906') AND\r\n\t\t--        in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--        policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB', 'BC', 'BD', 'BG', 'BH', 'BO', 'CP') AND in(type_bureau, 'CF', 'BE', 'BM') AND in(major_peril, '570', '906') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_boiler_and_machinery_earthquake_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'BA','BB','BC','BD','BG','BH','BO','CP') AND\r\n\t\t--        in(type_bureau,'CF','BE','BM') AND\r\n\t\t--        in(major_peril,'570','906'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'BA', 'BB', 'BC', 'BD', 'BG', 'BH', 'BO', 'CP') AND in(type_bureau, 'CF', 'BE', 'BM') AND in(major_peril, '570', '906'), 1, 0) AS v_boiler_and_machinery_boiler_and_machinery_wbm,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB','NS') AND\r\n\t\t--        in(type_bureau,'CF','BE', 'BM') AND\r\n\t\t--        in(major_peril,'570','906') AND\r\n\t\t--        in(v_risk_unit_group_1_3,@{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND\r\n\t\t--        policy_effective_date >= CL_EQ_EFF_Date\r\n\t\t-- ,1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND in(type_bureau, 'CF', 'BE', 'BM') AND in(major_peril, '570', '906') AND in(v_risk_unit_group_1_3, @{pipeline().parameters.RISK_UNIT_GRP_CL_EQ}) AND policy_effective_date >= CL_EQ_EFF_Date, 1, 0) AS v_boiler_and_machinery_earthquake_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'NA','NB','NS') AND\r\n\t\t--        in(type_bureau,'CF','BE','BM') AND\r\n\t\t--        in(major_peril,'570','906'),1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'NA', 'NB', 'NS') AND in(type_bureau, 'CF', 'BE', 'BM') AND in(major_peril, '570', '906'), 1, 0) AS v_boiler_and_machinery_boiler_and_machinery_nsi,\n\t\t-- *INF*: IIF(in(v_symbol_pos_1_2,'HA','HB','HH') AND\r\n\t\t--        type_bureau = 'MS' AND\r\n\t\t--        major_peril = '050',1,0)\n\t\tIFF(in(v_symbol_pos_1_2, 'HA', 'HB', 'HH') AND type_bureau = 'MS' AND major_peril = '050', 1, 0) AS v_mine_subsidence_homeowners_wbm,\n\t\t-- *INF*:  IIF(substr(symbol,1,1) != 'N' AND\r\n\t\t--        in(type_bureau,'MS','NB') AND\r\n\t\t--         major_peril = '050',1,0)\n\t\tIFF(substr(symbol, 1, 1) != 'N' AND in(type_bureau, 'MS', 'NB') AND major_peril = '050', 1, 0) AS v_mine_subsidence_allied_lines_wbm,\n\t\t-- *INF*:  IIF(substr(symbol,1,1) = 'N' AND\r\n\t\t--        in(type_bureau,'MS','NB') AND\r\n\t\t--         major_peril = '050',1,0)\n\t\tIFF(substr(symbol, 1, 1) = 'N' AND in(type_bureau, 'MS', 'NB') AND major_peril = '050', 1, 0) AS v_mine_subsidence_allied_lines_nsi,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_home_and_highway_fire_wbm,'1500',\r\n\t\t-- v_home_and_highway_allied_lines_wbm,'1500',\r\n\t\t-- v_home_and_highway_homeowners_wbm,'1500',\r\n\t\t-- v_home_and_highway_inland_marine_wbm,'1500',\r\n\t\t-- v_home_and_highway_earthquake_wbm,'1500',\r\n\t\t-- v_home_and_highway_personal_liability_wbm,'1500',\r\n\t\t-- v_home_and_highway_general_liability_wbm,'1500',\r\n\t\t-- v_home_and_highway_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_home_and_highway_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_preferred_auto_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_preferred_auto_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_select_auto_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_select_auto_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_standard_homeowners_allied_lined_wbm,'1500',\r\n\t\t-- v_standard_homeowners_homeowners_wbm,'1500',\r\n\t\t-- v_standard_homeowners_inland_marine_wbm,'1500',\r\n\t\t-- v_standard_homeowners_earthquake_wbm,'1500',\r\n\t\t-- v_standard_homeowners_personal_liability_wbm,'1500',\r\n\t\t-- v_select_homeowners_allied_lines_wbm,'1500',\r\n\t\t-- v_select_homeowners_homeowners_wbm,'1500',\r\n\t\t-- v_select_homeowners_inland_marine_wbm,'1500',\r\n\t\t-- v_select_homeowners_earthquake_wbm,'1500',\r\n\t\t-- v_select_homeowners_personal_liability_wbm,'1500',\r\n\t\t-- v_dwelling_fire_fire_wbm,'1500',\r\n\t\t-- v_dwelling_fire_allied_lines_wbm,'1500',\r\n\t\t-- v_dwelling_fire_earthquake_wbm,'1500',\r\n\t\t-- v_personal_inland_marine_inland_marine_wbm,'1500',\r\n\t\t-- v_personal_inland_marine_personal_liability_wbm,'1500',\r\n\t\t-- v_motorcycle_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_motorcycle_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_boatowners_inland_marine_wbm,'1500',\r\n\t\t-- v_boatowners_personal_liability_wbm,'1500',\r\n\t\t-- v_alternative_one_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_alternative_one_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_alternative_one_star_pp_auto_liability_wbm,'2000',\r\n\t\t-- v_alternative_one_star_pp_auto_physical_damage_wbm,'2020',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_wbm,'2050',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_nsi,'2050',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_wbm,'2050',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_nsi,'2050',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_wbm,'2070',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_nsi,'2070',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_wbm,'2070',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_nsi,'2070',\r\n\t\t-- v_garage_liability_commercial_auto_liability_wbm,'2080',\r\n\t\t-- v_garage_liability_commercial_auto_liability_nsi,'2080',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_wbm,'2100',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_nsi,'2100',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_wbm,'2150',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_nsi,'2150',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_argent,'2150',\r\n\t\t-- v_commercial_property_earthquake_wbm,'1500',\r\n\t\t-- v_commercial_property_fire_wbm,'1500',\r\n\t\t-- v_commercial_property_earthquake_nsi,'1500',\r\n\t\t-- v_commercial_property_fire_nsi,'1500',\r\n\t\t-- v_commercial_property_allied_lines_wbm,'1500',\r\n\t\t-- v_commercial_property_allied_lines_nsi,'1500',\r\n\t\t-- v_metalworkers_earthquake_wbm,'1500',\r\n\t\t-- v_metalworkers_fire_wbm,'1500',\r\n\t\t-- v_metalworkers_allied_lines_wbm,'1500',\r\n\t\t-- v_metalworkers_inland_marine_wbm,'1500',\r\n\t\t-- v_metalworkers_general_liability_wbm,'1500',\r\n\t\t-- v_metalworkers_products_liability_wbm,'1500',\r\n\t\t-- v_metalworkers_claims_made_product_liability_wbm,'1500',\r\n\t\t-- v_metalworkers_fidelity_wbm,'1500',\r\n\t\t-- v_metalworkers_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_woodworkers_earthquake_wbm,'1500',\r\n\t\t-- v_woodworkers_fire_wbm,'1500',\r\n\t\t-- v_woodworkers_allied_lines_wbm,'1500',\r\n\t\t-- v_woodworkers_inland_marine_wbm,'1500',\r\n\t\t-- v_woodworkers_general_liability_wbm,'1500',\r\n\t\t-- v_woodworkers_products_liability_wbm,'1500',\r\n\t\t-- v_woodworkers_claims_made_product_liability_wbm,'1500',\r\n\t\t-- v_woodworkers_fidelity_wbm,'1500',\r\n\t\t-- v_woodworkers_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_general_liability_general_liability_wbm,'1500',\r\n\t\t-- v_general_liability_general_liability_nsi,'1500',\r\n\t\t-- v_general_liability_products_liability_wbm,'1500',\r\n\t\t-- v_smart_products_liability_wbm,'1500',\r\n\t\t-- v_general_liability_products_liability_nsi,'1500',\r\n\t\t-- v_general_liability_claims_made_product_liability_wbm,'1500',\r\n\t\t-- v_general_liability_claims_made_product_liability_nsi,'1500',\r\n\t\t-- v_general_liability_claims_made_general_liability_nsi,'1500',\r\n\t\t-- v_crime_fidelity_wbm,'1500',\r\n\t\t-- v_smart_fidelity_wbm,'1500',\r\n\t\t-- v_crime_fidelity_nsi,'1500',\r\n\t\t-- v_crime_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_crime_burglary_and_theft_nsi,'1500',\r\n\t\t-- v_commercial_im_inland_marine_wbm,'1500',\r\n\t\t-- v_commercial_im_inland_marine_nsi,'1500',\r\n\t\t-- v_bop_cmp_property_wbm,'1500',\r\n\t\t-- v_bop_unnamed_R13905,'1500',\r\n\t\t-- v_bop_cmp_property_liability_peril_901_904_and_599_wbm,'1500',\r\n\t\t-- v_bop_cmp_liability_wbm,'1500',\r\n\t\t-- v_cbop_earthquake_wbm,'1500',\r\n\t\t-- v_cbop_fire_wbm,'1500',\r\n\t\t-- v_smart_earthquake_wbm,'1500',\r\n\t\t-- v_smart_fire_wbm,'1500',\r\n\t\t-- v_sbop_earthquake_nsi,'1500',\r\n\t\t-- v_sbop_fire_nsi,'1500',\r\n\t\t-- v_cbop_allied_lines_wbm,'1500',\r\n\t\t-- v_smart_allied_lines_wbm,'1500',\r\n\t\t-- v_sbop_allied_lines_nsi,'1500',\r\n\t\t-- v_cbop_cmp_property_wbm,'1500',\r\n\t\t-- v_cbop_inland_marine_wbm,'1500',\r\n\t\t-- v_smart_inland_marine_wbm,'1500',\r\n\t\t-- v_sbop_inland_marine_nsi,'1500',\r\n\t\t-- v_cbop_general_liability_wbm,'1500',\r\n\t\t-- v_smart_general_liability_wbm,'1500',\r\n\t\t-- v_sbop_general_liability_nsi,'1500',\r\n\t\t-- v_cbop_fidelity_wbm,'1500',\r\n\t\t-- v_sbop_fidelity_nsi,'1500',\r\n\t\t-- v_cbop_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_smart_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_sbop_burglary_and_theft_nsi,'1500',\r\n\t\t-- v_gbop_earthquake_wbm,'1500',\r\n\t\t-- v_gbop_fire_wbm,'1500',\r\n\t\t-- v_gbop_allied_lines_wbm,'1500',\r\n\t\t-- v_gbop_inland_marine_wbm,'1500',\r\n\t\t-- v_gbop_general_liability_wbm,'1500',\r\n\t\t-- v_gbop_commercial_auto_liability_wbm,'2110',\r\n\t\t-- v_gbop_cmp_property_liability_peril_901_904_wbm,'1500',\r\n\t\t-- v_gbop_cmp_liability_wbm,'1500',\r\n\t\t-- v_gbop_comm_auto_physical_damage_wbm,'2130',\r\n\t\t-- v_gbop_fidelity_wbm,'1500',\r\n\t\t-- v_gbop_burglary_and_theft_wbm,'1500',\r\n\t\t-- v_personal_umbrella_general_liability_wbm,'1500',\r\n\t\t-- v_commercial_umbrella_general_liability_wbm,'1500',\r\n\t\t-- v_commercial_umbrella_general_liability_nsi,'1500',\r\n\t\t-- v_workers_comp_pool_total_workers_comp_wbm,'2150',\r\n\t\t-- v_fidelity_bonds_fidelity_nsi,'1500',\r\n\t\t-- v_fidelity_bonds_burgulary_and_theft_nsi,'1500',\r\n\t\t-- v_surety_bonds_surety_nsi,'1500',\r\n\t\t-- v_d_and_o_claims_made_general_liability_wbm,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_wbm,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_nsi,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_cbop_wbm,'1500',\r\n\t\t-- v_smart_general_liability_claims_made_smart_wbm,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_sbop_nsi,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_bop_wbm,'1500',\r\n\t\t-- v_epli_general_liability_claims_made_gbop_wbm,'1500',\r\n\t\t-- v_d_and_o_claims_made_general_liability_nsi,'1500',\r\n\t\t-- v_boiler_and_machinery_earthquake_wbm,'1500',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_wbm,'1500',\r\n\t\t-- v_boiler_and_machinery_earthquake_nsi,'1500',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_nsi,'1500',\r\n\t\t-- v_mine_subsidence_homeowners_wbm,'1500',\r\n\t\t-- v_mine_subsidence_allied_lines_wbm,'1500',\r\n\t\t-- v_mine_subsidence_allied_lines_nsi,'1500',\r\n\t\t-- '1500')\r\n\t\t-- -- DECODES must follow the same order as the program\n\t\tDECODE(1,\n\t\tv_home_and_highway_fire_wbm, '1500',\n\t\tv_home_and_highway_allied_lines_wbm, '1500',\n\t\tv_home_and_highway_homeowners_wbm, '1500',\n\t\tv_home_and_highway_inland_marine_wbm, '1500',\n\t\tv_home_and_highway_earthquake_wbm, '1500',\n\t\tv_home_and_highway_personal_liability_wbm, '1500',\n\t\tv_home_and_highway_general_liability_wbm, '1500',\n\t\tv_home_and_highway_pp_auto_liability_wbm, '2000',\n\t\tv_home_and_highway_pp_auto_physical_damage_wbm, '2020',\n\t\tv_preferred_auto_pp_auto_liability_wbm, '2000',\n\t\tv_preferred_auto_pp_auto_physical_damage_wbm, '2020',\n\t\tv_select_auto_pp_auto_liability_wbm, '2000',\n\t\tv_select_auto_pp_auto_physical_damage_wbm, '2020',\n\t\tv_standard_homeowners_allied_lined_wbm, '1500',\n\t\tv_standard_homeowners_homeowners_wbm, '1500',\n\t\tv_standard_homeowners_inland_marine_wbm, '1500',\n\t\tv_standard_homeowners_earthquake_wbm, '1500',\n\t\tv_standard_homeowners_personal_liability_wbm, '1500',\n\t\tv_select_homeowners_allied_lines_wbm, '1500',\n\t\tv_select_homeowners_homeowners_wbm, '1500',\n\t\tv_select_homeowners_inland_marine_wbm, '1500',\n\t\tv_select_homeowners_earthquake_wbm, '1500',\n\t\tv_select_homeowners_personal_liability_wbm, '1500',\n\t\tv_dwelling_fire_fire_wbm, '1500',\n\t\tv_dwelling_fire_allied_lines_wbm, '1500',\n\t\tv_dwelling_fire_earthquake_wbm, '1500',\n\t\tv_personal_inland_marine_inland_marine_wbm, '1500',\n\t\tv_personal_inland_marine_personal_liability_wbm, '1500',\n\t\tv_motorcycle_pp_auto_liability_wbm, '2000',\n\t\tv_motorcycle_pp_auto_physical_damage_wbm, '2020',\n\t\tv_boatowners_inland_marine_wbm, '1500',\n\t\tv_boatowners_personal_liability_wbm, '1500',\n\t\tv_alternative_one_pp_auto_liability_wbm, '2000',\n\t\tv_alternative_one_pp_auto_physical_damage_wbm, '2020',\n\t\tv_alternative_one_star_pp_auto_liability_wbm, '2000',\n\t\tv_alternative_one_star_pp_auto_physical_damage_wbm, '2020',\n\t\tv_commercial_auto_commercial_auto_liability_wbm, '2050',\n\t\tv_commercial_auto_commercial_auto_liability_nsi, '2050',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_wbm, '2050',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_nsi, '2050',\n\t\tv_commercial_auto_comm_auto_physical_damage_wbm, '2070',\n\t\tv_commercial_auto_comm_auto_physical_damage_nsi, '2070',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_wbm, '2070',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_nsi, '2070',\n\t\tv_garage_liability_commercial_auto_liability_wbm, '2080',\n\t\tv_garage_liability_commercial_auto_liability_nsi, '2080',\n\t\tv_garage_liability_commercial_auto_physical_damage_wbm, '2100',\n\t\tv_garage_liability_commercial_auto_physical_damage_nsi, '2100',\n\t\tv_workers_comp_total_non_pool_workers_comp_wbm, '2150',\n\t\tv_workers_comp_total_non_pool_workers_comp_nsi, '2150',\n\t\tv_workers_comp_total_non_pool_workers_comp_argent, '2150',\n\t\tv_commercial_property_earthquake_wbm, '1500',\n\t\tv_commercial_property_fire_wbm, '1500',\n\t\tv_commercial_property_earthquake_nsi, '1500',\n\t\tv_commercial_property_fire_nsi, '1500',\n\t\tv_commercial_property_allied_lines_wbm, '1500',\n\t\tv_commercial_property_allied_lines_nsi, '1500',\n\t\tv_metalworkers_earthquake_wbm, '1500',\n\t\tv_metalworkers_fire_wbm, '1500',\n\t\tv_metalworkers_allied_lines_wbm, '1500',\n\t\tv_metalworkers_inland_marine_wbm, '1500',\n\t\tv_metalworkers_general_liability_wbm, '1500',\n\t\tv_metalworkers_products_liability_wbm, '1500',\n\t\tv_metalworkers_claims_made_product_liability_wbm, '1500',\n\t\tv_metalworkers_fidelity_wbm, '1500',\n\t\tv_metalworkers_burglary_and_theft_wbm, '1500',\n\t\tv_woodworkers_earthquake_wbm, '1500',\n\t\tv_woodworkers_fire_wbm, '1500',\n\t\tv_woodworkers_allied_lines_wbm, '1500',\n\t\tv_woodworkers_inland_marine_wbm, '1500',\n\t\tv_woodworkers_general_liability_wbm, '1500',\n\t\tv_woodworkers_products_liability_wbm, '1500',\n\t\tv_woodworkers_claims_made_product_liability_wbm, '1500',\n\t\tv_woodworkers_fidelity_wbm, '1500',\n\t\tv_woodworkers_burglary_and_theft_wbm, '1500',\n\t\tv_general_liability_general_liability_wbm, '1500',\n\t\tv_general_liability_general_liability_nsi, '1500',\n\t\tv_general_liability_products_liability_wbm, '1500',\n\t\tv_smart_products_liability_wbm, '1500',\n\t\tv_general_liability_products_liability_nsi, '1500',\n\t\tv_general_liability_claims_made_product_liability_wbm, '1500',\n\t\tv_general_liability_claims_made_product_liability_nsi, '1500',\n\t\tv_general_liability_claims_made_general_liability_nsi, '1500',\n\t\tv_crime_fidelity_wbm, '1500',\n\t\tv_smart_fidelity_wbm, '1500',\n\t\tv_crime_fidelity_nsi, '1500',\n\t\tv_crime_burglary_and_theft_wbm, '1500',\n\t\tv_crime_burglary_and_theft_nsi, '1500',\n\t\tv_commercial_im_inland_marine_wbm, '1500',\n\t\tv_commercial_im_inland_marine_nsi, '1500',\n\t\tv_bop_cmp_property_wbm, '1500',\n\t\tv_bop_unnamed_R13905, '1500',\n\t\tv_bop_cmp_property_liability_peril_901_904_and_599_wbm, '1500',\n\t\tv_bop_cmp_liability_wbm, '1500',\n\t\tv_cbop_earthquake_wbm, '1500',\n\t\tv_cbop_fire_wbm, '1500',\n\t\tv_smart_earthquake_wbm, '1500',\n\t\tv_smart_fire_wbm, '1500',\n\t\tv_sbop_earthquake_nsi, '1500',\n\t\tv_sbop_fire_nsi, '1500',\n\t\tv_cbop_allied_lines_wbm, '1500',\n\t\tv_smart_allied_lines_wbm, '1500',\n\t\tv_sbop_allied_lines_nsi, '1500',\n\t\tv_cbop_cmp_property_wbm, '1500',\n\t\tv_cbop_inland_marine_wbm, '1500',\n\t\tv_smart_inland_marine_wbm, '1500',\n\t\tv_sbop_inland_marine_nsi, '1500',\n\t\tv_cbop_general_liability_wbm, '1500',\n\t\tv_smart_general_liability_wbm, '1500',\n\t\tv_sbop_general_liability_nsi, '1500',\n\t\tv_cbop_fidelity_wbm, '1500',\n\t\tv_sbop_fidelity_nsi, '1500',\n\t\tv_cbop_burglary_and_theft_wbm, '1500',\n\t\tv_smart_burglary_and_theft_wbm, '1500',\n\t\tv_sbop_burglary_and_theft_nsi, '1500',\n\t\tv_gbop_earthquake_wbm, '1500',\n\t\tv_gbop_fire_wbm, '1500',\n\t\tv_gbop_allied_lines_wbm, '1500',\n\t\tv_gbop_inland_marine_wbm, '1500',\n\t\tv_gbop_general_liability_wbm, '1500',\n\t\tv_gbop_commercial_auto_liability_wbm, '2110',\n\t\tv_gbop_cmp_property_liability_peril_901_904_wbm, '1500',\n\t\tv_gbop_cmp_liability_wbm, '1500',\n\t\tv_gbop_comm_auto_physical_damage_wbm, '2130',\n\t\tv_gbop_fidelity_wbm, '1500',\n\t\tv_gbop_burglary_and_theft_wbm, '1500',\n\t\tv_personal_umbrella_general_liability_wbm, '1500',\n\t\tv_commercial_umbrella_general_liability_wbm, '1500',\n\t\tv_commercial_umbrella_general_liability_nsi, '1500',\n\t\tv_workers_comp_pool_total_workers_comp_wbm, '2150',\n\t\tv_fidelity_bonds_fidelity_nsi, '1500',\n\t\tv_fidelity_bonds_burgulary_and_theft_nsi, '1500',\n\t\tv_surety_bonds_surety_nsi, '1500',\n\t\tv_d_and_o_claims_made_general_liability_wbm, '1500',\n\t\tv_epli_general_liability_claims_made_wbm, '1500',\n\t\tv_epli_general_liability_claims_made_nsi, '1500',\n\t\tv_epli_general_liability_claims_made_cpp_cbop_wbm, '1500',\n\t\tv_smart_general_liability_claims_made_smart_wbm, '1500',\n\t\tv_epli_general_liability_claims_made_cpp_sbop_nsi, '1500',\n\t\tv_epli_general_liability_claims_made_bop_wbm, '1500',\n\t\tv_epli_general_liability_claims_made_gbop_wbm, '1500',\n\t\tv_d_and_o_claims_made_general_liability_nsi, '1500',\n\t\tv_boiler_and_machinery_earthquake_wbm, '1500',\n\t\tv_boiler_and_machinery_boiler_and_machinery_wbm, '1500',\n\t\tv_boiler_and_machinery_earthquake_nsi, '1500',\n\t\tv_boiler_and_machinery_boiler_and_machinery_nsi, '1500',\n\t\tv_mine_subsidence_homeowners_wbm, '1500',\n\t\tv_mine_subsidence_allied_lines_wbm, '1500',\n\t\tv_mine_subsidence_allied_lines_nsi, '1500',\n\t\t'1500') AS Path_Flag_Step_1,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_home_and_highway_fire_wbm,'20',\r\n\t\t-- v_home_and_highway_allied_lines_wbm,'20',\r\n\t\t-- v_home_and_highway_homeowners_wbm,'20',\r\n\t\t-- v_home_and_highway_inland_marine_wbm,'20',\r\n\t\t-- v_home_and_highway_earthquake_wbm,'20',\r\n\t\t-- v_home_and_highway_personal_liability_wbm,'20',\r\n\t\t-- v_home_and_highway_general_liability_wbm,'20',\r\n\t\t-- v_home_and_highway_pp_auto_liability_wbm,'20',\r\n\t\t-- v_home_and_highway_pp_auto_physical_damage_wbm,'20',\r\n\t\t-- v_preferred_auto_pp_auto_liability_wbm,'40',\r\n\t\t-- v_preferred_auto_pp_auto_physical_damage_wbm,'40',\r\n\t\t-- v_select_auto_pp_auto_liability_wbm,'60',\r\n\t\t-- v_select_auto_pp_auto_physical_damage_wbm,'60',\r\n\t\t-- v_standard_homeowners_allied_lined_wbm,'80',\r\n\t\t-- v_standard_homeowners_homeowners_wbm,'80',\r\n\t\t-- v_standard_homeowners_inland_marine_wbm,'80',\r\n\t\t-- v_standard_homeowners_earthquake_wbm,'80',\r\n\t\t-- v_standard_homeowners_personal_liability_wbm,'80',\r\n\t\t-- v_select_homeowners_allied_lines_wbm,'100',\r\n\t\t-- v_select_homeowners_homeowners_wbm,'100',\r\n\t\t-- v_select_homeowners_inland_marine_wbm,'100',\r\n\t\t-- v_select_homeowners_earthquake_wbm,'100',\r\n\t\t-- v_select_homeowners_personal_liability_wbm,'100',\r\n\t\t-- v_dwelling_fire_fire_wbm,'120',\r\n\t\t-- v_dwelling_fire_allied_lines_wbm,'120',\r\n\t\t-- v_dwelling_fire_earthquake_wbm,'120',\r\n\t\t-- v_personal_inland_marine_inland_marine_wbm,'140',\r\n\t\t-- v_personal_inland_marine_personal_liability_wbm,'140',\r\n\t\t-- v_motorcycle_pp_auto_liability_wbm,'160',\r\n\t\t-- v_motorcycle_pp_auto_physical_damage_wbm,'160',\r\n\t\t-- v_boatowners_inland_marine_wbm,'180',\r\n\t\t-- v_boatowners_personal_liability_wbm,'180',\r\n\t\t-- v_alternative_one_pp_auto_liability_wbm,'200',\r\n\t\t-- v_alternative_one_pp_auto_physical_damage_wbm,'200',\r\n\t\t-- v_alternative_one_star_pp_auto_liability_wbm,'220',\r\n\t\t-- v_alternative_one_star_pp_auto_physical_damage_wbm,'220',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_wbm,'240',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_nsi,'600',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_wbm,'240',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_nsi,'600',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_wbm,'240',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_nsi,'600',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_wbm,'240',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_nsi,'600',\r\n\t\t-- v_garage_liability_commercial_auto_liability_wbm,'260',\r\n\t\t-- v_garage_liability_commercial_auto_liability_nsi,'620',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_wbm,'260',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_nsi,'620',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_wbm,'280',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_nsi,'640',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_argent,'950',\r\n\t\t-- v_commercial_property_earthquake_wbm,'300',\r\n\t\t-- v_commercial_property_fire_wbm,'300',\r\n\t\t-- v_commercial_property_earthquake_nsi,'660',\r\n\t\t-- v_commercial_property_fire_nsi,'660',\r\n\t\t-- v_commercial_property_allied_lines_wbm,'300',\r\n\t\t-- v_commercial_property_allied_lines_nsi,'660',\r\n\t\t-- v_metalworkers_earthquake_wbm,'320',\r\n\t\t-- v_metalworkers_fire_wbm,'320',\r\n\t\t-- v_metalworkers_allied_lines_wbm,'320',\r\n\t\t-- v_metalworkers_inland_marine_wbm,'320',\r\n\t\t-- v_metalworkers_general_liability_wbm,'320',\r\n\t\t-- v_metalworkers_products_liability_wbm,'320',\r\n\t\t-- v_metalworkers_claims_made_product_liability_wbm,'320',\r\n\t\t-- v_metalworkers_fidelity_wbm,'320',\r\n\t\t-- v_metalworkers_burglary_and_theft_wbm,'320',\r\n\t\t-- v_woodworkers_earthquake_wbm,'340',\r\n\t\t-- v_woodworkers_fire_wbm,'340',\r\n\t\t-- v_woodworkers_allied_lines_wbm,'340',\r\n\t\t-- v_woodworkers_inland_marine_wbm,'340',\r\n\t\t-- v_woodworkers_general_liability_wbm,'340',\r\n\t\t-- v_woodworkers_products_liability_wbm,'340',\r\n\t\t-- v_woodworkers_claims_made_product_liability_wbm,'340',\r\n\t\t-- v_woodworkers_fidelity_wbm,'340',\r\n\t\t-- v_woodworkers_burglary_and_theft_wbm,'340',\r\n\t\t-- v_general_liability_general_liability_wbm,'360',\r\n\t\t-- v_general_liability_general_liability_nsi,'680',\r\n\t\t-- v_general_liability_products_liability_wbm,'360',\r\n\t\t-- v_smart_products_liability_wbm,'450',\r\n\t\t-- v_general_liability_products_liability_nsi,'680',\r\n\t\t-- v_general_liability_claims_made_product_liability_wbm,'360',\r\n\t\t-- v_general_liability_claims_made_product_liability_nsi,'680',\r\n\t\t-- v_general_liability_claims_made_general_liability_nsi,'680',\r\n\t\t-- v_crime_fidelity_wbm,'380',\r\n\t\t-- v_smart_fidelity_wbm,'450',\r\n\t\t-- v_crime_fidelity_nsi,'700',\r\n\t\t-- v_crime_burglary_and_theft_wbm,'380',\r\n\t\t-- v_crime_burglary_and_theft_nsi,'700',\r\n\t\t-- v_commercial_im_inland_marine_wbm,'400',\r\n\t\t-- v_commercial_im_inland_marine_nsi,'720',\r\n\t\t-- v_bop_cmp_property_wbm,'420',\r\n\t\t-- v_bop_unnamed_R13905,'420',\r\n\t\t-- v_bop_cmp_property_liability_peril_901_904_and_599_wbm,'420',\r\n\t\t-- v_bop_cmp_liability_wbm,'420',\r\n\t\t-- v_cbop_earthquake_wbm,'440',\r\n\t\t-- v_cbop_fire_wbm,'440',\r\n\t\t-- v_smart_earthquake_wbm,'450',\r\n\t\t-- v_smart_fire_wbm,'450',\r\n\t\t-- v_sbop_earthquake_nsi,'740',\r\n\t\t-- v_sbop_fire_nsi,'740',\r\n\t\t-- v_cbop_allied_lines_wbm,'440',\r\n\t\t-- v_smart_allied_lines_wbm,'450',\r\n\t\t-- v_sbop_allied_lines_nsi,'740',\r\n\t\t-- v_cbop_cmp_property_wbm,'440',\r\n\t\t-- v_cbop_inland_marine_wbm,'440',\r\n\t\t-- v_smart_inland_marine_wbm,'450',\r\n\t\t-- v_sbop_inland_marine_nsi,'740',\r\n\t\t-- v_cbop_general_liability_wbm,'440',\r\n\t\t-- v_smart_general_liability_wbm,'450',\r\n\t\t-- v_sbop_general_liability_nsi,'740',\r\n\t\t-- v_cbop_fidelity_wbm,'440',\r\n\t\t-- v_sbop_fidelity_nsi,'740',\r\n\t\t-- v_cbop_burglary_and_theft_wbm,'440',\r\n\t\t-- v_smart_burglary_and_theft_wbm,'450',\r\n\t\t-- v_sbop_burglary_and_theft_nsi,'740',\r\n\t\t-- v_gbop_earthquake_wbm,'460',\r\n\t\t-- v_gbop_fire_wbm,'460',\r\n\t\t-- v_gbop_allied_lines_wbm,'460',\r\n\t\t-- v_gbop_inland_marine_wbm,'460',\r\n\t\t-- v_gbop_general_liability_wbm,'460',\r\n\t\t-- v_gbop_commercial_auto_liability_wbm,'460',\r\n\t\t-- v_gbop_cmp_property_liability_peril_901_904_wbm,'460',\r\n\t\t-- v_gbop_cmp_liability_wbm,'460',\r\n\t\t-- v_gbop_comm_auto_physical_damage_wbm,'460',\r\n\t\t-- v_gbop_fidelity_wbm,'460',\r\n\t\t-- v_gbop_burglary_and_theft_wbm,'460',\r\n\t\t-- v_personal_umbrella_general_liability_wbm,'480',\r\n\t\t-- v_commercial_umbrella_general_liability_wbm,'500',\r\n\t\t-- v_commercial_umbrella_general_liability_nsi,'760',\r\n\t\t-- v_workers_comp_pool_total_workers_comp_wbm,'580',\r\n\t\t-- v_fidelity_bonds_fidelity_nsi,'780',\r\n\t\t-- v_fidelity_bonds_burgulary_and_theft_nsi,'780',\r\n\t\t-- v_surety_bonds_surety_nsi,'800',\r\n\t\t-- v_d_and_o_claims_made_general_liability_wbm,'530',\r\n\t\t-- v_epli_general_liability_claims_made_wbm,'520',\r\n\t\t-- v_epli_general_liability_claims_made_nsi,'820',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_cbop_wbm,'520',\r\n\t\t-- v_smart_general_liability_claims_made_smart_wbm,'450',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_sbop_nsi,'820',\r\n\t\t-- v_epli_general_liability_claims_made_bop_wbm,'520',\r\n\t\t-- v_epli_general_liability_claims_made_gbop_wbm,'520',\r\n\t\t-- v_d_and_o_claims_made_general_liability_nsi,'840',\r\n\t\t-- v_boiler_and_machinery_earthquake_wbm,'540',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_wbm,'540',\r\n\t\t-- v_boiler_and_machinery_earthquake_nsi,'860',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_nsi,'860',\r\n\t\t-- v_mine_subsidence_homeowners_wbm,'560',\r\n\t\t-- v_mine_subsidence_allied_lines_wbm,'560',\r\n\t\t-- v_mine_subsidence_allied_lines_nsi,'880',\r\n\t\t-- '999')\r\n\t\t-- -- DECODES must follow the same order as the program\n\t\tDECODE(1,\n\t\tv_home_and_highway_fire_wbm, '20',\n\t\tv_home_and_highway_allied_lines_wbm, '20',\n\t\tv_home_and_highway_homeowners_wbm, '20',\n\t\tv_home_and_highway_inland_marine_wbm, '20',\n\t\tv_home_and_highway_earthquake_wbm, '20',\n\t\tv_home_and_highway_personal_liability_wbm, '20',\n\t\tv_home_and_highway_general_liability_wbm, '20',\n\t\tv_home_and_highway_pp_auto_liability_wbm, '20',\n\t\tv_home_and_highway_pp_auto_physical_damage_wbm, '20',\n\t\tv_preferred_auto_pp_auto_liability_wbm, '40',\n\t\tv_preferred_auto_pp_auto_physical_damage_wbm, '40',\n\t\tv_select_auto_pp_auto_liability_wbm, '60',\n\t\tv_select_auto_pp_auto_physical_damage_wbm, '60',\n\t\tv_standard_homeowners_allied_lined_wbm, '80',\n\t\tv_standard_homeowners_homeowners_wbm, '80',\n\t\tv_standard_homeowners_inland_marine_wbm, '80',\n\t\tv_standard_homeowners_earthquake_wbm, '80',\n\t\tv_standard_homeowners_personal_liability_wbm, '80',\n\t\tv_select_homeowners_allied_lines_wbm, '100',\n\t\tv_select_homeowners_homeowners_wbm, '100',\n\t\tv_select_homeowners_inland_marine_wbm, '100',\n\t\tv_select_homeowners_earthquake_wbm, '100',\n\t\tv_select_homeowners_personal_liability_wbm, '100',\n\t\tv_dwelling_fire_fire_wbm, '120',\n\t\tv_dwelling_fire_allied_lines_wbm, '120',\n\t\tv_dwelling_fire_earthquake_wbm, '120',\n\t\tv_personal_inland_marine_inland_marine_wbm, '140',\n\t\tv_personal_inland_marine_personal_liability_wbm, '140',\n\t\tv_motorcycle_pp_auto_liability_wbm, '160',\n\t\tv_motorcycle_pp_auto_physical_damage_wbm, '160',\n\t\tv_boatowners_inland_marine_wbm, '180',\n\t\tv_boatowners_personal_liability_wbm, '180',\n\t\tv_alternative_one_pp_auto_liability_wbm, '200',\n\t\tv_alternative_one_pp_auto_physical_damage_wbm, '200',\n\t\tv_alternative_one_star_pp_auto_liability_wbm, '220',\n\t\tv_alternative_one_star_pp_auto_physical_damage_wbm, '220',\n\t\tv_commercial_auto_commercial_auto_liability_wbm, '240',\n\t\tv_commercial_auto_commercial_auto_liability_nsi, '600',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_wbm, '240',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_nsi, '600',\n\t\tv_commercial_auto_comm_auto_physical_damage_wbm, '240',\n\t\tv_commercial_auto_comm_auto_physical_damage_nsi, '600',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_wbm, '240',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_nsi, '600',\n\t\tv_garage_liability_commercial_auto_liability_wbm, '260',\n\t\tv_garage_liability_commercial_auto_liability_nsi, '620',\n\t\tv_garage_liability_commercial_auto_physical_damage_wbm, '260',\n\t\tv_garage_liability_commercial_auto_physical_damage_nsi, '620',\n\t\tv_workers_comp_total_non_pool_workers_comp_wbm, '280',\n\t\tv_workers_comp_total_non_pool_workers_comp_nsi, '640',\n\t\tv_workers_comp_total_non_pool_workers_comp_argent, '950',\n\t\tv_commercial_property_earthquake_wbm, '300',\n\t\tv_commercial_property_fire_wbm, '300',\n\t\tv_commercial_property_earthquake_nsi, '660',\n\t\tv_commercial_property_fire_nsi, '660',\n\t\tv_commercial_property_allied_lines_wbm, '300',\n\t\tv_commercial_property_allied_lines_nsi, '660',\n\t\tv_metalworkers_earthquake_wbm, '320',\n\t\tv_metalworkers_fire_wbm, '320',\n\t\tv_metalworkers_allied_lines_wbm, '320',\n\t\tv_metalworkers_inland_marine_wbm, '320',\n\t\tv_metalworkers_general_liability_wbm, '320',\n\t\tv_metalworkers_products_liability_wbm, '320',\n\t\tv_metalworkers_claims_made_product_liability_wbm, '320',\n\t\tv_metalworkers_fidelity_wbm, '320',\n\t\tv_metalworkers_burglary_and_theft_wbm, '320',\n\t\tv_woodworkers_earthquake_wbm, '340',\n\t\tv_woodworkers_fire_wbm, '340',\n\t\tv_woodworkers_allied_lines_wbm, '340',\n\t\tv_woodworkers_inland_marine_wbm, '340',\n\t\tv_woodworkers_general_liability_wbm, '340',\n\t\tv_woodworkers_products_liability_wbm, '340',\n\t\tv_woodworkers_claims_made_product_liability_wbm, '340',\n\t\tv_woodworkers_fidelity_wbm, '340',\n\t\tv_woodworkers_burglary_and_theft_wbm, '340',\n\t\tv_general_liability_general_liability_wbm, '360',\n\t\tv_general_liability_general_liability_nsi, '680',\n\t\tv_general_liability_products_liability_wbm, '360',\n\t\tv_smart_products_liability_wbm, '450',\n\t\tv_general_liability_products_liability_nsi, '680',\n\t\tv_general_liability_claims_made_product_liability_wbm, '360',\n\t\tv_general_liability_claims_made_product_liability_nsi, '680',\n\t\tv_general_liability_claims_made_general_liability_nsi, '680',\n\t\tv_crime_fidelity_wbm, '380',\n\t\tv_smart_fidelity_wbm, '450',\n\t\tv_crime_fidelity_nsi, '700',\n\t\tv_crime_burglary_and_theft_wbm, '380',\n\t\tv_crime_burglary_and_theft_nsi, '700',\n\t\tv_commercial_im_inland_marine_wbm, '400',\n\t\tv_commercial_im_inland_marine_nsi, '720',\n\t\tv_bop_cmp_property_wbm, '420',\n\t\tv_bop_unnamed_R13905, '420',\n\t\tv_bop_cmp_property_liability_peril_901_904_and_599_wbm, '420',\n\t\tv_bop_cmp_liability_wbm, '420',\n\t\tv_cbop_earthquake_wbm, '440',\n\t\tv_cbop_fire_wbm, '440',\n\t\tv_smart_earthquake_wbm, '450',\n\t\tv_smart_fire_wbm, '450',\n\t\tv_sbop_earthquake_nsi, '740',\n\t\tv_sbop_fire_nsi, '740',\n\t\tv_cbop_allied_lines_wbm, '440',\n\t\tv_smart_allied_lines_wbm, '450',\n\t\tv_sbop_allied_lines_nsi, '740',\n\t\tv_cbop_cmp_property_wbm, '440',\n\t\tv_cbop_inland_marine_wbm, '440',\n\t\tv_smart_inland_marine_wbm, '450',\n\t\tv_sbop_inland_marine_nsi, '740',\n\t\tv_cbop_general_liability_wbm, '440',\n\t\tv_smart_general_liability_wbm, '450',\n\t\tv_sbop_general_liability_nsi, '740',\n\t\tv_cbop_fidelity_wbm, '440',\n\t\tv_sbop_fidelity_nsi, '740',\n\t\tv_cbop_burglary_and_theft_wbm, '440',\n\t\tv_smart_burglary_and_theft_wbm, '450',\n\t\tv_sbop_burglary_and_theft_nsi, '740',\n\t\tv_gbop_earthquake_wbm, '460',\n\t\tv_gbop_fire_wbm, '460',\n\t\tv_gbop_allied_lines_wbm, '460',\n\t\tv_gbop_inland_marine_wbm, '460',\n\t\tv_gbop_general_liability_wbm, '460',\n\t\tv_gbop_commercial_auto_liability_wbm, '460',\n\t\tv_gbop_cmp_property_liability_peril_901_904_wbm, '460',\n\t\tv_gbop_cmp_liability_wbm, '460',\n\t\tv_gbop_comm_auto_physical_damage_wbm, '460',\n\t\tv_gbop_fidelity_wbm, '460',\n\t\tv_gbop_burglary_and_theft_wbm, '460',\n\t\tv_personal_umbrella_general_liability_wbm, '480',\n\t\tv_commercial_umbrella_general_liability_wbm, '500',\n\t\tv_commercial_umbrella_general_liability_nsi, '760',\n\t\tv_workers_comp_pool_total_workers_comp_wbm, '580',\n\t\tv_fidelity_bonds_fidelity_nsi, '780',\n\t\tv_fidelity_bonds_burgulary_and_theft_nsi, '780',\n\t\tv_surety_bonds_surety_nsi, '800',\n\t\tv_d_and_o_claims_made_general_liability_wbm, '530',\n\t\tv_epli_general_liability_claims_made_wbm, '520',\n\t\tv_epli_general_liability_claims_made_nsi, '820',\n\t\tv_epli_general_liability_claims_made_cpp_cbop_wbm, '520',\n\t\tv_smart_general_liability_claims_made_smart_wbm, '450',\n\t\tv_epli_general_liability_claims_made_cpp_sbop_nsi, '820',\n\t\tv_epli_general_liability_claims_made_bop_wbm, '520',\n\t\tv_epli_general_liability_claims_made_gbop_wbm, '520',\n\t\tv_d_and_o_claims_made_general_liability_nsi, '840',\n\t\tv_boiler_and_machinery_earthquake_wbm, '540',\n\t\tv_boiler_and_machinery_boiler_and_machinery_wbm, '540',\n\t\tv_boiler_and_machinery_earthquake_nsi, '860',\n\t\tv_boiler_and_machinery_boiler_and_machinery_nsi, '860',\n\t\tv_mine_subsidence_homeowners_wbm, '560',\n\t\tv_mine_subsidence_allied_lines_wbm, '560',\n\t\tv_mine_subsidence_allied_lines_nsi, '880',\n\t\t'999') AS product_code,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_home_and_highway_fire_wbm,'20',\r\n\t\t-- v_home_and_highway_allied_lines_wbm,'40',\r\n\t\t-- v_home_and_highway_homeowners_wbm,'60',\r\n\t\t-- v_home_and_highway_inland_marine_wbm,'120',\r\n\t\t-- v_home_and_highway_earthquake_wbm,'140',\r\n\t\t-- v_home_and_highway_personal_liability_wbm,'200',\r\n\t\t-- v_home_and_highway_general_liability_wbm,'220',\r\n\t\t-- v_home_and_highway_pp_auto_liability_wbm,'260',\r\n\t\t-- v_home_and_highway_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_preferred_auto_pp_auto_liability_wbm,'260',\r\n\t\t-- v_preferred_auto_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_select_auto_pp_auto_liability_wbm,'260',\r\n\t\t-- v_select_auto_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_standard_homeowners_allied_lined_wbm,'40',\r\n\t\t-- v_standard_homeowners_homeowners_wbm,'60',\r\n\t\t-- v_standard_homeowners_inland_marine_wbm,'120',\r\n\t\t-- v_standard_homeowners_earthquake_wbm,'140',\r\n\t\t-- v_standard_homeowners_personal_liability_wbm,'200',\r\n\t\t-- v_select_homeowners_allied_lines_wbm,'40',\r\n\t\t-- v_select_homeowners_homeowners_wbm,'60',\r\n\t\t-- v_select_homeowners_inland_marine_wbm,'120',\r\n\t\t-- v_select_homeowners_earthquake_wbm,'140',\r\n\t\t-- v_select_homeowners_personal_liability_wbm,'200',\r\n\t\t-- v_dwelling_fire_fire_wbm,'20',\r\n\t\t-- v_dwelling_fire_allied_lines_wbm,'40',\r\n\t\t-- v_dwelling_fire_earthquake_wbm,'140',\r\n\t\t-- v_personal_inland_marine_inland_marine_wbm,'120',\r\n\t\t-- v_personal_inland_marine_personal_liability_wbm,'200',\r\n\t\t-- v_motorcycle_pp_auto_liability_wbm,'260',\r\n\t\t-- v_motorcycle_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_boatowners_inland_marine_wbm,'120',\r\n\t\t-- v_boatowners_personal_liability_wbm,'200',\r\n\t\t-- v_alternative_one_pp_auto_liability_wbm,'260',\r\n\t\t-- v_alternative_one_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_alternative_one_star_pp_auto_liability_wbm,'260',\r\n\t\t-- v_alternative_one_star_pp_auto_physical_damage_wbm,'440',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_wbm,'340',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_nsi,'340',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_wbm,'340',\r\n\t\t-- v_commercial_auto_commercial_auto_liability_garage_veh_nsi,'340',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_wbm,'500',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_nsi,'500',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_wbm,'500',\r\n\t\t-- v_commercial_auto_comm_auto_physical_damage_garage_veh_nsi,'500',\r\n\t\t-- v_garage_liability_commercial_auto_liability_wbm,'340',\r\n\t\t-- v_garage_liability_commercial_auto_liability_nsi,'340',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_wbm,'500',\r\n\t\t-- v_garage_liability_commercial_auto_physical_damage_nsi,'500',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_wbm,'160',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_nsi,'160',\r\n\t\t-- v_workers_comp_total_non_pool_workers_comp_argent,'160',\r\n\t\t-- v_commercial_property_earthquake_wbm,'140',\r\n\t\t-- v_commercial_property_fire_wbm,'20',\r\n\t\t-- v_commercial_property_earthquake_nsi,'140',\r\n\t\t-- v_commercial_property_fire_nsi,'20',\r\n\t\t-- v_commercial_property_allied_lines_wbm,'40',\r\n\t\t-- v_commercial_property_allied_lines_nsi,'40',\r\n\t\t-- v_metalworkers_earthquake_wbm,'140',\r\n\t\t-- v_metalworkers_fire_wbm,'20',\r\n\t\t-- v_metalworkers_allied_lines_wbm,'40',\r\n\t\t-- v_metalworkers_inland_marine_wbm,'120',\r\n\t\t-- v_metalworkers_general_liability_wbm,'220',\r\n\t\t-- v_metalworkers_products_liability_wbm,'240',\r\n\t\t-- v_metalworkers_claims_made_product_liability_wbm,'250',\r\n\t\t-- v_metalworkers_fidelity_wbm,'600',\r\n\t\t-- v_metalworkers_burglary_and_theft_wbm,'640',\r\n\t\t-- v_woodworkers_earthquake_wbm,'140',\r\n\t\t-- v_woodworkers_fire_wbm,'20',\r\n\t\t-- v_woodworkers_allied_lines_wbm,'40',\r\n\t\t-- v_woodworkers_inland_marine_wbm,'120',\r\n\t\t-- v_woodworkers_general_liability_wbm,'220',\r\n\t\t-- v_woodworkers_products_liability_wbm,'240',\r\n\t\t-- v_woodworkers_claims_made_product_liability_wbm,'250',\r\n\t\t-- v_woodworkers_fidelity_wbm,'600',\r\n\t\t-- v_woodworkers_burglary_and_theft_wbm,'640',\r\n\t\t-- v_general_liability_general_liability_wbm,'220',\r\n\t\t-- v_general_liability_general_liability_nsi,'220',\r\n\t\t-- v_general_liability_products_liability_wbm,'240',\r\n\t\t-- v_smart_products_liability_wbm,'240',\r\n\t\t-- v_general_liability_products_liability_nsi,'240',\r\n\t\t-- v_general_liability_claims_made_product_liability_wbm,'250',\r\n\t\t-- v_general_liability_claims_made_product_liability_nsi,'250',\r\n\t\t-- v_general_liability_claims_made_general_liability_nsi,'230',\r\n\t\t-- v_crime_fidelity_wbm,'600',\r\n\t\t-- v_smart_fidelity_wbm,'600',\r\n\t\t-- v_crime_fidelity_nsi,'600',\r\n\t\t-- v_crime_burglary_and_theft_wbm,'640',\r\n\t\t-- v_crime_burglary_and_theft_nsi,'640',\r\n\t\t-- v_commercial_im_inland_marine_wbm,'120',\r\n\t\t-- v_commercial_im_inland_marine_nsi,'120',\r\n\t\t-- v_bop_cmp_property_wbm,'80',\r\n\t\t-- v_bop_unnamed_R13905,'80',\r\n\t\t-- v_bop_cmp_property_liability_peril_901_904_and_599_wbm,to_char(:UDF.ASL_400_PERIL_901_904_LIABILITY(loss_cause,80)),\r\n\t\t-- v_bop_cmp_liability_wbm,'100',\r\n\t\t-- v_cbop_earthquake_wbm,'140',\r\n\t\t-- v_cbop_fire_wbm,'20',\r\n\t\t-- v_smart_earthquake_wbm,'140',\r\n\t\t-- v_smart_fire_wbm,'20',\r\n\t\t-- v_sbop_earthquake_nsi,'140',\r\n\t\t-- v_sbop_fire_nsi,'20',\r\n\t\t-- v_cbop_allied_lines_wbm,'40',\r\n\t\t-- v_smart_allied_lines_wbm,'40',\r\n\t\t-- v_sbop_allied_lines_nsi,'40',\r\n\t\t-- v_cbop_cmp_property_wbm,'80',\r\n\t\t-- v_cbop_inland_marine_wbm,'120',\r\n\t\t-- v_smart_inland_marine_wbm,'120',\r\n\t\t-- v_sbop_inland_marine_nsi,'120',\r\n\t\t-- v_cbop_general_liability_wbm,'220',\r\n\t\t-- v_smart_general_liability_wbm,'220',\r\n\t\t-- v_sbop_general_liability_nsi,'220',\r\n\t\t-- v_cbop_fidelity_wbm,'600',\r\n\t\t-- v_sbop_fidelity_nsi,'600',\r\n\t\t-- v_cbop_burglary_and_theft_wbm,'640',\r\n\t\t-- v_smart_burglary_and_theft_wbm,'640',\r\n\t\t-- v_sbop_burglary_and_theft_nsi,'640',\r\n\t\t-- v_gbop_earthquake_wbm,'140',\r\n\t\t-- v_gbop_fire_wbm,'20',\r\n\t\t-- v_gbop_allied_lines_wbm,'40',\r\n\t\t-- v_gbop_inland_marine_wbm,'120',\r\n\t\t-- v_gbop_general_liability_wbm,'220',\r\n\t\t-- v_gbop_commercial_auto_liability_wbm,'340',\r\n\t\t-- v_gbop_cmp_property_liability_peril_901_904_wbm,'80',\r\n\t\t-- v_gbop_cmp_liability_wbm,'100',\r\n\t\t-- v_gbop_comm_auto_physical_damage_wbm,'500',\r\n\t\t-- v_gbop_fidelity_wbm,'600',\r\n\t\t-- v_gbop_burglary_and_theft_wbm,'640',\r\n\t\t-- v_personal_umbrella_general_liability_wbm,'220',\r\n\t\t-- v_commercial_umbrella_general_liability_wbm,'220',\r\n\t\t-- v_commercial_umbrella_general_liability_nsi,'220',\r\n\t\t-- v_workers_comp_pool_total_workers_comp_wbm,'160',\r\n\t\t-- v_fidelity_bonds_fidelity_nsi,'600',\r\n\t\t-- v_fidelity_bonds_burgulary_and_theft_nsi,'640',\r\n\t\t-- v_surety_bonds_surety_nsi,'620',\r\n\t\t-- v_d_and_o_claims_made_general_liability_wbm,'230',\r\n\t\t-- v_epli_general_liability_claims_made_wbm,'230',\r\n\t\t-- v_epli_general_liability_claims_made_nsi,'230',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_cbop_wbm,'230',\r\n\t\t-- v_smart_general_liability_claims_made_smart_wbm,'230',\r\n\t\t-- v_epli_general_liability_claims_made_cpp_sbop_nsi,'230',\r\n\t\t-- v_epli_general_liability_claims_made_bop_wbm,'230',\r\n\t\t-- v_epli_general_liability_claims_made_gbop_wbm,'230',\r\n\t\t-- v_d_and_o_claims_made_general_liability_nsi,'230',\r\n\t\t-- v_boiler_and_machinery_earthquake_wbm,'140',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_wbm,'660',\r\n\t\t-- v_boiler_and_machinery_earthquake_nsi,'140',\r\n\t\t-- v_boiler_and_machinery_boiler_and_machinery_nsi,'660',\r\n\t\t-- v_mine_subsidence_homeowners_wbm,'60',\r\n\t\t-- v_mine_subsidence_allied_lines_wbm,'40',\r\n\t\t-- v_mine_subsidence_allied_lines_nsi,'40',\r\n\t\t-- '999')\r\n\t\t-- -- DECODES must follow the same order as the program\n\t\tDECODE(1,\n\t\tv_home_and_highway_fire_wbm, '20',\n\t\tv_home_and_highway_allied_lines_wbm, '40',\n\t\tv_home_and_highway_homeowners_wbm, '60',\n\t\tv_home_and_highway_inland_marine_wbm, '120',\n\t\tv_home_and_highway_earthquake_wbm, '140',\n\t\tv_home_and_highway_personal_liability_wbm, '200',\n\t\tv_home_and_highway_general_liability_wbm, '220',\n\t\tv_home_and_highway_pp_auto_liability_wbm, '260',\n\t\tv_home_and_highway_pp_auto_physical_damage_wbm, '440',\n\t\tv_preferred_auto_pp_auto_liability_wbm, '260',\n\t\tv_preferred_auto_pp_auto_physical_damage_wbm, '440',\n\t\tv_select_auto_pp_auto_liability_wbm, '260',\n\t\tv_select_auto_pp_auto_physical_damage_wbm, '440',\n\t\tv_standard_homeowners_allied_lined_wbm, '40',\n\t\tv_standard_homeowners_homeowners_wbm, '60',\n\t\tv_standard_homeowners_inland_marine_wbm, '120',\n\t\tv_standard_homeowners_earthquake_wbm, '140',\n\t\tv_standard_homeowners_personal_liability_wbm, '200',\n\t\tv_select_homeowners_allied_lines_wbm, '40',\n\t\tv_select_homeowners_homeowners_wbm, '60',\n\t\tv_select_homeowners_inland_marine_wbm, '120',\n\t\tv_select_homeowners_earthquake_wbm, '140',\n\t\tv_select_homeowners_personal_liability_wbm, '200',\n\t\tv_dwelling_fire_fire_wbm, '20',\n\t\tv_dwelling_fire_allied_lines_wbm, '40',\n\t\tv_dwelling_fire_earthquake_wbm, '140',\n\t\tv_personal_inland_marine_inland_marine_wbm, '120',\n\t\tv_personal_inland_marine_personal_liability_wbm, '200',\n\t\tv_motorcycle_pp_auto_liability_wbm, '260',\n\t\tv_motorcycle_pp_auto_physical_damage_wbm, '440',\n\t\tv_boatowners_inland_marine_wbm, '120',\n\t\tv_boatowners_personal_liability_wbm, '200',\n\t\tv_alternative_one_pp_auto_liability_wbm, '260',\n\t\tv_alternative_one_pp_auto_physical_damage_wbm, '440',\n\t\tv_alternative_one_star_pp_auto_liability_wbm, '260',\n\t\tv_alternative_one_star_pp_auto_physical_damage_wbm, '440',\n\t\tv_commercial_auto_commercial_auto_liability_wbm, '340',\n\t\tv_commercial_auto_commercial_auto_liability_nsi, '340',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_wbm, '340',\n\t\tv_commercial_auto_commercial_auto_liability_garage_veh_nsi, '340',\n\t\tv_commercial_auto_comm_auto_physical_damage_wbm, '500',\n\t\tv_commercial_auto_comm_auto_physical_damage_nsi, '500',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_wbm, '500',\n\t\tv_commercial_auto_comm_auto_physical_damage_garage_veh_nsi, '500',\n\t\tv_garage_liability_commercial_auto_liability_wbm, '340',\n\t\tv_garage_liability_commercial_auto_liability_nsi, '340',\n\t\tv_garage_liability_commercial_auto_physical_damage_wbm, '500',\n\t\tv_garage_liability_commercial_auto_physical_damage_nsi, '500',\n\t\tv_workers_comp_total_non_pool_workers_comp_wbm, '160',\n\t\tv_workers_comp_total_non_pool_workers_comp_nsi, '160',\n\t\tv_workers_comp_total_non_pool_workers_comp_argent, '160',\n\t\tv_commercial_property_earthquake_wbm, '140',\n\t\tv_commercial_property_fire_wbm, '20',\n\t\tv_commercial_property_earthquake_nsi, '140',\n\t\tv_commercial_property_fire_nsi, '20',\n\t\tv_commercial_property_allied_lines_wbm, '40',\n\t\tv_commercial_property_allied_lines_nsi, '40',\n\t\tv_metalworkers_earthquake_wbm, '140',\n\t\tv_metalworkers_fire_wbm, '20',\n\t\tv_metalworkers_allied_lines_wbm, '40',\n\t\tv_metalworkers_inland_marine_wbm, '120',\n\t\tv_metalworkers_general_liability_wbm, '220',\n\t\tv_metalworkers_products_liability_wbm, '240',\n\t\tv_metalworkers_claims_made_product_liability_wbm, '250',\n\t\tv_metalworkers_fidelity_wbm, '600',\n\t\tv_metalworkers_burglary_and_theft_wbm, '640',\n\t\tv_woodworkers_earthquake_wbm, '140',\n\t\tv_woodworkers_fire_wbm, '20',\n\t\tv_woodworkers_allied_lines_wbm, '40',\n\t\tv_woodworkers_inland_marine_wbm, '120',\n\t\tv_woodworkers_general_liability_wbm, '220',\n\t\tv_woodworkers_products_liability_wbm, '240',\n\t\tv_woodworkers_claims_made_product_liability_wbm, '250',\n\t\tv_woodworkers_fidelity_wbm, '600',\n\t\tv_woodworkers_burglary_and_theft_wbm, '640',\n\t\tv_general_liability_general_liability_wbm, '220',\n\t\tv_general_liability_general_liability_nsi, '220',\n\t\tv_general_liability_products_liability_wbm, '240',\n\t\tv_smart_products_liability_wbm, '240',\n\t\tv_general_liability_products_liability_nsi, '240',\n\t\tv_general_liability_claims_made_product_liability_wbm, '250',\n\t\tv_general_liability_claims_made_product_liability_nsi, '250',\n\t\tv_general_liability_claims_made_general_liability_nsi, '230',\n\t\tv_crime_fidelity_wbm, '600',\n\t\tv_smart_fidelity_wbm, '600',\n\t\tv_crime_fidelity_nsi, '600',\n\t\tv_crime_burglary_and_theft_wbm, '640',\n\t\tv_crime_burglary_and_theft_nsi, '640',\n\t\tv_commercial_im_inland_marine_wbm, '120',\n\t\tv_commercial_im_inland_marine_nsi, '120',\n\t\tv_bop_cmp_property_wbm, '80',\n\t\tv_bop_unnamed_R13905, '80',\n\t\tv_bop_cmp_property_liability_peril_901_904_and_599_wbm, to_char(:UDF.ASL_400_PERIL_901_904_LIABILITY(loss_cause, 80)),\n\t\tv_bop_cmp_liability_wbm, '100',\n\t\tv_cbop_earthquake_wbm, '140',\n\t\tv_cbop_fire_wbm, '20',\n\t\tv_smart_earthquake_wbm, '140',\n\t\tv_smart_fire_wbm, '20',\n\t\tv_sbop_earthquake_nsi, '140',\n\t\tv_sbop_fire_nsi, '20',\n\t\tv_cbop_allied_lines_wbm, '40',\n\t\tv_smart_allied_lines_wbm, '40',\n\t\tv_sbop_allied_lines_nsi, '40',\n\t\tv_cbop_cmp_property_wbm, '80',\n\t\tv_cbop_inland_marine_wbm, '120',\n\t\tv_smart_inland_marine_wbm, '120',\n\t\tv_sbop_inland_marine_nsi, '120',\n\t\tv_cbop_general_liability_wbm, '220',\n\t\tv_smart_general_liability_wbm, '220',\n\t\tv_sbop_general_liability_nsi, '220',\n\t\tv_cbop_fidelity_wbm, '600',\n\t\tv_sbop_fidelity_nsi, '600',\n\t\tv_cbop_burglary_and_theft_wbm, '640',\n\t\tv_smart_burglary_and_theft_wbm, '640',\n\t\tv_sbop_burglary_and_theft_nsi, '640',\n\t\tv_gbop_earthquake_wbm, '140',\n\t\tv_gbop_fire_wbm, '20',\n\t\tv_gbop_allied_lines_wbm, '40',\n\t\tv_gbop_inland_marine_wbm, '120',\n\t\tv_gbop_general_liability_wbm, '220',\n\t\tv_gbop_commercial_auto_liability_wbm, '340',\n\t\tv_gbop_cmp_property_liability_peril_901_904_wbm, '80',\n\t\tv_gbop_cmp_liability_wbm, '100',\n\t\tv_gbop_comm_auto_physical_damage_wbm, '500',\n\t\tv_gbop_fidelity_wbm, '600',\n\t\tv_gbop_burglary_and_theft_wbm, '640',\n\t\tv_personal_umbrella_general_liability_wbm, '220',\n\t\tv_commercial_umbrella_general_liability_wbm, '220',\n\t\tv_commercial_umbrella_general_liability_nsi, '220',\n\t\tv_workers_comp_pool_total_workers_comp_wbm, '160',\n\t\tv_fidelity_bonds_fidelity_nsi, '600',\n\t\tv_fidelity_bonds_burgulary_and_theft_nsi, '640',\n\t\tv_surety_bonds_surety_nsi, '620',\n\t\tv_d_and_o_claims_made_general_liability_wbm, '230',\n\t\tv_epli_general_liability_claims_made_wbm, '230',\n\t\tv_epli_general_liability_claims_made_nsi, '230',\n\t\tv_epli_general_liability_claims_made_cpp_cbop_wbm, '230',\n\t\tv_smart_general_liability_claims_made_smart_wbm, '230',\n\t\tv_epli_general_liability_claims_made_cpp_sbop_nsi, '230',\n\t\tv_epli_general_liability_claims_made_bop_wbm, '230',\n\t\tv_epli_general_liability_claims_made_gbop_wbm, '230',\n\t\tv_d_and_o_claims_made_general_liability_nsi, '230',\n\t\tv_boiler_and_machinery_earthquake_wbm, '140',\n\t\tv_boiler_and_machinery_boiler_and_machinery_wbm, '660',\n\t\tv_boiler_and_machinery_earthquake_nsi, '140',\n\t\tv_boiler_and_machinery_boiler_and_machinery_nsi, '660',\n\t\tv_mine_subsidence_homeowners_wbm, '60',\n\t\tv_mine_subsidence_allied_lines_wbm, '40',\n\t\tv_mine_subsidence_allied_lines_nsi, '40',\n\t\t'999') AS coverage_code,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_mine_subsidence_homeowners_wbm,1,\r\n\t\t-- v_mine_subsidence_allied_lines_wbm,1,\r\n\t\t-- v_mine_subsidence_allied_lines_nsi,1,\r\n\t\t-- 0)\n\t\tDECODE(1,\n\t\tv_mine_subsidence_homeowners_wbm, 1,\n\t\tv_mine_subsidence_allied_lines_wbm, 1,\n\t\tv_mine_subsidence_allied_lines_nsi, 1,\n\t\t0) AS mine_sub_special_out\n\t\tFROM EXP_accept_inputs\n\t),\n\tEXP_router_step_1 AS (\n\t\tSELECT\n\t\tsymbol,\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\tunit_number,\n\t\tlocation_number,\n\t\tclass_of_business,\n\t\tsubline,\n\t\tclass_code,\n\t\trisk_unit_group,\n\t\tloss_cause,\n\t\tnsi_indicator,\n\t\tsymbol_pos_1_2_out,\n\t\tPath_Flag_Step_1,\n\t\tproduct_code,\n\t\tcoverage_code,\n\t\tmine_sub_special_out AS flag_mine_sub,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2000',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2000', 1, 0) AS flag_2000,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2020',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2020', 1, 0) AS flag_2020,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2050',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2050', 1, 0) AS flag_2050,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2070',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2070', 1, 0) AS flag_2070,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2080',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2080', 1, 0) AS flag_2080,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2100',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2100', 1, 0) AS flag_2100,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2110',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2110', 1, 0) AS flag_2110,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2130',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2130', 1, 0) AS flag_2130,\n\t\t-- *INF*: IIF(Path_Flag_Step_1='2150',1,0)\n\t\tIFF(Path_Flag_Step_1 = '2150', 1, 0) AS flag_2150\n\t\tFROM EXP_evaluate_step_1\n\t),\n\tEXP_2070 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(in(major_peril,'132','147','177','270',@{pipeline().parameters.MP_145_146},@{pipeline().parameters.MP_148_155},@{pipeline().parameters.MP_157_160},@{pipeline().parameters.MP_163_166}),1,0)\n\t\tIFF(in(major_peril, '132', '147', '177', '270', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_155}, @{pipeline().parameters.MP_157_160}, @{pipeline().parameters.MP_163_166}), 1, 0) AS v_Comp,\n\t\t-- *INF*: IIF(in(major_peril,'156','178','269',@{pipeline().parameters.MP_170_173}),1,0)\n\t\tIFF(in(major_peril, '156', '178', '269', @{pipeline().parameters.MP_170_173}), 1, 0) AS v_Coll,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_Comp,'520',\r\n\t\t-- v_Coll,'540',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_Comp, '520',\n\t\tv_Coll, '540',\n\t\t'999') AS coverage_code_2070,\n\t\t-- *INF*: '1500'\r\n\t\t-- --999 path does route to 4000, but that's an infinite loop in the source code that just writes 999 anyway.\n\t\t'1500' AS Path_Flag_Step_2_2070\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_mine_sub AS (\n\t\tSELECT\n\t\tnsi_indicator,\n\t\t'C' AS kind_code_mine_sub,\n\t\t'N' AS faculative_ind_mine_sub,\n\t\t-- *INF*: IIF(nsi_indicator='W','0008','0094')\n\t\tIFF(nsi_indicator = 'W', '0008', '0094') AS reins_co_number_mine_sub,\n\t\t'1500' AS Path_Flag_Step_2_mine_sub\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2050 AS (\n\t\tSELECT\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(type_bureau='AN' and in(major_peril,'130',@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(type_bureau = 'AN' AND in(major_peril, '130', @{pipeline().parameters.MP_930_931}), 1, 0) AS v_PIP,\n\t\t-- *INF*: IIF(type_bureau='AL' and in(major_peril,'150',@{pipeline().parameters.MP_100_125},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(type_bureau = 'AL' AND in(major_peril, '150', @{pipeline().parameters.MP_100_125}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_Other_Than_PIP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'2060',\r\n\t\t-- v_Other_Than_PIP,'2060',\r\n\t\t-- '1500')\n\t\tDECODE(1,\n\t\tv_PIP, '2060',\n\t\tv_Other_Than_PIP, '2060',\n\t\t'1500') AS Path_Flag_Step_2_2050,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'360',\r\n\t\t-- v_Other_Than_PIP,'380',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_PIP, '360',\n\t\tv_Other_Than_PIP, '380',\n\t\t'999') AS coverage_code_2050\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2020 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(in(major_peril,'168','169','174','912',@{pipeline().parameters.MP_145_149},@{pipeline().parameters.MP_151_155},@{pipeline().parameters.MP_157_163}),1,0)\n\t\tIFF(in(major_peril, '168', '169', '174', '912', @{pipeline().parameters.MP_145_149}, @{pipeline().parameters.MP_151_155}, @{pipeline().parameters.MP_157_163}), 1, 0) AS v_Comp,\n\t\t-- *INF*: IIF(in(major_peril,'156','178',@{pipeline().parameters.MP_170_173}),1,0)\n\t\tIFF(in(major_peril, '156', '178', @{pipeline().parameters.MP_170_173}), 1, 0) AS v_Coll,\n\t\t'1500' AS Path_Flag_Step_2_2020,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_Comp,'460',\r\n\t\t-- v_Coll, '480',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_Comp, '460',\n\t\tv_Coll, '480',\n\t\t'999') AS coverage_code_2020\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_Perform_2080 AS (\n\t\tSELECT\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(type_bureau='AN' and in(major_peril,'130',@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(type_bureau = 'AN' AND in(major_peril, '130', @{pipeline().parameters.MP_930_931}), 1, 0) AS v_GA_Comm_Auto_PIP,\n\t\t-- *INF*: IIF(type_bureau='AL' and in(major_peril,'599',@{pipeline().parameters.MP_100_125},@{pipeline().parameters.MP_271_274}),1,0)\n\t\tIFF(type_bureau = 'AL' AND in(major_peril, '599', @{pipeline().parameters.MP_100_125}, @{pipeline().parameters.MP_271_274}), 1, 0) AS v_GA_Comm_Auto_Other_Than_PIP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_GA_Comm_Auto_PIP,'2090',\r\n\t\t-- v_GA_Comm_Auto_Other_Than_PIP,'2090',\r\n\t\t-- '1500')\r\n\t\t-- \n\t\tDECODE(1,\n\t\tv_GA_Comm_Auto_PIP, '2090',\n\t\tv_GA_Comm_Auto_Other_Than_PIP, '2090',\n\t\t'1500') AS Path_Flag_Step_2_2080,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_GA_Comm_Auto_PIP,'360',\r\n\t\t-- v_GA_Comm_Auto_Other_Than_PIP,'380',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_GA_Comm_Auto_PIP, '360',\n\t\tv_GA_Comm_Auto_Other_Than_PIP, '380',\n\t\t'999') AS coverage_code_2080\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2130 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(in(major_peril,'132','177',@{pipeline().parameters.MP_145_155},@{pipeline().parameters.MP_157_160},@{pipeline().parameters.MP_165_166}),1,0)\n\t\tIFF(in(major_peril, '132', '177', @{pipeline().parameters.MP_145_155}, @{pipeline().parameters.MP_157_160}, @{pipeline().parameters.MP_165_166}), 1, 0) AS v_Comp,\n\t\t-- *INF*: IIF(in(major_peril,'156','178','269',@{pipeline().parameters.MP_170_173}),1,0)\n\t\tIFF(in(major_peril, '156', '178', '269', @{pipeline().parameters.MP_170_173}), 1, 0) AS v_Coll,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_Comp,'520',\r\n\t\t-- v_Coll,'540',\r\n\t\t-- '999')\r\n\t\t-- \n\t\tDECODE(1,\n\t\tv_Comp, '520',\n\t\tv_Coll, '540',\n\t\t'999') AS coverage_code_2130,\n\t\t'1500' AS Path_Flag_Step_2_2130\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2150 AS (\n\t\tSELECT\n\t\tloss_cause,\n\t\t-- *INF*: IIF(in(loss_cause,'05','75'),1,0)\n\t\tIFF(in(loss_cause, '05', '75'), 1, 0) AS v_Indemnity,\n\t\t-- *INF*: IIF(in(loss_cause,'06','07'),1,0)\n\t\tIFF(in(loss_cause, '06', '07'), 1, 0) AS v_Medical,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_Indemnity,'180',\r\n\t\t-- v_Medical,'190',\r\n\t\t-- '999')\r\n\t\t-- --this actually has no default condition in code\n\t\tDECODE(1,\n\t\tv_Indemnity, '180',\n\t\tv_Medical, '190',\n\t\t'999') AS coverage_code_2150,\n\t\t'1500' AS Path_Flag_Step_2_2150\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2000 AS (\n\t\tSELECT\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(type_bureau='RN' and major_peril='130',1,0)\n\t\tIFF(type_bureau = 'RN' AND major_peril = '130', 1, 0) AS v_PIP,\n\t\t-- *INF*: IIF(type_bureau='RL' and in(major_peril,'150',@{pipeline().parameters.MP_100_121},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(type_bureau = 'RL' AND in(major_peril, '150', @{pipeline().parameters.MP_100_121}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_Other_than_PIP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'270',\r\n\t\t-- v_Other_than_PIP,'280',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_PIP, '270',\n\t\tv_Other_than_PIP, '280',\n\t\t'999') AS coverage_code_2000,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'2010',\r\n\t\t-- v_Other_than_PIP,'2010',\r\n\t\t-- '1500')\n\t\tDECODE(1,\n\t\tv_PIP, '2010',\n\t\tv_Other_than_PIP, '2010',\n\t\t'1500') AS Path_Flag_Step_2_2000\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_2100 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(in(major_peril,'132','177','270',@{pipeline().parameters.MP_145_146},@{pipeline().parameters.MP_148_155},@{pipeline().parameters.MP_157_160},@{pipeline().parameters.MP_165_166}),1,0)\n\t\tIFF(in(major_peril, '132', '177', '270', @{pipeline().parameters.MP_145_146}, @{pipeline().parameters.MP_148_155}, @{pipeline().parameters.MP_157_160}, @{pipeline().parameters.MP_165_166}), 1, 0) AS v_Comp,\n\t\t-- *INF*: IIF(in(major_peril,'156','178','269',@{pipeline().parameters.MP_170_173}),1,0)\n\t\tIFF(in(major_peril, '156', '178', '269', @{pipeline().parameters.MP_170_173}), 1, 0) AS v_Coll,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_Comp,'520',\r\n\t\t-- v_Coll,'540',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_Comp, '520',\n\t\tv_Coll, '540',\n\t\t'999') AS coverage_code_2100,\n\t\t'1500' AS Path_Flag_Step_2_2100\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_perform_2110 AS (\n\t\tSELECT\n\t\ttype_bureau,\n\t\tmajor_peril,\n\t\t-- *INF*: IIF(type_bureau='AN' and in(major_peril,'130',@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(type_bureau = 'AN' AND in(major_peril, '130', @{pipeline().parameters.MP_930_931}), 1, 0) AS v_PIP,\n\t\t-- *INF*: IIF(type_bureau='AL' and in(major_peril,'599',@{pipeline().parameters.MP_100_125},@{pipeline().parameters.MP_271_274}),1,0)\n\t\tIFF(type_bureau = 'AL' AND in(major_peril, '599', @{pipeline().parameters.MP_100_125}, @{pipeline().parameters.MP_271_274}), 1, 0) AS v_Other_than_PIP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'2120',\r\n\t\t-- v_Other_than_PIP,'2120',\r\n\t\t-- '1500')\n\t\tDECODE(1,\n\t\tv_PIP, '2120',\n\t\tv_Other_than_PIP, '2120',\n\t\t'1500') AS Path_Flag_Step_2_2110,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_PIP,'360',\r\n\t\t-- v_Other_than_PIP,'380',\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_PIP, '360',\n\t\tv_Other_than_PIP, '380',\n\t\t'999') AS coverage_code_2110\n\t\tFROM EXP_router_step_1\n\t),\n\tEXP_union_router_Step_2 AS (\n\t\tSELECT\n\t\tEXP_router_step_1.symbol,\n\t\tEXP_router_step_1.type_bureau,\n\t\tEXP_router_step_1.major_peril,\n\t\tEXP_router_step_1.unit_number,\n\t\tEXP_router_step_1.location_number,\n\t\tEXP_router_step_1.class_of_business,\n\t\tEXP_router_step_1.subline,\n\t\tEXP_router_step_1.class_code,\n\t\tEXP_router_step_1.risk_unit_group,\n\t\tEXP_router_step_1.loss_cause,\n\t\tEXP_router_step_1.nsi_indicator,\n\t\tEXP_router_step_1.symbol_pos_1_2_out,\n\t\tEXP_router_step_1.Path_Flag_Step_1,\n\t\tEXP_router_step_1.product_code,\n\t\tEXP_router_step_1.coverage_code AS coverage_code_1,\n\t\tEXP_router_step_1.flag_2000,\n\t\tEXP_2000.coverage_code_2000,\n\t\tEXP_2000.Path_Flag_Step_2_2000,\n\t\tEXP_router_step_1.flag_2020,\n\t\tEXP_2020.Path_Flag_Step_2_2020,\n\t\tEXP_2020.coverage_code_2020,\n\t\tEXP_router_step_1.flag_2050,\n\t\tEXP_2050.Path_Flag_Step_2_2050,\n\t\tEXP_2050.coverage_code_2050,\n\t\tEXP_router_step_1.flag_2070,\n\t\tEXP_2070.coverage_code_2070,\n\t\tEXP_2070.Path_Flag_Step_2_2070,\n\t\tEXP_router_step_1.flag_2080,\n\t\tEXP_Perform_2080.Path_Flag_Step_2_2080,\n\t\tEXP_Perform_2080.coverage_code_2080,\n\t\tEXP_router_step_1.flag_2100,\n\t\tEXP_2100.coverage_code_2100,\n\t\tEXP_2100.Path_Flag_Step_2_2100,\n\t\tEXP_router_step_1.flag_2110,\n\t\tEXP_perform_2110.Path_Flag_Step_2_2110,\n\t\tEXP_perform_2110.coverage_code_2110,\n\t\tEXP_router_step_1.flag_2130,\n\t\tEXP_2130.coverage_code_2130,\n\t\tEXP_2130.Path_Flag_Step_2_2130,\n\t\tEXP_router_step_1.flag_2150,\n\t\tEXP_2150.coverage_code_2150,\n\t\tEXP_2150.Path_Flag_Step_2_2150,\n\t\tEXP_router_step_1.flag_mine_sub,\n\t\tEXP_mine_sub.kind_code_mine_sub,\n\t\tEXP_mine_sub.faculative_ind_mine_sub AS facultative_ind_mine_sub,\n\t\tEXP_mine_sub.reins_co_number_mine_sub,\n\t\tEXP_mine_sub.Path_Flag_Step_2_mine_sub,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- flag_2000,coverage_code_2000,\r\n\t\t-- flag_2020,coverage_code_2020,\r\n\t\t-- flag_2050,coverage_code_2050,\r\n\t\t-- flag_2070,coverage_code_2070,\r\n\t\t-- flag_2080,coverage_code_2080,\r\n\t\t-- flag_2100,coverage_code_2100,\r\n\t\t-- flag_2110,coverage_code_2110,\r\n\t\t-- flag_2130,coverage_code_2130,\r\n\t\t-- flag_2150,coverage_code_2150,\r\n\t\t-- 'N/A')\r\n\t\t-- \n\t\tDECODE(TRUE,\n\t\tflag_2000, coverage_code_2000,\n\t\tflag_2020, coverage_code_2020,\n\t\tflag_2050, coverage_code_2050,\n\t\tflag_2070, coverage_code_2070,\n\t\tflag_2080, coverage_code_2080,\n\t\tflag_2100, coverage_code_2100,\n\t\tflag_2110, coverage_code_2110,\n\t\tflag_2130, coverage_code_2130,\n\t\tflag_2150, coverage_code_2150,\n\t\t'N/A') AS coverage_code_step_2,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- flag_2000,Path_Flag_Step_2_2000,\r\n\t\t-- flag_2020,Path_Flag_Step_2_2020,\r\n\t\t-- flag_2050,Path_Flag_Step_2_2050,\r\n\t\t-- flag_2070,Path_Flag_Step_2_2070,\r\n\t\t-- flag_2080,Path_Flag_Step_2_2080,\r\n\t\t-- flag_2100,Path_Flag_Step_2_2100,\r\n\t\t-- flag_2110,Path_Flag_Step_2_2110,\r\n\t\t-- flag_2130,Path_Flag_Step_2_2130,\r\n\t\t-- flag_2150,Path_Flag_Step_2_2150,\r\n\t\t-- '1500')\n\t\tDECODE(TRUE,\n\t\tflag_2000, Path_Flag_Step_2_2000,\n\t\tflag_2020, Path_Flag_Step_2_2020,\n\t\tflag_2050, Path_Flag_Step_2_2050,\n\t\tflag_2070, Path_Flag_Step_2_2070,\n\t\tflag_2080, Path_Flag_Step_2_2080,\n\t\tflag_2100, Path_Flag_Step_2_2100,\n\t\tflag_2110, Path_Flag_Step_2_2110,\n\t\tflag_2130, Path_Flag_Step_2_2130,\n\t\tflag_2150, Path_Flag_Step_2_2150,\n\t\t'1500') AS Path_Flag_Step_3,\n\t\t-- *INF*: IIF(Path_Flag_Step_3='2010',1,0)\n\t\tIFF(Path_Flag_Step_3 = '2010', 1, 0) AS flag_2010,\n\t\t-- *INF*: IIF(Path_Flag_Step_3='2060',1,0)\n\t\tIFF(Path_Flag_Step_3 = '2060', 1, 0) AS flag_2060,\n\t\t-- *INF*: IIF(Path_Flag_Step_3='2090',1,0)\n\t\tIFF(Path_Flag_Step_3 = '2090', 1, 0) AS flag_2090,\n\t\t-- *INF*: IIF(Path_Flag_Step_3='2120',1,0)\n\t\tIFF(Path_Flag_Step_3 = '2120', 1, 0) AS flag_2120\n\t\tFROM EXP_2000\n\t\t -- Manually join with EXP_2020\n\t\t -- Manually join with EXP_2050\n\t\t -- Manually join with EXP_2070\n\t\t -- Manually join with EXP_2100\n\t\t -- Manually join with EXP_2130\n\t\t -- Manually join with EXP_2150\n\t\t -- Manually join with EXP_Perform_2080\n\t\t -- Manually join with EXP_mine_sub\n\t\t -- Manually join with EXP_perform_2110\n\t\t -- Manually join with EXP_router_step_1\n\t),\n\tEXP_2120 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\tloss_cause,\n\t\t-- *INF*: IIF(in(major_peril,'130',@{pipeline().parameters.MP_101_103},@{pipeline().parameters.MP_114_119},@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(in(major_peril, '130', @{pipeline().parameters.MP_101_103}, @{pipeline().parameters.MP_114_119}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_BI,\n\t\t-- *INF*: IIF(in(major_peril,@{pipeline().parameters.MP_110_112},@{pipeline().parameters.MP_120_125}),1,0)\n\t\tIFF(in(major_peril, @{pipeline().parameters.MP_110_112}, @{pipeline().parameters.MP_120_125}), 1, 0) AS v_PD,\n\t\t-- *INF*: IIF(in(major_peril,'100','599',@{pipeline().parameters.MP_271_274}),1,0)\n\t\tIFF(in(major_peril, '100', '599', @{pipeline().parameters.MP_271_274}), 1, 0) AS v_MP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_BI,'400',\r\n\t\t-- v_PD,'420',\r\n\t\t-- v_MP,to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause,400)),\r\n\t\t-- '999'\r\n\t\t-- )\n\t\tDECODE(1,\n\t\tv_BI, '400',\n\t\tv_PD, '420',\n\t\tv_MP, to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause, 400)),\n\t\t'999') AS coverage_code_2120\n\t\tFROM EXP_union_router_Step_2\n\t),\n\tEXP_2010 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\tloss_cause,\n\t\t-- *INF*: IIF(in(major_peril,'130',@{pipeline().parameters.MP_101_103},@{pipeline().parameters.MP_114_119},@{pipeline().parameters.MP_140_143}),1,0)\n\t\tIFF(in(major_peril, '130', @{pipeline().parameters.MP_101_103}, @{pipeline().parameters.MP_114_119}, @{pipeline().parameters.MP_140_143}), 1, 0) AS v_BI,\n\t\t-- *INF*: IIF(in(major_peril,@{pipeline().parameters.MP_110_112},@{pipeline().parameters.MP_120_121}),1,0)\n\t\tIFF(in(major_peril, @{pipeline().parameters.MP_110_112}, @{pipeline().parameters.MP_120_121}), 1, 0) AS v_PD,\n\t\t-- *INF*: IIF(major_peril='100',1,0)\n\t\tIFF(major_peril = '100', 1, 0) AS v_MP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_BI,'300',\r\n\t\t-- v_PD,'320',\r\n\t\t-- v_MP,to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause,300)),\r\n\t\t-- '999')\r\n\t\t-- \n\t\tDECODE(1,\n\t\tv_BI, '300',\n\t\tv_PD, '320',\n\t\tv_MP, to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause, 300)),\n\t\t'999') AS coverage_code_2010\n\t\tFROM EXP_union_router_Step_2\n\t),\n\tEXP_2060 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\tloss_cause,\n\t\t-- *INF*: IIF(in(major_peril,'130','150',@{pipeline().parameters.MP_101_103},@{pipeline().parameters.MP_114_119},@{pipeline().parameters.MP_140_143},@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(in(major_peril, '130', '150', @{pipeline().parameters.MP_101_103}, @{pipeline().parameters.MP_114_119}, @{pipeline().parameters.MP_140_143}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_BI,\n\t\t-- *INF*: IIF(in(major_peril,@{pipeline().parameters.MP_110_112},@{pipeline().parameters.MP_120_125}),1,0)\n\t\tIFF(in(major_peril, @{pipeline().parameters.MP_110_112}, @{pipeline().parameters.MP_120_125}), 1, 0) AS v_PD,\n\t\t-- *INF*: IIF(in(major_peril,'100','599'),1,0)\n\t\tIFF(in(major_peril, '100', '599'), 1, 0) AS v_MP,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_BI,'400',\r\n\t\t-- v_PD,'420',\r\n\t\t-- v_MP,to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause,400)),\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_BI, '400',\n\t\tv_PD, '420',\n\t\tv_MP, to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause, 400)),\n\t\t'999') AS coverage_code_2060\n\t\tFROM EXP_union_router_Step_2\n\t),\n\tEXP_2090 AS (\n\t\tSELECT\n\t\tmajor_peril,\n\t\tloss_cause,\n\t\t-- *INF*: IIF(in(major_peril,'130',@{pipeline().parameters.MP_101_103},@{pipeline().parameters.MP_114_119},@{pipeline().parameters.MP_930_931}),1,0)\n\t\tIFF(in(major_peril, '130', @{pipeline().parameters.MP_101_103}, @{pipeline().parameters.MP_114_119}, @{pipeline().parameters.MP_930_931}), 1, 0) AS v_GA_Comm_Auto_Bi,\n\t\t-- *INF*: IIF(in(major_peril,@{pipeline().parameters.MP_110_112},@{pipeline().parameters.MP_120_125}),1,0)\n\t\tIFF(in(major_peril, @{pipeline().parameters.MP_110_112}, @{pipeline().parameters.MP_120_125}), 1, 0) AS v_GA_Comm_Auto_Pd,\n\t\t-- *INF*: IIF(in(major_peril,'100','599',@{pipeline().parameters.MP_271_274}),1,0)\n\t\tIFF(in(major_peril, '100', '599', @{pipeline().parameters.MP_271_274}), 1, 0) AS v_GA_Comm_Auto,\n\t\t-- *INF*: DECODE(1,\r\n\t\t-- v_GA_Comm_Auto_Bi,'400',\r\n\t\t-- v_GA_Comm_Auto_Pd,'420',\r\n\t\t-- v_GA_Comm_Auto,to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause,400)),\r\n\t\t-- '999')\n\t\tDECODE(1,\n\t\tv_GA_Comm_Auto_Bi, '400',\n\t\tv_GA_Comm_Auto_Pd, '420',\n\t\tv_GA_Comm_Auto, to_char(:UDF.ASL_300_PERIL_100_PD(loss_cause, 400)),\n\t\t'999') AS coverage_code_2090\n\t\tFROM EXP_union_router_Step_2\n\t),\n\tEXP_union_output AS (\n\t\tSELECT\n\t\tEXP_union_router_Step_2.symbol,\n\t\tEXP_union_router_Step_2.type_bureau,\n\t\tEXP_union_router_Step_2.major_peril,\n\t\tEXP_union_router_Step_2.unit_number,\n\t\tEXP_union_router_Step_2.location_number,\n\t\tEXP_union_router_Step_2.class_of_business,\n\t\tEXP_union_router_Step_2.subline,\n\t\tEXP_union_router_Step_2.class_code,\n\t\tEXP_union_router_Step_2.risk_unit_group,\n\t\tEXP_union_router_Step_2.loss_cause,\n\t\tEXP_union_router_Step_2.nsi_indicator,\n\t\tEXP_union_router_Step_2.symbol_pos_1_2_out,\n\t\tEXP_union_router_Step_2.Path_Flag_Step_1,\n\t\tEXP_union_router_Step_2.product_code,\n\t\tEXP_union_router_Step_2.coverage_code_1,\n\t\tEXP_union_router_Step_2.flag_mine_sub,\n\t\tEXP_union_router_Step_2.kind_code_mine_sub,\n\t\tEXP_union_router_Step_2.facultative_ind_mine_sub,\n\t\tEXP_union_router_Step_2.reins_co_number_mine_sub,\n\t\tEXP_union_router_Step_2.Path_Flag_Step_2_mine_sub,\n\t\tEXP_union_router_Step_2.coverage_code_step_2,\n\t\tEXP_union_router_Step_2.flag_2010,\n\t\tEXP_2010.coverage_code_2010,\n\t\tEXP_union_router_Step_2.flag_2060,\n\t\tEXP_2060.coverage_code_2060,\n\t\tEXP_union_router_Step_2.flag_2090,\n\t\tEXP_2090.coverage_code_2090,\n\t\tEXP_union_router_Step_2.flag_2120,\n\t\tEXP_2120.coverage_code_2120,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- flag_2010,coverage_code_2010,\r\n\t\t-- flag_2060,coverage_code_2060,\r\n\t\t-- flag_2090,coverage_code_2090,\r\n\t\t-- flag_2120,coverage_code_2120,\r\n\t\t-- 'N/A')\n\t\tDECODE(TRUE,\n\t\tflag_2010, coverage_code_2010,\n\t\tflag_2060, coverage_code_2060,\n\t\tflag_2090, coverage_code_2090,\n\t\tflag_2120, coverage_code_2120,\n\t\t'N/A') AS coverage_code_3\n\t\tFROM EXP_2010\n\t\t -- Manually join with EXP_2060\n\t\t -- Manually join with EXP_2090\n\t\t -- Manually join with EXP_2120\n\t\t -- Manually join with EXP_union_router_Step_2\n\t),\n\tEXP_output AS (\n\t\tSELECT\n\t\tproduct_code,\n\t\tcoverage_code_1,\n\t\tkind_code_mine_sub,\n\t\tfacultative_ind_mine_sub,\n\t\treins_co_number_mine_sub,\n\t\tcoverage_code_step_2,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- coverage_code_1 = '40','421',\r\n\t\t-- coverage_code_step_2)\r\n\t\t-- \r\n\t\t-- ---- SubASLCode of 421 applies to Allied lines PMS data.\n\t\tDECODE(TRUE,\n\t\tcoverage_code_1 = '40', '421',\n\t\tcoverage_code_step_2) AS O_coverage_code_step_2,\n\t\tcoverage_code_3,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- coverage_code_1 = '40','421',\r\n\t\t-- coverage_code_3)\n\t\tDECODE(TRUE,\n\t\tcoverage_code_1 = '40', '421',\n\t\tcoverage_code_3) AS O_coverage_code_3\n\t\tFROM EXP_union_output\n\t),\n\tOutput AS (\n\t\tSELECT\n\t\tproduct_code, \n\t\tcoverage_code_1, \n\t\tO_coverage_code_step_2 AS coverage_code_2, \n\t\tO_coverage_code_3 AS coverage_code_3, \n\t\tkind_code_mine_sub, \n\t\tfacultative_ind_mine_sub, \n\t\treins_co_number_mine_sub\n\t\tFROM EXP_output\n\t),\n),\nEXP_ASL_mapplet_output AS (\n\tSELECT\n\tproduct_code,\n\tcoverage_code_1,\n\tcoverage_code_2,\n\tcoverage_code_3,\n\tkind_code_mine_sub,\n\tfacultative_ind_mine_sub,\n\treins_co_number_mine_sub\n\tFROM mplt_ASL_WBC8827B_Product_Coverage_Codes\n),\nLKP_asl_dim AS (\n\tSELECT\n\tasl_dim_id,\n\tasl_code,\n\tsub_asl_code,\n\tsub_non_asl_code\n\tFROM (\n\t\tSELECT \r\n\t\tasl_dim.asl_code as asl_code, \r\n\t\tasl_dim.asl_dim_id as asl_dim_id, \r\n\t\tasl_dim.sub_asl_code as sub_asl_code, \r\n\t\tasl_dim.sub_non_asl_code as sub_non_asl_code \r\n\t\tFROM asl_dim\r\n\t\twhere \r\n\t\tasl_dim.crrnt_snpsht_flag ='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY asl_code,sub_asl_code,sub_non_asl_code ORDER BY asl_dim_id DESC) = 1\n),\nLKP_asl_product_code_dim AS (\n\tSELECT\n\tasl_prdct_code_dim_id,\n\tasl_prdct_code\n\tFROM (\n\t\tSELECT \r\n\t\tasl_product_code_dim.asl_prdct_code_dim_id as asl_prdct_code_dim_id, \r\n\t\tasl_product_code_dim.asl_prdct_code as asl_prdct_code \r\n\t\tFROM \r\n\t\tasl_product_code_dim\r\n\t\tWHERE\r\n\t\tcrrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY asl_prdct_code ORDER BY asl_prdct_code_dim_id DESC) = 1\n),\nEXP_ASL_lookup_output AS (\n\tSELECT\n\tEXP_prepare_ASL_input.claim_loss_transaction_fact_id AS claim_loss_trans_fact_id,\n\tLKP_asl_dim.asl_dim_id,\n\tLKP_asl_product_code_dim.asl_prdct_code_dim_id,\n\tEXP_prepare_ASL_input.loss_master_dim_id,\n\t-- *INF*: IIF(isnull(asl_dim_id),-1,asl_dim_id)\n\tIFF(asl_dim_id IS NULL, - 1, asl_dim_id) AS asl_dim_id_out,\n\t-- *INF*: IIF(isnull(asl_prdct_code_dim_id),-1,asl_prdct_code_dim_id)\n\tIFF(asl_prdct_code_dim_id IS NULL, - 1, asl_prdct_code_dim_id) AS asl_prdct_code_dim_id_out,\n\t-- *INF*: IIF(isnull(loss_master_dim_id),-1,loss_master_dim_id)\n\tIFF(loss_master_dim_id IS NULL, - 1, loss_master_dim_id) AS loss_master_dim_id_out,\n\tEXP_ASL_mapplet_output.kind_code_mine_sub,\n\tEXP_ASL_mapplet_output.facultative_ind_mine_sub,\n\tEXP_ASL_mapplet_output.reins_co_number_mine_sub,\n\tEXP_asl_mapplet_bridge.major_peril,\n\tEXP_prepare_ASL_input.financial_type_code,\n\tEXP_prepare_ASL_input.trans_code,\n\tEXP_prepare_ASL_input.trans_date,\n\tEXP_prepare_ASL_input.trans_ctgry_code,\n\tEXP_prepare_ASL_input.trans_amt,\n\tEXP_prepare_ASL_input.trans_hist_amt,\n\tEXP_prepare_ASL_input.source_sys_id,\n\tEXP_prepare_ASL_input.claimant_cov_det_ak_id,\n\tEXP_prepare_ASL_input.prdct_code_dim_id,\n\tEXP_prepare_ASL_input.claim_loss_fact_trans_type_dim_id,\n\tEXP_prepare_ASL_input.InsuranceReferenceDimId,\n\tEXP_prepare_ASL_input.AgencyDimId,\n\tEXP_prepare_ASL_input.SalesDivisionDimId,\n\tEXP_prepare_ASL_input.InsuranceReferenceCoverageDimId,\n\tEXP_prepare_ASL_input.CoverageDetailDimId,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_ASL_mapplet_output\n\t -- Manually join with EXP_asl_mapplet_bridge\n\t -- Manually join with EXP_prepare_ASL_input\n\tLEFT JOIN LKP_asl_dim\n\tON LKP_asl_dim.asl_code = EXP_ASL_mapplet_output.coverage_code_1 AND LKP_asl_dim.sub_asl_code = EXP_ASL_mapplet_output.coverage_code_2 AND LKP_asl_dim.sub_non_asl_code = EXP_ASL_mapplet_output.coverage_code_3\n\tLEFT JOIN LKP_asl_product_code_dim\n\tON LKP_asl_product_code_dim.asl_prdct_code = EXP_ASL_mapplet_output.product_code\n),\nRTR_divert_MP50 AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\tasl_dim_id_out,\n\tasl_prdct_code_dim_id_out,\n\tloss_master_dim_id_out,\n\tkind_code_mine_sub,\n\tfacultative_ind_mine_sub,\n\treins_co_number_mine_sub,\n\tmajor_peril AS major_peril1,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tsource_sys_id,\n\tclaimant_cov_det_ak_id,\n\tprdct_code_dim_id,\n\tclaim_loss_fact_trans_type_dim_id,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId,\n\tModifiedDate\n\tFROM EXP_ASL_lookup_output\n),\nRTR_divert_MP50_Update AS (SELECT * FROM RTR_divert_MP50 WHERE TRUE),\nRTR_divert_MP50_MP50 AS (SELECT * FROM RTR_divert_MP50 WHERE major_peril1='050'),\nEXP_mp50_input AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\tasl_dim_id_out AS asl_dim_id_IN,\n\tasl_prdct_code_dim_id_out AS asl_prdct_code_dim_id_IN,\n\tloss_master_dim_id_out AS loss_master_dim_id_IN,\n\tkind_code_mine_sub AS kind_code_mine_sub_IN,\n\tfacultative_ind_mine_sub AS facultative_ind_mine_sub_IN,\n\treins_co_number_mine_sub AS reins_co_number_mine_sub_IN,\n\tmajor_peril1 AS major_peril_IN,\n\tfinancial_type_code AS financial_type_code_IN,\n\ttrans_code AS trans_code_IN,\n\ttrans_date AS trans_date_IN,\n\ttrans_ctgry_code AS trans_ctgry_code_IN,\n\ttrans_amt AS trans_amt_IN,\n\ttrans_hist_amt AS trans_hist_amt_IN,\n\tsource_sys_id AS source_sys_id_IN,\n\tclaimant_cov_det_ak_id AS claimant_cov_det_ak_id_IN,\n\tprdct_code_dim_id AS prdct_code_dim_id_IN,\n\tclaim_loss_fact_trans_type_dim_id AS claim_loss_fact_trans_type_dim_id_IN,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId\n\tFROM RTR_divert_MP50_MP50\n),\nLKP_claim_loss_transaction_fact AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\terr_flag,\n\taudit_id,\n\tedw_claim_trans_pk_id,\n\tedw_claim_reins_trans_pk_id,\n\tclaim_occurrence_dim_id,\n\tclaim_occurrence_dim_hist_id,\n\tclaimant_dim_id,\n\tclaimant_dim_hist_id,\n\tclaimant_cov_dim_id,\n\tclaimant_cov_dim_hist_id,\n\tcov_dim_id,\n\tcov_dim_hist_id,\n\tclaim_trans_type_dim_id,\n\tclaim_financial_type_dim_id,\n\treins_cov_dim_id,\n\treins_cov_dim_hist_id,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_dim_prim_claim_rep_hist_id,\n\tclaim_rep_dim_examiner_id,\n\tclaim_rep_dim_examiner_hist_id,\n\tclaim_rep_dim_prim_litigation_handler_id,\n\tclaim_rep_dim_prim_litigation_handler_hist_id,\n\tclaim_rep_dim_trans_entry_oper_id,\n\tclaim_rep_dim_trans_entry_oper_hist_id,\n\tclaim_rep_dim_claim_created_by_id,\n\tpol_dim_id,\n\tpol_dim_hist_id,\n\tagency_dim_id,\n\tagency_dim_hist_id,\n\tclaim_pay_dim_id,\n\tclaim_pay_dim_hist_id,\n\tclaim_pay_ctgry_type_dim_id,\n\tclaim_pay_ctgry_type_dim_hist_id,\n\tclaim_case_dim_id,\n\tclaim_case_dim_hist_id,\n\tcontract_cust_dim_id,\n\tcontract_cust_dim_hist_id,\n\tclaim_master_1099_list_dim_id,\n\tclaim_subrogation_dim_id,\n\tclaim_trans_date_id,\n\tclaim_trans_reprocess_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tclaim_subrogation_referred_to_subrogation_date_id,\n\tclaim_subrogation_pay_start_date_id,\n\tclaim_subrogation_closure_date_id,\n\tacct_entered_date_id,\n\ttrans_amt,\n\ttrans_hist_amt,\n\ttax_id,\n\tdirect_loss_paid_excluding_recoveries,\n\tdirect_loss_outstanding_excluding_recoveries,\n\tdirect_loss_incurred_excluding_recoveries,\n\tdirect_alae_paid_excluding_recoveries,\n\tdirect_alae_outstanding_excluding_recoveries,\n\tdirect_alae_incurred_excluding_recoveries,\n\tdirect_loss_paid_including_recoveries,\n\tdirect_loss_outstanding_including_recoveries,\n\tdirect_loss_incurred_including_recoveries,\n\tdirect_alae_paid_including_recoveries,\n\tdirect_alae_outstanding_including_recoveries,\n\tdirect_alae_incurred_including_recoveries,\n\tdirect_subrogation_paid,\n\tdirect_subrogation_outstanding,\n\tdirect_subrogation_incurred,\n\tdirect_salvage_paid,\n\tdirect_salvage_outstanding,\n\tdirect_salvage_incurred,\n\tdirect_other_recovery_loss_paid,\n\tdirect_other_recovery_loss_outstanding,\n\tdirect_other_recovery_loss_incurred,\n\tdirect_other_recovery_alae_paid,\n\tdirect_other_recovery_alae_outstanding,\n\tdirect_other_recovery_alae_incurred,\n\ttotal_direct_loss_recovery_paid,\n\ttotal_direct_loss_recovery_outstanding,\n\ttotal_direct_loss_recovery_incurred,\n\tdirect_other_recovery_paid,\n\tdirect_other_recovery_outstanding,\n\tdirect_other_recovery_incurred,\n\tceded_loss_paid,\n\tceded_loss_outstanding,\n\tceded_loss_incurred,\n\tceded_alae_paid,\n\tceded_alae_outstanding,\n\tceded_alae_incurred,\n\tceded_salvage_paid,\n\tceded_subrogation_paid,\n\tceded_other_recovery_loss_paid,\n\tceded_other_recovery_alae_paid,\n\ttotal_ceded_loss_recovery_paid,\n\tnet_loss_paid,\n\tnet_loss_outstanding,\n\tnet_loss_incurred,\n\tnet_alae_paid,\n\tnet_alae_outstanding,\n\tnet_alae_incurred,\n\tasl_dim_id,\n\tasl_prdct_code_dim_id,\n\tloss_master_dim_id,\n\tstrtgc_bus_dvsn_dim_id,\n\tprdct_code_dim_id,\n\tClaimReserveDimId,\n\tClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tFeatureRepresentativeAssignedDateId\n\tFROM (\n\t\tSELECT CLTF.err_flag                                          AS err_flag,\r\n\t\t       CLTF.audit_id                                          AS audit_id,\r\n\t\t       CLTF.edw_claim_trans_pk_id                             AS edw_claim_trans_pk_id,\r\n\t\t       CLTF.edw_claim_reins_trans_pk_id                       AS edw_claim_reins_trans_pk_id,\r\n\t\t       CLTF.claim_occurrence_dim_id                           AS claim_occurrence_dim_id,\r\n\t\t       CLTF.claim_occurrence_dim_hist_id                      AS claim_occurrence_dim_hist_id,\r\n\t\t       CLTF.claimant_dim_id                                   AS claimant_dim_id,\r\n\t\t       CLTF.claimant_dim_hist_id                              AS claimant_dim_hist_id,\r\n\t\t       CLTF.claimant_cov_dim_id                               AS claimant_cov_dim_id,\r\n\t\t       CLTF.claimant_cov_dim_hist_id                          AS claimant_cov_dim_hist_id,\r\n\t\t       CLTF.cov_dim_id                                        AS cov_dim_id,\r\n\t\t       CLTF.cov_dim_hist_id                                   AS cov_dim_hist_id,\r\n\t\t       CLTF.claim_financial_type_dim_id                       AS claim_financial_type_dim_id,\r\n\t\t       CLTF.reins_cov_dim_id                                  AS reins_cov_dim_id,\r\n\t\t       CLTF.reins_cov_dim_hist_id                             AS reins_cov_dim_hist_id,\r\n\t\t       CLTF.claim_rep_dim_prim_claim_rep_id                   AS claim_rep_dim_prim_claim_rep_id,\r\n\t\t       CLTF.claim_rep_dim_prim_claim_rep_hist_id              AS claim_rep_dim_prim_claim_rep_hist_id,\r\n\t\t       CLTF.claim_rep_dim_examiner_id                         AS claim_rep_dim_examiner_id,\r\n\t\t       CLTF.claim_rep_dim_examiner_hist_id                    AS claim_rep_dim_examiner_hist_id,\r\n\t\t       CLTF.claim_rep_dim_prim_litigation_handler_id          AS claim_rep_dim_prim_litigation_handler_id,\r\n\t\t       CLTF.claim_rep_dim_prim_litigation_handler_hist_id     AS claim_rep_dim_prim_litigation_handler_hist_id,\r\n\t\t       CLTF.claim_rep_dim_trans_entry_oper_id                 AS claim_rep_dim_trans_entry_oper_id,\r\n\t\t       CLTF.claim_rep_dim_trans_entry_oper_hist_id            AS claim_rep_dim_trans_entry_oper_hist_id,\r\n\t\t       CLTF.claim_rep_dim_claim_created_by_id                 AS claim_rep_dim_claim_created_by_id,\r\n\t\t       CLTF.pol_dim_id                                        AS pol_dim_id,\r\n\t\t       CLTF.pol_dim_hist_id                                   AS pol_dim_hist_id,\r\n\t\t       CLTF.agency_dim_id                                     AS agency_dim_id,\r\n\t\t       CLTF.agency_dim_hist_id                                AS agency_dim_hist_id,\r\n\t\t       CLTF.claim_pay_dim_id                                  AS claim_pay_dim_id,\r\n\t\t       CLTF.claim_pay_dim_hist_id                             AS claim_pay_dim_hist_id,\r\n\t\t       CLTF.claim_pay_ctgry_type_dim_id                       AS claim_pay_ctgry_type_dim_id,\r\n\t\t       CLTF.claim_pay_ctgry_type_dim_hist_id                  AS claim_pay_ctgry_type_dim_hist_id,\r\n\t\t       CLTF.claim_case_dim_id                                 AS claim_case_dim_id,\r\n\t\t       CLTF.claim_case_dim_hist_id                            AS claim_case_dim_hist_id,\r\n\t\t       CLTF.contract_cust_dim_id                              AS contract_cust_dim_id,\r\n\t\t       CLTF.contract_cust_dim_hist_id                         AS contract_cust_dim_hist_id,\r\n\t\t       CLTF.claim_master_1099_list_dim_id                     AS claim_master_1099_list_dim_id,\r\n\t\t       CLTF.claim_subrogation_dim_id                          AS claim_subrogation_dim_id,\r\n\t\t       CLTF.claim_trans_date_id                               AS claim_trans_date_id,\r\n\t\t       CLTF.claim_trans_reprocess_date_id                     AS claim_trans_reprocess_date_id,\r\n\t\t       CLTF.claim_loss_date_id                                AS claim_loss_date_id,\r\n\t\t       CLTF.claim_discovery_date_id                           AS claim_discovery_date_id,\r\n\t\t       CLTF.claim_scripted_date_id                            AS claim_scripted_date_id,\r\n\t\t       CLTF.source_claim_rpted_date_id                        AS source_claim_rpted_date_id,\r\n\t\t       CLTF.claim_rpted_date_id                               AS claim_rpted_date_id,\r\n\t\t       CLTF.claim_open_date_id                                AS claim_open_date_id,\r\n\t\t       CLTF.claim_close_date_id                               AS claim_close_date_id,\r\n\t\t       CLTF.claim_reopen_date_id                              AS claim_reopen_date_id,\r\n\t\t       CLTF.claim_closed_after_reopen_date_id                 AS claim_closed_after_reopen_date_id,\r\n\t\t       CLTF.claim_notice_only_date_id                         AS claim_notice_only_date_id,\r\n\t\t       CLTF.claim_cat_start_date_id                           AS claim_cat_start_date_id,\r\n\t\t       CLTF.claim_cat_end_date_id                             AS claim_cat_end_date_id,\r\n\t\t       CLTF.claim_rep_assigned_date_id                        AS claim_rep_assigned_date_id,\r\n\t\t       CLTF.claim_rep_unassigned_date_id                      AS claim_rep_unassigned_date_id,\r\n\t\t       CLTF.pol_eff_date_id                                   AS pol_eff_date_id,\r\n\t\t       CLTF.pol_exp_date_id                                   AS pol_exp_date_id,\r\n\t\t       CLTF.claim_subrogation_referred_to_subrogation_date_id AS claim_subrogation_referred_to_subrogation_date_id,\r\n\t\t       CLTF.claim_subrogation_pay_start_date_id               AS claim_subrogation_pay_start_date_id,\r\n\t\t       CLTF.claim_subrogation_closure_date_id                 AS claim_subrogation_closure_date_id,\r\n\t\t       CLTF.acct_entered_date_id                              AS acct_entered_date_id,\r\n\t\t       CLTF.trans_amt                                         AS trans_amt,\r\n\t\t       CLTF.trans_hist_amt                                    AS trans_hist_amt,\r\n\t\t       CLTF.tax_id                                            AS tax_id,\r\n\t\t       CLTF.direct_loss_paid_excluding_recoveries             AS direct_loss_paid_excluding_recoveries,\r\n\t\t       CLTF.direct_loss_outstanding_excluding_recoveries      AS direct_loss_outstanding_excluding_recoveries,\r\n\t\t       CLTF.direct_loss_incurred_excluding_recoveries         AS direct_loss_incurred_excluding_recoveries,\r\n\t\t       CLTF.direct_alae_paid_excluding_recoveries             AS direct_alae_paid_excluding_recoveries,\r\n\t\t       CLTF.direct_alae_outstanding_excluding_recoveries      AS direct_alae_outstanding_excluding_recoveries,\r\n\t\t       CLTF.direct_alae_incurred_excluding_recoveries         AS direct_alae_incurred_excluding_recoveries,\r\n\t\t       CLTF.direct_loss_paid_including_recoveries             AS direct_loss_paid_including_recoveries,\r\n\t\t       CLTF.direct_loss_outstanding_including_recoveries      AS direct_loss_outstanding_including_recoveries,\r\n\t\t       CLTF.direct_loss_incurred_including_recoveries         AS direct_loss_incurred_including_recoveries,\r\n\t\t       CLTF.direct_alae_paid_including_recoveries             AS direct_alae_paid_including_recoveries,\r\n\t\t       CLTF.direct_alae_outstanding_including_recoveries      AS direct_alae_outstanding_including_recoveries,\r\n\t\t       CLTF.direct_alae_incurred_including_recoveries         AS direct_alae_incurred_including_recoveries,\r\n\t\t       CLTF.direct_subrogation_paid                           AS direct_subrogation_paid,\r\n\t\t       CLTF.direct_subrogation_outstanding                    AS direct_subrogation_outstanding,\r\n\t\t       CLTF.direct_subrogation_incurred                       AS direct_subrogation_incurred,\r\n\t\t       CLTF.direct_salvage_paid                               AS direct_salvage_paid,\r\n\t\t       CLTF.direct_salvage_outstanding                        AS direct_salvage_outstanding,\r\n\t\t       CLTF.direct_salvage_incurred                           AS direct_salvage_incurred,\r\n\t\t       CLTF.direct_other_recovery_loss_paid                   AS direct_other_recovery_loss_paid,\r\n\t\t       CLTF.direct_other_recovery_loss_outstanding            AS direct_other_recovery_loss_outstanding,\r\n\t\t       CLTF.direct_other_recovery_loss_incurred               AS direct_other_recovery_loss_incurred,\r\n\t\t       CLTF.direct_other_recovery_alae_paid                   AS direct_other_recovery_alae_paid,\r\n\t\t       CLTF.direct_other_recovery_alae_outstanding            AS direct_other_recovery_alae_outstanding,\r\n\t\t       CLTF.direct_other_recovery_alae_incurred               AS direct_other_recovery_alae_incurred,\r\n\t\t       CLTF.total_direct_loss_recovery_paid                   AS total_direct_loss_recovery_paid,\r\n\t\t       CLTF.total_direct_loss_recovery_outstanding            AS total_direct_loss_recovery_outstanding,\r\n\t\t       CLTF.total_direct_loss_recovery_incurred               AS total_direct_loss_recovery_incurred,\r\n\t\t       CLTF.direct_other_recovery_paid                        AS direct_other_recovery_paid,\r\n\t\t       CLTF.direct_other_recovery_outstanding                 AS direct_other_recovery_outstanding,\r\n\t\t       CLTF.direct_other_recovery_incurred                    AS direct_other_recovery_incurred,\r\n\t\t       CLTF.ceded_loss_paid                                   AS ceded_loss_paid,\r\n\t\t       CLTF.ceded_loss_outstanding                            AS ceded_loss_outstanding,\r\n\t\t       CLTF.ceded_loss_incurred                               AS ceded_loss_incurred,\r\n\t\t       CLTF.ceded_alae_paid                                   AS ceded_alae_paid,\r\n\t\t       CLTF.ceded_alae_outstanding                            AS ceded_alae_outstanding,\r\n\t\t       CLTF.ceded_alae_incurred                               AS ceded_alae_incurred,\r\n\t\t       CLTF.ceded_salvage_paid                                AS ceded_salvage_paid,\r\n\t\t       CLTF.ceded_subrogation_paid                            AS ceded_subrogation_paid,\r\n\t\t       CLTF.ceded_other_recovery_loss_paid                    AS ceded_other_recovery_loss_paid,\r\n\t\t       CLTF.ceded_other_recovery_alae_paid                    AS ceded_other_recovery_alae_paid,\r\n\t\t       CLTF.total_ceded_loss_recovery_paid                    AS total_ceded_loss_recovery_paid,\r\n\t\t       CLTF.net_loss_paid                                     AS net_loss_paid,\r\n\t\t       CLTF.net_loss_outstanding                              AS net_loss_outstanding,\r\n\t\t       CLTF.net_loss_incurred                                 AS net_loss_incurred,\r\n\t\t       CLTF.net_alae_paid                                     AS net_alae_paid,\r\n\t\t       CLTF.net_alae_outstanding                              AS net_alae_outstanding,\r\n\t\t       CLTF.net_alae_incurred                                 AS net_alae_incurred,\r\n\t\t       CLTF.asl_dim_id                                        AS asl_dim_id,\r\n\t\t       CLTF.asl_prdct_code_dim_id                             AS asl_prdct_code_dim_id,\r\n\t\t       CLTF.loss_master_dim_id                                AS loss_master_dim_id,\r\n\t\t       CLTF.strtgc_bus_dvsn_dim_id                            AS strtgc_bus_dvsn_dim_id,\r\n\t\t       CLTF.prdct_code_dim_id                                 AS prdct_code_dim_id,\r\n\t\t       CLTF.ClaimReserveDimId                                 AS ClaimReserveDimId,\r\n\t\t\tCLTF.ClaimRepresentativeDimFeatureClaimRepresentativeId AS ClaimRepresentativeDimFeatureClaimRepresentativeId,\r\n\t\t\tCLTF.FeatureRepresentativeAssignedDateId AS FeatureRepresentativeAssignedDateId,\r\n\t\t       CLTF.claim_loss_trans_fact_id                          AS claim_loss_trans_fact_id,\r\n\t\t       CLTF.claim_trans_type_dim_id                           AS claim_trans_type_dim_id\r\n\t\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF , \r\n\t\t@{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.VW_claim_transaction CT , \r\n\t\t@{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tWHERE CLTF.edw_claim_trans_pk_id = CT.claim_trans_id\r\n\t\tAND CT.claimant_cov_det_ak_id = CCD.claimant_cov_det_ak_id\r\n\t\tAND CCD.major_peril_code = '050' AND CLTF.audit_id >0\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_loss_trans_fact_id ORDER BY claim_loss_trans_fact_id DESC) = 1\n),\nEXP_claim_loss_transaction_fact_lookup_output AS (\n\tSELECT\n\tLKP_claim_loss_transaction_fact.claim_loss_trans_fact_id,\n\tLKP_claim_loss_transaction_fact.err_flag,\n\tLKP_claim_loss_transaction_fact.audit_id,\n\tLKP_claim_loss_transaction_fact.edw_claim_trans_pk_id,\n\tLKP_claim_loss_transaction_fact.edw_claim_reins_trans_pk_id,\n\tLKP_claim_loss_transaction_fact.claim_occurrence_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_occurrence_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claimant_dim_id,\n\tLKP_claim_loss_transaction_fact.claimant_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claimant_cov_dim_id,\n\tLKP_claim_loss_transaction_fact.claimant_cov_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.cov_dim_id,\n\tLKP_claim_loss_transaction_fact.cov_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_trans_type_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_financial_type_dim_id,\n\tLKP_claim_loss_transaction_fact.reins_cov_dim_id,\n\tLKP_claim_loss_transaction_fact.reins_cov_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_prim_claim_rep_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_prim_claim_rep_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_examiner_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_examiner_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_prim_litigation_handler_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_prim_litigation_handler_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_trans_entry_oper_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_trans_entry_oper_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_dim_claim_created_by_id,\n\tLKP_claim_loss_transaction_fact.pol_dim_id,\n\tLKP_claim_loss_transaction_fact.pol_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.agency_dim_id,\n\tLKP_claim_loss_transaction_fact.agency_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_pay_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_pay_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_pay_ctgry_type_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_pay_ctgry_type_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_case_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_case_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.contract_cust_dim_id,\n\tLKP_claim_loss_transaction_fact.contract_cust_dim_hist_id,\n\tLKP_claim_loss_transaction_fact.claim_master_1099_list_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_subrogation_dim_id,\n\tLKP_claim_loss_transaction_fact.claim_trans_date_id,\n\tLKP_claim_loss_transaction_fact.claim_trans_reprocess_date_id,\n\tLKP_claim_loss_transaction_fact.claim_loss_date_id,\n\tLKP_claim_loss_transaction_fact.claim_discovery_date_id,\n\tLKP_claim_loss_transaction_fact.claim_scripted_date_id,\n\tLKP_claim_loss_transaction_fact.source_claim_rpted_date_id,\n\tLKP_claim_loss_transaction_fact.claim_rpted_date_id,\n\tLKP_claim_loss_transaction_fact.claim_open_date_id,\n\tLKP_claim_loss_transaction_fact.claim_close_date_id,\n\tLKP_claim_loss_transaction_fact.claim_reopen_date_id,\n\tLKP_claim_loss_transaction_fact.claim_closed_after_reopen_date_id,\n\tLKP_claim_loss_transaction_fact.claim_notice_only_date_id,\n\tLKP_claim_loss_transaction_fact.claim_cat_start_date_id,\n\tLKP_claim_loss_transaction_fact.claim_cat_end_date_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_assigned_date_id,\n\tLKP_claim_loss_transaction_fact.claim_rep_unassigned_date_id,\n\tLKP_claim_loss_transaction_fact.pol_eff_date_id,\n\tLKP_claim_loss_transaction_fact.pol_exp_date_id,\n\tLKP_claim_loss_transaction_fact.claim_subrogation_referred_to_subrogation_date_id,\n\tLKP_claim_loss_transaction_fact.claim_subrogation_pay_start_date_id,\n\tLKP_claim_loss_transaction_fact.claim_subrogation_closure_date_id,\n\tLKP_claim_loss_transaction_fact.acct_entered_date_id,\n\tLKP_claim_loss_transaction_fact.trans_amt,\n\tLKP_claim_loss_transaction_fact.trans_hist_amt,\n\tLKP_claim_loss_transaction_fact.tax_id,\n\tLKP_claim_loss_transaction_fact.direct_loss_paid_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_loss_outstanding_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_loss_incurred_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_paid_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_outstanding_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_incurred_excluding_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_loss_paid_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_loss_outstanding_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_loss_incurred_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_paid_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_outstanding_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_alae_incurred_including_recoveries,\n\tLKP_claim_loss_transaction_fact.direct_subrogation_paid,\n\tLKP_claim_loss_transaction_fact.direct_subrogation_outstanding,\n\tLKP_claim_loss_transaction_fact.direct_subrogation_incurred,\n\tLKP_claim_loss_transaction_fact.direct_salvage_paid,\n\tLKP_claim_loss_transaction_fact.direct_salvage_outstanding,\n\tLKP_claim_loss_transaction_fact.direct_salvage_incurred,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_loss_paid,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_loss_outstanding,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_loss_incurred,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_alae_paid,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_alae_outstanding,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_alae_incurred,\n\tLKP_claim_loss_transaction_fact.total_direct_loss_recovery_paid,\n\tLKP_claim_loss_transaction_fact.total_direct_loss_recovery_outstanding,\n\tLKP_claim_loss_transaction_fact.total_direct_loss_recovery_incurred,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_paid,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_outstanding,\n\tLKP_claim_loss_transaction_fact.direct_other_recovery_incurred,\n\tLKP_claim_loss_transaction_fact.ceded_loss_paid,\n\tLKP_claim_loss_transaction_fact.ceded_loss_outstanding,\n\tLKP_claim_loss_transaction_fact.ceded_loss_incurred,\n\tLKP_claim_loss_transaction_fact.ceded_alae_paid,\n\tLKP_claim_loss_transaction_fact.ceded_alae_outstanding,\n\tLKP_claim_loss_transaction_fact.ceded_alae_incurred,\n\tLKP_claim_loss_transaction_fact.ceded_salvage_paid,\n\tLKP_claim_loss_transaction_fact.ceded_subrogation_paid,\n\tLKP_claim_loss_transaction_fact.ceded_other_recovery_loss_paid,\n\tLKP_claim_loss_transaction_fact.ceded_other_recovery_alae_paid,\n\tLKP_claim_loss_transaction_fact.total_ceded_loss_recovery_paid,\n\tLKP_claim_loss_transaction_fact.net_loss_paid,\n\tLKP_claim_loss_transaction_fact.net_loss_outstanding,\n\tLKP_claim_loss_transaction_fact.net_loss_incurred,\n\tLKP_claim_loss_transaction_fact.net_alae_paid,\n\tLKP_claim_loss_transaction_fact.net_alae_outstanding,\n\tLKP_claim_loss_transaction_fact.net_alae_incurred,\n\tLKP_claim_loss_transaction_fact.asl_dim_id,\n\tLKP_claim_loss_transaction_fact.asl_prdct_code_dim_id,\n\tLKP_claim_loss_transaction_fact.loss_master_dim_id,\n\tLKP_claim_loss_transaction_fact.strtgc_bus_dvsn_dim_id,\n\tLKP_claim_loss_transaction_fact.prdct_code_dim_id,\n\tEXP_mp50_input.asl_dim_id_IN,\n\tEXP_mp50_input.asl_prdct_code_dim_id_IN,\n\tEXP_mp50_input.loss_master_dim_id_IN,\n\tEXP_mp50_input.kind_code_mine_sub_IN,\n\tEXP_mp50_input.facultative_ind_mine_sub_IN,\n\tEXP_mp50_input.reins_co_number_mine_sub_IN,\n\tEXP_mp50_input.major_peril_IN,\n\tEXP_mp50_input.financial_type_code_IN,\n\tEXP_mp50_input.trans_code_IN,\n\tEXP_mp50_input.trans_date_IN,\n\tEXP_mp50_input.trans_ctgry_code_IN,\n\tEXP_mp50_input.trans_amt_IN,\n\tEXP_mp50_input.trans_hist_amt_IN,\n\tEXP_mp50_input.source_sys_id_IN,\n\tEXP_mp50_input.claimant_cov_det_ak_id_IN,\n\tEXP_mp50_input.prdct_code_dim_id_IN,\n\tLKP_claim_loss_transaction_fact.ClaimReserveDimId,\n\tLKP_claim_loss_transaction_fact.ClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tLKP_claim_loss_transaction_fact.FeatureRepresentativeAssignedDateId,\n\tEXP_mp50_input.InsuranceReferenceDimId,\n\tEXP_mp50_input.AgencyDimId,\n\tEXP_mp50_input.SalesDivisionDimId,\n\tEXP_mp50_input.InsuranceReferenceCoverageDimId,\n\tEXP_mp50_input.CoverageDetailDimId\n\tFROM EXP_mp50_input\n\tLEFT JOIN LKP_claim_loss_transaction_fact\n\tON LKP_claim_loss_transaction_fact.claim_loss_trans_fact_id = EXP_mp50_input.claim_loss_trans_fact_id\n),\nLKP_claim_transaction_type_dim_Get_kind_code AS (\n\tSELECT\n\tclaim_trans_type_dim_id,\n\tcrrnt_snpsht_flag,\n\ttrans_ctgry_code,\n\ttrans_code,\n\ts3p_trans_code,\n\tpms_trans_code,\n\ttrans_base_type_code,\n\ttrans_kind_code,\n\ttrans_rsn,\n\ttype_disability,\n\toffset_onset_ind\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_trans_type_dim_id,\n\t\t\tcrrnt_snpsht_flag,\n\t\t\ttrans_ctgry_code,\n\t\t\ttrans_code,\n\t\t\ts3p_trans_code,\n\t\t\tpms_trans_code,\n\t\t\ttrans_base_type_code,\n\t\t\ttrans_kind_code,\n\t\t\ttrans_rsn,\n\t\t\ttype_disability,\n\t\t\toffset_onset_ind\n\t\tFROM claim_transaction_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_trans_type_dim_id ORDER BY claim_trans_type_dim_id DESC) = 1\n),\nFIL_remove_ceded_kind_code AS (\n\tSELECT\n\tLKP_claim_transaction_type_dim_Get_kind_code.crrnt_snpsht_flag AS lkp_crrnt_snpsht_flag, \n\tLKP_claim_transaction_type_dim_Get_kind_code.trans_ctgry_code AS lkp_trans_ctgry_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.trans_code AS lkp_trans_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.s3p_trans_code AS lkp_s3p_trans_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.pms_trans_code AS lkp_pms_trans_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.trans_base_type_code AS lkp_trans_base_type_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.trans_kind_code AS lkp_trans_kind_code, \n\tLKP_claim_transaction_type_dim_Get_kind_code.trans_rsn AS lkp_trans_rsn, \n\tLKP_claim_transaction_type_dim_Get_kind_code.type_disability AS lkp_type_disability, \n\tLKP_claim_transaction_type_dim_Get_kind_code.offset_onset_ind AS lkp_offset_onset_ind, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_loss_trans_fact_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.err_flag, \n\tEXP_claim_loss_transaction_fact_lookup_output.audit_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.edw_claim_trans_pk_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.edw_claim_reins_trans_pk_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_occurrence_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_occurrence_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claimant_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claimant_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claimant_cov_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claimant_cov_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.cov_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.cov_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_trans_type_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_financial_type_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.reins_cov_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.reins_cov_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_prim_claim_rep_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_prim_claim_rep_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_examiner_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_examiner_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_prim_litigation_handler_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_prim_litigation_handler_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_trans_entry_oper_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_trans_entry_oper_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_dim_claim_created_by_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.pol_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.pol_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.agency_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.agency_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_pay_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_pay_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_pay_ctgry_type_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_pay_ctgry_type_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_case_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_case_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.contract_cust_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.contract_cust_dim_hist_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_master_1099_list_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_subrogation_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_trans_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_trans_reprocess_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_loss_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_discovery_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_scripted_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.source_claim_rpted_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rpted_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_open_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_close_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_reopen_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_closed_after_reopen_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_notice_only_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_cat_start_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_cat_end_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_assigned_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_rep_unassigned_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.pol_eff_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.pol_exp_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_subrogation_referred_to_subrogation_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_subrogation_pay_start_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.claim_subrogation_closure_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.acct_entered_date_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_amt, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_hist_amt, \n\tEXP_claim_loss_transaction_fact_lookup_output.tax_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_paid_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_outstanding_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_incurred_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_paid_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_outstanding_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_incurred_excluding_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_paid_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_outstanding_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_loss_incurred_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_paid_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_outstanding_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_alae_incurred_including_recoveries, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_subrogation_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_subrogation_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_subrogation_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_salvage_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_salvage_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_salvage_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_loss_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_loss_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_loss_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_alae_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_alae_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_alae_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.total_direct_loss_recovery_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.total_direct_loss_recovery_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.total_direct_loss_recovery_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.direct_other_recovery_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_loss_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_loss_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_loss_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_alae_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_alae_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_alae_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_salvage_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_subrogation_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_other_recovery_loss_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.ceded_other_recovery_alae_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.total_ceded_loss_recovery_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_loss_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_loss_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_loss_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_alae_paid, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_alae_outstanding, \n\tEXP_claim_loss_transaction_fact_lookup_output.net_alae_incurred, \n\tEXP_claim_loss_transaction_fact_lookup_output.asl_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.asl_prdct_code_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.loss_master_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.strtgc_bus_dvsn_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.prdct_code_dim_id, \n\tEXP_claim_loss_transaction_fact_lookup_output.asl_dim_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.asl_prdct_code_dim_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.loss_master_dim_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.kind_code_mine_sub_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.facultative_ind_mine_sub_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.reins_co_number_mine_sub_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.major_peril_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.financial_type_code_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_code_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_date_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_ctgry_code_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_amt_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.trans_hist_amt_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.source_sys_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.claimant_cov_det_ak_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.prdct_code_dim_id_IN, \n\tEXP_claim_loss_transaction_fact_lookup_output.ClaimReserveDimId, \n\tEXP_claim_loss_transaction_fact_lookup_output.ClaimRepresentativeDimFeatureClaimRepresentativeId, \n\tEXP_claim_loss_transaction_fact_lookup_output.FeatureRepresentativeAssignedDateId, \n\tEXP_claim_loss_transaction_fact_lookup_output.InsuranceReferenceDimId, \n\tEXP_claim_loss_transaction_fact_lookup_output.AgencyDimId, \n\tEXP_claim_loss_transaction_fact_lookup_output.SalesDivisionDimId, \n\tEXP_claim_loss_transaction_fact_lookup_output.InsuranceReferenceCoverageDimId, \n\tEXP_claim_loss_transaction_fact_lookup_output.CoverageDetailDimId\n\tFROM EXP_claim_loss_transaction_fact_lookup_output\n\tLEFT JOIN LKP_claim_transaction_type_dim_Get_kind_code\n\tON LKP_claim_transaction_type_dim_Get_kind_code.claim_trans_type_dim_id = EXP_claim_loss_transaction_fact_lookup_output.claim_trans_type_dim_id\n\tWHERE rtrim(ltrim(lkp_trans_kind_code))='D'\n),\nLKP_claim_transaction_type_dim_Get_Ceded_Record AS (\n\tSELECT\n\tclaim_trans_type_dim_id,\n\tcrrnt_snpsht_flag,\n\ttrans_ctgry_code,\n\ttrans_code,\n\ts3p_trans_code,\n\tpms_trans_code,\n\ttrans_base_type_code,\n\ttrans_rsn,\n\ttype_disability,\n\toffset_onset_ind,\n\ttrans_kind_code\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_trans_type_dim_id,\n\t\t\tcrrnt_snpsht_flag,\n\t\t\ttrans_ctgry_code,\n\t\t\ttrans_code,\n\t\t\ts3p_trans_code,\n\t\t\tpms_trans_code,\n\t\t\ttrans_base_type_code,\n\t\t\ttrans_rsn,\n\t\t\ttype_disability,\n\t\t\toffset_onset_ind,\n\t\t\ttrans_kind_code\n\t\tFROM claim_transaction_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY crrnt_snpsht_flag,trans_ctgry_code,trans_code,s3p_trans_code,pms_trans_code,trans_base_type_code,trans_rsn,type_disability,offset_onset_ind,trans_kind_code ORDER BY claim_trans_type_dim_id DESC) = 1\n),\nEXP_set_ceded_transaction_type_id AS (\n\tSELECT\n\tFIL_remove_ceded_kind_code.claim_loss_trans_fact_id,\n\tFIL_remove_ceded_kind_code.err_flag,\n\tFIL_remove_ceded_kind_code.audit_id,\n\tFIL_remove_ceded_kind_code.edw_claim_trans_pk_id,\n\tFIL_remove_ceded_kind_code.edw_claim_reins_trans_pk_id,\n\tFIL_remove_ceded_kind_code.claim_occurrence_dim_id,\n\tFIL_remove_ceded_kind_code.claim_occurrence_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claimant_dim_id,\n\tFIL_remove_ceded_kind_code.claimant_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claimant_cov_dim_id,\n\tFIL_remove_ceded_kind_code.claimant_cov_dim_hist_id,\n\tFIL_remove_ceded_kind_code.cov_dim_id,\n\tFIL_remove_ceded_kind_code.cov_dim_hist_id,\n\tLKP_claim_transaction_type_dim_Get_Ceded_Record.claim_trans_type_dim_id,\n\t-- *INF*: IIF(isnull(claim_trans_type_dim_id),-1,claim_trans_type_dim_id)\n\tIFF(claim_trans_type_dim_id IS NULL, - 1, claim_trans_type_dim_id) AS lkp_claim_trans_type_dim_id,\n\tFIL_remove_ceded_kind_code.claim_financial_type_dim_id,\n\tFIL_remove_ceded_kind_code.reins_cov_dim_id,\n\tFIL_remove_ceded_kind_code.reins_cov_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_prim_claim_rep_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_prim_claim_rep_hist_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_examiner_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_examiner_hist_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_prim_litigation_handler_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_prim_litigation_handler_hist_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_trans_entry_oper_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_trans_entry_oper_hist_id,\n\tFIL_remove_ceded_kind_code.claim_rep_dim_claim_created_by_id,\n\tFIL_remove_ceded_kind_code.pol_dim_id,\n\tFIL_remove_ceded_kind_code.pol_dim_hist_id,\n\tFIL_remove_ceded_kind_code.agency_dim_id,\n\tFIL_remove_ceded_kind_code.agency_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claim_pay_dim_id,\n\tFIL_remove_ceded_kind_code.claim_pay_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claim_pay_ctgry_type_dim_id,\n\tFIL_remove_ceded_kind_code.claim_pay_ctgry_type_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claim_case_dim_id,\n\tFIL_remove_ceded_kind_code.claim_case_dim_hist_id,\n\tFIL_remove_ceded_kind_code.contract_cust_dim_id,\n\tFIL_remove_ceded_kind_code.contract_cust_dim_hist_id,\n\tFIL_remove_ceded_kind_code.claim_master_1099_list_dim_id,\n\tFIL_remove_ceded_kind_code.claim_subrogation_dim_id,\n\tFIL_remove_ceded_kind_code.claim_trans_date_id,\n\tFIL_remove_ceded_kind_code.claim_trans_reprocess_date_id,\n\tFIL_remove_ceded_kind_code.claim_loss_date_id,\n\tFIL_remove_ceded_kind_code.claim_discovery_date_id,\n\tFIL_remove_ceded_kind_code.claim_scripted_date_id,\n\tFIL_remove_ceded_kind_code.source_claim_rpted_date_id,\n\tFIL_remove_ceded_kind_code.claim_rpted_date_id,\n\tFIL_remove_ceded_kind_code.claim_open_date_id,\n\tFIL_remove_ceded_kind_code.claim_close_date_id,\n\tFIL_remove_ceded_kind_code.claim_reopen_date_id,\n\tFIL_remove_ceded_kind_code.claim_closed_after_reopen_date_id,\n\tFIL_remove_ceded_kind_code.claim_notice_only_date_id,\n\tFIL_remove_ceded_kind_code.claim_cat_start_date_id,\n\tFIL_remove_ceded_kind_code.claim_cat_end_date_id,\n\tFIL_remove_ceded_kind_code.claim_rep_assigned_date_id,\n\tFIL_remove_ceded_kind_code.claim_rep_unassigned_date_id,\n\tFIL_remove_ceded_kind_code.pol_eff_date_id,\n\tFIL_remove_ceded_kind_code.pol_exp_date_id,\n\tFIL_remove_ceded_kind_code.claim_subrogation_referred_to_subrogation_date_id,\n\tFIL_remove_ceded_kind_code.claim_subrogation_pay_start_date_id,\n\tFIL_remove_ceded_kind_code.claim_subrogation_closure_date_id,\n\tFIL_remove_ceded_kind_code.acct_entered_date_id,\n\tFIL_remove_ceded_kind_code.trans_amt,\n\tFIL_remove_ceded_kind_code.trans_hist_amt,\n\tFIL_remove_ceded_kind_code.tax_id,\n\tFIL_remove_ceded_kind_code.direct_loss_paid_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_loss_outstanding_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_loss_incurred_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_paid_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_outstanding_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_incurred_excluding_recoveries,\n\tFIL_remove_ceded_kind_code.direct_loss_paid_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_loss_outstanding_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_loss_incurred_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_paid_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_outstanding_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_alae_incurred_including_recoveries,\n\tFIL_remove_ceded_kind_code.direct_subrogation_paid,\n\tFIL_remove_ceded_kind_code.direct_subrogation_outstanding,\n\tFIL_remove_ceded_kind_code.direct_subrogation_incurred,\n\tFIL_remove_ceded_kind_code.direct_salvage_paid,\n\tFIL_remove_ceded_kind_code.direct_salvage_outstanding,\n\tFIL_remove_ceded_kind_code.direct_salvage_incurred,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_loss_paid,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_loss_outstanding,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_loss_incurred,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_alae_paid,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_alae_outstanding,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_alae_incurred,\n\tFIL_remove_ceded_kind_code.total_direct_loss_recovery_paid,\n\tFIL_remove_ceded_kind_code.total_direct_loss_recovery_outstanding,\n\tFIL_remove_ceded_kind_code.total_direct_loss_recovery_incurred,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_paid,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_outstanding,\n\tFIL_remove_ceded_kind_code.direct_other_recovery_incurred,\n\tFIL_remove_ceded_kind_code.ceded_loss_paid,\n\tFIL_remove_ceded_kind_code.ceded_loss_outstanding,\n\tFIL_remove_ceded_kind_code.ceded_loss_incurred,\n\tFIL_remove_ceded_kind_code.ceded_alae_paid,\n\tFIL_remove_ceded_kind_code.ceded_alae_outstanding,\n\tFIL_remove_ceded_kind_code.ceded_alae_incurred,\n\tFIL_remove_ceded_kind_code.ceded_salvage_paid,\n\tFIL_remove_ceded_kind_code.ceded_subrogation_paid,\n\tFIL_remove_ceded_kind_code.ceded_other_recovery_loss_paid,\n\tFIL_remove_ceded_kind_code.ceded_other_recovery_alae_paid,\n\tFIL_remove_ceded_kind_code.total_ceded_loss_recovery_paid,\n\tFIL_remove_ceded_kind_code.net_loss_paid,\n\tFIL_remove_ceded_kind_code.net_loss_outstanding,\n\tFIL_remove_ceded_kind_code.net_loss_incurred,\n\tFIL_remove_ceded_kind_code.net_alae_paid,\n\tFIL_remove_ceded_kind_code.net_alae_outstanding,\n\tFIL_remove_ceded_kind_code.net_alae_incurred,\n\tFIL_remove_ceded_kind_code.asl_dim_id,\n\tFIL_remove_ceded_kind_code.asl_prdct_code_dim_id,\n\tFIL_remove_ceded_kind_code.loss_master_dim_id,\n\tFIL_remove_ceded_kind_code.strtgc_bus_dvsn_dim_id,\n\tFIL_remove_ceded_kind_code.prdct_code_dim_id,\n\tFIL_remove_ceded_kind_code.asl_dim_id_IN,\n\tFIL_remove_ceded_kind_code.asl_prdct_code_dim_id_IN,\n\tFIL_remove_ceded_kind_code.loss_master_dim_id_IN,\n\tFIL_remove_ceded_kind_code.kind_code_mine_sub_IN,\n\tFIL_remove_ceded_kind_code.facultative_ind_mine_sub_IN,\n\tFIL_remove_ceded_kind_code.reins_co_number_mine_sub_IN,\n\tFIL_remove_ceded_kind_code.major_peril_IN,\n\t-1 AS DEFAULT_ID,\n\t-50 AS DEFAULT_AUDIT,\n\t0 AS DEFAULT_VALUE,\n\tFIL_remove_ceded_kind_code.financial_type_code_IN,\n\tFIL_remove_ceded_kind_code.trans_code_IN,\n\tFIL_remove_ceded_kind_code.trans_date_IN,\n\tFIL_remove_ceded_kind_code.trans_ctgry_code_IN,\n\tFIL_remove_ceded_kind_code.trans_amt_IN,\n\tFIL_remove_ceded_kind_code.trans_hist_amt_IN,\n\tFIL_remove_ceded_kind_code.source_sys_id_IN,\n\tFIL_remove_ceded_kind_code.claimant_cov_det_ak_id_IN,\n\tFIL_remove_ceded_kind_code.prdct_code_dim_id_IN,\n\tFIL_remove_ceded_kind_code.ClaimReserveDimId,\n\tFIL_remove_ceded_kind_code.ClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tFIL_remove_ceded_kind_code.FeatureRepresentativeAssignedDateId,\n\tFIL_remove_ceded_kind_code.InsuranceReferenceDimId,\n\tFIL_remove_ceded_kind_code.AgencyDimId,\n\tFIL_remove_ceded_kind_code.SalesDivisionDimId,\n\tFIL_remove_ceded_kind_code.InsuranceReferenceCoverageDimId,\n\tFIL_remove_ceded_kind_code.CoverageDetailDimId\n\tFROM FIL_remove_ceded_kind_code\n\tLEFT JOIN LKP_claim_transaction_type_dim_Get_Ceded_Record\n\tON LKP_claim_transaction_type_dim_Get_Ceded_Record.crrnt_snpsht_flag = FIL_remove_ceded_kind_code.lkp_crrnt_snpsht_flag AND LKP_claim_transaction_type_dim_Get_Ceded_Record.trans_ctgry_code = FIL_remove_ceded_kind_code.lkp_trans_ctgry_code AND LKP_claim_transaction_type_dim_Get_Ceded_Record.trans_code = FIL_remove_ceded_kind_code.lkp_trans_code AND LKP_claim_transaction_type_dim_Get_Ceded_Record.s3p_trans_code = FIL_remove_ceded_kind_code.lkp_s3p_trans_code AND LKP_claim_transaction_type_dim_Get_Ceded_Record.pms_trans_code = FIL_remove_ceded_kind_code.lkp_pms_trans_code AND LKP_claim_transaction_type_dim_Get_Ceded_Record.trans_base_type_code = FIL_remove_ceded_kind_code.lkp_trans_base_type_code AND LKP_claim_transaction_type_dim_Get_Ceded_Record.trans_rsn = FIL_remove_ceded_kind_code.lkp_trans_rsn AND LKP_claim_transaction_type_dim_Get_Ceded_Record.type_disability = FIL_remove_ceded_kind_code.lkp_type_disability AND LKP_claim_transaction_type_dim_Get_Ceded_Record.offset_onset_ind = FIL_remove_ceded_kind_code.lkp_offset_onset_ind AND LKP_claim_transaction_type_dim_Get_Ceded_Record.trans_kind_code = FIL_remove_ceded_kind_code.kind_code_mine_sub_IN\n),\nmplt_reinsurance_claim_loss_transaction_fact_calculations AS (WITH\n\tLKP_claim_reinsurance_transaction AS (\n\t\tSELECT\n\t\tclaimant_cov_det_ak_id,\n\t\tclaim_reins_financial_type_code,\n\t\tclaim_reins_trans_date\n\t\tFROM (\n\t\t\tSELECT claim_reinsurance_transaction.claimant_cov_det_ak_id as claimant_cov_det_ak_id, claim_reinsurance_transaction.claim_reins_financial_type_code as claim_reins_financial_type_code, claim_reinsurance_transaction.claim_reins_trans_date as claim_reins_trans_date \r\n\t\t\t FROM claim_reinsurance_transaction\r\n\t\t\twhere claim_reins_trans_code= 23\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,claim_reins_financial_type_code,claim_reins_trans_date ORDER BY claimant_cov_det_ak_id) = 1\n\t),\n\tINPT_reinsurance_claim_loss_trans_fact_calculations AS (\n\t\t\n\t),\n\tEXP_reinsurance_claim_loss_transaction_fact_calculations_input AS (\n\t\tSELECT\n\t\tclaim_reins_fin_type_code,\n\t\tclaim_reins_trans_code,\n\t\tclaim_reins_trans_amt,\n\t\tclaim_reins_trans_hist_amt,\n\t\tclaimant_cov_det_ak_id,\n\t\tclaim_reins_trans_date,\n\t\tsource_sys_id,\n\t\ttrans_ctgry_code\n\t\tFROM INPT_reinsurance_claim_loss_trans_fact_calculations\n\t),\n\tEXP_calculations AS (\n\t\tSELECT\n\t\tclaim_reins_fin_type_code AS claim_reins_financial_type_code,\n\t\tclaim_reins_trans_code,\n\t\tclaim_reins_trans_amt,\n\t\tclaim_reins_trans_hist_amt,\n\t\tclaimant_cov_det_ak_id,\n\t\tclaim_reins_trans_date,\n\t\tsource_sys_id,\n\t\ttrans_ctgry_code,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt, '21',claim_reins_trans_amt, '22', claim_reins_trans_amt, '23',claim_reins_trans_amt, '24', claim_reins_trans_amt, '28', claim_reins_trans_amt, '29', claim_reins_trans_amt, '41', 0, '42', 0, '43', 0, '65',0, '66', 0, '90', 0, '91', 0, '92', 0, 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t\t'20', claim_reins_trans_amt,\n\t\t'21', claim_reins_trans_amt,\n\t\t'22', claim_reins_trans_amt,\n\t\t'23', claim_reins_trans_amt,\n\t\t'24', claim_reins_trans_amt,\n\t\t'28', claim_reins_trans_amt,\n\t\t'29', claim_reins_trans_amt,\n\t\t'41', 0,\n\t\t'42', 0,\n\t\t'43', 0,\n\t\t'65', 0,\n\t\t'66', 0,\n\t\t'90', 0,\n\t\t'91', 0,\n\t\t'92', 0,\n\t\t0), 0) AS var_ceded_loss_paid,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code, '20', 0, '21', claim_reins_trans_amt * -1, '22', (claim_reins_trans_amt - claim_reins_trans_hist_amt ) * -1, '23', 0, '24', 0, '28', claim_reins_trans_amt * -1, '29', 0, '41', claim_reins_trans_hist_amt, '42', claim_reins_trans_hist_amt, '43', 0, '65', claim_reins_trans_hist_amt, '66', claim_reins_trans_hist_amt, '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0))\n\t\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t\t'20', 0,\n\t\t'21', claim_reins_trans_amt * - 1,\n\t\t'22', ( claim_reins_trans_amt - claim_reins_trans_hist_amt ) * - 1,\n\t\t'23', 0,\n\t\t'24', 0,\n\t\t'28', claim_reins_trans_amt * - 1,\n\t\t'29', 0,\n\t\t'41', claim_reins_trans_hist_amt,\n\t\t'42', claim_reins_trans_hist_amt,\n\t\t'43', 0,\n\t\t'65', claim_reins_trans_hist_amt,\n\t\t'66', claim_reins_trans_hist_amt,\n\t\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t0)) AS var_ceded_loss_outstanding,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt, '21', 0, '22', claim_reins_trans_hist_amt, '23', claim_reins_trans_amt, '24', claim_reins_trans_amt, '28',0, '29', claim_reins_trans_amt, '41', claim_reins_trans_hist_amt, '42', claim_reins_trans_hist_amt, '43', 0, '65', claim_reins_trans_hist_amt, '66', claim_reins_trans_hist_amt, '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 1111))\n\t\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t\t'20', claim_reins_trans_amt,\n\t\t'21', 0,\n\t\t'22', claim_reins_trans_hist_amt,\n\t\t'23', claim_reins_trans_amt,\n\t\t'24', claim_reins_trans_amt,\n\t\t'28', 0,\n\t\t'29', claim_reins_trans_amt,\n\t\t'41', claim_reins_trans_hist_amt,\n\t\t'42', claim_reins_trans_hist_amt,\n\t\t'43', 0,\n\t\t'65', claim_reins_trans_hist_amt,\n\t\t'66', claim_reins_trans_hist_amt,\n\t\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t1111)) AS var_ceded_loss_incurred,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'E', DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt, '21',claim_reins_trans_amt, '22', claim_reins_trans_amt, '23',claim_reins_trans_amt, '24', claim_reins_trans_amt, '28', claim_reins_trans_amt, '29', claim_reins_trans_amt, '40',0, '41', 0, '42', 0, '43', 0, '65',0, '66', 0, '90', 0, '91', 0, '92', 0, 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'E', DECODE(claim_reins_trans_code,\n\t\t'20', claim_reins_trans_amt,\n\t\t'21', claim_reins_trans_amt,\n\t\t'22', claim_reins_trans_amt,\n\t\t'23', claim_reins_trans_amt,\n\t\t'24', claim_reins_trans_amt,\n\t\t'28', claim_reins_trans_amt,\n\t\t'29', claim_reins_trans_amt,\n\t\t'40', 0,\n\t\t'41', 0,\n\t\t'42', 0,\n\t\t'43', 0,\n\t\t'65', 0,\n\t\t'66', 0,\n\t\t'90', 0,\n\t\t'91', 0,\n\t\t'92', 0,\n\t\t0), 0) AS var_ceded_alae_paid,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'E' and source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code, '20', 0, '21', claim_reins_trans_amt * -1, '22', (claim_reins_trans_amt - claim_reins_trans_hist_amt ) * -1, '23', 0, '24', 0, '28', claim_reins_trans_amt * -1, '29', 0, '40',claim_reins_trans_hist_amt, '41', claim_reins_trans_hist_amt, '42', claim_reins_trans_hist_amt, '43', 0, '65', claim_reins_trans_hist_amt, '66', claim_reins_trans_hist_amt, '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0), 0)\n\t\tIFF(claim_reins_financial_type_code = 'E' AND source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code,\n\t\t'20', 0,\n\t\t'21', claim_reins_trans_amt * - 1,\n\t\t'22', ( claim_reins_trans_amt - claim_reins_trans_hist_amt ) * - 1,\n\t\t'23', 0,\n\t\t'24', 0,\n\t\t'28', claim_reins_trans_amt * - 1,\n\t\t'29', 0,\n\t\t'40', claim_reins_trans_hist_amt,\n\t\t'41', claim_reins_trans_hist_amt,\n\t\t'42', claim_reins_trans_hist_amt,\n\t\t'43', 0,\n\t\t'65', claim_reins_trans_hist_amt,\n\t\t'66', claim_reins_trans_hist_amt,\n\t\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t0), 0) AS var_ceded_alae_outstanding,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'E' and source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt, '21', 0, '22', claim_reins_trans_hist_amt, '23', claim_reins_trans_amt, '24', claim_reins_trans_amt, '28',claim_reins_trans_amt, '29', claim_reins_trans_amt, '40', claim_reins_trans_hist_amt, '41', claim_reins_trans_hist_amt, '42', claim_reins_trans_hist_amt, '43', 0, '65', claim_reins_trans_hist_amt, '66', claim_reins_trans_hist_amt, '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0), 0)\n\t\tIFF(claim_reins_financial_type_code = 'E' AND source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code,\n\t\t'20', claim_reins_trans_amt,\n\t\t'21', 0,\n\t\t'22', claim_reins_trans_hist_amt,\n\t\t'23', claim_reins_trans_amt,\n\t\t'24', claim_reins_trans_amt,\n\t\t'28', claim_reins_trans_amt,\n\t\t'29', claim_reins_trans_amt,\n\t\t'40', claim_reins_trans_hist_amt,\n\t\t'41', claim_reins_trans_hist_amt,\n\t\t'42', claim_reins_trans_hist_amt,\n\t\t'43', 0,\n\t\t'65', claim_reins_trans_hist_amt,\n\t\t'66', claim_reins_trans_hist_amt,\n\t\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t\t0), 0) AS var_ceded_alae_incurred,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'S', DECODE(claim_reins_trans_code, '25', claim_reins_trans_amt * -1, '31', claim_reins_trans_amt * -1, '32', claim_reins_trans_amt * -1, '33', claim_reins_trans_amt * -1, '34', claim_reins_trans_amt * -1, '38', claim_reins_trans_amt * -1, '39', claim_reins_trans_amt * -1 , 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'S', DECODE(claim_reins_trans_code,\n\t\t'25', claim_reins_trans_amt * - 1,\n\t\t'31', claim_reins_trans_amt * - 1,\n\t\t'32', claim_reins_trans_amt * - 1,\n\t\t'33', claim_reins_trans_amt * - 1,\n\t\t'34', claim_reins_trans_amt * - 1,\n\t\t'38', claim_reins_trans_amt * - 1,\n\t\t'39', claim_reins_trans_amt * - 1,\n\t\t0), 0) AS var_ceded_salvage_paid,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'B', DECODE(claim_reins_trans_code, '25', claim_reins_trans_amt * -1, '31', claim_reins_trans_amt * -1, '32', claim_reins_trans_amt * -1, '33', claim_reins_trans_amt * -1, '34', claim_reins_trans_amt * -1, '38', claim_reins_trans_amt * -1, '39', claim_reins_trans_amt * -1 , 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'B', DECODE(claim_reins_trans_code,\n\t\t'25', claim_reins_trans_amt * - 1,\n\t\t'31', claim_reins_trans_amt * - 1,\n\t\t'32', claim_reins_trans_amt * - 1,\n\t\t'33', claim_reins_trans_amt * - 1,\n\t\t'34', claim_reins_trans_amt * - 1,\n\t\t'38', claim_reins_trans_amt * - 1,\n\t\t'39', claim_reins_trans_amt * - 1,\n\t\t0), 0) AS var_ceded_subrogation_paid,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'R' and trans_ctgry_code<>'EX', DECODE(claim_reins_trans_code, '25', claim_reins_trans_amt * -1, '31', claim_reins_trans_amt * -1, '32', claim_reins_trans_amt * -1, '33', claim_reins_trans_amt * -1, '34', claim_reins_trans_amt * -1, '38', claim_reins_trans_amt * -1, '39', claim_reins_trans_amt * -1 , 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'R' AND trans_ctgry_code <> 'EX', DECODE(claim_reins_trans_code,\n\t\t'25', claim_reins_trans_amt * - 1,\n\t\t'31', claim_reins_trans_amt * - 1,\n\t\t'32', claim_reins_trans_amt * - 1,\n\t\t'33', claim_reins_trans_amt * - 1,\n\t\t'34', claim_reins_trans_amt * - 1,\n\t\t'38', claim_reins_trans_amt * - 1,\n\t\t'39', claim_reins_trans_amt * - 1,\n\t\t0), 0) AS var_ceded_other_recovery_loss_paid,\n\t\t-- *INF*: IIF(claim_reins_financial_type_code = 'R' and trans_ctgry_code = 'EX', DECODE(claim_reins_trans_code, '25', claim_reins_trans_amt * -1, '31', claim_reins_trans_amt * -1, '32', claim_reins_trans_amt * -1, '33', claim_reins_trans_amt * -1, '34', claim_reins_trans_amt * -1, '38', claim_reins_trans_amt * -1, '39', claim_reins_trans_amt * -1 , 0),0)\n\t\tIFF(claim_reins_financial_type_code = 'R' AND trans_ctgry_code = 'EX', DECODE(claim_reins_trans_code,\n\t\t'25', claim_reins_trans_amt * - 1,\n\t\t'31', claim_reins_trans_amt * - 1,\n\t\t'32', claim_reins_trans_amt * - 1,\n\t\t'33', claim_reins_trans_amt * - 1,\n\t\t'34', claim_reins_trans_amt * - 1,\n\t\t'38', claim_reins_trans_amt * - 1,\n\t\t'39', claim_reins_trans_amt * - 1,\n\t\t0), 0) AS var_ceded_other_recovery_alae_paid,\n\t\t-- *INF*: round(var_ceded_salvage_paid+var_ceded_subrogation_paid+var_ceded_other_recovery_loss_paid,2)\n\t\tround(var_ceded_salvage_paid + var_ceded_subrogation_paid + var_ceded_other_recovery_loss_paid, 2) AS var_total_ceded_loss_recovery_paid,\n\t\tvar_ceded_loss_paid AS ceded_loss_paid,\n\t\tvar_ceded_loss_outstanding AS ceded_loss_outstanding,\n\t\tvar_ceded_loss_incurred AS ceded_loss_incurred,\n\t\tvar_ceded_alae_paid AS ceded_alae_paid,\n\t\tvar_ceded_alae_outstanding AS ceded_alae_outstanding,\n\t\tvar_ceded_alae_incurred AS ceded_alae_incurred,\n\t\tvar_ceded_salvage_paid AS ceded_salvage_paid,\n\t\tvar_ceded_subrogation_paid AS ceded_subrogation_paid,\n\t\tvar_ceded_other_recovery_loss_paid AS ceded_other_recovery_loss_paid,\n\t\tvar_ceded_other_recovery_alae_paid AS ceded_other_recovery_alae_paid,\n\t\tvar_total_ceded_loss_recovery_paid AS total_ceded_loss_recovery_paid,\n\t\tvar_ceded_loss_paid *-1 AS net_loss_paid,\n\t\tvar_ceded_loss_outstanding*-1 AS net_loss_outstanding,\n\t\tvar_ceded_loss_incurred * -1 AS net_loss_incurred,\n\t\tvar_ceded_alae_paid*-1 AS net_alae_paid,\n\t\tvar_ceded_alae_outstanding*-1 AS net_alae_outstanding,\n\t\tvar_ceded_alae_incurred*-1 AS net_alae_incurred\n\t\tFROM EXP_reinsurance_claim_loss_transaction_fact_calculations_input\n\t\tLEFT JOIN LKP_CLAIM_REINSURANCE_TRANSACTION LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date\n\t\tON LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id = claimant_cov_det_ak_id\n\t\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claim_reins_financial_type_code = 'D'\n\t\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claim_reins_trans_date = claim_reins_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REINSURANCE_TRANSACTION LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date\n\t\tON LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id = claimant_cov_det_ak_id\n\t\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claim_reins_financial_type_code = 'E'\n\t\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claim_reins_trans_date = claim_reins_trans_date\n\t\n\t),\n\tOUT_reinsurance_claim_loss_transaction_fact_calculations AS (\n\t\tSELECT\n\t\tclaim_reins_financial_type_code, \n\t\tclaim_reins_trans_code, \n\t\tclaim_reins_trans_amt, \n\t\tclaim_reins_trans_hist_amt, \n\t\tclaimant_cov_det_ak_id, \n\t\tclaim_reins_trans_date, \n\t\tsource_sys_id, \n\t\ttrans_ctgry_code, \n\t\tceded_loss_paid, \n\t\tceded_loss_outstanding, \n\t\tceded_loss_incurred, \n\t\tceded_alae_paid, \n\t\tceded_alae_outstanding, \n\t\tceded_alae_incurred, \n\t\tceded_salvage_paid, \n\t\tceded_subrogation_paid, \n\t\tceded_other_recovery_loss_paid, \n\t\tceded_other_recovery_alae_paid, \n\t\ttotal_ceded_loss_recovery_paid, \n\t\tnet_loss_paid, \n\t\tnet_loss_outstanding, \n\t\tnet_loss_incurred, \n\t\tnet_alae_paid, \n\t\tnet_alae_outstanding, \n\t\tnet_alae_incurred\n\t\tFROM EXP_calculations\n\t),\n),\nFIL_remove_if_record_exists AS (\n\tSELECT\n\tEXP_set_ceded_transaction_type_id.err_flag, \n\tEXP_set_ceded_transaction_type_id.audit_id, \n\tEXP_set_ceded_transaction_type_id.edw_claim_trans_pk_id, \n\tEXP_set_ceded_transaction_type_id.edw_claim_reins_trans_pk_id, \n\tEXP_set_ceded_transaction_type_id.claim_occurrence_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_occurrence_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claimant_dim_id, \n\tEXP_set_ceded_transaction_type_id.claimant_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claimant_cov_dim_id, \n\tEXP_set_ceded_transaction_type_id.claimant_cov_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.cov_dim_id, \n\tEXP_set_ceded_transaction_type_id.cov_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.lkp_claim_trans_type_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_financial_type_dim_id, \n\tEXP_set_ceded_transaction_type_id.reins_cov_dim_id, \n\tEXP_set_ceded_transaction_type_id.reins_cov_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_prim_claim_rep_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_prim_claim_rep_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_examiner_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_examiner_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_prim_litigation_handler_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_prim_litigation_handler_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_trans_entry_oper_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_trans_entry_oper_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_dim_claim_created_by_id, \n\tEXP_set_ceded_transaction_type_id.pol_dim_id, \n\tEXP_set_ceded_transaction_type_id.pol_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.agency_dim_id, \n\tEXP_set_ceded_transaction_type_id.agency_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_pay_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_pay_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_pay_ctgry_type_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_pay_ctgry_type_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_case_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_case_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.contract_cust_dim_id, \n\tEXP_set_ceded_transaction_type_id.contract_cust_dim_hist_id, \n\tEXP_set_ceded_transaction_type_id.claim_master_1099_list_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_subrogation_dim_id, \n\tEXP_set_ceded_transaction_type_id.claim_trans_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_trans_reprocess_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_loss_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_discovery_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_scripted_date_id, \n\tEXP_set_ceded_transaction_type_id.source_claim_rpted_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_rpted_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_open_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_close_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_reopen_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_closed_after_reopen_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_notice_only_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_cat_start_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_cat_end_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_assigned_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_rep_unassigned_date_id, \n\tEXP_set_ceded_transaction_type_id.pol_eff_date_id, \n\tEXP_set_ceded_transaction_type_id.pol_exp_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_subrogation_referred_to_subrogation_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_subrogation_pay_start_date_id, \n\tEXP_set_ceded_transaction_type_id.claim_subrogation_closure_date_id, \n\tEXP_set_ceded_transaction_type_id.acct_entered_date_id, \n\tEXP_set_ceded_transaction_type_id.trans_amt, \n\tEXP_set_ceded_transaction_type_id.trans_hist_amt, \n\tEXP_set_ceded_transaction_type_id.tax_id, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_paid_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_outstanding_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_incurred_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_paid_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_outstanding_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_incurred_excluding_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_paid_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_outstanding_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_loss_incurred_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_paid_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_outstanding_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_alae_incurred_including_recoveries, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_subrogation_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_subrogation_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_subrogation_incurred, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_salvage_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_salvage_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_salvage_incurred, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_loss_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_loss_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_loss_incurred, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_alae_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_alae_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_alae_incurred, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS total_direct_loss_recovery_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS total_direct_loss_recovery_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS total_direct_loss_recovery_incurred, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_paid, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_outstanding, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE AS direct_other_recovery_incurred, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_loss_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_loss_outstanding, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_loss_incurred, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_alae_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_alae_outstanding, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_alae_incurred, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_salvage_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_subrogation_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_other_recovery_loss_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.ceded_other_recovery_alae_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.total_ceded_loss_recovery_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_loss_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_loss_outstanding, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_loss_incurred, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_alae_paid, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_alae_outstanding, \n\tmplt_reinsurance_claim_loss_transaction_fact_calculations.net_alae_incurred, \n\tEXP_set_ceded_transaction_type_id.asl_dim_id, \n\tEXP_set_ceded_transaction_type_id.asl_prdct_code_dim_id, \n\tEXP_set_ceded_transaction_type_id.loss_master_dim_id, \n\tEXP_set_ceded_transaction_type_id.strtgc_bus_dvsn_dim_id, \n\tEXP_set_ceded_transaction_type_id.prdct_code_dim_id, \n\tEXP_set_ceded_transaction_type_id.asl_dim_id_IN, \n\tEXP_set_ceded_transaction_type_id.asl_prdct_code_dim_id_IN, \n\tEXP_set_ceded_transaction_type_id.loss_master_dim_id_IN, \n\tEXP_set_ceded_transaction_type_id.kind_code_mine_sub_IN, \n\tEXP_set_ceded_transaction_type_id.facultative_ind_mine_sub_IN, \n\tEXP_set_ceded_transaction_type_id.reins_co_number_mine_sub_IN, \n\tEXP_set_ceded_transaction_type_id.major_peril_IN, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_ID, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_AUDIT, \n\tEXP_set_ceded_transaction_type_id.DEFAULT_VALUE, \n\tEXP_set_ceded_transaction_type_id.prdct_code_dim_id_IN, \n\tEXP_set_ceded_transaction_type_id.ClaimReserveDimId, \n\tEXP_set_ceded_transaction_type_id.ClaimRepresentativeDimFeatureClaimRepresentativeId, \n\tEXP_set_ceded_transaction_type_id.FeatureRepresentativeAssignedDateId, \n\tEXP_set_ceded_transaction_type_id.InsuranceReferenceDimId, \n\tEXP_set_ceded_transaction_type_id.AgencyDimId, \n\tEXP_set_ceded_transaction_type_id.SalesDivisionDimId, \n\tEXP_set_ceded_transaction_type_id.InsuranceReferenceCoverageDimId, \n\tEXP_set_ceded_transaction_type_id.CoverageDetailDimId\n\tFROM EXP_set_ceded_transaction_type_id\n\t -- Manually join with mplt_reinsurance_claim_loss_transaction_fact_calculations\n\tWHERE TRUE\r\n\r\n\r\n---isnull(claim_loss_trans_fact_id)\n),\nLKP_reinsurance_coverage_dim AS (\n\tSELECT\n\treins_cov_dim_id,\n\treins_co_num,\n\tedw_reins_cov_pk_id\n\tFROM (\n\t\tSELECT \r\n\t\tRCD.reins_cov_dim_id \t\tas reins_cov_dim_id, \r\n\t\tRCD.reins_co_num \t\t\tas reins_co_num, \r\n\t\tRCD.edw_reins_cov_pk_id \tas edw_reins_cov_pk_id \r\n\t\t\r\n\t\tFROM reinsurance_coverage_dim RCD\r\n\t\twhere \r\n\t\tRCD.edw_reins_cov_pk_id  < 0\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY reins_co_num,edw_reins_cov_pk_id ORDER BY reins_cov_dim_id) = 1\n),\nEXP_mp50_output AS (\n\tSELECT\n\tFIL_remove_if_record_exists.err_flag,\n\tFIL_remove_if_record_exists.audit_id,\n\tFIL_remove_if_record_exists.edw_claim_trans_pk_id,\n\tFIL_remove_if_record_exists.edw_claim_reins_trans_pk_id,\n\tFIL_remove_if_record_exists.claim_occurrence_dim_id,\n\tFIL_remove_if_record_exists.claim_occurrence_dim_hist_id,\n\tFIL_remove_if_record_exists.claimant_dim_id,\n\tFIL_remove_if_record_exists.claimant_dim_hist_id,\n\tFIL_remove_if_record_exists.claimant_cov_dim_id,\n\tFIL_remove_if_record_exists.claimant_cov_dim_hist_id,\n\tFIL_remove_if_record_exists.cov_dim_id,\n\tFIL_remove_if_record_exists.cov_dim_hist_id,\n\tFIL_remove_if_record_exists.lkp_claim_trans_type_dim_id,\n\tFIL_remove_if_record_exists.claim_financial_type_dim_id,\n\tFIL_remove_if_record_exists.reins_cov_dim_hist_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_prim_claim_rep_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_prim_claim_rep_hist_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_examiner_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_examiner_hist_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_prim_litigation_handler_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_prim_litigation_handler_hist_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_trans_entry_oper_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_trans_entry_oper_hist_id,\n\tFIL_remove_if_record_exists.claim_rep_dim_claim_created_by_id,\n\tFIL_remove_if_record_exists.pol_dim_id,\n\tFIL_remove_if_record_exists.pol_dim_hist_id,\n\tFIL_remove_if_record_exists.agency_dim_id,\n\tFIL_remove_if_record_exists.agency_dim_hist_id,\n\tFIL_remove_if_record_exists.claim_pay_dim_id,\n\tFIL_remove_if_record_exists.claim_pay_dim_hist_id,\n\tFIL_remove_if_record_exists.claim_pay_ctgry_type_dim_id,\n\tFIL_remove_if_record_exists.claim_pay_ctgry_type_dim_hist_id,\n\tFIL_remove_if_record_exists.claim_case_dim_id,\n\tFIL_remove_if_record_exists.claim_case_dim_hist_id,\n\tFIL_remove_if_record_exists.contract_cust_dim_id,\n\tFIL_remove_if_record_exists.contract_cust_dim_hist_id,\n\tFIL_remove_if_record_exists.claim_master_1099_list_dim_id,\n\tFIL_remove_if_record_exists.claim_subrogation_dim_id,\n\tFIL_remove_if_record_exists.claim_trans_date_id,\n\tFIL_remove_if_record_exists.claim_trans_reprocess_date_id,\n\tFIL_remove_if_record_exists.claim_loss_date_id,\n\tFIL_remove_if_record_exists.claim_discovery_date_id,\n\tFIL_remove_if_record_exists.claim_scripted_date_id,\n\tFIL_remove_if_record_exists.source_claim_rpted_date_id,\n\tFIL_remove_if_record_exists.claim_rpted_date_id,\n\tFIL_remove_if_record_exists.claim_open_date_id,\n\tFIL_remove_if_record_exists.claim_close_date_id,\n\tFIL_remove_if_record_exists.claim_reopen_date_id,\n\tFIL_remove_if_record_exists.claim_closed_after_reopen_date_id,\n\tFIL_remove_if_record_exists.claim_notice_only_date_id,\n\tFIL_remove_if_record_exists.claim_cat_start_date_id,\n\tFIL_remove_if_record_exists.claim_cat_end_date_id,\n\tFIL_remove_if_record_exists.claim_rep_assigned_date_id,\n\tFIL_remove_if_record_exists.claim_rep_unassigned_date_id,\n\tFIL_remove_if_record_exists.pol_eff_date_id,\n\tFIL_remove_if_record_exists.pol_exp_date_id,\n\tFIL_remove_if_record_exists.claim_subrogation_referred_to_subrogation_date_id,\n\tFIL_remove_if_record_exists.claim_subrogation_pay_start_date_id,\n\tFIL_remove_if_record_exists.claim_subrogation_closure_date_id,\n\tFIL_remove_if_record_exists.acct_entered_date_id,\n\tFIL_remove_if_record_exists.trans_amt,\n\tFIL_remove_if_record_exists.trans_hist_amt,\n\tFIL_remove_if_record_exists.tax_id,\n\tFIL_remove_if_record_exists.direct_loss_paid_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_loss_outstanding_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_loss_incurred_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_paid_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_outstanding_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_incurred_excluding_recoveries,\n\tFIL_remove_if_record_exists.direct_loss_paid_including_recoveries,\n\tFIL_remove_if_record_exists.direct_loss_outstanding_including_recoveries,\n\tFIL_remove_if_record_exists.direct_loss_incurred_including_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_paid_including_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_outstanding_including_recoveries,\n\tFIL_remove_if_record_exists.direct_alae_incurred_including_recoveries,\n\tFIL_remove_if_record_exists.direct_subrogation_paid,\n\tFIL_remove_if_record_exists.direct_subrogation_outstanding,\n\tFIL_remove_if_record_exists.direct_subrogation_incurred,\n\tFIL_remove_if_record_exists.direct_salvage_paid,\n\tFIL_remove_if_record_exists.direct_salvage_outstanding,\n\tFIL_remove_if_record_exists.direct_salvage_incurred,\n\tFIL_remove_if_record_exists.direct_other_recovery_loss_paid,\n\tFIL_remove_if_record_exists.direct_other_recovery_loss_outstanding,\n\tFIL_remove_if_record_exists.direct_other_recovery_loss_incurred,\n\tFIL_remove_if_record_exists.direct_other_recovery_alae_paid,\n\tFIL_remove_if_record_exists.direct_other_recovery_alae_outstanding,\n\tFIL_remove_if_record_exists.direct_other_recovery_alae_incurred,\n\tFIL_remove_if_record_exists.total_direct_loss_recovery_paid,\n\tFIL_remove_if_record_exists.total_direct_loss_recovery_outstanding,\n\tFIL_remove_if_record_exists.total_direct_loss_recovery_incurred,\n\tFIL_remove_if_record_exists.direct_other_recovery_paid,\n\tFIL_remove_if_record_exists.direct_other_recovery_outstanding,\n\tFIL_remove_if_record_exists.direct_other_recovery_incurred,\n\tFIL_remove_if_record_exists.ceded_loss_paid,\n\tFIL_remove_if_record_exists.ceded_loss_outstanding,\n\tFIL_remove_if_record_exists.ceded_loss_incurred,\n\tFIL_remove_if_record_exists.ceded_alae_paid,\n\tFIL_remove_if_record_exists.ceded_alae_outstanding,\n\tFIL_remove_if_record_exists.ceded_alae_incurred,\n\tFIL_remove_if_record_exists.ceded_salvage_paid,\n\tFIL_remove_if_record_exists.ceded_subrogation_paid,\n\tFIL_remove_if_record_exists.ceded_other_recovery_loss_paid,\n\tFIL_remove_if_record_exists.ceded_other_recovery_alae_paid,\n\tFIL_remove_if_record_exists.total_ceded_loss_recovery_paid,\n\tFIL_remove_if_record_exists.net_loss_paid,\n\tFIL_remove_if_record_exists.net_loss_outstanding,\n\tFIL_remove_if_record_exists.net_loss_incurred,\n\tFIL_remove_if_record_exists.net_alae_paid,\n\tFIL_remove_if_record_exists.net_alae_outstanding,\n\tFIL_remove_if_record_exists.net_alae_incurred,\n\tFIL_remove_if_record_exists.asl_dim_id,\n\tFIL_remove_if_record_exists.asl_prdct_code_dim_id,\n\tFIL_remove_if_record_exists.loss_master_dim_id,\n\tFIL_remove_if_record_exists.strtgc_bus_dvsn_dim_id,\n\tFIL_remove_if_record_exists.prdct_code_dim_id,\n\tFIL_remove_if_record_exists.asl_dim_id_IN,\n\tFIL_remove_if_record_exists.asl_prdct_code_dim_id_IN,\n\tFIL_remove_if_record_exists.loss_master_dim_id_IN,\n\tFIL_remove_if_record_exists.kind_code_mine_sub_IN,\n\tFIL_remove_if_record_exists.facultative_ind_mine_sub_IN,\n\tFIL_remove_if_record_exists.reins_co_number_mine_sub_IN,\n\tFIL_remove_if_record_exists.major_peril_IN,\n\tFIL_remove_if_record_exists.DEFAULT_ID,\n\tFIL_remove_if_record_exists.DEFAULT_AUDIT,\n\tLKP_reinsurance_coverage_dim.reins_cov_dim_id AS lkp_reins_cov_dim_id,\n\tFIL_remove_if_record_exists.prdct_code_dim_id_IN,\n\tFIL_remove_if_record_exists.ClaimReserveDimId,\n\tFIL_remove_if_record_exists.ClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tFIL_remove_if_record_exists.FeatureRepresentativeAssignedDateId,\n\tFIL_remove_if_record_exists.InsuranceReferenceDimId,\n\tFIL_remove_if_record_exists.AgencyDimId,\n\tFIL_remove_if_record_exists.SalesDivisionDimId,\n\tFIL_remove_if_record_exists.InsuranceReferenceCoverageDimId,\n\tFIL_remove_if_record_exists.CoverageDetailDimId,\n\tSYSDATE AS ModifiedDate\n\tFROM FIL_remove_if_record_exists\n\tLEFT JOIN LKP_reinsurance_coverage_dim\n\tON LKP_reinsurance_coverage_dim.reins_co_num = FIL_remove_if_record_exists.reins_co_number_mine_sub_IN AND LKP_reinsurance_coverage_dim.edw_reins_cov_pk_id = FIL_remove_if_record_exists.DEFAULT_ID\n),\nclaim_loss_transaction_fact_mp50_INSERT AS (\n\tINSERT INTO claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\tERR_FLAG, \n\tDEFAULT_AUDIT AS AUDIT_ID, \n\tEDW_CLAIM_TRANS_PK_ID, \n\tEDW_CLAIM_REINS_TRANS_PK_ID, \n\tCLAIM_OCCURRENCE_DIM_ID, \n\tCLAIM_OCCURRENCE_DIM_HIST_ID, \n\tCLAIMANT_DIM_ID, \n\tCLAIMANT_DIM_HIST_ID, \n\tCLAIMANT_COV_DIM_ID, \n\tCLAIMANT_COV_DIM_HIST_ID, \n\tCOV_DIM_ID, \n\tCOV_DIM_HIST_ID, \n\tlkp_claim_trans_type_dim_id AS CLAIM_TRANS_TYPE_DIM_ID, \n\tCLAIM_FINANCIAL_TYPE_DIM_ID, \n\tlkp_reins_cov_dim_id AS REINS_COV_DIM_ID, \n\tDEFAULT_ID AS REINS_COV_DIM_HIST_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tCLAIM_REP_DIM_EXAMINER_ID, \n\tCLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tCLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tCLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tCLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tCLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tCLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tPOL_DIM_ID, \n\tPOL_DIM_HIST_ID, \n\tAGENCY_DIM_ID, \n\tAGENCY_DIM_HIST_ID, \n\tCLAIM_PAY_DIM_ID, \n\tCLAIM_PAY_DIM_HIST_ID, \n\tCLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tCLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tCLAIM_CASE_DIM_ID, \n\tCLAIM_CASE_DIM_HIST_ID, \n\tCONTRACT_CUST_DIM_ID, \n\tCONTRACT_CUST_DIM_HIST_ID, \n\tCLAIM_MASTER_1099_LIST_DIM_ID, \n\tCLAIM_SUBROGATION_DIM_ID, \n\tCLAIM_TRANS_DATE_ID, \n\tCLAIM_TRANS_REPROCESS_DATE_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tCLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\tCLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tCLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tCLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tACCT_ENTERED_DATE_ID, \n\tTRANS_AMT, \n\tTRANS_HIST_AMT, \n\tTAX_ID, \n\tDIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tDIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tDIRECT_SUBROGATION_PAID, \n\tDIRECT_SUBROGATION_OUTSTANDING, \n\tDIRECT_SUBROGATION_INCURRED, \n\tDIRECT_SALVAGE_PAID, \n\tDIRECT_SALVAGE_OUTSTANDING, \n\tDIRECT_SALVAGE_INCURRED, \n\tDIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tDIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tDIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tDIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tTOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tTOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tTOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tDIRECT_OTHER_RECOVERY_PAID, \n\tDIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_INCURRED, \n\tCEDED_LOSS_PAID, \n\tCEDED_LOSS_OUTSTANDING, \n\tCEDED_LOSS_INCURRED, \n\tCEDED_ALAE_PAID, \n\tCEDED_ALAE_OUTSTANDING, \n\tCEDED_ALAE_INCURRED, \n\tCEDED_SALVAGE_PAID, \n\tCEDED_SUBROGATION_PAID, \n\tCEDED_OTHER_RECOVERY_LOSS_PAID, \n\tCEDED_OTHER_RECOVERY_ALAE_PAID, \n\tTOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tNET_LOSS_PAID, \n\tNET_LOSS_OUTSTANDING, \n\tNET_LOSS_INCURRED, \n\tNET_ALAE_PAID, \n\tNET_ALAE_OUTSTANDING, \n\tNET_ALAE_INCURRED, \n\tasl_dim_id_IN AS ASL_DIM_ID, \n\tasl_prdct_code_dim_id_IN AS ASL_PRDCT_CODE_DIM_ID, \n\tloss_master_dim_id_IN AS LOSS_MASTER_DIM_ID, \n\tSTRTGC_BUS_DVSN_DIM_ID, \n\tprdct_code_dim_id_IN AS PRDCT_CODE_DIM_ID, \n\tCLAIMRESERVEDIMID, \n\tCLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tFEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tINSURANCEREFERENCEDIMID, \n\tAGENCYDIMID, \n\tSALESDIVISIONDIMID, \n\tINSURANCEREFERENCECOVERAGEDIMID, \n\tCOVERAGEDETAILDIMID, \n\tMODIFIEDDATE\n\tFROM EXP_mp50_output\n),\nUPD_set_update AS (\n\tSELECT\n\tclaim_loss_trans_fact_id, \n\tasl_dim_id_out AS asl_dim_id, \n\tasl_prdct_code_dim_id_out AS asl_prdct_code_dim_id, \n\tloss_master_dim_id_out AS loss_master_dim_id, \n\tprdct_code_dim_id AS prdct_code_dim_id1, \n\tInsuranceReferenceDimId, \n\tAgencyDimId, \n\tSalesDivisionDimId, \n\tInsuranceReferenceCoverageDimId, \n\tCoverageDetailDimId\n\tFROM RTR_divert_MP50_Update\n),\nclaim_loss_transaction_fact_UPDATE_PMSClaims AS (\n\tMERGE INTO claim_loss_transaction_fact AS T\n\tUSING UPD_set_update AS S\n\tON T.claim_loss_trans_fact_id = S.claim_loss_trans_fact_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.asl_dim_id = S.asl_dim_id, T.asl_prdct_code_dim_id = S.asl_prdct_code_dim_id, T.loss_master_dim_id = S.loss_master_dim_id, T.prdct_code_dim_id = S.prdct_code_dim_id1, T.InsuranceReferenceDimId = S.InsuranceReferenceDimId, T.AgencyDimId = S.AgencyDimId, T.SalesDivisionDimId = S.SalesDivisionDimId, T.InsuranceReferenceCoverageDimId = S.InsuranceReferenceCoverageDimId, T.CoverageDetailDimId = S.CoverageDetailDimId, T.ModifiedDate = S.ModifiedDate3\n),\nSQ_EDWSource_DCTClaims AS (\n\tSELECT CLTF.claim_loss_trans_fact_id   AS claim_loss_trans_fact_id,\r\n\t\t   CT.claim_trans_id\t\t\t   AS claim_trans_id,\r\n\t\t   AB.claimant_cov_det_ak_id       AS Claimant_cov_det_ak_id,\r\n\t\t   AB.claim_party_occurrence_ak_id AS claim_party_occurrence_ak_id,\r\n\t       AB.PolicySourceID               AS Policysourceid,\r\n\t       AB.ClassCode                    AS Classcode,\r\n\t       AB.SublineCode                  AS Sublinecode,\r\n\t       RC.Exposure                     AS Exposure,\r\n\t       RC.AnnualStatementLineNumber    AS AnnualStatementLineNumber,\r\n\t       RC.SchedulePNumber              AS SchedulePNumber,\r\n\t       RC.AnnualStatementLineCode      AS AnnualStatementLineCode,\r\n\t       RC.SubAnnualStatementLineNumber AS SubAnnualStatementLineNumber,\r\n\t       RC.SubAnnualStatementLineCode   AS SubAnnualStatementLineCode,\r\n\t       RC.SubNonAnnualStatementLineCode AS SubNonAnnualStatementLineCode,\r\n\t       RL.RiskTerritory                AS Riskterritory,\r\n\t       RL.StateProvinceCode            AS Stateprovincecode,\r\n\t       RL.ZipPostalCode                AS Zippostalcode,\r\n\t       RL.TaxLocation                  AS Taxlocation,\r\n\t       SPC.StrategicProfitCenterCode   AS StrategicProfitCenterCode,\r\n\t       PDT.ProductCode                 AS ProductCode,\r\n\t       LOB.InsuranceReferenceLineOfBusinessCode AS InsuranceReferenceLineOfBusinessCode,\r\n\tAB.cause_of_loss AS cause_of_loss \r\n\tFROM   @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF  INNER JOIN \r\n\t       @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.VW_claim_transaction CT  ON CLTF.edw_claim_trans_pk_id = CT.claim_trans_id\r\n\t       INNER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CLAIMANT_COVERAGE_DETAIL AB ON CT.Claimant_cov_det_ak_id = AB.Claimant_cov_det_ak_id\r\n\t       INNER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party_occurrence CPO ON CPO.claim_party_occurrence_ak_id = AB.claim_party_occurrence_ak_id\r\n\t       INNER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence CO ON CO.claim_occurrence_ak_id = CPO.claim_occurrence_ak_id\r\n\t       INNER JOIN @{pipeline().parameters.DB_NAME_EDW}.V2.policy P ON CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t   left JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.RatingCoverage RC ON AB.RatingCoverageAKId = RC.RatingCoverageAKID \r\n\t\t   AND RC.CurrentSnapshotFlag =1\r\n\t\t   left JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.POLICYCOVERAGE Pc ON RC.PolicyCoverageAKID = PC.PolicyCoverageAKID AND Pc.CurrentSnapshotFlag =1\r\n\t\t   left JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.RISKLOCATION Rl ON PC.RiskLocationAKID = RL.RiskLocationAKID AND Rl.CurrentSnapshotFlag =1\r\n\t\t   LEFT OUTER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.StrategicProfitCenter SPC ON P.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId\r\n\t\t   LEFT OUTER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceLineOfBusiness LOB ON RC.InsuranceReferenceLineOfBusinessAKId = LOB.InsuranceReferenceLineOfBusinessAKId\r\n\t\t   LEFT OUTER JOIN @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.TARGET_TABLE_OWNER}.Product PDT ON PDT.ProductAKId = RC.ProductAKId\r\n\tWHERE AB.PolicySourceID IN ( 'PDC', 'DUC' )\r\n\t      AND P.crrnt_snpsht_flag =1\r\n\t      AND SPC.CurrentSnapshotFlag =1\r\n\t      AND AB.crrnt_snpsht_flag = 1\r\n\t      AND CPO.crrnt_snpsht_flag = 1\r\n\t      AND CO.crrnt_snpsht_flag = 1\r\n\tAND  (CLTF.asl_dim_id in (0,-1) or CLTF.strtgc_bus_dvsn_dim_id in (0,-1) or  CLTF.loss_master_dim_id in (0,-1) or CLTF.prdct_code_dim_id in (0,-1)\r\n\t\t\t)\n),\nEXP_Default AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\tclaim_trans_id,\n\tclaimant_cov_det_ak_id,\n\tclaim_party_occurrence_ak_id,\n\tPolicySourceID,\n\tClassCode,\n\tSublineCode,\n\tRiskTerritory,\n\tStateProvinceCode,\n\tZipPostalCode,\n\tTaxLocation,\n\tExposure,\n\tStrategicProfitCenterCode,\n\tProductCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\t'N/A' AS Default_NA,\n\tAnnualStatementLineNumber1 AS AnnualStatementLineNumber,\n\tSchedulePNumber,\n\tAnnualStatementLineCode,\n\tSubAnnualStatementLineNumber,\n\tSubAnnualStatementLineCode,\n\tSubNonAnnualStatementLineCode,\n\tcause_of_loss,\n\t-- *INF*: IIF(in(cause_of_loss,'05','75'),'1','0')\n\tIFF(in(cause_of_loss, '05', '75'), '1', '0') AS v_Indemnity,\n\t-- *INF*: IIF(in(cause_of_loss,'06','07'),'1','0')\n\tIFF(in(cause_of_loss, '06', '07'), '1', '0') AS v_Medical,\n\t-- *INF*: IIF(AnnualStatementLineCode='160',\r\n\t-- DECODE('1',v_Indemnity,'180',v_Medical,'190','999'),\r\n\t-- \t\tSubAnnualStatementLineCode)\n\tIFF(AnnualStatementLineCode = '160', DECODE('1',\n\tv_Indemnity, '180',\n\tv_Medical, '190',\n\t'999'), SubAnnualStatementLineCode) AS o_sub_asl_code\n\tFROM SQ_EDWSource_DCTClaims\n),\nLKP_Produc_Code_Dim AS (\n\tSELECT\n\tprdct_code_dim_id,\n\tprdct_code\n\tFROM (\n\t\tSELECT \n\t\t\tprdct_code_dim_id,\n\t\t\tprdct_code\n\t\tFROM product_code_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY prdct_code ORDER BY prdct_code_dim_id DESC) = 1\n),\nLKP_asl_dim_DuckCreekClaims AS (\n\tSELECT\n\tasl_dim_id,\n\tasl_code,\n\tsub_asl_code,\n\tsub_non_asl_code\n\tFROM (\n\t\tSELECT \r\n\t\tasl_dim.asl_code as asl_code, \r\n\t\tasl_dim.asl_dim_id as asl_dim_id, \r\n\t\tasl_dim.sub_asl_code as sub_asl_code, \r\n\t\tasl_dim.sub_non_asl_code as sub_non_asl_code \r\n\t\tFROM asl_dim\r\n\t\twhere \r\n\t\tasl_dim.crrnt_snpsht_flag ='1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY asl_code,sub_asl_code,sub_non_asl_code ORDER BY asl_dim_id DESC) = 1\n),\nLKP_loss_master_dim_DuckCreekClaims AS (\n\tSELECT\n\tloss_master_dim_id,\n\trisk_state_prov_code,\n\trisk_zip_code,\n\tterr_code,\n\ttax_loc,\n\tclass_code,\n\texposure,\n\tsub_line_code,\n\tsource_sar_asl,\n\tsource_sar_prdct_line,\n\tsource_sar_sp_use_code,\n\tsource_statistical_line,\n\tvariation_code,\n\tpol_type,\n\tauto_reins_facility,\n\tstatistical_brkdwn_line,\n\tstatistical_code1,\n\tstatistical_code2,\n\tstatistical_code3,\n\tloss_master_cov_code\n\tFROM (\n\t\tSELECT loss_master_dim.loss_master_dim_id      AS loss_master_dim_id,\r\n\t\t       ltrim(rtrim(loss_master_dim.risk_state_prov_code))    AS risk_state_prov_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.risk_zip_code))           AS risk_zip_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.terr_code))               AS terr_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.tax_loc))                 AS tax_loc,\r\n\t\t       ltrim(rtrim(loss_master_dim.class_code))              AS class_code,\r\n\t\t       loss_master_dim.exposure                AS exposure,\r\n\t\t       ltrim(rtrim(loss_master_dim.sub_line_code))           AS sub_line_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_asl))          AS source_sar_asl,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_prdct_line))   AS source_sar_prdct_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_sar_sp_use_code))  AS source_sar_sp_use_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.source_statistical_line)) AS source_statistical_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.variation_code))          AS variation_code,\r\n\t\t       ltrim(rtrim(loss_master_dim.pol_type))                AS pol_type,\r\n\t\t       ltrim(rtrim(loss_master_dim.auto_reins_facility))     AS auto_reins_facility,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_brkdwn_line)) AS statistical_brkdwn_line,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code1))       AS statistical_code1,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code2))       AS statistical_code2,\r\n\t\t       ltrim(rtrim(loss_master_dim.statistical_code3))       AS statistical_code3,\r\n\t\t       ltrim(rtrim(loss_master_dim.loss_master_cov_code))    AS loss_master_cov_code\r\n\t\tFROM   loss_master_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY risk_state_prov_code,risk_zip_code,terr_code,tax_loc,class_code,exposure,sub_line_code,source_sar_asl,source_sar_prdct_line,source_sar_sp_use_code,source_statistical_line,variation_code,pol_type,auto_reins_facility,statistical_brkdwn_line,statistical_code1,statistical_code2,statistical_code3,loss_master_cov_code ORDER BY loss_master_dim_id DESC) = 1\n),\nLKP_strategic_business_division_dim AS (\n\tSELECT\n\tstrtgc_bus_dvsn_dim_id,\n\tstrtgc_bus_dvsn_code\n\tFROM (\n\t\tSELECT strategic_business_division_dim.strtgc_bus_dvsn_dim_id as strtgc_bus_dvsn_dim_id, strategic_business_division_dim.strtgc_bus_dvsn_code as strtgc_bus_dvsn_code FROM strategic_business_division_dim\r\n\t\tWHERE\r\n\t\tpol_sym_1 = 'N/A'\r\n\t\t\r\n\t\t--- We are filtering the records as we need to tie to DuckCreek Claims.\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY strtgc_bus_dvsn_code ORDER BY strtgc_bus_dvsn_dim_id DESC) = 1\n),\nEXP_Values AS (\n\tSELECT\n\tEXP_Default.claim_loss_trans_fact_id,\n\tEXP_Default.claim_trans_id,\n\tLKP_loss_master_dim_DuckCreekClaims.loss_master_dim_id,\n\t-- *INF*: IIF(ISNULL(loss_master_dim_id),-1,loss_master_dim_id)\n\tIFF(loss_master_dim_id IS NULL, - 1, loss_master_dim_id) AS loss_master_dim_id_out,\n\tEXP_Default.AnnualStatementLineNumber,\n\tEXP_Default.SchedulePNumber,\n\tEXP_Default.SubAnnualStatementLineNumber,\n\tLKP_asl_dim_DuckCreekClaims.asl_dim_id,\n\t-- *INF*: IIF(ISNULL(asl_dim_id),-1,asl_dim_id)\r\n\t-- \n\tIFF(asl_dim_id IS NULL, - 1, asl_dim_id) AS asl_dim_id_Out,\n\tLKP_strategic_business_division_dim.strtgc_bus_dvsn_dim_id,\n\t-- *INF*: IIF(ISNULL(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_Out,\n\tLKP_Produc_Code_Dim.prdct_code_dim_id,\n\t-- *INF*: IIF(ISNULL(prdct_code_dim_id),-1,prdct_code_dim_id)\n\tIFF(prdct_code_dim_id IS NULL, - 1, prdct_code_dim_id) AS prdct_code_dim_id_Out,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_Default\n\tLEFT JOIN LKP_Produc_Code_Dim\n\tON LKP_Produc_Code_Dim.prdct_code = EXP_Default.ProductCode\n\tLEFT JOIN LKP_asl_dim_DuckCreekClaims\n\tON LKP_asl_dim_DuckCreekClaims.asl_code = EXP_Default.AnnualStatementLineCode AND LKP_asl_dim_DuckCreekClaims.sub_asl_code = EXP_Default.o_sub_asl_code AND LKP_asl_dim_DuckCreekClaims.sub_non_asl_code = EXP_Default.SubNonAnnualStatementLineCode\n\tLEFT JOIN LKP_loss_master_dim_DuckCreekClaims\n\tON LKP_loss_master_dim_DuckCreekClaims.risk_state_prov_code = EXP_Default.StateProvinceCode AND LKP_loss_master_dim_DuckCreekClaims.risk_zip_code = EXP_Default.ZipPostalCode AND LKP_loss_master_dim_DuckCreekClaims.terr_code = EXP_Default.RiskTerritory AND LKP_loss_master_dim_DuckCreekClaims.tax_loc = EXP_Default.TaxLocation AND LKP_loss_master_dim_DuckCreekClaims.class_code = EXP_Default.ClassCode AND LKP_loss_master_dim_DuckCreekClaims.exposure = EXP_Default.Exposure AND LKP_loss_master_dim_DuckCreekClaims.sub_line_code = EXP_Default.SublineCode AND LKP_loss_master_dim_DuckCreekClaims.source_sar_asl = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.source_sar_prdct_line = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.source_sar_sp_use_code = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.source_statistical_line = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.variation_code = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.pol_type = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.auto_reins_facility = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.statistical_brkdwn_line = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.statistical_code1 = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.statistical_code2 = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.statistical_code3 = EXP_Default.Default_NA AND LKP_loss_master_dim_DuckCreekClaims.loss_master_cov_code = EXP_Default.Default_NA\n\tLEFT JOIN LKP_strategic_business_division_dim\n\tON LKP_strategic_business_division_dim.strtgc_bus_dvsn_code = EXP_Default.StrategicProfitCenterCode\n),\nAGG_Remove_Duplicate AS (\n\tSELECT\n\tclaim_loss_trans_fact_id, \n\tasl_dim_id_Out AS asl_dim_id, \n\tloss_master_dim_id_out AS loss_master_dim_id, \n\tstrtgc_bus_dvsn_dim_id_Out AS strtgc_bus_dvsn_dim_id, \n\tprdct_code_dim_id_Out AS prdct_code_dim_id, \n\tModifiedDate\n\tFROM EXP_Values\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_loss_trans_fact_id, asl_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id ORDER BY NULL) = 1\n),\nUPD_ASLID_LossMasterDimID AS (\n\tSELECT\n\tclaim_loss_trans_fact_id, \n\tasl_dim_id, \n\tloss_master_dim_id, \n\tstrtgc_bus_dvsn_dim_id, \n\tprdct_code_dim_id, \n\tModifiedDate\n\tFROM AGG_Remove_Duplicate\n),\nclaim_loss_transaction_fact_UPDATE_DCTClaims AS (\n\tMERGE INTO claim_loss_transaction_fact AS T\n\tUSING UPD_ASLID_LossMasterDimID AS S\n\tON T.claim_loss_trans_fact_id = S.claim_loss_trans_fact_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.asl_dim_id = S.asl_dim_id, T.loss_master_dim_id = S.loss_master_dim_id, T.strtgc_bus_dvsn_dim_id = S.strtgc_bus_dvsn_dim_id, T.prdct_code_dim_id = S.prdct_code_dim_id, T.ModifiedDate = S.ModifiedDate\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604481"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_CLAIM"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_DATA_MART_CLAIM"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "EXCEED AND PMS"
            },
            "DBCONNECTION_STAGE": {
                "type": "string",
                "defaultValue": "SQLServer_WC_STAGE_Claim"
            },
            "DB_NAME_DATAMART": {
                "type": "string",
                "defaultValue": "WC_Data_Mart"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "RPT_EDM"
            },
            "MP_210_211": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_249_250": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_220_230": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_260_261": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_100_130": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_140_143": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_145_149": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_151_163": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_170_178": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_271_274": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_930_931": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "GARAGE_SUBLINES": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_145_146": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_148_160": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_163_166": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_170_173": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_269_270": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_145_159": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_165_166": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "RISK_UNIT_GRP_CL_EQ": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SUB_325_335": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SUB_342_350": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SUB_313_315": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_901_904": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_145_160": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_148_155": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_157_160": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_100_125": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_151_155": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_157_163": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_145_155": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_100_121": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_101_103": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_114_119": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_110_112": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_120_125": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "MP_120_121": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}