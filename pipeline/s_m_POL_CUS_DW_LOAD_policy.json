{
    "name": "s_m_POL_CUS_DW_LOAD_policy",
    "properties": {
        "activities": [
            {
                "name": "m_POL_CUS_DW_LOAD_policy",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_PolicyOfferingCode AS (\n\tSELECT\n\tPolicyOfferingCode,\n\tSequenceNumber,\n\tIdentifiers\n\tFROM (\n\t\tSELECT PolicyOfferingCode as PolicyOfferingCode,\r\n\t\tSequenceNumber as SequenceNumber,\r\n\t\t(\r\n\t\tCASE WHEN SequenceNumber=1 THEN PolicySymbol\r\n\t\tWHEN SequenceNumber=2 THEN PolicySymbol\r\n\t\tWHEN SequenceNumber=3 THEN PolicySymbol+'&'+RiskUnitGroup\r\n\t\tWHEN SequenceNumber=4 THEN PolicySymbol+'&'+RiskUnitGroup+'&'+InsuranceLine\r\n\t\tWHEN SequenceNumber=5 THEN PolicySymbol+'&'+SublineCode+'&'+InsuranceLine+'&'+ClassCode\r\n\t\tWHEN SequenceNumber=6 THEN PolicySymbol+'&'+InsuranceLine+'&'+MajorPerilCode\r\n\t\tWHEN SequenceNumber=7 THEN PolicySymbol\r\n\t\tWHEN SequenceNumber=8 THEN PolicySymbol\r\n\t\tWHEN SequenceNumber=9 THEN PolicySymbol+'&'+SublineCode+'&'+InsuranceLine\r\n\t\tWHEN SequenceNumber IN (10 ,11) THEN PolicySymbol+'&'+InsuranceLine+'&'+ RiskUnitGroup\r\n\t\tWHEN SequenceNumber=12 THEN PolicySymbol\r\n\t\tEND\r\n\t\t) as Identifiers\r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupPolicyOfferingRules\r\n\t\tWHERE CurrentSnapshotFlag=1 and SourceCode='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SequenceNumber,Identifiers ORDER BY PolicyOfferingCode) = 1\n),\nLKP_StrategicProfitCenter AS (\n\tSELECT\n\tStrategicProfitCenterAbbreviation,\n\tStrategicProfitCenterAKId\n\tFROM (\n\t\tSELECT \n\t\t\tStrategicProfitCenterAbbreviation,\n\t\t\tStrategicProfitCenterAKId\n\t\tFROM StrategicProfitCenter\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StrategicProfitCenterAKId ORDER BY StrategicProfitCenterAbbreviation) = 1\n),\nLKP_PolicyOfferingAKId AS (\n\tSELECT\n\tPolicyOfferingAKId,\n\tPolicyOfferingCode\n\tFROM (\n\t\tSELECT \n\t\t\tPolicyOfferingAKId,\n\t\t\tPolicyOfferingCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.PolicyOffering\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyOfferingCode ORDER BY PolicyOfferingAKId) = 1\n),\nLKP_Pif02_MaxDate AS (\n\tSELECT\n\tpif_date_time_stamp,\n\tID\n\tFROM (\n\t\tselect max(substring(convert(varchar(16),pif_date_time_stamp),1,8)) as pif_date_time_stamp, 1 as id\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_02_stage--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ID ORDER BY pif_date_time_stamp) = 1\n),\nLKP_sup_policy_issue_code AS (\n\tSELECT\n\tsup_pol_issue_code_id,\n\tpol_issue_code\n\tFROM (\n\t\tSELECT \n\t\t\tsup_pol_issue_code_id,\n\t\t\tpol_issue_code\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_policy_issue_code\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_issue_code ORDER BY sup_pol_issue_code_id) = 1\n),\nSQ_pif_02_stage AS (\n\tSELECT pif_symbol, \r\n\t       pif_policy_number, \r\n\t       pif_module, \r\n\t       pif_master_co_number_a, \r\n\t       pif_location_a, \r\n\t       pif_amend_number, \r\n\t       pif_eff_yr_a, \r\n\t       pif_eff_mo_a, \r\n\t       pif_eff_da_a, \r\n\t       pif_exp_yr_a, \r\n\t       pif_exp_mo_a, \r\n\t       pif_exp_da_a, \r\n\t       pif_installment_term_a, \r\n\t       pif_risk_state_prov, \r\n\t       pif_company_number, \r\n\t       pif_full_agency_number, \r\n\t       pif_ent_yr_a, \r\n\t       pif_ent_mo_a, \r\n\t       pif_ent_da_a, \r\n\t       pif_line_business, \r\n\t       pif_issue_code, \r\n\t       pif_company_line, \r\n\t       pif_pay_service_code,\r\n\t       pif_audit_code, \r\n\t       pif_variation_code, \r\n\t       pif_producer_code, \r\n\t       pif_review_code, \r\n\t       pif_mvr_report_year, \r\n\t       pif_risk_grade_guide, \r\n\t       pif_renewal_code, \r\n\t       pif_reason_amended,\r\n\t       pif_renew_policy_symbol, \r\n\t       pif_renew_policy_number, \r\n\t       pif_original_incept, \r\n\t       wb_class_of_business, \r\n\t       pif_guarantee_ind, \r\n\t       wb_renewal_discount, \r\n\t       wb_inview_indicator, \r\n\t       pif_occupation, \r\n\t       pif_final_audit_ind, \r\n\t       pif_excess_claim_ind, \r\n\t       pif_anniversary_rerate, \r\n\t       pif_policy_status_on_pif, \r\n\t       pif_uk_postal_code, \r\n\t       pif_nonsmoker_discount, \r\n\t       pif_upload_audit, \r\n\t       pif_zip_ind, \r\n\t       pif_prgm_id, \r\n\t       pif_wbc_county, \r\n\t       pif_orig_act_date, \r\n\t       pif_fn_date, \r\n\t       pif_terrorism_risk, \r\n\t       pif_target_market_code, \r\n\t       pif_completed_audit_date, \r\n\t       pif_seg_id, \r\n\t       pif_service_center,\r\n\t       pif_renewal_safe_record_ctr,\r\n\t       pif_dc_bill_ind,\r\n\t       row_number() over (partition by pif_symbol, pif_policy_number, pif_module order by sar_acct_entrd_date,pif_4514_stage_id ASC) RN_sar_acct_entrd_date_MaxToMin,\r\n\t       sar_acct_entrd_date,\r\n\t       sar_insurance_line,\r\n\t       sar_risk_unit_group,\r\n\t       sar_major_peril,\r\n\t       sar_class_1_4,\r\n\t       sar_class_5_6 ,\r\n\t       sar_sub_line\r\n\tfrom (\r\n\tSELECT distinct pif_02_stage.pif_symbol, \r\n\t       pif_02_stage.pif_policy_number, \r\n\t       pif_02_stage.pif_module, \r\n\t       pif_02_stage.pif_master_co_number_a, \r\n\t       pif_02_stage.pif_location_a, \r\n\t       pif_02_stage.pif_amend_number, \r\n\t       pif_02_stage.pif_eff_yr_a, \r\n\t       pif_02_stage.pif_eff_mo_a, \r\n\t       pif_02_stage.pif_eff_da_a, \r\n\t       pif_02_stage.pif_exp_yr_a, \r\n\t       pif_02_stage.pif_exp_mo_a, \r\n\t       pif_02_stage.pif_exp_da_a, \r\n\t       pif_02_stage.pif_installment_term_a, \r\n\t       pif_02_stage.pif_risk_state_prov, \r\n\t       pif_02_stage.pif_company_number, \r\n\t       pif_02_stage.pif_full_agency_number, \r\n\t       pif_02_stage.pif_ent_yr_a, \r\n\t       pif_02_stage.pif_ent_mo_a, \r\n\t       pif_02_stage.pif_ent_da_a, \r\n\t       pif_02_stage.pif_line_business, \r\n\t       pif_02_stage.pif_issue_code, \r\n\t       pif_02_stage.pif_company_line, \r\n\t       pif_02_stage.pif_pay_service_code,\r\n\t       pif_02_stage.pif_audit_code, \r\n\t       pif_02_stage.pif_variation_code, \r\n\t       pif_02_stage.pif_producer_code, \r\n\t       pif_02_stage.pif_review_code, \r\n\t       pif_02_stage.pif_mvr_report_year, \r\n\t       pif_02_stage.pif_risk_grade_guide, \r\n\t       pif_02_stage.pif_renewal_code, \r\n\t       pif_02_stage.pif_reason_amended,\r\n\t       pif_02_stage.pif_renew_policy_symbol, \r\n\t       pif_02_stage.pif_renew_policy_number, \r\n\t       pif_02_stage.pif_original_incept, \r\n\t       pif_02_stage.wb_class_of_business, \r\n\t       pif_02_stage.pif_guarantee_ind, \r\n\t       pif_02_stage.wb_renewal_discount, \r\n\t       pif_02_stage.wb_inview_indicator, \r\n\t       pif_02_stage.pif_occupation, \r\n\t       pif_02_stage.pif_final_audit_ind, \r\n\t       pif_02_stage.pif_excess_claim_ind, \r\n\t       pif_02_stage.pif_anniversary_rerate, \r\n\t       pif_02_stage.pif_policy_status_on_pif, \r\n\t       pif_02_stage.pif_uk_postal_code, \r\n\t       pif_02_stage.pif_nonsmoker_discount, \r\n\t       pif_02_stage.pif_upload_audit, \r\n\t       pif_02_stage.pif_zip_ind, \r\n\t       pif_02_stage.pif_prgm_id, \r\n\t       pif_02_stage.pif_wbc_county, \r\n\t       pif_02_stage.pif_orig_act_date, \r\n\t       pif_02_stage.pif_fn_date, \r\n\t       pif_02_stage.pif_terrorism_risk, \r\n\t       pif_02_stage.pif_target_market_code, \r\n\t       pif_02_stage.pif_completed_audit_date, \r\n\t       pif_02_stage.pif_seg_id, \r\n\t       pif_02_stage.pif_service_center,\r\n\t       pif_02_stage.pif_date_time_stamp,\r\n\t       pif_02_stage.pif_renewal_safe_record_ctr,\r\n\t       pif_02_stage.pif_dc_bill_ind,\r\n\t       pif_4514_stage.pif_4514_stage_id,\r\n\t       pif_4514_stage.sar_acct_entrd_date,\r\n\t       pif_4514_stage.sar_insurance_line,\r\n\t       pif_4514_stage.sar_risk_unit_group,\r\n\t       pif_4514_stage.sar_major_peril,\r\n\t       pif_4514_stage.sar_class_1_4,\r\n\t       pif_4514_stage.sar_class_5_6 ,\r\n\t       pif_4514_stage.sar_sub_line\r\n\t       FROM\r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_02_stage \r\n\t       left join @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_4514_stage \r\n\t\t on pif_02_stage.pif_symbol=pif_4514_stage.pif_symbol and pif_02_stage.pif_policy_number=pif_4514_stage.pif_policy_number and pif_02_stage.pif_module=pif_4514_stage.pif_module\t\r\n\t       WHERE \r\n\t        (LTRIM(RTRIM(pif_02_stage.pif_eff_yr_a)) <> '9999'or \r\n\t\tLTRIM(RTRIM(pif_02_stage.pif_exp_yr_a)) <> '9999')and\r\n\t\tLTRIM(RTRIM(SUBSTRING(CAST(pif_02_stage.pif_full_agency_number AS char(7)),1,2)+SUBSTRING(CAST(pif_02_stage.pif_full_agency_number AS char(7)),5,3)))<>'99999'\r\n\t---------------------------------------------\r\n\t--AND pif_02_stage.pif_symbol  + pif_02_stage.pif_policy_number  +     pif_02_stage.pif_module  IN  ('A0S189678900')\r\n\t---------------------------------------------\r\n\t) Src\r\n\tORDER BY pif_symbol, \r\n\t       pif_policy_number, \r\n\t       pif_module, \r\n\t       sar_acct_entrd_date\r\n\t\r\n\t\r\n\t--  We are reading those rows from .pif_02_stage where (pif_eff_yr_a or pif_exp_yr_a) <> '9999' and pif_full_agency_number \r\n\t-- <>'99999'\n),\nLKP_PIF_04Stage AS (\n\tSELECT\n\tUNDND_UNDERWRITER_ID,\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE\n\tFROM (\n\t\tSELECT PIF_04Stage.pif_symbol AS pif_symbol,\r\n\t\t\tPIF_04Stage.pif_policy_number AS pif_policy_number,\r\n\t\t       PIF_04Stage.pif_module AS pif_module,\r\n\t\t       PIF_04Stage.UNDND_UNDERWRITER_ID AS UNDND_UNDERWRITER_ID\r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.PIF_04Stage\r\n\t\tORDER BY pif_symbol,pif_policy_number,pif_module,PIF04StageId--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PIF_SYMBOL,PIF_POLICY_NUMBER,PIF_MODULE ORDER BY UNDND_UNDERWRITER_ID DESC) = 1\n),\nLKP_pif_03_stage AS (\n\tSELECT\n\tcomments_reason_suspended,\n\tcomments_area,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module\n\tFROM (\n\t\tSELECT pif_03_stage.pif_symbol AS pif_symbol,\r\n\t\t       pif_03_stage.pif_policy_number AS pif_policy_number,\r\n\t\t       pif_03_stage.pif_module AS pif_module,\r\n\t\t       pif_03_stage.comments_reason_suspended AS comments_reason_suspended,\r\n\t\t       pif_03_stage.comments_area AS comments_area\r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_03_stage\r\n\t\tORDER BY pif_symbol,pif_policy_number,pif_module,pif_03_stage_id--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module ORDER BY comments_reason_suspended DESC) = 1\n),\nLKP_pif_43gj_stage AS (\n\tSELECT\n\tpmd4j_use_code,\n\tpmd4j_address_line_1,\n\tpmd4j_addr_lin_2_pos_1,\n\tpmd4j_addr_lin_2_pos_2_30,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module\n\tFROM (\n\t\tSELECT pif_43gj_stage.pif_symbol AS pif_symbol,\r\n\t\t       pif_43gj_stage.pif_policy_number AS pif_policy_number,\r\n\t\t       pif_43gj_stage.pif_module AS pif_module,\r\n\t\t       pif_43gj_stage.pmd4j_use_code AS pmd4j_use_code,\r\n\t\t       pif_43gj_stage.pmd4j_address_line_1 AS pmd4j_address_line_1,\r\n\t\t       pif_43gj_stage.pmd4j_addr_lin_2_pos_1 AS pmd4j_addr_lin_2_pos_1,\r\n\t\t       pif_43gj_stage.pmd4j_addr_lin_2_pos_2_30 AS pmd4j_addr_lin_2_pos_2_30\r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_43gj_stage\r\n\t\tORDER BY pif_symbol,pif_policy_number,pif_module,pif_43gj_stage_id--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module ORDER BY pmd4j_use_code DESC) = 1\n),\nEXP_PolicyOfferingAKId AS (\n\tSELECT\n\tSQ_pif_02_stage.pif_symbol,\n\tSQ_pif_02_stage.pif_policy_number,\n\tSQ_pif_02_stage.pif_module,\n\tSQ_pif_02_stage.pif_master_co_number_a,\n\tSQ_pif_02_stage.pif_location_a,\n\tSQ_pif_02_stage.pif_amend_number,\n\tSQ_pif_02_stage.pif_eff_yr_a,\n\tSQ_pif_02_stage.pif_eff_mo_a,\n\tSQ_pif_02_stage.pif_eff_da_a,\n\tSQ_pif_02_stage.pif_exp_yr_a,\n\tSQ_pif_02_stage.pif_exp_mo_a,\n\tSQ_pif_02_stage.pif_exp_da_a,\n\tSQ_pif_02_stage.pif_installment_term_a,\n\tSQ_pif_02_stage.pif_risk_state_prov,\n\tSQ_pif_02_stage.pif_company_number,\n\tSQ_pif_02_stage.pif_full_agency_number,\n\tSQ_pif_02_stage.pif_ent_yr_a,\n\tSQ_pif_02_stage.pif_ent_mo_a,\n\tSQ_pif_02_stage.pif_ent_da_a,\n\tSQ_pif_02_stage.pif_line_business,\n\tSQ_pif_02_stage.pif_issue_code,\n\tSQ_pif_02_stage.pif_company_line,\n\tSQ_pif_02_stage.pif_pay_service_code,\n\tSQ_pif_02_stage.pif_audit_code,\n\tSQ_pif_02_stage.pif_variation_code,\n\tSQ_pif_02_stage.pif_producer_code,\n\tSQ_pif_02_stage.pif_review_code,\n\tSQ_pif_02_stage.pif_mvr_report_year,\n\tSQ_pif_02_stage.pif_risk_grade_guide,\n\tSQ_pif_02_stage.pif_renewal_code,\n\tSQ_pif_02_stage.pif_reason_amended,\n\tSQ_pif_02_stage.pif_renew_policy_symbol,\n\tSQ_pif_02_stage.pif_renew_policy_number,\n\tSQ_pif_02_stage.pif_original_incept,\n\tSQ_pif_02_stage.wb_class_of_business,\n\tSQ_pif_02_stage.pif_guarantee_ind,\n\tSQ_pif_02_stage.wb_renewal_discount,\n\tSQ_pif_02_stage.wb_inview_indicator,\n\tSQ_pif_02_stage.pif_occupation,\n\tSQ_pif_02_stage.pif_final_audit_ind,\n\tSQ_pif_02_stage.pif_excess_claim_ind,\n\tSQ_pif_02_stage.pif_anniversary_rerate,\n\tSQ_pif_02_stage.pif_policy_status_on_pif,\n\tSQ_pif_02_stage.pif_uk_postal_code,\n\tSQ_pif_02_stage.pif_nonsmoker_discount,\n\tSQ_pif_02_stage.pif_upload_audit,\n\tSQ_pif_02_stage.pif_zip_ind,\n\tSQ_pif_02_stage.pif_prgm_id,\n\tSQ_pif_02_stage.pif_wbc_county,\n\tSQ_pif_02_stage.pif_orig_act_date,\n\tSQ_pif_02_stage.pif_fn_date,\n\tSQ_pif_02_stage.pif_terrorism_risk,\n\tSQ_pif_02_stage.pif_target_market_code,\n\tSQ_pif_02_stage.pif_completed_audit_date,\n\tSQ_pif_02_stage.pif_seg_id,\n\tSQ_pif_02_stage.pif_renewal_safe_record_ctr,\n\tSQ_pif_02_stage.pif_dc_bill_ind,\n\tSQ_pif_02_stage.RN_sar_acct_entrd_date_MaxToMin AS in_RN_sar_acct_entrd_date_MaxToMin,\n\tSQ_pif_02_stage.sar_acct_entrd_date AS in_sar_acct_entrd_date,\n\tSQ_pif_02_stage.sar_insurance_line AS in_sar_insurance_line_4514,\n\tSQ_pif_02_stage.sar_risk_unit_group AS in_sar_risk_unit_group_4514,\n\tSQ_pif_02_stage.sar_major_peril AS in_sar_major_peril_4514,\n\tSQ_pif_02_stage.sar_class_1_4 AS in_sar_class_1_4_4514,\n\tSQ_pif_02_stage.sar_class_5_6 AS in_sar_class_5_6_4514,\n\tSQ_pif_02_stage.sar_sub_line AS in_sar_sub_line_4514,\n\tLKP_pif_43gj_stage.pmd4j_use_code AS in_pmd4j_use_code,\n\tLKP_pif_43gj_stage.pmd4j_address_line_1 AS in_pmd4j_address_line_1,\n\tLKP_pif_43gj_stage.pmd4j_addr_lin_2_pos_1 AS in_pmd4j_addr_lin_2_pos_1,\n\tLKP_pif_43gj_stage.pmd4j_addr_lin_2_pos_2_30 AS in_pmd4j_addr_lin_2_pos_2_30,\n\tLKP_pif_03_stage.comments_reason_suspended AS in_comments_reason_suspended,\n\tLKP_pif_03_stage.comments_area AS in_comments_area,\n\tLKP_PIF_04Stage.UNDND_UNDERWRITER_ID AS in_UNDND_UNDERWRITER_ID,\n\t-- *INF*: LTRIM(RTRIM(in_UNDND_UNDERWRITER_ID))\n\tLTRIM(RTRIM(in_UNDND_UNDERWRITER_ID)) AS v_UNDND_UNDERWRITER_ID,\n\t-- *INF*: SUBSTR(ltrim(rtrim(pif_symbol)), 1, 1)\n\tSUBSTR(ltrim(rtrim(pif_symbol)), 1, 1) AS v_pif_symbol_02_F1,\n\t-- *INF*: SUBSTR(ltrim(rtrim(pif_symbol)), 1, 2)\n\tSUBSTR(ltrim(rtrim(pif_symbol)), 1, 2) AS v_pif_symbol_02_F2,\n\t-- *INF*: ltrim(rtrim(in_sar_insurance_line_4514))\n\tltrim(rtrim(in_sar_insurance_line_4514)) AS v_sar_insurance_line_4514,\n\t-- *INF*: ltrim(rtrim(in_sar_risk_unit_group_4514))\n\tltrim(rtrim(in_sar_risk_unit_group_4514)) AS v_sar_risk_unit_group_4514,\n\t-- *INF*: ltrim(rtrim(in_sar_major_peril_4514))\n\tltrim(rtrim(in_sar_major_peril_4514)) AS v_sar_major_peril_4514,\n\t-- *INF*: ltrim(rtrim(in_sar_class_1_4_4514))\n\tltrim(rtrim(in_sar_class_1_4_4514)) AS v_sar_class_1_4_4514,\n\t-- *INF*: ltrim(rtrim(in_sar_class_5_6_4514))\n\tltrim(rtrim(in_sar_class_5_6_4514)) AS v_sar_class_5_6_4514,\n\t-- *INF*: ltrim(rtrim(in_sar_sub_line_4514))\n\tltrim(rtrim(in_sar_sub_line_4514)) AS v_sar_sub_line_4514,\n\t-- *INF*: substr(in_sar_class_1_4_4514 || in_sar_class_5_6_4514,1,5)\n\tsubstr(in_sar_class_1_4_4514 || in_sar_class_5_6_4514, 1, 5) AS v_ClassCode,\n\t-- *INF*: IIF(pif_symbol = v_prev_pif_symbol  AND  pif_policy_number = v_prev_pif_policy_number  AND pif_module = v_prev_pif_module AND v_prev_PolicyOfferingCode!='000', v_prev_PolicyOfferingCode, :LKP.LKP_PolicyOfferingCode(1, v_pif_symbol_02_F2))\n\tIFF(pif_symbol = v_prev_pif_symbol AND pif_policy_number = v_prev_pif_policy_number AND pif_module = v_prev_pif_module AND v_prev_PolicyOfferingCode != '000', v_prev_PolicyOfferingCode, LKP_POLICYOFFERINGCODE_1_v_pif_symbol_02_F2.PolicyOfferingCode) AS v_PolicyOfferingCode_SN1,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN1), v_PolicyOfferingCode_SN1, :LKP.LKP_PolicyOfferingCode(2, v_pif_symbol_02_F1))\n\tIFF(NOT v_PolicyOfferingCode_SN1 IS NULL, v_PolicyOfferingCode_SN1, LKP_POLICYOFFERINGCODE_2_v_pif_symbol_02_F1.PolicyOfferingCode) AS v_PolicyOfferingCode_SN2,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN2), v_PolicyOfferingCode_SN2, :LKP.LKP_PolicyOfferingCode(3, v_pif_symbol_02_F2 || '&' || in_sar_risk_unit_group_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN2 IS NULL, v_PolicyOfferingCode_SN2, LKP_POLICYOFFERINGCODE_3_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN3,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN3), v_PolicyOfferingCode_SN3, :LKP.LKP_PolicyOfferingCode(4, v_pif_symbol_02_F2 || '&' || in_sar_risk_unit_group_4514 ||'&' ||  in_sar_insurance_line_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN3 IS NULL, v_PolicyOfferingCode_SN3, LKP_POLICYOFFERINGCODE_4_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514_in_sar_insurance_line_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN4,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN4), v_PolicyOfferingCode_SN4, :LKP.LKP_PolicyOfferingCode(5, v_pif_symbol_02_F2 ||'&' ||  in_sar_sub_line_4514 ||'&' ||  in_sar_insurance_line_4514 || '&' || v_ClassCode))\n\tIFF(NOT v_PolicyOfferingCode_SN4 IS NULL, v_PolicyOfferingCode_SN4, LKP_POLICYOFFERINGCODE_5_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514_v_ClassCode.PolicyOfferingCode) AS v_PolicyOfferingCode_SN5,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN5), v_PolicyOfferingCode_SN5, :LKP.LKP_PolicyOfferingCode(6, v_pif_symbol_02_F2 || '&' ||  in_sar_insurance_line_4514 ||'&' ||  in_sar_major_peril_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN5 IS NULL, v_PolicyOfferingCode_SN5, LKP_POLICYOFFERINGCODE_6_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_major_peril_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN6,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  NOT ISNULL(v_PolicyOfferingCode_SN6), v_PolicyOfferingCode_SN6, \r\n\t-- in_sar_major_peril_4514<>'517' AND in_sar_sub_line_4514<>'365'  AND NOT IN(in_sar_risk_unit_group_4514, '345', '346', '355') , \r\n\t-- :LKP.LKP_PolicyOfferingCode(7, v_pif_symbol_02_F2), NULL)\n\tDECODE(TRUE,\n\tNOT v_PolicyOfferingCode_SN6 IS NULL, v_PolicyOfferingCode_SN6,\n\tin_sar_major_peril_4514 <> '517' AND in_sar_sub_line_4514 <> '365' AND NOT IN(in_sar_risk_unit_group_4514, '345', '346', '355'), LKP_POLICYOFFERINGCODE_7_v_pif_symbol_02_F2.PolicyOfferingCode,\n\tNULL) AS v_PolicyOfferingCode_SN7,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  NOT ISNULL(v_PolicyOfferingCode_SN7), \r\n\t-- v_PolicyOfferingCode_SN7, \r\n\t-- NOT IN(in_sar_risk_unit_group_4514, '345', '355'), :LKP.LKP_PolicyOfferingCode(8, v_pif_symbol_02_F2), NULL)\n\tDECODE(TRUE,\n\tNOT v_PolicyOfferingCode_SN7 IS NULL, v_PolicyOfferingCode_SN7,\n\tNOT IN(in_sar_risk_unit_group_4514, '345', '355'), LKP_POLICYOFFERINGCODE_8_v_pif_symbol_02_F2.PolicyOfferingCode,\n\tNULL) AS v_PolicyOfferingCode_SN8,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN8), v_PolicyOfferingCode_SN8, :LKP.LKP_PolicyOfferingCode(9, v_pif_symbol_02_F2 || '&' || in_sar_sub_line_4514 ||'&' ||  in_sar_insurance_line_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN8 IS NULL, v_PolicyOfferingCode_SN8, LKP_POLICYOFFERINGCODE_9_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN9,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN9), v_PolicyOfferingCode_SN9,:LKP.LKP_PolicyOfferingCode(10, v_pif_symbol_02_F2 || '&' ||  in_sar_insurance_line_4514 || '&' || in_sar_risk_unit_group_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN9 IS NULL, v_PolicyOfferingCode_SN9, LKP_POLICYOFFERINGCODE_10_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN10,\n\t-- *INF*: IIF( NOT ISNULL(v_PolicyOfferingCode_SN10), v_PolicyOfferingCode_SN10,:LKP.LKP_PolicyOfferingCode(11, v_pif_symbol_02_F2 || '&' ||  in_sar_insurance_line_4514 || '&' || in_sar_risk_unit_group_4514))\n\tIFF(NOT v_PolicyOfferingCode_SN10 IS NULL, v_PolicyOfferingCode_SN10, LKP_POLICYOFFERINGCODE_11_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.PolicyOfferingCode) AS v_PolicyOfferingCode_SN11,\n\t-- *INF*: IIF(NOT ISNULL(v_PolicyOfferingCode_SN11)\r\n\t-- \t, v_PolicyOfferingCode_SN11\r\n\t-- \t, :LKP.LKP_PolicyOfferingCode(12, ltrim(rtrim(pif_symbol))))\n\tIFF(NOT v_PolicyOfferingCode_SN11 IS NULL, v_PolicyOfferingCode_SN11, LKP_POLICYOFFERINGCODE_12_ltrim_rtrim_pif_symbol.PolicyOfferingCode) AS v_PolicyOfferingCode_SN12,\n\t-- *INF*: IIF(NOT ISNULL(v_PolicyOfferingCode_SN12)\r\n\t-- \t, v_PolicyOfferingCode_SN12\r\n\t-- \t, IIF(v_pif_symbol_02_F1 = 'S' AND pif_line_business = 'WCP',\r\n\t-- \t\t'100'))\n\tIFF(NOT v_PolicyOfferingCode_SN12 IS NULL, v_PolicyOfferingCode_SN12, IFF(v_pif_symbol_02_F1 = 'S' AND pif_line_business = 'WCP', '100')) AS v_PolicyOfferingCode_SN13,\n\t-- *INF*: IIF(NOT ISNULL(v_PolicyOfferingCode_SN13)\r\n\t-- \t, v_PolicyOfferingCode_SN13\r\n\t-- \t, DECODE(TRUE\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'APV'), '810'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'HAP'), '800'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'BO'), '400'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'SMP'), '440'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND IN (pif_line_business, 'ACV','AFV','GL')), '500'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'WC'), '100'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'APV'), '810'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'HAP'), '800'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'BO'), '400'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'SMP'), '440'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND IN (pif_line_business, 'ACV','AFV','GL')), '500'\r\n\t-- \t\t, (v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'WC'), '100'\r\n\t-- \t\t)\r\n\t-- \t)\n\tIFF(NOT v_PolicyOfferingCode_SN13 IS NULL, v_PolicyOfferingCode_SN13, DECODE(TRUE,\n\t( v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'APV' ), '810',\n\t( v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'HAP' ), '800',\n\t( v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'BO' ), '400',\n\t( v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'SMP' ), '440',\n\t( v_pif_symbol_02_F2 = 'XA' AND IN(pif_line_business, 'ACV', 'AFV', 'GL') ), '500',\n\t( v_pif_symbol_02_F2 = 'XA' AND pif_line_business = 'WC' ), '100',\n\t( v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'APV' ), '810',\n\t( v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'HAP' ), '800',\n\t( v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'BO' ), '400',\n\t( v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'SMP' ), '440',\n\t( v_pif_symbol_02_F2 = 'XX' AND IN(pif_line_business, 'ACV', 'AFV', 'GL') ), '500',\n\t( v_pif_symbol_02_F2 = 'XX' AND pif_line_business = 'WC' ), '100')) AS v_PolicyOfferingCode_SN14,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tNOT ISNULL(v_PolicyOfferingCode_SN14)\r\n\t-- \t, v_PolicyOfferingCode_SN14\r\n\t-- \t, '000')\n\tDECODE(TRUE,\n\tNOT v_PolicyOfferingCode_SN14 IS NULL, v_PolicyOfferingCode_SN14,\n\t'000') AS v_PolicyOfferingCode,\n\t-- *INF*: DECODE(TRUE, pif_symbol != v_prev_pif_symbol  OR  pif_policy_number != v_prev_pif_policy_number  OR pif_module != v_prev_pif_module, null,\r\n\t-- ISNULL(v_prev_PolicyOfferingCode_First) AND v_prev_PolicyOfferingCode != '000',v_prev_PolicyOfferingCode,\r\n\t-- v_prev_PolicyOfferingCode_First\r\n\t--  )\n\tDECODE(TRUE,\n\tpif_symbol != v_prev_pif_symbol OR pif_policy_number != v_prev_pif_policy_number OR pif_module != v_prev_pif_module, null,\n\tv_prev_PolicyOfferingCode_First IS NULL AND v_prev_PolicyOfferingCode != '000', v_prev_PolicyOfferingCode,\n\tv_prev_PolicyOfferingCode_First) AS v_prev_PolicyOfferingCode_First,\n\t-- *INF*: DECODE(TRUE, ISNULL(v_prev_PolicyOfferingCode_First) AND v_PolicyOfferingCode != '000', \r\n\t-- '1',\r\n\t-- ISNULL(v_prev_PolicyOfferingCode_First) AND v_PolicyOfferingCode='000' AND in_RN_sar_acct_entrd_date_MaxToMin=1,'1',\r\n\t-- '0')\n\tDECODE(TRUE,\n\tv_prev_PolicyOfferingCode_First IS NULL AND v_PolicyOfferingCode != '000', '1',\n\tv_prev_PolicyOfferingCode_First IS NULL AND v_PolicyOfferingCode = '000' AND in_RN_sar_acct_entrd_date_MaxToMin = 1, '1',\n\t'0') AS v_PolicyOfferingCode_Flag,\n\tpif_symbol AS v_prev_pif_symbol,\n\tpif_policy_number AS v_prev_pif_policy_number,\n\tpif_module AS v_prev_pif_module,\n\tv_PolicyOfferingCode AS v_prev_PolicyOfferingCode,\n\t-- *INF*: :LKP.LKP_POLICYOFFERINGAKID(v_PolicyOfferingCode)\n\tLKP_POLICYOFFERINGAKID_v_PolicyOfferingCode.PolicyOfferingAKId AS v_PolicyOfferingAKId,\n\t-- *INF*: UPPER(LTRIM(RTRIM(in_pmd4j_use_code)))\n\tUPPER(LTRIM(RTRIM(in_pmd4j_use_code))) AS v_pmd4j_use_code,\n\t-- *INF*: IIF(ISNULL(in_pmd4j_address_line_1) OR IS_SPACES(in_pmd4j_address_line_1) OR LENGTH(in_pmd4j_address_line_1)=0, '', LTRIM(RTRIM(in_pmd4j_address_line_1)))\n\tIFF(in_pmd4j_address_line_1 IS NULL OR IS_SPACES(in_pmd4j_address_line_1) OR LENGTH(in_pmd4j_address_line_1) = 0, '', LTRIM(RTRIM(in_pmd4j_address_line_1))) AS v_pmd4j_address_line_1,\n\t-- *INF*: IIF(ISNULL(in_pmd4j_addr_lin_2_pos_1) OR IS_SPACES(in_pmd4j_addr_lin_2_pos_1) OR LENGTH(in_pmd4j_addr_lin_2_pos_1)=0, '', LTRIM(RTRIM(in_pmd4j_addr_lin_2_pos_1)))\n\tIFF(in_pmd4j_addr_lin_2_pos_1 IS NULL OR IS_SPACES(in_pmd4j_addr_lin_2_pos_1) OR LENGTH(in_pmd4j_addr_lin_2_pos_1) = 0, '', LTRIM(RTRIM(in_pmd4j_addr_lin_2_pos_1))) AS v_pmd4j_addr_lin_2_pos_1,\n\t-- *INF*: IIF(ISNULL(in_pmd4j_addr_lin_2_pos_2_30) OR IS_SPACES(in_pmd4j_addr_lin_2_pos_2_30) OR LENGTH(in_pmd4j_addr_lin_2_pos_2_30)=0, '', LTRIM(RTRIM(in_pmd4j_addr_lin_2_pos_2_30)))\n\tIFF(in_pmd4j_addr_lin_2_pos_2_30 IS NULL OR IS_SPACES(in_pmd4j_addr_lin_2_pos_2_30) OR LENGTH(in_pmd4j_addr_lin_2_pos_2_30) = 0, '', LTRIM(RTRIM(in_pmd4j_addr_lin_2_pos_2_30))) AS v_pmd4j_addr_lin_2_pos_2_30,\n\t-- *INF*: IIF(v_pmd4j_use_code='OB', v_pmd4j_address_line_1 ||' ' ||  v_pmd4j_addr_lin_2_pos_1 || v_pmd4j_addr_lin_2_pos_2_30, 'N/A')\n\tIFF(v_pmd4j_use_code = 'OB', v_pmd4j_address_line_1 || ' ' || v_pmd4j_addr_lin_2_pos_1 || v_pmd4j_addr_lin_2_pos_2_30, 'N/A') AS v_ObligeeName,\n\t-- *INF*: UPPER(LTRIM(RTRIM(in_comments_reason_suspended)))\n\tUPPER(LTRIM(RTRIM(in_comments_reason_suspended))) AS v_comments_reason_suspended,\n\t-- *INF*: UPPER(LTRIM(RTRIM(in_comments_area)))\n\tUPPER(LTRIM(RTRIM(in_comments_area))) AS v_comments_area,\n\tv_PolicyOfferingCode_Flag AS o_PolicyOfferingCode_Flag,\n\tv_PolicyOfferingCode AS o_PolicyOfferingCode,\n\t-- *INF*: IIF(ISNULL(v_PolicyOfferingAKId), 26, v_PolicyOfferingAKId)\n\tIFF(v_PolicyOfferingAKId IS NULL, 26, v_PolicyOfferingAKId) AS o_PolicyOfferingAKId,\n\t-- *INF*: IIF(v_ObligeeName=' ', 'N/A', v_ObligeeName)\n\tIFF(v_ObligeeName = ' ', 'N/A', v_ObligeeName) AS o_ObligeeName,\n\t-- *INF*: IIF(v_UNDND_UNDERWRITER_ID='9999','Y','N')\n\tIFF(v_UNDND_UNDERWRITER_ID = '9999', 'Y', 'N') AS o_AutomatedUnderwritingServicesIndicator,\n\t-- *INF*: IIF(v_comments_reason_suspended='ZZ' AND IN(v_comments_area, 'SBOP AUTOMATIC') AND pif_risk_state_prov != '16' AND IN(pif_renewal_code, '1', '2'), '1', '0')\n\tIFF(v_comments_reason_suspended = 'ZZ' AND IN(v_comments_area, 'SBOP AUTOMATIC') AND pif_risk_state_prov != '16' AND IN(pif_renewal_code, '1', '2'), '1', '0') AS o_AutomaticRenewalIndicator,\n\tSQ_pif_02_stage.pif_service_center\n\tFROM SQ_pif_02_stage\n\tLEFT JOIN LKP_PIF_04Stage\n\tON LKP_PIF_04Stage.PIF_SYMBOL = SQ_pif_02_stage.pif_symbol AND LKP_PIF_04Stage.PIF_POLICY_NUMBER = SQ_pif_02_stage.pif_policy_number AND LKP_PIF_04Stage.PIF_MODULE = SQ_pif_02_stage.pif_module\n\tLEFT JOIN LKP_pif_03_stage\n\tON LKP_pif_03_stage.pif_symbol = SQ_pif_02_stage.pif_symbol AND LKP_pif_03_stage.pif_policy_number = SQ_pif_02_stage.pif_policy_number AND LKP_pif_03_stage.pif_module = SQ_pif_02_stage.pif_module\n\tLEFT JOIN LKP_pif_43gj_stage\n\tON LKP_pif_43gj_stage.pif_symbol = SQ_pif_02_stage.pif_symbol AND LKP_pif_43gj_stage.pif_policy_number = SQ_pif_02_stage.pif_policy_number AND LKP_pif_43gj_stage.pif_module = SQ_pif_02_stage.pif_module\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_1_v_pif_symbol_02_F2\n\tON LKP_POLICYOFFERINGCODE_1_v_pif_symbol_02_F2.SequenceNumber = 1\n\tAND LKP_POLICYOFFERINGCODE_1_v_pif_symbol_02_F2.Identifiers = v_pif_symbol_02_F2\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_2_v_pif_symbol_02_F1\n\tON LKP_POLICYOFFERINGCODE_2_v_pif_symbol_02_F1.SequenceNumber = 2\n\tAND LKP_POLICYOFFERINGCODE_2_v_pif_symbol_02_F1.Identifiers = v_pif_symbol_02_F1\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_3_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514\n\tON LKP_POLICYOFFERINGCODE_3_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514.SequenceNumber = 3\n\tAND LKP_POLICYOFFERINGCODE_3_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_risk_unit_group_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_4_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514_in_sar_insurance_line_4514\n\tON LKP_POLICYOFFERINGCODE_4_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514_in_sar_insurance_line_4514.SequenceNumber = 4\n\tAND LKP_POLICYOFFERINGCODE_4_v_pif_symbol_02_F2_in_sar_risk_unit_group_4514_in_sar_insurance_line_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_risk_unit_group_4514 || '&' || in_sar_insurance_line_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_5_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514_v_ClassCode\n\tON LKP_POLICYOFFERINGCODE_5_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514_v_ClassCode.SequenceNumber = 5\n\tAND LKP_POLICYOFFERINGCODE_5_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514_v_ClassCode.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_sub_line_4514 || '&' || in_sar_insurance_line_4514 || '&' || v_ClassCode\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_6_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_major_peril_4514\n\tON LKP_POLICYOFFERINGCODE_6_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_major_peril_4514.SequenceNumber = 6\n\tAND LKP_POLICYOFFERINGCODE_6_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_major_peril_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_insurance_line_4514 || '&' || in_sar_major_peril_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_7_v_pif_symbol_02_F2\n\tON LKP_POLICYOFFERINGCODE_7_v_pif_symbol_02_F2.SequenceNumber = 7\n\tAND LKP_POLICYOFFERINGCODE_7_v_pif_symbol_02_F2.Identifiers = v_pif_symbol_02_F2\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_8_v_pif_symbol_02_F2\n\tON LKP_POLICYOFFERINGCODE_8_v_pif_symbol_02_F2.SequenceNumber = 8\n\tAND LKP_POLICYOFFERINGCODE_8_v_pif_symbol_02_F2.Identifiers = v_pif_symbol_02_F2\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_9_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514\n\tON LKP_POLICYOFFERINGCODE_9_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514.SequenceNumber = 9\n\tAND LKP_POLICYOFFERINGCODE_9_v_pif_symbol_02_F2_in_sar_sub_line_4514_in_sar_insurance_line_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_sub_line_4514 || '&' || in_sar_insurance_line_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_10_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514\n\tON LKP_POLICYOFFERINGCODE_10_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.SequenceNumber = 10\n\tAND LKP_POLICYOFFERINGCODE_10_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_insurance_line_4514 || '&' || in_sar_risk_unit_group_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_11_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514\n\tON LKP_POLICYOFFERINGCODE_11_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.SequenceNumber = 11\n\tAND LKP_POLICYOFFERINGCODE_11_v_pif_symbol_02_F2_in_sar_insurance_line_4514_in_sar_risk_unit_group_4514.Identifiers = v_pif_symbol_02_F2 || '&' || in_sar_insurance_line_4514 || '&' || in_sar_risk_unit_group_4514\n\n\tLEFT JOIN LKP_POLICYOFFERINGCODE LKP_POLICYOFFERINGCODE_12_ltrim_rtrim_pif_symbol\n\tON LKP_POLICYOFFERINGCODE_12_ltrim_rtrim_pif_symbol.SequenceNumber = 12\n\tAND LKP_POLICYOFFERINGCODE_12_ltrim_rtrim_pif_symbol.Identifiers = ltrim(rtrim(pif_symbol))\n\n\tLEFT JOIN LKP_POLICYOFFERINGAKID LKP_POLICYOFFERINGAKID_v_PolicyOfferingCode\n\tON LKP_POLICYOFFERINGAKID_v_PolicyOfferingCode.PolicyOfferingCode = v_PolicyOfferingCode\n\n),\nFIL_MIN AS (\n\tSELECT\n\tpif_symbol, \n\tpif_policy_number, \n\tpif_module, \n\tpif_master_co_number_a, \n\tpif_location_a, \n\tpif_amend_number, \n\tpif_eff_yr_a, \n\tpif_eff_mo_a, \n\tpif_eff_da_a, \n\tpif_exp_yr_a, \n\tpif_exp_mo_a, \n\tpif_exp_da_a, \n\tpif_installment_term_a, \n\tpif_risk_state_prov, \n\tpif_company_number, \n\tpif_full_agency_number, \n\tpif_ent_yr_a, \n\tpif_ent_mo_a, \n\tpif_ent_da_a, \n\tpif_line_business, \n\tpif_issue_code, \n\tpif_company_line, \n\tpif_pay_service_code, \n\tpif_audit_code, \n\tpif_variation_code, \n\tpif_producer_code, \n\tpif_review_code, \n\tpif_mvr_report_year, \n\tpif_risk_grade_guide, \n\tpif_renewal_code, \n\tpif_reason_amended, \n\tpif_renew_policy_symbol, \n\tpif_renew_policy_number, \n\tpif_original_incept, \n\twb_class_of_business, \n\tpif_guarantee_ind, \n\twb_renewal_discount, \n\twb_inview_indicator, \n\tpif_occupation, \n\tpif_final_audit_ind, \n\tpif_excess_claim_ind, \n\tpif_anniversary_rerate, \n\tpif_policy_status_on_pif, \n\tpif_uk_postal_code, \n\tpif_nonsmoker_discount, \n\tpif_upload_audit, \n\tpif_zip_ind, \n\tpif_prgm_id, \n\tpif_wbc_county, \n\tpif_orig_act_date, \n\tpif_fn_date, \n\tpif_terrorism_risk, \n\tpif_target_market_code, \n\tpif_completed_audit_date, \n\tpif_seg_id, \n\tpif_renewal_safe_record_ctr, \n\to_PolicyOfferingCode_Flag AS PolicyOfferingCode_Flag, \n\to_PolicyOfferingCode AS PolicyOfferingCode, \n\to_PolicyOfferingAKId AS PolicyOfferingAKId, \n\to_ObligeeName AS ObligeeName, \n\to_AutomatedUnderwritingServicesIndicator AS AutomatedUnderwritingServicesIndicator, \n\to_AutomaticRenewalIndicator AS AutomaticRenewalIndicator, \n\tpif_service_center, \n\tpif_dc_bill_ind\n\tFROM EXP_PolicyOfferingAKId\n\tWHERE PolicyOfferingCode_Flag='1'\n),\nEXP_values AS (\n\tSELECT\n\tpif_symbol AS in_pif_symbol,\n\t-- *INF*: in_pif_symbol\r\n\t-- --ltrim(rtrim(in_pif_symbol))\n\tin_pif_symbol AS pif_symbol,\n\t-- *INF*: SUBSTR(in_pif_symbol,1,1)\n\tSUBSTR(in_pif_symbol, 1, 1) AS pif_symbol_1,\n\tpif_policy_number AS in_pif_policy_number,\n\t-- *INF*: ltrim(rtrim(in_pif_policy_number))\n\tltrim(rtrim(in_pif_policy_number)) AS v_pif_pol_number,\n\tv_pif_pol_number AS pif_pol_number,\n\t-- *INF*: SUBSTR(v_pif_pol_number,1,1)\n\tSUBSTR(v_pif_pol_number, 1, 1) AS pif_pol_number_1,\n\tpif_module AS in_pif_module,\n\t-- *INF*: ltrim(rtrim(in_pif_module))\n\tltrim(rtrim(in_pif_module)) AS pif_module,\n\t-- *INF*: ltrim(rtrim(in_pif_symbol)) || ltrim(rtrim(in_pif_policy_number)) || ltrim(rtrim(in_pif_module))\n\tltrim(rtrim(in_pif_symbol)) || ltrim(rtrim(in_pif_policy_number)) || ltrim(rtrim(in_pif_module)) AS v_policy_key,\n\t-- *INF*: ltrim(rtrim(v_policy_key))\n\tltrim(rtrim(v_policy_key)) AS policy_key,\n\tpif_master_co_number_a,\n\t-- *INF*: iif(isnull(pif_master_co_number_a) or is_spaces(pif_master_co_number_a) or LENGTH(pif_master_co_number_a)=0,'N/A',LTRIM(RTRIM(pif_master_co_number_a)))\n\tIFF(pif_master_co_number_a IS NULL OR is_spaces(pif_master_co_number_a) OR LENGTH(pif_master_co_number_a) = 0, 'N/A', LTRIM(RTRIM(pif_master_co_number_a))) AS mco,\n\tpif_eff_yr_a,\n\t-- *INF*: IIF(pif_eff_yr_a = '9999', '1800', pif_eff_yr_a)\n\tIFF(pif_eff_yr_a = '9999', '1800', pif_eff_yr_a) AS v_pif_eff_yr_a,\n\tpif_eff_mo_a,\n\t-- *INF*: IIF(pif_eff_mo_a > '12', '01', pif_eff_mo_a)\r\n\t-- --IIF(TO_INTEGER(pif_eff_mo_a) > 12, '01', pif_eff_mo_a)\n\tIFF(pif_eff_mo_a > '12', '01', pif_eff_mo_a) AS v_pif_eff_mo_a,\n\tpif_eff_da_a,\n\t-- *INF*: IIF(pif_eff_da_a > '31', '01', pif_eff_da_a)\r\n\t-- --IIF(TO_INTEGER(pif_eff_da_a) > 31, '01', pif_eff_da_a)\n\tIFF(pif_eff_da_a > '31', '01', pif_eff_da_a) AS v_pif_eff_da_a,\n\t-- *INF*: TO_DATE(v_pif_eff_yr_a ||'-' || v_pif_eff_mo_a || '-' || v_pif_eff_da_a,'YYYY-MM-DD')\n\tTO_DATE(v_pif_eff_yr_a || '-' || v_pif_eff_mo_a || '-' || v_pif_eff_da_a, 'YYYY-MM-DD') AS v_pol_eff_date,\n\tv_pol_eff_date AS pol_eff_date,\n\tpif_exp_yr_a,\n\t-- *INF*: IIF(pif_exp_yr_a = '9999', '2100', pif_exp_yr_a)\n\tIFF(pif_exp_yr_a = '9999', '2100', pif_exp_yr_a) AS v_pif_exp_yr_a,\n\tpif_exp_mo_a,\n\t-- *INF*: IIF(TO_INTEGER(pif_exp_mo_a) > 12, '12', pif_exp_mo_a)\n\tIFF(TO_INTEGER(pif_exp_mo_a) > 12, '12', pif_exp_mo_a) AS v_pif_exp_mo_a,\n\tpif_exp_da_a,\n\t-- *INF*: IIF(TO_INTEGER(pif_exp_da_a) > 31, '31', pif_exp_da_a)\n\tIFF(TO_INTEGER(pif_exp_da_a) > 31, '31', pif_exp_da_a) AS v_pif_exp_da_a,\n\t-- *INF*: TO_DATE(v_pif_exp_yr_a ||'-' || v_pif_exp_mo_a || '-' || v_pif_exp_da_a,'YYYY-MM-DD')\n\tTO_DATE(v_pif_exp_yr_a || '-' || v_pif_exp_mo_a || '-' || v_pif_exp_da_a, 'YYYY-MM-DD') AS v_pol_exp_date,\n\t-- *INF*: TO_DATE( v_pif_exp_yr_a ||'-' || v_pif_exp_mo_a || '-' ||  v_pif_exp_da_a,'YYYY-MM-DD')\n\tTO_DATE(v_pif_exp_yr_a || '-' || v_pif_exp_mo_a || '-' || v_pif_exp_da_a, 'YYYY-MM-DD') AS pol_exp_date,\n\tpif_installment_term_a AS in_pif_installment_term_a,\n\t-- *INF*: iif(isnull(in_pif_installment_term_a) or is_spaces(in_pif_installment_term_a) or LENGTH(in_pif_installment_term_a)=0,'N/A',LTRIM(RTRIM(in_pif_installment_term_a)))\n\tIFF(in_pif_installment_term_a IS NULL OR is_spaces(in_pif_installment_term_a) OR LENGTH(in_pif_installment_term_a) = 0, 'N/A', LTRIM(RTRIM(in_pif_installment_term_a))) AS pol_term,\n\tpif_risk_state_prov AS in_pif_risk_state_prov,\n\t-- *INF*: iif(isnull(in_pif_risk_state_prov) or is_spaces(in_pif_risk_state_prov) or LENGTH(in_pif_risk_state_prov)=0,'N/A' ,LTRIM(RTRIM(in_pif_risk_state_prov)))\n\tIFF(in_pif_risk_state_prov IS NULL OR is_spaces(in_pif_risk_state_prov) OR LENGTH(in_pif_risk_state_prov) = 0, 'N/A', LTRIM(RTRIM(in_pif_risk_state_prov))) AS state_of_domicile_code,\n\t-- *INF*: iif(isnull(in_pif_risk_state_prov) or is_spaces(in_pif_risk_state_prov) or LENGTH(in_pif_risk_state_prov)=0,'N/A',IIF(LTRIM(RTRIM(in_pif_risk_state_prov))='00', '0', LTRIM(LTRIM(RTRIM(in_pif_risk_state_prov)), '0')))\n\tIFF(in_pif_risk_state_prov IS NULL OR is_spaces(in_pif_risk_state_prov) OR LENGTH(in_pif_risk_state_prov) = 0, 'N/A', IFF(LTRIM(RTRIM(in_pif_risk_state_prov)) = '00', '0', LTRIM(LTRIM(RTRIM(in_pif_risk_state_prov)), '0'))) AS state_of_domicile_code_without0,\n\tpif_company_number AS in_pif_company_number,\n\t-- *INF*: iif(isnull(in_pif_company_number) or is_spaces(in_pif_company_number) or LENGTH(in_pif_company_number)=0,'N/A',LTRIM(RTRIM(in_pif_company_number)))\n\tIFF(in_pif_company_number IS NULL OR is_spaces(in_pif_company_number) OR LENGTH(in_pif_company_number) = 0, 'N/A', LTRIM(RTRIM(in_pif_company_number))) AS pol_co_num,\n\tpif_ent_yr_a,\n\tpif_ent_mo_a,\n\tpif_ent_da_a,\n\tpif_line_business AS in_pif_line_business,\n\t-- *INF*: iif(isnull(in_pif_line_business) or is_spaces(in_pif_line_business) or LENGTH(in_pif_line_business)=0,'N/A',LTRIM(RTRIM(in_pif_line_business)))\n\tIFF(in_pif_line_business IS NULL OR is_spaces(in_pif_line_business) OR LENGTH(in_pif_line_business) = 0, 'N/A', LTRIM(RTRIM(in_pif_line_business))) AS pif_lob_code,\n\tpif_company_line,\n\t-- *INF*: iif(isnull(pif_company_line) or is_spaces(pif_company_line) or LENGTH(pif_company_line)=0,'N/A',LTRIM(RTRIM(pif_company_line)))\n\tIFF(pif_company_line IS NULL OR is_spaces(pif_company_line) OR LENGTH(pif_company_line) = 0, 'N/A', LTRIM(RTRIM(pif_company_line))) AS pol_co_line_code,\n\tpif_pay_service_code AS in_pif_pay_service_code,\n\t-- *INF*:  DECODE(:UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_pay_service_code),\r\n\t--                       'R' ,'BCMS billing'  ,\r\n\t--                       'A', 'Agency Billing ' ,\r\n\t--                       'D' , 'PMS Direct Bill',\r\n\t--                      'E' , 'Mortgage Bill',\r\n\t--                      'P', 'Premium Pay',\r\n\t--                      'N/A ')\r\n\t--  \r\n\t--  \n\tDECODE(:UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_pay_service_code),\n\t'R', 'BCMS billing',\n\t'A', 'Agency Billing ',\n\t'D', 'PMS Direct Bill',\n\t'E', 'Mortgage Bill',\n\t'P', 'Premium Pay',\n\t'N/A ') AS BillingType,\n\tpif_renewal_code AS in_pif_renewal_code,\n\tpif_reason_amended AS in_pif_reason_amended,\n\t-- *INF*: iif(in_pif_renewal_code='9','Y','N')\n\tIFF(in_pif_renewal_code = '9', 'Y', 'N') AS pol_cancellation_ind,\n\t-- *INF*: iif(isnull(in_pif_renewal_code) or is_spaces(in_pif_renewal_code) or LENGTH(in_pif_renewal_code)=0,'N/A',LTRIM(RTRIM(in_pif_renewal_code)))\n\tIFF(in_pif_renewal_code IS NULL OR is_spaces(in_pif_renewal_code) OR LENGTH(in_pif_renewal_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_renewal_code))) AS renl_code,\n\tpif_original_incept AS in_pif_original_incept,\n\t-- *INF*: iif(length(ltrim(rtrim(substr(in_pif_original_incept,1,4))))<>4,'1800',substr(in_pif_original_incept,1,4))\n\tIFF(length(ltrim(rtrim(substr(in_pif_original_incept, 1, 4)))) <> 4, '1800', substr(in_pif_original_incept, 1, 4)) AS v_orig_incep_date_year,\n\t-- *INF*: iif(substr(in_pif_original_incept,5,2)>'12','12',substr(in_pif_original_incept,5,2))\n\tIFF(substr(in_pif_original_incept, 5, 2) > '12', '12', substr(in_pif_original_incept, 5, 2)) AS v_orig_incep_date_month,\n\t-- *INF*: iif(IS_DATE(v_orig_incep_date_year ||'-' || v_orig_incep_date_month || '-' || '01','YYYY-MM-DD'),TO_DATE(v_orig_incep_date_year ||'-' || v_orig_incep_date_month || '-' || '01','YYYY-MM-DD'),to_date('01/01/1800','MM/DD/YYYY'))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --TO_DATE(v_orig_incep_date_year ||'-' || v_orig_incep_date_month || '-' || '01','YYYY-MM-DD')\n\tIFF(IS_DATE(v_orig_incep_date_year || '-' || v_orig_incep_date_month || '-' || '01', 'YYYY-MM-DD'), TO_DATE(v_orig_incep_date_year || '-' || v_orig_incep_date_month || '-' || '01', 'YYYY-MM-DD'), to_date('01/01/1800', 'MM/DD/YYYY')) AS v_orig_incep_date,\n\tv_orig_incep_date AS orig_incep_date,\n\twb_inview_indicator AS in_wb_inview_indicator,\n\t-- *INF*: iif(isnull(in_wb_inview_indicator) or is_spaces(in_wb_inview_indicator) or LENGTH(in_wb_inview_indicator)=0,'N/A',LTRIM(RTRIM(in_wb_inview_indicator)))\n\tIFF(in_wb_inview_indicator IS NULL OR is_spaces(in_wb_inview_indicator) OR LENGTH(in_wb_inview_indicator) = 0, 'N/A', LTRIM(RTRIM(in_wb_inview_indicator))) AS wbconnect_upload_code,\n\tpif_occupation AS in_pif_occupation,\n\t-- *INF*: to_char(TO_INTEGER(in_pif_occupation))\n\tto_char(TO_INTEGER(in_pif_occupation)) AS v_pif_occupation,\n\t-- *INF*: iif(isnull(v_pif_occupation) or is_spaces(v_pif_occupation) or LENGTH(v_pif_occupation)=0,'N/A',LTRIM(RTRIM(LPAD(v_pif_occupation,5,'0'))))\n\tIFF(v_pif_occupation IS NULL OR is_spaces(v_pif_occupation) OR LENGTH(v_pif_occupation) = 0, 'N/A', LTRIM(RTRIM(LPAD(v_pif_occupation, 5, '0')))) AS prim_bus_class_code,\n\tpif_terrorism_risk AS in_pif_terrorism_risk,\n\t-- *INF*: iif(isnull(in_pif_terrorism_risk) or is_spaces(in_pif_terrorism_risk) or LENGTH(in_pif_terrorism_risk)=0,'N/A',LTRIM(RTRIM(in_pif_terrorism_risk)))\n\tIFF(in_pif_terrorism_risk IS NULL OR is_spaces(in_pif_terrorism_risk) OR LENGTH(in_pif_terrorism_risk) = 0, 'N/A', LTRIM(RTRIM(in_pif_terrorism_risk))) AS terrorism_risk_ind,\n\tpif_renew_policy_symbol AS in_pif_renew_policy_symbol,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_renew_policy_symbol)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_renew_policy_symbol) AS out_pif_renew_policy_symbol,\n\tpif_renew_policy_number AS in_pif_renew_policy_number,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_renew_policy_number)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(in_pif_renew_policy_number) AS out_pif_renew_policy_number,\n\tpif_uk_postal_code AS in_pif_uk_postal_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(substr(in_pif_uk_postal_code,1,2))\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(substr(in_pif_uk_postal_code, 1, 2)) AS RenewalPolicyMod,\n\t-- *INF*: in_pif_renew_policy_symbol||in_pif_renew_policy_number||substr(in_pif_uk_postal_code,1,2)\n\tin_pif_renew_policy_symbol || in_pif_renew_policy_number || substr(in_pif_uk_postal_code, 1, 2) AS v_prior_pol_key,\n\t-- *INF*: iif(isnull(v_prior_pol_key) or is_spaces(v_prior_pol_key) or LENGTH(v_prior_pol_key)=0,'N/A',LTRIM(RTRIM(v_prior_pol_key)))\n\tIFF(v_prior_pol_key IS NULL OR is_spaces(v_prior_pol_key) OR LENGTH(v_prior_pol_key) = 0, 'N/A', LTRIM(RTRIM(v_prior_pol_key))) AS prior_pol_key,\n\tpif_issue_code AS in_pif_issue_code,\n\t-- *INF*: IIF(\r\n\t--   in_pif_issue_code='M' OR in_pif_issue_code='N',\r\n\t--   '1'\r\n\t-- )\r\n\t-- --iif(in_pif_issue_code='M','1',IIF(in_pif_issue_code='N','1'))\n\tIFF(in_pif_issue_code = 'M' OR in_pif_issue_code = 'N', '1') AS v_pif_issue_code,\n\t-- *INF*: iif((in_pif_original_incept=(pif_eff_yr_a || pif_eff_mo_a)) and v_pif_issue_code='1','N','R')\n\tIFF(( in_pif_original_incept = ( pif_eff_yr_a || pif_eff_mo_a ) ) AND v_pif_issue_code = '1', 'N', 'R') AS pol_issue_code,\n\t-- *INF*: iif(GET_DATE_PART(v_orig_incep_date,'YYYY')=1800,-1,DATE_DIFF(trunc(v_pol_eff_date,'YYYY'),trunc(v_orig_incep_date,'YYYY'),'YYYY'))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DATE_DIFF(trunc(v_pol_eff_date,'YYYY'),trunc(v_orig_incep_date,'YYYY'),'YYYY')\n\tIFF(GET_DATE_PART(v_orig_incep_date, 'YYYY') = 1800, - 1, DATE_DIFF(trunc(v_pol_eff_date, 'YYYY'), trunc(v_orig_incep_date, 'YYYY'), 'YYYY')) AS v_pol_age,\n\tv_pol_age AS v_v_pol_age,\n\t-- *INF*: abs(v_pol_age)\n\tabs(v_pol_age) AS pol_age,\n\tpif_risk_grade_guide AS in_pif_risk_grade_guide,\n\t-- *INF*: iif(isnull(in_pif_risk_grade_guide) or is_spaces(in_pif_risk_grade_guide) or LENGTH(in_pif_risk_grade_guide)=0,'N/A',LTRIM(RTRIM(in_pif_risk_grade_guide)))\n\tIFF(in_pif_risk_grade_guide IS NULL OR is_spaces(in_pif_risk_grade_guide) OR LENGTH(in_pif_risk_grade_guide) = 0, 'N/A', LTRIM(RTRIM(in_pif_risk_grade_guide))) AS industry_risk_grade_code,\n\tpif_amend_number AS in_pif_amend_number,\n\t-- *INF*: iif(isnull(in_pif_amend_number) or is_spaces(in_pif_amend_number) or LENGTH(in_pif_amend_number)=0,'N/A',LTRIM(RTRIM(in_pif_amend_number)))\n\tIFF(in_pif_amend_number IS NULL OR is_spaces(in_pif_amend_number) OR LENGTH(in_pif_amend_number) = 0, 'N/A', LTRIM(RTRIM(in_pif_amend_number))) AS amend_num,\n\tpif_anniversary_rerate AS in_pif_anniversary_rerate,\n\t-- *INF*: iif(isnull(in_pif_anniversary_rerate) or is_spaces(in_pif_anniversary_rerate) or LENGTH(in_pif_anniversary_rerate)=0,'N/A',LTRIM(RTRIM(in_pif_anniversary_rerate)))\n\tIFF(in_pif_anniversary_rerate IS NULL OR is_spaces(in_pif_anniversary_rerate) OR LENGTH(in_pif_anniversary_rerate) = 0, 'N/A', LTRIM(RTRIM(in_pif_anniversary_rerate))) AS anniversary_rerate_code,\n\tpif_audit_code AS in_pif_audit_code,\n\t-- *INF*: iif(isnull(in_pif_audit_code) or is_spaces(in_pif_audit_code) or LENGTH(in_pif_audit_code)=0,'N/A',LTRIM(RTRIM(in_pif_audit_code)))\n\tIFF(in_pif_audit_code IS NULL OR is_spaces(in_pif_audit_code) OR LENGTH(in_pif_audit_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_audit_code))) AS pol_audit_frqncy,\n\tpif_final_audit_ind AS in_pif_final_audit_ind,\n\t-- *INF*: iif(isnull(in_pif_final_audit_ind) or is_spaces(in_pif_final_audit_ind) or LENGTH(in_pif_final_audit_ind)=0,'N/A',LTRIM(RTRIM(in_pif_final_audit_ind)))\n\tIFF(in_pif_final_audit_ind IS NULL OR is_spaces(in_pif_final_audit_ind) OR LENGTH(in_pif_final_audit_ind) = 0, 'N/A', LTRIM(RTRIM(in_pif_final_audit_ind))) AS final_audit_code,\n\tpif_zip_ind AS in_pif_zip_ind,\n\t-- *INF*: iif(isnull(in_pif_zip_ind) or is_spaces(in_pif_zip_ind) or LENGTH(in_pif_zip_ind)=0,'N/A',LTRIM(RTRIM(in_pif_zip_ind)))\n\tIFF(in_pif_zip_ind IS NULL OR is_spaces(in_pif_zip_ind) OR LENGTH(in_pif_zip_ind) = 0, 'N/A', LTRIM(RTRIM(in_pif_zip_ind))) AS zip_ind,\n\tpif_prgm_id AS in_pif_prgm_id,\n\t-- *INF*: iif(isnull(in_pif_prgm_id) or is_spaces(in_pif_prgm_id) or LENGTH(in_pif_prgm_id)=0,'N/A',LTRIM(RTRIM(in_pif_prgm_id)))\n\tIFF(in_pif_prgm_id IS NULL OR is_spaces(in_pif_prgm_id) OR LENGTH(in_pif_prgm_id) = 0, 'N/A', LTRIM(RTRIM(in_pif_prgm_id))) AS v_pif_prgm_id,\n\tpif_guarantee_ind AS in_pif_guarantee_ind,\n\t-- *INF*: iif(isnull(in_pif_guarantee_ind) or is_spaces(in_pif_guarantee_ind) or LENGTH(in_pif_guarantee_ind)=0,'N/A',LTRIM(RTRIM(in_pif_guarantee_ind)))\n\tIFF(in_pif_guarantee_ind IS NULL OR is_spaces(in_pif_guarantee_ind) OR LENGTH(in_pif_guarantee_ind) = 0, 'N/A', LTRIM(RTRIM(in_pif_guarantee_ind))) AS gutantee_ind,\n\tpif_variation_code AS in_pif_variation_code,\n\t-- *INF*: iif(isnull(in_pif_variation_code) or is_spaces(in_pif_variation_code) or LENGTH(in_pif_variation_code)=0,'N/A',LTRIM(RTRIM(in_pif_variation_code)))\n\tIFF(in_pif_variation_code IS NULL OR is_spaces(in_pif_variation_code) OR LENGTH(in_pif_variation_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_variation_code))) AS variation_code,\n\tpif_wbc_county AS in_pif_wbc_county,\n\t-- *INF*: iif(isnull(in_pif_wbc_county) or is_spaces(in_pif_wbc_county) or LENGTH(in_pif_wbc_county)=0,'N/A',LTRIM(RTRIM(in_pif_wbc_county)))\n\tIFF(in_pif_wbc_county IS NULL OR is_spaces(in_pif_wbc_county) OR LENGTH(in_pif_wbc_county) = 0, 'N/A', LTRIM(RTRIM(in_pif_wbc_county))) AS county,\n\tpif_nonsmoker_discount AS in_pif_nonsmoker_discount,\n\t-- *INF*: iif(isnull(in_pif_nonsmoker_discount) or is_spaces(in_pif_nonsmoker_discount) or LENGTH(in_pif_nonsmoker_discount)=0,'N/A',LTRIM(RTRIM(in_pif_nonsmoker_discount)))\n\tIFF(in_pif_nonsmoker_discount IS NULL OR is_spaces(in_pif_nonsmoker_discount) OR LENGTH(in_pif_nonsmoker_discount) = 0, 'N/A', LTRIM(RTRIM(in_pif_nonsmoker_discount))) AS non_smoker_disc_code,\n\twb_renewal_discount AS in_wb_renewal_discount,\n\t-- *INF*: iif(isnull(in_wb_renewal_discount),0,in_wb_renewal_discount)\n\tIFF(in_wb_renewal_discount IS NULL, 0, in_wb_renewal_discount) AS renl_disc,\n\tpif_upload_audit AS in_pif_upload_audit,\n\t-- *INF*: iif(isnull(in_pif_upload_audit) or is_spaces(in_pif_upload_audit) or LENGTH(in_pif_upload_audit)=0,'N/A',in_pif_upload_audit)\n\tIFF(in_pif_upload_audit IS NULL OR is_spaces(in_pif_upload_audit) OR LENGTH(in_pif_upload_audit) = 0, 'N/A', in_pif_upload_audit) AS pif_upload_audit,\n\tpif_seg_id AS in_pif_seg_id,\n\t-- *INF*: iif(isnull(in_pif_seg_id) or is_spaces(in_pif_seg_id) or LENGTH(in_pif_seg_id)=0,'N/A',in_pif_seg_id)\n\tIFF(in_pif_seg_id IS NULL OR is_spaces(in_pif_seg_id) OR LENGTH(in_pif_seg_id) = 0, 'N/A', in_pif_seg_id) AS pif_seg_id,\n\tpif_renewal_safe_record_ctr AS in_pif_renewal_safe_record_ctr,\n\t-- *INF*: iif(isnull(in_pif_renewal_safe_record_ctr) ,-1,TO_INTEGER(in_pif_renewal_safe_record_ctr))\n\tIFF(in_pif_renewal_safe_record_ctr IS NULL, - 1, TO_INTEGER(in_pif_renewal_safe_record_ctr)) AS renl_safe_driver_disc_count,\n\tpif_fn_date AS in_pif_fn_date,\n\t-- *INF*: iif(isnull(in_pif_fn_date) or is_spaces(in_pif_fn_date) or LENGTH(in_pif_fn_date)=0,'21001231',in_pif_fn_date)\n\tIFF(in_pif_fn_date IS NULL OR is_spaces(in_pif_fn_date) OR LENGTH(in_pif_fn_date) = 0, '21001231', in_pif_fn_date) AS v_pif_fn_date,\n\t-- *INF*: to_date(substr(v_pif_fn_date,1,4) || '-' || substr(v_pif_fn_date,5,2) || '-' || substr(v_pif_fn_date,7,2),'YYYY-MM-DD')\r\n\t-- \r\n\t-- \r\n\t-- \n\tto_date(substr(v_pif_fn_date, 1, 4) || '-' || substr(v_pif_fn_date, 5, 2) || '-' || substr(v_pif_fn_date, 7, 2), 'YYYY-MM-DD') AS fn_date,\n\tpif_completed_audit_date AS in_pif_completed_audit_date,\n\t-- *INF*: iif(isnull(in_pif_completed_audit_date) or is_spaces(in_pif_completed_audit_date) or LENGTH(in_pif_completed_audit_date)=0,'21001231',in_pif_completed_audit_date)\n\tIFF(in_pif_completed_audit_date IS NULL OR is_spaces(in_pif_completed_audit_date) OR LENGTH(in_pif_completed_audit_date) = 0, '21001231', in_pif_completed_audit_date) AS v_in_pif_completed_audit_date,\n\t-- *INF*: to_date(substr(v_in_pif_completed_audit_date,1,4) || '-' || substr(v_in_pif_completed_audit_date,5,2) || '-' || substr(v_in_pif_completed_audit_date,7,2),'YYYY-MM-DD')\n\tto_date(substr(v_in_pif_completed_audit_date, 1, 4) || '-' || substr(v_in_pif_completed_audit_date, 5, 2) || '-' || substr(v_in_pif_completed_audit_date, 7, 2), 'YYYY-MM-DD') AS audit_complt_date,\n\tpif_orig_act_date AS in_pif_orig_act_date,\n\t-- *INF*: iif(isnull(in_pif_orig_act_date) or is_spaces(in_pif_orig_act_date) or LENGTH(in_pif_orig_act_date)=0\r\n\t--         ,'21001231'\r\n\t--         ,iif(LENGTH(ltrim(rtrim(in_pif_orig_act_date)))=7\r\n\t--              ,iif(is_date(ltrim(rtrim(in_pif_orig_act_date)) || '0','yyyymmdd')\r\n\t--                    ,ltrim(rtrim(in_pif_orig_act_date)) || '0'\r\n\t--                    ,ltrim(rtrim(in_pif_orig_act_date)) || '1'\r\n\t--                   )\r\n\t--              ,in_pif_orig_act_date)\r\n\t-- )\n\tIFF(in_pif_orig_act_date IS NULL OR is_spaces(in_pif_orig_act_date) OR LENGTH(in_pif_orig_act_date) = 0, '21001231', IFF(LENGTH(ltrim(rtrim(in_pif_orig_act_date))) = 7, IFF(is_date(ltrim(rtrim(in_pif_orig_act_date)) || '0', 'yyyymmdd'), ltrim(rtrim(in_pif_orig_act_date)) || '0', ltrim(rtrim(in_pif_orig_act_date)) || '1'), in_pif_orig_act_date)) AS v_pif_orig_act_date,\n\t-- *INF*: to_date(substr(v_pif_orig_act_date,1,4) || '-' || substr(v_pif_orig_act_date,5,2) || '-' || substr(v_pif_orig_act_date,7,2),'YYYY-MM-DD')\n\tto_date(substr(v_pif_orig_act_date, 1, 4) || '-' || substr(v_pif_orig_act_date, 5, 2) || '-' || substr(v_pif_orig_act_date, 7, 2), 'YYYY-MM-DD') AS original_account_date,\n\tpif_ent_yr_a AS in_pif_ent_yr_a1,\n\tpif_ent_mo_a AS in_pif_ent_mo_a1,\n\tpif_ent_da_a AS in_pif_ent_da_a1,\n\t-- *INF*: iif(isnull(in_pif_ent_yr_a1) or is_spaces(in_pif_ent_yr_a1) or LENGTH(in_pif_ent_yr_a1)=0,'1800',LTRIM(RTRIM(in_pif_ent_yr_a1)))\n\tIFF(in_pif_ent_yr_a1 IS NULL OR is_spaces(in_pif_ent_yr_a1) OR LENGTH(in_pif_ent_yr_a1) = 0, '1800', LTRIM(RTRIM(in_pif_ent_yr_a1))) AS v_pif_ent_yr,\n\t-- *INF*: iif(isnull(in_pif_ent_mo_a1) or is_spaces(in_pif_ent_mo_a1) or LENGTH(in_pif_ent_mo_a1)=0,'01',LTRIM(RTRIM(in_pif_ent_mo_a1)))\n\tIFF(in_pif_ent_mo_a1 IS NULL OR is_spaces(in_pif_ent_mo_a1) OR LENGTH(in_pif_ent_mo_a1) = 0, '01', LTRIM(RTRIM(in_pif_ent_mo_a1))) AS v_pif_ent_mo,\n\t-- *INF*: iif(isnull(in_pif_ent_da_a1) or is_spaces(in_pif_ent_da_a1) or LENGTH(in_pif_ent_da_a1)=0,'01',LTRIM(RTRIM(in_pif_ent_da_a1)))\n\tIFF(in_pif_ent_da_a1 IS NULL OR is_spaces(in_pif_ent_da_a1) OR LENGTH(in_pif_ent_da_a1) = 0, '01', LTRIM(RTRIM(in_pif_ent_da_a1))) AS v_pif_ent_da,\n\t-- *INF*: TO_DATE(v_pif_ent_yr ||'-' || v_pif_ent_mo || '-' || v_pif_ent_da,'YYYY-MM-DD')\n\tTO_DATE(v_pif_ent_yr || '-' || v_pif_ent_mo || '-' || v_pif_ent_da, 'YYYY-MM-DD') AS pol_enter_date,\n\tpif_location_a AS in_pif_location_a,\n\t-- *INF*: iif(isnull(in_pif_location_a) or is_spaces(in_pif_location_a) or LENGTH(in_pif_location_a)=0,'N/A',LTRIM(RTRIM(in_pif_location_a)))\n\tIFF(in_pif_location_a IS NULL OR is_spaces(in_pif_location_a) OR LENGTH(in_pif_location_a) = 0, 'N/A', LTRIM(RTRIM(in_pif_location_a))) AS loc,\n\tpif_excess_claim_ind AS in_pif_excess_claim_ind,\n\t-- *INF*: iif(isnull(in_pif_excess_claim_ind) or is_spaces(in_pif_excess_claim_ind) or LENGTH(in_pif_excess_claim_ind)=0,'N/A',LTRIM(RTRIM(in_pif_excess_claim_ind)))\n\tIFF(in_pif_excess_claim_ind IS NULL OR is_spaces(in_pif_excess_claim_ind) OR LENGTH(in_pif_excess_claim_ind) = 0, 'N/A', LTRIM(RTRIM(in_pif_excess_claim_ind))) AS excess_claim_code,\n\tpif_policy_status_on_pif AS in_pif_policy_status_on_pif,\n\t-- *INF*: iif(isnull(in_pif_policy_status_on_pif) or is_spaces(in_pif_policy_status_on_pif) or LENGTH(in_pif_policy_status_on_pif)=0,'N/A',LTRIM(RTRIM(in_pif_policy_status_on_pif)))\n\tIFF(in_pif_policy_status_on_pif IS NULL OR is_spaces(in_pif_policy_status_on_pif) OR LENGTH(in_pif_policy_status_on_pif) = 0, 'N/A', LTRIM(RTRIM(in_pif_policy_status_on_pif))) AS pif_policy_status_on,\n\tpif_service_center,\n\t'N/A' AS reins_code,\n\t-- *INF*: ----IIF( SUBSTR(in_pif_reason_amended,1,1) = 'P' and in_pif_renewal_code = '9', SYSDATE,\r\n\t-- --TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS'))\n\t'' AS v_pol_cancellation_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS pol_cancellation_date,\n\t'N/A' AS pol_cancellation_rsn_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(pif_service_center) OR IS_SPACES(pif_service_center) OR LENGTH(pif_service_center) = 0 OR LTRIM(RTRIM(pif_service_center)) = '','N/A',\r\n\t-- pif_service_center )\r\n\t-- \r\n\t-- --IIF(ISNULL(pif_service_center),'N/A',pif_service_center)\n\tDECODE(TRUE,\n\tpif_service_center IS NULL OR IS_SPACES(pif_service_center) OR LENGTH(pif_service_center) = 0 OR LTRIM(RTRIM(pif_service_center)) = '', 'N/A',\n\tpif_service_center) AS serv_center_support_code,\n\tpif_review_code AS in_pif_review_code,\n\t-- *INF*: iif(isnull(in_pif_review_code) or IS_SPACES(in_pif_review_code) or LENGTH(in_pif_review_code)=0,'N/A',LTRIM(RTRIM(in_pif_review_code)))\n\tIFF(in_pif_review_code IS NULL OR IS_SPACES(in_pif_review_code) OR LENGTH(in_pif_review_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_review_code))) AS uw_review_yr,\n\tpif_mvr_report_year AS in_pif_mvr_report_year,\n\t-- *INF*: iif(isnull(in_pif_mvr_report_year) or IS_SPACES(in_pif_mvr_report_year) or LENGTH(in_pif_mvr_report_year)=0,'N/A',LTRIM(RTRIM(in_pif_mvr_report_year)))\n\tIFF(in_pif_mvr_report_year IS NULL OR IS_SPACES(in_pif_mvr_report_year) OR LENGTH(in_pif_mvr_report_year) = 0, 'N/A', LTRIM(RTRIM(in_pif_mvr_report_year))) AS mvr_request_code,\n\tpif_full_agency_number AS in_pif_full_agency_number,\n\t-- *INF*: SUBSTR(in_pif_full_agency_number,1,2) || SUBSTR(in_pif_full_agency_number,5,3)\n\tSUBSTR(in_pif_full_agency_number, 1, 2) || SUBSTR(in_pif_full_agency_number, 5, 3) AS v_agency_key,\n\tv_agency_key AS agency_key,\n\tpif_producer_code AS in_pif_producer_code,\n\t-- *INF*: iif(isnull(in_pif_producer_code) or IS_SPACES(in_pif_producer_code) or LENGTH(in_pif_producer_code)=0,'N/A',LTRIM(RTRIM(in_pif_producer_code)))\n\tIFF(in_pif_producer_code IS NULL OR IS_SPACES(in_pif_producer_code) OR LENGTH(in_pif_producer_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_producer_code))) AS producer_code,\n\t-- *INF*: substr(in_pif_symbol,1,2)\n\tsubstr(in_pif_symbol, 1, 2) AS pkg_code,\n\twb_class_of_business AS in_wb_class_of_business,\n\t-- *INF*: LTRIM(RTRIM(in_wb_class_of_business))\n\tLTRIM(RTRIM(in_wb_class_of_business)) AS v_wb_class_of_business1,\n\t-- *INF*: iif(isnull(v_wb_class_of_business1) or IS_SPACES(v_wb_class_of_business1) or LENGTH(v_wb_class_of_business1)=0,'N/A',v_wb_class_of_business1)\n\tIFF(v_wb_class_of_business1 IS NULL OR IS_SPACES(v_wb_class_of_business1) OR LENGTH(v_wb_class_of_business1) = 0, 'N/A', v_wb_class_of_business1) AS v_wb_class_of_business2,\n\tpif_target_market_code AS in_pif_target_market_code,\n\t-- *INF*: iif(isnull(in_pif_target_market_code) or IS_SPACES(in_pif_target_market_code) or LENGTH(in_pif_target_market_code)=0,'N/A',LTRIM(RTRIM(in_pif_target_market_code)))\n\tIFF(in_pif_target_market_code IS NULL OR IS_SPACES(in_pif_target_market_code) OR LENGTH(in_pif_target_market_code) = 0, 'N/A', LTRIM(RTRIM(in_pif_target_market_code))) AS pif_target_market_code,\n\t-- *INF*: --:LKP.LKP_MARKETING_AK_ID(pif_target_market_code,pkg_code,prog_code)\n\t'' AS v_marketing_ak_id,\n\t-1 AS emp_id,\n\t-- *INF*: --:LKP.LKP_PRODUCER_CODE_AK_ID(v_producer_code,v_agency_key,emp_id)\n\t'' AS v_producer_code_ak_id,\n\t-- *INF*: iif(isnull(v_marketing_ak_id),-1,v_marketing_ak_id)\n\tIFF(v_marketing_ak_id IS NULL, - 1, v_marketing_ak_id) AS mrktng_ak_id,\n\t-- *INF*: iif(isnull(v_producer_code_ak_id),-1,v_producer_code_ak_id)\n\tIFF(v_producer_code_ak_id IS NULL, - 1, v_producer_code_ak_id) AS producer_code_ak_id,\n\t-- *INF*: --:LKP.LKP_SUB_ASSOCIATION_PROGRAM_CODE(v_wb_class_of_business)\n\t'' AS v_sub_association_program_type,\n\tv_wb_class_of_business2 AS ClassOfBusiness,\n\t-- *INF*: IIF(v_pif_prgm_id='N/A',v_wb_class_of_business2,v_pif_prgm_id)\n\tIFF(v_pif_prgm_id = 'N/A', v_wb_class_of_business2, v_pif_prgm_id) AS ProgramCode,\n\t-- *INF*:   IIF(  SIGN(DATE_DIFF(v_pol_eff_date ,sysdate , 'DD')) <= 0 AND (\r\n\t--      SIGN(DATE_DIFF(sysdate,v_pol_exp_date , 'DD'))  <= 0 OR    SIGN(DATE_DIFF(sysdate,v_pol_cancellation_date , 'DD'))  <= 0 ), 'I',\r\n\t-- IIF(\r\n\t--  SIGN(DATE_DIFF(v_pol_cancellation_date ,sysdate , 'DD')) < 0 , 'C',\r\n\t-- IIF(\r\n\t--  SIGN(DATE_DIFF(v_pol_exp_date ,sysdate , 'DD')) <= 0\r\n\t-- and   ( TO_INTEGER(in_pif_renewal_code) < 9)\r\n\t-- , 'E', 'O'\r\n\t-- ) ))\r\n\t--  \r\n\t-- --- Not used at this time.\r\n\t-- -- Set to \"\"Inforce\"\" when policy effective date <= Current ?Date  AND Minimum of the Policy Expiration Date or Policy Cancellation Date => Current Date\r\n\t-- ---  Set to \"\"Cancelled\"\"  when Policy Cancellation Date < Current Date \r\n\t-- --- Set to \"\"Expired\"\" when Policy Expiration Date <= Current Date AND  PIF-RENEWAL-CODE < 9\r\n\t-- --- Set to \"\"Other\"\" for all policies that don't meet the criteria listed above.\n\tIFF(SIGN(DATE_DIFF(v_pol_eff_date, sysdate, 'DD')) <= 0 AND ( SIGN(DATE_DIFF(sysdate, v_pol_exp_date, 'DD')) <= 0 OR SIGN(DATE_DIFF(sysdate, v_pol_cancellation_date, 'DD')) <= 0 ), 'I', IFF(SIGN(DATE_DIFF(v_pol_cancellation_date, sysdate, 'DD')) < 0, 'C', IFF(SIGN(DATE_DIFF(v_pol_exp_date, sysdate, 'DD')) <= 0 AND ( TO_INTEGER(in_pif_renewal_code) < 9 ), 'E', 'O'))) AS v_policy_status_code1,\n\t'N/A' AS v_policy_status_code2,\n\tv_policy_status_code2 AS policy_status_code,\n\tPolicyOfferingCode,\n\tPolicyOfferingAKId,\n\tObligeeName,\n\tAutomatedUnderwritingServicesIndicator,\n\tAutomaticRenewalIndicator,\n\tv_wb_class_of_business1 AS o_ClassOfBusiness,\n\tpif_dc_bill_ind\n\tFROM FIL_MIN\n),\nLKP_AgencyAKId AS (\n\tSELECT\n\tAgencyAKId,\n\tAgencyCode\n\tFROM (\n\t\tSELECT \n\t\t\tAgencyAKId,\n\t\t\tAgencyCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER_V2}.Agency\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyCode ORDER BY AgencyAKId) = 1\n),\nLKP_AgencyEmployee AS (\n\tSELECT\n\tAgencyEmployeeAKID,\n\tAgencyAKID,\n\tProducerCode\n\tFROM (\n\t\tSELECT \r\n\t\tAgencyEmployee.AgencyEmployeeAKID as AgencyEmployeeAKID, \r\n\t\tAgencyEmployee.AgencyEmployeeRole as AgencyEmployeeRole, \r\n\t\tAgencyEmployee.AgencyAKID as AgencyAKID, \r\n\t\tAgencyEmployee.ProducerCode as ProducerCode \r\n\t\tFROM \r\n\t\tAgencyEmployee\r\n\t\twhere CurrentSnapshotFlag=1\r\n\t\torder by AgencyEmployeeAKID, ProducerCode, case when AgencyEmployeeRole = 'Principal' then 1 else 2 END, AgencyEmployeeID --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,ProducerCode ORDER BY AgencyEmployeeAKID) = 1\n),\nLKP_Association AS (\n\tSELECT\n\tAssociationCode\n\tFROM (\n\t\tSELECT \n\t\t\tAssociationCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.Association\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AssociationCode ORDER BY AssociationCode) = 1\n),\nLKP_Policy AS (\n\tSELECT\n\tpol_id,\n\tpol_ak_id,\n\tcontract_cust_ak_id,\n\tagency_ak_id,\n\tAgencyAKId,\n\tmco,\n\tpol_co_num,\n\tpol_eff_date,\n\tpol_exp_date,\n\torig_incptn_date,\n\tprim_bus_class_code,\n\treins_code,\n\tpms_pol_lob_code,\n\tpol_co_line_code,\n\tpol_cancellation_ind,\n\tpol_cancellation_date,\n\tpol_cancellation_rsn_code,\n\tstate_of_domicile_code,\n\twbconnect_upload_code,\n\tserv_center_support_code,\n\tpol_term,\n\tterrorism_risk_ind,\n\tprior_pol_key,\n\tpol_status_code,\n\tpol_issue_code,\n\tpol_age,\n\tindustry_risk_grade_code,\n\tuw_review_yr,\n\tmvr_request_code,\n\trenl_code,\n\tamend_num,\n\tanniversary_rerate_code,\n\tpol_audit_frqncy,\n\tfinal_audit_code,\n\tzip_ind,\n\tguarantee_ind,\n\tvariation_code,\n\tcounty,\n\tnon_smoker_disc_code,\n\trenl_disc,\n\trenl_safe_driver_disc_count,\n\tnonrenewal_flag_date,\n\taudit_complt_date,\n\torig_acct_date,\n\tpol_enter_date,\n\texcess_claim_code,\n\tpol_status_on_pif,\n\ttarget_mrkt_code,\n\tpkg_code,\n\tbus_seg_code,\n\tpif_upload_audit_ind,\n\tproducer_code_ak_id,\n\tprdcr_code,\n\tClassOfBusiness,\n\tstrtgc_bus_dvsn_ak_id,\n\tRenewalPolicyNumber,\n\tRenewalPolicySymbol,\n\tRenewalPolicyMod,\n\tBillingType,\n\tstrtgc_bus_dvsn_code,\n\tPolicyOfferingCode,\n\tProgramCode,\n\tproducer_code_id,\n\tstrtgc_bus_dvsn_id,\n\tsup_bus_class_code_id,\n\tsup_pol_term_id,\n\tsup_pol_status_code_id,\n\tsup_pol_issue_code_id,\n\tsup_pol_audit_frqncy_id,\n\tsup_industry_risk_grade_code_id,\n\tsup_state_id,\n\tSurchargeExemptCode,\n\tSupSurchargeExemptID,\n\tStrategicProfitCenterAKId,\n\tInsuranceSegmentAKId,\n\tPolicyOfferingAKId,\n\tProgramAKId,\n\tObligeeName,\n\tAutomatedUnderwritingServicesIndicator,\n\tAutomaticRenewalIndicator,\n\tAssociationCode,\n\tAgencyEmployeeAKId,\n\tpol_key\n\tFROM (\n\t\tSELECT \n\t\t\tpol_id,\n\t\t\tpol_ak_id,\n\t\t\tcontract_cust_ak_id,\n\t\t\tagency_ak_id,\n\t\t\tAgencyAKId,\n\t\t\tmco,\n\t\t\tpol_co_num,\n\t\t\tpol_eff_date,\n\t\t\tpol_exp_date,\n\t\t\torig_incptn_date,\n\t\t\tprim_bus_class_code,\n\t\t\treins_code,\n\t\t\tpms_pol_lob_code,\n\t\t\tpol_co_line_code,\n\t\t\tpol_cancellation_ind,\n\t\t\tpol_cancellation_date,\n\t\t\tpol_cancellation_rsn_code,\n\t\t\tstate_of_domicile_code,\n\t\t\twbconnect_upload_code,\n\t\t\tserv_center_support_code,\n\t\t\tpol_term,\n\t\t\tterrorism_risk_ind,\n\t\t\tprior_pol_key,\n\t\t\tpol_status_code,\n\t\t\tpol_issue_code,\n\t\t\tpol_age,\n\t\t\tindustry_risk_grade_code,\n\t\t\tuw_review_yr,\n\t\t\tmvr_request_code,\n\t\t\trenl_code,\n\t\t\tamend_num,\n\t\t\tanniversary_rerate_code,\n\t\t\tpol_audit_frqncy,\n\t\t\tfinal_audit_code,\n\t\t\tzip_ind,\n\t\t\tguarantee_ind,\n\t\t\tvariation_code,\n\t\t\tcounty,\n\t\t\tnon_smoker_disc_code,\n\t\t\trenl_disc,\n\t\t\trenl_safe_driver_disc_count,\n\t\t\tnonrenewal_flag_date,\n\t\t\taudit_complt_date,\n\t\t\torig_acct_date,\n\t\t\tpol_enter_date,\n\t\t\texcess_claim_code,\n\t\t\tpol_status_on_pif,\n\t\t\ttarget_mrkt_code,\n\t\t\tpkg_code,\n\t\t\tbus_seg_code,\n\t\t\tpif_upload_audit_ind,\n\t\t\tproducer_code_ak_id,\n\t\t\tprdcr_code,\n\t\t\tClassOfBusiness,\n\t\t\tstrtgc_bus_dvsn_ak_id,\n\t\t\tRenewalPolicyNumber,\n\t\t\tRenewalPolicySymbol,\n\t\t\tRenewalPolicyMod,\n\t\t\tBillingType,\n\t\t\tstrtgc_bus_dvsn_code,\n\t\t\tPolicyOfferingCode,\n\t\t\tProgramCode,\n\t\t\tproducer_code_id,\n\t\t\tstrtgc_bus_dvsn_id,\n\t\t\tsup_bus_class_code_id,\n\t\t\tsup_pol_term_id,\n\t\t\tsup_pol_status_code_id,\n\t\t\tsup_pol_issue_code_id,\n\t\t\tsup_pol_audit_frqncy_id,\n\t\t\tsup_industry_risk_grade_code_id,\n\t\t\tsup_state_id,\n\t\t\tSurchargeExemptCode,\n\t\t\tSupSurchargeExemptID,\n\t\t\tStrategicProfitCenterAKId,\n\t\t\tInsuranceSegmentAKId,\n\t\t\tPolicyOfferingAKId,\n\t\t\tProgramAKId,\n\t\t\tObligeeName,\n\t\t\tAutomatedUnderwritingServicesIndicator,\n\t\t\tAutomaticRenewalIndicator,\n\t\t\tAssociationCode,\n\t\t\tAgencyEmployeeAKId,\n\t\t\tpol_key\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key ORDER BY pol_id) = 1\n),\nLKP_sup_association_program_code AS (\n\tSELECT\n\tassoc_prog_code\n\tFROM (\n\t\tSELECT \n\t\t\tassoc_prog_code\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_association_program_code\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}' AND assoc_prog_type='Program'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY assoc_prog_code ORDER BY assoc_prog_code) = 1\n),\nLKP_ProgramAKId AS (\n\tSELECT\n\tProgramAKId,\n\tin_ProgramCode,\n\tProgramCode\n\tFROM (\n\t\tSELECT \n\t\t\tProgramAKId,\n\t\t\tin_ProgramCode,\n\t\t\tProgramCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.Program\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ProgramCode ORDER BY ProgramAKId) = 1\n),\nLKP_PIF_12_stage AS (\n\tSELECT\n\tuse_code,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module\n\tFROM (\n\t\tSELECT \n\t\t\tuse_code,\n\t\t\tpif_symbol,\n\t\t\tpif_policy_number,\n\t\t\tpif_module\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_12_stage\n\t\tWHERE use_code in ('EA','EP')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module ORDER BY use_code) = 1\n),\nexp_user_code AS (\n\tSELECT\n\tuse_code AS in_use_code,\n\t-- *INF*: IIF(IN(in_use_code,'EA','EP'),in_use_code,'N/A')\n\tIFF(IN(in_use_code, 'EA', 'EP'), in_use_code, 'N/A') AS out_use_code\n\tFROM LKP_PIF_12_stage\n),\nLKP_SupSurchargeExempt AS (\n\tSELECT\n\tSupSurchargeExemptId,\n\tSurchargeExemptCode\n\tFROM (\n\t\tSELECT \n\t\t\tSupSurchargeExemptId,\n\t\t\tSurchargeExemptCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupSurchargeExempt\n\t\tWHERE CurrentSnapshotFlag=1 AND SourceSystemId='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SurchargeExemptCode ORDER BY SupSurchargeExemptId) = 1\n),\nLKP_agency_ak_id AS (\n\tSELECT\n\tagency_ak_id,\n\tagency_key\n\tFROM (\n\t\tSELECT \n\t\t\tagency_ak_id,\n\t\t\tagency_key\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.agency\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_key ORDER BY agency_ak_id) = 1\n),\nLKP_contract_customer_key AS (\n\tSELECT\n\tcontract_cust_ak_id,\n\tcontract_key\n\tFROM (\n\t\tSELECT \r\n\t\tcontract_customer.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\tltrim(rtrim(contract_customer.contract_key)) as contract_key \r\n\t\tFROM \r\n\t\tcontract_customer\r\n\t\tWHERE contract_customer.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY contract_key ORDER BY contract_cust_ak_id DESC) = 1\n),\nLKP_producer_code_ak_id AS (\n\tSELECT\n\tproducer_code_id,\n\tprdcr_code_ak_id,\n\tproducer_code,\n\tagency_key\n\tFROM (\n\t\tSELECT \r\n\t\ta.producer_code_id as producer_code_id,\r\n\t\ta.prdcr_code_ak_id as prdcr_code_ak_id, \r\n\t\tltrim(rtrim(a.producer_code)) as producer_code, \r\n\t\tltrim(rtrim(a.agency_key)) as agency_key\r\n\t\tFROM \r\n\t\t@{pipeline().parameters.TARGET_TABLE_OWNER}.producer_code a\r\n\t\tWHERE a.crrnt_snpsht_flag=1 AND a.source_sys_id = '@{pipeline().parameters.AGENCY_SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY producer_code,agency_key ORDER BY producer_code_id DESC) = 1\n),\nLKP_sup_business_classification_code AS (\n\tSELECT\n\tsup_bus_class_code_id,\n\tbus_class_code\n\tFROM (\n\t\tSELECT \n\t\t\tsup_bus_class_code_id,\n\t\t\tbus_class_code\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_business_classification_code\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY bus_class_code ORDER BY sup_bus_class_code_id) = 1\n),\nLKP_sup_industry_risk_grade_code AS (\n\tSELECT\n\tsup_industry_risk_grade_code_id,\n\tindustry_risk_grade_code\n\tFROM (\n\t\tSELECT \n\t\t\tsup_industry_risk_grade_code_id,\n\t\t\tindustry_risk_grade_code\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_industry_risk_grade_code\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY industry_risk_grade_code ORDER BY sup_industry_risk_grade_code_id) = 1\n),\nLKP_sup_policy_audit_frequency AS (\n\tSELECT\n\tsup_pol_audit_frqncy_id,\n\tpol_audit_frqncy\n\tFROM (\n\t\tSELECT \n\t\t\tsup_pol_audit_frqncy_id,\n\t\t\tpol_audit_frqncy\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_policy_audit_frequency\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_audit_frqncy ORDER BY sup_pol_audit_frqncy_id) = 1\n),\nLKP_sup_policy_status_code AS (\n\tSELECT\n\tsup_pol_status_code_id,\n\tpol_status_code\n\tFROM (\n\t\tSELECT \n\t\t\tsup_pol_status_code_id,\n\t\t\tpol_status_code\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_policy_status_code\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_status_code ORDER BY sup_pol_status_code_id) = 1\n),\nLKP_sup_policy_term AS (\n\tSELECT\n\tsup_pol_term_id,\n\tpol_term\n\tFROM (\n\t\tSELECT \n\t\t\tsup_pol_term_id,\n\t\t\tpol_term\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_policy_term\n\t\tWHERE crrnt_snpsht_flag=1 AND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_term ORDER BY sup_pol_term_id) = 1\n),\nLKP_sup_state AS (\n\tSELECT\n\tsup_state_id,\n\tstate_abbrev\n\tFROM (\n\t\tSELECT \n\t\t\tsup_state_id,\n\t\t\tstate_abbrev\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_state\n\t\tWHERE crrnt_snpsht_flag = 1 AND source_sys_id = 'EXCEED'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY state_abbrev ORDER BY sup_state_id) = 1\n),\nmplt_PMS_StrategicProfitCenterInsuranceSegment AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_Compute_AS400_Values AS (\n\t\tSELECT\n\t\tpif_symbol AS in_pif_symbol,\n\t\tpif_pol_number AS in_pif_pol_number,\n\t\tpif_lob_code AS in_pif_lob_code,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- \tIN(in_pif_symbol,'HXX','HXY') AND IN (in_pif_lob_code,'HAP','HP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'PXX','PXY') AND IN (in_pif_lob_code,'APV','HAP','HP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'PXX','PXY') AND IN (in_pif_lob_code,'ACV','AFV','BO','CF','SMP'),\r\n\t\t-- \t'2',\r\n\t\t-- --Modifying the ETL code to assign strategicProfitCenter as \"WB-CL\" if the policy Symbol start with \"SM\" and Policies LOB ='SMP'\r\n\t\t--       IN(SUBSTR(in_pif_symbol,1,2),'SM') AND IN(in_pif_lob_code,'SMP'),\r\n\t\t--       '2',\r\n\t\t-- \tIN(in_pif_symbol,'WMM','WMY','WXX','WXY') AND IN (in_pif_lob_code,'WC'),\r\n\t\t-- \t'2',\r\n\t\t-- \tIN(in_pif_symbol,'XAA','XAY','XXX','XXY') AND IN (in_pif_lob_code,'APV','HAP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'XAA','XAY','XXX','XXY') AND IN (in_pif_lob_code,'ACV','AFV','BO','GL','SMP','WC'),\r\n\t\t-- \t'2',\r\n\t\t-- \t'N/A'\r\n\t\t-- )\n\t\tDECODE(TRUE,\n\t\tIN(in_pif_symbol, 'HXX', 'HXY') AND IN(in_pif_lob_code, 'HAP', 'HP'), '1',\n\t\tIN(in_pif_symbol, 'PXX', 'PXY') AND IN(in_pif_lob_code, 'APV', 'HAP', 'HP'), '1',\n\t\tIN(in_pif_symbol, 'PXX', 'PXY') AND IN(in_pif_lob_code, 'ACV', 'AFV', 'BO', 'CF', 'SMP'), '2',\n\t\tIN(SUBSTR(in_pif_symbol, 1, 2), 'SM') AND IN(in_pif_lob_code, 'SMP'), '2',\n\t\tIN(in_pif_symbol, 'WMM', 'WMY', 'WXX', 'WXY') AND IN(in_pif_lob_code, 'WC'), '2',\n\t\tIN(in_pif_symbol, 'XAA', 'XAY', 'XXX', 'XXY') AND IN(in_pif_lob_code, 'APV', 'HAP'), '1',\n\t\tIN(in_pif_symbol, 'XAA', 'XAY', 'XXX', 'XXY') AND IN(in_pif_lob_code, 'ACV', 'AFV', 'BO', 'GL', 'SMP', 'WC'), '2',\n\t\t'N/A') AS v_AS400_StrategicProfitCenterCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- \tIN(in_pif_symbol,'HXX','HXY') AND IN (in_pif_lob_code,'HAP','HP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'PXX','PXY') AND IN (in_pif_lob_code,'APV','HAP','HP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'PXX','PXY') AND IN (in_pif_lob_code,'ACV','AFV','BO','CF','SMP'),\r\n\t\t-- \t'2',\r\n\t\t-- --Modifying the ETL code to assign InsuranceSegment as \"Commercial-LIne\"  if the policy Symbol start with \"SM\" and Policies LOB ='SMP'\r\n\t\t--       IN(SUBSTR(in_pif_symbol,1,2),'SM') AND IN(in_pif_lob_code,'SMP'),\r\n\t\t--       '2',\r\n\t\t-- \tIN(in_pif_symbol,'WMM','WMY','WXX','WXY') AND IN (in_pif_lob_code,'WC'),\r\n\t\t-- \t'2',\r\n\t\t-- \tIN(in_pif_symbol,'XAA','XAY','XXX','XXY') AND IN (in_pif_lob_code,'APV','HAP'),\r\n\t\t-- \t'1',\r\n\t\t-- \tIN(in_pif_symbol,'XAA','XAY','XXX','XXY') AND IN (in_pif_lob_code,'ACV','AFV','BO','GL','SMP','WC'),\r\n\t\t-- \t'2',\r\n\t\t-- \t'N/A'\r\n\t\t-- )\n\t\tDECODE(TRUE,\n\t\tIN(in_pif_symbol, 'HXX', 'HXY') AND IN(in_pif_lob_code, 'HAP', 'HP'), '1',\n\t\tIN(in_pif_symbol, 'PXX', 'PXY') AND IN(in_pif_lob_code, 'APV', 'HAP', 'HP'), '1',\n\t\tIN(in_pif_symbol, 'PXX', 'PXY') AND IN(in_pif_lob_code, 'ACV', 'AFV', 'BO', 'CF', 'SMP'), '2',\n\t\tIN(SUBSTR(in_pif_symbol, 1, 2), 'SM') AND IN(in_pif_lob_code, 'SMP'), '2',\n\t\tIN(in_pif_symbol, 'WMM', 'WMY', 'WXX', 'WXY') AND IN(in_pif_lob_code, 'WC'), '2',\n\t\tIN(in_pif_symbol, 'XAA', 'XAY', 'XXX', 'XXY') AND IN(in_pif_lob_code, 'APV', 'HAP'), '1',\n\t\tIN(in_pif_symbol, 'XAA', 'XAY', 'XXX', 'XXY') AND IN(in_pif_lob_code, 'ACV', 'AFV', 'BO', 'GL', 'SMP', 'WC'), '2',\n\t\t'N/A') AS v_AS400_InsuranceSegmentCode,\n\t\tv_AS400_StrategicProfitCenterCode AS out_AS400_StrategicProfitCenterCode1,\n\t\tv_AS400_InsuranceSegmentCode AS out_AS400_InsuranceSegmentCode1,\n\t\t-- *INF*: IIF(v_AS400_StrategicProfitCenterCode= 'N/A',\r\n\t\t-- SUBSTR(in_pif_symbol,1,1),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(v_AS400_StrategicProfitCenterCode = 'N/A', SUBSTR(in_pif_symbol, 1, 1), '') AS out_PMS_pol_sym_1,\n\t\t-- *INF*: IIF(v_AS400_StrategicProfitCenterCode= 'N/A',\r\n\t\t-- SUBSTR(in_pif_pol_number,1,1),\r\n\t\t-- '')\n\t\tIFF(v_AS400_StrategicProfitCenterCode = 'N/A', SUBSTR(in_pif_pol_number, 1, 1), '') AS out_PMS_pol_num_1\n\t\tFROM INPUT\n\t),\n\tLKP_SupStrategicProfitCenterInsuranceSegment AS (\n\t\tSELECT\n\t\tStrategicProfitCenterCode,\n\t\tInsuranceSegmentCode,\n\t\tPolicySymbol1,\n\t\tPolicyNumber1\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tStrategicProfitCenterCode,\n\t\t\t\tInsuranceSegmentCode,\n\t\t\t\tPolicySymbol1,\n\t\t\t\tPolicyNumber1\n\t\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupStrategicProfitCenterInsuranceSegment\n\t\t\tWHERE CurrentSnapshotFlag=1 AND SourceCode='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicySymbol1,PolicyNumber1 ORDER BY StrategicProfitCenterCode) = 1\n\t),\n\tEXP_Select_StrategicProfitCenter_InsuranceSegment AS (\n\t\tSELECT\n\t\tEXP_Compute_AS400_Values.out_AS400_StrategicProfitCenterCode1 AS in_AS400_StrategicProfitCenterCode,\n\t\tEXP_Compute_AS400_Values.out_AS400_InsuranceSegmentCode1 AS in_AS400_InsuranceSegmentCode,\n\t\tLKP_SupStrategicProfitCenterInsuranceSegment.StrategicProfitCenterCode AS in_PMS_StrategicProfitCenterCode,\n\t\tLKP_SupStrategicProfitCenterInsuranceSegment.InsuranceSegmentCode AS in_PMS_InsuranceSegmentCode,\n\t\t-- *INF*: IIF(in_AS400_StrategicProfitCenterCode= 'N/A',\r\n\t\t-- in_PMS_StrategicProfitCenterCode,\r\n\t\t-- in_AS400_StrategicProfitCenterCode\r\n\t\t-- )\n\t\tIFF(in_AS400_StrategicProfitCenterCode = 'N/A', in_PMS_StrategicProfitCenterCode, in_AS400_StrategicProfitCenterCode) AS v_StrategicProfitCenterCode,\n\t\t-- *INF*: IIF(in_AS400_InsuranceSegmentCode='N/A',\r\n\t\t-- in_PMS_InsuranceSegmentCode,\r\n\t\t-- in_AS400_InsuranceSegmentCode\r\n\t\t-- )\n\t\tIFF(in_AS400_InsuranceSegmentCode = 'N/A', in_PMS_InsuranceSegmentCode, in_AS400_InsuranceSegmentCode) AS v_InsuranceSegmentCode,\n\t\tv_StrategicProfitCenterCode AS out_StrategicProfitCenterCode,\n\t\tv_InsuranceSegmentCode AS out_InsuranceSegmentCode\n\t\tFROM EXP_Compute_AS400_Values\n\t\tLEFT JOIN LKP_SupStrategicProfitCenterInsuranceSegment\n\t\tON LKP_SupStrategicProfitCenterInsuranceSegment.PolicySymbol1 = EXP_Compute_AS400_Values.out_PMS_pol_sym_1 AND LKP_SupStrategicProfitCenterInsuranceSegment.PolicyNumber1 = EXP_Compute_AS400_Values.out_PMS_pol_num_1\n\t),\n\tLKP_InsuranceSegmentAKId AS (\n\t\tSELECT\n\t\tInsuranceSegmentAKId,\n\t\tInsuranceSegmentCode\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tInsuranceSegmentAKId,\n\t\t\t\tInsuranceSegmentCode\n\t\t\tFROM InsuranceSegment\n\t\t\tWHERE CurrentSnapshotFlag=1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceSegmentCode ORDER BY InsuranceSegmentAKId) = 1\n\t),\n\tLKP_StrategicProfitCenterAKId AS (\n\t\tSELECT\n\t\tStrategicProfitCenterAKId,\n\t\tStrategicProfitCenterCode\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tStrategicProfitCenterAKId,\n\t\t\t\tStrategicProfitCenterCode\n\t\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.StrategicProfitCenter\n\t\t\tWHERE CurrentSnapshotFlag=1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StrategicProfitCenterCode ORDER BY StrategicProfitCenterAKId) = 1\n\t),\n\tEXP_Null_Check AS (\n\t\tSELECT\n\t\tLKP_StrategicProfitCenterAKId.StrategicProfitCenterAKId AS in_StrategicProfitCenterAKId,\n\t\tLKP_InsuranceSegmentAKId.InsuranceSegmentAKId AS in_InsuranceSegmentAKId,\n\t\t-- *INF*: IIF(ISNULL(in_StrategicProfitCenterAKId),\r\n\t\t-- -1,\r\n\t\t-- in_StrategicProfitCenterAKId)\n\t\tIFF(in_StrategicProfitCenterAKId IS NULL, - 1, in_StrategicProfitCenterAKId) AS v_StrategicProfitCenterAKId,\n\t\t-- *INF*: IIF(ISNULL(in_InsuranceSegmentAKId),\r\n\t\t-- -1,\r\n\t\t-- in_InsuranceSegmentAKId)\n\t\tIFF(in_InsuranceSegmentAKId IS NULL, - 1, in_InsuranceSegmentAKId) AS v_InsuranceSegmentAKId,\n\t\tv_StrategicProfitCenterAKId AS out_StrategicProfitCenterAKId,\n\t\tv_InsuranceSegmentAKId AS out_InsuranceSegmentAKId\n\t\tFROM \n\t\tLEFT JOIN LKP_InsuranceSegmentAKId\n\t\tON LKP_InsuranceSegmentAKId.InsuranceSegmentCode = EXP_Select_StrategicProfitCenter_InsuranceSegment.out_InsuranceSegmentCode\n\t\tLEFT JOIN LKP_StrategicProfitCenterAKId\n\t\tON LKP_StrategicProfitCenterAKId.StrategicProfitCenterCode = EXP_Select_StrategicProfitCenter_InsuranceSegment.out_StrategicProfitCenterCode\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tout_StrategicProfitCenterAKId AS StrategicProfitCenterAKId, \n\t\tout_InsuranceSegmentAKId AS InsuranceSegmentAKId\n\t\tFROM EXP_Null_Check\n\t),\n),\nmplt_Strategic_Business_Division AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A','N/A',substr(ltrim(rtrim(policy_symbol)),1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(ltrim(rtrim(policy_symbol)), 1, 1)) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(ltrim(rtrim(policy_number)),1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(ltrim(rtrim(policy_number)), 1, 1)) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, SYSDATE, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id,\n\t\tstrtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_id,\n\t\t\t\tstrtgc_bus_dvsn_ak_id,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date\n\t\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.strategic_business_division\n\t\t\tWHERE crrnt_snpsht_flag = 1 AND source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id,\n\t\tstrtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_id),-1,strtgc_bus_dvsn_id)\n\t\tIFF(strtgc_bus_dvsn_id IS NULL, - 1, strtgc_bus_dvsn_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_ak_id),-1,strtgc_bus_dvsn_ak_id)\n\t\tIFF(strtgc_bus_dvsn_ak_id IS NULL, - 1, strtgc_bus_dvsn_ak_id) AS strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_Strategic_Business_Division\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_id, \n\t\tstrtgc_bus_dvsn_ak_id_out AS strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tLKP_Policy.pol_id AS lkp_pol_id,\n\tLKP_Policy.pol_ak_id AS lkp_pol_ak_id,\n\tLKP_Policy.contract_cust_ak_id AS lkp_contract_cust_ak_id,\n\tLKP_Policy.agency_ak_id AS lkp_agency_ak_id,\n\tLKP_Policy.AgencyAKId AS lkp_AgencyAKId,\n\tLKP_Policy.mco AS lkp_mco,\n\tLKP_Policy.pol_co_num AS lkp_pol_co_num,\n\tLKP_Policy.pol_eff_date AS lkp_pol_eff_date,\n\tLKP_Policy.pol_exp_date AS lkp_pol_exp_date,\n\tLKP_Policy.orig_incptn_date AS lkp_orig_incptn_date,\n\tLKP_Policy.prim_bus_class_code AS lkp_prim_bus_class_code,\n\tLKP_Policy.reins_code AS lkp_reins_code,\n\tLKP_Policy.pms_pol_lob_code AS lkp_pms_pol_lob_code,\n\tLKP_Policy.pol_co_line_code AS lkp_pol_co_line_code,\n\tLKP_Policy.pol_cancellation_ind AS lkp_pol_cancellation_ind,\n\tLKP_Policy.pol_cancellation_date AS lkp_pol_cancellation_date,\n\tLKP_Policy.pol_cancellation_rsn_code AS lkp_pol_cancellation_rsn_code,\n\tLKP_Policy.state_of_domicile_code AS lkp_state_of_domicile_code,\n\tLKP_Policy.wbconnect_upload_code AS lkp_wbconnect_upload_code,\n\tLKP_Policy.serv_center_support_code AS lkp_serv_center_support_code,\n\tLKP_Policy.pol_term AS lkp_pol_term,\n\tLKP_Policy.terrorism_risk_ind AS lkp_terrorism_risk_ind,\n\tLKP_Policy.prior_pol_key AS lkp_prior_pol_key,\n\tLKP_Policy.pol_status_code AS lkp_pol_status_code,\n\tLKP_Policy.pol_issue_code AS lkp_pol_issue_code,\n\tLKP_Policy.pol_age AS lkp_pol_age,\n\tLKP_Policy.industry_risk_grade_code AS lkp_industry_risk_grade_code,\n\tLKP_Policy.uw_review_yr AS lkp_uw_review_yr,\n\tLKP_Policy.mvr_request_code AS lkp_mvr_request_code,\n\tLKP_Policy.renl_code AS lkp_renl_code,\n\tLKP_Policy.amend_num AS lkp_amend_num,\n\tLKP_Policy.anniversary_rerate_code AS lkp_anniversary_rerate_code,\n\tLKP_Policy.pol_audit_frqncy AS lkp_pol_audit_frqncy,\n\tLKP_Policy.final_audit_code AS lkp_final_audit_code,\n\tLKP_Policy.zip_ind AS lkp_zip_ind,\n\tLKP_Policy.guarantee_ind AS lkp_guarantee_ind,\n\tLKP_Policy.variation_code AS lkp_variation_code,\n\tLKP_Policy.county AS lkp_county,\n\tLKP_Policy.non_smoker_disc_code AS lkp_non_smoker_disc_code,\n\tLKP_Policy.renl_disc AS lkp_renl_disc,\n\tLKP_Policy.renl_safe_driver_disc_count AS lkp_renl_safe_driver_disc_count,\n\tLKP_Policy.nonrenewal_flag_date AS lkp_nonrenewal_flag_date,\n\tLKP_Policy.audit_complt_date AS lkp_audit_complt_date,\n\tLKP_Policy.orig_acct_date AS lkp_orig_acct_date,\n\tLKP_Policy.pol_enter_date AS lkp_pol_enter_date,\n\tLKP_Policy.excess_claim_code AS lkp_excess_claim_code,\n\tLKP_Policy.pol_status_on_pif AS lkp_pol_status_on_pif,\n\tLKP_Policy.target_mrkt_code AS lkp_target_mrkt_code,\n\tLKP_Policy.pkg_code AS lkp_pkg_code,\n\tLKP_Policy.bus_seg_code AS lkp_bus_seg_code,\n\tLKP_Policy.pif_upload_audit_ind AS lkp_pif_upload_audit_ind,\n\tLKP_Policy.producer_code_ak_id AS lkp_producer_code_ak_id,\n\tLKP_Policy.prdcr_code AS lkp_prdcr_code,\n\tLKP_Policy.ClassOfBusiness AS lkp_ClassOfBusiness,\n\tLKP_Policy.strtgc_bus_dvsn_ak_id AS lkp_strtgc_bus_dvsn_ak_id,\n\tLKP_Policy.RenewalPolicyNumber AS lkp_RenewalPolicyNumber,\n\tLKP_Policy.RenewalPolicySymbol AS lkp_RenewalPolicySymbol,\n\tLKP_Policy.RenewalPolicyMod AS lkp_RenewalPolicyMod,\n\tLKP_Policy.BillingType AS lkp_BillingType,\n\tLKP_Policy.producer_code_id AS lkp_producer_code_id,\n\tLKP_Policy.sup_bus_class_code_id AS lkp_sup_bus_class_code_id,\n\tLKP_Policy.sup_pol_term_id AS lkp_sup_pol_term_id,\n\tLKP_Policy.sup_pol_status_code_id AS lkp_sup_pol_status_code_id,\n\tLKP_Policy.sup_pol_issue_code_id AS lkp_sup_pol_issue_code_id,\n\tLKP_Policy.sup_pol_audit_frqncy_id AS lkp_sup_pol_audit_frqncy_id,\n\tLKP_Policy.sup_industry_risk_grade_code_id AS lkp_sup_industry_risk_grade_code_id,\n\tLKP_Policy.sup_state_id AS lkp_sup_state_id,\n\tLKP_Policy.SurchargeExemptCode AS lkp_SurchargeExemptCode,\n\tLKP_Policy.SupSurchargeExemptID AS lkp_SupSurchargeExemptID,\n\tLKP_Policy.StrategicProfitCenterAKId AS lkp_StrategicProfitCenterAKId,\n\tLKP_Policy.InsuranceSegmentAKId AS lkp_InsuranceSegmentAKId,\n\tLKP_Policy.PolicyOfferingAKId AS lkp_PolicyOfferingAKId,\n\tLKP_Policy.ProgramAKId AS lkp_ProgramAKId,\n\tLKP_Policy.ObligeeName AS lkp_ObligeeName,\n\tLKP_Policy.AutomatedUnderwritingServicesIndicator AS lkp_AutomatedUnderwritingServicesIndicator,\n\tLKP_Policy.AutomaticRenewalIndicator AS lkp_AutomaticRenewalIndicator,\n\tLKP_Policy.AssociationCode AS lkp_AssociationCode,\n\tLKP_Policy.AgencyEmployeeAKId AS lkp_AgencyEmployeeAKId,\n\tLKP_contract_customer_key.contract_cust_ak_id AS in_cust_ak_id,\n\tLKP_agency_ak_id.agency_ak_id AS in_agency_ak_id,\n\tLKP_AgencyAKId.AgencyAKId AS in_AgencyAKID,\n\tLKP_producer_code_ak_id.producer_code_id AS in_producer_code_id,\n\tLKP_producer_code_ak_id.prdcr_code_ak_id AS in_producer_code_ak_id,\n\tmplt_Strategic_Business_Division.strtgc_bus_dvsn_ak_id AS in_strtgc_bus_dvsn_ak_id,\n\tLKP_sup_business_classification_code.sup_bus_class_code_id AS in_sup_bus_class_code_id,\n\tLKP_sup_policy_term.sup_pol_term_id AS in_sup_pol_term_id,\n\tLKP_sup_policy_status_code.sup_pol_status_code_id AS in_sup_pol_status_code_id,\n\tLKP_sup_policy_audit_frequency.sup_pol_audit_frqncy_id AS in_sup_pol_audit_frqncy_id,\n\tLKP_sup_industry_risk_grade_code.sup_industry_risk_grade_code_id AS in_sup_industry_risk_grade_code_id,\n\tLKP_sup_state.sup_state_id AS in_sup_state_id,\n\tmplt_PMS_StrategicProfitCenterInsuranceSegment.StrategicProfitCenterAKId AS in_StrategicProfitCenterAKId,\n\tmplt_PMS_StrategicProfitCenterInsuranceSegment.InsuranceSegmentAKId AS in_InsuranceSegmentAKId,\n\tLKP_ProgramAKId.ProgramAKId AS in_ProgramAKId,\n\tLKP_AgencyEmployee.AgencyEmployeeAKID AS in_AgencyEmployeeAKID,\n\tEXP_values.pif_symbol,\n\tEXP_values.pif_pol_number AS pif_policy_number,\n\tEXP_values.pif_module,\n\tEXP_values.policy_key,\n\tEXP_values.pol_eff_date,\n\tEXP_values.pol_exp_date,\n\tEXP_values.mco,\n\tEXP_values.pol_term,\n\tEXP_values.state_of_domicile_code,\n\tEXP_values.pol_co_num,\n\tEXP_values.pif_lob_code AS pif_pol_lob_code,\n\tEXP_values.pol_co_line_code,\n\tEXP_values.pol_cancellation_ind,\n\tEXP_values.renl_code,\n\tEXP_values.orig_incep_date,\n\tEXP_values.wbconnect_upload_code,\n\tEXP_values.prim_bus_class_code,\n\tEXP_values.terrorism_risk_ind,\n\tEXP_values.out_pif_renew_policy_number AS renewalpolicynumber,\n\tEXP_values.out_pif_renew_policy_symbol AS renewalpolicysymbol,\n\tEXP_values.prior_pol_key,\n\tEXP_values.pol_issue_code AS in_pol_issue_code,\n\tEXP_values.pol_age,\n\tEXP_values.industry_risk_grade_code,\n\tEXP_values.amend_num,\n\tEXP_values.anniversary_rerate_code,\n\tEXP_values.pol_audit_frqncy,\n\tEXP_values.final_audit_code,\n\tEXP_values.zip_ind,\n\tEXP_values.gutantee_ind,\n\tEXP_values.variation_code,\n\tEXP_values.county,\n\tEXP_values.non_smoker_disc_code,\n\tEXP_values.renl_disc,\n\tEXP_values.pif_upload_audit,\n\tEXP_values.pif_seg_id,\n\tEXP_values.renl_safe_driver_disc_count,\n\tEXP_values.fn_date AS non_renewal_flag_date,\n\tEXP_values.audit_complt_date,\n\tEXP_values.original_account_date,\n\tEXP_values.pol_enter_date,\n\tEXP_values.excess_claim_code,\n\tEXP_values.pif_policy_status_on,\n\tEXP_values.reins_code,\n\tEXP_values.pol_cancellation_date,\n\tEXP_values.pol_cancellation_rsn_code,\n\tEXP_values.serv_center_support_code,\n\tEXP_values.policy_status_code AS pol_status_code,\n\tEXP_values.uw_review_yr,\n\tEXP_values.mvr_request_code,\n\tEXP_values.pif_target_market_code,\n\tEXP_values.pkg_code,\n\tEXP_values.RenewalPolicyMod,\n\tEXP_values.BillingType,\n\tEXP_values.producer_code,\n\tEXP_values.ClassOfBusiness,\n\texp_user_code.out_use_code AS SurchargeExemptCode,\n\tLKP_SupSurchargeExempt.SupSurchargeExemptId AS SupSurchargeExemptID,\n\tEXP_values.PolicyOfferingCode AS in_PolicyOfferingCode,\n\tEXP_values.PolicyOfferingAKId AS in_PolicyOfferingAKId,\n\tEXP_values.ObligeeName,\n\tEXP_values.AutomatedUnderwritingServicesIndicator,\n\tEXP_values.AutomaticRenewalIndicator,\n\tLKP_Association.AssociationCode AS in_AssociationCode,\n\t-- *INF*: IIF(\r\n\t--   ISNULL( in_cust_ak_id ),\r\n\t--   -1,\r\n\t--   in_cust_ak_id\r\n\t-- )\n\tIFF(in_cust_ak_id IS NULL, - 1, in_cust_ak_id) AS v_cust_ak_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_agency_ak_id),\r\n\t--   -1,\r\n\t-- in_agency_ak_id\r\n\t-- )\n\tIFF(in_agency_ak_id IS NULL, - 1, in_agency_ak_id) AS v_agency_ak_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_AgencyAKID ),\r\n\t--   -1,\r\n\t--  in_AgencyAKID\r\n\t-- )\n\tIFF(in_AgencyAKID IS NULL, - 1, in_AgencyAKID) AS v_AgencyAKId,\n\t-- *INF*: IIF(\r\n\t--   ISNULL( in_producer_code_id ),\r\n\t--   -1,\r\n\t--   in_producer_code_id\r\n\t-- )\n\tIFF(in_producer_code_id IS NULL, - 1, in_producer_code_id) AS v_producer_code_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_producer_code_ak_id ),\r\n\t--   -1,\r\n\t--   in_producer_code_ak_id\r\n\t-- )\n\tIFF(in_producer_code_ak_id IS NULL, - 1, in_producer_code_ak_id) AS v_producer_code_ak_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL( in_strtgc_bus_dvsn_ak_id ),\r\n\t--   -1,\r\n\t--   in_strtgc_bus_dvsn_ak_id\r\n\t-- )\n\tIFF(in_strtgc_bus_dvsn_ak_id IS NULL, - 1, in_strtgc_bus_dvsn_ak_id) AS v_strtgc_bus_dvsn_ak_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_sup_bus_class_code_id),\r\n\t--   -1,\r\n\t--   in_sup_bus_class_code_id\r\n\t-- )\n\tIFF(in_sup_bus_class_code_id IS NULL, - 1, in_sup_bus_class_code_id) AS v_sup_bus_class_code_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_sup_pol_term_id),\r\n\t--   -1,\r\n\t--   in_sup_pol_term_id\r\n\t-- )\n\tIFF(in_sup_pol_term_id IS NULL, - 1, in_sup_pol_term_id) AS v_sup_pol_term_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_sup_pol_status_code_id),\r\n\t--   -1,\r\n\t--   in_sup_pol_status_code_id\r\n\t-- )\n\tIFF(in_sup_pol_status_code_id IS NULL, - 1, in_sup_pol_status_code_id) AS v_sup_pol_status_code_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_sup_pol_audit_frqncy_id),\r\n\t--   -1,\r\n\t--   in_sup_pol_audit_frqncy_id\r\n\t-- )\n\tIFF(in_sup_pol_audit_frqncy_id IS NULL, - 1, in_sup_pol_audit_frqncy_id) AS v_sup_pol_audit_frqncy_id,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_sup_industry_risk_grade_code_id),\r\n\t--   -1,\r\n\t--   in_sup_industry_risk_grade_code_id\r\n\t-- )\n\tIFF(in_sup_industry_risk_grade_code_id IS NULL, - 1, in_sup_industry_risk_grade_code_id) AS v_sup_industry_risk_grade_code_id,\n\t-- *INF*: IIF(ISNULL(in_sup_state_id), -1, in_sup_state_id)\n\tIFF(in_sup_state_id IS NULL, - 1, in_sup_state_id) AS v_sup_state_id,\n\t-- *INF*: IIF(ISNULL(in_StrategicProfitCenterAKId), -1, in_StrategicProfitCenterAKId)\n\tIFF(in_StrategicProfitCenterAKId IS NULL, - 1, in_StrategicProfitCenterAKId) AS v_StrategicProfitCenterAKId,\n\t-- *INF*: substr(pif_symbol,1,2)\n\tsubstr(pif_symbol, 1, 2) AS v_pif_symbol_02_F2,\n\t-- *INF*: substr(pif_symbol,1,1)\n\tsubstr(pif_symbol, 1, 1) AS v_pif_symbol_02_F1,\n\t-- *INF*: IIF(ISNULL(in_InsuranceSegmentAKId), -1, in_InsuranceSegmentAKId)\n\tIFF(in_InsuranceSegmentAKId IS NULL, - 1, in_InsuranceSegmentAKId) AS v_InsuranceSegmentAKId,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(in_ProgramAKId),\r\n\t--   -1,\r\n\t--   in_ProgramAKId\r\n\t-- )\n\tIFF(in_ProgramAKId IS NULL, - 1, in_ProgramAKId) AS v_ProgramAKId,\n\tin_PolicyOfferingAKId AS v_PolicyOfferingAKId,\n\t-- *INF*: :LKP.LKP_POLICYOFFERINGAKID('000')\n\tLKP_POLICYOFFERINGAKID__000.PolicyOfferingAKId AS v_PolicyOfferingAKId_default,\n\t-- *INF*: DECODE(lkp_AutomaticRenewalIndicator, 'T', '1', 'F', '0', NULL)\n\tDECODE(lkp_AutomaticRenewalIndicator,\n\t'T', '1',\n\t'F', '0',\n\tNULL) AS v_lkp_AutomaticRenewalIndicator,\n\t-- *INF*: iif(isnull(in_AssociationCode ) or IS_SPACES(in_AssociationCode ) or LENGTH(in_AssociationCode )=0,'N/A',in_AssociationCode )\n\tIFF(in_AssociationCode IS NULL OR IS_SPACES(in_AssociationCode) OR LENGTH(in_AssociationCode) = 0, 'N/A', in_AssociationCode) AS v_AssociationCode,\n\t-- *INF*: IIF(ISNULL(in_AgencyEmployeeAKID), -1, in_AgencyEmployeeAKID)\n\tIFF(in_AgencyEmployeeAKID IS NULL, - 1, in_AgencyEmployeeAKID) AS v_AgencyEmployeeAKId,\n\tLKP_ProgramAKId.in_ProgramCode,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_StrategicProfitCenter(v_StrategicProfitCenterAKId)), 'N/A', :LKP.LKP_StrategicProfitCenter(v_StrategicProfitCenterAKId))\n\tIFF(LKP_STRATEGICPROFITCENTER_v_StrategicProfitCenterAKId.StrategicProfitCenterAbbreviation IS NULL, 'N/A', LKP_STRATEGICPROFITCENTER_v_StrategicProfitCenterAKId.StrategicProfitCenterAbbreviation) AS v_StrategicProfitCenterAbbrev,\n\t-- *INF*: DECODE(TRUE, \r\n\t-- SUBSTR(pif_symbol, 1, 2) = 'NC', 'N',\r\n\t-- in_ProgramCode = 'XD', 'N',\r\n\t-- v_StrategicProfitCenterAbbrev = 'WB - PL' AND in_pol_issue_code = 'R' AND pif_module = '00', 'N',\r\n\t-- in_pol_issue_code)\n\tDECODE(TRUE,\n\tSUBSTR(pif_symbol, 1, 2) = 'NC', 'N',\n\tin_ProgramCode = 'XD', 'N',\n\tv_StrategicProfitCenterAbbrev = 'WB - PL' AND in_pol_issue_code = 'R' AND pif_module = '00', 'N',\n\tin_pol_issue_code) AS v_pol_issue_code,\n\t-- *INF*: IIF(\r\n\t--   ISNULL(:LKP.LKP_sup_policy_issue_code(v_pol_issue_code)),\r\n\t--   -1,\r\n\t--   :LKP.LKP_sup_policy_issue_code(v_pol_issue_code)\r\n\t-- )\n\tIFF(LKP_SUP_POLICY_ISSUE_CODE_v_pol_issue_code.sup_pol_issue_code_id IS NULL, - 1, LKP_SUP_POLICY_ISSUE_CODE_v_pol_issue_code.sup_pol_issue_code_id) AS v_sup_pol_issue_code_id,\n\t-- *INF*: IIF(ISNULL(lkp_pol_ak_id), 'NEW', \r\n\t-- IIF(lkp_contract_cust_ak_id != v_cust_ak_id OR \r\n\t-- lkp_agency_ak_id<>in_agency_ak_id OR\r\n\t-- lkp_AgencyAKId != v_AgencyAKId OR \r\n\t-- LTRIM(RTRIM(lkp_mco)) != LTRIM(RTRIM(mco)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_co_num)) != LTRIM(RTRIM(pol_co_num)) OR \r\n\t-- lkp_pol_eff_date != pol_eff_date OR \r\n\t-- lkp_pol_exp_date != pol_exp_date OR \r\n\t-- lkp_orig_incptn_date != orig_incep_date OR \r\n\t-- LTRIM(RTRIM(lkp_prim_bus_class_code)) != LTRIM(RTRIM(prim_bus_class_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_reins_code)) != LTRIM(RTRIM(reins_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pms_pol_lob_code)) != LTRIM(RTRIM(pif_pol_lob_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_co_line_code)) != LTRIM(RTRIM(pol_co_line_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_cancellation_ind)) != LTRIM(RTRIM(pol_cancellation_ind)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_cancellation_rsn_code)) != LTRIM(RTRIM(pol_cancellation_rsn_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_state_of_domicile_code)) != LTRIM(RTRIM(state_of_domicile_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_wbconnect_upload_code)) != LTRIM(RTRIM(wbconnect_upload_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_serv_center_support_code)) != LTRIM(RTRIM(serv_center_support_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_term)) != LTRIM(RTRIM(pol_term)) OR \r\n\t-- LTRIM(RTRIM(lkp_terrorism_risk_ind)) != LTRIM(RTRIM(terrorism_risk_ind)) OR \r\n\t-- LTRIM(RTRIM(lkp_prior_pol_key)) != LTRIM(RTRIM(prior_pol_key)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_issue_code)) != LTRIM(RTRIM(v_pol_issue_code)) OR \r\n\t-- lkp_pol_age != pol_age OR \r\n\t-- LTRIM(RTRIM(lkp_industry_risk_grade_code)) != LTRIM(RTRIM(industry_risk_grade_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_uw_review_yr)) != LTRIM(RTRIM(uw_review_yr)) OR \r\n\t-- LTRIM(RTRIM(lkp_mvr_request_code)) != LTRIM(RTRIM(mvr_request_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_renl_code)) != LTRIM(RTRIM(renl_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_amend_num)) != LTRIM(RTRIM(amend_num)) OR \r\n\t-- LTRIM(RTRIM(lkp_anniversary_rerate_code)) != LTRIM(RTRIM(anniversary_rerate_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_audit_frqncy)) != LTRIM(RTRIM(pol_audit_frqncy)) OR \r\n\t-- LTRIM(RTRIM(lkp_final_audit_code)) != LTRIM(RTRIM(final_audit_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_zip_ind)) != LTRIM(RTRIM(zip_ind)) OR \r\n\t-- LTRIM(RTRIM(lkp_guarantee_ind)) != LTRIM(RTRIM(gutantee_ind)) OR \r\n\t-- LTRIM(RTRIM(lkp_variation_code)) != LTRIM(RTRIM(variation_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_county)) != LTRIM(RTRIM(county)) OR \r\n\t-- LTRIM(RTRIM(lkp_non_smoker_disc_code)) != LTRIM(RTRIM(non_smoker_disc_code)) OR \r\n\t-- lkp_renl_disc != renl_disc OR \r\n\t-- lkp_renl_safe_driver_disc_count != renl_safe_driver_disc_count OR \r\n\t-- lkp_nonrenewal_flag_date != non_renewal_flag_date OR \r\n\t-- lkp_audit_complt_date != audit_complt_date OR \r\n\t-- lkp_orig_acct_date != original_account_date OR \r\n\t-- lkp_pol_enter_date != pol_enter_date OR \r\n\t-- LTRIM(RTRIM(lkp_excess_claim_code)) != LTRIM(RTRIM(excess_claim_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pol_status_on_pif)) != LTRIM(RTRIM(pif_policy_status_on)) OR \r\n\t-- LTRIM(RTRIM(lkp_target_mrkt_code)) != LTRIM(RTRIM(pif_target_market_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_pkg_code)) != LTRIM(RTRIM(pkg_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_bus_seg_code)) != LTRIM(RTRIM(pif_seg_id)) OR \r\n\t-- LTRIM(RTRIM(lkp_pif_upload_audit_ind)) != LTRIM(RTRIM(pif_upload_audit)) OR \r\n\t-- lkp_producer_code_ak_id != v_producer_code_ak_id OR \r\n\t-- LTRIM(RTRIM(lkp_prdcr_code)) != LTRIM(RTRIM(producer_code)) OR \r\n\t-- LTRIM(RTRIM(lkp_ClassOfBusiness)) != LTRIM(RTRIM(ClassOfBusiness)) OR \r\n\t-- lkp_strtgc_bus_dvsn_ak_id != v_strtgc_bus_dvsn_ak_id OR \r\n\t-- LTRIM(RTRIM(lkp_RenewalPolicyNumber)) != LTRIM(RTRIM(renewalpolicynumber)) OR \r\n\t-- LTRIM(RTRIM(lkp_RenewalPolicySymbol)) != LTRIM(RTRIM(renewalpolicysymbol)) OR \r\n\t-- LTRIM(RTRIM(lkp_RenewalPolicyMod)) != LTRIM(RTRIM(RenewalPolicyMod)) OR \r\n\t-- LTRIM(RTRIM(lkp_BillingType)) != LTRIM(RTRIM(BillingType)) OR \r\n\t-- --LTRIM(RTRIM(lkp_strtgc_bus_dvsn_code)) != LTRIM(RTRIM(v_strtgc_bus_dvsn_code)) OR  ***\r\n\t-- --LTRIM(RTRIM(lkp_PolicyOfferingCode)) != LTRIM(RTRIM(v_PolicyOfferingCode)) OR ***\r\n\t-- --LTRIM(RTRIM(lkp_ProgramCode)) != LTRIM(RTRIM(v_ProgramCode)) OR ***\r\n\t-- lkp_producer_code_id != v_producer_code_id OR \r\n\t-- --lkp_strtgc_bus_dvsn_id != v_strtgc_bus_dvsn_id OR  ***\r\n\t-- ---------------------------------------------------------------------------------------------\r\n\t-- lkp_sup_bus_class_code_id != v_sup_bus_class_code_id OR \r\n\t-- lkp_sup_pol_term_id != v_sup_pol_term_id OR \r\n\t-- lkp_sup_pol_issue_code_id != v_sup_pol_issue_code_id OR \r\n\t-- lkp_sup_pol_audit_frqncy_id != v_sup_pol_audit_frqncy_id OR \r\n\t-- lkp_sup_industry_risk_grade_code_id != v_sup_industry_risk_grade_code_id OR \r\n\t-- lkp_sup_state_id != v_sup_state_id OR \r\n\t-- LTRIM(RTRIM(lkp_SurchargeExemptCode)) != LTRIM(RTRIM(SurchargeExemptCode)) OR\r\n\t-- lkp_SupSurchargeExemptID != SupSurchargeExemptID OR\r\n\t-- lkp_StrategicProfitCenterAKId!=v_StrategicProfitCenterAKId OR\r\n\t-- lkp_InsuranceSegmentAKId != v_InsuranceSegmentAKId  OR \r\n\t-- LTRIM(RTRIM(lkp_AssociationCode))!=LTRIM(RTRIM(v_AssociationCode)) OR\r\n\t-- lkp_ProgramAKId != v_ProgramAKId OR \r\n\t-- (lkp_PolicyOfferingAKId !=v_PolicyOfferingAKId AND  (lkp_PolicyOfferingAKId=-1 OR lkp_PolicyOfferingAKId=v_PolicyOfferingAKId_default)) OR \r\n\t-- lkp_ObligeeName  != ObligeeName OR \r\n\t-- lkp_AutomatedUnderwritingServicesIndicator != AutomatedUnderwritingServicesIndicator OR \r\n\t-- ---------------------------------------------------------------------------------------\r\n\t-- v_lkp_AutomaticRenewalIndicator != AutomaticRenewalIndicator OR \r\n\t-- lkp_AgencyEmployeeAKId != in_AgencyEmployeeAKID OR\r\n\t-- 1!=1 ,\r\n\t-- 'UPDATE', 'NOCHANGE'))\r\n\t-- \r\n\t-- --OR  LTRIM(RTRIM(lkp_InsuranceSegmentCode)) != LTRIM(RTRIM(v_InsuranceSegmentCode))\n\tIFF(lkp_pol_ak_id IS NULL, 'NEW', IFF(lkp_contract_cust_ak_id != v_cust_ak_id OR lkp_agency_ak_id <> in_agency_ak_id OR lkp_AgencyAKId != v_AgencyAKId OR LTRIM(RTRIM(lkp_mco)) != LTRIM(RTRIM(mco)) OR LTRIM(RTRIM(lkp_pol_co_num)) != LTRIM(RTRIM(pol_co_num)) OR lkp_pol_eff_date != pol_eff_date OR lkp_pol_exp_date != pol_exp_date OR lkp_orig_incptn_date != orig_incep_date OR LTRIM(RTRIM(lkp_prim_bus_class_code)) != LTRIM(RTRIM(prim_bus_class_code)) OR LTRIM(RTRIM(lkp_reins_code)) != LTRIM(RTRIM(reins_code)) OR LTRIM(RTRIM(lkp_pms_pol_lob_code)) != LTRIM(RTRIM(pif_pol_lob_code)) OR LTRIM(RTRIM(lkp_pol_co_line_code)) != LTRIM(RTRIM(pol_co_line_code)) OR LTRIM(RTRIM(lkp_pol_cancellation_ind)) != LTRIM(RTRIM(pol_cancellation_ind)) OR LTRIM(RTRIM(lkp_pol_cancellation_rsn_code)) != LTRIM(RTRIM(pol_cancellation_rsn_code)) OR LTRIM(RTRIM(lkp_state_of_domicile_code)) != LTRIM(RTRIM(state_of_domicile_code)) OR LTRIM(RTRIM(lkp_wbconnect_upload_code)) != LTRIM(RTRIM(wbconnect_upload_code)) OR LTRIM(RTRIM(lkp_serv_center_support_code)) != LTRIM(RTRIM(serv_center_support_code)) OR LTRIM(RTRIM(lkp_pol_term)) != LTRIM(RTRIM(pol_term)) OR LTRIM(RTRIM(lkp_terrorism_risk_ind)) != LTRIM(RTRIM(terrorism_risk_ind)) OR LTRIM(RTRIM(lkp_prior_pol_key)) != LTRIM(RTRIM(prior_pol_key)) OR LTRIM(RTRIM(lkp_pol_issue_code)) != LTRIM(RTRIM(v_pol_issue_code)) OR lkp_pol_age != pol_age OR LTRIM(RTRIM(lkp_industry_risk_grade_code)) != LTRIM(RTRIM(industry_risk_grade_code)) OR LTRIM(RTRIM(lkp_uw_review_yr)) != LTRIM(RTRIM(uw_review_yr)) OR LTRIM(RTRIM(lkp_mvr_request_code)) != LTRIM(RTRIM(mvr_request_code)) OR LTRIM(RTRIM(lkp_renl_code)) != LTRIM(RTRIM(renl_code)) OR LTRIM(RTRIM(lkp_amend_num)) != LTRIM(RTRIM(amend_num)) OR LTRIM(RTRIM(lkp_anniversary_rerate_code)) != LTRIM(RTRIM(anniversary_rerate_code)) OR LTRIM(RTRIM(lkp_pol_audit_frqncy)) != LTRIM(RTRIM(pol_audit_frqncy)) OR LTRIM(RTRIM(lkp_final_audit_code)) != LTRIM(RTRIM(final_audit_code)) OR LTRIM(RTRIM(lkp_zip_ind)) != LTRIM(RTRIM(zip_ind)) OR LTRIM(RTRIM(lkp_guarantee_ind)) != LTRIM(RTRIM(gutantee_ind)) OR LTRIM(RTRIM(lkp_variation_code)) != LTRIM(RTRIM(variation_code)) OR LTRIM(RTRIM(lkp_county)) != LTRIM(RTRIM(county)) OR LTRIM(RTRIM(lkp_non_smoker_disc_code)) != LTRIM(RTRIM(non_smoker_disc_code)) OR lkp_renl_disc != renl_disc OR lkp_renl_safe_driver_disc_count != renl_safe_driver_disc_count OR lkp_nonrenewal_flag_date != non_renewal_flag_date OR lkp_audit_complt_date != audit_complt_date OR lkp_orig_acct_date != original_account_date OR lkp_pol_enter_date != pol_enter_date OR LTRIM(RTRIM(lkp_excess_claim_code)) != LTRIM(RTRIM(excess_claim_code)) OR LTRIM(RTRIM(lkp_pol_status_on_pif)) != LTRIM(RTRIM(pif_policy_status_on)) OR LTRIM(RTRIM(lkp_target_mrkt_code)) != LTRIM(RTRIM(pif_target_market_code)) OR LTRIM(RTRIM(lkp_pkg_code)) != LTRIM(RTRIM(pkg_code)) OR LTRIM(RTRIM(lkp_bus_seg_code)) != LTRIM(RTRIM(pif_seg_id)) OR LTRIM(RTRIM(lkp_pif_upload_audit_ind)) != LTRIM(RTRIM(pif_upload_audit)) OR lkp_producer_code_ak_id != v_producer_code_ak_id OR LTRIM(RTRIM(lkp_prdcr_code)) != LTRIM(RTRIM(producer_code)) OR LTRIM(RTRIM(lkp_ClassOfBusiness)) != LTRIM(RTRIM(ClassOfBusiness)) OR lkp_strtgc_bus_dvsn_ak_id != v_strtgc_bus_dvsn_ak_id OR LTRIM(RTRIM(lkp_RenewalPolicyNumber)) != LTRIM(RTRIM(renewalpolicynumber)) OR LTRIM(RTRIM(lkp_RenewalPolicySymbol)) != LTRIM(RTRIM(renewalpolicysymbol)) OR LTRIM(RTRIM(lkp_RenewalPolicyMod)) != LTRIM(RTRIM(RenewalPolicyMod)) OR LTRIM(RTRIM(lkp_BillingType)) != LTRIM(RTRIM(BillingType)) OR lkp_producer_code_id != v_producer_code_id OR lkp_sup_bus_class_code_id != v_sup_bus_class_code_id OR lkp_sup_pol_term_id != v_sup_pol_term_id OR lkp_sup_pol_issue_code_id != v_sup_pol_issue_code_id OR lkp_sup_pol_audit_frqncy_id != v_sup_pol_audit_frqncy_id OR lkp_sup_industry_risk_grade_code_id != v_sup_industry_risk_grade_code_id OR lkp_sup_state_id != v_sup_state_id OR LTRIM(RTRIM(lkp_SurchargeExemptCode)) != LTRIM(RTRIM(SurchargeExemptCode)) OR lkp_SupSurchargeExemptID != SupSurchargeExemptID OR lkp_StrategicProfitCenterAKId != v_StrategicProfitCenterAKId OR lkp_InsuranceSegmentAKId != v_InsuranceSegmentAKId OR LTRIM(RTRIM(lkp_AssociationCode)) != LTRIM(RTRIM(v_AssociationCode)) OR lkp_ProgramAKId != v_ProgramAKId OR ( lkp_PolicyOfferingAKId != v_PolicyOfferingAKId AND ( lkp_PolicyOfferingAKId = - 1 OR lkp_PolicyOfferingAKId = v_PolicyOfferingAKId_default ) ) OR lkp_ObligeeName != ObligeeName OR lkp_AutomatedUnderwritingServicesIndicator != AutomatedUnderwritingServicesIndicator OR v_lkp_AutomaticRenewalIndicator != AutomaticRenewalIndicator OR lkp_AgencyEmployeeAKId != in_AgencyEmployeeAKID OR 1 != 1, 'UPDATE', 'NOCHANGE')) AS v_changed_flag,\n\t-- *INF*: :LKP.LKP_PIF02_MAXDATE(1)\n\tLKP_PIF02_MAXDATE_1.pif_date_time_stamp AS lkp_pif_date_time_stamp,\n\tv_changed_flag AS out_changed_flag,\n\t1 AS out_crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS out_audit_id,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_changed_flag='NEW',\tto_date('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'),\r\n\t-- IS_DATE(lkp_pif_date_time_stamp,'YYYYMMDD'),TO_DATE(lkp_pif_date_time_stamp||' 23:59:59','YYYYMMDD HH24:MI:SS'))\n\tDECODE(TRUE,\n\tv_changed_flag = 'NEW', to_date('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'),\n\tIS_DATE(lkp_pif_date_time_stamp, 'YYYYMMDD'), TO_DATE(lkp_pif_date_time_stamp || ' 23:59:59', 'YYYYMMDD HH24:MI:SS')) AS out_eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS out_eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS out_source_sys_id,\n\tSYSDATE AS out_created_date,\n\tSYSDATE AS out_modified_date,\n\tv_cust_ak_id AS out_cust_ak_id,\n\tv_agency_ak_id AS out_agency_ak_id,\n\tv_AgencyAKId AS out_AgencyAKId,\n\tv_producer_code_ak_id AS out_producer_code_ak_id,\n\tv_strtgc_bus_dvsn_ak_id AS out_strtgc_bus_dvsn_ak_id,\n\tv_producer_code_id AS out_producer_code_id,\n\tv_sup_bus_class_code_id AS out_sup_bus_class_code_id,\n\tv_sup_pol_term_id AS out_sup_pol_term_id,\n\tv_sup_pol_status_code_id AS out_sup_pol_status_code_id,\n\tv_sup_pol_issue_code_id AS out_sup_pol_issue_code_id,\n\tv_sup_pol_audit_frqncy_id AS out_sup_pol_audit_frqncy_id,\n\tv_sup_industry_risk_grade_code_id AS out_sup_industry_risk_grade_code_id,\n\tv_sup_state_id AS out_sup_state_id,\n\tv_StrategicProfitCenterAKId AS out_StrategicProfitCenterAKId,\n\tv_InsuranceSegmentAKId AS out_InsuranceSegmentAKId,\n\t-- *INF*: IIF(ISNULL(lkp_PolicyOfferingAKId) OR lkp_PolicyOfferingAKId=v_PolicyOfferingAKId_default OR lkp_PolicyOfferingAKId=-1, in_PolicyOfferingAKId, lkp_PolicyOfferingAKId)\n\tIFF(lkp_PolicyOfferingAKId IS NULL OR lkp_PolicyOfferingAKId = v_PolicyOfferingAKId_default OR lkp_PolicyOfferingAKId = - 1, in_PolicyOfferingAKId, lkp_PolicyOfferingAKId) AS out_PolicyOfferingAKId,\n\tv_ProgramAKId AS out_ProgramAKId,\n\tv_AssociationCode AS out_AssociationCode,\n\tv_AgencyEmployeeAKId AS out_AgencyEmployeeAKId,\n\tv_pol_issue_code AS o_pol_issue_code,\n\tEXP_values.pif_dc_bill_ind\n\tFROM EXP_values\n\t -- Manually join with exp_user_code\n\t -- Manually join with mplt_PMS_StrategicProfitCenterInsuranceSegment\n\t -- Manually join with mplt_Strategic_Business_Division\n\tLEFT JOIN LKP_AgencyAKId\n\tON LKP_AgencyAKId.AgencyCode = EXP_values.agency_key\n\tLEFT JOIN LKP_AgencyEmployee\n\tON LKP_AgencyEmployee.AgencyAKID = LKP_AgencyAKId.AgencyAKId AND LKP_AgencyEmployee.ProducerCode = EXP_values.producer_code\n\tLEFT JOIN LKP_Association\n\tON LKP_Association.AssociationCode = EXP_values.o_ClassOfBusiness\n\tLEFT JOIN LKP_Policy\n\tON LKP_Policy.pol_key = EXP_values.policy_key\n\tLEFT JOIN LKP_ProgramAKId\n\tON LKP_ProgramAKId.ProgramCode = LKP_sup_association_program_code.assoc_prog_code\n\tLEFT JOIN LKP_SupSurchargeExempt\n\tON LKP_SupSurchargeExempt.SurchargeExemptCode = exp_user_code.out_use_code\n\tLEFT JOIN LKP_agency_ak_id\n\tON LKP_agency_ak_id.agency_key = EXP_values.agency_key\n\tLEFT JOIN LKP_contract_customer_key\n\tON LKP_contract_customer_key.contract_key = EXP_values.policy_key\n\tLEFT JOIN LKP_producer_code_ak_id\n\tON LKP_producer_code_ak_id.producer_code = EXP_values.producer_code AND LKP_producer_code_ak_id.agency_key = EXP_values.agency_key\n\tLEFT JOIN LKP_sup_business_classification_code\n\tON LKP_sup_business_classification_code.bus_class_code = EXP_values.prim_bus_class_code\n\tLEFT JOIN LKP_sup_industry_risk_grade_code\n\tON LKP_sup_industry_risk_grade_code.industry_risk_grade_code = EXP_values.industry_risk_grade_code\n\tLEFT JOIN LKP_sup_policy_audit_frequency\n\tON LKP_sup_policy_audit_frequency.pol_audit_frqncy = EXP_values.pol_audit_frqncy\n\tLEFT JOIN LKP_sup_policy_status_code\n\tON LKP_sup_policy_status_code.pol_status_code = EXP_values.policy_status_code\n\tLEFT JOIN LKP_sup_policy_term\n\tON LKP_sup_policy_term.pol_term = EXP_values.pol_term\n\tLEFT JOIN LKP_sup_state\n\tON LKP_sup_state.state_abbrev = EXP_values.state_of_domicile_code\n\tLEFT JOIN LKP_POLICYOFFERINGAKID LKP_POLICYOFFERINGAKID__000\n\tON LKP_POLICYOFFERINGAKID__000.PolicyOfferingCode = '000'\n\n\tLEFT JOIN LKP_STRATEGICPROFITCENTER LKP_STRATEGICPROFITCENTER_v_StrategicProfitCenterAKId\n\tON LKP_STRATEGICPROFITCENTER_v_StrategicProfitCenterAKId.StrategicProfitCenterAKId = v_StrategicProfitCenterAKId\n\n\tLEFT JOIN LKP_SUP_POLICY_ISSUE_CODE LKP_SUP_POLICY_ISSUE_CODE_v_pol_issue_code\n\tON LKP_SUP_POLICY_ISSUE_CODE_v_pol_issue_code.pol_issue_code = v_pol_issue_code\n\n\tLEFT JOIN LKP_PIF02_MAXDATE LKP_PIF02_MAXDATE_1\n\tON LKP_PIF02_MAXDATE_1.ID = 1\n\n),\nFIL_insert AS (\n\tSELECT\n\tlkp_pol_ak_id, \n\tpif_symbol, \n\tpif_policy_number, \n\tpif_module, \n\tpolicy_key, \n\tpol_eff_date, \n\tpol_exp_date, \n\tmco, \n\tpol_term, \n\tstate_of_domicile_code, \n\tpol_co_num, \n\tpif_pol_lob_code, \n\tpol_co_line_code, \n\tpol_cancellation_ind, \n\trenl_code, \n\torig_incep_date, \n\twbconnect_upload_code, \n\tprim_bus_class_code, \n\tterrorism_risk_ind, \n\tprior_pol_key, \n\to_pol_issue_code AS pol_issue_code, \n\tpol_age, \n\tindustry_risk_grade_code, \n\tamend_num, \n\tanniversary_rerate_code, \n\tpol_audit_frqncy, \n\tfinal_audit_code, \n\tzip_ind, \n\tgutantee_ind, \n\tvariation_code, \n\tcounty, \n\tnon_smoker_disc_code, \n\trenl_disc, \n\tpif_upload_audit, \n\tpif_seg_id, \n\trenl_safe_driver_disc_count, \n\tnon_renewal_flag_date, \n\taudit_complt_date, \n\toriginal_account_date, \n\tpol_enter_date, \n\texcess_claim_code, \n\tpif_policy_status_on, \n\tout_cust_ak_id AS cust_ak_id, \n\tout_agency_ak_id AS agency_ak_id, \n\tout_AgencyAKId AS AgencyAKId, \n\tout_producer_code_ak_id AS producer_code_ak_id, \n\treins_code, \n\tpol_cancellation_date, \n\tpol_cancellation_rsn_code, \n\tserv_center_support_code, \n\tpol_status_code, \n\tuw_review_yr, \n\tmvr_request_code, \n\tpif_target_market_code, \n\tpkg_code, \n\tout_changed_flag AS changed_flag, \n\tout_crrnt_snpsht_flag AS crrnt_snpsht_flag, \n\tout_audit_id AS audit_id, \n\tout_eff_from_date AS eff_from_date, \n\tout_eff_to_date AS eff_to_date, \n\tout_source_sys_id AS source_sys_id, \n\tout_created_date AS created_date, \n\tout_modified_date AS modified_date, \n\tproducer_code, \n\tClassOfBusiness, \n\tout_strtgc_bus_dvsn_ak_id AS strtgc_bus_dvsn_ak_id, \n\trenewalpolicynumber, \n\trenewalpolicysymbol, \n\tRenewalPolicyMod, \n\tBillingType, \n\tout_producer_code_id AS producer_code_id, \n\tout_sup_bus_class_code_id AS sup_bus_class_code_id, \n\tout_sup_pol_term_id AS sup_pol_term_id, \n\tout_sup_pol_status_code_id AS sup_pol_status_code_id, \n\tout_sup_pol_issue_code_id AS sup_pol_issue_code_id, \n\tout_sup_pol_audit_frqncy_id AS sup_pol_audit_frqncy_id, \n\tout_sup_industry_risk_grade_code_id AS sup_industry_risk_grade_code_id, \n\tout_sup_state_id AS sup_state_id, \n\tSurchargeExemptCode, \n\tSupSurchargeExemptID, \n\tout_StrategicProfitCenterAKId AS StrategicProfitCenterAKId, \n\tout_InsuranceSegmentAKId AS InsuranceSegmentAKId, \n\tout_PolicyOfferingAKId AS PolicyOfferingAKId, \n\tout_ProgramAKId AS ProgramAKId, \n\tObligeeName, \n\tAutomatedUnderwritingServicesIndicator, \n\tAutomaticRenewalIndicator, \n\tout_AssociationCode, \n\tout_AgencyEmployeeAKId AS AgencyEmployeeAKId, \n\tpif_dc_bill_ind\n\tFROM EXP_Detect_Changes\n\tWHERE changed_flag='NEW'or changed_flag='UPDATE'\n),\nSEQ_policy_cus_ak_id AS (\n\tCREATE SEQUENCE SEQ_policy_cus_ak_id\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_policy_ak_id AS (\n\tSELECT\n\tlkp_pol_ak_id,\n\tSEQ_policy_cus_ak_id.NEXTVAL,\n\tcrrnt_snpsht_flag,\n\taudit_id,\n\teff_from_date,\n\teff_to_date,\n\tsource_sys_id,\n\tcreated_date,\n\tmodified_date,\n\tcust_ak_id,\n\tagency_ak_id,\n\tAgencyAKId,\n\tproducer_code_ak_id,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tpolicy_key,\n\tpol_eff_date,\n\tpol_exp_date,\n\tmco,\n\tpol_term,\n\tstate_of_domicile_code,\n\tpol_co_num,\n\tpif_pol_lob_code,\n\tpol_co_line_code,\n\tpol_cancellation_ind,\n\trenl_code,\n\torig_incep_date,\n\twbconnect_upload_code,\n\tprim_bus_class_code,\n\tterrorism_risk_ind,\n\tprior_pol_key,\n\tpol_issue_code,\n\tpol_age,\n\tindustry_risk_grade_code,\n\tamend_num,\n\tanniversary_rerate_code,\n\tpol_audit_frqncy,\n\tfinal_audit_code,\n\tzip_ind,\n\tgutantee_ind,\n\tvariation_code,\n\tcounty,\n\tnon_smoker_disc_code,\n\trenl_disc,\n\tpif_upload_audit,\n\tpif_seg_id,\n\trenl_safe_driver_disc_count,\n\tnon_renewal_flag_date,\n\taudit_complt_date,\n\toriginal_account_date,\n\tpol_enter_date,\n\texcess_claim_code,\n\tpif_policy_status_on,\n\treins_code,\n\tpol_cancellation_date,\n\tpol_cancellation_rsn_code,\n\tserv_center_support_code,\n\tpol_status_code,\n\tuw_review_yr,\n\tmvr_request_code,\n\tpif_target_market_code,\n\tpkg_code,\n\tproducer_code,\n\tClassOfBusiness,\n\tstrtgc_bus_dvsn_ak_id,\n\trenewalpolicynumber,\n\trenewalpolicysymbol,\n\tRenewalPolicyMod,\n\tBillingType,\n\t-- *INF*: iif(isnull(lkp_pol_ak_id),NEXTVAL,lkp_pol_ak_id)\n\tIFF(lkp_pol_ak_id IS NULL, NEXTVAL, lkp_pol_ak_id) AS pol_ak_id,\n\t'D' AS pol_kind_code,\n\t0 AS Default_Int,\n\tproducer_code_id,\n\tsup_bus_class_code_id,\n\tsup_pol_term_id,\n\tsup_pol_status_code_id,\n\tsup_pol_issue_code_id,\n\tsup_pol_audit_frqncy_id,\n\tsup_industry_risk_grade_code_id,\n\tsup_state_id,\n\tSurchargeExemptCode,\n\tSupSurchargeExemptID,\n\tStrategicProfitCenterAKId,\n\tInsuranceSegmentAKId,\n\tPolicyOfferingAKId,\n\tProgramAKId,\n\t-1 AS o_UnderwritingAssociateAKId,\n\tObligeeName,\n\tAutomatedUnderwritingServicesIndicator,\n\tAutomaticRenewalIndicator,\n\tout_AssociationCode,\n\t0 AS RolloverPolicyIndicator,\n\t'N/A' AS RolloverPriorCarrier,\n\t'0' AS MailToInsuredFlag,\n\tAgencyEmployeeAKId,\n\t0 AS PolicyIssueCodeOverride,\n\tpif_dc_bill_ind,\n\t-- *INF*: DECODE( TRUE,\r\n\t-- pif_dc_bill_ind = 'Y',1,\r\n\t-- 0)\n\tDECODE(TRUE,\n\tpif_dc_bill_ind = 'Y', 1,\n\t0) AS DCBillFlag,\n\t'N/A' AS IssuedUWID,\n\t'N/A' AS IssuedUnderwriter\n\tFROM FIL_insert\n),\nTGT_policy_INSERT AS (\n\n\t------------ PRE SQL ----------\n\texec [spSetIndexStatus] @Enable = 0, @Schema = 'V2', @TableName = 'policy', @IndexWildcard = 'Ak3Policy'\n\t-------------------------------\n\n\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy\n\t(crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date, pol_ak_id, contract_cust_ak_id, agency_ak_id, pol_sym, pol_num, pol_mod, pol_key, mco, pol_co_num, pol_eff_date, pol_exp_date, orig_incptn_date, prim_bus_class_code, reins_code, pms_pol_lob_code, pol_co_line_code, pol_cancellation_ind, pol_cancellation_date, pol_cancellation_rsn_code, state_of_domicile_code, wbconnect_upload_code, serv_center_support_code, pol_term, terrorism_risk_ind, prior_pol_key, pol_status_code, pol_issue_code, pol_age, industry_risk_grade_code, uw_review_yr, mvr_request_code, renl_code, amend_num, anniversary_rerate_code, pol_audit_frqncy, final_audit_code, zip_ind, guarantee_ind, variation_code, county, non_smoker_disc_code, renl_disc, renl_safe_driver_disc_count, nonrenewal_flag_date, audit_complt_date, orig_acct_date, pol_enter_date, excess_claim_code, pol_status_on_pif, target_mrkt_code, pkg_code, pol_kind_code, bus_seg_code, pif_upload_audit_ind, err_flag_bal_txn, err_flag_bal_reins, producer_code_ak_id, prdcr_code, ClassOfBusiness, strtgc_bus_dvsn_ak_id, ErrorFlagBalancePremiumTransaction, RenewalPolicyNumber, RenewalPolicySymbol, RenewalPolicyMod, BillingType, producer_code_id, sup_bus_class_code_id, sup_pol_term_id, sup_pol_status_code_id, sup_pol_issue_code_id, sup_pol_audit_frqncy_id, sup_industry_risk_grade_code_id, sup_state_id, SurchargeExemptCode, SupSurchargeExemptID, StrategicProfitCenterAKId, InsuranceSegmentAKId, PolicyOfferingAKId, ProgramAKId, AgencyAKId, UnderwritingAssociateAKId, ObligeeName, AutomatedUnderwritingServicesIndicator, AutomaticRenewalIndicator, AssociationCode, RolloverPolicyIndicator, RolloverPriorCarrier, MailToInsuredFlag, AgencyEmployeeAKId, PolicyIssueCodeOverride, DCBillFlag, IssuedUWID, IssuedUnderwriter)\n\tSELECT \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tSOURCE_SYS_ID, \n\tCREATED_DATE, \n\tMODIFIED_DATE, \n\tPOL_AK_ID, \n\tcust_ak_id AS CONTRACT_CUST_AK_ID, \n\tAGENCY_AK_ID, \n\tpif_symbol AS POL_SYM, \n\tpif_policy_number AS POL_NUM, \n\tpif_module AS POL_MOD, \n\tpolicy_key AS POL_KEY, \n\tMCO, \n\tPOL_CO_NUM, \n\tPOL_EFF_DATE, \n\tPOL_EXP_DATE, \n\torig_incep_date AS ORIG_INCPTN_DATE, \n\tPRIM_BUS_CLASS_CODE, \n\tREINS_CODE, \n\tpif_pol_lob_code AS PMS_POL_LOB_CODE, \n\tPOL_CO_LINE_CODE, \n\tPOL_CANCELLATION_IND, \n\tPOL_CANCELLATION_DATE, \n\tPOL_CANCELLATION_RSN_CODE, \n\tSTATE_OF_DOMICILE_CODE, \n\tWBCONNECT_UPLOAD_CODE, \n\tSERV_CENTER_SUPPORT_CODE, \n\tPOL_TERM, \n\tTERRORISM_RISK_IND, \n\tPRIOR_POL_KEY, \n\tPOL_STATUS_CODE, \n\tPOL_ISSUE_CODE, \n\tPOL_AGE, \n\tINDUSTRY_RISK_GRADE_CODE, \n\tUW_REVIEW_YR, \n\tMVR_REQUEST_CODE, \n\tRENL_CODE, \n\tAMEND_NUM, \n\tANNIVERSARY_RERATE_CODE, \n\tPOL_AUDIT_FRQNCY, \n\tFINAL_AUDIT_CODE, \n\tZIP_IND, \n\tgutantee_ind AS GUARANTEE_IND, \n\tVARIATION_CODE, \n\tCOUNTY, \n\tNON_SMOKER_DISC_CODE, \n\tRENL_DISC, \n\tRENL_SAFE_DRIVER_DISC_COUNT, \n\tnon_renewal_flag_date AS NONRENEWAL_FLAG_DATE, \n\tAUDIT_COMPLT_DATE, \n\toriginal_account_date AS ORIG_ACCT_DATE, \n\tPOL_ENTER_DATE, \n\tEXCESS_CLAIM_CODE, \n\tpif_policy_status_on AS POL_STATUS_ON_PIF, \n\tpif_target_market_code AS TARGET_MRKT_CODE, \n\tPKG_CODE, \n\tPOL_KIND_CODE, \n\tpif_seg_id AS BUS_SEG_CODE, \n\tpif_upload_audit AS PIF_UPLOAD_AUDIT_IND, \n\tDefault_Int AS ERR_FLAG_BAL_TXN, \n\tDefault_Int AS ERR_FLAG_BAL_REINS, \n\tPRODUCER_CODE_AK_ID, \n\tproducer_code AS PRDCR_CODE, \n\tCLASSOFBUSINESS, \n\tSTRTGC_BUS_DVSN_AK_ID, \n\tDefault_Int AS ERRORFLAGBALANCEPREMIUMTRANSACTION, \n\trenewalpolicynumber AS RENEWALPOLICYNUMBER, \n\trenewalpolicysymbol AS RENEWALPOLICYSYMBOL, \n\tRENEWALPOLICYMOD, \n\tBILLINGTYPE, \n\tPRODUCER_CODE_ID, \n\tSUP_BUS_CLASS_CODE_ID, \n\tSUP_POL_TERM_ID, \n\tSUP_POL_STATUS_CODE_ID, \n\tSUP_POL_ISSUE_CODE_ID, \n\tSUP_POL_AUDIT_FRQNCY_ID, \n\tSUP_INDUSTRY_RISK_GRADE_CODE_ID, \n\tSUP_STATE_ID, \n\tSURCHARGEEXEMPTCODE, \n\tSUPSURCHARGEEXEMPTID, \n\tSTRATEGICPROFITCENTERAKID, \n\tINSURANCESEGMENTAKID, \n\tPOLICYOFFERINGAKID, \n\tPROGRAMAKID, \n\tAGENCYAKID, \n\to_UnderwritingAssociateAKId AS UNDERWRITINGASSOCIATEAKID, \n\tOBLIGEENAME, \n\tAUTOMATEDUNDERWRITINGSERVICESINDICATOR, \n\tAUTOMATICRENEWALINDICATOR, \n\tout_AssociationCode AS ASSOCIATIONCODE, \n\tROLLOVERPOLICYINDICATOR, \n\tROLLOVERPRIORCARRIER, \n\tMAILTOINSUREDFLAG, \n\tAGENCYEMPLOYEEAKID, \n\tPOLICYISSUECODEOVERRIDE, \n\tDCBILLFLAG, \n\tISSUEDUWID, \n\tISSUEDUNDERWRITER\n\tFROM EXP_policy_ak_id\n),\nSQ_policy AS (\n\tSELECT \r\n\t\ta.pol_id, \r\n\t\ta.eff_from_date,\r\n\t\ta.eff_to_date, \r\n\t\ta.pol_ak_id  \r\n\tFROM \r\n\t\t@{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy a\r\n\tWHERE  a.pol_ak_id  IN\r\n\t\t( SELECT pol_ak_id  FROM @{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy\r\n\t\tWHERE CRRNT_SNPSHT_FLAG = 1 GROUP BY pol_ak_id HAVING count(*) > 1) \r\n\tAND source_sys_id='@{pipeline().parameters.SOURCE_SYSTEM_ID}'\r\n\tORDER BY a.pol_ak_id ,a.eff_from_date DESC\r\n\t\r\n\t\r\n\t\r\n\t--IN Subquery exists to pick AK ID column values that have multiple rows with a 12/31/2100 eff_to_date.\r\n\t--When this condition occurs this is an indication that we must expire one or more of these rows.\r\n\t--WHERE clause is always made up of current snapshot flag \r\n\t--GROUP BY clause is always on AK\r\n\t--HAVING clause stays the same\n),\nEXP_Lag_eff_from_date AS (\n\tSELECT\n\tpol_id,\n\teff_from_date,\n\teff_to_date AS eff_to_date1,\n\tpol_ak_id,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- pol_ak_id = v_prev_pol_ak_id ,\r\n\t-- ADD_TO_DATE(v_prev_eff_from_date,'SS',-1),eff_to_date1)\n\tDECODE(TRUE,\n\tpol_ak_id = v_prev_pol_ak_id, ADD_TO_DATE(v_prev_eff_from_date, 'SS', - 1),\n\teff_to_date1) AS v_eff_to_date,\n\tv_eff_to_date AS eff_to_date,\n\tpol_ak_id AS v_prev_pol_ak_id,\n\teff_from_date AS v_prev_eff_from_date,\n\t0 AS crrnt_snpsht_flag,\n\tSYSDATE AS modified_date\n\tFROM SQ_policy\n),\nFIL_FirstRowInAKGroup AS (\n\tSELECT\n\tpol_id, \n\teff_to_date1, \n\teff_to_date, \n\tcrrnt_snpsht_flag, \n\tmodified_date\n\tFROM EXP_Lag_eff_from_date\n\tWHERE eff_to_date1 != eff_to_date\n),\nUPD_policy AS (\n\tSELECT\n\tpol_id, \n\teff_to_date, \n\tcrrnt_snpsht_flag, \n\tmodified_date\n\tFROM FIL_FirstRowInAKGroup\n),\nTGT_policy_UPDATE AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy AS T\n\tUSING UPD_policy AS S\n\tON T.pol_id = S.pol_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.eff_to_date = S.eff_to_date, T.modified_date = S.modified_date\n\n\t++------------ POST SQL ----------\n\texec [spSetIndexStatus] @Enable = 1, @Schema = 'V2', @TableName = 'policy', @IndexWildcard = 'Ak3Policy'\n\t-------------------------------++\n\n\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "AGENCY_SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Policy DataWarehouse/"
        },
        "annotations": []
    }
}