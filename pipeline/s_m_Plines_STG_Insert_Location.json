{
    "name": "s_m_Plines_STG_Insert_Location",
    "properties": {
        "activities": [
            {
                "name": "m_Plines_STG_Insert_Location",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_location AS (\n\tSELECT\n\t\tloc_seq,\n\t\tpolicy_num,\n\t\tpolicy_sym,\n\t\tpolicy_mod,\n\t\tpolicy_mco,\n\t\tcov_part_type_code,\n\t\tho_type_code,\n\t\thm_usage_type_code,\n\t\tloc_num,\n\t\tstreet,\n\t\tcity,\n\t\tstate_type_code,\n\t\tzip_type_code,\n\t\tcounty_type_code,\n\t\tsection,\n\t\ttown,\n\t\trange,\n\t\ttown_of,\n\t\tcredit_exist_ins_exp_date,\n\t\tmarket_desire_value_flag,\n\t\tbill_to_type_code,\n\t\tbill_time_type_code,\n\t\tconst_type_code,\n\t\tbuilt_year,\n\t\tmarket_value,\n\t\treplacement_cost,\n\t\tstruct_type_code,\n\t\toccupancy_type_code,\n\t\tnum_of_family,\n\t\tnum_of_apt,\n\t\tterritory,\n\t\tprotect_class_type_code,\n\t\thydrant_dist_type_code,\n\t\tfire_station_dis,\n\t\tresp_fire_dept,\n\t\thydrant_excl_flag,\n\t\tprotect_device_type_code,\n\t\tfire_place_type_code,\n\t\tprotect_class_rate_type_code,\n\t\tsuburban_flag,\n\t\troof_type_code,\n\t\tstandard_amps_flag,\n\t\telec_serv_type_code,\n\t\trow_house_fire_wall_flag,\n\t\twoodbrn_stove_flag,\n\t\tswimming_pool_flag,\n\t\tpool_type_code,\n\t\tslide_diving_type_code,\n\t\tnum_of_hm_in_sub_dev,\n\t\tinside_city_limit_flag,\n\t\tbus_on_premises_flag,\n\t\tbus_on_premises_descript,\n\t\tnum_of_emp,\n\t\tflood_plain_flag,\n\t\trenovation_flag,\n\t\trenovation_descript,\n\t\ttrampoline_flag,\n\t\ttrampoline_descript,\n\t\tbuilt_other_than_res_flag,\n\t\tbuilt_other_than_res_descript,\n\t\tlog_intricate_corner_flag,\n\t\tlog_const_system_flag,\n\t\tlog_frame_flag,\n\t\troomer_boarder_flag,\n\t\troomer_boarder_num,\n\t\tfull_time_residence_flag,\n\t\tadd_int_na_flag,\n\t\tloss_history_na_flag,\n\t\tmodified_date,\n\t\tmodified_user_id,\n\t\tvisited_status_type_code,\n\t\tmine_subsidence_rejection_flag,\n\t\tdeposit_amt_applied_flag,\n\t\tdeposit_amt_applied,\n\t\tconst_eifs_flag,\n\t\tpool_depth_by_diving_board,\n\t\ttax_location,\n\t\tprotected_suburban_class_flag,\n\t\tnum_of_occupied_dwellings_flag,\n\t\twater_source_and_pumper_truck_flag,\n\t\tpumper_truck_gallons_flag,\n\t\tmiles_from_populated_municipality_flag,\n\t\tdaycare_flag,\n\t\tten_or_more_homes_flag,\n\t\taccessible_year_round_flag,\n\t\twithin_five_miles_of_fd_flag,\n\t\tdwelling_fire_app,\n\t\tmanually_rated_code,\n\t\tloc_status_type_code,\n\t\tconst_type_code_change_flag,\n\t\tstruct_type_code_change_flag,\n\t\tendorsement_view_code,\n\t\tpif_legal_addr,\n\t\tpif_legal_addr_change_flag,\n\t\tpif_home_disc,\n\t\twoodbrn_stove_flag_change_flag,\n\t\tpif_woodbrn_stove_prem,\n\t\tprotect_class_type_code_change_flag,\n\t\tsigned_other_struct_excl_flag,\n\t\tpif_hm_usage_type_code,\n\t\tpif_market_desire_value_flag,\n\t\tpif_woodbrn_stove_flag,\n\t\tpif_built_year,\n\t\tpif_num_of_family,\n\t\tpif_protect_class_type_code,\n\t\tbuilders_risk_flag\n\tFROM location\n),\nEXP_LOCATION AS (\n\tSELECT\n\tloc_seq,\n\tpolicy_num,\n\tpolicy_sym,\n\tpolicy_mod,\n\tpolicy_mco,\n\tcov_part_type_code,\n\tho_type_code,\n\thm_usage_type_code,\n\tloc_num,\n\tstreet,\n\tcity,\n\tstate_type_code,\n\tzip_type_code,\n\tcounty_type_code,\n\tsection,\n\ttown,\n\trange,\n\ttown_of,\n\tcredit_exist_ins_exp_date,\n\tmarket_desire_value_flag,\n\tbill_to_type_code,\n\tbill_time_type_code,\n\tconst_type_code,\n\tbuilt_year,\n\tmarket_value,\n\treplacement_cost,\n\tstruct_type_code,\n\toccupancy_type_code,\n\tnum_of_family,\n\tnum_of_apt,\n\tterritory,\n\tprotect_class_type_code,\n\thydrant_dist_type_code,\n\tfire_station_dis,\n\tresp_fire_dept,\n\thydrant_excl_flag,\n\tprotect_device_type_code,\n\tfire_place_type_code,\n\tprotect_class_rate_type_code,\n\tsuburban_flag,\n\troof_type_code,\n\tstandard_amps_flag,\n\telec_serv_type_code,\n\trow_house_fire_wall_flag,\n\twoodbrn_stove_flag,\n\tswimming_pool_flag,\n\tpool_type_code,\n\tslide_diving_type_code,\n\tnum_of_hm_in_sub_dev,\n\tinside_city_limit_flag,\n\tbus_on_premises_flag,\n\tbus_on_premises_descript,\n\tnum_of_emp,\n\tflood_plain_flag,\n\trenovation_flag,\n\trenovation_descript,\n\ttrampoline_flag,\n\ttrampoline_descript,\n\tbuilt_other_than_res_flag,\n\tbuilt_other_than_res_descript,\n\tlog_intricate_corner_flag,\n\tlog_const_system_flag,\n\tlog_frame_flag,\n\troomer_boarder_flag,\n\troomer_boarder_num,\n\tfull_time_residence_flag,\n\tadd_int_na_flag,\n\tloss_history_na_flag,\n\tmodified_date,\n\tmodified_user_id,\n\tvisited_status_type_code,\n\tmine_subsidence_rejection_flag,\n\tdeposit_amt_applied_flag,\n\tdeposit_amt_applied,\n\tconst_eifs_flag,\n\tpool_depth_by_diving_board,\n\ttax_location,\n\tprotected_suburban_class_flag,\n\tnum_of_occupied_dwellings_flag,\n\twater_source_and_pumper_truck_flag,\n\tpumper_truck_gallons_flag,\n\tmiles_from_populated_municipality_flag,\n\tdaycare_flag,\n\tten_or_more_homes_flag,\n\taccessible_year_round_flag,\n\twithin_five_miles_of_fd_flag,\n\tdwelling_fire_app,\n\tmanually_rated_code,\n\tloc_status_type_code,\n\tconst_type_code_change_flag,\n\tstruct_type_code_change_flag,\n\tendorsement_view_code,\n\tpif_legal_addr,\n\tpif_legal_addr_change_flag,\n\tpif_home_disc,\n\twoodbrn_stove_flag_change_flag,\n\tpif_woodbrn_stove_prem,\n\tprotect_class_type_code_change_flag,\n\tsigned_other_struct_excl_flag,\n\tpif_hm_usage_type_code,\n\tpif_market_desire_value_flag,\n\tpif_woodbrn_stove_flag,\n\tpif_built_year,\n\tpif_num_of_family,\n\tpif_protect_class_type_code,\n\tbuilders_risk_flag,\n\tSYSDATE AS EXTRACT_DATE,\n\tSYSDATE AS AS_OF_DATE,\n\t'' AS RECORD_COUNT,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID\n\tFROM SQ_location\n),\nlocation_plines_stage AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.location_plines_stage;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.location_plines_stage\n\t(loc_seq, policy_num, policy_sym, policy_mod, policy_mco, cov_part_type_code, ho_type_code, hm_usage_type_code, loc_num, street, city, state_type_code, zip_type_code, county_type_code, section, town, range, town_of, credit_exist_ins_exp_date, market_desire_value_flag, bill_to_type_code, bill_time_type_code, const_type_code, built_year, market_value, replacement_cost, struct_type_code, occupancy_type_code, num_of_family, num_of_apt, territory, protect_class_type_code, hydrant_dist_type_code, fire_station_dis, resp_fire_dept, hydrant_excl_flag, protect_device_type_code, fire_place_type_code, protect_class_rate_type_code, suburban_flag, roof_type_code, standard_amps_flag, elec_serv_type_code, row_house_fire_wall_flag, woodbrn_stove_flag, swimming_pool_flag, pool_type_code, slide_diving_type_code, num_of_hm_in_sub_dev, inside_city_limit_flag, bus_on_premises_flag, bus_on_premises_descript, num_of_emp, flood_plain_flag, renovation_flag, renovation_descript, trampoline_flag, trampoline_descript, built_other_than_res_flag, built_other_than_res_descript, log_intricate_corner_flag, log_const_system_flag, log_frame_flag, roomer_boarder_flag, roomer_boarder_num, full_time_residence_flag, add_int_na_flag, loss_history_na_flag, modified_date, modified_user_id, visited_status_type_code, mine_subsidence_rejection_flag, deposit_amt_applied_flag, deposit_amt_applied, const_eifs_flag, pool_depth_by_diving_board, tax_location, protected_suburban_class_flag, num_of_occupied_dwellings_flag, water_source_and_pumper_truck_flag, pumper_truck_gallons_flag, miles_from_populated_municipality_flag, daycare_flag, ten_or_more_homes_flag, accessible_year_round_flag, within_five_miles_of_fd_flag, dwelling_fire_app, manually_rated_code, loc_status_type_code, const_type_code_change_flag, struct_type_code_change_flag, endorsement_view_code, pif_legal_addr, pif_legal_addr_change_flag, pif_home_disc, woodbrn_stove_flag_change_flag, pif_woodbrn_stove_prem, protect_class_type_code_change_flag, signed_other_struct_excl_flag, pif_hm_usage_type_code, pif_market_desire_value_flag, pif_woodbrn_stove_flag, pif_built_year, pif_num_of_family, pif_protect_class_type_code, builders_risk_flag, extract_date, as_of_date, record_count, source_system_id)\n\tSELECT \n\tLOC_SEQ, \n\tPOLICY_NUM, \n\tPOLICY_SYM, \n\tPOLICY_MOD, \n\tPOLICY_MCO, \n\tCOV_PART_TYPE_CODE, \n\tHO_TYPE_CODE, \n\tHM_USAGE_TYPE_CODE, \n\tLOC_NUM, \n\tSTREET, \n\tCITY, \n\tSTATE_TYPE_CODE, \n\tZIP_TYPE_CODE, \n\tCOUNTY_TYPE_CODE, \n\tSECTION, \n\tTOWN, \n\tRANGE, \n\tTOWN_OF, \n\tCREDIT_EXIST_INS_EXP_DATE, \n\tMARKET_DESIRE_VALUE_FLAG, \n\tBILL_TO_TYPE_CODE, \n\tBILL_TIME_TYPE_CODE, \n\tCONST_TYPE_CODE, \n\tBUILT_YEAR, \n\tMARKET_VALUE, \n\tREPLACEMENT_COST, \n\tSTRUCT_TYPE_CODE, \n\tOCCUPANCY_TYPE_CODE, \n\tNUM_OF_FAMILY, \n\tNUM_OF_APT, \n\tTERRITORY, \n\tPROTECT_CLASS_TYPE_CODE, \n\tHYDRANT_DIST_TYPE_CODE, \n\tFIRE_STATION_DIS, \n\tRESP_FIRE_DEPT, \n\tHYDRANT_EXCL_FLAG, \n\tPROTECT_DEVICE_TYPE_CODE, \n\tFIRE_PLACE_TYPE_CODE, \n\tPROTECT_CLASS_RATE_TYPE_CODE, \n\tSUBURBAN_FLAG, \n\tROOF_TYPE_CODE, \n\tSTANDARD_AMPS_FLAG, \n\tELEC_SERV_TYPE_CODE, \n\tROW_HOUSE_FIRE_WALL_FLAG, \n\tWOODBRN_STOVE_FLAG, \n\tSWIMMING_POOL_FLAG, \n\tPOOL_TYPE_CODE, \n\tSLIDE_DIVING_TYPE_CODE, \n\tNUM_OF_HM_IN_SUB_DEV, \n\tINSIDE_CITY_LIMIT_FLAG, \n\tBUS_ON_PREMISES_FLAG, \n\tBUS_ON_PREMISES_DESCRIPT, \n\tNUM_OF_EMP, \n\tFLOOD_PLAIN_FLAG, \n\tRENOVATION_FLAG, \n\tRENOVATION_DESCRIPT, \n\tTRAMPOLINE_FLAG, \n\tTRAMPOLINE_DESCRIPT, \n\tBUILT_OTHER_THAN_RES_FLAG, \n\tBUILT_OTHER_THAN_RES_DESCRIPT, \n\tLOG_INTRICATE_CORNER_FLAG, \n\tLOG_CONST_SYSTEM_FLAG, \n\tLOG_FRAME_FLAG, \n\tROOMER_BOARDER_FLAG, \n\tROOMER_BOARDER_NUM, \n\tFULL_TIME_RESIDENCE_FLAG, \n\tADD_INT_NA_FLAG, \n\tLOSS_HISTORY_NA_FLAG, \n\tMODIFIED_DATE, \n\tMODIFIED_USER_ID, \n\tVISITED_STATUS_TYPE_CODE, \n\tMINE_SUBSIDENCE_REJECTION_FLAG, \n\tDEPOSIT_AMT_APPLIED_FLAG, \n\tDEPOSIT_AMT_APPLIED, \n\tCONST_EIFS_FLAG, \n\tPOOL_DEPTH_BY_DIVING_BOARD, \n\tTAX_LOCATION, \n\tPROTECTED_SUBURBAN_CLASS_FLAG, \n\tNUM_OF_OCCUPIED_DWELLINGS_FLAG, \n\tWATER_SOURCE_AND_PUMPER_TRUCK_FLAG, \n\tPUMPER_TRUCK_GALLONS_FLAG, \n\tMILES_FROM_POPULATED_MUNICIPALITY_FLAG, \n\tDAYCARE_FLAG, \n\tTEN_OR_MORE_HOMES_FLAG, \n\tACCESSIBLE_YEAR_ROUND_FLAG, \n\tWITHIN_FIVE_MILES_OF_FD_FLAG, \n\tDWELLING_FIRE_APP, \n\tMANUALLY_RATED_CODE, \n\tLOC_STATUS_TYPE_CODE, \n\tCONST_TYPE_CODE_CHANGE_FLAG, \n\tSTRUCT_TYPE_CODE_CHANGE_FLAG, \n\tENDORSEMENT_VIEW_CODE, \n\tPIF_LEGAL_ADDR, \n\tPIF_LEGAL_ADDR_CHANGE_FLAG, \n\tPIF_HOME_DISC, \n\tWOODBRN_STOVE_FLAG_CHANGE_FLAG, \n\tPIF_WOODBRN_STOVE_PREM, \n\tPROTECT_CLASS_TYPE_CODE_CHANGE_FLAG, \n\tSIGNED_OTHER_STRUCT_EXCL_FLAG, \n\tPIF_HM_USAGE_TYPE_CODE, \n\tPIF_MARKET_DESIRE_VALUE_FLAG, \n\tPIF_WOODBRN_STOVE_FLAG, \n\tPIF_BUILT_YEAR, \n\tPIF_NUM_OF_FAMILY, \n\tPIF_PROTECT_CLASS_TYPE_CODE, \n\tBUILDERS_RISK_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID\n\tFROM EXP_LOCATION\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "CommonStaging/"
        },
        "annotations": []
    }
}