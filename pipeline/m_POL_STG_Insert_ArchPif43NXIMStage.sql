WITH
SQ_Pif43NXIMStage AS (
	SELECT
		Pif43NXIMStageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		PMDNXI1SegmentId,
		PMDNXI1SegmentStatus,
		PMDNXI1YearTransaction,
		PMDNXI1MonthTransaction,
		PMDNXI1DayTransaction,
		PMDNXI1SegmentLevelCode,
		PMDNXI1SegmentPartCode,
		PMDNXI1SubPartCode,
		PMDNXI1InsuranceLine,
		PMDNXI1LocationNumber,
		PMDNXI1SubLocationNumber,
		PMDNXI1YearItemEffective,
		PMDNXI1MonthItemEffective,
		PMDNXI1DayItemEffective,
		PMDNXI1VariableKey,
		PMDNXI1YearProcess,
		PMDNXI1MonthProcess,
		PMDNXI1DayProcess,
		PMDNXI1RatingState,
		PMDNXI1TerrCode,
		PMDNXI1ClassDescSource,
		PMDNXI1BldgCspClassCode,
		PMDNXI1RatePlan,
		PMDNXI1ContCspClassCode,
		PMDNXI1CspConstrCod,
		PMDNXI1ProtectionClassPart1,
		PMDNXI1ProtectionClassPart2,
		PMDNXI1GrpiiEcSymbol,
		PMDNXI1GrpiiNumPrefixX,
		PMDNXI1GrpiSpecificRate,
		PMDNXI1GrpiiSpecificRate,
		PMDNXI1ArReportPeriod,
		PMDNXI1ArAdjPeriod,
		PMDNXI1GenlClsRtGrp,
		PMDNXI1GrpiCode,
		PMDNXI1Zone,
		PMDNXI1ZoneArea,
		PMDNXI1OccCls,
		PMDNXI1OccSym,
		PMDNXI1GrpiiType,
		PMDNXI1GrpiiCode,
		PMDNXI1ClassDescription,
		PMDNXI1MassDistrict,
		PMDNXI1MassTenReloExp,
		PMDNXI1DecChangeFlag,
		PMDNXI1FartsBreakage,
		PMDNXI1TransRadius,
		PMDNXI1BusinessClass,
		PMDNXI1TransGroupN,
		PMDNXI1EdpBackup,
		PMDNXI1EdpAddlFact,
		PMDNXI1TransInd,
		PMDNXI1EdpEqInd,
		PMDNXI1PmsFutureUse,
		PMDNXI1MinimumPremium,
		PMDNXI1ReportingRate,
		PMDNXI1EdpOtlSw,
		PMDNXI1CustomerUse,
		PMDNXI1Yr2000CustUse
	FROM Pif43NXIMStage
),
EXP_Pif43NXIMStage AS (
	SELECT
	Pif43NXIMStageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	PMDNXI1SegmentId,
	PMDNXI1SegmentStatus,
	PMDNXI1YearTransaction,
	PMDNXI1MonthTransaction,
	PMDNXI1DayTransaction,
	PMDNXI1SegmentLevelCode,
	PMDNXI1SegmentPartCode,
	PMDNXI1SubPartCode,
	PMDNXI1InsuranceLine,
	PMDNXI1LocationNumber,
	PMDNXI1SubLocationNumber,
	PMDNXI1YearItemEffective,
	PMDNXI1MonthItemEffective,
	PMDNXI1DayItemEffective,
	PMDNXI1VariableKey,
	PMDNXI1YearProcess,
	PMDNXI1MonthProcess,
	PMDNXI1DayProcess,
	PMDNXI1RatingState,
	PMDNXI1TerrCode,
	PMDNXI1ClassDescSource,
	PMDNXI1BldgCspClassCode,
	PMDNXI1RatePlan,
	PMDNXI1ContCspClassCode,
	PMDNXI1CspConstrCod,
	PMDNXI1ProtectionClassPart1,
	PMDNXI1ProtectionClassPart2,
	PMDNXI1GrpiiEcSymbol,
	PMDNXI1GrpiiNumPrefixX,
	PMDNXI1GrpiSpecificRate,
	PMDNXI1GrpiiSpecificRate,
	PMDNXI1ArReportPeriod,
	PMDNXI1ArAdjPeriod,
	PMDNXI1GenlClsRtGrp,
	PMDNXI1GrpiCode,
	PMDNXI1Zone,
	PMDNXI1ZoneArea,
	PMDNXI1OccCls,
	PMDNXI1OccSym,
	PMDNXI1GrpiiType,
	PMDNXI1GrpiiCode,
	PMDNXI1ClassDescription,
	PMDNXI1MassDistrict,
	PMDNXI1MassTenReloExp,
	PMDNXI1DecChangeFlag,
	PMDNXI1FartsBreakage,
	PMDNXI1TransRadius,
	PMDNXI1BusinessClass,
	PMDNXI1TransGroupN,
	PMDNXI1EdpBackup,
	PMDNXI1EdpAddlFact,
	PMDNXI1TransInd,
	PMDNXI1EdpEqInd,
	PMDNXI1PmsFutureUse,
	PMDNXI1MinimumPremium,
	PMDNXI1ReportingRate,
	PMDNXI1EdpOtlSw,
	PMDNXI1CustomerUse,
	PMDNXI1Yr2000CustUse,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif43NXIMStage
),
ArchPif43NXIMStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43NXIMStage
	(ExtractDate, SourceSystemid, AuditId, PifSymbol, PifPolicyNumber, PifModule, PMDNXI1SegmentId, PMDNXI1SegmentStatus, PMDNXI1YearTransaction, PMDNXI1MonthTransaction, PMDNXI1DayTransaction, PMDNXI1SegmentLevelCode, PMDNXI1SegmentPartCode, PMDNXI1SubPartCode, PMDNXI1InsuranceLine, PMDNXI1LocationNumber, PMDNXI1SubLocationNumber, PMDNXI1YearItemEffective, PMDNXI1MonthItemEffective, PMDNXI1DayItemEffective, PMDNXI1VariableKey, PMDNXI1YearProcess, PMDNXI1MonthProcess, PMDNXI1DayProcess, PMDNXI1RatingState, PMDNXI1TerrCode, PMDNXI1ClassDescSource, PMDNXI1BldgCspClassCode, PMDNXI1RatePlan, PMDNXI1ContCspClassCode, PMDNXI1CspConstrCod, PMDNXI1ProtectionClassPart1, PMDNXI1ProtectionClassPart2, PMDNXI1GrpiiEcSymbol, PMDNXI1GrpiiNumPrefixX, PMDNXI1GrpiSpecificRate, PMDNXI1GrpiiSpecificRate, PMDNXI1ArReportPeriod, PMDNXI1ArAdjPeriod, PMDNXI1GenlClsRtGrp, PMDNXI1GrpiCode, PMDNXI1Zone, PMDNXI1ZoneArea, PMDNXI1OccCls, PMDNXI1OccSym, PMDNXI1GrpiiType, PMDNXI1GrpiiCode, PMDNXI1ClassDescription, PMDNXI1MassDistrict, PMDNXI1MassTenReloExp, PMDNXI1DecChangeFlag, PMDNXI1FartsBreakage, PMDNXI1TransRadius, PMDNXI1BusinessClass, PMDNXI1TransGroupN, PMDNXI1EdpBackup, PMDNXI1EdpAddlFact, PMDNXI1TransInd, PMDNXI1EdpEqInd, PMDNXI1PmsFutureUse, PMDNXI1MinimumPremium, PMDNXI1ReportingRate, PMDNXI1EdpOtlSw, PMDNXI1CustomerUse, PMDNXI1Yr2000CustUse)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_audit_id AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDNXI1SEGMENTID, 
	PMDNXI1SEGMENTSTATUS, 
	PMDNXI1YEARTRANSACTION, 
	PMDNXI1MONTHTRANSACTION, 
	PMDNXI1DAYTRANSACTION, 
	PMDNXI1SEGMENTLEVELCODE, 
	PMDNXI1SEGMENTPARTCODE, 
	PMDNXI1SUBPARTCODE, 
	PMDNXI1INSURANCELINE, 
	PMDNXI1LOCATIONNUMBER, 
	PMDNXI1SUBLOCATIONNUMBER, 
	PMDNXI1YEARITEMEFFECTIVE, 
	PMDNXI1MONTHITEMEFFECTIVE, 
	PMDNXI1DAYITEMEFFECTIVE, 
	PMDNXI1VARIABLEKEY, 
	PMDNXI1YEARPROCESS, 
	PMDNXI1MONTHPROCESS, 
	PMDNXI1DAYPROCESS, 
	PMDNXI1RATINGSTATE, 
	PMDNXI1TERRCODE, 
	PMDNXI1CLASSDESCSOURCE, 
	PMDNXI1BLDGCSPCLASSCODE, 
	PMDNXI1RATEPLAN, 
	PMDNXI1CONTCSPCLASSCODE, 
	PMDNXI1CSPCONSTRCOD, 
	PMDNXI1PROTECTIONCLASSPART1, 
	PMDNXI1PROTECTIONCLASSPART2, 
	PMDNXI1GRPIIECSYMBOL, 
	PMDNXI1GRPIINUMPREFIXX, 
	PMDNXI1GRPISPECIFICRATE, 
	PMDNXI1GRPIISPECIFICRATE, 
	PMDNXI1ARREPORTPERIOD, 
	PMDNXI1ARADJPERIOD, 
	PMDNXI1GENLCLSRTGRP, 
	PMDNXI1GRPICODE, 
	PMDNXI1ZONE, 
	PMDNXI1ZONEAREA, 
	PMDNXI1OCCCLS, 
	PMDNXI1OCCSYM, 
	PMDNXI1GRPIITYPE, 
	PMDNXI1GRPIICODE, 
	PMDNXI1CLASSDESCRIPTION, 
	PMDNXI1MASSDISTRICT, 
	PMDNXI1MASSTENRELOEXP, 
	PMDNXI1DECCHANGEFLAG, 
	PMDNXI1FARTSBREAKAGE, 
	PMDNXI1TRANSRADIUS, 
	PMDNXI1BUSINESSCLASS, 
	PMDNXI1TRANSGROUPN, 
	PMDNXI1EDPBACKUP, 
	PMDNXI1EDPADDLFACT, 
	PMDNXI1TRANSIND, 
	PMDNXI1EDPEQIND, 
	PMDNXI1PMSFUTUREUSE, 
	PMDNXI1MINIMUMPREMIUM, 
	PMDNXI1REPORTINGRATE, 
	PMDNXI1EDPOTLSW, 
	PMDNXI1CUSTOMERUSE, 
	PMDNXI1YR2000CUSTUSE
	FROM EXP_Pif43NXIMStage
),