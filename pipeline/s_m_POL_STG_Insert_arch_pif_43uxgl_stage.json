{
    "name": "s_m_POL_STG_Insert_arch_pif_43uxgl_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43uxgl_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif43UXGLStage AS (\n\tSELECT\n\t\tPif43UXGLStageId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifModule,\n\t\tPmduxg1RecLength,\n\t\tPmduxg1ActionCode,\n\t\tPmduxg1FileId,\n\t\tPmduxg1SegmentId,\n\t\tPmduxg1SegmentStatus,\n\t\tPmduxg1YearTransaction,\n\t\tPmduxg1MonthTransaction,\n\t\tPmduxg1DayTransaction,\n\t\tPmduxg1SegmentLevelCode,\n\t\tPmduxg1SegmentPartCode,\n\t\tPmduxg1SubPartCode,\n\t\tPmduxg1InsuranceLine,\n\t\tPmduxg1LocationNumber,\n\t\tPmduxg1PmsDefGlSubline,\n\t\tPmduxg1ClassCodeGroup,\n\t\tPmduxg1ClassCodeMember,\n\t\tPmduxg1ClassCode,\n\t\tPmduxg1RiskSequence,\n\t\tPmduxg1RiskTypeInd,\n\t\tPmduxg1YearItemEffective,\n\t\tPmduxg1MonthItemEffective,\n\t\tPmduxg1DayItemEffective,\n\t\tPmduxg1AddInterestType,\n\t\tPmduxg1AddInterestSeq,\n\t\tPmduxg1ProdwCovType,\n\t\tPmduxg1YearProcess,\n\t\tPmduxg1MonthProcess,\n\t\tPmduxg1DayProcess,\n\t\tPmduxg1ExposureAmount,\n\t\tPmduxg1RatingClass,\n\t\tPmduxg1IncLimitTableInd,\n\t\tPmduxg1ClassDescSource,\n\t\tPmduxg1YearInTransition,\n\t\tPmduxg1ExposureIndicator,\n\t\tPmduxg1RatingState,\n\t\tPmduxg1Territory,\n\t\tPmduxg1CoOwnRspLiabInd,\n\t\tPmduxg1MtgeeAssgnLiabInd,\n\t\tPmduxg1CntlIntInd,\n\t\tPmduxg1OwnLandLesdInd,\n\t\tPmduxg1OwnLeseLiabInd,\n\t\tPmduxg1ExectAdminTrstInd,\n\t\tPmduxg1ElectOficCorpInd,\n\t\tPmduxg1GovtUntsOwnInd,\n\t\tPmduxg1FiducCovFiducInd,\n\t\tPmduxg1MbrOfChrchInd,\n\t\tPmduxg1OilGasOpsOwnInd,\n\t\tPmduxg1TrstClrgyInd,\n\t\tPmduxg1SpseOfPartnInd,\n\t\tPmduxg1PrivResBiInd,\n\t\tPmduxg1PrivResAptNumFam,\n\t\tPmduxg1FcltyMbrSchlInd,\n\t\tPmduxg1SchlGovtImmInd,\n\t\tPmduxg1PremBasis,\n\t\tPmduxg1ExposureBasis,\n\t\tPmduxg1YearCvgExpire,\n\t\tPmduxg1MonthCvrExpire,\n\t\tPmduxg1DayCvgExpire,\n\t\tPmduxg1SplitCombinedDedInd,\n\t\tPmduxg1DedAmount,\n\t\tPmduxg1DeductiblePer,\n\t\tPmduxg1DedAmtPd,\n\t\tPmduxg1DeductiblePerPd,\n\t\tPmduxg1PmaCode,\n\t\tPmduxg1ARatesInd,\n\t\tPmduxg1FringeCode1,\n\t\tPmduxg1FringeCode2,\n\t\tPmduxg1FringeCode3,\n\t\tPmduxg1SpecialMedPayInd,\n\t\tPmduxg1SklMinPremInd,\n\t\tPmduxg1ProductsInd,\n\t\tPmduxg1ExtReptPrdMonths,\n\t\tPmduxg1ErpPercent,\n\t\tPmduxg1OldBaseExposure,\n\t\tPmduxg1OldPremiumBasis,\n\t\tPmduxg1DecChangeFlag,\n\t\tPmduxg1ExpoInd,\n\t\tPmduxg1NoDecInd,\n\t\tPmduxg1ClassMinPrem,\n\t\tPmduxg1MunLiabInd,\n\t\tPmduxg1SklMinPrem,\n\t\tPmduxg1StatTerritory,\n\t\tPmduxg1PmscFutureUse,\n\t\tPmduxg1DayCareInd,\n\t\tPmduxg1TranProgInd,\n\t\tPmduxg1LocationChangeInd,\n\t\tPmduxg1AuditClassSw,\n\t\tPmduxg1BroadFormInd,\n\t\tPmduxg1TerrManualOverride,\n\t\tPmduxg1CustFutureUse,\n\t\tPmduxg1BusinessClass,\n\t\tPmduxg1BldgNum,\n\t\tPmduxg1Yr2000CustUse,\n\t\tPmduxg1WbcKey,\n\t\tExtractDate,\n\t\tAsOfDate,\n\t\tRecordCount,\n\t\tSourceSystemId\n\tFROM Pif43UXGLStage\n),\nEXP_Values AS (\n\tSELECT\n\tPif43UXGLStageId AS Pif43UXStageId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifModule,\n\tPmduxg1RecLength,\n\tPmduxg1ActionCode,\n\tPmduxg1FileId,\n\tPmduxg1SegmentId,\n\tPmduxg1SegmentStatus,\n\tPmduxg1YearTransaction,\n\tPmduxg1MonthTransaction,\n\tPmduxg1DayTransaction,\n\tPmduxg1SegmentLevelCode,\n\tPmduxg1SegmentPartCode,\n\tPmduxg1SubPartCode,\n\tPmduxg1InsuranceLine,\n\tPmduxg1LocationNumber,\n\tPmduxg1PmsDefGlSubline,\n\tPmduxg1ClassCodeGroup,\n\tPmduxg1ClassCodeMember,\n\tPmduxg1ClassCode,\n\tPmduxg1RiskSequence,\n\tPmduxg1RiskTypeInd,\n\tPmduxg1YearItemEffective AS Pmduxg1YrItemEffective,\n\tPmduxg1MonthItemEffective AS Pmduxg1MthItemEffective,\n\tPmduxg1DayItemEffective,\n\tPmduxg1AddInterestType,\n\tPmduxg1AddInterestSeq,\n\tPmduxg1ProdwCovType,\n\tPmduxg1YearProcess,\n\tPmduxg1MonthProcess,\n\tPmduxg1DayProcess,\n\tPmduxg1ExposureAmount AS Pmduxg1ExposureAmountD,\n\tPmduxg1RatingClass,\n\tPmduxg1IncLimitTableInd,\n\tPmduxg1ClassDescSource,\n\tPmduxg1YearInTransition AS Pmduxg1YearInTransitionD,\n\tPmduxg1ExposureIndicator,\n\tPmduxg1RatingState,\n\tPmduxg1Territory,\n\tPmduxg1CoOwnRspLiabInd,\n\tPmduxg1MtgeeAssgnLiabInd,\n\tPmduxg1CntlIntInd,\n\tPmduxg1OwnLandLesdInd,\n\tPmduxg1OwnLeseLiabInd,\n\tPmduxg1ExectAdminTrstInd,\n\tPmduxg1ElectOficCorpInd,\n\tPmduxg1GovtUntsOwnInd,\n\tPmduxg1FiducCovFiducInd,\n\tPmduxg1MbrOfChrchInd,\n\tPmduxg1OilGasOpsOwnInd,\n\tPmduxg1TrstClrgyInd,\n\tPmduxg1SpseOfPartnInd,\n\tPmduxg1PrivResBiInd,\n\tPmduxg1PrivResAptNumFam,\n\tPmduxg1FcltyMbrSchlInd,\n\tPmduxg1SchlGovtImmInd,\n\tPmduxg1PremBasis,\n\tPmduxg1ExposureBasis,\n\tPmduxg1YearCvgExpire,\n\tPmduxg1MonthCvrExpire,\n\tPmduxg1DayCvgExpire,\n\tPmduxg1SplitCombinedDedInd,\n\tPmduxg1DedAmount,\n\tPmduxg1DeductiblePer,\n\tPmduxg1DedAmtPd,\n\tPmduxg1DeductiblePerPd,\n\tPmduxg1PmaCode,\n\tPmduxg1ARatesInd,\n\tPmduxg1FringeCode1,\n\tPmduxg1FringeCode2,\n\tPmduxg1FringeCode3,\n\tPmduxg1SpecialMedPayInd,\n\tPmduxg1SklMinPremInd,\n\tPmduxg1ProductsInd,\n\tPmduxg1ExtReptPrdMonths,\n\tPmduxg1ErpPercent,\n\tPmduxg1OldBaseExposure,\n\tPmduxg1OldPremiumBasis,\n\tPmduxg1DecChangeFlag,\n\tPmduxg1ExpoInd,\n\tPmduxg1NoDecInd,\n\tPmduxg1ClassMinPrem,\n\tPmduxg1MunLiabInd,\n\tPmduxg1SklMinPrem,\n\tPmduxg1StatTerritory,\n\tPmduxg1PmscFutureUse,\n\tPmduxg1DayCareInd,\n\tPmduxg1TranProgInd,\n\tPmduxg1LocationChangeInd,\n\tPmduxg1AuditClassSw,\n\tPmduxg1BroadFormInd,\n\tPmduxg1TerrManualOverride,\n\tPmduxg1CustFutureUse,\n\tPmduxg1BusinessClass,\n\tPmduxg1BldgNum,\n\tPmduxg1Yr2000CustUse,\n\tPmduxg1WbcKey,\n\tExtractDate,\n\tAsOfDate,\n\tRecordCount,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_Pif43UXGLStage\n),\nTGT_ArchPif43UXGLStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UXGLStage\n\t(Pif43UXGLStage, PifSymbol, PifPolicyNumber, PifModule, Pmduxg1RecLength, Pmduxg1ActionCode, Pmduxg1FileId, Pmduxg1SegmentId, Pmduxg1SegmentStatus, Pmduxg1YearTransaction, Pmduxg1MonthTransaction, Pmduxg1DayTransaction, Pmduxg1SegmentLevelCode, Pmduxg1SegmentPartCode, Pmduxg1SubPartCode, Pmduxg1InsuranceLine, Pmduxg1LocationNumber, Pmduxg1PmsDefGlSubline, Pmduxg1ClassCodeGroup, Pmduxg1ClassCodeMember, Pmduxg1ClassCode, Pmduxg1RiskSequence, Pmduxg1RiskTypeInd, Pmduxg1YearItemEffective, Pmduxg1MonthItemEffective, Pmduxg1DayItemEffective, Pmduxg1AddInterestType, Pmduxg1AddInterestSeq, Pmduxg1ProdwCovType, Pmduxg1YearProcess, Pmduxg1MonthProcess, Pmduxg1DayProcess, Pmduxg1ExposureAmountD, Pmduxg1RatingClass, Pmduxg1IncLimitTableInd, Pmduxg1ClassDescSource, Pmduxg1YearInTransition, Pmduxg1ExposureIndicator, Pmduxg1RatingState, Pmduxg1Territory, Pmduxg1CoOwnRspLiabInd, Pmduxg1MtgeeAssgnLiabInd, Pmduxg1CntlIntInd, Pmduxg1OwnLandLesdInd, Pmduxg1OwnLeseLiabInd, Pmduxg1ExectAdminTrstInd, Pmduxg1ElectOficCorpInd, Pmduxg1GovtUntsOwnInd, Pmduxg1FiducCovFiducInd, Pmduxg1MbrOfChrchInd, Pmduxg1OilGasOpsOwnInd, Pmduxg1TrstClrgyInd, Pmduxg1SpseOfPartnInd, Pmduxg1PrivResBiInd, Pmduxg1PrivResAptNumFam, Pmduxg1FcltyMbrSchlInd, Pmduxg1SchlGovtImmInd, Pmduxg1PremBasis, Pmduxg1ExposureBasis, Pmduxg1YearCvgExpire, Pmduxg1MonthCvrExpire, Pmduxg1DayCvgExpire, Pmduxg1SplitCombinedDedInd, Pmduxg1DedAmount, Pmduxg1DeductiblePer, Pmduxg1DedAmtPd, Pmduxg1DeductiblePerPd, Pmduxg1PmaCode, Pmduxg1ARatesInd, Pmduxg1FringeCode1, Pmduxg1FringeCode2, Pmduxg1FringeCode3, Pmduxg1SpecialMedPayInd, Pmduxg1SklMinPremInd, Pmduxg1ProductsInd, Pmduxg1ExtReptPrdMonths, Pmduxg1ErpPercent, Pmduxg1OldBaseExposure, Pmduxg1OldPremiumBasis, Pmduxg1DecChangeFlag, Pmduxg1ExpoInd, Pmduxg1NoDecInd, Pmduxg1ClassMinPrem, Pmduxg1MunLiabInd, Pmduxg1SklMinPrem, Pmduxg1StatTerritory, Pmduxg1PmscFutureUse, Pmduxg1DayCareInd, Pmduxg1TranProgInd, Pmduxg1LocationChangeInd, Pmduxg1AuditClassSw, Pmduxg1BroadFormInd, Pmduxg1TerrManualOverride, Pmduxg1CustFutureUse, Pmduxg1BusinessClass, Pmduxg1BldgNum, Pmduxg1Yr2000CustUse, Pmduxg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)\n\tSELECT \n\tPif43UXStageId AS PIF43UXGLSTAGE, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFMODULE, \n\tPMDUXG1RECLENGTH, \n\tPMDUXG1ACTIONCODE, \n\tPMDUXG1FILEID, \n\tPMDUXG1SEGMENTID, \n\tPMDUXG1SEGMENTSTATUS, \n\tPMDUXG1YEARTRANSACTION, \n\tPMDUXG1MONTHTRANSACTION, \n\tPMDUXG1DAYTRANSACTION, \n\tPMDUXG1SEGMENTLEVELCODE, \n\tPMDUXG1SEGMENTPARTCODE, \n\tPMDUXG1SUBPARTCODE, \n\tPMDUXG1INSURANCELINE, \n\tPMDUXG1LOCATIONNUMBER, \n\tPMDUXG1PMSDEFGLSUBLINE, \n\tPMDUXG1CLASSCODEGROUP, \n\tPMDUXG1CLASSCODEMEMBER, \n\tPMDUXG1CLASSCODE, \n\tPMDUXG1RISKSEQUENCE, \n\tPMDUXG1RISKTYPEIND, \n\tPmduxg1YrItemEffective AS PMDUXG1YEARITEMEFFECTIVE, \n\tPmduxg1MthItemEffective AS PMDUXG1MONTHITEMEFFECTIVE, \n\tPMDUXG1DAYITEMEFFECTIVE, \n\tPMDUXG1ADDINTERESTTYPE, \n\tPMDUXG1ADDINTERESTSEQ, \n\tPMDUXG1PRODWCOVTYPE, \n\tPMDUXG1YEARPROCESS, \n\tPMDUXG1MONTHPROCESS, \n\tPMDUXG1DAYPROCESS, \n\tPMDUXG1EXPOSUREAMOUNTD, \n\tPMDUXG1RATINGCLASS, \n\tPMDUXG1INCLIMITTABLEIND, \n\tPMDUXG1CLASSDESCSOURCE, \n\tPmduxg1YearInTransitionD AS PMDUXG1YEARINTRANSITION, \n\tPMDUXG1EXPOSUREINDICATOR, \n\tPMDUXG1RATINGSTATE, \n\tPMDUXG1TERRITORY, \n\tPMDUXG1COOWNRSPLIABIND, \n\tPMDUXG1MTGEEASSGNLIABIND, \n\tPMDUXG1CNTLINTIND, \n\tPMDUXG1OWNLANDLESDIND, \n\tPMDUXG1OWNLESELIABIND, \n\tPMDUXG1EXECTADMINTRSTIND, \n\tPMDUXG1ELECTOFICCORPIND, \n\tPMDUXG1GOVTUNTSOWNIND, \n\tPMDUXG1FIDUCCOVFIDUCIND, \n\tPMDUXG1MBROFCHRCHIND, \n\tPMDUXG1OILGASOPSOWNIND, \n\tPMDUXG1TRSTCLRGYIND, \n\tPMDUXG1SPSEOFPARTNIND, \n\tPMDUXG1PRIVRESBIIND, \n\tPMDUXG1PRIVRESAPTNUMFAM, \n\tPMDUXG1FCLTYMBRSCHLIND, \n\tPMDUXG1SCHLGOVTIMMIND, \n\tPMDUXG1PREMBASIS, \n\tPMDUXG1EXPOSUREBASIS, \n\tPMDUXG1YEARCVGEXPIRE, \n\tPMDUXG1MONTHCVREXPIRE, \n\tPMDUXG1DAYCVGEXPIRE, \n\tPMDUXG1SPLITCOMBINEDDEDIND, \n\tPMDUXG1DEDAMOUNT, \n\tPMDUXG1DEDUCTIBLEPER, \n\tPMDUXG1DEDAMTPD, \n\tPMDUXG1DEDUCTIBLEPERPD, \n\tPMDUXG1PMACODE, \n\tPMDUXG1ARATESIND, \n\tPMDUXG1FRINGECODE1, \n\tPMDUXG1FRINGECODE2, \n\tPMDUXG1FRINGECODE3, \n\tPMDUXG1SPECIALMEDPAYIND, \n\tPMDUXG1SKLMINPREMIND, \n\tPMDUXG1PRODUCTSIND, \n\tPMDUXG1EXTREPTPRDMONTHS, \n\tPMDUXG1ERPPERCENT, \n\tPMDUXG1OLDBASEEXPOSURE, \n\tPMDUXG1OLDPREMIUMBASIS, \n\tPMDUXG1DECCHANGEFLAG, \n\tPMDUXG1EXPOIND, \n\tPMDUXG1NODECIND, \n\tPMDUXG1CLASSMINPREM, \n\tPMDUXG1MUNLIABIND, \n\tPMDUXG1SKLMINPREM, \n\tPMDUXG1STATTERRITORY, \n\tPMDUXG1PMSCFUTUREUSE, \n\tPMDUXG1DAYCAREIND, \n\tPMDUXG1TRANPROGIND, \n\tPMDUXG1LOCATIONCHANGEIND, \n\tPMDUXG1AUDITCLASSSW, \n\tPMDUXG1BROADFORMIND, \n\tPMDUXG1TERRMANUALOVERRIDE, \n\tPMDUXG1CUSTFUTUREUSE, \n\tPMDUXG1BUSINESSCLASS, \n\tPMDUXG1BLDGNUM, \n\tPMDUXG1YR2000CUSTUSE, \n\tPMDUXG1WBCKEY, \n\tEXTRACTDATE, \n\tASOFDATE, \n\tRECORDCOUNT, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID\n\tFROM EXP_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}