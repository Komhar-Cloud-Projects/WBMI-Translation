{
    "name": "s_m_POL_FEED_WorkCatastropheExposureVehicle_DCT",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_WorkCatastropheExposureVehicle_DCT",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkCatastropheExposureTransaction AS (\n\tselect WCET.SourceSystemID,\r\n\tPOL.pol_key,\r\n\tWCET.VehicleNumber,\r\n\tWCET.BusinessType,\r\n\tIRLE.InsuranceReferenceLegalEntityDescription,\r\n\tRL.StreetAddress,\r\n\tRL.RatingCity,\r\n\tSS.state_code,\r\n\tRL.ZipPostalCode,\r\n\tRL.RatingCounty,\r\n\tCDCA.VehicleYear,\r\n\tPT.PremiumTransactionAmount,\r\n\tAGY.AgencyCode,\r\n\tSPC.StrategicProfitCenterDescription, \r\n\tISG.InsuranceSegmentDescription,\r\n\tCC.name,\r\n\tCC.cust_num ,\r\n\tPOL.pol_eff_date,\r\n\tPOL.pol_exp_date,\r\n\tRTRIM(SUBSTRING(SBCC.StandardBusinessClassCode, 1, 5)) OccupancyCode,\r\n\tCC.sic_code,\r\n\t@{pipeline().parameters.PROCESS_DATE} ProcessDate, \r\n\tWCET.AddToLocationPremiumFlag, \r\n\tWCET.TerrorismRiskIndicator \r\n\tfrom @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction WCET\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\ton WCET.PremiumTransactionAKId=PT.PremiumTransactionAKID\r\n\tand PT.CurrentSnapshotFlag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\ton PT.RatingCoverageAKID=RC.RatingCoverageAKID\r\n\tand RC.EffectiveDate=PT.EffectiveDate \r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\ton PC.PolicyCoverageAKID=RC.PolicyCoverageAKID\r\n\tand PC.CurrentSnapshotFlag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\ton PC.RiskLocationAKID=RL.RiskLocationAKID\r\n\tand RL.CurrentSnapshotFlag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy POL\r\n\ton POL.pol_ak_id=RL.PolicyAKID\r\n\tand POL.crrnt_snpsht_flag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer CC\r\n\ton CC.contract_cust_ak_id=POL.contract_cust_ak_id\r\n\tand CC.crrnt_snpsht_flag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency AGY\r\n\ton AGY.AgencyAKID=POL.AgencyAKId\r\n\tand AGY.CurrentSnapshotFlag=1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_business_classification_code SBCC\r\n\ton SBCC.sup_bus_class_code_id=POL.sup_bus_class_code_id \r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_state SS\r\n\ton (CASE WHEN len(SS.state_abbrev) = 1 THEN '0' + SS.state_abbrev ELSE SS.state_abbrev END) = (CASE WHEN len(RL.StateProvinceCode) = 1 THEN '0' + RL.StateProvinceCode ELSE RL.StateProvinceCode END)\r\n\tand SS.crrnt_snpsht_flag = 1\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment ISG\r\n\ton POL.InsuranceSegmentAKId=ISG.InsuranceSegmentAKId\r\n\tand ISG.CurrentSnapshotFlag=1\r\n\tand ISG.InsuranceSegmentAbbreviation = 'CL'\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter SPC\r\n\ton POL.StrategicProfitCenterAKId=SPC.StrategicProfitCenterAKId\r\n\tand SPC.CurrentSnapshotFlag=1 \r\n\tand SPC.StrategicProfitCenterDescription IN ('West Bend Commercial Lines', 'NSI')\r\n\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity IRLE\r\n\ton SPC.InsuranceReferenceLegalEntityId = IRLE.InsuranceReferenceLegalEntityId \r\n\tand IRLE.CurrentSnapshotFlag = 1\r\n\t\r\n\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialAuto CDCA\r\n\ton CDCA.PremiumTransactionId=PT.PremiumTransactionId\r\n\twhere WCET.BusinessType = 'Commercial Auto'\r\n\tAND WCET.VehicleNumber > 0\r\n\t\r\n\t\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Cal AS (\n\tSELECT\n\tSourceSystemId,\n\tpol_key,\n\tVehicleNumber,\n\tBusinessType,\n\tInsuranceReferenceLegalEntityDescription,\n\tStreetAddress,\n\tRatingCity,\n\tstate_code,\n\tZipPostalCode,\n\tRatingCounty,\n\tVehicleYear,\n\tPremiumTransactionAmount,\n\tAgencyCode,\n\tStrategicProfitCenterDescription,\n\tInsuranceSegmentDescription,\n\tname,\n\tcust_num,\n\tpol_eff_date,\n\tpol_exp_date,\n\tOccupancyCode,\n\tsic_code,\n\tProcessDate,\n\tAddToLocationPremiumFlag,\n\tTerrorismRiskIndicator,\n\tpol_key AS o_PolicyKey,\n\t-- *INF*: IIF(state_code='N/A', '', RTRIM(state_code))\n\tIFF(state_code = 'N/A', '', RTRIM(state_code)) AS o_RatingStateProvinceAbbreviation,\n\t-- *INF*: SUBSTR(LTRIM(ZipPostalCode), 0, 5)\n\tSUBSTR(LTRIM(ZipPostalCode), 0, 5) AS o_RatingPostalCode,\n\t-- *INF*: IIF(ISNULL(VehicleYear), '', VehicleYear)\n\tIFF(VehicleYear IS NULL, '', VehicleYear) AS o_ModelYear,\n\tAgencyCode AS o_AgencyCode,\n\tname AS o_InsuredName,\n\t-- *INF*: RTRIM(SUBSTR(cust_num, 1, 12))\n\tRTRIM(SUBSTR(cust_num, 1, 12)) AS o_CustomerNumber,\n\tpol_eff_date AS o_PolicyEffectiveDate,\n\tpol_exp_date AS o_PolicyExpirationDate,\n\t-- *INF*: RTRIM(SUBSTR(sic_code, 1, 4))\n\tRTRIM(SUBSTR(sic_code, 1, 4)) AS o_SicCode\n\tFROM SQ_WorkCatastropheExposureTransaction\n),\nAGG_VehiclePremium AS (\n\tSELECT\n\tSourceSystemId,\n\to_PolicyKey AS PolicyKey,\n\tVehicleNumber,\n\tBusinessType,\n\tInsuranceReferenceLegalEntityDescription,\n\tStreetAddress,\n\tRatingCity,\n\to_RatingStateProvinceAbbreviation AS RatingStateProvinceAbbreviation,\n\to_RatingPostalCode AS RatingPostalCode,\n\tRatingCounty,\n\to_ModelYear AS ModelYear,\n\tPremiumTransactionAmount,\n\to_AgencyCode AS AgencyCode,\n\tStrategicProfitCenterDescription,\n\tInsuranceSegmentDescription,\n\to_InsuredName AS InsuredName,\n\to_CustomerNumber AS CustomerNumber,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\tOccupancyCode,\n\to_SicCode AS SicCode,\n\tProcessDate,\n\tAddToLocationPremiumFlag,\n\tTerrorismRiskIndicator,\n\t-- *INF*: SUM(PremiumTransactionAmount, AddToLocationPremiumFlag='T')\n\tSUM(PremiumTransactionAmount, AddToLocationPremiumFlag = 'T') AS o_VehiclePremium\n\tFROM EXP_Cal\n\tGROUP BY PolicyKey, VehicleNumber, BusinessType\n),\nLKP_WorkCatastropheExposureDeductible AS (\n\tSELECT\n\tDeductibleValue,\n\tPolicyKey,\n\tVehicleNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT D.PolicyKey AS PolicyKey , D.VehicleNumber as VehicleNumber , D.BusinessType as BusinessType, \r\n\t\t RelevantDeductibles.TargetColumn AS TargetColumn,\r\n\t\t (CASE WHEN RelevantDeductibles.CalculationRule = 'MAX' THEN MAX(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t\t  WHEN RelevantDeductibles.CalculationRule = 'MIN' THEN MIN(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t\t  WHEN RelevantDeductibles.CalculationRule = 'SUM' THEN SUM(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t\t  ELSE 0 \r\n\t\t END) AS DeductibleValue\r\n\t\tFROM  @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureDeductible D\r\n\t\tINNER JOIN (SELECT DISTINCT BusinessType, DeductibleType, CalculationRule, TargetColumn \r\n\t\t  FROM  @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SupCatastropheExposureDeductibleRule \r\n\t\t  WHERE TargetColumn = 'Loc Dedctbl' \r\n\t\t  AND SourceSystemId = 'DCT') RelevantDeductibles ON D.BusinessType = RelevantDeductibles.BusinessType AND D.DeductibleType = RelevantDeductibles.DeductibleType\r\n\t\tWHERE D.BusinessType = 'Commercial Auto'\r\n\t\tGROUP BY D.PolicyKey, D.VehicleNumber, D.BusinessType, RelevantDeductibles.TargetColumn, RelevantDeductibles.CalculationRule\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,VehicleNumber,BusinessType ORDER BY DeductibleValue) = 1\n),\nLKP_WorkCatastropheExposureLimit AS (\n\tSELECT\n\tLimitValue,\n\tPolicyKey,\n\tVehicleNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT L.PolicyKey as PolicyKey, L.VehicleNumber as VehicleNumber, L.BusinessType as BusinessType, \r\n\t\t RelevantLimits.TargetColumn AS TargetColumn,\r\n\t\t (CASE WHEN RelevantLimits.CalculationRule = 'MAX' THEN MAX(CONVERT(BIGINT, L.LimitValue)) \r\n\t\t  WHEN RelevantLimits.CalculationRule = 'MIN' THEN MIN(CONVERT(BIGINT, L.LimitValue)) \r\n\t\t  WHEN RelevantLimits.CalculationRule = 'SUM' THEN SUM(CONVERT(BIGINT, L.LimitValue)) \r\n\t\t  ELSE 0 \r\n\t\t END) AS LimitValue\r\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureLimit L\r\n\t\tINNER JOIN (SELECT DISTINCT BusinessType, LimitType, CalculationRule, TargetColumn \r\n\t\t  FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SupCatastropheExposureLimitRule \r\n\t\t  WHERE TargetColumn = 'Loc Limit' \r\n\t\t  AND SourceSystemId = 'DCT') RelevantLimits ON L.BusinessType = RelevantLimits.BusinessType AND L.LimitType = RelevantLimits.LimitType\r\n\t\tWHERE L.BusinessType = 'Commercial Auto'\r\n\t\tGROUP BY L.PolicyKey, L.VehicleNumber, L.BusinessType, RelevantLimits.TargetColumn, RelevantLimits.CalculationRule\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,VehicleNumber,BusinessType ORDER BY LimitValue) = 1\n),\nLKP_WorkCatastropheExposureTransaction_ALS AS (\n\tSELECT\n\tDCTCoverageTypeCode,\n\tPolicyKey,\n\tVehicleNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tDCTCoverageTypeCode,\n\t\t\tPolicyKey,\n\t\t\tVehicleNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE DctCoverageTypeCode = 'ALS'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,VehicleNumber,BusinessType ORDER BY DCTCoverageTypeCode) = 1\n),\nLKP_WorkCatastropheExposureTransaction_PlusPak AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Plus Pak'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_Terrorismflag AS (\n\tSELECT\n\tPolicyKey,\n\tBusinessType,\n\tTerrorismRiskIndicator,\n\ti_PolicyKey,\n\ti_BusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tPolicyKey,\n\t\t\tBusinessType,\n\t\t\tTerrorismRiskIndicator,\n\t\t\ti_PolicyKey,\n\t\t\ti_BusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE TerrorismRiskIndicator = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY PolicyKey) = 1\n),\nEXP_MetaData AS (\n\tSELECT\n\tAGG_VehiclePremium.SourceSystemId,\n\tAGG_VehiclePremium.PolicyKey,\n\tAGG_VehiclePremium.VehicleNumber,\n\tAGG_VehiclePremium.BusinessType,\n\tAGG_VehiclePremium.InsuranceReferenceLegalEntityDescription,\n\tAGG_VehiclePremium.StreetAddress,\n\tAGG_VehiclePremium.RatingCity,\n\tAGG_VehiclePremium.RatingStateProvinceAbbreviation,\n\tAGG_VehiclePremium.RatingPostalCode,\n\tAGG_VehiclePremium.RatingCounty,\n\tAGG_VehiclePremium.ModelYear,\n\tAGG_VehiclePremium.o_VehiclePremium AS VehiclePremium,\n\t-- *INF*: IIF(ISNULL(VehiclePremium),0,VehiclePremium)\n\tIFF(VehiclePremium IS NULL, 0, VehiclePremium) AS o_VehiclePremium,\n\tLKP_WorkCatastropheExposureLimit.LimitValue AS VehicleLimit,\n\tLKP_WorkCatastropheExposureDeductible.DeductibleValue AS VehicleDeductible,\n\tAGG_VehiclePremium.AgencyCode,\n\tAGG_VehiclePremium.StrategicProfitCenterDescription,\n\tAGG_VehiclePremium.InsuranceSegmentDescription,\n\tAGG_VehiclePremium.InsuredName,\n\tAGG_VehiclePremium.CustomerNumber,\n\tAGG_VehiclePremium.PolicyEffectiveDate,\n\tAGG_VehiclePremium.PolicyExpirationDate,\n\tAGG_VehiclePremium.OccupancyCode,\n\tAGG_VehiclePremium.SicCode,\n\tAGG_VehiclePremium.ProcessDate,\n\tAGG_VehiclePremium.TerrorismRiskIndicator,\n\tLKP_WorkCatastropheExposureTransaction_PlusPak.CoverageDescription AS lkp_CoverageDescription_PlusPak,\n\tLKP_WorkCatastropheExposureTransaction_ALS.DCTCoverageTypeCode AS lkp_DCTCoverageTypeCode_ALS,\n\tLKP_WorkCatastropheExposureTransaction_Terrorismflag.TerrorismRiskIndicator AS lkp_TerrorismRiskIndicator_Terrorismflag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\tVehicleLimit AS o_AdjustedTotalInsuredValue,\n\t-- *INF*: IIF(ISNULL(lkp_CoverageDescription_PlusPak), '0','1')\n\tIFF(lkp_CoverageDescription_PlusPak IS NULL, '0', '1') AS o_PlusPakFlag,\n\t-- *INF*: IIF(ISNULL(lkp_DCTCoverageTypeCode_ALS), '0','1')\n\tIFF(lkp_DCTCoverageTypeCode_ALS IS NULL, '0', '1') AS o_ActualLossSustainedCoverageFlag,\n\t-- *INF*: IIF(ISNULL(lkp_TerrorismRiskIndicator_Terrorismflag), '0','1')\n\tIFF(lkp_TerrorismRiskIndicator_Terrorismflag IS NULL, '0', '1') AS o_TerrorismFlag\n\tFROM AGG_VehiclePremium\n\tLEFT JOIN LKP_WorkCatastropheExposureDeductible\n\tON LKP_WorkCatastropheExposureDeductible.PolicyKey = AGG_VehiclePremium.PolicyKey AND LKP_WorkCatastropheExposureDeductible.VehicleNumber = AGG_VehiclePremium.VehicleNumber AND LKP_WorkCatastropheExposureDeductible.BusinessType = AGG_VehiclePremium.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureLimit\n\tON LKP_WorkCatastropheExposureLimit.PolicyKey = AGG_VehiclePremium.PolicyKey AND LKP_WorkCatastropheExposureLimit.VehicleNumber = AGG_VehiclePremium.VehicleNumber AND LKP_WorkCatastropheExposureLimit.BusinessType = AGG_VehiclePremium.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_ALS\n\tON LKP_WorkCatastropheExposureTransaction_ALS.PolicyKey = AGG_VehiclePremium.PolicyKey AND LKP_WorkCatastropheExposureTransaction_ALS.VehicleNumber = AGG_VehiclePremium.VehicleNumber AND LKP_WorkCatastropheExposureTransaction_ALS.BusinessType = AGG_VehiclePremium.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_PlusPak\n\tON LKP_WorkCatastropheExposureTransaction_PlusPak.PolicyKey = AGG_VehiclePremium.PolicyKey AND LKP_WorkCatastropheExposureTransaction_PlusPak.BusinessType = AGG_VehiclePremium.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_Terrorismflag\n\tON LKP_WorkCatastropheExposureTransaction_Terrorismflag.PolicyKey = AGG_VehiclePremium.PolicyKey AND LKP_WorkCatastropheExposureTransaction_Terrorismflag.BusinessType = AGG_VehiclePremium.BusinessType\n),\nFIL_VehiclePremium AS (\n\tSELECT\n\tSourceSystemId, \n\tPolicyKey, \n\tVehicleNumber, \n\tBusinessType, \n\tInsuranceReferenceLegalEntityDescription, \n\tStreetAddress, \n\tRatingCity, \n\tRatingStateProvinceAbbreviation, \n\tRatingPostalCode, \n\tRatingCounty, \n\tModelYear, \n\to_VehiclePremium AS VehiclePremium, \n\tVehicleLimit, \n\tVehicleDeductible, \n\tAgencyCode, \n\tStrategicProfitCenterDescription, \n\tInsuranceSegmentDescription, \n\tInsuredName, \n\tCustomerNumber, \n\tPolicyEffectiveDate, \n\tPolicyExpirationDate, \n\tOccupancyCode, \n\tSicCode, \n\tProcessDate, \n\to_AuditId, \n\to_CreatedDate, \n\to_ModifiedDate, \n\to_AdjustedTotalInsuredValue, \n\to_PlusPakFlag, \n\to_ActualLossSustainedCoverageFlag, \n\to_TerrorismFlag\n\tFROM EXP_MetaData\n\tWHERE VehiclePremium != 0\n),\nWorkCatastropheExposureVehicle AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureVehicle;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureVehicle\n\t(AuditId, CreatedDate, ModifiedDate, SourceSystemId, PolicyKey, VehicleNumber, BusinessType, InsuranceReferenceLegalEntityDescription, RatingAddress, RatingCity, RatingStateProvinceAbbreviation, RatingPostalCode, RatingCounty, ModelYear, VehiclePremium, VehicleLimit, VehicleDeductible, AdjustedTotalInsuredValue, AgencyCode, StrategicProfitCenterDescription, InsuranceSegmentDescription, PlusPakFlag, ActualLossSustainedCoverageFlag, InsuredName, CustomerNumber, PolicyEffectiveDate, PolicyExpirationDate, OccupancyCode, SicCode, TerrorismFlag, ProcessDate)\n\tSELECT \n\to_AuditId AS AUDITID, \n\to_CreatedDate AS CREATEDDATE, \n\to_ModifiedDate AS MODIFIEDDATE, \n\tSOURCESYSTEMID, \n\tPOLICYKEY, \n\tVEHICLENUMBER, \n\tBUSINESSTYPE, \n\tINSURANCEREFERENCELEGALENTITYDESCRIPTION, \n\tStreetAddress AS RATINGADDRESS, \n\tRATINGCITY, \n\tRATINGSTATEPROVINCEABBREVIATION, \n\tRATINGPOSTALCODE, \n\tRATINGCOUNTY, \n\tMODELYEAR, \n\tVEHICLEPREMIUM, \n\tVEHICLELIMIT, \n\tVEHICLEDEDUCTIBLE, \n\to_AdjustedTotalInsuredValue AS ADJUSTEDTOTALINSUREDVALUE, \n\tAGENCYCODE, \n\tSTRATEGICPROFITCENTERDESCRIPTION, \n\tINSURANCESEGMENTDESCRIPTION, \n\to_PlusPakFlag AS PLUSPAKFLAG, \n\to_ActualLossSustainedCoverageFlag AS ACTUALLOSSSUSTAINEDCOVERAGEFLAG, \n\tINSUREDNAME, \n\tCUSTOMERNUMBER, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYEXPIRATIONDATE, \n\tOCCUPANCYCODE, \n\tSICCODE, \n\to_TerrorismFlag AS TERRORISMFLAG, \n\tPROCESSDATE\n\tFROM FIL_VehiclePremium\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "PROCESS_DATE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}