WITH
LKP_pif_42gp_stage AS (
	SELECT
	logical_flag,
	pif_symbol,
	pif_policy_number,
	pif_module,
	ipfcgp_year_of_loss,
	ipfcgp_month_of_loss,
	ipfcgp_day_of_loss,
	ipfcgp_loss_occurence
	FROM (
		SELECT 
			logical_flag,
			pif_symbol,
			pif_policy_number,
			pif_module,
			ipfcgp_year_of_loss,
			ipfcgp_month_of_loss,
			ipfcgp_day_of_loss,
			ipfcgp_loss_occurence
		FROM pif_42gp_stage
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module,ipfcgp_year_of_loss,ipfcgp_month_of_loss,ipfcgp_day_of_loss,ipfcgp_loss_occurence ORDER BY logical_flag) = 1
),
SQ_dailypif_PIF_42GJ AS (

-- TODO Manual --

),
EXP_INPUTS AS (
	SELECT
	IPFC4J_ID_NUMBER AS ipfc4j_id_number1,
	-- *INF*: LTRIM(RTRIM(ipfc4j_id_number1))
	LTRIM(RTRIM(ipfc4j_id_number1)) AS ipfc4j_id_number
	FROM SQ_dailypif_PIF_42GJ
),
LKP_pif_42gj_stage_daily_TokenService_File AS (
),
EXP_Evaluate AS (
	SELECT
	EXP_INPUTS.ipfc4j_id_number,
	LKP_pif_42gj_stage_daily_TokenService_File.lkp_ipfc4j_id_number,
	LKP_pif_42gj_stage_daily_TokenService_File.ipfc4j_id_number_Tokens,
	-- *INF*: IIF(ISNULL(LTRIM(RTRIM(lkp_ipfc4j_id_number))),ipfc4j_id_number,ipfc4j_id_number_Tokens)
	IFF(LTRIM(RTRIM(lkp_ipfc4j_id_number)) IS NULL, ipfc4j_id_number, ipfc4j_id_number_Tokens) AS v_ipfc4j_id_number,
	v_ipfc4j_id_number AS o_ipfc4j_id_number
	FROM EXP_INPUTS
	LEFT JOIN LKP_pif_42gj_stage_daily_TokenService_File
	ON LKP_pif_42gj_stage_daily_TokenService_File.lkp_ipfc4j_id_number = EXP_INPUTS.ipfc4j_id_number
),
FIL_REMV_NULL_SEG_ID AS (
	SELECT
	SQ_dailypif_PIF_42GJ.PIF_SYMBOL, 
	SQ_dailypif_PIF_42GJ.PIF_POLICY_NUMBER, 
	SQ_dailypif_PIF_42GJ.PIF_MODULE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEGMENT_ID, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEGMENT_LEVEL_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEGMENT_PART_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SUB_PART_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_INSURANCE_LINE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOCATION_NUMBER, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SUB_LOCATION_NUMBER, 
	SQ_dailypif_PIF_42GJ.IPFC4J_RISK_UNIT_GROUP, 
	SQ_dailypif_PIF_42GJ.IPFC4J_CLASS_CODE_GROUP, 
	SQ_dailypif_PIF_42GJ.IPFC4J_CLASS_CODE_MEMBER, 
	SQ_dailypif_PIF_42GJ.IPFC4J_RISK_UNIT, 
	SQ_dailypif_PIF_42GJ.IPFC4J_RISK_SEQUENCE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_RISK_TYPE_IND, 
	SQ_dailypif_PIF_42GJ.IPFC4J_YEAR_ITEM_EFFECTIVE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_MONTH_ITEM_EFFECTIVE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_DAY_ITEM_EFFECTIVE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOSS_YEAR, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOSS_MONTH, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOSS_DAY, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOSS_OCCURENCE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOSS_CLAIMANT, 
	SQ_dailypif_PIF_42GJ.IPFC4J_USE_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEQUENCE_USE_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_AI_SEQ_USE_CODE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_YEAR_PROCESS, 
	SQ_dailypif_PIF_42GJ.IPFC4J_MONTH_PROCESS, 
	SQ_dailypif_PIF_42GJ.IPFC4J_DAY_PROCESS, 
	SQ_dailypif_PIF_42GJ.IPFC4J_YEAR_CHANGE_ENTRY, 
	SQ_dailypif_PIF_42GJ.IPFC4J_MONTH_CHANGE_ENTRY, 
	SQ_dailypif_PIF_42GJ.IPFC4J_DAY_CHANGE_ENTRY, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEQUENCE_CHANGE_ENTRY, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SEGMENT_STATUS, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ENTRY_OPERATOR, 
	SQ_dailypif_PIF_42GJ.IPFC4J_USE_CODE_DATA, 
	SQ_dailypif_PIF_42GJ.IPFC4J_SORT_NAME, 
	SQ_dailypif_PIF_42GJ.IPFC4J_NAME_TYPE_IND, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ADDRESS_LINE_1, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ADDR_LIN_2_POS_1, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ADDR_LIN_2_POS_2_30, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ADDRESS_LINE_3, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ADDRESS_LINE_4, 
	EXP_Evaluate.o_ipfc4j_id_number AS IPFC4J_ID_NUMBER, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ZIP_BASIC, 
	SQ_dailypif_PIF_42GJ.IPFC4J_ZIP_EXPANDED, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PHONE_AREA, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PHONE_EXCHANGE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PHONE_NUMBER, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PHONE_EXTENSION, 
	SQ_dailypif_PIF_42GJ.IPFC4J_INTEREST_ITEM, 
	SQ_dailypif_PIF_42GJ.IPFC4J_LOCATION_STATE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_OFFSET_ONSET_IND, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PMS_FUTURE_USE_4J_1, 
	SQ_dailypif_PIF_42GJ.IPFC4J_CUST_SPL_USE_4J_1, 
	SQ_dailypif_PIF_42GJ.IPFC4J_PMS_FUTURE_USE, 
	SQ_dailypif_PIF_42GJ.IPFC4J_YR2000_CUST_USE, 
	SQ_dailypif_PIF_42GJ.SC_POLICY_TYPE, 
	SQ_dailypif_PIF_42GJ.SC_LOCATION_CODE, 
	SQ_dailypif_PIF_42GJ.SC_MASTER_COMPANY, 
	SQ_dailypif_PIF_42GJ.SC_SYMBOL, 
	SQ_dailypif_PIF_42GJ.SC_POLICY_NUMBER, 
	SQ_dailypif_PIF_42GJ.SC_POLICY_MODULE, 
	SQ_dailypif_PIF_42GJ.SC_RECORD_ID, 
	SQ_dailypif_PIF_42GJ.SC_OPERATOR_ID1, 
	SQ_dailypif_PIF_42GJ.SC_OPERATOR_ID2, 
	SQ_dailypif_PIF_42GJ.SC_AGENCY_STATE, 
	SQ_dailypif_PIF_42GJ.SC_AGENCY_NAME, 
	SQ_dailypif_PIF_42GJ.SC_ACCOUNT_NUMBER, 
	SQ_dailypif_PIF_42GJ.SC_SPECIAL_COMPANY, 
	SQ_dailypif_PIF_42GJ.SC_SPECIAL_ISSUE, 
	SQ_dailypif_PIF_42GJ.SC_SORT_NAME, 
	SQ_dailypif_PIF_42GJ.SC_CUSTOMER_NUMBER, 
	SQ_dailypif_PIF_42GJ.PIF_42GJ_INF_ACTION, 
	SQ_dailypif_PIF_42GJ.INF_TIMESTAMP, 
	SQ_dailypif_PIF_42GJ.INF_SPECIFIC_INFO
	FROM EXP_Evaluate
	 -- Manually join with SQ_dailypif_PIF_42GJ
	WHERE NOT ISNULL(IPFC4J_SEGMENT_ID)
),
SRT_PIF_42GJ AS (
	SELECT
	PIF_SYMBOL, 
	PIF_POLICY_NUMBER, 
	PIF_MODULE, 
	IPFC4J_SEGMENT_ID, 
	IPFC4J_SEGMENT_LEVEL_CODE, 
	IPFC4J_SEGMENT_PART_CODE, 
	IPFC4J_SUB_PART_CODE, 
	IPFC4J_INSURANCE_LINE, 
	IPFC4J_LOCATION_NUMBER, 
	IPFC4J_SUB_LOCATION_NUMBER, 
	IPFC4J_RISK_UNIT_GROUP, 
	IPFC4J_CLASS_CODE_GROUP, 
	IPFC4J_CLASS_CODE_MEMBER, 
	IPFC4J_RISK_UNIT, 
	IPFC4J_RISK_SEQUENCE, 
	IPFC4J_RISK_TYPE_IND, 
	IPFC4J_LOSS_YEAR, 
	IPFC4J_LOSS_MONTH, 
	IPFC4J_LOSS_DAY, 
	IPFC4J_LOSS_OCCURENCE, 
	IPFC4J_LOSS_CLAIMANT, 
	IPFC4J_USE_CODE, 
	INF_TIMESTAMP, 
	IPFC4J_YEAR_ITEM_EFFECTIVE, 
	IPFC4J_MONTH_ITEM_EFFECTIVE, 
	IPFC4J_DAY_ITEM_EFFECTIVE, 
	IPFC4J_SEQUENCE_USE_CODE, 
	IPFC4J_AI_SEQ_USE_CODE, 
	IPFC4J_YEAR_PROCESS, 
	IPFC4J_MONTH_PROCESS, 
	IPFC4J_DAY_PROCESS, 
	IPFC4J_YEAR_CHANGE_ENTRY, 
	IPFC4J_MONTH_CHANGE_ENTRY, 
	IPFC4J_DAY_CHANGE_ENTRY, 
	IPFC4J_SEQUENCE_CHANGE_ENTRY, 
	IPFC4J_SEGMENT_STATUS, 
	IPFC4J_ENTRY_OPERATOR, 
	IPFC4J_USE_CODE_DATA, 
	IPFC4J_SORT_NAME, 
	IPFC4J_NAME_TYPE_IND, 
	IPFC4J_ADDRESS_LINE_1, 
	IPFC4J_ADDR_LIN_2_POS_1, 
	IPFC4J_ADDR_LIN_2_POS_2_30, 
	IPFC4J_ADDRESS_LINE_3, 
	IPFC4J_ADDRESS_LINE_4, 
	IPFC4J_ID_NUMBER, 
	IPFC4J_ZIP_BASIC, 
	IPFC4J_ZIP_EXPANDED, 
	IPFC4J_PHONE_AREA, 
	IPFC4J_PHONE_EXCHANGE, 
	IPFC4J_PHONE_NUMBER, 
	IPFC4J_PHONE_EXTENSION, 
	IPFC4J_INTEREST_ITEM, 
	IPFC4J_LOCATION_STATE, 
	IPFC4J_OFFSET_ONSET_IND, 
	IPFC4J_PMS_FUTURE_USE_4J_1, 
	IPFC4J_CUST_SPL_USE_4J_1, 
	IPFC4J_PMS_FUTURE_USE, 
	IPFC4J_YR2000_CUST_USE, 
	PIF_42GJ_INF_ACTION
	FROM FIL_REMV_NULL_SEG_ID
	ORDER BY PIF_SYMBOL ASC, PIF_POLICY_NUMBER ASC, PIF_MODULE ASC, IPFC4J_LOSS_YEAR ASC, IPFC4J_LOSS_MONTH ASC, IPFC4J_LOSS_DAY ASC, IPFC4J_LOSS_OCCURENCE ASC, IPFC4J_LOSS_CLAIMANT ASC, IPFC4J_USE_CODE ASC, INF_TIMESTAMP ASC, IPFC4J_YEAR_ITEM_EFFECTIVE ASC, IPFC4J_MONTH_ITEM_EFFECTIVE ASC, IPFC4J_DAY_ITEM_EFFECTIVE ASC, IPFC4J_ENTRY_OPERATOR ASC
),
AGG_REMV_DUP_POL_RECS AS (
	SELECT
	PIF_SYMBOL,
	PIF_POLICY_NUMBER,
	PIF_MODULE,
	IPFC4J_SEGMENT_ID,
	IPFC4J_SEGMENT_LEVEL_CODE,
	IPFC4J_SEGMENT_PART_CODE,
	IPFC4J_SUB_PART_CODE,
	IPFC4J_INSURANCE_LINE,
	IPFC4J_LOCATION_NUMBER,
	IPFC4J_SUB_LOCATION_NUMBER,
	IPFC4J_RISK_UNIT_GROUP,
	IPFC4J_CLASS_CODE_GROUP,
	IPFC4J_CLASS_CODE_MEMBER,
	IPFC4J_RISK_UNIT,
	IPFC4J_RISK_SEQUENCE,
	IPFC4J_RISK_TYPE_IND,
	IPFC4J_YEAR_ITEM_EFFECTIVE,
	IPFC4J_MONTH_ITEM_EFFECTIVE,
	IPFC4J_DAY_ITEM_EFFECTIVE,
	IPFC4J_LOSS_YEAR,
	IPFC4J_LOSS_MONTH,
	IPFC4J_LOSS_DAY,
	IPFC4J_LOSS_OCCURENCE,
	IPFC4J_LOSS_CLAIMANT,
	IPFC4J_USE_CODE,
	IPFC4J_SEQUENCE_USE_CODE,
	IPFC4J_AI_SEQ_USE_CODE,
	IPFC4J_YEAR_PROCESS,
	IPFC4J_MONTH_PROCESS,
	IPFC4J_DAY_PROCESS,
	IPFC4J_YEAR_CHANGE_ENTRY,
	IPFC4J_MONTH_CHANGE_ENTRY,
	IPFC4J_DAY_CHANGE_ENTRY,
	IPFC4J_SEQUENCE_CHANGE_ENTRY,
	IPFC4J_SEGMENT_STATUS,
	IPFC4J_ENTRY_OPERATOR,
	IPFC4J_USE_CODE_DATA,
	IPFC4J_SORT_NAME,
	IPFC4J_NAME_TYPE_IND,
	IPFC4J_ADDRESS_LINE_1,
	IPFC4J_ADDR_LIN_2_POS_1,
	IPFC4J_ADDR_LIN_2_POS_2_30,
	IPFC4J_ADDRESS_LINE_3,
	IPFC4J_ADDRESS_LINE_4,
	IPFC4J_ID_NUMBER,
	IPFC4J_ZIP_BASIC,
	IPFC4J_ZIP_EXPANDED,
	IPFC4J_PHONE_AREA,
	IPFC4J_PHONE_EXCHANGE,
	IPFC4J_PHONE_NUMBER,
	IPFC4J_PHONE_EXTENSION,
	IPFC4J_INTEREST_ITEM,
	IPFC4J_LOCATION_STATE,
	IPFC4J_OFFSET_ONSET_IND,
	IPFC4J_PMS_FUTURE_USE_4J_1,
	IPFC4J_CUST_SPL_USE_4J_1,
	IPFC4J_PMS_FUTURE_USE,
	IPFC4J_YR2000_CUST_USE,
	PIF_42GJ_INF_ACTION,
	INF_TIMESTAMP
	FROM SRT_PIF_42GJ
	QUALIFY ROW_NUMBER() OVER (PARTITION BY PIF_SYMBOL, PIF_POLICY_NUMBER, PIF_MODULE, IPFC4J_LOSS_YEAR, IPFC4J_LOSS_MONTH, IPFC4J_LOSS_DAY, IPFC4J_LOSS_OCCURENCE, IPFC4J_LOSS_CLAIMANT, IPFC4J_USE_CODE ORDER BY NULL) = 1
),
EXP_PIF_42GJ AS (
	SELECT
	PIF_SYMBOL,
	PIF_POLICY_NUMBER,
	PIF_MODULE,
	IPFC4J_SEGMENT_ID,
	IPFC4J_SEGMENT_LEVEL_CODE,
	IPFC4J_SEGMENT_PART_CODE,
	IPFC4J_SUB_PART_CODE,
	IPFC4J_INSURANCE_LINE,
	IPFC4J_LOCATION_NUMBER,
	IPFC4J_SUB_LOCATION_NUMBER,
	IPFC4J_RISK_UNIT_GROUP,
	IPFC4J_CLASS_CODE_GROUP,
	IPFC4J_CLASS_CODE_MEMBER,
	IPFC4J_RISK_UNIT,
	IPFC4J_RISK_SEQUENCE,
	IPFC4J_RISK_TYPE_IND,
	IPFC4J_YEAR_ITEM_EFFECTIVE,
	IPFC4J_MONTH_ITEM_EFFECTIVE,
	IPFC4J_DAY_ITEM_EFFECTIVE,
	IPFC4J_LOSS_YEAR,
	IPFC4J_LOSS_MONTH,
	IPFC4J_LOSS_DAY,
	IPFC4J_LOSS_OCCURENCE,
	IPFC4J_LOSS_CLAIMANT,
	IPFC4J_USE_CODE,
	IPFC4J_SEQUENCE_USE_CODE,
	IPFC4J_AI_SEQ_USE_CODE,
	IPFC4J_YEAR_PROCESS,
	IPFC4J_MONTH_PROCESS,
	IPFC4J_DAY_PROCESS,
	IPFC4J_YEAR_CHANGE_ENTRY,
	IPFC4J_MONTH_CHANGE_ENTRY,
	IPFC4J_DAY_CHANGE_ENTRY,
	IPFC4J_SEQUENCE_CHANGE_ENTRY,
	IPFC4J_SEGMENT_STATUS,
	IPFC4J_ENTRY_OPERATOR,
	IPFC4J_USE_CODE_DATA,
	IPFC4J_SORT_NAME,
	IPFC4J_NAME_TYPE_IND,
	IPFC4J_ADDRESS_LINE_1,
	IPFC4J_ADDR_LIN_2_POS_1,
	IPFC4J_ADDR_LIN_2_POS_2_30,
	IPFC4J_ADDRESS_LINE_3,
	IPFC4J_ADDRESS_LINE_4,
	IPFC4J_ID_NUMBER,
	IPFC4J_ZIP_BASIC,
	IPFC4J_ZIP_EXPANDED,
	IPFC4J_PHONE_AREA,
	IPFC4J_PHONE_EXCHANGE,
	IPFC4J_PHONE_NUMBER,
	IPFC4J_PHONE_EXTENSION,
	IPFC4J_INTEREST_ITEM,
	IPFC4J_LOCATION_STATE,
	IPFC4J_OFFSET_ONSET_IND,
	IPFC4J_PMS_FUTURE_USE_4J_1,
	IPFC4J_CUST_SPL_USE_4J_1,
	IPFC4J_PMS_FUTURE_USE,
	IPFC4J_YR2000_CUST_USE,
	PIF_42GJ_INF_ACTION,
	INF_TIMESTAMP,
	-- *INF*: :LKP.LKP_PIF_42GP_STAGE(PIF_SYMBOL, PIF_POLICY_NUMBER, PIF_MODULE, IPFC4J_LOSS_YEAR, IPFC4J_LOSS_MONTH, IPFC4J_LOSS_DAY, IPFC4J_LOSS_OCCURENCE)
	LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.logical_flag AS LOGICAL_FLAG_OP,
	SYSDATE AS EXTRACT_DATE,
	SYSDATE AS AS_OF_DATE,
	'' AS RECORD_COUNT_OP,
	@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID
	FROM AGG_REMV_DUP_POL_RECS
	LEFT JOIN LKP_PIF_42GP_STAGE LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE
	ON LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_symbol = PIF_SYMBOL
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_policy_number = PIF_POLICY_NUMBER
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_module = PIF_MODULE
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_year_of_loss = IPFC4J_LOSS_YEAR
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_month_of_loss = IPFC4J_LOSS_MONTH
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_day_of_loss = IPFC4J_LOSS_DAY
	AND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_loss_occurence = IPFC4J_LOSS_OCCURENCE

),
PIF_42GJ_stage AS (
	TRUNCATE TABLE PIF_42GJ_stage;
	INSERT INTO PIF_42GJ_stage
	(pif_symbol, pif_policy_number, pif_module, ipfc4j_segment_id, ipfc4j_segment_level_code, ipfc4j_segment_part_code, ipfc4j_sub_part_code, ipfc4j_insurance_line, ipfc4j_location_number, ipfc4j_sub_location_number, ipfc4j_risk_unit_group, ipfc4j_class_code_group, ipfc4j_class_code_member, ipfc4j_risk_unit, ipfc4j_risk_sequence, ipfc4j_risk_type_ind, ipfc4j_year_item_effective, ipfc4j_month_item_effective, ipfc4j_day_item_effective, ipfc4j_loss_year, ipfc4j_loss_month, ipfc4j_loss_day, ipfc4j_loss_occurence, ipfc4j_loss_claimant, ipfc4j_use_code, ipfc4j_sequence_use_code, ipfc4j_ai_seq_use_code, ipfc4j_year_process, ipfc4j_month_process, ipfc4j_day_process, ipfc4j_year_change_entry, ipfc4j_month_change_entry, ipfc4j_day_change_entry, ipfc4j_sequence_change_entry, ipfc4j_segment_status, ipfc4j_entry_operator, ipfc4j_use_code_data, ipfc4j_sort_name, ipfc4j_name_type_ind, ipfc4j_address_line_1, ipfc4j_addr_lin_2_pos_1, ipfc4j_addr_lin_2_pos_2_30, ipfc4j_address_line_3, ipfc4j_address_line_4, ipfc4j_id_number, ipfc4j_zip_basic, ipfc4j_zip_expanded, ipfc4j_phone_area, ipfc4j_phone_exchange, ipfc4j_phone_number, ipfc4j_phone_extension, ipfc4j_interest_item, ipfc4j_location_state, ipfc4j_offset_onset_ind, ipfc4j_pms_future_use_4j_1, ipfc4j_cust_spl_use_4j_1, ipfc4j_pms_future_use, ipfc4j_yr2000_cust_use, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id)
	SELECT 
	PIF_SYMBOL AS PIF_SYMBOL, 
	PIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, 
	PIF_MODULE AS PIF_MODULE, 
	IPFC4J_SEGMENT_ID AS IPFC4J_SEGMENT_ID, 
	IPFC4J_SEGMENT_LEVEL_CODE AS IPFC4J_SEGMENT_LEVEL_CODE, 
	IPFC4J_SEGMENT_PART_CODE AS IPFC4J_SEGMENT_PART_CODE, 
	IPFC4J_SUB_PART_CODE AS IPFC4J_SUB_PART_CODE, 
	IPFC4J_INSURANCE_LINE AS IPFC4J_INSURANCE_LINE, 
	IPFC4J_LOCATION_NUMBER AS IPFC4J_LOCATION_NUMBER, 
	IPFC4J_SUB_LOCATION_NUMBER AS IPFC4J_SUB_LOCATION_NUMBER, 
	IPFC4J_RISK_UNIT_GROUP AS IPFC4J_RISK_UNIT_GROUP, 
	IPFC4J_CLASS_CODE_GROUP AS IPFC4J_CLASS_CODE_GROUP, 
	IPFC4J_CLASS_CODE_MEMBER AS IPFC4J_CLASS_CODE_MEMBER, 
	IPFC4J_RISK_UNIT AS IPFC4J_RISK_UNIT, 
	IPFC4J_RISK_SEQUENCE AS IPFC4J_RISK_SEQUENCE, 
	IPFC4J_RISK_TYPE_IND AS IPFC4J_RISK_TYPE_IND, 
	IPFC4J_YEAR_ITEM_EFFECTIVE AS IPFC4J_YEAR_ITEM_EFFECTIVE, 
	IPFC4J_MONTH_ITEM_EFFECTIVE AS IPFC4J_MONTH_ITEM_EFFECTIVE, 
	IPFC4J_DAY_ITEM_EFFECTIVE AS IPFC4J_DAY_ITEM_EFFECTIVE, 
	IPFC4J_LOSS_YEAR AS IPFC4J_LOSS_YEAR, 
	IPFC4J_LOSS_MONTH AS IPFC4J_LOSS_MONTH, 
	IPFC4J_LOSS_DAY AS IPFC4J_LOSS_DAY, 
	IPFC4J_LOSS_OCCURENCE AS IPFC4J_LOSS_OCCURENCE, 
	IPFC4J_LOSS_CLAIMANT AS IPFC4J_LOSS_CLAIMANT, 
	IPFC4J_USE_CODE AS IPFC4J_USE_CODE, 
	IPFC4J_SEQUENCE_USE_CODE AS IPFC4J_SEQUENCE_USE_CODE, 
	IPFC4J_AI_SEQ_USE_CODE AS IPFC4J_AI_SEQ_USE_CODE, 
	IPFC4J_YEAR_PROCESS AS IPFC4J_YEAR_PROCESS, 
	IPFC4J_MONTH_PROCESS AS IPFC4J_MONTH_PROCESS, 
	IPFC4J_DAY_PROCESS AS IPFC4J_DAY_PROCESS, 
	IPFC4J_YEAR_CHANGE_ENTRY AS IPFC4J_YEAR_CHANGE_ENTRY, 
	IPFC4J_MONTH_CHANGE_ENTRY AS IPFC4J_MONTH_CHANGE_ENTRY, 
	IPFC4J_DAY_CHANGE_ENTRY AS IPFC4J_DAY_CHANGE_ENTRY, 
	IPFC4J_SEQUENCE_CHANGE_ENTRY AS IPFC4J_SEQUENCE_CHANGE_ENTRY, 
	IPFC4J_SEGMENT_STATUS AS IPFC4J_SEGMENT_STATUS, 
	IPFC4J_ENTRY_OPERATOR AS IPFC4J_ENTRY_OPERATOR, 
	IPFC4J_USE_CODE_DATA AS IPFC4J_USE_CODE_DATA, 
	IPFC4J_SORT_NAME AS IPFC4J_SORT_NAME, 
	IPFC4J_NAME_TYPE_IND AS IPFC4J_NAME_TYPE_IND, 
	IPFC4J_ADDRESS_LINE_1 AS IPFC4J_ADDRESS_LINE_1, 
	IPFC4J_ADDR_LIN_2_POS_1 AS IPFC4J_ADDR_LIN_2_POS_1, 
	IPFC4J_ADDR_LIN_2_POS_2_30 AS IPFC4J_ADDR_LIN_2_POS_2_30, 
	IPFC4J_ADDRESS_LINE_3 AS IPFC4J_ADDRESS_LINE_3, 
	IPFC4J_ADDRESS_LINE_4 AS IPFC4J_ADDRESS_LINE_4, 
	IPFC4J_ID_NUMBER AS IPFC4J_ID_NUMBER, 
	IPFC4J_ZIP_BASIC AS IPFC4J_ZIP_BASIC, 
	IPFC4J_ZIP_EXPANDED AS IPFC4J_ZIP_EXPANDED, 
	IPFC4J_PHONE_AREA AS IPFC4J_PHONE_AREA, 
	IPFC4J_PHONE_EXCHANGE AS IPFC4J_PHONE_EXCHANGE, 
	IPFC4J_PHONE_NUMBER AS IPFC4J_PHONE_NUMBER, 
	IPFC4J_PHONE_EXTENSION AS IPFC4J_PHONE_EXTENSION, 
	IPFC4J_INTEREST_ITEM AS IPFC4J_INTEREST_ITEM, 
	IPFC4J_LOCATION_STATE AS IPFC4J_LOCATION_STATE, 
	IPFC4J_OFFSET_ONSET_IND AS IPFC4J_OFFSET_ONSET_IND, 
	IPFC4J_PMS_FUTURE_USE_4J_1 AS IPFC4J_PMS_FUTURE_USE_4J_1, 
	IPFC4J_CUST_SPL_USE_4J_1 AS IPFC4J_CUST_SPL_USE_4J_1, 
	IPFC4J_PMS_FUTURE_USE AS IPFC4J_PMS_FUTURE_USE, 
	IPFC4J_YR2000_CUST_USE AS IPFC4J_YR2000_CUST_USE, 
	PIF_42GJ_INF_ACTION AS INF_ACTION, 
	INF_TIMESTAMP AS INF_TIMESTAMP, 
	LOGICAL_FLAG_OP AS LOGICAL_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT_OP AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID
	FROM EXP_PIF_42GJ
),