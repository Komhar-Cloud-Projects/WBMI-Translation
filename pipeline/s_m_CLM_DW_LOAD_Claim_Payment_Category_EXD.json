{
    "name": "s_m_CLM_DW_LOAD_Claim_Payment_Category_EXD",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DW_LOAD_Claim_Payment_Category_EXD",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Claim_Party_Occurrence_AK_ID AS (\n\tSELECT\n\tclaim_party_occurrence_ak_id,\n\tclaimant_num\n\tFROM (\n\t\tSELECT CPO.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, \r\n\t\tLTRIM(RTRIM(CO.claim_occurrence_key)) as claimant_num, \r\n\t\tLTRIM(RTRIM(CP.claim_party_key)) as claim_party_role_code\r\n\t\tFROM \r\n\t\t@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party_occurrence CPO,\r\n\t\t@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party CP, \r\n\t\t@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence CO \r\n\t\tWHERE CO.claim_occurrence_ak_id = CPO.claim_occurrence_ak_id  AND CP.claim_party_ak_id = CPO.claim_party_ak_id \r\n\t\tAND CO.source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' \r\n\t\tAND CP.source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' \r\n\t\tAND CPO.source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' \r\n\t\tAND CPO.claim_party_role_code = 'CLMT'\r\n\t\tAND CO.crrnt_snpsht_flag = 1\r\n\t\tAND CP.crrnt_snpsht_flag = 1\r\n\t\tAND CPO.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_num ORDER BY claim_party_occurrence_ak_id) = 1\n),\nSEQ_Claim_payment_category_AK_ID1 AS (\n\tCREATE SEQUENCE SEQ_Claim_payment_category_AK_ID1\n\tSTART = 0\n\tINCREMENT = 1;\n),\nSQ_CLAIM_TRANSACTION_STAGE AS (\n\tSELECT CT.ctx_fin_type_cd, CT.ctx_draft_nbr,CT.ctx_trs_cat_cd, CT.ctx_trs_amt ,\r\n\tCASE \r\n\t WHEN ctx_trs_amt < 0  THEN -(ctx_cost_cont_sav)  ELSE ctx_cost_cont_sav END as ctx_cost_cont_sav \r\n\tFROM\r\n\t claim_transaction_stage CT\r\n\tWHERE CT.ctx_cost_cont_sav IS NOT NULL and CT.ctx_cost_cont_sav <> 0\n),\nEXP_get_vlayes_txn AS (\n\tSELECT\n\tctx_trs_cat_cd,\n\tctx_fin_type_cd,\n\tctx_trs_amt,\n\tctx_draft_nbr,\n\tctx_cost_cont_sav\n\tFROM SQ_CLAIM_TRANSACTION_STAGE\n),\nAGG_txn AS (\n\tSELECT\n\tctx_fin_type_cd, \n\tctx_draft_nbr, \n\tctx_cost_cont_sav, \n\tSUM(ctx_cost_cont_sav) AS ctx_cost_cont_sav_out\n\tFROM EXP_get_vlayes_txn\n\tGROUP BY ctx_fin_type_cd, ctx_draft_nbr\n),\nLKP_claim_payment_exd_txn AS (\n\tSELECT\n\tclaim_pay_ak_id,\n\tclaim_pay_num,\n\tIN_CTX_DRAFT_NBR\n\tFROM (\n\t\tSELECT claim_payment.claim_pay_ak_id as claim_pay_ak_id, claim_payment.claim_pay_num as claim_pay_num FROM claim_payment\r\n\t\twhere source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_num ORDER BY claim_pay_ak_id) = 1\n),\nEXP_set_defaults_txn AS (\n\tSELECT\n\tLKP_claim_payment_exd_txn.claim_pay_ak_id AS in_claim_pay_ak_id,\n\t-- *INF*: IIF(ISNULL(in_claim_pay_ak_id), -1, in_claim_pay_ak_id)\n\tIFF(in_claim_pay_ak_id IS NULL, - 1, in_claim_pay_ak_id) AS claim_pay_ak_id,\n\t'CC' AS ctx_trs_cat_cd,\n\t-1 AS CTB_BENE_SEQ_NUM,\n\tAGG_txn.ctx_fin_type_cd AS IN_CTB_FIN_TYPE_CD,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) OR LENGTH(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD)))\n\tIFF(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) AS CTB_FIN_TYPE_CD,\n\tAGG_txn.ctx_cost_cont_sav_out AS IN_CTB_COST_CONT_SAV,\n\t-- *INF*: IIF(ISNULL(IN_CTB_COST_CONT_SAV), 0, IN_CTB_COST_CONT_SAV)\n\tIFF(IN_CTB_COST_CONT_SAV IS NULL, 0, IN_CTB_COST_CONT_SAV) AS CTB_COST_CONT_SAV,\n\t0 AS AMT_default,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS CTB_BENEFIT_START,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS CTB_BENEFIT_END,\n\t'N/A' AS char_default,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_sys_id,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\t'N/A' AS claim_pay_ctgry_litigated_ind,\n\t'N/A' AS claim_pay_ctgry_lump_sum_ind,\n\t'N/A' AS cov_ctgry_code,\n\t'0' AS BenefitTypeCode,\n\t0.0 AS BenefitOffsetAmount\n\tFROM AGG_txn\n\tLEFT JOIN LKP_claim_payment_exd_txn\n\tON LKP_claim_payment_exd_txn.claim_pay_num = AGG_txn.ctx_draft_nbr\n),\nLKP_payment_category_txn AS (\n\tSELECT\n\tclaim_pay_ctgry_id,\n\tclaim_pay_ak_id,\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_seq_num,\n\tIN_claim_pay_ak_id,\n\tIN_CTB_BENEFIT_TYPE,\n\tIN_CTB_BENE_SEQ_NUM\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_ctgry_id,\n\t\t\tclaim_pay_ak_id,\n\t\t\tclaim_pay_ctgry_type,\n\t\t\tclaim_pay_ctgry_seq_num,\n\t\t\tIN_claim_pay_ak_id,\n\t\t\tIN_CTB_BENEFIT_TYPE,\n\t\t\tIN_CTB_BENE_SEQ_NUM\n\t\tFROM claim_payment_category\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,claim_pay_ctgry_type,claim_pay_ctgry_seq_num ORDER BY claim_pay_ctgry_id) = 1\n),\nRTR_claim_payment_category_txn AS (\n\tSELECT\n\tLKP_payment_category_txn.claim_pay_ctgry_id,\n\tEXP_set_defaults_txn.claim_pay_ak_id,\n\tEXP_set_defaults_txn.ctx_trs_cat_cd,\n\tEXP_set_defaults_txn.CTB_BENE_SEQ_NUM,\n\tEXP_set_defaults_txn.CTB_FIN_TYPE_CD,\n\tEXP_set_defaults_txn.CTB_COST_CONT_SAV,\n\tEXP_set_defaults_txn.AMT_default,\n\tEXP_set_defaults_txn.CTB_BENEFIT_START,\n\tEXP_set_defaults_txn.CTB_BENEFIT_END,\n\tEXP_set_defaults_txn.char_default,\n\tEXP_set_defaults_txn.crrnt_snpsht_flag,\n\tEXP_set_defaults_txn.audit_id,\n\tEXP_set_defaults_txn.eff_from_date,\n\tEXP_set_defaults_txn.eff_to_date,\n\tEXP_set_defaults_txn.source_sys_id,\n\tEXP_set_defaults_txn.created_date,\n\tEXP_set_defaults_txn.modified_date,\n\tEXP_set_defaults_txn.claim_pay_ctgry_litigated_ind,\n\tEXP_set_defaults_txn.claim_pay_ctgry_lump_sum_ind,\n\tEXP_set_defaults_txn.cov_ctgry_code,\n\tEXP_set_defaults_txn.BenefitTypeCode,\n\tEXP_set_defaults_txn.BenefitOffsetAmount\n\tFROM EXP_set_defaults_txn\n\tLEFT JOIN LKP_payment_category_txn\n\tON LKP_payment_category_txn.claim_pay_ak_id = EXP_set_defaults_txn.claim_pay_ak_id AND LKP_payment_category_txn.claim_pay_ctgry_type = EXP_set_defaults_txn.ctx_trs_cat_cd AND LKP_payment_category_txn.claim_pay_ctgry_seq_num = EXP_set_defaults_txn.CTB_BENE_SEQ_NUM\n),\nRTR_claim_payment_category_txn_Insert AS (SELECT * FROM RTR_claim_payment_category_txn WHERE ISNULL(claim_pay_ctgry_id)),\nRTR_claim_payment_category_txn_Update AS (SELECT * FROM RTR_claim_payment_category_txn WHERE NOT ISNULL(claim_pay_ctgry_id)),\nUPD_claim_payment_category_txn_insert AS (\n\tSELECT\n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id1, \n\tclaim_pay_ak_id AS claim_pay_ak_id1, \n\tctx_trs_cat_cd AS ctx_trs_cat_cd1, \n\tCTB_BENE_SEQ_NUM AS CTB_BENE_SEQ_NUM1, \n\tCTB_FIN_TYPE_CD AS CTB_FIN_TYPE_CD1, \n\tCTB_COST_CONT_SAV AS CTB_COST_CONT_SAV1, \n\tAMT_default AS AMT_default1, \n\tCTB_BENEFIT_START AS CTB_BENEFIT_START1, \n\tCTB_BENEFIT_END AS CTB_BENEFIT_END1, \n\tchar_default AS char_default1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tsource_sys_id AS source_sys_id1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tclaim_pay_ctgry_litigated_ind AS claim_pay_ctgry_litigated_ind1, \n\tclaim_pay_ctgry_lump_sum_ind AS claim_pay_ctgry_lump_sum_ind1, \n\tcov_ctgry_code, \n\tBenefitTypeCode AS BenefitTypeCode1, \n\tBenefitOffsetAmount AS BenefitOffsetAmount1\n\tFROM RTR_claim_payment_category_txn_Insert\n),\nclaim_payment_category_txn_insert AS (\n\tINSERT INTO claim_payment_category\n\t(claim_pay_ctgry_ak_id, claim_pay_ak_id, claim_pay_ctgry_type, claim_pay_ctgry_seq_num, claim_pay_ctgry_amt, claim_pay_ctgry_earned_amt, claim_pay_ctgry_billed_amt, claim_pay_ctgry_start_date, claim_pay_ctgry_end_date, financial_type_code, invc_num, cost_containment_saving_amt, cost_containment_red_amt, cost_containment_ppo_amt, attorney_fee_amt, attorney_cost_amt, attorney_file_num, hourly_rate, hours_worked, num_of_days, num_of_weeks, tpd_rate, tpd_rate_fac, tpd_wage_loss, tpd_wkly_wage, claim_pay_ctgry_comment, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date, claim_pay_ctgry_litigated_ind, claim_pay_ctgry_lump_sum_ind, cov_ctgry_code, BenefitOffsetCode, BenefitOffsetAmount)\n\tSELECT \n\tSEQ_Claim_payment_category_AK_ID1.NEXTVAL AS CLAIM_PAY_CTGRY_AK_ID, \n\tclaim_pay_ak_id1 AS CLAIM_PAY_AK_ID, \n\tctx_trs_cat_cd1 AS CLAIM_PAY_CTGRY_TYPE, \n\tCTB_BENE_SEQ_NUM1 AS CLAIM_PAY_CTGRY_SEQ_NUM, \n\tAMT_default1 AS CLAIM_PAY_CTGRY_AMT, \n\tAMT_default1 AS CLAIM_PAY_CTGRY_EARNED_AMT, \n\tAMT_default1 AS CLAIM_PAY_CTGRY_BILLED_AMT, \n\tCTB_BENEFIT_START1 AS CLAIM_PAY_CTGRY_START_DATE, \n\tCTB_BENEFIT_END1 AS CLAIM_PAY_CTGRY_END_DATE, \n\tCTB_FIN_TYPE_CD1 AS FINANCIAL_TYPE_CODE, \n\tchar_default1 AS INVC_NUM, \n\tCTB_COST_CONT_SAV1 AS COST_CONTAINMENT_SAVING_AMT, \n\tAMT_default1 AS COST_CONTAINMENT_RED_AMT, \n\tAMT_default1 AS COST_CONTAINMENT_PPO_AMT, \n\tAMT_default1 AS ATTORNEY_FEE_AMT, \n\tAMT_default1 AS ATTORNEY_COST_AMT, \n\tchar_default1 AS ATTORNEY_FILE_NUM, \n\tAMT_default1 AS HOURLY_RATE, \n\tAMT_default1 AS HOURS_WORKED, \n\tCTB_BENE_SEQ_NUM1 AS NUM_OF_DAYS, \n\tCTB_BENE_SEQ_NUM1 AS NUM_OF_WEEKS, \n\tAMT_default1 AS TPD_RATE, \n\tAMT_default1 AS TPD_RATE_FAC, \n\tAMT_default1 AS TPD_WAGE_LOSS, \n\tAMT_default1 AS TPD_WKLY_WAGE, \n\tchar_default1 AS CLAIM_PAY_CTGRY_COMMENT, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tsource_sys_id1 AS SOURCE_SYS_ID, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tclaim_pay_ctgry_litigated_ind1 AS CLAIM_PAY_CTGRY_LITIGATED_IND, \n\tclaim_pay_ctgry_lump_sum_ind1 AS CLAIM_PAY_CTGRY_LUMP_SUM_IND, \n\tCOV_CTGRY_CODE, \n\tBenefitTypeCode1 AS BENEFITOFFSETCODE, \n\tBenefitOffsetAmount1 AS BENEFITOFFSETAMOUNT\n\tFROM UPD_claim_payment_category_txn_insert\n),\nUPD_claim_payment_category_txn_update AS (\n\tSELECT\n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id3, \n\tclaim_pay_ak_id AS claim_pay_ak_id3, \n\tctx_trs_cat_cd AS ctx_trs_cat_cd3, \n\tCTB_BENE_SEQ_NUM AS CTB_BENE_SEQ_NUM3, \n\tCTB_FIN_TYPE_CD AS CTB_FIN_TYPE_CD3, \n\tCTB_COST_CONT_SAV AS CTB_COST_CONT_SAV3, \n\tAMT_default AS AMT_default3, \n\tCTB_BENEFIT_START AS CTB_BENEFIT_START3, \n\tCTB_BENEFIT_END AS CTB_BENEFIT_END3, \n\tchar_default AS char_default3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_date AS eff_from_date3, \n\teff_to_date AS eff_to_date3, \n\tsource_sys_id AS source_sys_id3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3, \n\tclaim_pay_ctgry_litigated_ind AS claim_pay_ctgry_litigated_ind3, \n\tclaim_pay_ctgry_lump_sum_ind AS claim_pay_ctgry_lump_sum_ind3, \n\tcov_ctgry_code\n\tFROM RTR_claim_payment_category_txn_Update\n),\nclaim_payment_category_txn_update AS (\n\tMERGE INTO claim_payment_category AS T\n\tUSING UPD_claim_payment_category_txn_update AS S\n\tON T.claim_pay_ctgry_id = S.claim_pay_ctgry_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.cost_containment_saving_amt = S.CTB_COST_CONT_SAV3, T.modified_date = S.modified_date3\n),\nSQ_CLM_TRANS_BENEFIT_STAGE AS (\n\tSELECT \r\n\tCTB.CTB_CLAIM_NBR, \r\n\tCTB.CTB_DRAFT_NBR, \r\n\tCTB.CTB_BENEFIT_TYPE,\r\n\t CTB.CTB_BENE_SEQ_NUM,  \r\n\tCTB.CTB_FIN_TYPE_CD, \r\n\tCTB.CTB_CREATE_TS as CTB_CREATE_TS ,\r\n\tCTB.CTB_BENEFIT_START, CTB.CTB_BENEFIT_END, CTB.CTB_BENEFIT_AMT, CTB.CTB_NUM_WEEKS, \r\n\tCTB.CTB_NUM_DAYS, CTB.CTB_HOURS_WORKED, CTB.CTB_HOURLY_RATE, CTB.CTB_TPD_WKLY_WAGE, \r\n\tCTB.CTB_TPD_WAGE_LOSS, CTB.CTB_TPD_RATE_FCTR, CTB.CTB_TPD_RATE, CTB.CTB_INVOICE_NBR, \r\n\tCTB.CTB_COST_CONT_SAV, CTB.CTB_BILLED_AMT, CTB.CTB_COST_CONT_PPO, CTB.CTB_COST_CONT_RED, \r\n\tCTB.CTB_ATY_FILE_NUM, CTB.CTB_ATY_FEE_AMT, CTB.CTB_ATY_COSTS_AMT, CTB.CTB_AMT_EARNED, \r\n\tCTB.CTB_BENE_MIS_CMT ,\r\n\tCTB.CTB_BENE_LITIGATED,\r\n\tCTB.CTB_LUMP_SUM_IND,\r\n\tCTB.CTB_BENEFIT_OFFSET_CD, \r\n\tCTB.CTB_BENEFIT_OFFSET_AMT \r\n\tFROM\r\n\t CLM_TRANS_BENEFIT_STAGE CTB\n),\nEXP_get_values_benefit AS (\n\tSELECT\n\tCTB_CLAIM_NBR,\n\tCTB_DRAFT_NBR AS IN_CTB_DRAFT_NBR,\n\t-- *INF*: IIF(ISNULL(IN_CTB_DRAFT_NBR) OR IS_SPACES(LTRIM(RTRIM(IN_CTB_DRAFT_NBR))) OR LENGTH(LTRIM(RTRIM(IN_CTB_DRAFT_NBR))) = 0, 'N/A', IN_CTB_DRAFT_NBR)\n\tIFF(IN_CTB_DRAFT_NBR IS NULL OR IS_SPACES(LTRIM(RTRIM(IN_CTB_DRAFT_NBR))) OR LENGTH(LTRIM(RTRIM(IN_CTB_DRAFT_NBR))) = 0, 'N/A', IN_CTB_DRAFT_NBR) AS CTB_DRAFT_NBR,\n\tCTB_BENEFIT_TYPE,\n\tCTB_BENE_SEQ_NUM,\n\tCTB_BENEFIT_AMT,\n\tCTB_AMT_EARNED,\n\tCTB_BILLED_AMT,\n\tCTB_BENEFIT_START,\n\tCTB_BENEFIT_END,\n\tCTB_FIN_TYPE_CD,\n\tCTB_INVOICE_NBR,\n\tCTB_COST_CONT_SAV,\n\tCTB_COST_CONT_RED,\n\tCTB_COST_CONT_PPO,\n\tCTB_ATY_FEE_AMT,\n\tCTB_ATY_COSTS_AMT,\n\tCTB_ATY_FILE_NUM,\n\tCTB_HOURLY_RATE,\n\tCTB_HOURS_WORKED,\n\tCTB_NUM_DAYS,\n\tCTB_NUM_WEEKS,\n\tCTB_TPD_RATE,\n\tCTB_TPD_RATE_FCTR,\n\tCTB_TPD_WAGE_LOSS,\n\tCTB_TPD_WKLY_WAGE,\n\tCTB_BENE_MIS_CMT,\n\tctb_bene_litigated AS IN_ctb_bene_litigated,\n\t-- *INF*: IIF(ISNULL(IN_ctb_bene_litigated) OR IS_SPACES(LTRIM(RTRIM(IN_ctb_bene_litigated))) OR LENGTH(LTRIM(RTRIM(IN_ctb_bene_litigated))) = 0, 'N/A', IN_ctb_bene_litigated)\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(IN_ctb_bene_litigated IS NULL OR IS_SPACES(LTRIM(RTRIM(IN_ctb_bene_litigated))) OR LENGTH(LTRIM(RTRIM(IN_ctb_bene_litigated))) = 0, 'N/A', IN_ctb_bene_litigated) AS CLAIM_PAY_CTGRY_LITIGATED_IND,\n\tCTB_CREATE_TS AS IN_CTB_CREATE_TS,\n\t-- *INF*: IIF(ISNULL(IN_CTB_CREATE_TS),TO_DATE('1/1/1800','MM/DD/YYYY'),IN_CTB_CREATE_TS)\n\tIFF(IN_CTB_CREATE_TS IS NULL, TO_DATE('1/1/1800', 'MM/DD/YYYY'), IN_CTB_CREATE_TS) AS CTB_CREATE_TS,\n\tctb_lump_sum_ind AS IN_ctb_lump_sum_ind,\n\t-- *INF*: IIF(ISNULL(IN_ctb_lump_sum_ind) OR IS_SPACES(LTRIM(RTRIM(IN_ctb_lump_sum_ind))) OR LENGTH(LTRIM(RTRIM(IN_ctb_lump_sum_ind))) = 0, 'N/A', IN_ctb_lump_sum_ind)\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(IN_ctb_lump_sum_ind IS NULL OR IS_SPACES(LTRIM(RTRIM(IN_ctb_lump_sum_ind))) OR LENGTH(LTRIM(RTRIM(IN_ctb_lump_sum_ind))) = 0, 'N/A', IN_ctb_lump_sum_ind) AS ctb_lump_sum_ind,\n\tctb_benefit_offset_cd,\n\t-- *INF*: IIF(ISNULL(ctb_benefit_offset_cd),'0', ctb_benefit_offset_cd )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --ISNULL(ctb_benefit_offset_cd),'N/A',\r\n\t-- --ctb_benefit_offset_cd = '0','UNKNOWN',\r\n\t-- --ctb_benefit_offset_cd = '1','NONE',\r\n\t-- --ctb_benefit_offset_cd = '2','SSDI',\r\n\t-- --ctb_benefit_offset_cd = '3','OTHER',\r\n\t-- --'N/A\n\tIFF(ctb_benefit_offset_cd IS NULL, '0', ctb_benefit_offset_cd) AS o_ctb_benefit_offset_cd,\n\tctb_benefit_offset_amt,\n\t-- *INF*: IIF(ISNULL(ctb_benefit_offset_amt), 0.00, ctb_benefit_offset_amt)\n\tIFF(ctb_benefit_offset_amt IS NULL, 0.00, ctb_benefit_offset_amt) AS o_ctb_benefit_offset_amt\n\tFROM SQ_CLM_TRANS_BENEFIT_STAGE\n),\nLKP_CLAIM_OCCURRENCE AS (\n\tSELECT\n\tclaim_occurrence_key\n\tFROM (\n\t\tSELECT \r\n\t\t      claim_occurrence.claim_occurrence_key as claim_occurrence_key \r\n\t\tFROM \r\n\t\t   claim_occurrence\r\n\t\tWHERE\r\n\t\t   source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' AND crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_key ORDER BY claim_occurrence_key DESC) = 1\n),\nLKP_COV_CTGRY_CODE AS (\n\tSELECT\n\tcategory_code,\n\tclaim_nbr\n\tFROM (\n\t\tselect distinct a.cvr_claim_nbr as  claim_nbr ,\r\n\t\t g.cov_category_code                as  category_code\r\n\t\tfrom  claim_coverage_stage a  ,  --- new used\r\n\t\t          clm_trans_benefit_stage c,  --- not used\r\n\t\t          cause_of_loss_stage d,      ---- MOD  - New column\r\n\t\t           sup_benefit_type_stage e, --- NOT new used\r\n\t\t           pc_benefit_filter_stage f,--- new used\r\n\t\t           pc_bnft_fltr_typs_stage g  --- new used\r\n\t\tWHERE a.cvr_claim_nbr =c.ctb_claim_nbr   ----------------------\r\n\t\t AND a.cvr_line_of_bus_cd = d.line_of_business  \r\n\t\tAND   c.ctb_cov_type_cd = d.major_peril  \r\n\t\tAND   substring(c.ctb_bur_cause_loss,1,2) = d.cause_of_loss\r\n\t\tAND   c.ctb_benefit_type = e.code\r\n\t\tAND   e.code = f.benefit_code  \r\n\t\tAND   f.filter_type = g.filter_type \r\n\t\tAND   c.ctb_fin_type_cd = g.fin_type_cd\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_nbr ORDER BY category_code DESC) = 1\n),\nLKP_claim_payment_exd_benefit AS (\n\tSELECT\n\tclaim_pay_ak_id,\n\tclaim_pay_num,\n\tIN_CTX_DRAFT_NBR\n\tFROM (\n\t\tSELECT claim_payment.claim_pay_ak_id as claim_pay_ak_id, claim_payment.claim_pay_num as claim_pay_num FROM claim_payment\r\n\t\twhere source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_num ORDER BY claim_pay_ak_id) = 1\n),\nEXP_set_defaults_benefit AS (\n\tSELECT\n\tLKP_claim_payment_exd_benefit.claim_pay_ak_id AS in_claim_pay_ak_id,\n\t-- *INF*: IIF(ISNULL(in_claim_pay_ak_id), -1, in_claim_pay_ak_id)\n\tIFF(in_claim_pay_ak_id IS NULL, - 1, in_claim_pay_ak_id) AS claim_pay_ak_id,\n\tEXP_get_values_benefit.CTB_BENEFIT_TYPE AS IN_CTB_BENEFIT_TYPE,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BENEFIT_TYPE) OR IS_SPACES(LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE))) OR LENGTH(LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE)))\n\tIFF(IN_CTB_BENEFIT_TYPE IS NULL OR IS_SPACES(LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE))) OR LENGTH(LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_BENEFIT_TYPE))) AS CTB_BENEFIT_TYPE,\n\tEXP_get_values_benefit.CTB_BENE_SEQ_NUM AS IN_CTB_BENE_SEQ_NUM,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BENE_SEQ_NUM), -1, IN_CTB_BENE_SEQ_NUM)\n\tIFF(IN_CTB_BENE_SEQ_NUM IS NULL, - 1, IN_CTB_BENE_SEQ_NUM) AS CTB_BENE_SEQ_NUM,\n\tEXP_get_values_benefit.CTB_BENEFIT_AMT AS IN_CTB_BENEFIT_AMT,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BENEFIT_AMT), 0, IN_CTB_BENEFIT_AMT)\n\tIFF(IN_CTB_BENEFIT_AMT IS NULL, 0, IN_CTB_BENEFIT_AMT) AS CTB_BENEFIT_AMT,\n\tEXP_get_values_benefit.CTB_AMT_EARNED AS IN_CTB_AMT_EARNED,\n\t-- *INF*: IIF(ISNULL(IN_CTB_AMT_EARNED), 0, IN_CTB_AMT_EARNED)\n\tIFF(IN_CTB_AMT_EARNED IS NULL, 0, IN_CTB_AMT_EARNED) AS CTB_AMT_EARNED,\n\tEXP_get_values_benefit.CTB_BILLED_AMT AS IN_CTB_BILLED_AMT,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BILLED_AMT), 0, IN_CTB_BILLED_AMT)\n\tIFF(IN_CTB_BILLED_AMT IS NULL, 0, IN_CTB_BILLED_AMT) AS CTB_BILLED_AMT,\n\tEXP_get_values_benefit.CTB_BENEFIT_START AS IN_CTB_BENEFIT_START,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BENEFIT_START), TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'), IN_CTB_BENEFIT_START)\r\n\t-- \r\n\t-- --OR NOT IS_DATE(IN_CTB_BENEFIT_START)\n\tIFF(IN_CTB_BENEFIT_START IS NULL, TO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'), IN_CTB_BENEFIT_START) AS CTB_BENEFIT_START,\n\tEXP_get_values_benefit.CTB_BENEFIT_END AS IN_CTB_BENEFIT_END,\n\t-- *INF*: IIF(ISNULL(IN_CTB_BENEFIT_END), TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS'), IN_CTB_BENEFIT_END)\n\tIFF(IN_CTB_BENEFIT_END IS NULL, TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'), IN_CTB_BENEFIT_END) AS CTB_BENEFIT_END,\n\tEXP_get_values_benefit.CTB_FIN_TYPE_CD AS IN_CTB_FIN_TYPE_CD,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) OR LENGTH(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD)))\n\tIFF(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_FIN_TYPE_CD))) AS CTB_FIN_TYPE_CD,\n\tEXP_get_values_benefit.CTB_INVOICE_NBR AS IN_CTB_INVOICE_NBR,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CTB_INVOICE_NBR))) OR LENGTH(LTRIM(RTRIM(IN_CTB_INVOICE_NBR))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_INVOICE_NBR)))\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(LTRIM(RTRIM(IN_CTB_INVOICE_NBR)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CTB_INVOICE_NBR))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_INVOICE_NBR))) AS CTB_INVOICE_NBR,\n\tEXP_get_values_benefit.CTB_COST_CONT_SAV AS IN_CTB_COST_CONT_SAV,\n\t-- *INF*: IIF(ISNULL(IN_CTB_COST_CONT_SAV), 0, IN_CTB_COST_CONT_SAV)\n\tIFF(IN_CTB_COST_CONT_SAV IS NULL, 0, IN_CTB_COST_CONT_SAV) AS CTB_COST_CONT_SAV,\n\tEXP_get_values_benefit.CTB_COST_CONT_RED AS IN_CTB_COST_CONT_RED,\n\t-- *INF*: IIF(ISNULL(IN_CTB_COST_CONT_RED), 0, IN_CTB_COST_CONT_RED)\n\tIFF(IN_CTB_COST_CONT_RED IS NULL, 0, IN_CTB_COST_CONT_RED) AS CTB_COST_CONT_RED,\n\tEXP_get_values_benefit.CTB_COST_CONT_PPO AS IN_CTB_COST_CONT_PPO,\n\t-- *INF*: IIF(ISNULL(IN_CTB_COST_CONT_PPO), 0, IN_CTB_COST_CONT_PPO)\n\tIFF(IN_CTB_COST_CONT_PPO IS NULL, 0, IN_CTB_COST_CONT_PPO) AS CTB_COST_CONT_PPO,\n\tEXP_get_values_benefit.CTB_ATY_FEE_AMT AS IN_CTB_ATY_FEE_AMT,\n\t-- *INF*: IIF(ISNULL(IN_CTB_ATY_FEE_AMT), 0, IN_CTB_ATY_FEE_AMT)\n\tIFF(IN_CTB_ATY_FEE_AMT IS NULL, 0, IN_CTB_ATY_FEE_AMT) AS CTB_ATY_FEE_AMT,\n\tEXP_get_values_benefit.CTB_ATY_COSTS_AMT AS IN_CTB_ATY_COSTS_AMT,\n\t-- *INF*: IIF(ISNULL(IN_CTB_ATY_COSTS_AMT), 0, IN_CTB_ATY_COSTS_AMT)\n\tIFF(IN_CTB_ATY_COSTS_AMT IS NULL, 0, IN_CTB_ATY_COSTS_AMT) AS CTB_ATY_COSTS_AMT,\n\tEXP_get_values_benefit.CTB_ATY_FILE_NUM AS IN_CTB_ATY_FILE_NUM,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM))) OR LENGTH(LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM)))\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM))) = 0, 'N/A', LTRIM(RTRIM(IN_CTB_ATY_FILE_NUM))) AS CTB_ATY_FILE_NUM,\n\tEXP_get_values_benefit.CTB_HOURLY_RATE AS IN_CTB_HOURLY_RATE,\n\t-- *INF*: IIF(ISNULL(IN_CTB_HOURLY_RATE), 0, IN_CTB_HOURLY_RATE)\n\tIFF(IN_CTB_HOURLY_RATE IS NULL, 0, IN_CTB_HOURLY_RATE) AS CTB_HOURLY_RATE,\n\tEXP_get_values_benefit.CTB_HOURS_WORKED AS IN_CTB_HOURS_WORKED,\n\t-- *INF*: IIF(ISNULL(IN_CTB_HOURS_WORKED), 0, IN_CTB_HOURS_WORKED)\n\tIFF(IN_CTB_HOURS_WORKED IS NULL, 0, IN_CTB_HOURS_WORKED) AS CTB_HOURS_WORKED,\n\tEXP_get_values_benefit.CTB_NUM_DAYS AS IN_CTB_NUM_DAYS,\n\t-- *INF*: IIF(ISNULL(IN_CTB_NUM_DAYS), -1, IN_CTB_NUM_DAYS)\n\tIFF(IN_CTB_NUM_DAYS IS NULL, - 1, IN_CTB_NUM_DAYS) AS CTB_NUM_DAYS,\n\tEXP_get_values_benefit.CTB_NUM_WEEKS AS IN_CTB_NUM_WEEKS,\n\t-- *INF*: IIF(ISNULL(IN_CTB_NUM_WEEKS), -1, IN_CTB_NUM_WEEKS)\n\tIFF(IN_CTB_NUM_WEEKS IS NULL, - 1, IN_CTB_NUM_WEEKS) AS CTB_NUM_WEEKS,\n\tEXP_get_values_benefit.CTB_TPD_RATE AS IN_CTB_TPD_RATE,\n\t-- *INF*: IIF(ISNULL(IN_CTB_TPD_RATE), 0, IN_CTB_TPD_RATE)\n\tIFF(IN_CTB_TPD_RATE IS NULL, 0, IN_CTB_TPD_RATE) AS CTB_TPD_RATE,\n\tEXP_get_values_benefit.CTB_TPD_RATE_FCTR AS IN_CTB_TPD_RATE_FCTR,\n\t-- *INF*: IIF(ISNULL(IN_CTB_TPD_RATE_FCTR), 0, IN_CTB_TPD_RATE_FCTR)\n\tIFF(IN_CTB_TPD_RATE_FCTR IS NULL, 0, IN_CTB_TPD_RATE_FCTR) AS CTB_TPD_RATE_FCTR,\n\tEXP_get_values_benefit.CTB_TPD_WAGE_LOSS AS IN_CTB_TPD_WAGE_LOSS,\n\t-- *INF*: IIF(ISNULL(IN_CTB_TPD_WAGE_LOSS), 0, IN_CTB_TPD_WAGE_LOSS)\n\tIFF(IN_CTB_TPD_WAGE_LOSS IS NULL, 0, IN_CTB_TPD_WAGE_LOSS) AS CTB_TPD_WAGE_LOSS,\n\tEXP_get_values_benefit.CTB_TPD_WKLY_WAGE AS IN_CTB_TPD_WKLY_WAGE,\n\t-- *INF*: IIF(ISNULL(IN_CTB_TPD_WKLY_WAGE), 0, IN_CTB_TPD_WKLY_WAGE)\n\tIFF(IN_CTB_TPD_WKLY_WAGE IS NULL, 0, IN_CTB_TPD_WKLY_WAGE) AS CTB_TPD_WKLY_WAGE,\n\tEXP_get_values_benefit.CTB_BENE_MIS_CMT AS IN_CTB_BENE_MIS_CMT,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CTB_BENE_MIS_CMT))) OR LENGTH(LTRIM(RTRIM(IN_CTB_BENE_MIS_CMT))) = 0, 'N/A', LTRIM(RTRIM  ( SUBSTR(IN_CTB_BENE_MIS_CMT,1,250))))\r\n\t-- \r\n\t-- \n\tIFF(LTRIM(RTRIM(IN_CTB_BENE_MIS_CMT)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CTB_BENE_MIS_CMT))) = 0, 'N/A', LTRIM(RTRIM(SUBSTR(IN_CTB_BENE_MIS_CMT, 1, 250)))) AS CTB_BENE_MIS_CMT,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_sys_id,\n\tSYSDATE AS modified_date,\n\tEXP_get_values_benefit.CLAIM_PAY_CTGRY_LITIGATED_IND AS IN_CLAIM_PAY_CTGRY_LITIGATED_IND,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND))) OR LENGTH(LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND))) = 0, 'N/A', LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND)))\n\tIFF(LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND)) IS NULL OR LENGTH(LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND))) = 0, 'N/A', LTRIM(RTRIM(IN_CLAIM_PAY_CTGRY_LITIGATED_IND))) AS CLAIM_PAY_CTGRY_LITIGATED_IND,\n\tEXP_get_values_benefit.CTB_CREATE_TS AS IN_CTB_CREATE_TS,\n\tIN_CTB_CREATE_TS AS created_date,\n\tEXP_get_values_benefit.ctb_lump_sum_ind,\n\tLKP_COV_CTGRY_CODE.category_code AS cov_ctgry_code,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(cov_ctgry_code))) OR LENGTH(LTRIM(RTRIM(cov_ctgry_code))) = 0, 'N/A',cov_ctgry_code  )\n\tIFF(LTRIM(RTRIM(cov_ctgry_code)) IS NULL OR LENGTH(LTRIM(RTRIM(cov_ctgry_code))) = 0, 'N/A', cov_ctgry_code) AS o_cov_ctgry_code,\n\tEXP_get_values_benefit.o_ctb_benefit_offset_cd AS ctb_benefit_offset_cd,\n\tctb_benefit_offset_cd AS BenefitOffsetCode,\n\tEXP_get_values_benefit.o_ctb_benefit_offset_amt AS ctb_benefit_offset_amt,\n\tctb_benefit_offset_amt AS BenefitOffsetAmount\n\tFROM EXP_get_values_benefit\n\tLEFT JOIN LKP_COV_CTGRY_CODE\n\tON LKP_COV_CTGRY_CODE.claim_nbr = LKP_CLAIM_OCCURRENCE.claim_occurrence_key\n\tLEFT JOIN LKP_claim_payment_exd_benefit\n\tON LKP_claim_payment_exd_benefit.claim_pay_num = EXP_get_values_benefit.CTB_DRAFT_NBR\n),\nLKP_payment_category_benefit AS (\n\tSELECT\n\tclaim_pay_ctgry_id,\n\tclaim_pay_ak_id,\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_seq_num,\n\tIN_claim_pay_ak_id,\n\tIN_CTB_BENEFIT_TYPE,\n\tIN_CTB_BENE_SEQ_NUM\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_ctgry_id,\n\t\t\tclaim_pay_ak_id,\n\t\t\tclaim_pay_ctgry_type,\n\t\t\tclaim_pay_ctgry_seq_num,\n\t\t\tIN_claim_pay_ak_id,\n\t\t\tIN_CTB_BENEFIT_TYPE,\n\t\t\tIN_CTB_BENE_SEQ_NUM\n\t\tFROM claim_payment_category\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,claim_pay_ctgry_type,claim_pay_ctgry_seq_num ORDER BY claim_pay_ctgry_id) = 1\n),\nRTR_claim_payment_category_benefit AS (\n\tSELECT\n\tLKP_payment_category_benefit.claim_pay_ctgry_id,\n\tEXP_set_defaults_benefit.claim_pay_ak_id,\n\tEXP_set_defaults_benefit.CTB_BENEFIT_TYPE,\n\tEXP_set_defaults_benefit.CTB_BENE_SEQ_NUM,\n\tEXP_set_defaults_benefit.CTB_BENEFIT_AMT,\n\tEXP_set_defaults_benefit.CTB_AMT_EARNED,\n\tEXP_set_defaults_benefit.CTB_BILLED_AMT,\n\tEXP_set_defaults_benefit.CTB_BENEFIT_START,\n\tEXP_set_defaults_benefit.CTB_BENEFIT_END,\n\tEXP_set_defaults_benefit.CTB_FIN_TYPE_CD,\n\tEXP_set_defaults_benefit.CTB_INVOICE_NBR,\n\tEXP_set_defaults_benefit.CTB_COST_CONT_SAV,\n\tEXP_set_defaults_benefit.CTB_COST_CONT_RED,\n\tEXP_set_defaults_benefit.CTB_COST_CONT_PPO,\n\tEXP_set_defaults_benefit.CTB_ATY_FEE_AMT,\n\tEXP_set_defaults_benefit.CTB_ATY_COSTS_AMT,\n\tEXP_set_defaults_benefit.CTB_ATY_FILE_NUM,\n\tEXP_set_defaults_benefit.CTB_HOURLY_RATE,\n\tEXP_set_defaults_benefit.CTB_HOURS_WORKED,\n\tEXP_set_defaults_benefit.CTB_NUM_DAYS,\n\tEXP_set_defaults_benefit.CTB_NUM_WEEKS,\n\tEXP_set_defaults_benefit.CTB_TPD_RATE,\n\tEXP_set_defaults_benefit.CTB_TPD_RATE_FCTR,\n\tEXP_set_defaults_benefit.CTB_TPD_WAGE_LOSS,\n\tEXP_set_defaults_benefit.CTB_TPD_WKLY_WAGE,\n\tEXP_set_defaults_benefit.CTB_BENE_MIS_CMT,\n\tEXP_set_defaults_benefit.crrnt_snpsht_flag,\n\tEXP_set_defaults_benefit.audit_id,\n\tEXP_set_defaults_benefit.eff_from_date,\n\tEXP_set_defaults_benefit.eff_to_date,\n\tEXP_set_defaults_benefit.source_sys_id,\n\tEXP_set_defaults_benefit.created_date,\n\tEXP_set_defaults_benefit.modified_date,\n\tEXP_set_defaults_benefit.CLAIM_PAY_CTGRY_LITIGATED_IND,\n\tEXP_set_defaults_benefit.ctb_lump_sum_ind,\n\tEXP_set_defaults_benefit.o_cov_ctgry_code AS cov_ctgry_code,\n\tEXP_set_defaults_benefit.BenefitOffsetCode,\n\tEXP_set_defaults_benefit.BenefitOffsetAmount\n\tFROM EXP_set_defaults_benefit\n\tLEFT JOIN LKP_payment_category_benefit\n\tON LKP_payment_category_benefit.claim_pay_ak_id = EXP_set_defaults_benefit.claim_pay_ak_id AND LKP_payment_category_benefit.claim_pay_ctgry_type = EXP_set_defaults_benefit.CTB_BENEFIT_TYPE AND LKP_payment_category_benefit.claim_pay_ctgry_seq_num = EXP_set_defaults_benefit.CTB_BENE_SEQ_NUM\n),\nRTR_claim_payment_category_benefit_INSERT AS (SELECT * FROM RTR_claim_payment_category_benefit WHERE ISNULL(claim_pay_ctgry_id)),\nRTR_claim_payment_category_benefit_UPDATE AS (SELECT * FROM RTR_claim_payment_category_benefit WHERE NOT ISNULL(claim_pay_ctgry_id)),\nUPD_claim_payment_category_benefit_update AS (\n\tSELECT\n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id3, \n\tclaim_pay_ak_id AS claim_pay_ak_id3, \n\tCTB_BENEFIT_TYPE AS CTB_BENEFIT_TYPE3, \n\tCTB_BENE_SEQ_NUM AS CTB_BENE_SEQ_NUM3, \n\tCTB_BENEFIT_AMT AS CTB_BENEFIT_AMT3, \n\tCTB_AMT_EARNED AS CTB_AMT_EARNED3, \n\tCTB_BILLED_AMT AS CTB_BILLED_AMT3, \n\tCTB_BENEFIT_START AS CTB_BENEFIT_START3, \n\tCTB_BENEFIT_END AS CTB_BENEFIT_END3, \n\tCTB_FIN_TYPE_CD AS CTB_FIN_TYPE_CD3, \n\tCTB_INVOICE_NBR AS CTB_INVOICE_NBR3, \n\tCTB_COST_CONT_SAV AS CTB_COST_CONT_SAV3, \n\tCTB_COST_CONT_RED AS CTB_COST_CONT_RED3, \n\tCTB_COST_CONT_PPO AS CTB_COST_CONT_PPO3, \n\tCTB_ATY_FEE_AMT AS CTB_ATY_FEE_AMT3, \n\tCTB_ATY_COSTS_AMT AS CTB_ATY_COSTS_AMT3, \n\tCTB_ATY_FILE_NUM AS CTB_ATY_FILE_NUM3, \n\tCTB_HOURLY_RATE AS CTB_HOURLY_RATE3, \n\tCTB_HOURS_WORKED AS CTB_HOURS_WORKED3, \n\tCTB_NUM_DAYS AS CTB_NUM_DAYS3, \n\tCTB_NUM_WEEKS AS CTB_NUM_WEEKS3, \n\tCTB_TPD_RATE AS CTB_TPD_RATE3, \n\tCTB_TPD_RATE_FCTR AS CTB_TPD_RATE_FCTR3, \n\tCTB_TPD_WAGE_LOSS AS CTB_TPD_WAGE_LOSS3, \n\tCTB_TPD_WKLY_WAGE AS CTB_TPD_WKLY_WAGE3, \n\tCTB_BENE_MIS_CMT AS CTB_BENE_MIS_CMT3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_date AS eff_from_date3, \n\teff_to_date AS eff_to_date3, \n\tsource_sys_id AS source_sys_id3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3, \n\tCLAIM_PAY_CTGRY_LITIGATED_IND AS CLAIM_PAY_CTGRY_LITIGATED_IND3, \n\tctb_lump_sum_ind AS ctb_lump_sum_ind3, \n\tcov_ctgry_code AS COV_CTGRY_CODE3, \n\tBenefitOffsetCode AS BenefitOffsetCode3, \n\tBenefitOffsetAmount AS BenefitOffsetAmount3\n\tFROM RTR_claim_payment_category_benefit_UPDATE\n),\nclaim_payment_category_benefit_update AS (\n\tMERGE INTO claim_payment_category AS T\n\tUSING UPD_claim_payment_category_benefit_update AS S\n\tON T.claim_pay_ctgry_id = S.claim_pay_ctgry_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.claim_pay_ctgry_amt = S.CTB_BENEFIT_AMT3, T.claim_pay_ctgry_earned_amt = S.CTB_AMT_EARNED3, T.claim_pay_ctgry_billed_amt = S.CTB_BILLED_AMT3, T.claim_pay_ctgry_start_date = S.CTB_BENEFIT_START3, T.claim_pay_ctgry_end_date = S.CTB_BENEFIT_END3, T.financial_type_code = S.CTB_FIN_TYPE_CD3, T.invc_num = S.CTB_INVOICE_NBR3, T.cost_containment_saving_amt = S.CTB_COST_CONT_SAV3, T.cost_containment_red_amt = S.CTB_COST_CONT_RED3, T.cost_containment_ppo_amt = S.CTB_COST_CONT_PPO3, T.attorney_fee_amt = S.CTB_ATY_FEE_AMT3, T.attorney_cost_amt = S.CTB_ATY_COSTS_AMT3, T.attorney_file_num = S.CTB_ATY_FILE_NUM3, T.hourly_rate = S.CTB_HOURLY_RATE3, T.hours_worked = S.CTB_HOURS_WORKED3, T.num_of_days = S.CTB_NUM_DAYS3, T.num_of_weeks = S.CTB_NUM_WEEKS3, T.tpd_rate = S.CTB_TPD_RATE3, T.tpd_rate_fac = S.CTB_TPD_RATE_FCTR3, T.tpd_wage_loss = S.CTB_TPD_WAGE_LOSS3, T.tpd_wkly_wage = S.CTB_TPD_WKLY_WAGE3, T.claim_pay_ctgry_comment = S.CTB_BENE_MIS_CMT3, T.audit_id = S.audit_id3, T.modified_date = S.modified_date3, T.claim_pay_ctgry_litigated_ind = S.CLAIM_PAY_CTGRY_LITIGATED_IND3, T.claim_pay_ctgry_lump_sum_ind = S.ctb_lump_sum_ind3, T.cov_ctgry_code = S.COV_CTGRY_CODE3, T.BenefitOffsetCode = S.BenefitOffsetCode3, T.BenefitOffsetAmount = S.BenefitOffsetAmount3\n),\nSEQ_Claim_payment_category_AK_ID AS (\n\tCREATE SEQUENCE SEQ_Claim_payment_category_AK_ID\n\tSTART = 0\n\tINCREMENT = 1;\n),\nUPD_claim_payment_category_benefit_insert AS (\n\tSELECT\n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id1, \n\tclaim_pay_ak_id AS claim_pay_ak_id1, \n\tCTB_BENEFIT_TYPE AS CTB_BENEFIT_TYPE1, \n\tCTB_BENE_SEQ_NUM AS CTB_BENE_SEQ_NUM1, \n\tCTB_BENEFIT_AMT AS CTB_BENEFIT_AMT1, \n\tCTB_AMT_EARNED AS CTB_AMT_EARNED1, \n\tCTB_BILLED_AMT AS CTB_BILLED_AMT1, \n\tCTB_BENEFIT_START AS CTB_BENEFIT_START1, \n\tCTB_BENEFIT_END AS CTB_BENEFIT_END1, \n\tCTB_FIN_TYPE_CD AS CTB_FIN_TYPE_CD1, \n\tCTB_INVOICE_NBR AS CTB_INVOICE_NBR1, \n\tCTB_COST_CONT_SAV AS CTB_COST_CONT_SAV1, \n\tCTB_COST_CONT_RED AS CTB_COST_CONT_RED1, \n\tCTB_COST_CONT_PPO AS CTB_COST_CONT_PPO1, \n\tCTB_ATY_FEE_AMT AS CTB_ATY_FEE_AMT1, \n\tCTB_ATY_COSTS_AMT AS CTB_ATY_COSTS_AMT1, \n\tCTB_ATY_FILE_NUM AS CTB_ATY_FILE_NUM1, \n\tCTB_HOURLY_RATE AS CTB_HOURLY_RATE1, \n\tCTB_HOURS_WORKED AS CTB_HOURS_WORKED1, \n\tCTB_NUM_DAYS AS CTB_NUM_DAYS1, \n\tCTB_NUM_WEEKS AS CTB_NUM_WEEKS1, \n\tCTB_TPD_RATE AS CTB_TPD_RATE1, \n\tCTB_TPD_RATE_FCTR AS CTB_TPD_RATE_FCTR1, \n\tCTB_TPD_WAGE_LOSS AS CTB_TPD_WAGE_LOSS1, \n\tCTB_TPD_WKLY_WAGE AS CTB_TPD_WKLY_WAGE1, \n\tCTB_BENE_MIS_CMT AS CTB_BENE_MIS_CMT1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tsource_sys_id AS source_sys_id1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tCLAIM_PAY_CTGRY_LITIGATED_IND AS CLAIM_PAY_CTGRY_LITIGATED_IND1, \n\tctb_lump_sum_ind AS ctb_lump_sum_ind1, \n\tcov_ctgry_code AS COV_CTGRY_CODE, \n\tBenefitOffsetCode AS BenefitOffsetCode1, \n\tBenefitOffsetAmount AS BenefitOffsetAmount1\n\tFROM RTR_claim_payment_category_benefit_INSERT\n),\nclaim_payment_category_benefit_insert AS (\n\tINSERT INTO claim_payment_category\n\t(claim_pay_ctgry_ak_id, claim_pay_ak_id, claim_pay_ctgry_type, claim_pay_ctgry_seq_num, claim_pay_ctgry_amt, claim_pay_ctgry_earned_amt, claim_pay_ctgry_billed_amt, claim_pay_ctgry_start_date, claim_pay_ctgry_end_date, financial_type_code, invc_num, cost_containment_saving_amt, cost_containment_red_amt, cost_containment_ppo_amt, attorney_fee_amt, attorney_cost_amt, attorney_file_num, hourly_rate, hours_worked, num_of_days, num_of_weeks, tpd_rate, tpd_rate_fac, tpd_wage_loss, tpd_wkly_wage, claim_pay_ctgry_comment, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date, claim_pay_ctgry_litigated_ind, claim_pay_ctgry_lump_sum_ind, cov_ctgry_code, BenefitOffsetCode, BenefitOffsetAmount)\n\tSELECT \n\tSEQ_Claim_payment_category_AK_ID.NEXTVAL AS CLAIM_PAY_CTGRY_AK_ID, \n\tclaim_pay_ak_id1 AS CLAIM_PAY_AK_ID, \n\tCTB_BENEFIT_TYPE1 AS CLAIM_PAY_CTGRY_TYPE, \n\tCTB_BENE_SEQ_NUM1 AS CLAIM_PAY_CTGRY_SEQ_NUM, \n\tCTB_BENEFIT_AMT1 AS CLAIM_PAY_CTGRY_AMT, \n\tCTB_AMT_EARNED1 AS CLAIM_PAY_CTGRY_EARNED_AMT, \n\tCTB_BILLED_AMT1 AS CLAIM_PAY_CTGRY_BILLED_AMT, \n\tCTB_BENEFIT_START1 AS CLAIM_PAY_CTGRY_START_DATE, \n\tCTB_BENEFIT_END1 AS CLAIM_PAY_CTGRY_END_DATE, \n\tCTB_FIN_TYPE_CD1 AS FINANCIAL_TYPE_CODE, \n\tCTB_INVOICE_NBR1 AS INVC_NUM, \n\tCTB_COST_CONT_SAV1 AS COST_CONTAINMENT_SAVING_AMT, \n\tCTB_COST_CONT_RED1 AS COST_CONTAINMENT_RED_AMT, \n\tCTB_COST_CONT_PPO1 AS COST_CONTAINMENT_PPO_AMT, \n\tCTB_ATY_FEE_AMT1 AS ATTORNEY_FEE_AMT, \n\tCTB_ATY_COSTS_AMT1 AS ATTORNEY_COST_AMT, \n\tCTB_ATY_FILE_NUM1 AS ATTORNEY_FILE_NUM, \n\tCTB_HOURLY_RATE1 AS HOURLY_RATE, \n\tCTB_HOURS_WORKED1 AS HOURS_WORKED, \n\tCTB_NUM_DAYS1 AS NUM_OF_DAYS, \n\tCTB_NUM_WEEKS1 AS NUM_OF_WEEKS, \n\tCTB_TPD_RATE1 AS TPD_RATE, \n\tCTB_TPD_RATE_FCTR1 AS TPD_RATE_FAC, \n\tCTB_TPD_WAGE_LOSS1 AS TPD_WAGE_LOSS, \n\tCTB_TPD_WKLY_WAGE1 AS TPD_WKLY_WAGE, \n\tCTB_BENE_MIS_CMT1 AS CLAIM_PAY_CTGRY_COMMENT, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tsource_sys_id1 AS SOURCE_SYS_ID, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tCLAIM_PAY_CTGRY_LITIGATED_IND1 AS CLAIM_PAY_CTGRY_LITIGATED_IND, \n\tctb_lump_sum_ind1 AS CLAIM_PAY_CTGRY_LUMP_SUM_IND, \n\tCOV_CTGRY_CODE AS COV_CTGRY_CODE, \n\tBenefitOffsetCode1 AS BENEFITOFFSETCODE, \n\tBenefitOffsetAmount1 AS BENEFITOFFSETAMOUNT\n\tFROM UPD_claim_payment_category_benefit_insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataWarehouse/"
        },
        "annotations": []
    }
}