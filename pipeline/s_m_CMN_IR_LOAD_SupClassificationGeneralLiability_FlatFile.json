{
    "name": "s_m_CMN_IR_LOAD_SupClassificationGeneralLiability_FlatFile",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_IR_LOAD_SupClassificationGeneralLiability_Flat_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_GenLiabClass AS (\n\n-- TODO Manual --\n\n),\nEXP_DefaultValues AS (\n\tSELECT\n\tLineOfBusinessAbbreviation AS i_LineofBusinessAbbreviation,\n\tRatingStateCode AS i_RatingStateCode,\n\tEffectiveDate AS i_ClassEffectiveDate,\n\tExpirationDate AS i_ClassExpirationDate,\n\tClassCode AS i_ClassCode,\n\tClassDescription AS i_ClassDescription,\n\tOriginatingOrganizationCode AS i_ClassCodeOriginatingOrganization,\n\tSublineCode_334 AS i_ISOGLClassGroupPremOp_Subline334,\n\tSublineCode_336 AS i_ISOGLClassGroupProdCO_Subline336,\n\tISOGeneralLiabilityClassSummary_334 AS i_ISOGLClassSummary_334,\n\tISOGeneralLiabilityClassSummary_336 AS i_ISOGLClassSummary_336,\n\tRatingBasis AS i_RatingBasis,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_LineofBusinessAbbreviation))) OR IS_SPACES(LTRIM(RTRIM(i_LineofBusinessAbbreviation))) OR LENGTH(LTRIM(RTRIM(i_LineofBusinessAbbreviation)))=0,'N/A',LTRIM(RTRIM(i_LineofBusinessAbbreviation)))\n\tIFF(\n\t    LTRIM(RTRIM(i_LineofBusinessAbbreviation)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_LineofBusinessAbbreviation)))>0\n\t    and TRIM(LTRIM(RTRIM(i_LineofBusinessAbbreviation)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_LineofBusinessAbbreviation))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_LineofBusinessAbbreviation))\n\t) AS o_LineofBusinessAbbreviation,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_RatingStateCode))) OR IS_SPACES(LTRIM(RTRIM(i_RatingStateCode))) OR LENGTH(LTRIM(RTRIM(i_RatingStateCode)))=0,'N/A',LTRIM(RTRIM(i_RatingStateCode)))\n\tIFF(\n\t    LTRIM(RTRIM(i_RatingStateCode)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_RatingStateCode)))>0\n\t    and TRIM(LTRIM(RTRIM(i_RatingStateCode)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_RatingStateCode))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_RatingStateCode))\n\t) AS o_RatingStateCode,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ClassEffectiveDate))) \r\n\t-- OR IS_SPACES(LTRIM(RTRIM(i_ClassEffectiveDate))) \r\n\t-- OR LENGTH(LTRIM(RTRIM(i_ClassEffectiveDate)))=0\r\n\t-- OR LTRIM(RTRIM(i_ClassEffectiveDate))='1900-01-01 01:00:00','1800-01-01 01:00:00',LTRIM(RTRIM(i_ClassEffectiveDate)))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(i_ClassEffectiveDate) OR i_ClassEffectiveDate=TO_DATE('01/01/1900 00:00:00','MM/DD/YYYY HH24:MI:SS'),'01/01/1800 01:00:00', TO_CHAR(i_ClassEffectiveDate,'MM/DD/YYYY HH24:MI:SS'))\n\tIFF(\n\t    LTRIM(RTRIM(i_ClassEffectiveDate)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ClassEffectiveDate)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ClassEffectiveDate)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ClassEffectiveDate))) = 0\n\t    or LTRIM(RTRIM(i_ClassEffectiveDate)) = '1900-01-01 01:00:00',\n\t    '1800-01-01 01:00:00',\n\t    LTRIM(RTRIM(i_ClassEffectiveDate))\n\t) AS o_ClassEffectiveDate,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ClassExpirationDate))) \r\n\t-- OR IS_SPACES(LTRIM(RTRIM(i_ClassExpirationDate)))\r\n\t-- OR LENGTH(LTRIM(RTRIM(i_ClassExpirationDate)))=0\r\n\t-- OR LTRIM(RTRIM(i_ClassExpirationDate))='2999-01-01 01:00:00','2100-12-31 23:59:59',LTRIM(RTRIM(i_ClassExpirationDate)))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(i_ClassExpirationDate) OR i_ClassExpirationDate=TO_DATE('01/01/2999 00:00:00','MM/DD/YYYY HH24:MI:SS'),'12/31/2100 23:59:59', TO_CHAR(i_ClassExpirationDate,'MM/DD/YYYY HH24:MI:SS'))\n\tIFF(\n\t    LTRIM(RTRIM(i_ClassExpirationDate)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ClassExpirationDate)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ClassExpirationDate)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ClassExpirationDate))) = 0\n\t    or LTRIM(RTRIM(i_ClassExpirationDate)) = '2999-01-01 01:00:00',\n\t    '2100-12-31 23:59:59',\n\t    LTRIM(RTRIM(i_ClassExpirationDate))\n\t) AS o_ClassExpirationDate,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ClassCode))) OR IS_SPACES(LTRIM(RTRIM(i_ClassCode))) OR LENGTH(LTRIM(RTRIM(i_ClassCode)))=0,'N/A',LTRIM(RTRIM(i_ClassCode)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ClassCode)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ClassCode)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ClassCode)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ClassCode))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ClassCode))\n\t) AS o_ClassCode,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ClassDescription))) OR IS_SPACES(LTRIM(RTRIM(i_ClassDescription))) OR LENGTH(LTRIM(RTRIM(i_ClassDescription)))=0,'N/A',LTRIM(RTRIM(i_ClassDescription)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ClassDescription)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ClassDescription)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ClassDescription)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ClassDescription))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ClassDescription))\n\t) AS o_ClassDescription,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization))) OR IS_SPACES(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization))) OR LENGTH(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization)))=0,'N/A',LTRIM(RTRIM(i_ClassCodeOriginatingOrganization)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ClassCodeOriginatingOrganization)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ClassCodeOriginatingOrganization))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ClassCodeOriginatingOrganization))\n\t) AS o_ClassCodeOriginatingOrganization,\n\t'334' AS o_Subline_334,\n\t'336' AS o_Subline_336,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334))) OR IS_SPACES(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334))) OR LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334)))=0,'N/A',LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ISOGLClassGroupPremOp_Subline334))\n\t) AS o_ISOGLClassGroupPremOp_Subline334,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336))) OR IS_SPACES(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336))) OR LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336)))=0,'N/A',LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ISOGLClassGroupProdCO_Subline336))\n\t) AS o_ISOGLClassGroupProdCO_Subline336,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ISOGLClassSummary_334))) OR IS_SPACES(LTRIM(RTRIM(i_ISOGLClassSummary_334))) OR LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_334)))=0,'N/A',LTRIM(RTRIM(i_ISOGLClassSummary_334)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ISOGLClassSummary_334)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_334)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ISOGLClassSummary_334)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_334))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ISOGLClassSummary_334))\n\t) AS o_ISOGLClassSummary_334,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_ISOGLClassSummary_336))) OR IS_SPACES(LTRIM(RTRIM(i_ISOGLClassSummary_336))) OR LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_336)))=0,'N/A',LTRIM(RTRIM(i_ISOGLClassSummary_336)))\n\tIFF(\n\t    LTRIM(RTRIM(i_ISOGLClassSummary_336)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_336)))>0\n\t    and TRIM(LTRIM(RTRIM(i_ISOGLClassSummary_336)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_ISOGLClassSummary_336))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ISOGLClassSummary_336))\n\t) AS o_ISOGLClassSummary_336,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(i_RatingBasis))) OR IS_SPACES(LTRIM(RTRIM(i_RatingBasis))) OR LENGTH(LTRIM(RTRIM(i_RatingBasis)))=0,'N/A',LTRIM(RTRIM(i_RatingBasis)))\n\tIFF(\n\t    LTRIM(RTRIM(i_RatingBasis)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(i_RatingBasis)))>0\n\t    and TRIM(LTRIM(RTRIM(i_RatingBasis)))=''\n\t    or LENGTH(LTRIM(RTRIM(i_RatingBasis))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_RatingBasis))\n\t) AS o_RatingBasis\n\tFROM SQ_GenLiabClass\n),\nNRM_ClassGroup_ClassSummary AS (\n),\nEXP_CalculateData AS (\n\tSELECT\n\tLineofBusinessAbbreviation,\n\tRatingStateCode,\n\tClassEffectiveDate,\n\tClassExpirationDate,\n\tClassCode,\n\tClassDescription,\n\tClassCodeOriginatingOrganization,\n\tSubline,\n\tISOGLClassGroup,\n\tISOGLClassSummary,\n\tRatingBasis,\n\tLineofBusinessAbbreviation AS o_LineofBusinessAbbreviation,\n\t-- *INF*: TO_DATE(SUBSTR(ClassEffectiveDate,1,19),'YYYY-MM-DD HH24:MI:SS')\n\tTO_TIMESTAMP(SUBSTR(ClassEffectiveDate, 1, 19), 'YYYY-MM-DD HH24:MI:SS') AS o_ClassEffectiveDate,\n\t-- *INF*: TO_DATE(SUBSTR(ClassExpirationDate,1,19),'YYYY-MM-DD HH24:MI:SS')\n\tTO_TIMESTAMP(SUBSTR(ClassExpirationDate, 1, 19), 'YYYY-MM-DD HH24:MI:SS') AS o_ClassExpirationDate,\n\t-- *INF*: LTRIM(RTRIM(RatingStateCode))\n\tLTRIM(RTRIM(RatingStateCode)) AS o_RatingStateCode,\n\tSubline AS o_Subline,\n\tClassCode AS o_ClassCode,\n\t-- *INF*: LTRIM(RTRIM(REPLACESTR(1,ClassDescription,'\"','')))\n\tLTRIM(RTRIM(REGEXP_REPLACE(ClassDescription,'\"',''))) AS o_ClassDescription,\n\t-- *INF*: LTRIM(RTRIM(ClassCodeOriginatingOrganization))\n\tLTRIM(RTRIM(ClassCodeOriginatingOrganization)) AS o_ClassCodeOriginatingOrganization,\n\t-- *INF*: LTRIM(RTRIM(IIF(ISOGLClassGroup!='N/A',LPAD(ISOGLClassGroup,2,'0'),ISOGLClassGroup)))\n\tLTRIM(RTRIM(\n\t        IFF(\n\t            ISOGLClassGroup != 'N/A', LPAD(ISOGLClassGroup, 2, '0'), ISOGLClassGroup\n\t        ))) AS o_ISOGLClassGroup,\n\t-- *INF*: LTRIM(RTRIM(REPLACESTR(1,ISOGLClassSummary,'\"','')))\n\tLTRIM(RTRIM(REGEXP_REPLACE(ISOGLClassSummary,'\"',''))) AS o_ISOGLClassSummary,\n\t-- *INF*: LTRIM(RTRIM(RatingBasis))\n\tLTRIM(RTRIM(RatingBasis)) AS o_RatingBasis\n\tFROM NRM_ClassGroup_ClassSummary\n),\nFIL_ValidClassGroup AS (\n\tSELECT\n\to_LineofBusinessAbbreviation AS LineofBusinessAbbreviation, \n\to_ClassEffectiveDate AS ClassEffectiveDate, \n\to_ClassExpirationDate AS ClassExpirationDate, \n\to_RatingStateCode AS RatingStateCode, \n\to_Subline AS Subline, \n\to_ClassCode AS ClassCode, \n\to_ClassDescription AS ClassDescription, \n\to_ClassCodeOriginatingOrganization AS ClassCodeOriginatingOrganization, \n\to_ISOGLClassGroup AS ISOGLClassGroup, \n\to_ISOGLClassSummary AS ISOGLClassSummary, \n\to_RatingBasis AS RatingBasis\n\tFROM EXP_CalculateData\n\tWHERE 1=1\r\n\r\n--NOT (ISOGLClassGroup='N/A' and ISOGLClassSummary='N/A')\n),\nAGG_RemoveDuplicate AS (\n\tSELECT\n\tLineofBusinessAbbreviation,\n\tClassEffectiveDate,\n\tClassExpirationDate,\n\tRatingStateCode,\n\tSubline,\n\tClassCode,\n\tClassDescription,\n\tClassCodeOriginatingOrganization,\n\tISOGLClassGroup,\n\tISOGLClassSummary,\n\tRatingBasis\n\tFROM FIL_ValidClassGroup\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY LineofBusinessAbbreviation, ClassEffectiveDate, ClassExpirationDate, RatingStateCode, Subline, ClassCode, ClassDescription, ClassCodeOriginatingOrganization, ISOGLClassGroup, ISOGLClassSummary, RatingBasis ORDER BY NULL) = 1\n),\nEXP_UpdateOrInsert AS (\n\tSELECT\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\tLineofBusinessAbbreviation,\n\tRatingStateCode,\n\tClassEffectiveDate AS EffectiveDate,\n\tClassExpirationDate AS ExpirationDate,\n\tClassCode,\n\tClassDescription,\n\tClassCodeOriginatingOrganization,\n\tSubline,\n\tISOGLClassSummary,\n\tISOGLClassGroup,\n\tRatingBasis\n\tFROM AGG_RemoveDuplicate\n),\nSupClassificationGeneralLiability AS (\n\tTRUNCATE TABLE SupClassificationGeneralLiability;\n\tINSERT INTO SupClassificationGeneralLiability\n\t(AuditId, CreatedDate, ModifiedDate, LineOfBusinessAbbreviation, RatingStateCode, EffectiveDate, ExpirationDate, ClassCode, ClassDescription, OriginatingOrganizationCode, SublineCode, ISOGeneralLiabilityClassSummary, ISOGeneralLiabilityClassGroupCode, RatingBasis)\n\tSELECT \n\to_AuditId AS AUDITID, \n\to_CreatedDate AS CREATEDDATE, \n\to_ModifiedDate AS MODIFIEDDATE, \n\tLineofBusinessAbbreviation AS LINEOFBUSINESSABBREVIATION, \n\tRATINGSTATECODE, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\tCLASSCODE, \n\tCLASSDESCRIPTION, \n\tClassCodeOriginatingOrganization AS ORIGINATINGORGANIZATIONCODE, \n\tSubline AS SUBLINECODE, \n\tISOGLClassSummary AS ISOGENERALLIABILITYCLASSSUMMARY, \n\tISOGLClassGroup AS ISOGENERALLIABILITYCLASSGROUPCODE, \n\tRATINGBASIS\n\tFROM EXP_UpdateOrInsert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "CommonDataWarehouse/"
        },
        "annotations": []
    }
}