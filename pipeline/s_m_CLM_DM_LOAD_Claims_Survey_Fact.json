{
    "name": "s_m_CLM_DM_LOAD_Claims_Survey_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claims_Survey_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_claims_survey_result AS (\n\tSELECT Survey.claims_survey_result_id\r\n\t,\t\tSurvey.claims_survey_result_ak_id\r\n\t,\t\tSurvey.claims_survey_form_num\r\n\t,\t\tSurvey.entry_date\r\n\t,\t\tSurvey.ques1_resp_val\r\n\t,\t\tSurvey.ques2_resp_val\r\n\t,\t\tSurvey.ques3_resp_val\r\n\t,\t\tSurvey.ques4_resp_val\r\n\t,\t\tSurvey.ques5_resp_val\r\n\t,\t\tSurvey.ques6_resp_val\r\n\t,\t\tSurvey.ques7_resp_val\r\n\t,\t\tSurvey.ques8_resp_val\r\n\t,\t\tSurvey.ques9_resp_val\r\n\t,\t\tSurvey.ques10_resp_val\r\n\t,\t\tSurvey.ques11_resp_val\r\n\t,\t\tSurvey.ques12_resp_val\r\n\t,\t\tSurvey.ques13_resp_val\r\n\t,\t\tSurvey.ques14_resp_val\r\n\t,\t\tSurvey.ques15_resp_val\r\n\t,\t\tSurvey.ques16_resp_val\r\n\t,\t\tSurvey.ques17_resp_val\r\n\t,\t\tSurvey.ques18_resp_val\r\n\t,\t\tisnull(RepOcc.claim_occurrence_ak_id,-1)\tAS claim_occurrence_ak_id\r\n\t,\t\tisnull(RepOcc.claim_rep_ak_id,-1)\t\t\tAS claim_rep_ak_id\r\n\tFROM\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claims_survey_result Survey\r\n\tLEFT\tOUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_representative_occurrence RepOcc\r\n\t\tON\tSurvey.claim_rep_occurrence_ak_id\t\t\t= RepOcc.claim_rep_occurrence_ak_id\r\n\tWHERE\tRepOcc.crrnt_snpsht_flag = 1\n),\nLKP_calender_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nLKP_claim_occurrence_dim AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tedw_claim_occurrence_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_occurrence_dim_id,\n\t\t\tedw_claim_occurrence_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_occurrence_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n),\nLKP_claim_representative_dim AS (\n\tSELECT\n\tclaim_rep_dim_id,\n\tedw_claim_rep_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_rep_dim_id,\n\t\t\tedw_claim_rep_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_representative_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n),\nlkp_claims_survey_form_dim AS (\n\tSELECT\n\tclaims_survey_form_dim_id,\n\tclaims_survey_form_num,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaims_survey_form_dim_id,\n\t\t\tclaims_survey_form_num,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claims_survey_form_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claims_survey_form_num,eff_from_date,eff_to_date ORDER BY claims_survey_form_dim_id DESC) = 1\n),\nEXP_Values AS (\n\tSELECT\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tSQ_claims_survey_result.claims_survey_result_id AS edw_claims_survey_result_pk_id,\n\tSQ_claims_survey_result.claims_survey_result_ak_id AS edw_claims_survey_result_ak_id,\n\tlkp_claims_survey_form_dim.claims_survey_form_dim_id AS in_claims_survey_form_dim_id,\n\t-- *INF*: iif(isnull(in_claims_survey_form_dim_id),-1,in_claims_survey_form_dim_id)\n\tIFF(in_claims_survey_form_dim_id IS NULL,\n\t\t- 1,\n\t\tin_claims_survey_form_dim_id\n\t) AS claims_survey_form_dim_id,\n\tLKP_claim_occurrence_dim.claim_occurrence_dim_id AS in_claim_occurrence_dim_id,\n\t-- *INF*: iif(isnull(in_claim_occurrence_dim_id),-1,in_claim_occurrence_dim_id)\n\tIFF(in_claim_occurrence_dim_id IS NULL,\n\t\t- 1,\n\t\tin_claim_occurrence_dim_id\n\t) AS claim_occurrence_dim_id,\n\tLKP_claim_representative_dim.claim_rep_dim_id AS in_claim_rep_dim_id,\n\t-- *INF*: iif(isnull(in_claim_rep_dim_id),-1,in_claim_rep_dim_id)\n\tIFF(in_claim_rep_dim_id IS NULL,\n\t\t- 1,\n\t\tin_claim_rep_dim_id\n\t) AS claim_rep_dim_id,\n\tLKP_calender_dim.clndr_id AS in_entry_date_clndr_id,\n\t-- *INF*: iif(isnull(in_entry_date_clndr_id),-1,in_entry_date_clndr_id)\n\tIFF(in_entry_date_clndr_id IS NULL,\n\t\t- 1,\n\t\tin_entry_date_clndr_id\n\t) AS entry_date_clndr_id,\n\tSQ_claims_survey_result.ques1_resp_val,\n\tSQ_claims_survey_result.ques2_resp_val,\n\tSQ_claims_survey_result.ques3_resp_val,\n\tSQ_claims_survey_result.ques4_resp_val,\n\tSQ_claims_survey_result.ques5_resp_val,\n\tSQ_claims_survey_result.ques6_resp_val,\n\tSQ_claims_survey_result.ques7_resp_val,\n\tSQ_claims_survey_result.ques8_resp_val,\n\tSQ_claims_survey_result.ques9_resp_val,\n\tSQ_claims_survey_result.ques10_resp_val,\n\tSQ_claims_survey_result.ques11_resp_val,\n\tSQ_claims_survey_result.ques12_resp_val,\n\tSQ_claims_survey_result.ques13_resp_val,\n\tSQ_claims_survey_result.ques14_resp_val,\n\tSQ_claims_survey_result.ques15_resp_val,\n\tSQ_claims_survey_result.ques16_resp_val,\n\tSQ_claims_survey_result.ques17_resp_val,\n\tSQ_claims_survey_result.ques18_resp_val,\n\t-- *INF*: IIF(ques10_resp_val>3,1,0)\n\tIFF(ques10_resp_val > 3,\n\t\t1,\n\t\t0\n\t) AS raving_fan_flag,\n\t0 AS dtrctr_flag\n\tFROM SQ_claims_survey_result\n\tLEFT JOIN LKP_calender_dim\n\tON LKP_calender_dim.clndr_date = SQ_claims_survey_result.entry_date\n\tLEFT JOIN LKP_claim_occurrence_dim\n\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = SQ_claims_survey_result.claim_occurrence_ak_id AND LKP_claim_occurrence_dim.eff_from_date <= SQ_claims_survey_result.entry_date AND LKP_claim_occurrence_dim.eff_to_date >= SQ_claims_survey_result.entry_date\n\tLEFT JOIN LKP_claim_representative_dim\n\tON LKP_claim_representative_dim.edw_claim_rep_ak_id = SQ_claims_survey_result.claim_rep_ak_id AND LKP_claim_representative_dim.eff_from_date <= SQ_claims_survey_result.entry_date AND LKP_claim_representative_dim.eff_to_date >= SQ_claims_survey_result.entry_date\n\tLEFT JOIN lkp_claims_survey_form_dim\n\tON lkp_claims_survey_form_dim.claims_survey_form_num = SQ_claims_survey_result.claims_survey_form_num AND lkp_claims_survey_form_dim.eff_from_date <= SQ_claims_survey_result.entry_date AND lkp_claims_survey_form_dim.eff_to_date >= SQ_claims_survey_result.entry_date\n),\nlkp_claims_survey_fact AS (\n\tSELECT\n\tin_edw_claims_survey_result_pk_id,\n\tclaims_survey_fact_id,\n\tedw_claims_survey_result_pk_id,\n\tedw_claims_survey_result_ak_id,\n\tclaims_survey_form_dim_id,\n\tclaim_occurrence_dim_id,\n\tclaim_rep_dim_id,\n\tentry_date_clndr_id,\n\tques1_resp_val,\n\tques2_resp_val,\n\tques3_resp_val,\n\tques4_resp_val,\n\tques5_resp_val,\n\tques6_resp_val,\n\tques7_resp_val,\n\tques8_resp_val,\n\tques9_resp_val,\n\tques10_resp_val,\n\tques11_resp_val,\n\tques12_resp_val,\n\tques13_resp_val,\n\tques14_resp_val,\n\tques15_resp_val,\n\tques16_resp_val,\n\tques17_resp_val,\n\tques18_resp_val,\n\traving_fan_flag,\n\tdtrctr_flag\n\tFROM (\n\t\tSELECT \n\t\t\tin_edw_claims_survey_result_pk_id,\n\t\t\tclaims_survey_fact_id,\n\t\t\tedw_claims_survey_result_pk_id,\n\t\t\tedw_claims_survey_result_ak_id,\n\t\t\tclaims_survey_form_dim_id,\n\t\t\tclaim_occurrence_dim_id,\n\t\t\tclaim_rep_dim_id,\n\t\t\tentry_date_clndr_id,\n\t\t\tques1_resp_val,\n\t\t\tques2_resp_val,\n\t\t\tques3_resp_val,\n\t\t\tques4_resp_val,\n\t\t\tques5_resp_val,\n\t\t\tques6_resp_val,\n\t\t\tques7_resp_val,\n\t\t\tques8_resp_val,\n\t\t\tques9_resp_val,\n\t\t\tques10_resp_val,\n\t\t\tques11_resp_val,\n\t\t\tques12_resp_val,\n\t\t\tques13_resp_val,\n\t\t\tques14_resp_val,\n\t\t\tques15_resp_val,\n\t\t\tques16_resp_val,\n\t\t\tques17_resp_val,\n\t\t\tques18_resp_val,\n\t\t\traving_fan_flag,\n\t\t\tdtrctr_flag\n\t\tFROM claims_survey_fact\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claims_survey_result_pk_id ORDER BY in_edw_claims_survey_result_pk_id DESC) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tlkp_claims_survey_fact.claims_survey_fact_id AS lkp_claims_survey_fact_id,\n\tlkp_claims_survey_fact.edw_claims_survey_result_pk_id AS lkp_edw_claims_survey_result_pk_id,\n\tlkp_claims_survey_fact.edw_claims_survey_result_ak_id AS lkp_edw_claims_survey_result_ak_id,\n\tlkp_claims_survey_fact.claims_survey_form_dim_id AS lkp_claims_survey_form_dim_id,\n\tlkp_claims_survey_fact.claim_occurrence_dim_id AS lkp_claim_occurrence_dim_id,\n\tlkp_claims_survey_fact.claim_rep_dim_id AS lkp_claim_rep_dim_id,\n\tlkp_claims_survey_fact.entry_date_clndr_id AS lkp_entry_date_clndr_id,\n\tlkp_claims_survey_fact.ques1_resp_val AS lkp_ques1_resp_val,\n\tlkp_claims_survey_fact.ques2_resp_val AS lkp_ques2_resp_val,\n\tlkp_claims_survey_fact.ques3_resp_val AS lkp_ques3_resp_val,\n\tlkp_claims_survey_fact.ques4_resp_val AS lkp_ques4_resp_val,\n\tlkp_claims_survey_fact.ques5_resp_val AS lkp_ques5_resp_val,\n\tlkp_claims_survey_fact.ques6_resp_val AS lkp_ques6_resp_val,\n\tlkp_claims_survey_fact.ques7_resp_val AS lkp_ques7_resp_val,\n\tlkp_claims_survey_fact.ques8_resp_val AS lkp_ques8_resp_val,\n\tlkp_claims_survey_fact.ques9_resp_val AS lkp_ques9_resp_val,\n\tlkp_claims_survey_fact.ques10_resp_val AS lkp_ques10_resp_val,\n\tlkp_claims_survey_fact.ques11_resp_val AS lkp_ques11_resp_val,\n\tlkp_claims_survey_fact.ques12_resp_val AS lkp_ques12_resp_val,\n\tlkp_claims_survey_fact.ques13_resp_val AS lkp_ques13_resp_val,\n\tlkp_claims_survey_fact.ques14_resp_val AS lkp_ques14_resp_val,\n\tlkp_claims_survey_fact.ques15_resp_val AS lkp_ques15_resp_val,\n\tlkp_claims_survey_fact.ques16_resp_val AS lkp_ques16_resp_val,\n\tlkp_claims_survey_fact.ques17_resp_val AS lkp_ques17_resp_val,\n\tlkp_claims_survey_fact.ques18_resp_val AS lkp_ques18_resp_val,\n\tlkp_claims_survey_fact.raving_fan_flag AS lkp_raving_fan_flag,\n\tlkp_claims_survey_fact.dtrctr_flag AS lkp_dtrctr_flag,\n\tEXP_Values.audit_id,\n\tEXP_Values.edw_claims_survey_result_pk_id,\n\tEXP_Values.edw_claims_survey_result_ak_id,\n\tEXP_Values.claims_survey_form_dim_id,\n\tEXP_Values.claim_occurrence_dim_id,\n\tEXP_Values.claim_rep_dim_id,\n\tEXP_Values.entry_date_clndr_id,\n\tEXP_Values.ques1_resp_val,\n\tEXP_Values.ques2_resp_val,\n\tEXP_Values.ques3_resp_val,\n\tEXP_Values.ques4_resp_val,\n\tEXP_Values.ques5_resp_val,\n\tEXP_Values.ques6_resp_val,\n\tEXP_Values.ques7_resp_val,\n\tEXP_Values.ques8_resp_val,\n\tEXP_Values.ques9_resp_val,\n\tEXP_Values.ques10_resp_val,\n\tEXP_Values.ques11_resp_val,\n\tEXP_Values.ques12_resp_val,\n\tEXP_Values.ques13_resp_val,\n\tEXP_Values.ques14_resp_val,\n\tEXP_Values.ques15_resp_val,\n\tEXP_Values.ques16_resp_val,\n\tEXP_Values.ques17_resp_val,\n\tEXP_Values.ques18_resp_val,\n\tEXP_Values.raving_fan_flag,\n\tEXP_Values.dtrctr_flag,\n\t-- *INF*: IIF(ISNULL(lkp_claims_survey_fact_id) ,'NEW',\r\n\t-- IIF(\r\n\t-- lkp_claims_survey_form_dim_id <> claims_survey_form_dim_id OR\r\n\t-- lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id OR\r\n\t-- lkp_claim_rep_dim_id <> claim_rep_dim_id OR\r\n\t-- lkp_entry_date_clndr_id <> entry_date_clndr_id OR\r\n\t-- lkp_ques1_resp_val <> ques1_resp_val OR\r\n\t-- lkp_ques2_resp_val <> ques2_resp_val OR\r\n\t-- lkp_ques3_resp_val <> ques3_resp_val OR\r\n\t-- lkp_ques4_resp_val <> ques4_resp_val OR\r\n\t-- lkp_ques5_resp_val <> ques5_resp_val OR\r\n\t-- lkp_ques6_resp_val <> ques6_resp_val OR\r\n\t-- lkp_ques7_resp_val <> ques7_resp_val OR\r\n\t-- lkp_ques8_resp_val <> ques8_resp_val OR\r\n\t-- lkp_ques9_resp_val <> ques9_resp_val OR\r\n\t-- lkp_ques10_resp_val <> ques10_resp_val OR\r\n\t-- lkp_ques11_resp_val <> ques11_resp_val OR\r\n\t-- lkp_ques12_resp_val <> ques12_resp_val OR\r\n\t-- lkp_ques13_resp_val <> ques13_resp_val OR\r\n\t-- lkp_ques14_resp_val <> ques14_resp_val OR\r\n\t-- lkp_ques15_resp_val <> ques15_resp_val OR\r\n\t-- lkp_ques16_resp_val <> ques16_resp_val OR\r\n\t-- lkp_ques17_resp_val <> ques17_resp_val OR\r\n\t-- lkp_ques18_resp_val <> ques18_resp_val OR\r\n\t-- lkp_raving_fan_flag <> raving_fan_flag OR\r\n\t-- lkp_dtrctr_flag <> dtrctr_flag \r\n\t-- ,\r\n\t-- 'UPDATE','NOCHANGE'))\r\n\t-- \n\tIFF(lkp_claims_survey_fact_id IS NULL,\n\t\t'NEW',\n\t\tIFF(lkp_claims_survey_form_dim_id <> claims_survey_form_dim_id \n\t\t\tOR lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id \n\t\t\tOR lkp_claim_rep_dim_id <> claim_rep_dim_id \n\t\t\tOR lkp_entry_date_clndr_id <> entry_date_clndr_id \n\t\t\tOR lkp_ques1_resp_val <> ques1_resp_val \n\t\t\tOR lkp_ques2_resp_val <> ques2_resp_val \n\t\t\tOR lkp_ques3_resp_val <> ques3_resp_val \n\t\t\tOR lkp_ques4_resp_val <> ques4_resp_val \n\t\t\tOR lkp_ques5_resp_val <> ques5_resp_val \n\t\t\tOR lkp_ques6_resp_val <> ques6_resp_val \n\t\t\tOR lkp_ques7_resp_val <> ques7_resp_val \n\t\t\tOR lkp_ques8_resp_val <> ques8_resp_val \n\t\t\tOR lkp_ques9_resp_val <> ques9_resp_val \n\t\t\tOR lkp_ques10_resp_val <> ques10_resp_val \n\t\t\tOR lkp_ques11_resp_val <> ques11_resp_val \n\t\t\tOR lkp_ques12_resp_val <> ques12_resp_val \n\t\t\tOR lkp_ques13_resp_val <> ques13_resp_val \n\t\t\tOR lkp_ques14_resp_val <> ques14_resp_val \n\t\t\tOR lkp_ques15_resp_val <> ques15_resp_val \n\t\t\tOR lkp_ques16_resp_val <> ques16_resp_val \n\t\t\tOR lkp_ques17_resp_val <> ques17_resp_val \n\t\t\tOR lkp_ques18_resp_val <> ques18_resp_val \n\t\t\tOR lkp_raving_fan_flag <> raving_fan_flag \n\t\t\tOR lkp_dtrctr_flag <> dtrctr_flag,\n\t\t\t'UPDATE',\n\t\t\t'NOCHANGE'\n\t\t)\n\t) AS v_changed_flag,\n\tv_changed_flag AS changed_flag,\n\tSYSDATE AS modified_date\n\tFROM EXP_Values\n\tLEFT JOIN lkp_claims_survey_fact\n\tON lkp_claims_survey_fact.edw_claims_survey_result_pk_id = EXP_Values.edw_claims_survey_result_pk_id\n),\nRTR_InsertUpdate AS (\n\tSELECT\n\tlkp_claims_survey_fact_id,\n\taudit_id,\n\tedw_claims_survey_result_pk_id,\n\tedw_claims_survey_result_ak_id,\n\tclaims_survey_form_dim_id,\n\tclaim_occurrence_dim_id,\n\tclaim_rep_dim_id,\n\tentry_date_clndr_id,\n\tques1_resp_val,\n\tques2_resp_val,\n\tques3_resp_val,\n\tques4_resp_val,\n\tques5_resp_val,\n\tques6_resp_val,\n\tques7_resp_val,\n\tques8_resp_val,\n\tques9_resp_val,\n\tques10_resp_val,\n\tques11_resp_val,\n\tques12_resp_val,\n\tques13_resp_val,\n\tques14_resp_val,\n\tques15_resp_val,\n\tques16_resp_val,\n\tques17_resp_val,\n\tques18_resp_val,\n\traving_fan_flag,\n\tdtrctr_flag,\n\tchanged_flag\n\tFROM EXP_Detect_Changes\n),\nRTR_InsertUpdate_InsertRecords AS (SELECT * FROM RTR_InsertUpdate WHERE changed_flag = 'NEW'),\nRTR_InsertUpdate_UpdateRecords AS (SELECT * FROM RTR_InsertUpdate WHERE changed_flag = 'UPDATE'),\nUPD_claims_survey_fact_Update AS (\n\tSELECT\n\tlkp_claims_survey_fact_id, \n\tedw_claims_survey_result_pk_id, \n\tedw_claims_survey_result_ak_id, \n\tclaims_survey_form_dim_id, \n\tclaim_occurrence_dim_id, \n\tclaim_rep_dim_id, \n\tentry_date_clndr_id, \n\tques1_resp_val, \n\tques2_resp_val, \n\tques3_resp_val, \n\tques4_resp_val, \n\tques5_resp_val, \n\tques6_resp_val, \n\tques7_resp_val, \n\tques8_resp_val, \n\tques9_resp_val, \n\tques10_resp_val, \n\tques11_resp_val, \n\tques12_resp_val, \n\tques13_resp_val, \n\tques14_resp_val, \n\tques15_resp_val, \n\tques16_resp_val, \n\tques17_resp_val, \n\tques18_resp_val, \n\traving_fan_flag, \n\tdtrctr_flag\n\tFROM RTR_InsertUpdate_UpdateRecords\n),\nclaims_survey_fact_update AS (\n\tMERGE INTO claims_survey_fact AS T\n\tUSING UPD_claims_survey_fact_Update AS S\n\tON T.claims_survey_fact_id = S.lkp_claims_survey_fact_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.edw_claims_survey_result_pk_id = S.edw_claims_survey_result_pk_id, T.edw_claims_survey_result_ak_id = S.edw_claims_survey_result_ak_id, T.claims_survey_form_dim_id = S.claims_survey_form_dim_id, T.claim_occurrence_dim_id = S.claim_occurrence_dim_id, T.claim_rep_dim_id = S.claim_rep_dim_id, T.entry_date_clndr_id = S.entry_date_clndr_id, T.ques1_resp_val = S.ques1_resp_val, T.ques2_resp_val = S.ques2_resp_val, T.ques3_resp_val = S.ques3_resp_val, T.ques4_resp_val = S.ques4_resp_val, T.ques5_resp_val = S.ques5_resp_val, T.ques6_resp_val = S.ques6_resp_val, T.ques7_resp_val = S.ques7_resp_val, T.ques8_resp_val = S.ques8_resp_val, T.ques9_resp_val = S.ques9_resp_val, T.ques10_resp_val = S.ques10_resp_val, T.ques11_resp_val = S.ques11_resp_val, T.ques12_resp_val = S.ques12_resp_val, T.ques13_resp_val = S.ques13_resp_val, T.ques14_resp_val = S.ques14_resp_val, T.ques15_resp_val = S.ques15_resp_val, T.ques16_resp_val = S.ques16_resp_val, T.ques17_resp_val = S.ques17_resp_val, T.ques18_resp_val = S.ques18_resp_val, T.raving_fan_flag = S.raving_fan_flag, T.dtrctr_flag = S.dtrctr_flag\n),\nUPD_claims_survey_fact_Insert AS (\n\tSELECT\n\taudit_id, \n\tedw_claims_survey_result_pk_id, \n\tedw_claims_survey_result_ak_id, \n\tclaims_survey_form_dim_id, \n\tclaim_occurrence_dim_id, \n\tclaim_rep_dim_id, \n\tentry_date_clndr_id, \n\tques1_resp_val, \n\tques2_resp_val, \n\tques3_resp_val, \n\tques4_resp_val, \n\tques5_resp_val, \n\tques6_resp_val, \n\tques7_resp_val, \n\tques8_resp_val, \n\tques9_resp_val, \n\tques10_resp_val, \n\tques11_resp_val, \n\tques12_resp_val, \n\tques13_resp_val, \n\tques14_resp_val, \n\tques15_resp_val, \n\tques16_resp_val, \n\tques17_resp_val, \n\tques18_resp_val, \n\traving_fan_flag, \n\tdtrctr_flag\n\tFROM RTR_InsertUpdate_InsertRecords\n),\nclaims_survey_fact_insert AS (\n\tINSERT INTO claims_survey_fact\n\t(audit_id, edw_claims_survey_result_pk_id, edw_claims_survey_result_ak_id, claims_survey_form_dim_id, claim_occurrence_dim_id, claim_rep_dim_id, entry_date_clndr_id, ques1_resp_val, ques2_resp_val, ques3_resp_val, ques4_resp_val, ques5_resp_val, ques6_resp_val, ques7_resp_val, ques8_resp_val, ques9_resp_val, ques10_resp_val, ques11_resp_val, ques12_resp_val, ques13_resp_val, ques14_resp_val, ques15_resp_val, ques16_resp_val, ques17_resp_val, ques18_resp_val, raving_fan_flag, dtrctr_flag)\n\tSELECT \n\tAUDIT_ID, \n\tEDW_CLAIMS_SURVEY_RESULT_PK_ID, \n\tEDW_CLAIMS_SURVEY_RESULT_AK_ID, \n\tCLAIMS_SURVEY_FORM_DIM_ID, \n\tCLAIM_OCCURRENCE_DIM_ID, \n\tCLAIM_REP_DIM_ID, \n\tENTRY_DATE_CLNDR_ID, \n\tQUES1_RESP_VAL, \n\tQUES2_RESP_VAL, \n\tQUES3_RESP_VAL, \n\tQUES4_RESP_VAL, \n\tQUES5_RESP_VAL, \n\tQUES6_RESP_VAL, \n\tQUES7_RESP_VAL, \n\tQUES8_RESP_VAL, \n\tQUES9_RESP_VAL, \n\tQUES10_RESP_VAL, \n\tQUES11_RESP_VAL, \n\tQUES12_RESP_VAL, \n\tQUES13_RESP_VAL, \n\tQUES14_RESP_VAL, \n\tQUES15_RESP_VAL, \n\tQUES16_RESP_VAL, \n\tQUES17_RESP_VAL, \n\tQUES18_RESP_VAL, \n\tRAVING_FAN_FLAG, \n\tDTRCTR_FLAG\n\tFROM UPD_claims_survey_fact_Insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604479"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "OMR_APP"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}