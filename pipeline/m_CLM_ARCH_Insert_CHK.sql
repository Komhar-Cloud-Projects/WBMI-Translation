WITH
SQ_chk_stage AS (
	SELECT chk_stage.Chk_stage_id, chk_stage.RecordId, chk_stage.CTpId, chk_stage.Id, chk_stage.OrigId, chk_stage.AltSrt, chk_stage.AltSrt1, chk_stage.IdPre, chk_stage.ModVer, chk_stage.ModCd, chk_stage.CmpId, chk_stage.PayToNam1, chk_stage.PayToNam2, chk_stage.PayToNam3, chk_stage.IssDt, chk_stage.PayAmt, chk_stage.OrigPayAmt, chk_stage.ResrvAmt, chk_stage.BnkId, chk_stage.BnkNum, chk_stage.LosDt, chk_stage.Dt1, chk_stage.Dt2, chk_stage.Dt3, chk_stage.Dt4, chk_stage.Dt5, chk_stage.Time1, chk_stage.Time2, chk_stage.TranCd, chk_stage.TaxId, chk_stage.TaxTyp, chk_stage.Tax1099, chk_stage.RptAmt1099, chk_stage.SpltPay1099, chk_stage.VndTyp, chk_stage.VndId, chk_stage.AgentTyp, chk_stage.AgentId, chk_stage.MailToNam, chk_stage.MailToAdr1, chk_stage.MailToAdr2, chk_stage.MailToAdr3, chk_stage.MailToAdr4, chk_stage.MailToAdr5, chk_stage.City, chk_stage.State, chk_stage.CntyCd, chk_stage.CountryId, chk_stage.ZipCd, chk_stage.BillState, chk_stage.BillDt, chk_stage.PhNum1, chk_stage.PhNum2, chk_stage.FaxNum, chk_stage.FaxNumTyp, chk_stage.FaxToNam, chk_stage.EmailAdr, chk_stage.MrgId, chk_stage.MrgId2, chk_stage.PayCd, chk_stage.PayToCd, chk_stage.ReqId, chk_stage.ExamId, chk_stage.ExamNam, chk_stage.AdjId, chk_stage.CurId, chk_stage.Office, chk_stage.DeptCd, chk_stage.MailStop, chk_stage.ReissCd, chk_stage.AtchCd, chk_stage.ReqNum, chk_stage.ImpBch, chk_stage.ImpBnkBch, chk_stage.PrtBch, chk_stage.RcnBch, chk_stage.SavRcnBch, chk_stage.ExpBch, chk_stage.PdBch, chk_stage.VoidExpCd, chk_stage.PrevVoidExpCd, chk_stage.WriteOffExpCd, chk_stage.SrchLtrCd, chk_stage.PrtCnt, chk_stage.RcnCd, chk_stage.VoidCd, chk_stage.VoidId, chk_stage.VoidDt, chk_stage.UnVoidCd, chk_stage.UnVoidId, chk_stage.UnVoidDt, chk_stage.SigCd, chk_stage.SigCd1, chk_stage.SigCd2, chk_stage.DrftCd, chk_stage.DscCd, chk_stage.RestCd, chk_stage.XCd1, chk_stage.XCd2, chk_stage.XCd3, chk_stage.XCd4, chk_stage.XCd5, chk_stage.XCd6, chk_stage.XCd7, chk_stage.XCd8, chk_stage.XCd9, chk_stage.XCd10, chk_stage.PayRate, chk_stage.XRate1, chk_stage.XRate2, chk_stage.XRate3, chk_stage.XAmt1, chk_stage.XAmt2, chk_stage.XAmt3, chk_stage.XAmt4, chk_stage.XAmt5, chk_stage.XAmt6, chk_stage.XAmt7, chk_stage.XAmt8, chk_stage.XAmt9, chk_stage.XAmt10, chk_stage.SalaryAmt, chk_stage.MaritalStat, chk_stage.FedExempt, chk_stage.StateExempt, chk_stage.Day30Cd, chk_stage.PstCd, chk_stage.RsnCd, chk_stage.PdCd, chk_stage.PdDt, chk_stage.ApprovCd, chk_stage.ApprovDt, chk_stage.ApprovId, chk_stage.ApprovCd2, chk_stage.ApprovDt2, chk_stage.ApprovId2, chk_stage.ApprovCd3, chk_stage.ApprovDt3, chk_stage.ApprovId3, chk_stage.ApprovCd4, chk_stage.ApprovDt4, chk_stage.ApprovId4, chk_stage.ApprovCd5, chk_stage.ApprovDt5, chk_stage.ApprovId5, chk_stage.ApprovCd6, chk_stage.ApprovDt6, chk_stage.ApprovId6, chk_stage.ApprovCd7, chk_stage.ApprovDt7, chk_stage.ApprovId7, chk_stage.ApprovCd8, chk_stage.ApprovDt8, chk_stage.ApprovId8, chk_stage.ApprovCd9, chk_stage.ApprovDt9, chk_stage.ApprovId9, chk_stage.AddDt, chk_stage.AddTime, chk_stage.AddId, chk_stage.ChgDt, chk_stage.ChgTime, chk_stage.ChgId, chk_stage.SrceCd, chk_stage.FrmCd, chk_stage.RefNum, chk_stage.NamTyp, chk_stage.LstNam, chk_stage.FstNam, chk_stage.MidInit, chk_stage.Salutation, chk_stage.AcctNum, chk_stage.ExpAcct, chk_stage.DebitAcct, chk_stage.BnkAcct, chk_stage.BnkRout, chk_stage.AcctNam, chk_stage.EftTypCd, chk_stage.BnkAcct2, chk_stage.BnkRout2, chk_stage.AcctNam2, chk_stage.EftTypCd2, chk_stage.BnkAcct3, chk_stage.BnkRout3, chk_stage.AcctNam3, chk_stage.EftTypCd3, chk_stage.AllocPct1, chk_stage.AllocPct2, chk_stage.AllocPct3, chk_stage.OptCd, chk_stage.EftTranCd, chk_stage.AdviceTyp, chk_stage.RepRsn, chk_stage.EmployerTyp, chk_stage.EmployerId, chk_stage.EmployerNam, chk_stage.EmployerAdr1, chk_stage.EmployerAdr2, chk_stage.EmployerAdr3, chk_stage.ProviderTyp, chk_stage.ProviderId, chk_stage.ProviderNam, chk_stage.CarrierTyp, chk_stage.CarrierId, chk_stage.PolId, chk_stage.InsNam, chk_stage.InsAdr1, chk_stage.InsAdr2, chk_stage.InsAdr3, chk_stage.ClaimNum, chk_stage.ClmntNum, chk_stage.ClmntNam, chk_stage.ClmntAdr1, chk_stage.ClmntAdr2, chk_stage.ClmntAdr3, chk_stage.LosCause, chk_stage.DiagCd1, chk_stage.DiagCd2, chk_stage.DiagCd3, chk_stage.DiagCd4, chk_stage.ForRsn1, chk_stage.ForRsn2, chk_stage.ForRsn3, chk_stage.CommentTxt, chk_stage.XNum1, chk_stage.XNum2, chk_stage.XNum3, chk_stage.XNum4, chk_stage.TransferOutBch, chk_stage.TransferInBch, chk_stage.VchCnt, chk_stage.PrtDt, chk_stage.PrtId, chk_stage.TranDt, chk_stage.TranTime, chk_stage.TranTyp, chk_stage.TranId, chk_stage.BTpId, chk_stage.ExamTyp, chk_stage.Priority, chk_stage.DeliveryDt, chk_stage.CardNum, chk_stage.CardTyp, chk_stage.ExportStat, chk_stage.PrevExportStat, chk_stage.extract_date, chk_stage.as_of_Date, chk_stage.record_count, chk_stage.source_system_id 
	FROM
	 chk_stage
	WHERE
	DATEADD(dd, chk_stage.AddDt, '12/28/1800') >= '@{pipeline().parameters.SELECTION_START_TS}'
	OR
	DATEADD(dd, chk_stage.ChgDt, '12/28/1800') >= '@{pipeline().parameters.SELECTION_START_TS}'
),
EXP_AUDIT_FIELDS AS (
	SELECT
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP,
	Chk_stage_id,
	RecordId,
	CTpId,
	Id,
	OrigId,
	AltSrt,
	AltSrt1,
	IdPre,
	ModVer,
	ModCd,
	CmpId,
	PayToNam1,
	PayToNam2,
	PayToNam3,
	IssDt,
	PayAmt,
	OrigPayAmt,
	ResrvAmt,
	BnkId,
	BnkNum,
	LosDt,
	Dt1,
	Dt2,
	Dt3,
	Dt4,
	Dt5,
	Time1,
	Time2,
	TranCd,
	TaxId,
	TaxTyp,
	Tax1099,
	RptAmt1099,
	SpltPay1099,
	VndTyp,
	VndId,
	AgentTyp,
	AgentId,
	MailToNam,
	MailToAdr1,
	MailToAdr2,
	MailToAdr3,
	MailToAdr4,
	MailToAdr5,
	City,
	State,
	CntyCd,
	CountryId,
	ZipCd,
	BillState,
	BillDt,
	PhNum1,
	PhNum2,
	FaxNum,
	FaxNumTyp,
	FaxToNam,
	EmailAdr,
	MrgId,
	MrgId2,
	PayCd,
	PayToCd,
	ReqId,
	ExamId,
	ExamNam,
	AdjId,
	CurId,
	Office,
	DeptCd,
	MailStop,
	ReissCd,
	AtchCd,
	ReqNum,
	ImpBch,
	ImpBnkBch,
	PrtBch,
	RcnBch,
	SavRcnBch,
	ExpBch,
	PdBch,
	VoidExpCd,
	PrevVoidExpCd,
	WriteOffExpCd,
	SrchLtrCd,
	PrtCnt,
	RcnCd,
	VoidCd,
	VoidId,
	VoidDt,
	UnVoidCd,
	UnVoidId,
	UnVoidDt,
	SigCd,
	SigCd1,
	SigCd2,
	DrftCd,
	DscCd,
	RestCd,
	XCd1,
	XCd2,
	XCd3,
	XCd4,
	XCd5,
	XCd6,
	XCd7,
	XCd8,
	XCd9,
	XCd10,
	PayRate,
	XRate1,
	XRate2,
	XRate3,
	XAmt1,
	XAmt2,
	XAmt3,
	XAmt4,
	XAmt5,
	XAmt6,
	XAmt7,
	XAmt8,
	XAmt9,
	XAmt10,
	SalaryAmt,
	MaritalStat,
	FedExempt,
	StateExempt,
	Day30Cd,
	PstCd,
	RsnCd,
	PdCd,
	PdDt,
	ApprovCd,
	ApprovDt,
	ApprovId,
	ApprovCd2,
	ApprovDt2,
	ApprovId2,
	ApprovCd3,
	ApprovDt3,
	ApprovId3,
	ApprovCd4,
	ApprovDt4,
	ApprovId4,
	ApprovCd5,
	ApprovDt5,
	ApprovId5,
	ApprovCd6,
	ApprovDt6,
	ApprovId6,
	ApprovCd7,
	ApprovDt7,
	ApprovId7,
	ApprovCd8,
	ApprovDt8,
	ApprovId8,
	ApprovCd9,
	ApprovDt9,
	ApprovId9,
	AddDt,
	AddTime,
	AddId,
	ChgDt,
	ChgTime,
	ChgId,
	SrceCd,
	FrmCd,
	RefNum,
	NamTyp,
	LstNam,
	FstNam,
	MidInit,
	Salutation,
	AcctNum,
	ExpAcct,
	DebitAcct,
	BnkAcct,
	BnkRout,
	AcctNam,
	EftTypCd,
	BnkAcct2,
	BnkRout2,
	AcctNam2,
	EftTypCd2,
	BnkAcct3,
	BnkRout3,
	AcctNam3,
	EftTypCd3,
	AllocPct1,
	AllocPct2,
	AllocPct3,
	OptCd,
	EftTranCd,
	AdviceTyp,
	RepRsn,
	EmployerTyp,
	EmployerId,
	EmployerNam,
	EmployerAdr1,
	EmployerAdr2,
	EmployerAdr3,
	ProviderTyp,
	ProviderId,
	ProviderNam,
	CarrierTyp,
	CarrierId,
	PolId,
	InsNam,
	InsAdr1,
	InsAdr2,
	InsAdr3,
	ClaimNum,
	ClmntNum,
	ClmntNam,
	ClmntAdr1,
	ClmntAdr2,
	ClmntAdr3,
	LosCause,
	DiagCd1,
	DiagCd2,
	DiagCd3,
	DiagCd4,
	ForRsn1,
	ForRsn2,
	ForRsn3,
	CommentTxt,
	XNum1,
	XNum2,
	XNum3,
	XNum4,
	TransferOutBch,
	TransferInBch,
	VchCnt,
	PrtDt,
	PrtId,
	TranDt,
	TranTime,
	TranTyp,
	TranId,
	BTpId,
	ExamTyp,
	Priority,
	DeliveryDt,
	CardNum,
	CardTyp,
	ExportStat,
	PrevExportStat,
	extract_date,
	as_of_Date,
	record_count,
	source_system_id
	FROM SQ_chk_stage
),
arch_chk_stage AS (
	INSERT INTO arch_chk_stage
	(Chk_stage_id, RecordId, CTpId, Id, OrigId, AltSrt, AltSrt1, IdPre, ModVer, ModCd, CmpId, PayToNam1, PayToNam2, PayToNam3, IssDt, PayAmt, OrigPayAmt, ResrvAmt, BnkId, BnkNum, LosDt, Dt1, Dt2, Dt3, Dt4, Dt5, Time1, Time2, TranCd, TaxId, TaxTyp, Tax1099, RptAmt1099, SpltPay1099, VndTyp, VndId, AgentTyp, AgentId, MailToNam, MailToAdr1, MailToAdr2, MailToAdr3, MailToAdr4, MailToAdr5, City, State, CntyCd, CountryId, ZipCd, BillState, BillDt, PhNum1, PhNum2, FaxNum, FaxNumTyp, FaxToNam, EmailAdr, MrgId, MrgId2, PayCd, PayToCd, ReqId, ExamId, ExamNam, AdjId, CurId, Office, DeptCd, MailStop, ReissCd, AtchCd, ReqNum, ImpBch, ImpBnkBch, PrtBch, RcnBch, SavRcnBch, ExpBch, PdBch, VoidExpCd, PrevVoidExpCd, WriteOffExpCd, SrchLtrCd, PrtCnt, RcnCd, VoidCd, VoidId, VoidDt, UnVoidCd, UnVoidId, UnVoidDt, SigCd, SigCd1, SigCd2, DrftCd, DscCd, RestCd, XCd1, XCd2, XCd3, XCd4, XCd5, XCd6, XCd7, XCd8, XCd9, XCd10, PayRate, XRate1, XRate2, XRate3, XAmt1, XAmt2, XAmt3, XAmt4, XAmt5, XAmt6, XAmt7, XAmt8, XAmt9, XAmt10, SalaryAmt, MaritalStat, FedExempt, StateExempt, Day30Cd, PstCd, RsnCd, PdCd, PdDt, ApprovCd, ApprovDt, ApprovId, ApprovCd2, ApprovDt2, ApprovId2, ApprovCd3, ApprovDt3, ApprovId3, ApprovCd4, ApprovDt4, ApprovId4, ApprovCd5, ApprovDt5, ApprovId5, ApprovCd6, ApprovDt6, ApprovId6, ApprovCd7, ApprovDt7, ApprovId7, ApprovCd8, ApprovDt8, ApprovId8, ApprovCd9, ApprovDt9, ApprovId9, AddDt, AddTime, AddId, ChgDt, ChgTime, ChgId, SrceCd, FrmCd, RefNum, NamTyp, LstNam, FstNam, MidInit, Salutation, AcctNum, ExpAcct, DebitAcct, BnkAcct, BnkRout, AcctNam, EftTypCd, BnkAcct2, BnkRout2, AcctNam2, EftTypCd2, BnkAcct3, BnkRout3, AcctNam3, EftTypCd3, AllocPct1, AllocPct2, AllocPct3, OptCd, EftTranCd, AdviceTyp, RepRsn, EmployerTyp, EmployerId, EmployerNam, EmployerAdr1, EmployerAdr2, EmployerAdr3, ProviderTyp, ProviderId, ProviderNam, CarrierTyp, CarrierId, PolId, InsNam, InsAdr1, InsAdr2, InsAdr3, ClaimNum, ClmntNum, ClmntNam, ClmntAdr1, ClmntAdr2, ClmntAdr3, LosCause, DiagCd1, DiagCd2, DiagCd3, DiagCd4, ForRsn1, ForRsn2, ForRsn3, CommentTxt, XNum1, XNum2, XNum3, XNum4, TransferOutBch, TransferInBch, VchCnt, PrtDt, PrtId, TranDt, TranTime, TranTyp, TranId, BTpId, ExamTyp, Priority, DeliveryDt, CardNum, CardTyp, ExportStat, PrevExportStat, extract_date, as_of_Date, record_count, source_system_id, audit_id)
	SELECT 
	CHK_STAGE_ID, 
	RECORDID, 
	CTPID, 
	ID, 
	ORIGID, 
	ALTSRT, 
	ALTSRT1, 
	IDPRE, 
	MODVER, 
	MODCD, 
	CMPID, 
	PAYTONAM1, 
	PAYTONAM2, 
	PAYTONAM3, 
	ISSDT, 
	PAYAMT, 
	ORIGPAYAMT, 
	RESRVAMT, 
	BNKID, 
	BNKNUM, 
	LOSDT, 
	DT1, 
	DT2, 
	DT3, 
	DT4, 
	DT5, 
	TIME1, 
	TIME2, 
	TRANCD, 
	TAXID, 
	TAXTYP, 
	TAX1099, 
	RPTAMT1099, 
	SPLTPAY1099, 
	VNDTYP, 
	VNDID, 
	AGENTTYP, 
	AGENTID, 
	MAILTONAM, 
	MAILTOADR1, 
	MAILTOADR2, 
	MAILTOADR3, 
	MAILTOADR4, 
	MAILTOADR5, 
	CITY, 
	STATE, 
	CNTYCD, 
	COUNTRYID, 
	ZIPCD, 
	BILLSTATE, 
	BILLDT, 
	PHNUM1, 
	PHNUM2, 
	FAXNUM, 
	FAXNUMTYP, 
	FAXTONAM, 
	EMAILADR, 
	MRGID, 
	MRGID2, 
	PAYCD, 
	PAYTOCD, 
	REQID, 
	EXAMID, 
	EXAMNAM, 
	ADJID, 
	CURID, 
	OFFICE, 
	DEPTCD, 
	MAILSTOP, 
	REISSCD, 
	ATCHCD, 
	REQNUM, 
	IMPBCH, 
	IMPBNKBCH, 
	PRTBCH, 
	RCNBCH, 
	SAVRCNBCH, 
	EXPBCH, 
	PDBCH, 
	VOIDEXPCD, 
	PREVVOIDEXPCD, 
	WRITEOFFEXPCD, 
	SRCHLTRCD, 
	PRTCNT, 
	RCNCD, 
	VOIDCD, 
	VOIDID, 
	VOIDDT, 
	UNVOIDCD, 
	UNVOIDID, 
	UNVOIDDT, 
	SIGCD, 
	SIGCD1, 
	SIGCD2, 
	DRFTCD, 
	DSCCD, 
	RESTCD, 
	XCD1, 
	XCD2, 
	XCD3, 
	XCD4, 
	XCD5, 
	XCD6, 
	XCD7, 
	XCD8, 
	XCD9, 
	XCD10, 
	PAYRATE, 
	XRATE1, 
	XRATE2, 
	XRATE3, 
	XAMT1, 
	XAMT2, 
	XAMT3, 
	XAMT4, 
	XAMT5, 
	XAMT6, 
	XAMT7, 
	XAMT8, 
	XAMT9, 
	XAMT10, 
	SALARYAMT, 
	MARITALSTAT, 
	FEDEXEMPT, 
	STATEEXEMPT, 
	DAY30CD, 
	PSTCD, 
	RSNCD, 
	PDCD, 
	PDDT, 
	APPROVCD, 
	APPROVDT, 
	APPROVID, 
	APPROVCD2, 
	APPROVDT2, 
	APPROVID2, 
	APPROVCD3, 
	APPROVDT3, 
	APPROVID3, 
	APPROVCD4, 
	APPROVDT4, 
	APPROVID4, 
	APPROVCD5, 
	APPROVDT5, 
	APPROVID5, 
	APPROVCD6, 
	APPROVDT6, 
	APPROVID6, 
	APPROVCD7, 
	APPROVDT7, 
	APPROVID7, 
	APPROVCD8, 
	APPROVDT8, 
	APPROVID8, 
	APPROVCD9, 
	APPROVDT9, 
	APPROVID9, 
	ADDDT, 
	ADDTIME, 
	ADDID, 
	CHGDT, 
	CHGTIME, 
	CHGID, 
	SRCECD, 
	FRMCD, 
	REFNUM, 
	NAMTYP, 
	LSTNAM, 
	FSTNAM, 
	MIDINIT, 
	SALUTATION, 
	ACCTNUM, 
	EXPACCT, 
	DEBITACCT, 
	BNKACCT, 
	BNKROUT, 
	ACCTNAM, 
	EFTTYPCD, 
	BNKACCT2, 
	BNKROUT2, 
	ACCTNAM2, 
	EFTTYPCD2, 
	BNKACCT3, 
	BNKROUT3, 
	ACCTNAM3, 
	EFTTYPCD3, 
	ALLOCPCT1, 
	ALLOCPCT2, 
	ALLOCPCT3, 
	OPTCD, 
	EFTTRANCD, 
	ADVICETYP, 
	REPRSN, 
	EMPLOYERTYP, 
	EMPLOYERID, 
	EMPLOYERNAM, 
	EMPLOYERADR1, 
	EMPLOYERADR2, 
	EMPLOYERADR3, 
	PROVIDERTYP, 
	PROVIDERID, 
	PROVIDERNAM, 
	CARRIERTYP, 
	CARRIERID, 
	POLID, 
	INSNAM, 
	INSADR1, 
	INSADR2, 
	INSADR3, 
	CLAIMNUM, 
	CLMNTNUM, 
	CLMNTNAM, 
	CLMNTADR1, 
	CLMNTADR2, 
	CLMNTADR3, 
	LOSCAUSE, 
	DIAGCD1, 
	DIAGCD2, 
	DIAGCD3, 
	DIAGCD4, 
	FORRSN1, 
	FORRSN2, 
	FORRSN3, 
	COMMENTTXT, 
	XNUM1, 
	XNUM2, 
	XNUM3, 
	XNUM4, 
	TRANSFEROUTBCH, 
	TRANSFERINBCH, 
	VCHCNT, 
	PRTDT, 
	PRTID, 
	TRANDT, 
	TRANTIME, 
	TRANTYP, 
	TRANID, 
	BTPID, 
	EXAMTYP, 
	PRIORITY, 
	DELIVERYDT, 
	CARDNUM, 
	CARDTYP, 
	EXPORTSTAT, 
	PREVEXPORTSTAT, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_AUDIT_FIELDS
),