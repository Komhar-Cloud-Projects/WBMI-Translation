WITH
SQ_WBCFCoverageEquipmentBreakdownStage AS (
	SELECT
		WBCFCoverageEquipmentBreakdownStageId,
		ExtractDate,
		SourceSystemId,
		CoverageId,
		WB_CF_CoverageEquipmentBreakdownId,
		SessionId,
		ARate,
		Blanket,
		BlanketNOCDescription,
		Coinsurance,
		Deductible,
		InceptionDate,
		Indicator,
		OtherFlood,
		OtherFloodOther,
		OtherFloodPrimary,
		Specific,
		SpecificNOCDescription,
		WaiveUnderlyingInsurance,
		EquipmentBreakdownPremiumOverride,
		PriorTermEquipmentBreakdownPremium,
		PerishableGoodsPolicyPremium,
		AlgorithmPart2Display,
		AlgorithmPart1Display,
		AlgorithmPart3Effective2013Display,
		AlgorithmPart3Effective2014Display,
		PremiumDisplay,
		BillingLOB,
		ParentBillingLOB,
		CommissionPlanId,
		TransactionCommissionType,
		TransactionCommissionValue,
		PurePremium,
		TransactionFinalCommissionValue,
		IsBillingSubline,
		AlgorithmPart3Year1TransitionDisplay,
		AlgorithmPart3Year2TransitionDisplay,
		AlgorithmPart3Year1TransitionAdjustmentPremiumDisplay,
		AlgorithmPart3Year2TransitionAdjustmentPremiumDisplay,
		AlgorithmPart3EquipmentBreakdownPremiumDisplay
	FROM WBCFCoverageEquipmentBreakdownStage
),
EXP_Metadata AS (
	SELECT
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,
	WBCFCoverageEquipmentBreakdownStageId,
	ExtractDate,
	SourceSystemId,
	CoverageId,
	WB_CF_CoverageEquipmentBreakdownId,
	SessionId,
	ARate,
	Blanket,
	BlanketNOCDescription,
	Coinsurance,
	Deductible,
	InceptionDate,
	Indicator,
	OtherFlood,
	OtherFloodOther,
	OtherFloodPrimary,
	Specific,
	SpecificNOCDescription,
	WaiveUnderlyingInsurance,
	EquipmentBreakdownPremiumOverride,
	PriorTermEquipmentBreakdownPremium,
	PerishableGoodsPolicyPremium,
	AlgorithmPart2Display,
	AlgorithmPart1Display,
	AlgorithmPart3Effective2013Display,
	AlgorithmPart3Effective2014Display,
	PremiumDisplay,
	BillingLOB,
	ParentBillingLOB,
	CommissionPlanId,
	TransactionCommissionType,
	TransactionCommissionValue,
	PurePremium,
	TransactionFinalCommissionValue,
	IsBillingSubline,
	AlgorithmPart3Year1TransitionDisplay,
	AlgorithmPart3Year2TransitionDisplay,
	AlgorithmPart3Year1TransitionAdjustmentPremiumDisplay,
	AlgorithmPart3Year2TransitionAdjustmentPremiumDisplay,
	AlgorithmPart3EquipmentBreakdownPremiumDisplay
	FROM SQ_WBCFCoverageEquipmentBreakdownStage
),
ArchWBCFCoverageEquipmentBreakdownStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchWBCFCoverageEquipmentBreakdownStage
	(ExtractDate, SourceSystemId, AuditId, WBCFCoverageEquipmentBreakdownStageId, CoverageId, WB_CF_CoverageEquipmentBreakdownId, SessionId, ARate, Blanket, BlanketNOCDescription, Coinsurance, Deductible, InceptionDate, Indicator, OtherFlood, OtherFloodOther, OtherFloodPrimary, Specific, SpecificNOCDescription, WaiveUnderlyingInsurance, EquipmentBreakdownPremiumOverride, PriorTermEquipmentBreakdownPremium, PerishableGoodsPolicyPremium, AlgorithmPart2Display, AlgorithmPart1Display, AlgorithmPart3Effective2013Display, AlgorithmPart3Effective2014Display, PremiumDisplay, BillingLOB, ParentBillingLOB, CommissionPlanId, TransactionCommissionType, TransactionCommissionValue, PurePremium, TransactionFinalCommissionValue, IsBillingSubline, AlgorithmPart3Year1TransitionDisplay, AlgorithmPart3Year2TransitionDisplay, AlgorithmPart3Year1TransitionAdjustmentPremiumDisplay, AlgorithmPart3Year2TransitionAdjustmentPremiumDisplay, AlgorithmPart3EquipmentBreakdownPremiumDisplay)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID, 
	WBCFCOVERAGEEQUIPMENTBREAKDOWNSTAGEID, 
	COVERAGEID, 
	WB_CF_COVERAGEEQUIPMENTBREAKDOWNID, 
	SESSIONID, 
	ARATE, 
	BLANKET, 
	BLANKETNOCDESCRIPTION, 
	COINSURANCE, 
	DEDUCTIBLE, 
	INCEPTIONDATE, 
	INDICATOR, 
	OTHERFLOOD, 
	OTHERFLOODOTHER, 
	OTHERFLOODPRIMARY, 
	SPECIFIC, 
	SPECIFICNOCDESCRIPTION, 
	WAIVEUNDERLYINGINSURANCE, 
	EQUIPMENTBREAKDOWNPREMIUMOVERRIDE, 
	PRIORTERMEQUIPMENTBREAKDOWNPREMIUM, 
	PERISHABLEGOODSPOLICYPREMIUM, 
	ALGORITHMPART2DISPLAY, 
	ALGORITHMPART1DISPLAY, 
	ALGORITHMPART3EFFECTIVE2013DISPLAY, 
	ALGORITHMPART3EFFECTIVE2014DISPLAY, 
	PREMIUMDISPLAY, 
	BILLINGLOB, 
	PARENTBILLINGLOB, 
	COMMISSIONPLANID, 
	TRANSACTIONCOMMISSIONTYPE, 
	TRANSACTIONCOMMISSIONVALUE, 
	PUREPREMIUM, 
	TRANSACTIONFINALCOMMISSIONVALUE, 
	ISBILLINGSUBLINE, 
	ALGORITHMPART3YEAR1TRANSITIONDISPLAY, 
	ALGORITHMPART3YEAR2TRANSITIONDISPLAY, 
	ALGORITHMPART3YEAR1TRANSITIONADJUSTMENTPREMIUMDISPLAY, 
	ALGORITHMPART3YEAR2TRANSITIONADJUSTMENTPREMIUMDISPLAY, 
	ALGORITHMPART3EQUIPMENTBREAKDOWNPREMIUMDISPLAY
	FROM EXP_Metadata
),