{
    "name": "s_m_FEED_Load_AAIS_Extract_File_RemoveDupOnsetOffset",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_AAIS_Extract_File_RemoveDupOnsetOffset",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkAAIS_Loss AS (\n\tSELECT WorkAAISExtract.WorkAAISExtractId, WorkAAISExtract.AuditId, WorkAAISExtract.CreatedDate, WorkAAISExtract.EDWPremiumMasterCalculationPKId, WorkAAISExtract.EDWLossMasterCalculationPKId, WorkAAISExtract.TypeBureauCode, WorkAAISExtract.BureauLineOfInsurance, WorkAAISExtract.PremiumMasterRunDate, WorkAAISExtract.LossMasterRunDate, WorkAAISExtract.BureauCompanyNumber, WorkAAISExtract.PolicyKey, WorkAAISExtract.StateProvinceCode, WorkAAISExtract.RatingCounty, WorkAAISExtract.PremiumMasterDirectWrittenPremiumAmount, WorkAAISExtract.PaidLossAmount, WorkAAISExtract.OutstandingLossAmount, WorkAAISExtract.LossMasterNewClaimCount, WorkAAISExtract.PremiumMasterClassCode, WorkAAISExtract.LossMasterClassCode, WorkAAISExtract.DeductibleAmount, WorkAAISExtract.BureauAnnualStatementLineCode, WorkAAISExtract.BureauOrganizationCode, WorkAAISExtract.TerrorismRiskIndicator, WorkAAISExtract.InlandMarinePropertyAmountOfInsurance, WorkAAISExtract.ConstructionCode, WorkAAISExtract.ISOFireProtectionCode, WorkAAISExtract.InsuranceSegmentDescription, WorkAAISExtract.PolicyOfferingDescription, WorkAAISExtract.PolicyTerm, WorkAAISExtract.CauseOfLossName, WorkAAISExtract.ClaimLossDate, WorkAAISExtract.ZipPostalCode, WorkAAISExtract.CoverageEffectiveDate, WorkAAISExtract.CoverageExpirationDate, WorkAAISExtract.InceptionToDatePaidLossAmount, WorkAAISExtract.ClaimantCoverageDetailId, WorkAAISExtract.ClaimNumber, WorkAAISExtract.AnnualStatementLineNumber \r\n\t, WorkAAISExtract.PaidAllocatedLossAdjustmentExpenseAmount\r\n\t, WorkAAISExtract.OutstandingAllocatedLossAdjustmentExpenseAmount \r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkAAISExtract \r\n\tWHERE\r\n\t WorkAAISExtract.EDWLossMasterCalculationPKId<>-1\r\n\t@{pipeline().parameters.WHERE_CLAUSE_LOSS}\n),\nEXP_Loss AS (\n\tSELECT\n\tWorkAAISExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tBureauCompanyNumber,\n\tPolicyKey,\n\tStateProvinceCode,\n\tRatingCounty,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tLossMasterNewClaimCount,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tDeductibleAmount,\n\tBureauAnnualStatementLineCode,\n\tBureauOrganizationCode,\n\tTerrorismRiskIndicator,\n\tInlandMarinePropertyAmountOfInsurance,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tInsuranceSegmentDescription,\n\tPolicyOfferingDescription,\n\tPolicyTerm,\n\tCauseOfLossName,\n\tClaimLossDate,\n\tZipPostalCode,\n\tCoverageEffectiveDate,\n\tCoverageExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tClaimNumber,\n\tAnnualStatementLineNumber,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM SQ_WorkAAIS_Loss\n),\nSQ_WorkAAIS_Prem_Unique AS (\n\twith prem_unique as\r\n\t\t(select CONCAT(\r\n\t\tTypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber) as concct, count(*) count from @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkAAISExtract\r\n\t\t\twhere EDWPremiumMasterCalculationPKId<>-1\r\n\t\t\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\r\n\t\t\t\r\n\t\t\tgroup by CONCAT(\r\n\t\tTypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber) having count(*)=1)\r\n\t\t\r\n\t\tselect distinct WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber\r\n\t\t,PaidAllocatedLossAdjustmentExpenseAmount,OutstandingAllocatedLossAdjustmentExpenseAmount\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkAAISExtract WorkAAISExtract join prem_unique b\r\n\t\ton (CONCAT(\r\n\t\tTypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber)=b.concct)\r\n\t\twhere WorkAAISExtract.EDWPremiumMasterCalculationPKId<>-1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\n),\nEXP_PremUnique AS (\n\tSELECT\n\tWorkAAISExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tBureauCompanyNumber,\n\tPolicyKey,\n\tStateProvinceCode,\n\tRatingCounty,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tLossMasterNewClaimCount,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tDeductibleAmount,\n\tBureauAnnualStatementLineCode,\n\tBureauOrganizationCode,\n\tTerrorismRiskIndicator,\n\tInlandMarinePropertyAmountOfInsurance,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tInsuranceSegmentDescription,\n\tPolicyOfferingDescription,\n\tPolicyTerm,\n\tCauseOfLossName,\n\tClaimLossDate,\n\tZipPostalCode,\n\tCoverageEffectiveDate,\n\tCoverageExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tClaimNumber,\n\tAnnualStatementLineNumber,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM SQ_WorkAAIS_Prem_Unique\n),\nSQ_WorkAAIS_Premium_Dup AS (\n\tWITH ROLLUP_TABLE_TEMP\r\n\tAS\r\n\t(SELECT\r\n\t\t\tSUM(PremiumMasterDirectWrittenPremiumAmount) ROLL_UP_DWP_AMT\r\n\t\t\t,MAX(WorkAAISExtractId) MAX_ISS_KEY\r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkAAISExtract a\r\n\t\tWHERE a.EDWPremiumMasterCalculationPKId <> -1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_PREMIUM}\r\n\t\tGROUP BY CONCAT(\r\n\t\tTypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey,\r\n\t\tStateProvinceCode, RatingCounty, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode,\r\n\t\tLossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator,\r\n\t\tInlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription,\r\n\t\tPolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate,\r\n\t\tCoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber)\r\n\t\tHAVING COUNT(1) > 1\r\n\t\tAND SUM(PremiumMasterDirectWrittenPremiumAmount) <> 0)\r\n\t\r\n\t\r\n\tSELECT\r\n\t\tWorkAAISExtract.WorkAAISExtractId\r\n\t\t,WorkAAISExtract.AuditId\r\n\t\t,WorkAAISExtract.CreatedDate\r\n\t\t,WorkAAISExtract.EDWPremiumMasterCalculationPKId\r\n\t\t,WorkAAISExtract.EDWLossMasterCalculationPKId\r\n\t\t,WorkAAISExtract.TypeBureauCode\r\n\t\t,WorkAAISExtract.BureauLineOfInsurance\r\n\t\t,WorkAAISExtract.PremiumMasterRunDate\r\n\t\t,WorkAAISExtract.LossMasterRunDate\r\n\t\t,WorkAAISExtract.BureauCompanyNumber\r\n\t\t,WorkAAISExtract.PolicyKey\r\n\t\t,WorkAAISExtract.StateProvinceCode\r\n\t\t,WorkAAISExtract.RatingCounty\r\n\t\t,ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT AS PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,WorkAAISExtract.PaidLossAmount\r\n\t\t,WorkAAISExtract.OutstandingLossAmount\r\n\t\t,WorkAAISExtract.LossMasterNewClaimCount\r\n\t\t,WorkAAISExtract.PremiumMasterClassCode\r\n\t\t,WorkAAISExtract.LossMasterClassCode\r\n\t\t,WorkAAISExtract.DeductibleAmount\r\n\t\t,WorkAAISExtract.BureauAnnualStatementLineCode\r\n\t\t,WorkAAISExtract.BureauOrganizationCode\r\n\t\t,WorkAAISExtract.TerrorismRiskIndicator\r\n\t\t,WorkAAISExtract.InlandMarinePropertyAmountOfInsurance\r\n\t\t,WorkAAISExtract.ConstructionCode\r\n\t\t,WorkAAISExtract.ISOFireProtectionCode\r\n\t\t,WorkAAISExtract.InsuranceSegmentDescription\r\n\t\t,WorkAAISExtract.PolicyOfferingDescription\r\n\t\t,WorkAAISExtract.PolicyTerm\r\n\t\t,WorkAAISExtract.CauseOfLossName\r\n\t\t,WorkAAISExtract.ClaimLossDate\r\n\t\t,WorkAAISExtract.ZipPostalCode\r\n\t\t,WorkAAISExtract.CoverageEffectiveDate\r\n\t\t,WorkAAISExtract.CoverageExpirationDate\r\n\t\t,WorkAAISExtract.InceptionToDatePaidLossAmount\r\n\t\t,WorkAAISExtract.ClaimantCoverageDetailId\r\n\t\t,WorkAAISExtract.ClaimNumber\r\n\t\t,WorkAAISExtract.AnnualStatementLineNumber\r\n\t      ,WorkAAISExtract.PaidAllocatedLossAdjustmentExpenseAmount\r\n\t      ,WorkAAISExtract.OutstandingAllocatedLossAdjustmentExpenseAmount\r\n\tFROM ROLLUP_TABLE_TEMP\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.WorkAAISExtract WorkAAISExtract\r\n\t\tON WorkAAISExtract.WorkAAISExtractId = ROLLUP_TABLE_TEMP.MAX_ISS_KEY\n),\nEXP_PremiumDup AS (\n\tSELECT\n\tWorkAAISExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tBureauCompanyNumber,\n\tPolicyKey,\n\tStateProvinceCode,\n\tRatingCounty,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tLossMasterNewClaimCount,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tDeductibleAmount,\n\tBureauAnnualStatementLineCode,\n\tBureauOrganizationCode,\n\tTerrorismRiskIndicator,\n\tInlandMarinePropertyAmountOfInsurance,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tInsuranceSegmentDescription,\n\tPolicyOfferingDescription,\n\tPolicyTerm,\n\tCauseOfLossName,\n\tClaimLossDate,\n\tZipPostalCode,\n\tCoverageEffectiveDate,\n\tCoverageExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tClaimNumber,\n\tAnnualStatementLineNumber,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM SQ_WorkAAIS_Premium_Dup\n),\nUnion AS (\n\tSELECT WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM EXP_Loss\n\tUNION\n\tSELECT WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM EXP_PremUnique\n\tUNION\n\tSELECT WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber, PaidAllocatedLossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM EXP_PremiumDup\n),\nEXP_Cleansing AS (\n\tSELECT\n\tWorkAAISExtractId AS i_WorkAAISExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tPolicyKey AS i_PolicyKey,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tRatingCounty AS i_RatingCounty,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tLossMasterNewClaimCount AS i_LossMasterNewClaimCount,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tDeductibleAmount AS i_DeductibleAmount,\n\tBureauAnnualStatementLineCode AS i_BureauAnnualStatementLineCode,\n\tBureauOrganizationCode AS i_BureauOrganizationCode,\n\tTerrorismRiskIndicator AS i_TerrorismRiskIndicator,\n\tInlandMarinePropertyAmountOfInsurance AS i_InlandMarinePropertyAmountOfInsurance,\n\tConstructionCode AS i_ConstructionCode,\n\tISOFireProtectionCode AS i_ISOFireProtectionCode,\n\tInsuranceSegmentDescription AS i_InsuranceSegmentDescription,\n\tPolicyOfferingDescription AS i_PolicyOfferingDescription,\n\tPolicyTerm AS i_PolicyTerm,\n\tCauseOfLossName AS i_CauseOfLossName,\n\tClaimLossDate AS i_ClaimLossDate,\n\tZipPostalCode AS i_ZipPostalCode,\n\tCoverageEffectiveDate AS i_CoverageEffectiveDate,\n\tCoverageExpirationDate AS i_CoverageExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tClaimNumber AS i_ClaimNumber,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tPaidAllocatedLossAdjustmentExpenseAmount AS i_PaidAllocatedLossAdjustmentExpenseAmount,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount AS i_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\ti_WorkAAISExtractId AS o_WorkAAISExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: RTRIM(LTRIM(i_TypeBureauCode))\n\tRTRIM(LTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauLineOfInsurance))\n\tRTRIM(LTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: RTRIM(LTRIM(i_BureauCompanyNumber))\n\tRTRIM(LTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyKey))\n\tRTRIM(LTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: RTRIM(LTRIM(i_StateProvinceCode))\n\tRTRIM(LTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\t-- *INF*: RTRIM(LTRIM(i_RatingCounty))\n\tRTRIM(LTRIM(i_RatingCounty)) AS o_RatingCounty,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_LossMasterNewClaimCount AS o_LossMasterNewClaimCount,\n\t-- *INF*: RTRIM(LTRIM(i_PremiumMasterClassCode))\n\tRTRIM(LTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossMasterClassCode))\n\tRTRIM(LTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_DeductibleAmount))\n\tRTRIM(LTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: RTRIM(LTRIM(i_BureauAnnualStatementLineCode))\n\tRTRIM(LTRIM(i_BureauAnnualStatementLineCode)) AS o_BureauAnnualStatementLineCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauOrganizationCode))\n\tRTRIM(LTRIM(i_BureauOrganizationCode)) AS o_BureauOrganizationCode,\n\t-- *INF*: RTRIM(LTRIM(i_TerrorismRiskIndicator))\n\tRTRIM(LTRIM(i_TerrorismRiskIndicator)) AS o_TerrorismRiskIndicator,\n\t-- *INF*: RTRIM(LTRIM(i_InlandMarinePropertyAmountOfInsurance))\n\tRTRIM(LTRIM(i_InlandMarinePropertyAmountOfInsurance)) AS o_InlandMarinePropertyAmountOfInsurance,\n\t-- *INF*: RTRIM(LTRIM(i_ConstructionCode))\n\tRTRIM(LTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: RTRIM(LTRIM(i_ISOFireProtectionCode))\n\tRTRIM(LTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: RTRIM(LTRIM(i_InsuranceSegmentDescription))\n\tRTRIM(LTRIM(i_InsuranceSegmentDescription)) AS o_InsuranceSegmentDescription,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyOfferingDescription))\n\tRTRIM(LTRIM(i_PolicyOfferingDescription)) AS o_PolicyOfferingDescription,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyTerm))\n\tRTRIM(LTRIM(i_PolicyTerm)) AS o_PolicyTerm,\n\t-- *INF*: RTRIM(LTRIM(i_CauseOfLossName))\n\tRTRIM(LTRIM(i_CauseOfLossName)) AS o_CauseOfLossName,\n\ti_ClaimLossDate AS o_ClaimLossDate,\n\t-- *INF*: RTRIM(LTRIM(i_ZipPostalCode))\n\tRTRIM(LTRIM(i_ZipPostalCode)) AS o_ZipPostalCode,\n\ti_CoverageEffectiveDate AS o_CoverageEffectiveDate,\n\ti_CoverageExpirationDate AS o_CoverageExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailId,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimNumber))\n\tRTRIM(LTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: IIF(ISNULL(i_AnnualStatementLineNumber),'N/A',RTRIM(LTRIM(i_AnnualStatementLineNumber)))\n\tIFF(i_AnnualStatementLineNumber IS NULL, 'N/A', RTRIM(LTRIM(i_AnnualStatementLineNumber))) AS o_AnnualStatementLineNumber,\n\ti_PaidAllocatedLossAdjustmentExpenseAmount AS o_PaidAllocatedLossAdjustmentExpenseAmount,\n\ti_OutstandingAllocatedLossAdjustmentExpenseAmount AS o_OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM Union\n),\nEXP_Append_Filename AS (\n\tSELECT\n\t-- *INF*: TO_CHAR(TRUNC(sysdate,'DD'),'YYYYMMDD')\n\tTO_CHAR(CAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)), 'YYYYMMDD') AS v_RunDate,\n\t'InlandMarine_' || v_RunDate || '.CSV' AS FileName,\n\to_WorkAAISExtractId AS WorkAAISExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_PolicyKey AS PolicyKey,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_RatingCounty AS RatingCounty,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_LossMasterNewClaimCount AS LossMasterNewClaimCount,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_BureauAnnualStatementLineCode AS BureauAnnualStatementLineCode,\n\to_BureauOrganizationCode AS BureauOrganizationCode,\n\to_TerrorismRiskIndicator AS TerrorismRiskIndicator,\n\to_InlandMarinePropertyAmountOfInsurance AS InlandMarinePropertyAmountOfInsurance,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_InsuranceSegmentDescription AS InsuranceSegmentDescription,\n\to_PolicyOfferingDescription AS PolicyOfferingDescription,\n\to_PolicyTerm AS PolicyTerm,\n\to_CauseOfLossName AS CauseOfLossName,\n\to_ClaimLossDate AS ClaimLossDate,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_CoverageEffectiveDate AS CoverageEffectiveDate,\n\to_CoverageExpirationDate AS CoverageExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailId AS ClaimantCoverageDetailId,\n\to_ClaimNumber AS ClaimNumber,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_PaidAllocatedLossAdjustmentExpenseAmount,\n\to_OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM EXP_Cleansing\n),\nSRT_AAIS_Flatfile AS (\n\tSELECT\n\tFileName, \n\tWorkAAISExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tBureauCompanyNumber, \n\tPolicyKey, \n\tStateProvinceCode, \n\tRatingCounty, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tLossMasterNewClaimCount, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tDeductibleAmount, \n\tBureauAnnualStatementLineCode, \n\tBureauOrganizationCode, \n\tTerrorismRiskIndicator, \n\tInlandMarinePropertyAmountOfInsurance, \n\tConstructionCode, \n\tISOFireProtectionCode, \n\tInsuranceSegmentDescription, \n\tPolicyOfferingDescription, \n\tPolicyTerm, \n\tCauseOfLossName, \n\tClaimLossDate, \n\tCoverageEffectiveDate, \n\tCoverageExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailId, \n\tClaimNumber, \n\tAnnualStatementLineNumber, \n\tZipPostalCode, \n\to_PaidAllocatedLossAdjustmentExpenseAmount, \n\to_OutstandingAllocatedLossAdjustmentExpenseAmount\n\tFROM EXP_Append_Filename\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nAAISFlatFile AS (\n\tINSERT INTO AAISFlatFile\n\t(FileName, WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PaidAllocatedlossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber)\n\tSELECT \n\tFILENAME, \n\tWORKAAISEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tBUREAUCOMPANYNUMBER, \n\tPOLICYKEY, \n\tSTATEPROVINCECODE, \n\tRATINGCOUNTY, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\to_PaidAllocatedLossAdjustmentExpenseAmount AS PAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\to_OutstandingAllocatedLossAdjustmentExpenseAmount AS OUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tLOSSMASTERNEWCLAIMCOUNT, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tDEDUCTIBLEAMOUNT, \n\tBUREAUANNUALSTATEMENTLINECODE, \n\tBUREAUORGANIZATIONCODE, \n\tTERRORISMRISKINDICATOR, \n\tINLANDMARINEPROPERTYAMOUNTOFINSURANCE, \n\tCONSTRUCTIONCODE, \n\tISOFIREPROTECTIONCODE, \n\tINSURANCESEGMENTDESCRIPTION, \n\tPOLICYOFFERINGDESCRIPTION, \n\tPOLICYTERM, \n\tCAUSEOFLOSSNAME, \n\tCLAIMLOSSDATE, \n\tZIPPOSTALCODE, \n\tCOVERAGEEFFECTIVEDATE, \n\tCOVERAGEEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tCLAIMNUMBER, \n\tANNUALSTATEMENTLINENUMBER\n\tFROM SRT_AAIS_Flatfile\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_LOSS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_PREMIUM": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}