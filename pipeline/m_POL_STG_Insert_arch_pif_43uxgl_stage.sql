WITH
SQ_Pif43UXGLStage AS (
	SELECT
		Pif43UXGLStageId,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		Pmduxg1RecLength,
		Pmduxg1ActionCode,
		Pmduxg1FileId,
		Pmduxg1SegmentId,
		Pmduxg1SegmentStatus,
		Pmduxg1YearTransaction,
		Pmduxg1MonthTransaction,
		Pmduxg1DayTransaction,
		Pmduxg1SegmentLevelCode,
		Pmduxg1SegmentPartCode,
		Pmduxg1SubPartCode,
		Pmduxg1InsuranceLine,
		Pmduxg1LocationNumber,
		Pmduxg1PmsDefGlSubline,
		Pmduxg1ClassCodeGroup,
		Pmduxg1ClassCodeMember,
		Pmduxg1ClassCode,
		Pmduxg1RiskSequence,
		Pmduxg1RiskTypeInd,
		Pmduxg1YearItemEffective,
		Pmduxg1MonthItemEffective,
		Pmduxg1DayItemEffective,
		Pmduxg1AddInterestType,
		Pmduxg1AddInterestSeq,
		Pmduxg1ProdwCovType,
		Pmduxg1YearProcess,
		Pmduxg1MonthProcess,
		Pmduxg1DayProcess,
		Pmduxg1ExposureAmount,
		Pmduxg1RatingClass,
		Pmduxg1IncLimitTableInd,
		Pmduxg1ClassDescSource,
		Pmduxg1YearInTransition,
		Pmduxg1ExposureIndicator,
		Pmduxg1RatingState,
		Pmduxg1Territory,
		Pmduxg1CoOwnRspLiabInd,
		Pmduxg1MtgeeAssgnLiabInd,
		Pmduxg1CntlIntInd,
		Pmduxg1OwnLandLesdInd,
		Pmduxg1OwnLeseLiabInd,
		Pmduxg1ExectAdminTrstInd,
		Pmduxg1ElectOficCorpInd,
		Pmduxg1GovtUntsOwnInd,
		Pmduxg1FiducCovFiducInd,
		Pmduxg1MbrOfChrchInd,
		Pmduxg1OilGasOpsOwnInd,
		Pmduxg1TrstClrgyInd,
		Pmduxg1SpseOfPartnInd,
		Pmduxg1PrivResBiInd,
		Pmduxg1PrivResAptNumFam,
		Pmduxg1FcltyMbrSchlInd,
		Pmduxg1SchlGovtImmInd,
		Pmduxg1PremBasis,
		Pmduxg1ExposureBasis,
		Pmduxg1YearCvgExpire,
		Pmduxg1MonthCvrExpire,
		Pmduxg1DayCvgExpire,
		Pmduxg1SplitCombinedDedInd,
		Pmduxg1DedAmount,
		Pmduxg1DeductiblePer,
		Pmduxg1DedAmtPd,
		Pmduxg1DeductiblePerPd,
		Pmduxg1PmaCode,
		Pmduxg1ARatesInd,
		Pmduxg1FringeCode1,
		Pmduxg1FringeCode2,
		Pmduxg1FringeCode3,
		Pmduxg1SpecialMedPayInd,
		Pmduxg1SklMinPremInd,
		Pmduxg1ProductsInd,
		Pmduxg1ExtReptPrdMonths,
		Pmduxg1ErpPercent,
		Pmduxg1OldBaseExposure,
		Pmduxg1OldPremiumBasis,
		Pmduxg1DecChangeFlag,
		Pmduxg1ExpoInd,
		Pmduxg1NoDecInd,
		Pmduxg1ClassMinPrem,
		Pmduxg1MunLiabInd,
		Pmduxg1SklMinPrem,
		Pmduxg1StatTerritory,
		Pmduxg1PmscFutureUse,
		Pmduxg1DayCareInd,
		Pmduxg1TranProgInd,
		Pmduxg1LocationChangeInd,
		Pmduxg1AuditClassSw,
		Pmduxg1BroadFormInd,
		Pmduxg1TerrManualOverride,
		Pmduxg1CustFutureUse,
		Pmduxg1BusinessClass,
		Pmduxg1BldgNum,
		Pmduxg1Yr2000CustUse,
		Pmduxg1WbcKey,
		ExtractDate,
		AsOfDate,
		RecordCount,
		SourceSystemId
	FROM Pif43UXGLStage
),
EXP_Values AS (
	SELECT
	Pif43UXGLStageId AS Pif43UXStageId,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	Pmduxg1RecLength,
	Pmduxg1ActionCode,
	Pmduxg1FileId,
	Pmduxg1SegmentId,
	Pmduxg1SegmentStatus,
	Pmduxg1YearTransaction,
	Pmduxg1MonthTransaction,
	Pmduxg1DayTransaction,
	Pmduxg1SegmentLevelCode,
	Pmduxg1SegmentPartCode,
	Pmduxg1SubPartCode,
	Pmduxg1InsuranceLine,
	Pmduxg1LocationNumber,
	Pmduxg1PmsDefGlSubline,
	Pmduxg1ClassCodeGroup,
	Pmduxg1ClassCodeMember,
	Pmduxg1ClassCode,
	Pmduxg1RiskSequence,
	Pmduxg1RiskTypeInd,
	Pmduxg1YearItemEffective AS Pmduxg1YrItemEffective,
	Pmduxg1MonthItemEffective AS Pmduxg1MthItemEffective,
	Pmduxg1DayItemEffective,
	Pmduxg1AddInterestType,
	Pmduxg1AddInterestSeq,
	Pmduxg1ProdwCovType,
	Pmduxg1YearProcess,
	Pmduxg1MonthProcess,
	Pmduxg1DayProcess,
	Pmduxg1ExposureAmount AS Pmduxg1ExposureAmountD,
	Pmduxg1RatingClass,
	Pmduxg1IncLimitTableInd,
	Pmduxg1ClassDescSource,
	Pmduxg1YearInTransition AS Pmduxg1YearInTransitionD,
	Pmduxg1ExposureIndicator,
	Pmduxg1RatingState,
	Pmduxg1Territory,
	Pmduxg1CoOwnRspLiabInd,
	Pmduxg1MtgeeAssgnLiabInd,
	Pmduxg1CntlIntInd,
	Pmduxg1OwnLandLesdInd,
	Pmduxg1OwnLeseLiabInd,
	Pmduxg1ExectAdminTrstInd,
	Pmduxg1ElectOficCorpInd,
	Pmduxg1GovtUntsOwnInd,
	Pmduxg1FiducCovFiducInd,
	Pmduxg1MbrOfChrchInd,
	Pmduxg1OilGasOpsOwnInd,
	Pmduxg1TrstClrgyInd,
	Pmduxg1SpseOfPartnInd,
	Pmduxg1PrivResBiInd,
	Pmduxg1PrivResAptNumFam,
	Pmduxg1FcltyMbrSchlInd,
	Pmduxg1SchlGovtImmInd,
	Pmduxg1PremBasis,
	Pmduxg1ExposureBasis,
	Pmduxg1YearCvgExpire,
	Pmduxg1MonthCvrExpire,
	Pmduxg1DayCvgExpire,
	Pmduxg1SplitCombinedDedInd,
	Pmduxg1DedAmount,
	Pmduxg1DeductiblePer,
	Pmduxg1DedAmtPd,
	Pmduxg1DeductiblePerPd,
	Pmduxg1PmaCode,
	Pmduxg1ARatesInd,
	Pmduxg1FringeCode1,
	Pmduxg1FringeCode2,
	Pmduxg1FringeCode3,
	Pmduxg1SpecialMedPayInd,
	Pmduxg1SklMinPremInd,
	Pmduxg1ProductsInd,
	Pmduxg1ExtReptPrdMonths,
	Pmduxg1ErpPercent,
	Pmduxg1OldBaseExposure,
	Pmduxg1OldPremiumBasis,
	Pmduxg1DecChangeFlag,
	Pmduxg1ExpoInd,
	Pmduxg1NoDecInd,
	Pmduxg1ClassMinPrem,
	Pmduxg1MunLiabInd,
	Pmduxg1SklMinPrem,
	Pmduxg1StatTerritory,
	Pmduxg1PmscFutureUse,
	Pmduxg1DayCareInd,
	Pmduxg1TranProgInd,
	Pmduxg1LocationChangeInd,
	Pmduxg1AuditClassSw,
	Pmduxg1BroadFormInd,
	Pmduxg1TerrManualOverride,
	Pmduxg1CustFutureUse,
	Pmduxg1BusinessClass,
	Pmduxg1BldgNum,
	Pmduxg1Yr2000CustUse,
	Pmduxg1WbcKey,
	ExtractDate,
	AsOfDate,
	RecordCount,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_Pif43UXGLStage
),
TGT_ArchPif43UXGLStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UXGLStage
	(Pif43UXGLStage, PifSymbol, PifPolicyNumber, PifModule, Pmduxg1RecLength, Pmduxg1ActionCode, Pmduxg1FileId, Pmduxg1SegmentId, Pmduxg1SegmentStatus, Pmduxg1YearTransaction, Pmduxg1MonthTransaction, Pmduxg1DayTransaction, Pmduxg1SegmentLevelCode, Pmduxg1SegmentPartCode, Pmduxg1SubPartCode, Pmduxg1InsuranceLine, Pmduxg1LocationNumber, Pmduxg1PmsDefGlSubline, Pmduxg1ClassCodeGroup, Pmduxg1ClassCodeMember, Pmduxg1ClassCode, Pmduxg1RiskSequence, Pmduxg1RiskTypeInd, Pmduxg1YearItemEffective, Pmduxg1MonthItemEffective, Pmduxg1DayItemEffective, Pmduxg1AddInterestType, Pmduxg1AddInterestSeq, Pmduxg1ProdwCovType, Pmduxg1YearProcess, Pmduxg1MonthProcess, Pmduxg1DayProcess, Pmduxg1ExposureAmountD, Pmduxg1RatingClass, Pmduxg1IncLimitTableInd, Pmduxg1ClassDescSource, Pmduxg1YearInTransition, Pmduxg1ExposureIndicator, Pmduxg1RatingState, Pmduxg1Territory, Pmduxg1CoOwnRspLiabInd, Pmduxg1MtgeeAssgnLiabInd, Pmduxg1CntlIntInd, Pmduxg1OwnLandLesdInd, Pmduxg1OwnLeseLiabInd, Pmduxg1ExectAdminTrstInd, Pmduxg1ElectOficCorpInd, Pmduxg1GovtUntsOwnInd, Pmduxg1FiducCovFiducInd, Pmduxg1MbrOfChrchInd, Pmduxg1OilGasOpsOwnInd, Pmduxg1TrstClrgyInd, Pmduxg1SpseOfPartnInd, Pmduxg1PrivResBiInd, Pmduxg1PrivResAptNumFam, Pmduxg1FcltyMbrSchlInd, Pmduxg1SchlGovtImmInd, Pmduxg1PremBasis, Pmduxg1ExposureBasis, Pmduxg1YearCvgExpire, Pmduxg1MonthCvrExpire, Pmduxg1DayCvgExpire, Pmduxg1SplitCombinedDedInd, Pmduxg1DedAmount, Pmduxg1DeductiblePer, Pmduxg1DedAmtPd, Pmduxg1DeductiblePerPd, Pmduxg1PmaCode, Pmduxg1ARatesInd, Pmduxg1FringeCode1, Pmduxg1FringeCode2, Pmduxg1FringeCode3, Pmduxg1SpecialMedPayInd, Pmduxg1SklMinPremInd, Pmduxg1ProductsInd, Pmduxg1ExtReptPrdMonths, Pmduxg1ErpPercent, Pmduxg1OldBaseExposure, Pmduxg1OldPremiumBasis, Pmduxg1DecChangeFlag, Pmduxg1ExpoInd, Pmduxg1NoDecInd, Pmduxg1ClassMinPrem, Pmduxg1MunLiabInd, Pmduxg1SklMinPrem, Pmduxg1StatTerritory, Pmduxg1PmscFutureUse, Pmduxg1DayCareInd, Pmduxg1TranProgInd, Pmduxg1LocationChangeInd, Pmduxg1AuditClassSw, Pmduxg1BroadFormInd, Pmduxg1TerrManualOverride, Pmduxg1CustFutureUse, Pmduxg1BusinessClass, Pmduxg1BldgNum, Pmduxg1Yr2000CustUse, Pmduxg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)
	SELECT 
	Pif43UXStageId AS PIF43UXGLSTAGE, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDUXG1RECLENGTH, 
	PMDUXG1ACTIONCODE, 
	PMDUXG1FILEID, 
	PMDUXG1SEGMENTID, 
	PMDUXG1SEGMENTSTATUS, 
	PMDUXG1YEARTRANSACTION, 
	PMDUXG1MONTHTRANSACTION, 
	PMDUXG1DAYTRANSACTION, 
	PMDUXG1SEGMENTLEVELCODE, 
	PMDUXG1SEGMENTPARTCODE, 
	PMDUXG1SUBPARTCODE, 
	PMDUXG1INSURANCELINE, 
	PMDUXG1LOCATIONNUMBER, 
	PMDUXG1PMSDEFGLSUBLINE, 
	PMDUXG1CLASSCODEGROUP, 
	PMDUXG1CLASSCODEMEMBER, 
	PMDUXG1CLASSCODE, 
	PMDUXG1RISKSEQUENCE, 
	PMDUXG1RISKTYPEIND, 
	Pmduxg1YrItemEffective AS PMDUXG1YEARITEMEFFECTIVE, 
	Pmduxg1MthItemEffective AS PMDUXG1MONTHITEMEFFECTIVE, 
	PMDUXG1DAYITEMEFFECTIVE, 
	PMDUXG1ADDINTERESTTYPE, 
	PMDUXG1ADDINTERESTSEQ, 
	PMDUXG1PRODWCOVTYPE, 
	PMDUXG1YEARPROCESS, 
	PMDUXG1MONTHPROCESS, 
	PMDUXG1DAYPROCESS, 
	PMDUXG1EXPOSUREAMOUNTD, 
	PMDUXG1RATINGCLASS, 
	PMDUXG1INCLIMITTABLEIND, 
	PMDUXG1CLASSDESCSOURCE, 
	Pmduxg1YearInTransitionD AS PMDUXG1YEARINTRANSITION, 
	PMDUXG1EXPOSUREINDICATOR, 
	PMDUXG1RATINGSTATE, 
	PMDUXG1TERRITORY, 
	PMDUXG1COOWNRSPLIABIND, 
	PMDUXG1MTGEEASSGNLIABIND, 
	PMDUXG1CNTLINTIND, 
	PMDUXG1OWNLANDLESDIND, 
	PMDUXG1OWNLESELIABIND, 
	PMDUXG1EXECTADMINTRSTIND, 
	PMDUXG1ELECTOFICCORPIND, 
	PMDUXG1GOVTUNTSOWNIND, 
	PMDUXG1FIDUCCOVFIDUCIND, 
	PMDUXG1MBROFCHRCHIND, 
	PMDUXG1OILGASOPSOWNIND, 
	PMDUXG1TRSTCLRGYIND, 
	PMDUXG1SPSEOFPARTNIND, 
	PMDUXG1PRIVRESBIIND, 
	PMDUXG1PRIVRESAPTNUMFAM, 
	PMDUXG1FCLTYMBRSCHLIND, 
	PMDUXG1SCHLGOVTIMMIND, 
	PMDUXG1PREMBASIS, 
	PMDUXG1EXPOSUREBASIS, 
	PMDUXG1YEARCVGEXPIRE, 
	PMDUXG1MONTHCVREXPIRE, 
	PMDUXG1DAYCVGEXPIRE, 
	PMDUXG1SPLITCOMBINEDDEDIND, 
	PMDUXG1DEDAMOUNT, 
	PMDUXG1DEDUCTIBLEPER, 
	PMDUXG1DEDAMTPD, 
	PMDUXG1DEDUCTIBLEPERPD, 
	PMDUXG1PMACODE, 
	PMDUXG1ARATESIND, 
	PMDUXG1FRINGECODE1, 
	PMDUXG1FRINGECODE2, 
	PMDUXG1FRINGECODE3, 
	PMDUXG1SPECIALMEDPAYIND, 
	PMDUXG1SKLMINPREMIND, 
	PMDUXG1PRODUCTSIND, 
	PMDUXG1EXTREPTPRDMONTHS, 
	PMDUXG1ERPPERCENT, 
	PMDUXG1OLDBASEEXPOSURE, 
	PMDUXG1OLDPREMIUMBASIS, 
	PMDUXG1DECCHANGEFLAG, 
	PMDUXG1EXPOIND, 
	PMDUXG1NODECIND, 
	PMDUXG1CLASSMINPREM, 
	PMDUXG1MUNLIABIND, 
	PMDUXG1SKLMINPREM, 
	PMDUXG1STATTERRITORY, 
	PMDUXG1PMSCFUTUREUSE, 
	PMDUXG1DAYCAREIND, 
	PMDUXG1TRANPROGIND, 
	PMDUXG1LOCATIONCHANGEIND, 
	PMDUXG1AUDITCLASSSW, 
	PMDUXG1BROADFORMIND, 
	PMDUXG1TERRMANUALOVERRIDE, 
	PMDUXG1CUSTFUTUREUSE, 
	PMDUXG1BUSINESSCLASS, 
	PMDUXG1BLDGNUM, 
	PMDUXG1YR2000CUSTUSE, 
	PMDUXG1WBCKEY, 
	EXTRACTDATE, 
	ASOFDATE, 
	RECORDCOUNT, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_Values
),