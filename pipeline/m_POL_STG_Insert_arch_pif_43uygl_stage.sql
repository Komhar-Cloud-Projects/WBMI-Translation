WITH
SQ_Pif43UYGLStage AS (
	SELECT
		Pif43UYGLStageId,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		Pmduyg1RecLength,
		Pmduyg1ActionCode,
		Pmduyg1FileId,
		Pmduyg1SegmentId,
		Pmduyg1SegmentStatus,
		Pmduyg1YearTransaction,
		Pmduyg1MonthTransaction,
		Pmduyg1DayTransaction,
		Pmduyg1SegmentLevelCode,
		Pmduyg1SegmentPartCode,
		Pmduyg1SubPartCode,
		Pmduyg1InsuranceLine,
		Pmduyg1LocationNumber,
		Pmduyg1PmsDefGlSubline,
		Pmduyg1ClassCodeGroup,
		Pmduyg1ClassCodeMember,
		Pmduyg1ClassCode,
		Pmduyg1RiskSequence,
		Pmduyg1RiskTypeInd,
		Pmduyg1YearItemEffective,
		Pmduyg1MonthItemEffective,
		Pmduyg1DayItemEffective,
		Pmduyg1AddInterestType,
		Pmduyg1AddInterestSeq,
		Pmduyg1ProdwCovType,
		Pmduyg1YearProcess,
		Pmduyg1MonthProcess,
		Pmduyg1DayProcess,
		Pmduyg1ManualGenerateInd,
		Pmduyg1BasicRate,
		Pmduyg1BasicRateMgInd,
		Pmduyg1ModifiedRate,
		Pmduyg1ModifiedRateMgInd,
		Pmduyg1PkgModMgInd,
		Pmduyg1PkgModFactor,
		Pmduyg1DeductibleCredit,
		Pmduyg1DedCrdtMgInd,
		Pmduyg1DeductibleCreditPd,
		Pmduyg1DedCrdtMgIndPd,
		Pmduyg1CalcPremFctr,
		Pmduyg1TermFactor,
		Pmduyg1PremTmMgInd,
		Pmduyg1PremiumTerm,
		Pmduyg1PremDeposMgInd,
		Pmduyg1PremiumDeposit,
		Pmduyg1ClaimsMadeFactor,
		Pmduyg1IncrLimMgInd,
		Pmduyg1IncreaseLimitsFactor,
		Pmduyg1PdIncrLimMgInd,
		Pmduyg1PdIncrLimitFactor,
		Pmduyg1BiWeightMgInd,
		Pmduyg1BiWeightFactor,
		Pmduyg1PdWeightMgInd,
		Pmduyg1PdWeightFactor,
		Pmduyg1FringeRate1,
		Pmduyg1FringeRateMgInd1,
		Pmduyg1FringeRate2,
		Pmduyg1FringeRateMgInd2,
		Pmduyg1FringeRate3,
		Pmduyg1FringeRateMgInd3,
		Pmduyg1Rdf,
		Pmduyg1Rmf,
		Pmduyg1TransitionFactor,
		Pmduyg1ConstantFactor,
		Pmduyg1ConstantMgInd,
		Pmduyg1CoverageChange,
		Pmduyg1RateAtLimits,
		Pmduyg1CompanyDeviation,
		Pmduyg1BiSplitIlf,
		Pmduyg1PdSplitIlf,
		Pmduyg1TotalSplitIlf,
		Pmduyg1AddInterestFactor,
		Pmduyg1AddIntFactorMgInd,
		Pmduyg1ClaimsMadeMgInd,
		Pmduyg1AuditTransFactor,
		Pmduyg1RdfMgInd,
		Pmduyg1DecChangeFlag,
		Pmduyg1TransFactorNew,
		Pmduyg1NyTortFactor,
		Pmguyg1LossCostMult,
		Pmduyg1FullyEarnedSw,
		Pmduyg1TerrorismRate,
		Pmduyg1AvgTerrorRate,
		Pmduyg1BroadFactor,
		Pmduyg1BroadMin,
		Pmduyg1BroadMax,
		Pmduyg1ProdwFactor,
		Pmduyg1ProdwFactorMgInd,
		Pmduyg1PmsFutureUse,
		Pmduyg1EdgeFactor,
		Pmduyg1EmpBen0100Fact,
		Pmduyg1EmpBen101400Fact,
		Pmduyg1EmpBen401700Fact,
		Pmduyg1EmpBen7011000Fact,
		Pmduyg1ProgramFactor,
		Pmduyg1AssociationFactor,
		Pmduyg1CustomerUse,
		Pmduyg1BldgNum,
		Pmduyg1RestaurantSqFt,
		Pmduyg1LpwIncidentFactor,
		Pmduyg1SapFactor,
		Pmduyg1RestaurantSqFt6,
		Pmduyg1Yr2000CustUse,
		Pmduyg1WbcKey,
		ExtractDate,
		AsOfDate,
		RecordCount,
		SourceSystemId
	FROM Pif43UYGLStage
),
EXP_Values AS (
	SELECT
	Pif43UYGLStageId AS Pif43UYStageId,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	Pmduyg1RecLength,
	Pmduyg1ActionCode,
	Pmduyg1FileId,
	Pmduyg1SegmentId,
	Pmduyg1SegmentStatus,
	Pmduyg1YearTransaction,
	Pmduyg1MonthTransaction,
	Pmduyg1DayTransaction,
	Pmduyg1SegmentLevelCode,
	Pmduyg1SegmentPartCode,
	Pmduyg1SubPartCode,
	Pmduyg1InsuranceLine,
	Pmduyg1LocationNumber,
	Pmduyg1PmsDefGlSubline,
	Pmduyg1ClassCodeGroup,
	Pmduyg1ClassCodeMember,
	Pmduyg1ClassCode,
	Pmduyg1RiskSequence,
	Pmduyg1RiskTypeInd,
	Pmduyg1YearItemEffective,
	Pmduyg1MonthItemEffective,
	Pmduyg1DayItemEffective,
	Pmduyg1AddInterestType,
	Pmduyg1AddInterestSeq,
	Pmduyg1ProdwCovType,
	Pmduyg1YearProcess,
	Pmduyg1MonthProcess,
	Pmduyg1DayProcess,
	Pmduyg1ManualGenerateInd,
	Pmduyg1BasicRate,
	Pmduyg1BasicRateMgInd,
	Pmduyg1ModifiedRate,
	Pmduyg1ModifiedRateMgInd,
	Pmduyg1PkgModMgInd,
	Pmduyg1PkgModFactor,
	Pmduyg1DeductibleCredit,
	Pmduyg1DedCrdtMgInd,
	Pmduyg1DeductibleCreditPd,
	Pmduyg1DedCrdtMgIndPd,
	Pmduyg1CalcPremFctr,
	Pmduyg1TermFactor,
	Pmduyg1PremTmMgInd,
	Pmduyg1PremiumTerm,
	Pmduyg1PremDeposMgInd,
	Pmduyg1PremiumDeposit,
	Pmduyg1ClaimsMadeFactor,
	Pmduyg1IncrLimMgInd,
	Pmduyg1IncreaseLimitsFactor,
	Pmduyg1PdIncrLimMgInd,
	Pmduyg1PdIncrLimitFactor,
	Pmduyg1BiWeightMgInd,
	Pmduyg1BiWeightFactor,
	Pmduyg1PdWeightMgInd,
	Pmduyg1PdWeightFactor,
	Pmduyg1FringeRate1,
	Pmduyg1FringeRateMgInd1,
	Pmduyg1FringeRate2,
	Pmduyg1FringeRateMgInd2,
	Pmduyg1FringeRate3,
	Pmduyg1FringeRateMgInd3,
	Pmduyg1Rdf,
	Pmduyg1Rmf,
	Pmduyg1TransitionFactor,
	Pmduyg1ConstantFactor,
	Pmduyg1ConstantMgInd,
	Pmduyg1CoverageChange,
	Pmduyg1RateAtLimits,
	Pmduyg1CompanyDeviation,
	Pmduyg1BiSplitIlf,
	Pmduyg1PdSplitIlf,
	Pmduyg1TotalSplitIlf,
	Pmduyg1AddInterestFactor,
	Pmduyg1AddIntFactorMgInd,
	Pmduyg1ClaimsMadeMgInd,
	Pmduyg1AuditTransFactor,
	Pmduyg1RdfMgInd,
	Pmduyg1DecChangeFlag,
	Pmduyg1TransFactorNew,
	Pmduyg1NyTortFactor,
	Pmguyg1LossCostMult,
	Pmduyg1FullyEarnedSw,
	Pmduyg1TerrorismRate,
	Pmduyg1AvgTerrorRate,
	Pmduyg1BroadFactor,
	Pmduyg1BroadMin,
	Pmduyg1BroadMax,
	Pmduyg1ProdwFactor,
	Pmduyg1ProdwFactorMgInd,
	Pmduyg1PmsFutureUse,
	Pmduyg1EdgeFactor,
	Pmduyg1EmpBen0100Fact AS Pmduyg1EmpBen0100Factor,
	Pmduyg1EmpBen101400Fact AS Pmduyg1EmpBen101400Factor,
	Pmduyg1EmpBen401700Fact AS Pmduyg1EmpBen401700Factor,
	Pmduyg1EmpBen7011000Fact AS Pmduyg1EmpBen7011000Factor,
	Pmduyg1ProgramFactor,
	Pmduyg1AssociationFactor,
	Pmduyg1CustomerUse,
	Pmduyg1BldgNum,
	Pmduyg1RestaurantSqFt,
	Pmduyg1LpwIncidentFactor,
	Pmduyg1SapFactor,
	Pmduyg1RestaurantSqFt6,
	Pmduyg1Yr2000CustUse,
	Pmduyg1WbcKey,
	ExtractDate,
	AsOfDate,
	RecordCount,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_Pif43UYGLStage
),
ArchPif43UYGLStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UYGLStage
	(Pif43UYGLStageId, PifSymbol, PifPolicyNumber, PifModule, Pmduyg1RecLength, Pmduyg1ActionCode, Pmduyg1FileId, Pmduyg1SegmentId, Pmduyg1SegmentStatus, Pmduyg1YearTransaction, Pmduyg1MonthTransaction, Pmduyg1DayTransaction, Pmduyg1SegmentLevelCode, Pmduyg1SegmentPartCode, Pmduyg1SubPartCode, Pmduyg1InsuranceLine, Pmduyg1LocationNumber, Pmduyg1PmsDefGlSubline, Pmduyg1ClassCodeGroup, Pmduyg1ClassCodeMember, Pmduyg1ClassCode, Pmduyg1RiskSequence, Pmduyg1RiskTypeInd, Pmduyg1YearItemEffective, Pmduyg1MonthItemEffective, Pmduyg1DayItemEffective, Pmduyg1AddInterestType, Pmduyg1AddInterestSeq, Pmduyg1ProdwCovType, Pmduyg1YearProcess, Pmduyg1MonthProcess, Pmduyg1DayProcess, Pmduyg1ManualGenerateInd, Pmduyg1BasicRate, Pmduyg1BasicRateMgInd, Pmduyg1ModifiedRate, Pmduyg1ModifiedRateMgInd, Pmduyg1PkgModMgInd, Pmduyg1PkgModFactor, Pmduyg1DeductibleCredit, Pmduyg1DedCrdtMgInd, Pmduyg1DeductibleCreditPd, Pmduyg1DedCrdtMgIndPd, Pmduyg1CalcPremFctr, Pmduyg1TermFactor, Pmduyg1PremTmMgInd, Pmduyg1PremiumTerm, Pmduyg1PremDeposMgInd, Pmduyg1PremiumDeposit, Pmduyg1ClaimsMadeFactor, Pmduyg1IncrLimMgInd, Pmduyg1IncreaseLimitsFactor, Pmduyg1PdIncrLimMgInd, Pmduyg1PdIncrLimitFactor, Pmduyg1BiWeightMgInd, Pmduyg1BiWeightFactor, Pmduyg1PdWeightMgInd, Pmduyg1PdWeightFactor, Pmduyg1FringeRate1, Pmduyg1FringeRateMgInd1, Pmduyg1FringeRate2, Pmduyg1FringeRateMgInd2, Pmduyg1FringeRate3, Pmduyg1FringeRateMgInd3, Pmduyg1Rdf, Pmduyg1Rmf, Pmduyg1TransitionFactor, Pmduyg1ConstantFactor, Pmduyg1ConstantMgInd, Pmduyg1CoverageChange, Pmduyg1RateAtLimits, Pmduyg1CompanyDeviation, Pmduyg1BiSplitIlf, Pmduyg1PdSplitIlf, Pmduyg1TotalSplitIlf, Pmduyg1AddInterestFactor, Pmduyg1AddIntFactorMgInd, Pmduyg1ClaimsMadeMgInd, Pmduyg1AuditTransFactor, Pmduyg1RdfMgInd, Pmduyg1DecChangeFlag, Pmduyg1TransFactorNew, Pmduyg1NyTortFactor, Pmguyg1LossCostMult, Pmduyg1FullyEarnedSw, Pmduyg1TerrorismRate, Pmduyg1AvgTerrorRate, Pmduyg1BroadFactor, Pmduyg1BroadMin, Pmduyg1BroadMax, Pmduyg1ProdwFactor, Pmduyg1ProdwFactorMgInd, Pmduyg1PmsFutureUse, Pmduyg1EdgeFactor, Pmduyg1EmpBen0100Fact, Pmduyg1EmpBen101400Fact, Pmduyg1EmpBen401700Fact, Pmduyg1EmpBen7011000Fact, Pmduyg1ProgramFactor, Pmduyg1AssociationFactor, Pmduyg1CustomerUse, Pmduyg1BldgNum, Pmduyg1RestaurantSqFt, Pmduyg1LpwIncidentFactor, Pmduyg1SapFactor, Pmduyg1RestaurantSqFt6, Pmduyg1Yr2000CustUse, Pmduyg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)
	SELECT 
	Pif43UYStageId AS PIF43UYGLSTAGEID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDUYG1RECLENGTH, 
	PMDUYG1ACTIONCODE, 
	PMDUYG1FILEID, 
	PMDUYG1SEGMENTID, 
	PMDUYG1SEGMENTSTATUS, 
	PMDUYG1YEARTRANSACTION, 
	PMDUYG1MONTHTRANSACTION, 
	PMDUYG1DAYTRANSACTION, 
	PMDUYG1SEGMENTLEVELCODE, 
	PMDUYG1SEGMENTPARTCODE, 
	PMDUYG1SUBPARTCODE, 
	PMDUYG1INSURANCELINE, 
	PMDUYG1LOCATIONNUMBER, 
	PMDUYG1PMSDEFGLSUBLINE, 
	PMDUYG1CLASSCODEGROUP, 
	PMDUYG1CLASSCODEMEMBER, 
	PMDUYG1CLASSCODE, 
	PMDUYG1RISKSEQUENCE, 
	PMDUYG1RISKTYPEIND, 
	PMDUYG1YEARITEMEFFECTIVE, 
	PMDUYG1MONTHITEMEFFECTIVE, 
	PMDUYG1DAYITEMEFFECTIVE, 
	PMDUYG1ADDINTERESTTYPE, 
	PMDUYG1ADDINTERESTSEQ, 
	PMDUYG1PRODWCOVTYPE, 
	PMDUYG1YEARPROCESS, 
	PMDUYG1MONTHPROCESS, 
	PMDUYG1DAYPROCESS, 
	PMDUYG1MANUALGENERATEIND, 
	PMDUYG1BASICRATE, 
	PMDUYG1BASICRATEMGIND, 
	PMDUYG1MODIFIEDRATE, 
	PMDUYG1MODIFIEDRATEMGIND, 
	PMDUYG1PKGMODMGIND, 
	PMDUYG1PKGMODFACTOR, 
	PMDUYG1DEDUCTIBLECREDIT, 
	PMDUYG1DEDCRDTMGIND, 
	PMDUYG1DEDUCTIBLECREDITPD, 
	PMDUYG1DEDCRDTMGINDPD, 
	PMDUYG1CALCPREMFCTR, 
	PMDUYG1TERMFACTOR, 
	PMDUYG1PREMTMMGIND, 
	PMDUYG1PREMIUMTERM, 
	PMDUYG1PREMDEPOSMGIND, 
	PMDUYG1PREMIUMDEPOSIT, 
	PMDUYG1CLAIMSMADEFACTOR, 
	PMDUYG1INCRLIMMGIND, 
	PMDUYG1INCREASELIMITSFACTOR, 
	PMDUYG1PDINCRLIMMGIND, 
	PMDUYG1PDINCRLIMITFACTOR, 
	PMDUYG1BIWEIGHTMGIND, 
	PMDUYG1BIWEIGHTFACTOR, 
	PMDUYG1PDWEIGHTMGIND, 
	PMDUYG1PDWEIGHTFACTOR, 
	PMDUYG1FRINGERATE1, 
	PMDUYG1FRINGERATEMGIND1, 
	PMDUYG1FRINGERATE2, 
	PMDUYG1FRINGERATEMGIND2, 
	PMDUYG1FRINGERATE3, 
	PMDUYG1FRINGERATEMGIND3, 
	PMDUYG1RDF, 
	PMDUYG1RMF, 
	PMDUYG1TRANSITIONFACTOR, 
	PMDUYG1CONSTANTFACTOR, 
	PMDUYG1CONSTANTMGIND, 
	PMDUYG1COVERAGECHANGE, 
	PMDUYG1RATEATLIMITS, 
	PMDUYG1COMPANYDEVIATION, 
	PMDUYG1BISPLITILF, 
	PMDUYG1PDSPLITILF, 
	PMDUYG1TOTALSPLITILF, 
	PMDUYG1ADDINTERESTFACTOR, 
	PMDUYG1ADDINTFACTORMGIND, 
	PMDUYG1CLAIMSMADEMGIND, 
	PMDUYG1AUDITTRANSFACTOR, 
	PMDUYG1RDFMGIND, 
	PMDUYG1DECCHANGEFLAG, 
	PMDUYG1TRANSFACTORNEW, 
	PMDUYG1NYTORTFACTOR, 
	PMGUYG1LOSSCOSTMULT, 
	PMDUYG1FULLYEARNEDSW, 
	PMDUYG1TERRORISMRATE, 
	PMDUYG1AVGTERRORRATE, 
	PMDUYG1BROADFACTOR, 
	PMDUYG1BROADMIN, 
	PMDUYG1BROADMAX, 
	PMDUYG1PRODWFACTOR, 
	PMDUYG1PRODWFACTORMGIND, 
	PMDUYG1PMSFUTUREUSE, 
	PMDUYG1EDGEFACTOR, 
	Pmduyg1EmpBen0100Factor AS PMDUYG1EMPBEN0100FACT, 
	Pmduyg1EmpBen101400Factor AS PMDUYG1EMPBEN101400FACT, 
	Pmduyg1EmpBen401700Factor AS PMDUYG1EMPBEN401700FACT, 
	Pmduyg1EmpBen7011000Factor AS PMDUYG1EMPBEN7011000FACT, 
	PMDUYG1PROGRAMFACTOR, 
	PMDUYG1ASSOCIATIONFACTOR, 
	PMDUYG1CUSTOMERUSE, 
	PMDUYG1BLDGNUM, 
	PMDUYG1RESTAURANTSQFT, 
	PMDUYG1LPWINCIDENTFACTOR, 
	PMDUYG1SAPFACTOR, 
	PMDUYG1RESTAURANTSQFT6, 
	PMDUYG1YR2000CUSTUSE, 
	PMDUYG1WBCKEY, 
	EXTRACTDATE, 
	ASOFDATE, 
	RECORDCOUNT, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_Values
),