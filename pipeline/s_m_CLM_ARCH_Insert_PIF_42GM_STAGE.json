{
    "name": "s_m_CLM_ARCH_Insert_PIF_42GM_STAGE",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_PIF_42GM_STAGE",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PIF_42GM_stage AS (\n\tSELECT\n\t\tpif_42gm_stage_id AS PIF_42GM_stage_id,\n\t\tpif_symbol AS PIF_SYMBOL,\n\t\tpif_policy_number AS PIF_POLICY_NUMBER,\n\t\tpif_module AS PIF_MODULE,\n\t\tipfc4m_rec_length AS IPFC4M_REC_LENGTH,\n\t\tipfc4m_action_code AS IPFC4M_ACTION_CODE,\n\t\tipfc4m_file_id AS IPFC4M_FILE_ID,\n\t\tipfc4m_segment_id AS IPFC4M_SEGMENT_ID,\n\t\tipfc4m_segment_level_code AS IPFC4M_SEGMENT_LEVEL_CODE,\n\t\tipfc4m_segment_part_code AS IPFC4M_SEGMENT_PART_CODE,\n\t\tipfc4m_sub_part_code AS IPFC4M_SUB_PART_CODE,\n\t\tipfc4m_insurance_line AS IPFC4M_INSURANCE_LINE,\n\t\tipfc4m_location_number AS IPFC4M_LOCATION_NUMBER,\n\t\tipfc4m_sub_location_number AS IPFC4M_SUB_LOCATION_NUMBER,\n\t\tipfc4m_risk_unit_group AS IPFC4M_RISK_UNIT_GROUP,\n\t\tipfc4m_class_code_group AS IPFC4M_CLASS_CODE_GROUP,\n\t\tipfc4m_class_code_member AS IPFC4M_CLASS_CODE_MEMBER,\n\t\tipfc4m_risk_unit AS IPFC4M_RISK_UNIT,\n\t\tipfc4m_risk_sequence AS IPFC4M_RISK_SEQUENCE,\n\t\tipfc4m_risk_type_ind AS IPFC4M_RISK_TYPE_IND,\n\t\tipfc4m_year_item_effective AS IPFC4M_YEAR_ITEM_EFFECTIVE,\n\t\tipfc4m_month_item_effective AS IPFC4M_MONTH_ITEM_EFFECTIVE,\n\t\tipfc4m_day_item_effective AS IPFC4M_DAY_ITEM_EFFECTIVE,\n\t\tipfc4m_loss_year AS IPFC4M_LOSS_YEAR,\n\t\tipfc4m_loss_month AS IPFC4M_LOSS_MONTH,\n\t\tipfc4m_loss_day AS IPFC4M_LOSS_DAY,\n\t\tipfc4m_loss_occurence AS IPFC4M_LOSS_OCCURENCE,\n\t\tipfc4m_loss_claimant AS IPFC4M_LOSS_CLAIMANT,\n\t\tipfc4m_remark_length AS IPFC4M_REMARK_LENGTH,\n\t\tipfc4m_use_code AS IPFC4M_USE_CODE,\n\t\tipfc4m_sequence_use_code AS IPFC4M_SEQUENCE_USE_CODE,\n\t\tipfc4m_year_process AS IPFC4M_YEAR_PROCESS,\n\t\tipfc4m_month_process AS IPFC4M_MONTH_PROCESS,\n\t\tipfc4m_day_process AS IPFC4M_DAY_PROCESS,\n\t\tipfc4m_year_change_entry AS IPFC4M_YEAR_CHANGE_ENTRY,\n\t\tipfc4m_month_change_entry AS IPFC4M_MONTH_CHANGE_ENTRY,\n\t\tipfc4m_day_change_entry AS IPFC4M_DAY_CHANGE_ENTRY,\n\t\tipfc4m_sequence_change_entry AS IPFC4M_SEQUENCE_CHANGE_ENTRY,\n\t\tipfc4m_segment_status AS IPFC4M_SEGMENT_STATUS,\n\t\tipfc4m_entry_operator AS IPFC4M_ENTRY_OPERATOR,\n\t\tipfc4m_rsk_rmk_verbg AS IPFC4M_RSK_RMK_VERBG,\n\t\tipfc4m_offset_onset_ind AS IPFC4M_OFFSET_ONSET_IND,\n\t\tipfc4m_pms_future_use_4m AS IPFC4M_PMS_FUTURE_USE_4M,\n\t\tipfc4m_yr2000_cust_use AS IPFC4M_YR2000_CUST_USE,\n\t\tipfc4m_cust_spl_use_4m AS IPFC4M_CUST_SPL_USE_4M,\n\t\tinf_action,\n\t\tinf_timestamp,\n\t\tlogical_flag,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID\n\tFROM PIF_42GM_stage\n),\nEXP_arch_PIF_42GM_stage AS (\n\tSELECT\n\tPIF_42GM_stage_id,\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE,\n\tIPFC4M_REC_LENGTH,\n\tIPFC4M_ACTION_CODE,\n\tIPFC4M_FILE_ID,\n\tIPFC4M_SEGMENT_ID,\n\tIPFC4M_SEGMENT_LEVEL_CODE,\n\tIPFC4M_SEGMENT_PART_CODE,\n\tIPFC4M_SUB_PART_CODE,\n\tIPFC4M_INSURANCE_LINE,\n\tIPFC4M_LOCATION_NUMBER,\n\tIPFC4M_SUB_LOCATION_NUMBER,\n\tIPFC4M_RISK_UNIT_GROUP,\n\tIPFC4M_CLASS_CODE_GROUP,\n\tIPFC4M_CLASS_CODE_MEMBER,\n\tIPFC4M_RISK_UNIT,\n\tIPFC4M_RISK_SEQUENCE,\n\tIPFC4M_RISK_TYPE_IND,\n\tIPFC4M_YEAR_ITEM_EFFECTIVE,\n\tIPFC4M_MONTH_ITEM_EFFECTIVE,\n\tIPFC4M_DAY_ITEM_EFFECTIVE,\n\tIPFC4M_LOSS_YEAR,\n\tIPFC4M_LOSS_MONTH,\n\tIPFC4M_LOSS_DAY,\n\tIPFC4M_LOSS_OCCURENCE,\n\tIPFC4M_LOSS_CLAIMANT,\n\tIPFC4M_REMARK_LENGTH,\n\tIPFC4M_USE_CODE,\n\tIPFC4M_SEQUENCE_USE_CODE,\n\tIPFC4M_YEAR_PROCESS,\n\tIPFC4M_MONTH_PROCESS,\n\tIPFC4M_DAY_PROCESS,\n\tIPFC4M_YEAR_CHANGE_ENTRY,\n\tIPFC4M_MONTH_CHANGE_ENTRY,\n\tIPFC4M_DAY_CHANGE_ENTRY,\n\tIPFC4M_SEQUENCE_CHANGE_ENTRY,\n\tIPFC4M_SEGMENT_STATUS,\n\tIPFC4M_ENTRY_OPERATOR,\n\tIPFC4M_RSK_RMK_VERBG,\n\tIPFC4M_OFFSET_ONSET_IND,\n\tIPFC4M_PMS_FUTURE_USE_4M,\n\tIPFC4M_YR2000_CUST_USE,\n\tIPFC4M_CUST_SPL_USE_4M,\n\tinf_action,\n\tinf_timestamp,\n\tlogical_flag,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_PIF_42GM_stage\n),\narch_PIF_42GM_stage AS (\n\tINSERT INTO arch_PIF_42GM_stage\n\t(pif_42gm_stage_id, pif_symbol, pif_policy_number, pif_module, ipfc4m_rec_length, ipfc4m_action_code, ipfc4m_file_id, ipfc4m_segment_id, ipfc4m_segment_level_code, ipfc4m_segment_part_code, ipfc4m_sub_part_code, ipfc4m_insurance_line, ipfc4m_location_number, ipfc4m_sub_location_number, ipfc4m_risk_unit_group, ipfc4m_class_code_group, ipfc4m_class_code_member, ipfc4m_risk_unit, ipfc4m_risk_sequence, ipfc4m_risk_type_ind, ipfc4m_year_item_effective, ipfc4m_month_item_effective, ipfc4m_day_item_effective, ipfc4m_loss_year, ipfc4m_loss_month, ipfc4m_loss_day, ipfc4m_loss_occurence, ipfc4m_loss_claimant, ipfc4m_remark_length, ipfc4m_use_code, ipfc4m_sequence_use_code, ipfc4m_year_process, ipfc4m_month_process, ipfc4m_day_process, ipfc4m_year_change_entry, ipfc4m_month_change_entry, ipfc4m_day_change_entry, ipfc4m_sequence_change_entry, ipfc4m_segment_status, ipfc4m_entry_operator, ipfc4m_rsk_rmk_verbg, ipfc4m_offset_onset_ind, ipfc4m_pms_future_use_4m, ipfc4m_yr2000_cust_use, ipfc4m_cust_spl_use_4m, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)\n\tSELECT \n\tPIF_42GM_stage_id AS PIF_42GM_STAGE_ID, \n\tPIF_SYMBOL AS PIF_SYMBOL, \n\tPIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, \n\tPIF_MODULE AS PIF_MODULE, \n\tIPFC4M_REC_LENGTH AS IPFC4M_REC_LENGTH, \n\tIPFC4M_ACTION_CODE AS IPFC4M_ACTION_CODE, \n\tIPFC4M_FILE_ID AS IPFC4M_FILE_ID, \n\tIPFC4M_SEGMENT_ID AS IPFC4M_SEGMENT_ID, \n\tIPFC4M_SEGMENT_LEVEL_CODE AS IPFC4M_SEGMENT_LEVEL_CODE, \n\tIPFC4M_SEGMENT_PART_CODE AS IPFC4M_SEGMENT_PART_CODE, \n\tIPFC4M_SUB_PART_CODE AS IPFC4M_SUB_PART_CODE, \n\tIPFC4M_INSURANCE_LINE AS IPFC4M_INSURANCE_LINE, \n\tIPFC4M_LOCATION_NUMBER AS IPFC4M_LOCATION_NUMBER, \n\tIPFC4M_SUB_LOCATION_NUMBER AS IPFC4M_SUB_LOCATION_NUMBER, \n\tIPFC4M_RISK_UNIT_GROUP AS IPFC4M_RISK_UNIT_GROUP, \n\tIPFC4M_CLASS_CODE_GROUP AS IPFC4M_CLASS_CODE_GROUP, \n\tIPFC4M_CLASS_CODE_MEMBER AS IPFC4M_CLASS_CODE_MEMBER, \n\tIPFC4M_RISK_UNIT AS IPFC4M_RISK_UNIT, \n\tIPFC4M_RISK_SEQUENCE AS IPFC4M_RISK_SEQUENCE, \n\tIPFC4M_RISK_TYPE_IND AS IPFC4M_RISK_TYPE_IND, \n\tIPFC4M_YEAR_ITEM_EFFECTIVE AS IPFC4M_YEAR_ITEM_EFFECTIVE, \n\tIPFC4M_MONTH_ITEM_EFFECTIVE AS IPFC4M_MONTH_ITEM_EFFECTIVE, \n\tIPFC4M_DAY_ITEM_EFFECTIVE AS IPFC4M_DAY_ITEM_EFFECTIVE, \n\tIPFC4M_LOSS_YEAR AS IPFC4M_LOSS_YEAR, \n\tIPFC4M_LOSS_MONTH AS IPFC4M_LOSS_MONTH, \n\tIPFC4M_LOSS_DAY AS IPFC4M_LOSS_DAY, \n\tIPFC4M_LOSS_OCCURENCE AS IPFC4M_LOSS_OCCURENCE, \n\tIPFC4M_LOSS_CLAIMANT AS IPFC4M_LOSS_CLAIMANT, \n\tIPFC4M_REMARK_LENGTH AS IPFC4M_REMARK_LENGTH, \n\tIPFC4M_USE_CODE AS IPFC4M_USE_CODE, \n\tIPFC4M_SEQUENCE_USE_CODE AS IPFC4M_SEQUENCE_USE_CODE, \n\tIPFC4M_YEAR_PROCESS AS IPFC4M_YEAR_PROCESS, \n\tIPFC4M_MONTH_PROCESS AS IPFC4M_MONTH_PROCESS, \n\tIPFC4M_DAY_PROCESS AS IPFC4M_DAY_PROCESS, \n\tIPFC4M_YEAR_CHANGE_ENTRY AS IPFC4M_YEAR_CHANGE_ENTRY, \n\tIPFC4M_MONTH_CHANGE_ENTRY AS IPFC4M_MONTH_CHANGE_ENTRY, \n\tIPFC4M_DAY_CHANGE_ENTRY AS IPFC4M_DAY_CHANGE_ENTRY, \n\tIPFC4M_SEQUENCE_CHANGE_ENTRY AS IPFC4M_SEQUENCE_CHANGE_ENTRY, \n\tIPFC4M_SEGMENT_STATUS AS IPFC4M_SEGMENT_STATUS, \n\tIPFC4M_ENTRY_OPERATOR AS IPFC4M_ENTRY_OPERATOR, \n\tIPFC4M_RSK_RMK_VERBG AS IPFC4M_RSK_RMK_VERBG, \n\tIPFC4M_OFFSET_ONSET_IND AS IPFC4M_OFFSET_ONSET_IND, \n\tIPFC4M_PMS_FUTURE_USE_4M AS IPFC4M_PMS_FUTURE_USE_4M, \n\tIPFC4M_YR2000_CUST_USE AS IPFC4M_YR2000_CUST_USE, \n\tIPFC4M_CUST_SPL_USE_4M AS IPFC4M_CUST_SPL_USE_4M, \n\tINF_ACTION, \n\tINF_TIMESTAMP, \n\tLOGICAL_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_arch_PIF_42GM_stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}