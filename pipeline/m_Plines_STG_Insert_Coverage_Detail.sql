WITH
SQ_coverage_detail AS (
	SELECT
		cov_detail_seq,
		cov_master_seq,
		num_of_item,
		street,
		city,
		state_type_code,
		zip_type_code,
		limit_type_code,
		descript,
		corporal_punish_flag,
		premium,
		amt,
		max_amt,
		computer_type_code,
		crop_farm_flag,
		live_stock_flag,
		num_acre,
		bus_loc_descript,
		loc_type_code,
		sched_sent_by_type_code,
		collapse_eff_date,
		theft_eff_date,
		veneer_flag,
		damage_flag,
		tank_capacity,
		tank_age,
		tank_loc_type_code,
		ded_type_code,
		loan_carry_over_flag,
		appraisal_date,
		pers_inj_protect_type_code,
		farmed_by,
		other_const_type,
		modified_date,
		modified_user_id,
		cov_detail_num,
		eq_struct_code,
		eq_zone,
		eq_ded_prcnt,
		eq_struct_descript,
		eq_limit_amt,
		veh_loan_flag,
		time_share_flag,
		incidental_occupancy_code,
		gross_receipts,
		employee_assistant_premises_flag,
		assisted_living_facility_code,
		business_ownership_type_flag,
		name_of_living_facility,
		name_of_insd_person_in_living_facility,
		relationship_living_facility_insd_code,
		year,
		make,
		model,
		serial_nbr,
		veh_category_type_code,
		loss_settlement_type_code,
		home_day_care_loc_type_code,
		loan_lease_purchase_lease_date,
		loan_lease_previously_insured_flag,
		loan_lease_cov_provided_by_prior_carrier_flag,
		endorsement_view_code,
		pif_amt,
		pif_ded_type_code
	FROM coverage_detail
	WHERE coverage_detail.cov_detail_seq%3=0
),
EXP_COVERAGE_DETAIL AS (
	SELECT
	cov_detail_seq,
	cov_master_seq,
	num_of_item,
	street,
	city,
	state_type_code,
	zip_type_code,
	limit_type_code,
	descript,
	corporal_punish_flag,
	premium,
	amt,
	max_amt,
	computer_type_code,
	crop_farm_flag,
	live_stock_flag,
	num_acre,
	bus_loc_descript,
	loc_type_code,
	sched_sent_by_type_code,
	collapse_eff_date,
	theft_eff_date,
	veneer_flag,
	damage_flag,
	tank_capacity,
	tank_age,
	tank_loc_type_code,
	ded_type_code,
	loan_carry_over_flag,
	appraisal_date,
	pers_inj_protect_type_code,
	farmed_by,
	other_const_type,
	modified_date,
	modified_user_id,
	cov_detail_num,
	eq_struct_code,
	eq_zone,
	eq_ded_prcnt,
	eq_struct_descript,
	eq_limit_amt,
	veh_loan_flag,
	time_share_flag,
	incidental_occupancy_code,
	gross_receipts,
	employee_assistant_premises_flag,
	assisted_living_facility_code,
	business_ownership_type_flag,
	name_of_living_facility,
	name_of_insd_person_in_living_facility,
	relationship_living_facility_insd_code,
	year,
	make,
	model,
	serial_nbr,
	veh_category_type_code,
	loss_settlement_type_code,
	home_day_care_loc_type_code,
	loan_lease_purchase_lease_date,
	loan_lease_previously_insured_flag,
	loan_lease_cov_provided_by_prior_carrier_flag,
	endorsement_view_code,
	pif_amt,
	pif_ded_type_code,
	SYSDATE AS EXTRACT_DATE,
	SYSDATE AS AS_OF_DATE,
	0 AS RECORD_COUNT,
	@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID
	FROM SQ_coverage_detail
),
coverage_detail_stage AS (
	TRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.coverage_detail_stage;
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.coverage_detail_stage
	(cov_detail_seq, cov_master_seq, num_of_item, street, city, state_type_code, zip_type_code, limit_type_code, descript, corporal_punish_flag, premium, amt, max_amt, computer_type_code, crop_farm_flag, live_stock_flag, num_acre, bus_loc_descript, loc_type_code, sched_sent_by_type_code, collapse_eff_date, theft_eff_date, veneer_flag, damage_flag, tank_capacity, tank_age, tank_loc_type_code, ded_type_code, loan_carry_over_flag, appraisal_date, pers_inj_protect_type_code, farmed_by, other_const_type, modified_date, modified_user_id, cov_detail_num, eq_struct_code, eq_zone, eq_ded_prcnt, eq_struct_descript, eq_limit_amt, veh_loan_flag, time_share_flag, incidental_occupancy_code, gross_receipts, employee_assistant_premises_flag, assisted_living_facility_code, business_ownership_type_flag, name_of_living_facility, name_of_insd_person_in_living_facility, relationship_living_facility_insd_code, year, make, model, serial_nbr, veh_category_type_code, loss_settlement_type_code, home_day_care_loc_type_code, loan_lease_purchase_lease_date, loan_lease_previously_insured_flag, loan_lease_cov_provided_by_prior_carrier_flag, endorsement_view_code, pif_amt, pif_ded_type_code, extract_date, as_of_date, record_count, source_system_id)
	SELECT 
	COV_DETAIL_SEQ, 
	COV_MASTER_SEQ, 
	NUM_OF_ITEM, 
	STREET, 
	CITY, 
	STATE_TYPE_CODE, 
	ZIP_TYPE_CODE, 
	LIMIT_TYPE_CODE, 
	DESCRIPT, 
	CORPORAL_PUNISH_FLAG, 
	PREMIUM, 
	AMT, 
	MAX_AMT, 
	COMPUTER_TYPE_CODE, 
	CROP_FARM_FLAG, 
	LIVE_STOCK_FLAG, 
	NUM_ACRE, 
	BUS_LOC_DESCRIPT, 
	LOC_TYPE_CODE, 
	SCHED_SENT_BY_TYPE_CODE, 
	COLLAPSE_EFF_DATE, 
	THEFT_EFF_DATE, 
	VENEER_FLAG, 
	DAMAGE_FLAG, 
	TANK_CAPACITY, 
	TANK_AGE, 
	TANK_LOC_TYPE_CODE, 
	DED_TYPE_CODE, 
	LOAN_CARRY_OVER_FLAG, 
	APPRAISAL_DATE, 
	PERS_INJ_PROTECT_TYPE_CODE, 
	FARMED_BY, 
	OTHER_CONST_TYPE, 
	MODIFIED_DATE, 
	MODIFIED_USER_ID, 
	COV_DETAIL_NUM, 
	EQ_STRUCT_CODE, 
	EQ_ZONE, 
	EQ_DED_PRCNT, 
	EQ_STRUCT_DESCRIPT, 
	EQ_LIMIT_AMT, 
	VEH_LOAN_FLAG, 
	TIME_SHARE_FLAG, 
	INCIDENTAL_OCCUPANCY_CODE, 
	GROSS_RECEIPTS, 
	EMPLOYEE_ASSISTANT_PREMISES_FLAG, 
	ASSISTED_LIVING_FACILITY_CODE, 
	BUSINESS_OWNERSHIP_TYPE_FLAG, 
	NAME_OF_LIVING_FACILITY, 
	NAME_OF_INSD_PERSON_IN_LIVING_FACILITY, 
	RELATIONSHIP_LIVING_FACILITY_INSD_CODE, 
	YEAR, 
	MAKE, 
	MODEL, 
	SERIAL_NBR, 
	VEH_CATEGORY_TYPE_CODE, 
	LOSS_SETTLEMENT_TYPE_CODE, 
	HOME_DAY_CARE_LOC_TYPE_CODE, 
	LOAN_LEASE_PURCHASE_LEASE_DATE, 
	LOAN_LEASE_PREVIOUSLY_INSURED_FLAG, 
	LOAN_LEASE_COV_PROVIDED_BY_PRIOR_CARRIER_FLAG, 
	ENDORSEMENT_VIEW_CODE, 
	PIF_AMT, 
	PIF_DED_TYPE_CODE, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID
	FROM EXP_COVERAGE_DETAIL
),