{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_ArchWBCUUmbrellaSBOPStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_ArchWBCUUmbrellaSBOPStage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WBCUUmbrellaSBOPStage AS (\n\tSELECT\n\t\tWBCUUmbrellaSBOPStageId,\n\t\tLineId,\n\t\tWBCUUmbrellaSBOPId,\n\t\tSessionId,\n\t\tDeleted,\n\t\tCoverageForm,\n\t\tDescription,\n\t\tEffectiveDate,\n\t\tExpirationDate,\n\t\tPersonalLiability,\n\t\tPolicyNumber,\n\t\tProfessionalLiabilityEachOccurrenceClaimLimit,\n\t\tProfessionalLiabilityAggregate,\n\t\tBodilyInjuryByAccidentEachAccident,\n\t\tBodilyInjuryByDiseaseEachEmployee,\n\t\tBodilyInjuryByDiseaseAggregate,\n\t\tFirstMillionBasePremium,\n\t\tFirstMillionModifiedPremium,\n\t\tPremOpsTotalPremiumTable1,\n\t\tPremOpsTotalPremiumTable2,\n\t\tPremOpsTotalPremiumTable3,\n\t\tAllOtherPremium,\n\t\tProductsTotalPremiumTableA,\n\t\tProductsTotalPremiumTableB,\n\t\tProductsTotalPremiumTableC,\n\t\tIncludeProfessionalLiability,\n\t\tAllOtherPremiumOverride,\n\t\tPremOpsTotalPremiumTable1PremiumOverride,\n\t\tPremOpsTotalPremiumTable2PremiumOverride,\n\t\tPremOpsTotalPremiumTable3PremiumOverride,\n\t\tProductsTotalPremiumTableAPremiumOverride,\n\t\tProductsTotalPremiumTableBPremiumOverride,\n\t\tProductsTotalPremiumTableCPremiumOverride,\n\t\tAllOtherRevisedPremium,\n\t\tPremOpsTotalPremiumTable1RevisedPremium,\n\t\tPremOpsTotalPremiumTable2RevisedPremium,\n\t\tPremOpsTotalPremiumTable3RevisedPremium,\n\t\tProductsTotalPremiumTableARevisedPremium,\n\t\tProductsTotalPremiumTableBRevisedPremium,\n\t\tProductsTotalPremiumTableCRevisedPremium,\n\t\tScheduledModification,\n\t\tIncludeCGL,\n\t\tIncludeOhioStopGapLiability,\n\t\tPremium,\n\t\tPremiumChange,\n\t\tPremiumWritten,\n\t\tIDField,\n\t\tUmbrellaSBOPScheduledModificationLocationInComment,\n\t\tUmbrellaSBOPScheduledModificationLocationInModification,\n\t\tUmbrellaSBOPScheduledModificationLocationOutComment,\n\t\tUmbrellaSBOPScheduledModificationLocationOutModification,\n\t\tUmbrellaSBOPScheduledModificationPremisesComment,\n\t\tUmbrellaSBOPScheduledModificationPremisesModification,\n\t\tUmbrellaSBOPScheduledModificationEquipmentComment,\n\t\tUmbrellaSBOPScheduledModificationEquipmentModification,\n\t\tUmbrellaSBOPScheduledModificationManagementComment,\n\t\tUmbrellaSBOPScheduledModificationManagementModification,\n\t\tUmbrellaSBOPScheduledModificationEmployeesComment,\n\t\tUmbrellaSBOPScheduledModificationEmployeesModification,\n\t\tUmbrellaSBOPScheduledModificationCooperationMedicalComment,\n\t\tUmbrellaSBOPScheduledModificationCooperationMedicalModification,\n\t\tUmbrellaSBOPScheduledModificationCooperationSafetyComment,\n\t\tUmbrellaSBOPScheduledModificationCooperationSafetyModification,\n\t\tModificationTotal,\n\t\tModificationTotalForSBOPBusinessDetailPage,\n\t\tExtractDate,\n\t\tSourceSystemId\n\tFROM WBCUUmbrellaSBOPStage\n),\nEXP_Metadata AS (\n\tSELECT\n\tWBCUUmbrellaSBOPStageId,\n\tLineId,\n\tWBCUUmbrellaSBOPId,\n\tSessionId,\n\tDeleted AS i_Deleted,\n\t-- *INF*: DECODE(i_Deleted,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_Deleted,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_Deleted,\n\tCoverageForm,\n\tDescription,\n\tEffectiveDate,\n\tExpirationDate,\n\tPersonalLiability AS i_PersonalLiability,\n\t-- *INF*: DECODE(i_PersonalLiability,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_PersonalLiability,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PersonalLiability,\n\tPolicyNumber,\n\tProfessionalLiabilityEachOccurrenceClaimLimit,\n\tProfessionalLiabilityAggregate,\n\tBodilyInjuryByAccidentEachAccident,\n\tBodilyInjuryByDiseaseEachEmployee,\n\tBodilyInjuryByDiseaseAggregate,\n\tFirstMillionBasePremium,\n\tFirstMillionModifiedPremium,\n\tPremOpsTotalPremiumTable1,\n\tPremOpsTotalPremiumTable2,\n\tPremOpsTotalPremiumTable3,\n\tAllOtherPremium,\n\tProductsTotalPremiumTableA,\n\tProductsTotalPremiumTableB,\n\tProductsTotalPremiumTableC,\n\tIncludeProfessionalLiability AS i_IncludeProfessionalLiability,\n\tAllOtherPremiumOverride AS i_AllOtherPremiumOverride,\n\tPremOpsTotalPremiumTable1PremiumOverride AS i_PremOpsTotalPremiumTable1PremiumOverride,\n\tPremOpsTotalPremiumTable2PremiumOverride AS i_PremOpsTotalPremiumTable2PremiumOverride,\n\tPremOpsTotalPremiumTable3PremiumOverride AS i_PremOpsTotalPremiumTable3PremiumOverride,\n\tProductsTotalPremiumTableAPremiumOverride AS i_ProductsTotalPremiumTableAPremiumOverride,\n\tProductsTotalPremiumTableBPremiumOverride AS i_ProductsTotalPremiumTableBPremiumOverride,\n\tProductsTotalPremiumTableCPremiumOverride AS i_ProductsTotalPremiumTableCPremiumOverride,\n\t-- *INF*: DECODE(i_IncludeProfessionalLiability,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_IncludeProfessionalLiability,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_IncludeProfessionalLiability,\n\t-- *INF*: DECODE(i_AllOtherPremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_AllOtherPremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_AllOtherPremiumOverride,\n\t-- *INF*: DECODE(i_PremOpsTotalPremiumTable1PremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_PremOpsTotalPremiumTable1PremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PremOpsTotalPremiumTable1PremiumOverride,\n\t-- *INF*: DECODE(i_PremOpsTotalPremiumTable2PremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_PremOpsTotalPremiumTable2PremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PremOpsTotalPremiumTable2PremiumOverride,\n\t-- *INF*: DECODE(i_PremOpsTotalPremiumTable3PremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_PremOpsTotalPremiumTable3PremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PremOpsTotalPremiumTable3PremiumOverride,\n\t-- *INF*: DECODE(i_ProductsTotalPremiumTableAPremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ProductsTotalPremiumTableAPremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ProductsTotalPremiumTableAPremiumOverride,\n\t-- *INF*: DECODE(i_ProductsTotalPremiumTableBPremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ProductsTotalPremiumTableBPremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ProductsTotalPremiumTableBPremiumOverride,\n\t-- *INF*: DECODE(i_ProductsTotalPremiumTableCPremiumOverride,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ProductsTotalPremiumTableCPremiumOverride,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ProductsTotalPremiumTableCPremiumOverride,\n\tAllOtherRevisedPremium,\n\tPremOpsTotalPremiumTable1RevisedPremium,\n\tPremOpsTotalPremiumTable2RevisedPremium,\n\tPremOpsTotalPremiumTable3RevisedPremium,\n\tProductsTotalPremiumTableARevisedPremium,\n\tProductsTotalPremiumTableBRevisedPremium,\n\tProductsTotalPremiumTableCRevisedPremium,\n\tScheduledModification,\n\tIncludeCGL AS i_IncludeCGL,\n\tIncludeOhioStopGapLiability AS i_IncludeOhioStopGapLiability,\n\t-- *INF*: DECODE(i_IncludeCGL,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_IncludeCGL,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_IncludeCGL,\n\t-- *INF*: DECODE(i_IncludeOhioStopGapLiability,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_IncludeOhioStopGapLiability,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_IncludeOhioStopGapLiability,\n\tPremium,\n\tPremiumChange,\n\tPremiumWritten,\n\tIDField,\n\tUmbrellaSBOPScheduledModificationLocationInComment,\n\tUmbrellaSBOPScheduledModificationLocationInModification,\n\tUmbrellaSBOPScheduledModificationLocationOutComment,\n\tUmbrellaSBOPScheduledModificationLocationOutModification,\n\tUmbrellaSBOPScheduledModificationPremisesComment,\n\tUmbrellaSBOPScheduledModificationPremisesModification,\n\tUmbrellaSBOPScheduledModificationEquipmentComment,\n\tUmbrellaSBOPScheduledModificationEquipmentModification,\n\tUmbrellaSBOPScheduledModificationManagementComment,\n\tUmbrellaSBOPScheduledModificationManagementModification,\n\tUmbrellaSBOPScheduledModificationEmployeesComment,\n\tUmbrellaSBOPScheduledModificationEmployeesModification,\n\tUmbrellaSBOPScheduledModificationCooperationMedicalComment,\n\tUmbrellaSBOPScheduledModificationCooperationMedicalModification,\n\tUmbrellaSBOPScheduledModificationCooperationSafetyComment,\n\tUmbrellaSBOPScheduledModificationCooperationSafetyModification,\n\tModificationTotal,\n\tModificationTotalForSBOPBusinessDetailPage,\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_WBCUUmbrellaSBOPStage\n),\nArchWBCUUmbrellaSBOPStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchWBCUUmbrellaSBOPStage\n\t(WBCUUmbrellaSBOPStageId, LineId, WBCUUmbrellaSBOPId, SessionId, Deleted, CoverageForm, Description, EffectiveDate, ExpirationDate, PersonalLiability, PolicyNumber, ProfessionalLiabilityEachOccurrenceClaimLimit, ProfessionalLiabilityAggregate, BodilyInjuryByAccidentEachAccident, BodilyInjuryByDiseaseEachEmployee, BodilyInjuryByDiseaseAggregate, FirstMillionBasePremium, FirstMillionModifiedPremium, PremOpsTotalPremiumTable1, PremOpsTotalPremiumTable2, PremOpsTotalPremiumTable3, AllOtherPremium, ProductsTotalPremiumTableA, ProductsTotalPremiumTableB, ProductsTotalPremiumTableC, IncludeProfessionalLiability, AllOtherPremiumOverride, PremOpsTotalPremiumTable1PremiumOverride, PremOpsTotalPremiumTable2PremiumOverride, PremOpsTotalPremiumTable3PremiumOverride, ProductsTotalPremiumTableAPremiumOverride, ProductsTotalPremiumTableBPremiumOverride, ProductsTotalPremiumTableCPremiumOverride, AllOtherRevisedPremium, PremOpsTotalPremiumTable1RevisedPremium, PremOpsTotalPremiumTable2RevisedPremium, PremOpsTotalPremiumTable3RevisedPremium, ProductsTotalPremiumTableARevisedPremium, ProductsTotalPremiumTableBRevisedPremium, ProductsTotalPremiumTableCRevisedPremium, ScheduledModification, IncludeCGL, IncludeOhioStopGapLiability, Premium, PremiumChange, PremiumWritten, IDField, UmbrellaSBOPScheduledModificationLocationInComment, UmbrellaSBOPScheduledModificationLocationInModification, UmbrellaSBOPScheduledModificationLocationOutComment, UmbrellaSBOPScheduledModificationLocationOutModification, UmbrellaSBOPScheduledModificationPremisesComment, UmbrellaSBOPScheduledModificationPremisesModification, UmbrellaSBOPScheduledModificationEquipmentComment, UmbrellaSBOPScheduledModificationEquipmentModification, UmbrellaSBOPScheduledModificationManagementComment, UmbrellaSBOPScheduledModificationManagementModification, UmbrellaSBOPScheduledModificationEmployeesComment, UmbrellaSBOPScheduledModificationEmployeesModification, UmbrellaSBOPScheduledModificationCooperationMedicalComment, UmbrellaSBOPScheduledModificationCooperationMedicalModification, UmbrellaSBOPScheduledModificationCooperationSafetyComment, UmbrellaSBOPScheduledModificationCooperationSafetyModification, ModificationTotal, ModificationTotalForSBOPBusinessDetailPage, ExtractDate, SourceSystemId, AuditId)\n\tSELECT \n\tWBCUUMBRELLASBOPSTAGEID, \n\tLINEID, \n\tWBCUUMBRELLASBOPID, \n\tSESSIONID, \n\to_Deleted AS DELETED, \n\tCOVERAGEFORM, \n\tDESCRIPTION, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\to_PersonalLiability AS PERSONALLIABILITY, \n\tPOLICYNUMBER, \n\tPROFESSIONALLIABILITYEACHOCCURRENCECLAIMLIMIT, \n\tPROFESSIONALLIABILITYAGGREGATE, \n\tBODILYINJURYBYACCIDENTEACHACCIDENT, \n\tBODILYINJURYBYDISEASEEACHEMPLOYEE, \n\tBODILYINJURYBYDISEASEAGGREGATE, \n\tFIRSTMILLIONBASEPREMIUM, \n\tFIRSTMILLIONMODIFIEDPREMIUM, \n\tPREMOPSTOTALPREMIUMTABLE1, \n\tPREMOPSTOTALPREMIUMTABLE2, \n\tPREMOPSTOTALPREMIUMTABLE3, \n\tALLOTHERPREMIUM, \n\tPRODUCTSTOTALPREMIUMTABLEA, \n\tPRODUCTSTOTALPREMIUMTABLEB, \n\tPRODUCTSTOTALPREMIUMTABLEC, \n\to_IncludeProfessionalLiability AS INCLUDEPROFESSIONALLIABILITY, \n\to_AllOtherPremiumOverride AS ALLOTHERPREMIUMOVERRIDE, \n\to_PremOpsTotalPremiumTable1PremiumOverride AS PREMOPSTOTALPREMIUMTABLE1PREMIUMOVERRIDE, \n\to_PremOpsTotalPremiumTable2PremiumOverride AS PREMOPSTOTALPREMIUMTABLE2PREMIUMOVERRIDE, \n\to_PremOpsTotalPremiumTable3PremiumOverride AS PREMOPSTOTALPREMIUMTABLE3PREMIUMOVERRIDE, \n\to_ProductsTotalPremiumTableAPremiumOverride AS PRODUCTSTOTALPREMIUMTABLEAPREMIUMOVERRIDE, \n\to_ProductsTotalPremiumTableBPremiumOverride AS PRODUCTSTOTALPREMIUMTABLEBPREMIUMOVERRIDE, \n\to_ProductsTotalPremiumTableCPremiumOverride AS PRODUCTSTOTALPREMIUMTABLECPREMIUMOVERRIDE, \n\tALLOTHERREVISEDPREMIUM, \n\tPREMOPSTOTALPREMIUMTABLE1REVISEDPREMIUM, \n\tPREMOPSTOTALPREMIUMTABLE2REVISEDPREMIUM, \n\tPREMOPSTOTALPREMIUMTABLE3REVISEDPREMIUM, \n\tPRODUCTSTOTALPREMIUMTABLEAREVISEDPREMIUM, \n\tPRODUCTSTOTALPREMIUMTABLEBREVISEDPREMIUM, \n\tPRODUCTSTOTALPREMIUMTABLECREVISEDPREMIUM, \n\tSCHEDULEDMODIFICATION, \n\to_IncludeCGL AS INCLUDECGL, \n\to_IncludeOhioStopGapLiability AS INCLUDEOHIOSTOPGAPLIABILITY, \n\tPREMIUM, \n\tPREMIUMCHANGE, \n\tPREMIUMWRITTEN, \n\tIDFIELD, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONLOCATIONINCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONLOCATIONINMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONLOCATIONOUTCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONLOCATIONOUTMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONPREMISESCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONPREMISESMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONEQUIPMENTCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONEQUIPMENTMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONMANAGEMENTCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONMANAGEMENTMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONEMPLOYEESCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONEMPLOYEESMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONCOOPERATIONMEDICALCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONCOOPERATIONMEDICALMODIFICATION, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONCOOPERATIONSAFETYCOMMENT, \n\tUMBRELLASBOPSCHEDULEDMODIFICATIONCOOPERATIONSAFETYMODIFICATION, \n\tMODIFICATIONTOTAL, \n\tMODIFICATIONTOTALFORSBOPBUSINESSDETAILPAGE, \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}