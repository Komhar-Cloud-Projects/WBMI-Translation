WITH
SQ_pif_40_stage AS (
	SELECT
		pif_40_stage_id,
		pif_symbol,
		pif_policy_number,
		pif_module,
		rein_rec_length,
		rein_action_code,
		rein_file_id,
		rein_id,
		reins_section_code,
		reins_insurance_line,
		reins_location_number,
		reins_sub_location_number,
		reins_risk_unit_group,
		reins_seq_rsk_unt_grp,
		reins_location,
		reins_risk_sequence,
		reins_risk_type_ind,
		reins_layer,
		reins_company_no,
		reins_eff_year,
		reins_eff_month,
		reins_eff_day,
		reins_percent_prem_ceded,
		reins_percent_loss_ceded,
		reins_percent_fac_comm,
		reins_exp_year,
		reins_exp_month,
		reins_exp_day,
		reins_cession_no,
		reins_type,
		reins_ent_year,
		reins_ent_month,
		reins_ent_day,
		reins_broker_no,
		reins_excess_amt,
		reins_occur_limit,
		reins_aggregate_limit,
		reins_special_use,
		reins_proportional_code,
		reins_pms_future_use,
		reins_cust_future_use,
		reins_yr2000_cust_use,
		reins_dup_key_seq_num,
		logical_flag,
		extract_date,
		as_of_date,
		record_count,
		source_system_id,
		inf_action,
		inf_timestamp
	FROM pif_40_stage
),
EXP_arch_PIF_4578_stage AS (
	SELECT
	pif_40_stage_id,
	pif_symbol,
	pif_policy_number,
	pif_module,
	rein_rec_length,
	rein_action_code,
	rein_file_id,
	rein_id,
	reins_section_code,
	reins_insurance_line,
	reins_location_number,
	reins_sub_location_number,
	reins_risk_unit_group,
	reins_seq_rsk_unt_grp,
	reins_location,
	reins_risk_sequence,
	reins_risk_type_ind,
	reins_layer,
	reins_company_no,
	reins_eff_year,
	reins_eff_month,
	reins_eff_day,
	reins_percent_prem_ceded,
	reins_percent_loss_ceded,
	reins_percent_fac_comm,
	reins_exp_year,
	reins_exp_month,
	reins_exp_day,
	reins_cession_no,
	reins_type,
	reins_ent_year,
	reins_ent_month,
	reins_ent_day,
	reins_broker_no,
	reins_excess_amt,
	reins_occur_limit,
	reins_aggregate_limit,
	reins_special_use,
	reins_proportional_code,
	reins_pms_future_use,
	reins_cust_future_use,
	reins_yr2000_cust_use,
	reins_dup_key_seq_num,
	logical_flag,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	inf_action,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP,
	inf_timestamp
	FROM SQ_pif_40_stage
),
arch_pif_40_stage AS (
	INSERT INTO arch_pif_40_stage
	(pif_40_stage_id, pif_symbol, pif_policy_number, pif_module, rein_rec_length, rein_action_code, rein_file_id, rein_id, reins_section_code, reins_insurance_line, reins_location_number, reins_sub_location_number, reins_risk_unit_group, reins_seq_rsk_unt_grp, reins_location, reins_risk_sequence, reins_risk_type_ind, reins_layer, reins_company_no, reins_eff_year, reins_eff_month, reins_eff_day, reins_percent_prem_ceded, reins_percent_loss_ceded, reins_percent_fac_comm, reins_exp_year, reins_exp_month, reins_exp_day, reins_cession_no, reins_type, reins_ent_year, reins_ent_month, reins_ent_day, reins_broker_no, reins_excess_amt, reins_occur_limit, reins_aggregate_limit, reins_special_use, reins_proportional_code, reins_pms_future_use, reins_cust_future_use, reins_yr2000_cust_use, reins_dup_key_seq_num, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id, inf_action, inf_timestamp)
	SELECT 
	PIF_40_STAGE_ID, 
	PIF_SYMBOL, 
	PIF_POLICY_NUMBER, 
	PIF_MODULE, 
	REIN_REC_LENGTH, 
	REIN_ACTION_CODE, 
	REIN_FILE_ID, 
	REIN_ID, 
	REINS_SECTION_CODE, 
	REINS_INSURANCE_LINE, 
	REINS_LOCATION_NUMBER, 
	REINS_SUB_LOCATION_NUMBER, 
	REINS_RISK_UNIT_GROUP, 
	REINS_SEQ_RSK_UNT_GRP, 
	REINS_LOCATION, 
	REINS_RISK_SEQUENCE, 
	REINS_RISK_TYPE_IND, 
	REINS_LAYER, 
	REINS_COMPANY_NO, 
	REINS_EFF_YEAR, 
	REINS_EFF_MONTH, 
	REINS_EFF_DAY, 
	REINS_PERCENT_PREM_CEDED, 
	REINS_PERCENT_LOSS_CEDED, 
	REINS_PERCENT_FAC_COMM, 
	REINS_EXP_YEAR, 
	REINS_EXP_MONTH, 
	REINS_EXP_DAY, 
	REINS_CESSION_NO, 
	REINS_TYPE, 
	REINS_ENT_YEAR, 
	REINS_ENT_MONTH, 
	REINS_ENT_DAY, 
	REINS_BROKER_NO, 
	REINS_EXCESS_AMT, 
	REINS_OCCUR_LIMIT, 
	REINS_AGGREGATE_LIMIT, 
	REINS_SPECIAL_USE, 
	REINS_PROPORTIONAL_CODE, 
	REINS_PMS_FUTURE_USE, 
	REINS_CUST_FUTURE_USE, 
	REINS_YR2000_CUST_USE, 
	REINS_DUP_KEY_SEQ_NUM, 
	LOGICAL_FLAG, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID, 
	INF_ACTION, 
	INF_TIMESTAMP
	FROM EXP_arch_PIF_4578_stage
),