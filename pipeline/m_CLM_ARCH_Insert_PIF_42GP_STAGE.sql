WITH
SQ_PIF_42GP_stage AS (
	SELECT
		pif_42gp_stage_id AS PIF_42GP_stage_id,
		pif_symbol AS PIF_SYMBOL,
		pif_policy_number AS PIF_POLICY_NUMBER,
		pif_module AS PIF_MODULE,
		ipfcgp_rec_length AS IPFCGP_REC_LENGTH,
		ipfcgp_action_code AS IPFCGP_ACTION_CODE,
		ipfcgp_file_id AS IPFCGP_FILE_ID,
		ipfcgp_segment_id AS IPFCGP_SEGMENT_ID,
		ipfcgp_segment_level_code AS IPFCGP_SEGMENT_LEVEL_CODE,
		ipfcgp_segment_part_code AS IPFCGP_SEGMENT_PART_CODE,
		ipfcgp_sub_part_code AS IPFCGP_SUB_PART_CODE,
		ipfcgp_year_of_loss AS IPFCGP_YEAR_OF_LOSS,
		ipfcgp_month_of_loss AS IPFCGP_MONTH_OF_LOSS,
		ipfcgp_day_of_loss AS IPFCGP_DAY_OF_LOSS,
		ipfcgp_loss_occurence AS IPFCGP_LOSS_OCCURENCE,
		ipfcgp_year_process AS IPFCGP_YEAR_PROCESS,
		ipfcgp_month_process AS IPFCGP_MONTH_PROCESS,
		ipfcgp_day_process AS IPFCGP_DAY_PROCESS,
		ipfcgp_year_change_entry AS IPFCGP_YEAR_CHANGE_ENTRY,
		ipfcgp_month_change_entry AS IPFCGP_MONTH_CHANGE_ENTRY,
		ipfcgp_day_change_entry AS IPFCGP_DAY_CHANGE_ENTRY,
		ipfcgp_sequence_change_entry AS IPFCGP_SEQUENCE_CHANGE_ENTRY,
		ipfcgp_segment_status AS IPFCGP_SEGMENT_STATUS,
		ipfcgp_entry_operator AS IPFCGP_ENTRY_OPERATOR,
		ipfcgp_reinsurance_indicator AS IPFCGP_REINSURANCE_INDICATOR,
		ipfcgp_loss_adjustor_no AS IPFCGP_LOSS_ADJUSTOR_NO,
		ipfcgp_loss_examiner AS IPFCGP_LOSS_EXAMINER,
		ipfcgp_other_assignment AS IPFCGP_OTHER_ASSIGNMENT,
		ipfcgp_account_entered_date AS IPFCGP_ACCOUNT_ENTERED_DATE,
		ipfcgp_loss_handling_office AS IPFCGP_LOSS_HANDLING_OFFICE,
		ipfcgp_loss_handling_branch AS IPFCGP_LOSS_HANDLING_BRANCH,
		ipfcgp_loss_plant_location AS IPFCGP_LOSS_PLANT_LOCATION,
		ipfcgp_loss_accident_state AS IPFCGP_LOSS_ACCIDENT_STATE,
		ipfcgp_loss_catastrophe_no AS IPFCGP_LOSS_CATASTROPHE_NO,
		ipfcgp_excess_catastrophe AS IPFCGP_EXCESS_CATASTROPHE,
		ipfcgp_company_year AS IPFCGP_COMPANY_YEAR,
		ipfcgp_company_month AS IPFCGP_COMPANY_MONTH,
		ipfcgp_company_day AS IPFCGP_COMPANY_DAY,
		ipfcgp_loss_time,
		ipfcgp_loss_day AS IPFCGP_LOSS_DAY,
		ipfcgp_police_authority AS IPFCGP_POLICE_AUTHORITY,
		ipfcgp_agent_received_year AS IPFCGP_AGENT_RECEIVED_YEAR,
		ipfcgp_agent_received_month AS IPFCGP_AGENT_RECEIVED_MONTH,
		ipfcgp_agent_received_day AS IPFCGP_AGENT_RECEIVED_DAY,
		ipfcgp_bulk_claimant_count AS IPFCGP_BULK_CLAIMANT_COUNT,
		ipfcgp_discovery_year AS IPFCGP_DISCOVERY_YEAR,
		ipfcgp_discovery_month AS IPFCGP_DISCOVERY_MONTH,
		ipfcgp_discovery_day AS IPFCGP_DISCOVERY_DAY,
		ipfcgp_claim_number AS IPFCGP_CLAIM_NUMBER,
		ipfcgp_claim_filler AS IPFCGP_CLAIM_FILLER,
		ipfcgp_excess_loss_ind AS IPFCGP_EXCESS_LOSS_IND,
		ipfcgp_claim_status AS IPFCGP_CLAIM_STATUS,
		ipfcgp_loss_original_reserve AS IPFCGP_LOSS_ORIGINAL_RESERVE,
		ipfcgp_os_loss_reserve AS IPFCGP_OS_LOSS_RESERVE,
		ipfcgp_os_expense_reserve AS IPFCGP_OS_EXPENSE_RESERVE,
		ipfcgp_total_loss AS IPFCGP_TOTAL_LOSS,
		ipfcgp_total_expense AS IPFCGP_TOTAL_EXPENSE,
		ipfcgp_total_recoveries AS IPFCGP_TOTAL_RECOVERIES,
		ipfcgp_beg_os_loss_reserve AS IPFCGP_BEG_OS_LOSS_RESERVE,
		ipfcgp_accident_description AS IPFCGP_ACCIDENT_DESCRIPTION,
		ipfcgp_number_of_part78 AS IPFCGP_NUMBER_OF_PART78,
		ipfcgp_notice_of_occurrence AS IPFCGP_NOTICE_OF_OCCURRENCE,
		ipfcgp_offset_onset_ind AS IPFCGP_OFFSET_ONSET_IND,
		ipfcgp_master_claim_number AS IPFCGP_MASTER_CLAIM_NUMBER,
		ipfcgp_processing_location AS IPFCGP_PROCESSING_LOCATION,
		ipfcgp_crime_zip_basic AS IPFCGP_CRIME_ZIP_BASIC,
		ipfcgp_crime_zip_expanded AS IPFCGP_CRIME_ZIP_EXPANDED,
		ipfcgp_cr_sub_line AS IPFCGP_CR_SUB_LINE,
		ipfcgp_pms_future_use_gp AS IPFCGP_PMS_FUTURE_USE_GP,
		ipfcgp_direct_reporting AS IPFCGP_DIRECT_REPORTING,
		ipfcgp_litigated_savings AS IPFCGP_LITIGATED_SAVINGS,
		ipfcgp_cust_spl_use_gp AS IPFCGP_CUST_SPL_USE_GP,
		ipfcgp_yr2000_cust_use AS IPFCGP_YR2000_CUST_USE,
		inf_action,
		inf_timestamp,
		logical_flag,
		extract_date AS EXTRACT_DATE,
		as_of_date AS AS_OF_DATE,
		record_count AS RECORD_COUNT,
		source_system_id AS SOURCE_SYSTEM_ID
	FROM PIF_42GP_stage
),
EXP_arch_PIF_42GP_stage AS (
	SELECT
	PIF_42GP_stage_id,
	PIF_SYMBOL,
	PIF_POLICY_NUMBER,
	PIF_MODULE,
	IPFCGP_REC_LENGTH,
	IPFCGP_ACTION_CODE,
	IPFCGP_FILE_ID,
	IPFCGP_SEGMENT_ID,
	IPFCGP_SEGMENT_LEVEL_CODE,
	IPFCGP_SEGMENT_PART_CODE,
	IPFCGP_SUB_PART_CODE,
	IPFCGP_YEAR_OF_LOSS,
	IPFCGP_MONTH_OF_LOSS,
	IPFCGP_DAY_OF_LOSS,
	IPFCGP_LOSS_OCCURENCE,
	IPFCGP_YEAR_PROCESS,
	IPFCGP_MONTH_PROCESS,
	IPFCGP_DAY_PROCESS,
	IPFCGP_YEAR_CHANGE_ENTRY,
	IPFCGP_MONTH_CHANGE_ENTRY,
	IPFCGP_DAY_CHANGE_ENTRY,
	IPFCGP_SEQUENCE_CHANGE_ENTRY,
	IPFCGP_SEGMENT_STATUS,
	IPFCGP_ENTRY_OPERATOR,
	IPFCGP_REINSURANCE_INDICATOR,
	IPFCGP_LOSS_ADJUSTOR_NO,
	IPFCGP_LOSS_EXAMINER,
	IPFCGP_OTHER_ASSIGNMENT,
	IPFCGP_ACCOUNT_ENTERED_DATE,
	IPFCGP_LOSS_HANDLING_OFFICE,
	IPFCGP_LOSS_HANDLING_BRANCH,
	IPFCGP_LOSS_PLANT_LOCATION,
	IPFCGP_LOSS_ACCIDENT_STATE,
	IPFCGP_LOSS_CATASTROPHE_NO,
	IPFCGP_EXCESS_CATASTROPHE,
	IPFCGP_COMPANY_YEAR,
	IPFCGP_COMPANY_MONTH,
	IPFCGP_COMPANY_DAY,
	IPFCGP_LOSS_DAY,
	ipfcgp_loss_time,
	IPFCGP_POLICE_AUTHORITY,
	IPFCGP_AGENT_RECEIVED_YEAR,
	IPFCGP_AGENT_RECEIVED_MONTH,
	IPFCGP_AGENT_RECEIVED_DAY,
	IPFCGP_BULK_CLAIMANT_COUNT,
	IPFCGP_DISCOVERY_YEAR,
	IPFCGP_DISCOVERY_MONTH,
	IPFCGP_DISCOVERY_DAY,
	IPFCGP_CLAIM_NUMBER,
	IPFCGP_CLAIM_FILLER,
	IPFCGP_EXCESS_LOSS_IND,
	IPFCGP_CLAIM_STATUS,
	IPFCGP_LOSS_ORIGINAL_RESERVE,
	IPFCGP_OS_LOSS_RESERVE,
	IPFCGP_OS_EXPENSE_RESERVE,
	IPFCGP_TOTAL_LOSS,
	IPFCGP_TOTAL_EXPENSE,
	IPFCGP_TOTAL_RECOVERIES,
	IPFCGP_BEG_OS_LOSS_RESERVE,
	IPFCGP_ACCIDENT_DESCRIPTION,
	IPFCGP_NUMBER_OF_PART78,
	IPFCGP_NOTICE_OF_OCCURRENCE,
	IPFCGP_OFFSET_ONSET_IND,
	IPFCGP_MASTER_CLAIM_NUMBER,
	IPFCGP_PROCESSING_LOCATION,
	IPFCGP_CRIME_ZIP_BASIC,
	IPFCGP_CRIME_ZIP_EXPANDED,
	IPFCGP_CR_SUB_LINE,
	IPFCGP_PMS_FUTURE_USE_GP,
	IPFCGP_DIRECT_REPORTING,
	IPFCGP_LITIGATED_SAVINGS,
	IPFCGP_CUST_SPL_USE_GP,
	IPFCGP_YR2000_CUST_USE,
	inf_action,
	inf_timestamp,
	logical_flag,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_PIF_42GP_stage
),
arch_PIF_42GP_stage AS (
	INSERT INTO arch_PIF_42GP_stage
	(pif_42gp_stage_id, pif_symbol, pif_policy_number, pif_module, ipfcgp_rec_length, ipfcgp_action_code, ipfcgp_file_id, ipfcgp_segment_id, ipfcgp_segment_level_code, ipfcgp_segment_part_code, ipfcgp_sub_part_code, ipfcgp_year_of_loss, ipfcgp_month_of_loss, ipfcgp_day_of_loss, ipfcgp_loss_occurence, ipfcgp_year_process, ipfcgp_month_process, ipfcgp_day_process, ipfcgp_year_change_entry, ipfcgp_month_change_entry, ipfcgp_day_change_entry, ipfcgp_sequence_change_entry, ipfcgp_segment_status, ipfcgp_entry_operator, ipfcgp_reinsurance_indicator, ipfcgp_loss_adjustor_no, ipfcgp_loss_examiner, ipfcgp_other_assignment, ipfcgp_account_entered_date, ipfcgp_loss_handling_office, ipfcgp_loss_handling_branch, ipfcgp_loss_plant_location, ipfcgp_loss_accident_state, ipfcgp_loss_catastrophe_no, ipfcgp_excess_catastrophe, ipfcgp_company_year, ipfcgp_company_month, ipfcgp_company_day, ipfcgp_loss_time, ipfcgp_loss_day, ipfcgp_police_authority, ipfcgp_agent_received_year, ipfcgp_agent_received_month, ipfcgp_agent_received_day, ipfcgp_bulk_claimant_count, ipfcgp_discovery_year, ipfcgp_discovery_month, ipfcgp_discovery_day, ipfcgp_claim_number, ipfcgp_claim_filler, ipfcgp_excess_loss_ind, ipfcgp_claim_status, ipfcgp_loss_original_reserve, ipfcgp_os_loss_reserve, ipfcgp_os_expense_reserve, ipfcgp_total_loss, ipfcgp_total_expense, ipfcgp_total_recoveries, ipfcgp_beg_os_loss_reserve, ipfcgp_accident_description, ipfcgp_number_of_part78, ipfcgp_notice_of_occurrence, ipfcgp_offset_onset_ind, ipfcgp_master_claim_number, ipfcgp_processing_location, ipfcgp_crime_zip_basic, ipfcgp_crime_zip_expanded, ipfcgp_cr_sub_line, ipfcgp_pms_future_use_gp, ipfcgp_direct_reporting, ipfcgp_litigated_savings, ipfcgp_cust_spl_use_gp, ipfcgp_yr2000_cust_use, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	PIF_42GP_stage_id AS PIF_42GP_STAGE_ID, 
	PIF_SYMBOL AS PIF_SYMBOL, 
	PIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, 
	PIF_MODULE AS PIF_MODULE, 
	IPFCGP_REC_LENGTH AS IPFCGP_REC_LENGTH, 
	IPFCGP_ACTION_CODE AS IPFCGP_ACTION_CODE, 
	IPFCGP_FILE_ID AS IPFCGP_FILE_ID, 
	IPFCGP_SEGMENT_ID AS IPFCGP_SEGMENT_ID, 
	IPFCGP_SEGMENT_LEVEL_CODE AS IPFCGP_SEGMENT_LEVEL_CODE, 
	IPFCGP_SEGMENT_PART_CODE AS IPFCGP_SEGMENT_PART_CODE, 
	IPFCGP_SUB_PART_CODE AS IPFCGP_SUB_PART_CODE, 
	IPFCGP_YEAR_OF_LOSS AS IPFCGP_YEAR_OF_LOSS, 
	IPFCGP_MONTH_OF_LOSS AS IPFCGP_MONTH_OF_LOSS, 
	IPFCGP_DAY_OF_LOSS AS IPFCGP_DAY_OF_LOSS, 
	IPFCGP_LOSS_OCCURENCE AS IPFCGP_LOSS_OCCURENCE, 
	IPFCGP_YEAR_PROCESS AS IPFCGP_YEAR_PROCESS, 
	IPFCGP_MONTH_PROCESS AS IPFCGP_MONTH_PROCESS, 
	IPFCGP_DAY_PROCESS AS IPFCGP_DAY_PROCESS, 
	IPFCGP_YEAR_CHANGE_ENTRY AS IPFCGP_YEAR_CHANGE_ENTRY, 
	IPFCGP_MONTH_CHANGE_ENTRY AS IPFCGP_MONTH_CHANGE_ENTRY, 
	IPFCGP_DAY_CHANGE_ENTRY AS IPFCGP_DAY_CHANGE_ENTRY, 
	IPFCGP_SEQUENCE_CHANGE_ENTRY AS IPFCGP_SEQUENCE_CHANGE_ENTRY, 
	IPFCGP_SEGMENT_STATUS AS IPFCGP_SEGMENT_STATUS, 
	IPFCGP_ENTRY_OPERATOR AS IPFCGP_ENTRY_OPERATOR, 
	IPFCGP_REINSURANCE_INDICATOR AS IPFCGP_REINSURANCE_INDICATOR, 
	IPFCGP_LOSS_ADJUSTOR_NO AS IPFCGP_LOSS_ADJUSTOR_NO, 
	IPFCGP_LOSS_EXAMINER AS IPFCGP_LOSS_EXAMINER, 
	IPFCGP_OTHER_ASSIGNMENT AS IPFCGP_OTHER_ASSIGNMENT, 
	IPFCGP_ACCOUNT_ENTERED_DATE AS IPFCGP_ACCOUNT_ENTERED_DATE, 
	IPFCGP_LOSS_HANDLING_OFFICE AS IPFCGP_LOSS_HANDLING_OFFICE, 
	IPFCGP_LOSS_HANDLING_BRANCH AS IPFCGP_LOSS_HANDLING_BRANCH, 
	IPFCGP_LOSS_PLANT_LOCATION AS IPFCGP_LOSS_PLANT_LOCATION, 
	IPFCGP_LOSS_ACCIDENT_STATE AS IPFCGP_LOSS_ACCIDENT_STATE, 
	IPFCGP_LOSS_CATASTROPHE_NO AS IPFCGP_LOSS_CATASTROPHE_NO, 
	IPFCGP_EXCESS_CATASTROPHE AS IPFCGP_EXCESS_CATASTROPHE, 
	IPFCGP_COMPANY_YEAR AS IPFCGP_COMPANY_YEAR, 
	IPFCGP_COMPANY_MONTH AS IPFCGP_COMPANY_MONTH, 
	IPFCGP_COMPANY_DAY AS IPFCGP_COMPANY_DAY, 
	IPFCGP_LOSS_TIME, 
	IPFCGP_LOSS_DAY AS IPFCGP_LOSS_DAY, 
	IPFCGP_POLICE_AUTHORITY AS IPFCGP_POLICE_AUTHORITY, 
	IPFCGP_AGENT_RECEIVED_YEAR AS IPFCGP_AGENT_RECEIVED_YEAR, 
	IPFCGP_AGENT_RECEIVED_MONTH AS IPFCGP_AGENT_RECEIVED_MONTH, 
	IPFCGP_AGENT_RECEIVED_DAY AS IPFCGP_AGENT_RECEIVED_DAY, 
	IPFCGP_BULK_CLAIMANT_COUNT AS IPFCGP_BULK_CLAIMANT_COUNT, 
	IPFCGP_DISCOVERY_YEAR AS IPFCGP_DISCOVERY_YEAR, 
	IPFCGP_DISCOVERY_MONTH AS IPFCGP_DISCOVERY_MONTH, 
	IPFCGP_DISCOVERY_DAY AS IPFCGP_DISCOVERY_DAY, 
	IPFCGP_CLAIM_NUMBER AS IPFCGP_CLAIM_NUMBER, 
	IPFCGP_CLAIM_FILLER AS IPFCGP_CLAIM_FILLER, 
	IPFCGP_EXCESS_LOSS_IND AS IPFCGP_EXCESS_LOSS_IND, 
	IPFCGP_CLAIM_STATUS AS IPFCGP_CLAIM_STATUS, 
	IPFCGP_LOSS_ORIGINAL_RESERVE AS IPFCGP_LOSS_ORIGINAL_RESERVE, 
	IPFCGP_OS_LOSS_RESERVE AS IPFCGP_OS_LOSS_RESERVE, 
	IPFCGP_OS_EXPENSE_RESERVE AS IPFCGP_OS_EXPENSE_RESERVE, 
	IPFCGP_TOTAL_LOSS AS IPFCGP_TOTAL_LOSS, 
	IPFCGP_TOTAL_EXPENSE AS IPFCGP_TOTAL_EXPENSE, 
	IPFCGP_TOTAL_RECOVERIES AS IPFCGP_TOTAL_RECOVERIES, 
	IPFCGP_BEG_OS_LOSS_RESERVE AS IPFCGP_BEG_OS_LOSS_RESERVE, 
	IPFCGP_ACCIDENT_DESCRIPTION AS IPFCGP_ACCIDENT_DESCRIPTION, 
	IPFCGP_NUMBER_OF_PART78 AS IPFCGP_NUMBER_OF_PART78, 
	IPFCGP_NOTICE_OF_OCCURRENCE AS IPFCGP_NOTICE_OF_OCCURRENCE, 
	IPFCGP_OFFSET_ONSET_IND AS IPFCGP_OFFSET_ONSET_IND, 
	IPFCGP_MASTER_CLAIM_NUMBER AS IPFCGP_MASTER_CLAIM_NUMBER, 
	IPFCGP_PROCESSING_LOCATION AS IPFCGP_PROCESSING_LOCATION, 
	IPFCGP_CRIME_ZIP_BASIC AS IPFCGP_CRIME_ZIP_BASIC, 
	IPFCGP_CRIME_ZIP_EXPANDED AS IPFCGP_CRIME_ZIP_EXPANDED, 
	IPFCGP_CR_SUB_LINE AS IPFCGP_CR_SUB_LINE, 
	IPFCGP_PMS_FUTURE_USE_GP AS IPFCGP_PMS_FUTURE_USE_GP, 
	IPFCGP_DIRECT_REPORTING AS IPFCGP_DIRECT_REPORTING, 
	IPFCGP_LITIGATED_SAVINGS AS IPFCGP_LITIGATED_SAVINGS, 
	IPFCGP_CUST_SPL_USE_GP AS IPFCGP_CUST_SPL_USE_GP, 
	IPFCGP_YR2000_CUST_USE AS IPFCGP_YR2000_CUST_USE, 
	INF_ACTION, 
	INF_TIMESTAMP, 
	LOGICAL_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_arch_PIF_42GP_stage
),