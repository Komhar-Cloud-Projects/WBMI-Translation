{
    "name": "s_m_CLM_GENERATE_CMS_Claims_Input_File",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_GENERATE_CMS_Claims_Input_File",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Record_Count AS (\n\tSELECT\n\tclaim_med_ak_id,\n\tdummy_integer\n\tFROM (\n\t\tselect (A.claim_med_ak_id + B.claim_med_ak_id) as claim_med_ak_id, 1 as dummy_integer \r\n\t\tFROM\r\n\t\t(SELECT count(*) as claim_med_ak_id FROM dbo.work_claim_cms_detail_extract WHERE audit_id = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}) A,\r\n\t\t(SELECT count(*) as claim_med_ak_id FROM dbo.work_claim_cms_auxiliary_extract WHERE audit_id = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}) B\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY dummy_integer ORDER BY claim_med_ak_id) = 1\n),\nSQ_work_claim_cms_detail_extract AS (\n\tSELECT work_claim_cms_detail_extract.work_claim_cms_detail_extract_id,work_claim_cms_detail_extract.record_identifier,\r\n\t       work_claim_cms_detail_extract.dcn,\r\n\t       work_claim_cms_detail_extract.action_type,\r\n\t       work_claim_cms_detail_extract.injured_party_hicn,\r\n\t       work_claim_cms_detail_extract.injured_party_ssn,\r\n\t       work_claim_cms_detail_extract.injured_party_last_name,\r\n\t       work_claim_cms_detail_extract.injured_party_first_name,\r\n\t       work_claim_cms_detail_extract.injured_party_middle_ini,\r\n\t       work_claim_cms_detail_extract.injured_party_gender,\r\n\t       work_claim_cms_detail_extract.injured_party_dob,\r\n\t       work_claim_cms_detail_extract.reserved_11,\r\n\t       work_claim_cms_detail_extract.cms_date_of_incident,\r\n\t       work_claim_cms_detail_extract.industry_date_of_incident,\r\n\t       work_claim_cms_detail_extract.reserved_14,\r\n\t       work_claim_cms_detail_extract.alleged_cause_of_injury,\r\n\t       work_claim_cms_detail_extract.reserved_16,\r\n\t       work_claim_cms_detail_extract.state_of_venue,\r\n\t       work_claim_cms_detail_extract.icd_indicator,\r\n\t       work_claim_cms_detail_extract.diag_code_1,\r\n\t       work_claim_cms_detail_extract.reserved_20,\r\n\t       work_claim_cms_detail_extract.diag_code_2,\r\n\t       work_claim_cms_detail_extract.reserved_22,\r\n\t       work_claim_cms_detail_extract.diag_code_3,\r\n\t       work_claim_cms_detail_extract.reserved_24,\r\n\t       work_claim_cms_detail_extract.diag_code_4,\r\n\t       work_claim_cms_detail_extract.reserved_26,\r\n\t       work_claim_cms_detail_extract.diag_code_5,\r\n\t       work_claim_cms_detail_extract.reserved_28,\r\n\t       work_claim_cms_detail_extract.diag_code_6,\r\n\t       work_claim_cms_detail_extract.reserved_30,\r\n\t       work_claim_cms_detail_extract.diag_code_7,\r\n\t       work_claim_cms_detail_extract.reserved_32,\r\n\t       work_claim_cms_detail_extract.diag_code_8,\r\n\t       work_claim_cms_detail_extract.reserved_34,\r\n\t       work_claim_cms_detail_extract.diag_code_9,\r\n\t       work_claim_cms_detail_extract.reserved_36,\r\n\t       work_claim_cms_detail_extract.diag_code_10,\r\n\t       work_claim_cms_detail_extract.reserved_38,\r\n\t       work_claim_cms_detail_extract.diag_code_11,\r\n\t       work_claim_cms_detail_extract.reserved_40,\r\n\t       work_claim_cms_detail_extract.diag_code_12,\r\n\t       work_claim_cms_detail_extract.reserved_42,\r\n\t       work_claim_cms_detail_extract.diag_code_13,\r\n\t       work_claim_cms_detail_extract.reserved_44,\r\n\t       work_claim_cms_detail_extract.diag_code_14,\r\n\t       work_claim_cms_detail_extract.reserved_46,\r\n\t       work_claim_cms_detail_extract.diag_code_15,\r\n\t       work_claim_cms_detail_extract.reserved_48,\r\n\t       work_claim_cms_detail_extract.diag_code_16,\r\n\t       work_claim_cms_detail_extract.reserved_50,\r\n\t       work_claim_cms_detail_extract.diag_code_17,\r\n\t       work_claim_cms_detail_extract.reserved_52,\r\n\t       work_claim_cms_detail_extract.diag_code_18,\r\n\t       work_claim_cms_detail_extract.reserved_54,\r\n\t       work_claim_cms_detail_extract.diag_code_19,\r\n\t       work_claim_cms_detail_extract.reserved_56,\r\n\t       work_claim_cms_detail_extract.descript_of_illness,\r\n\t       work_claim_cms_detail_extract.product_liability_ind,\r\n\t       work_claim_cms_detail_extract.product_generic_name,\r\n\t       work_claim_cms_detail_extract.product_brand_name,\r\n\t       work_claim_cms_detail_extract.product_manufacturer,\r\n\t       work_claim_cms_detail_extract.product_alleged_harm,\r\n\t       work_claim_cms_detail_extract.reserved_63,\r\n\t       work_claim_cms_detail_extract.self_insured_ind,\r\n\t       work_claim_cms_detail_extract.self_insured_type,\r\n\t       work_claim_cms_detail_extract.policyholder_last_name,\r\n\t       work_claim_cms_detail_extract.policyholder_first_name,\r\n\t       work_claim_cms_detail_extract.dba_name,\r\n\t       work_claim_cms_detail_extract.legal_name,\r\n\t       work_claim_cms_detail_extract.reserved_70,\r\n\t       work_claim_cms_detail_extract.plan_insurance_type,\r\n\t       work_claim_cms_detail_extract.tin,\r\n\t       work_claim_cms_detail_extract.office_code,\r\n\t       work_claim_cms_detail_extract.policy_number,\r\n\t       work_claim_cms_detail_extract.claim_number,\r\n\t       work_claim_cms_detail_extract.plan_contact_department_name,\r\n\t       work_claim_cms_detail_extract.plan_contact_last_name,\r\n\t       work_claim_cms_detail_extract.plan_contact_first_name,\r\n\t       work_claim_cms_detail_extract.plan_contact_ph,\r\n\t       work_claim_cms_detail_extract.plan_contact_ph_extension,\r\n\t       work_claim_cms_detail_extract.no_fault_insurance_limit,\r\n\t       work_claim_cms_detail_extract.exhaust_date_for_dollar_limit,\r\n\t       work_claim_cms_detail_extract.reserved_83,\r\n\t       work_claim_cms_detail_extract.inj_party_rep_ind,\r\n\t       work_claim_cms_detail_extract.rep_last_name,\r\n\t       work_claim_cms_detail_extract.rep_first_name,\r\n\t       work_claim_cms_detail_extract.rep_firm_name,\r\n\t       work_claim_cms_detail_extract.rep_tin,\r\n\t       work_claim_cms_detail_extract.rep_mail_addr_1,\r\n\t       work_claim_cms_detail_extract.rep_mail_addr_2,\r\n\t       work_claim_cms_detail_extract.rep_city,\r\n\t       work_claim_cms_detail_extract.rep_state,\r\n\t       work_claim_cms_detail_extract.rep_mail_zip_code,\r\n\t       work_claim_cms_detail_extract.rep_mail_zip4,\r\n\t       work_claim_cms_detail_extract.rep_ph,\r\n\t       work_claim_cms_detail_extract.rep_ph_extension,\r\n\t       work_claim_cms_detail_extract.reserved_97,\r\n\t       work_claim_cms_detail_extract.orm_ind,\r\n\t       work_claim_cms_detail_extract.orm_termination_date,\r\n\t       work_claim_cms_detail_extract.tpoc_date,\r\n\t       work_claim_cms_detail_extract.tpoc_amount,\r\n\t       work_claim_cms_detail_extract.funding_delayed_beyond_tpoc_start_date,\r\n\t       work_claim_cms_detail_extract.reserved_103,\r\n\t       work_claim_cms_detail_extract.c1_relationship,\r\n\t       work_claim_cms_detail_extract.c1_tin,\r\n\t       work_claim_cms_detail_extract.c1_last_name,\r\n\t       work_claim_cms_detail_extract.c1_first_name,\r\n\t       work_claim_cms_detail_extract.c1_middle_initial,\r\n\t       work_claim_cms_detail_extract.c1_mail_addr_1,\r\n\t       work_claim_cms_detail_extract.c1_mail_addr_2,\r\n\t       work_claim_cms_detail_extract.c1_city,\r\n\t       work_claim_cms_detail_extract.c1_state,\r\n\t       work_claim_cms_detail_extract.c1_zip,\r\n\t       work_claim_cms_detail_extract.c1_zip4,\r\n\t       work_claim_cms_detail_extract.c1_ph,\r\n\t       work_claim_cms_detail_extract.c1_ph_extension,\r\n\t       work_claim_cms_detail_extract.reserved_117,\r\n\t       work_claim_cms_detail_extract.c1_rep_ind,\r\n\t       work_claim_cms_detail_extract.c1_rep_last_name,\r\n\t       work_claim_cms_detail_extract.c1_rep_first_name,\r\n\t       work_claim_cms_detail_extract.c1_rep_firm_name,\r\n\t       work_claim_cms_detail_extract.c1_rep_tin,\r\n\t       work_claim_cms_detail_extract.c1_rep_mail_addr_1,\r\n\t       work_claim_cms_detail_extract.c1_rep_mail_addr_2,\r\n\t       work_claim_cms_detail_extract.c1_rep_mail_city,\r\n\t       work_claim_cms_detail_extract.c1_rep_state,\r\n\t       work_claim_cms_detail_extract.c1_rep_zip,\r\n\t       work_claim_cms_detail_extract.c1_rep_zip4,\r\n\t       work_claim_cms_detail_extract.c1_rep_ph,\r\n\t       work_claim_cms_detail_extract.c1_rep_ph_extension,\r\n\t       work_claim_cms_detail_extract.reserved_131\r\n\tFROM   work_claim_cms_detail_extract\r\n\tWHERE \r\n\taudit_id =@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tORDER  BY  work_claim_cms_detail_extract_id,\r\n\twork_claim_cms_detail_extract.dcn ASC,\r\n\t          work_claim_cms_detail_extract.action_type DESC\n),\nSQ_work_claim_cms_detail_extract_SSN AS (\n\tSELECT work_claim_cms_detail_extract.work_claim_cms_detail_extract_id, work_claim_cms_detail_extract.injured_party_ssn \r\n\tFROM\r\n\t work_claim_cms_detail_extract \r\n\tWHERE\r\n\t audit_id = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n),\nmplt_Detokinize_WebService_call_detail_extract_SSN AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_SSN_FEIN_TAXID AS (\n\t\tSELECT\n\t\tIN_id AS id,\n\t\tIN_ssn_fein_taxid AS ssn_fein_taxid,\n\t\t-- *INF*: LTRIM(RTRIM(ssn_fein_taxid))\n\t\tLTRIM(RTRIM(ssn_fein_taxid)) AS V_ssn_fein_taxid,\n\t\t-- *INF*: IIF(LENGTH(V_ssn_fein_taxid)=0  or IS_NUMBER(V_ssn_fein_taxid),'FEIN','NONFEIN')\r\n\t\t-- --IIF(LENGTH(V_ssn_fein_taxid)=11 AND REG_MATCH(V_ssn_fein_taxid,'[\\da-zA-Z]+'),'NONFEIN','FEIN')\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(\n\t\t    LENGTH(V_ssn_fein_taxid) = 0 or REGEXP_LIKE(V_ssn_fein_taxid, '^[0-9]+$'), 'FEIN', 'NONFEIN'\n\t\t) AS V_flag,\n\t\tV_flag AS flag,\n\t\tV_ssn_fein_taxid AS o_ssn_fein_taxid\n\t\tFROM INPUT\n\t),\n\tRTR_SSN_FEIN_TAXID AS (\n\t\tSELECT\n\t\tid,\n\t\tflag,\n\t\to_ssn_fein_taxid AS ssn_fein_taxid,\n\t\to_ssn_fein_taxid AS ssn_fein\n\t\tFROM EXP_SSN_FEIN_TAXID\n\t),\n\tRTR_SSN_FEIN_TAXID_FEIN_VALUES AS (SELECT * FROM RTR_SSN_FEIN_TAXID WHERE flag = 'FEIN'),\n\tRTR_SSN_FEIN_TAXID_NONFEIN_VALUES AS (SELECT * FROM RTR_SSN_FEIN_TAXID WHERE flag='NONFEIN'),\n\tEXP_Values AS (\n\t\tSELECT\n\t\tid AS ID,\n\t\t'Detokenize' AS Function,\n\t\t'SSN' AS Scheme,\n\t\tssn_fein_taxid AS SSN_FEIN_TAXID,\n\t\t'DATAFEED_JOBS' AS Requestedby,\n\t\t'Claims' AS Application,\n\t\t'DataFeeds' AS Caller,\n\t\t-- *INF*: 'https://intsvc.wbconnect.com/services/TokenService/Token.svc'\r\n\t\t-- \r\n\t\t-- \r\n\t\t-- \n\t\t'https://intsvc.wbconnect.com/services/TokenService/Token.svc' AS URL,\n\t\tssn_fein AS SSN_FEIN3\n\t\tFROM RTR_SSN_FEIN_TAXID_NONFEIN_VALUES\n\t),\n\tToken AS (-- Token\n\t\n\t\t##############################################\n\t\n\t\t# TODO: Place holder for Custom transformation\n\t\n\t\t##############################################\n\t),\n\tEXP_Response AS (\n\t\tSELECT\n\t\tREF_Id AS ID,\n\t\ttns_Data0 AS TokenResponse,\n\t\tREF_SSN_FEIN_TAXID,\n\t\t-- *INF*: ltrim(rtrim(REPLACECHR(0,TokenResponse,'-',NULL)))\r\n\t\t-- \n\t\tltrim(rtrim(REGEXP_REPLACE(TokenResponse,'-','','i'))) AS o_TokenResponse\n\t\tFROM Token\n\t),\n\tUnion_SSN_FEIN_TAXID AS (\n\t\tSELECT id AS ID, ssn_fein_taxid AS TokenReponse, ssn_fein_taxid AS SSN_FEIN\n\t\tFROM RTR_SSN_FEIN_TAXID_FEIN_VALUES\n\t\tUNION\n\t\tSELECT ID, o_TokenResponse AS TokenReponse, REF_SSN_FEIN_TAXID AS SSN_FEIN\n\t\tFROM EXP_Response\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tID AS OUT_id, \n\t\tTokenReponse AS OUT_TokenResponse, \n\t\tSSN_FEIN AS OUT_IN_ssn_fein_taxid\n\t\tFROM Union_SSN_FEIN_TAXID\n\t),\n),\nJNR_work_claim_cms_detail_extract AS (SELECT\n\tSQ_work_claim_cms_detail_extract.work_claim_cms_detail_extract_id, \n\tSQ_work_claim_cms_detail_extract.Record_Identifier, \n\tSQ_work_claim_cms_detail_extract.DCN, \n\tSQ_work_claim_cms_detail_extract.Action_Type, \n\tSQ_work_claim_cms_detail_extract.injured_party_hicn, \n\tSQ_work_claim_cms_detail_extract.injured_party_ssn, \n\tSQ_work_claim_cms_detail_extract.injured_party_last_name, \n\tSQ_work_claim_cms_detail_extract.injured_party_first_name, \n\tSQ_work_claim_cms_detail_extract.injured_party_middle_ini, \n\tSQ_work_claim_cms_detail_extract.injured_party_gender, \n\tSQ_work_claim_cms_detail_extract.injured_party_dob, \n\tSQ_work_claim_cms_detail_extract.Reserved_11, \n\tSQ_work_claim_cms_detail_extract.CMS_Date_of_Incident, \n\tSQ_work_claim_cms_detail_extract.Industry_Date_of_Incident, \n\tSQ_work_claim_cms_detail_extract.Reserved_14, \n\tSQ_work_claim_cms_detail_extract.Alleged_Cause_of_Injury, \n\tSQ_work_claim_cms_detail_extract.Reserved_16, \n\tSQ_work_claim_cms_detail_extract.State_of_Venue, \n\tSQ_work_claim_cms_detail_extract.icd_indicator, \n\tSQ_work_claim_cms_detail_extract.diag_code_1, \n\tSQ_work_claim_cms_detail_extract.Reserved_20, \n\tSQ_work_claim_cms_detail_extract.diag_code_2, \n\tSQ_work_claim_cms_detail_extract.Reserved_22, \n\tSQ_work_claim_cms_detail_extract.diag_code_3, \n\tSQ_work_claim_cms_detail_extract.Reserved_24, \n\tSQ_work_claim_cms_detail_extract.diag_code_4, \n\tSQ_work_claim_cms_detail_extract.Reserved_26, \n\tSQ_work_claim_cms_detail_extract.diag_code_5, \n\tSQ_work_claim_cms_detail_extract.Reserved_28, \n\tSQ_work_claim_cms_detail_extract.diag_code_6, \n\tSQ_work_claim_cms_detail_extract.Reserved_30, \n\tSQ_work_claim_cms_detail_extract.diag_code_7, \n\tSQ_work_claim_cms_detail_extract.Reserved_32, \n\tSQ_work_claim_cms_detail_extract.diag_code_8, \n\tSQ_work_claim_cms_detail_extract.Reserved_34, \n\tSQ_work_claim_cms_detail_extract.diag_code_9, \n\tSQ_work_claim_cms_detail_extract.Reserved_36, \n\tSQ_work_claim_cms_detail_extract.diag_code_10, \n\tSQ_work_claim_cms_detail_extract.Reserved_38, \n\tSQ_work_claim_cms_detail_extract.diag_code_11, \n\tSQ_work_claim_cms_detail_extract.Reserved_40, \n\tSQ_work_claim_cms_detail_extract.diag_code_12, \n\tSQ_work_claim_cms_detail_extract.Reserved_42, \n\tSQ_work_claim_cms_detail_extract.diag_code_13, \n\tSQ_work_claim_cms_detail_extract.Reserved_44, \n\tSQ_work_claim_cms_detail_extract.diag_code_14, \n\tSQ_work_claim_cms_detail_extract.Reserved_46, \n\tSQ_work_claim_cms_detail_extract.diag_code_15, \n\tSQ_work_claim_cms_detail_extract.Reserved_48, \n\tSQ_work_claim_cms_detail_extract.diag_code_16, \n\tSQ_work_claim_cms_detail_extract.Reserved_50, \n\tSQ_work_claim_cms_detail_extract.diag_code_17, \n\tSQ_work_claim_cms_detail_extract.Reserved_52, \n\tSQ_work_claim_cms_detail_extract.diag_code_18, \n\tSQ_work_claim_cms_detail_extract.Reserved_54, \n\tSQ_work_claim_cms_detail_extract.diag_code_19, \n\tSQ_work_claim_cms_detail_extract.Reserved_56, \n\tSQ_work_claim_cms_detail_extract.descript_of_illness, \n\tSQ_work_claim_cms_detail_extract.Product_Liability_Ind, \n\tSQ_work_claim_cms_detail_extract.Product_Generic_Name, \n\tSQ_work_claim_cms_detail_extract.Product_Brand_Name, \n\tSQ_work_claim_cms_detail_extract.Product_Manufacturer, \n\tSQ_work_claim_cms_detail_extract.Product_Alleged_Harm, \n\tSQ_work_claim_cms_detail_extract.Reserved_63, \n\tSQ_work_claim_cms_detail_extract.Self_Insured_Ind, \n\tSQ_work_claim_cms_detail_extract.Self_Insured_Type, \n\tSQ_work_claim_cms_detail_extract.Policyholder_Last_Name, \n\tSQ_work_claim_cms_detail_extract.Policyholder_First_Name, \n\tSQ_work_claim_cms_detail_extract.DBA_Name, \n\tSQ_work_claim_cms_detail_extract.Legal_Name, \n\tSQ_work_claim_cms_detail_extract.Reserved_70, \n\tSQ_work_claim_cms_detail_extract.Plan_Insurance_Type, \n\tSQ_work_claim_cms_detail_extract.TIN, \n\tSQ_work_claim_cms_detail_extract.Office_Code, \n\tSQ_work_claim_cms_detail_extract.Policy_Number, \n\tSQ_work_claim_cms_detail_extract.Claim_Number, \n\tSQ_work_claim_cms_detail_extract.Plan_Contact_Department_Name, \n\tSQ_work_claim_cms_detail_extract.Plan_Contact_Last_Name, \n\tSQ_work_claim_cms_detail_extract.Plan_Contact_First_Name, \n\tSQ_work_claim_cms_detail_extract.Plan_Contact_Ph, \n\tSQ_work_claim_cms_detail_extract.Plan_Contact_Ph_Extension, \n\tSQ_work_claim_cms_detail_extract.No_Fault_Insurance_Limit, \n\tSQ_work_claim_cms_detail_extract.Exhaust_Date_for_Dollar_Limit, \n\tSQ_work_claim_cms_detail_extract.Reserved_83, \n\tSQ_work_claim_cms_detail_extract.Inj_Party_Rep_Ind, \n\tSQ_work_claim_cms_detail_extract.Rep_Last_Name, \n\tSQ_work_claim_cms_detail_extract.Rep_First_Name, \n\tSQ_work_claim_cms_detail_extract.Rep_Firm_Name, \n\tSQ_work_claim_cms_detail_extract.Rep_TIN, \n\tSQ_work_claim_cms_detail_extract.Rep_Mail_Addr_1, \n\tSQ_work_claim_cms_detail_extract.Rep_Mail_Addr_2, \n\tSQ_work_claim_cms_detail_extract.Rep_City, \n\tSQ_work_claim_cms_detail_extract.Rep_State, \n\tSQ_work_claim_cms_detail_extract.Rep_Mail_Zip_Code, \n\tSQ_work_claim_cms_detail_extract.Rep_Mail_Zip4, \n\tSQ_work_claim_cms_detail_extract.Rep_Ph, \n\tSQ_work_claim_cms_detail_extract.Rep_Ph_Extension, \n\tSQ_work_claim_cms_detail_extract.Reserved_97, \n\tSQ_work_claim_cms_detail_extract.ORM_Ind, \n\tSQ_work_claim_cms_detail_extract.ORM_Termination_Date, \n\tSQ_work_claim_cms_detail_extract.TPOC_Date, \n\tSQ_work_claim_cms_detail_extract.TPOC_Amount, \n\tSQ_work_claim_cms_detail_extract.Funding_Delayed_Beyond_TPOC_Start_Date, \n\tSQ_work_claim_cms_detail_extract.Reserved_103, \n\tSQ_work_claim_cms_detail_extract.c1_relationship, \n\tSQ_work_claim_cms_detail_extract.c1_tin, \n\tSQ_work_claim_cms_detail_extract.c1_last_name, \n\tSQ_work_claim_cms_detail_extract.c1_first_name, \n\tSQ_work_claim_cms_detail_extract.c1_middle_initial, \n\tSQ_work_claim_cms_detail_extract.c1_mail_addr_1, \n\tSQ_work_claim_cms_detail_extract.c1_mail_addr_2, \n\tSQ_work_claim_cms_detail_extract.c1_city, \n\tSQ_work_claim_cms_detail_extract.c1_state, \n\tSQ_work_claim_cms_detail_extract.c1_zip, \n\tSQ_work_claim_cms_detail_extract.c1_zip4, \n\tSQ_work_claim_cms_detail_extract.c1_ph, \n\tSQ_work_claim_cms_detail_extract.c1_ph_extension, \n\tSQ_work_claim_cms_detail_extract.Reserved_117, \n\tSQ_work_claim_cms_detail_extract.c1_rep_ind, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Last_Name, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_First_Name, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Firm_Name, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_TIN, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Mail_Addr_1, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Mail_Addr_2, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Mail_City, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_State, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Zip, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Zip4, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Ph, \n\tSQ_work_claim_cms_detail_extract.C1_Rep_Ph_Extension, \n\tSQ_work_claim_cms_detail_extract.Reserved_131, \n\tmplt_Detokinize_WebService_call_detail_extract_SSN.OUT_id AS IN_mplt_id, \n\tmplt_Detokinize_WebService_call_detail_extract_SSN.OUT_TokenResponse AS TokenResponse\n\tFROM SQ_work_claim_cms_detail_extract\n\tINNER JOIN mplt_Detokinize_WebService_call_detail_extract_SSN\n\tON mplt_Detokinize_WebService_call_detail_extract_SSN.OUT_id = SQ_work_claim_cms_detail_extract.work_claim_cms_detail_extract_id\n),\nEXP_Detail AS (\n\tSELECT\n\tRecord_Identifier,\n\tDCN,\n\tAction_Type,\n\tinjured_party_hicn,\n\tTokenResponse AS injured_party_ssn,\n\t-- *INF*: REPLACECHR(0,injured_party_ssn,'-',NULL)\n\tREGEXP_REPLACE(injured_party_ssn,'-','','i') AS v_injured_party_ssn,\n\tv_injured_party_ssn AS o_injured_party_ssn,\n\tinjured_party_last_name,\n\tinjured_party_first_name,\n\tinjured_party_middle_ini,\n\tinjured_party_gender,\n\tinjured_party_dob,\n\tReserved_11,\n\tCMS_Date_of_Incident,\n\tIndustry_Date_of_Incident,\n\tReserved_14,\n\tAlleged_Cause_of_Injury,\n\tReserved_16,\n\tState_of_Venue,\n\ticd_indicator,\n\tdiag_code_1,\n\tReserved_20,\n\tdiag_code_2,\n\tReserved_22,\n\tdiag_code_3,\n\tReserved_24,\n\tdiag_code_4,\n\tReserved_26,\n\tdiag_code_5,\n\tReserved_28,\n\tdiag_code_6,\n\tReserved_30,\n\tdiag_code_7,\n\tReserved_32,\n\tdiag_code_8,\n\tReserved_34,\n\tdiag_code_9,\n\tReserved_36,\n\tdiag_code_10,\n\tReserved_38,\n\tdiag_code_11,\n\tReserved_40,\n\tdiag_code_12,\n\tReserved_42,\n\tdiag_code_13,\n\tReserved_44,\n\tdiag_code_14,\n\tReserved_46,\n\tdiag_code_15,\n\tReserved_48,\n\tdiag_code_16,\n\tReserved_50,\n\tdiag_code_17,\n\tReserved_52,\n\tdiag_code_18,\n\tReserved_54,\n\tdiag_code_19,\n\tReserved_56,\n\t-- *INF*: substr(Reserved_56,1,57)\n\tsubstr(Reserved_56, 1, 57) AS Reserved_56_out,\n\tdescript_of_illness,\n\tProduct_Liability_Ind,\n\tProduct_Generic_Name,\n\tProduct_Brand_Name,\n\tProduct_Manufacturer,\n\tProduct_Alleged_Harm,\n\tReserved_63,\n\tSelf_Insured_Ind,\n\tSelf_Insured_Type,\n\tPolicyholder_Last_Name,\n\tPolicyholder_First_Name,\n\tDBA_Name,\n\tLegal_Name,\n\tReserved_70,\n\tPlan_Insurance_Type,\n\tTIN,\n\tOffice_Code,\n\tPolicy_Number,\n\tClaim_Number,\n\tPlan_Contact_Department_Name,\n\tPlan_Contact_Last_Name,\n\tPlan_Contact_First_Name,\n\tPlan_Contact_Ph,\n\tPlan_Contact_Ph_Extension,\n\tNo_Fault_Insurance_Limit,\n\tExhaust_Date_for_Dollar_Limit,\n\tReserved_83,\n\tInj_Party_Rep_Ind,\n\tRep_Last_Name,\n\tRep_First_Name,\n\tRep_Firm_Name,\n\tRep_TIN,\n\tRep_Mail_Addr_1,\n\tRep_Mail_Addr_2,\n\tRep_City,\n\tRep_State,\n\tRep_Mail_Zip_Code,\n\tRep_Mail_Zip4,\n\tRep_Ph,\n\tRep_Ph_Extension,\n\tReserved_97,\n\tORM_Ind,\n\tORM_Termination_Date,\n\tTPOC_Date,\n\tTPOC_Amount,\n\tFunding_Delayed_Beyond_TPOC_Start_Date,\n\tReserved_103,\n\tc1_relationship,\n\tc1_tin,\n\tc1_last_name,\n\tc1_first_name,\n\tc1_middle_initial,\n\tc1_mail_addr_1,\n\tc1_mail_addr_2,\n\tc1_city,\n\tc1_state,\n\tc1_zip,\n\tc1_zip4,\n\tc1_ph,\n\tc1_ph_extension,\n\tReserved_117,\n\tc1_rep_ind,\n\tC1_Rep_Last_Name,\n\tC1_Rep_First_Name,\n\tC1_Rep_Firm_Name,\n\tC1_Rep_TIN,\n\tC1_Rep_Mail_Addr_1,\n\tC1_Rep_Mail_Addr_2,\n\tC1_Rep_Mail_City,\n\tC1_Rep_State,\n\tC1_Rep_Zip,\n\tC1_Rep_Zip4,\n\tC1_Rep_Ph,\n\tC1_Rep_Ph_Extension,\n\tReserved_131,\n\t'' AS O_assign_null_values_to_TIN\n\tFROM JNR_work_claim_cms_detail_extract\n),\nCMS_Claims_Input_File_Detail AS (\n\tINSERT INTO CMS_Claims_Input_File_Detail\n\t(Record_Identifier, DCN, Action_Type, Inj_Party_HICN, Inj_Party_SSN, Inj_Party_Last_Name, Inj_Party_First_Name, Inj_Party_Middle_Ini, Inj_Party_Gender, Inj_Party_DOB, Reserved_11, CMS_Date_of_Incident, Industry_Date_of_Incident, Reserved_14, Alleged_Cause_of_Injury, State_of_Venue, ICD_Indicator, Diagnosis_Code_1, Diagnosis_Code_2, Diagnosis_Code_3, Diagnosis_Code_4, Diagnosis_Code_5, Diagnosis_Code_6, Diagnosis_Code_7, Diagnosis_Code_8, Diagnosis_Code_9, Diagnosis_Code_10, Diagnosis_Code_11, Diagnosis_Code_12, Diagnosis_Code_13, Diagnosis_Code_14, Diagnosis_Code_15, Diagnosis_Code_16, Diagnosis_Code_17, Diagnosis_Code_18, Diagnosis_Code_19, Reserved_56, Description_of_Illness, Product_Liability_Ind, Product_Generic_Name, Product_Brand_Name, Product_Manufacturer, Product_Alleged_Harm, Reserved_63, Self_Insured_Ind, Self_Insured_Type, Policyholder_Last_Name, Policyholder_First_Name, DBA_Name, Legal_Name, Reserved_70, Plan_Insurance_Type, TIN, Office_Code, Policy_Number, Claim_Number, Plan_Contact_Department_Name, Plan_Contact_Last_Name, Plan_Contact_First_Name, Plan_Contact_Ph, Plan_Contact_Ph_Extension, No_Fault_Insurance_Limit, Exhaust_Date_for_Dollar_Limit, Reserved_83, Inj_Party_Rep_Ind, Rep_Last_Name, Rep_First_Name, Rep_Firm_Name, Rep_TIN, Rep_Mail_Addr_1, Rep_Mail_Addr_2, Rep_City, Rep_State, Rep_Mail_Zip_Code, Rep_Mail_Zip4, Rep_Ph, Rep_Ph_Extension, Reserved_97, ORM_Ind, ORM_Termination_Date, TPOC_Date, TPOC_Amount, Funding_Delayed_Beyond_TPOC_Start_Date, Reserved_103, Claimant_1_Relationship, Claimant_1_TIN, Claimant_1_Last_Name, Claimant_1_First_Name, Claimant_1_Middle_Initial, Claimant_1_Mail_Addr_1, Claimant_1_Mail_Addr_2, Claimant_1City, Claimant_1_State, Claimant_1_Zip, Claimant_1_Zip4, Claimant_1_Ph, Claimant_1_Ph_Extension, Reserved_117, Claimant_1_Rep_Ind, C1_Rep_Last_Name, C1_Rep_First_Name, C1_Rep_Firm_Name, C1_Rep_TIN, C1_Rep_Mail_Addr_1, C1_Rep_Mail_Addr_2, C1_Rep_Mail_City, C1_Rep_State, C1_Rep_Zip, C1_Rep_Zip4, C1_Rep_Ph, C1_Rep_Ph_Extension, Reserved_131)\n\tSELECT \n\tRECORD_IDENTIFIER, \n\tDCN, \n\tACTION_TYPE, \n\tinjured_party_hicn AS INJ_PARTY_HICN, \n\to_injured_party_ssn AS INJ_PARTY_SSN, \n\tinjured_party_last_name AS INJ_PARTY_LAST_NAME, \n\tinjured_party_first_name AS INJ_PARTY_FIRST_NAME, \n\tinjured_party_middle_ini AS INJ_PARTY_MIDDLE_INI, \n\tinjured_party_gender AS INJ_PARTY_GENDER, \n\tinjured_party_dob AS INJ_PARTY_DOB, \n\tRESERVED_11, \n\tCMS_DATE_OF_INCIDENT, \n\tINDUSTRY_DATE_OF_INCIDENT, \n\tRESERVED_14, \n\tALLEGED_CAUSE_OF_INJURY, \n\tSTATE_OF_VENUE, \n\ticd_indicator AS ICD_INDICATOR, \n\tdiag_code_1 AS DIAGNOSIS_CODE_1, \n\tdiag_code_2 AS DIAGNOSIS_CODE_2, \n\tdiag_code_3 AS DIAGNOSIS_CODE_3, \n\tdiag_code_4 AS DIAGNOSIS_CODE_4, \n\tdiag_code_5 AS DIAGNOSIS_CODE_5, \n\tdiag_code_6 AS DIAGNOSIS_CODE_6, \n\tdiag_code_7 AS DIAGNOSIS_CODE_7, \n\tdiag_code_8 AS DIAGNOSIS_CODE_8, \n\tdiag_code_9 AS DIAGNOSIS_CODE_9, \n\tdiag_code_10 AS DIAGNOSIS_CODE_10, \n\tdiag_code_11 AS DIAGNOSIS_CODE_11, \n\tdiag_code_12 AS DIAGNOSIS_CODE_12, \n\tdiag_code_13 AS DIAGNOSIS_CODE_13, \n\tdiag_code_14 AS DIAGNOSIS_CODE_14, \n\tdiag_code_15 AS DIAGNOSIS_CODE_15, \n\tdiag_code_16 AS DIAGNOSIS_CODE_16, \n\tdiag_code_17 AS DIAGNOSIS_CODE_17, \n\tdiag_code_18 AS DIAGNOSIS_CODE_18, \n\tdiag_code_19 AS DIAGNOSIS_CODE_19, \n\tReserved_56_out AS RESERVED_56, \n\tdescript_of_illness AS DESCRIPTION_OF_ILLNESS, \n\tPRODUCT_LIABILITY_IND, \n\tPRODUCT_GENERIC_NAME, \n\tPRODUCT_BRAND_NAME, \n\tPRODUCT_MANUFACTURER, \n\tPRODUCT_ALLEGED_HARM, \n\tRESERVED_63, \n\tSELF_INSURED_IND, \n\tSELF_INSURED_TYPE, \n\tPOLICYHOLDER_LAST_NAME, \n\tPOLICYHOLDER_FIRST_NAME, \n\tDBA_NAME, \n\tLEGAL_NAME, \n\tRESERVED_70, \n\tPLAN_INSURANCE_TYPE, \n\tTIN, \n\tOFFICE_CODE, \n\tPOLICY_NUMBER, \n\tCLAIM_NUMBER, \n\tPLAN_CONTACT_DEPARTMENT_NAME, \n\tPLAN_CONTACT_LAST_NAME, \n\tPLAN_CONTACT_FIRST_NAME, \n\tPLAN_CONTACT_PH, \n\tPLAN_CONTACT_PH_EXTENSION, \n\tNO_FAULT_INSURANCE_LIMIT, \n\tEXHAUST_DATE_FOR_DOLLAR_LIMIT, \n\tRESERVED_83, \n\tINJ_PARTY_REP_IND, \n\tREP_LAST_NAME, \n\tREP_FIRST_NAME, \n\tREP_FIRM_NAME, \n\tO_assign_null_values_to_TIN AS REP_TIN, \n\tREP_MAIL_ADDR_1, \n\tREP_MAIL_ADDR_2, \n\tREP_CITY, \n\tREP_STATE, \n\tREP_MAIL_ZIP_CODE, \n\tREP_MAIL_ZIP4, \n\tREP_PH, \n\tREP_PH_EXTENSION, \n\tRESERVED_97, \n\tORM_IND, \n\tORM_TERMINATION_DATE, \n\tTPOC_DATE, \n\tTPOC_AMOUNT, \n\tFUNDING_DELAYED_BEYOND_TPOC_START_DATE, \n\tRESERVED_103, \n\tc1_relationship AS CLAIMANT_1_RELATIONSHIP, \n\tO_assign_null_values_to_TIN AS CLAIMANT_1_TIN, \n\tc1_last_name AS CLAIMANT_1_LAST_NAME, \n\tc1_first_name AS CLAIMANT_1_FIRST_NAME, \n\tc1_middle_initial AS CLAIMANT_1_MIDDLE_INITIAL, \n\tc1_mail_addr_1 AS CLAIMANT_1_MAIL_ADDR_1, \n\tc1_mail_addr_2 AS CLAIMANT_1_MAIL_ADDR_2, \n\tc1_city AS CLAIMANT_1CITY, \n\tc1_state AS CLAIMANT_1_STATE, \n\tc1_zip AS CLAIMANT_1_ZIP, \n\tc1_zip4 AS CLAIMANT_1_ZIP4, \n\tc1_ph AS CLAIMANT_1_PH, \n\tc1_ph_extension AS CLAIMANT_1_PH_EXTENSION, \n\tRESERVED_117, \n\tc1_rep_ind AS CLAIMANT_1_REP_IND, \n\tC1_REP_LAST_NAME, \n\tC1_REP_FIRST_NAME, \n\tC1_REP_FIRM_NAME, \n\tO_assign_null_values_to_TIN AS C1_REP_TIN, \n\tC1_REP_MAIL_ADDR_1, \n\tC1_REP_MAIL_ADDR_2, \n\tC1_REP_MAIL_CITY, \n\tC1_REP_STATE, \n\tC1_REP_ZIP, \n\tC1_REP_ZIP4, \n\tC1_REP_PH, \n\tC1_REP_PH_EXTENSION, \n\tRESERVED_131\n\tFROM EXP_Detail\n),\nSQ_work_claim_cms_auxiliary_extract AS (\n\tSELECT work_claim_cms_auxiliary_extract.work_claim_cms_auxiliary_extract_id, work_claim_cms_auxiliary_extract.claim_med_ak_id, work_claim_cms_auxiliary_extract.claim_party_occurrence_ak_id, work_claim_cms_auxiliary_extract.claim_med_plan_ak_id, work_claim_cms_auxiliary_extract.claim_occurrence_ak_id, work_claim_cms_auxiliary_extract.claim_party_ak_id, work_claim_cms_auxiliary_extract.record_identifier, work_claim_cms_auxiliary_extract.dcn, work_claim_cms_auxiliary_extract.injured_party_hicn, work_claim_cms_auxiliary_extract.injured_party_ssn, work_claim_cms_auxiliary_extract.injured_party_last_name, work_claim_cms_auxiliary_extract.injured_party_first_name, work_claim_cms_auxiliary_extract.c2_relationship, work_claim_cms_auxiliary_extract.c2_tin, work_claim_cms_auxiliary_extract.c2_last_name, work_claim_cms_auxiliary_extract.c2_first_name, work_claim_cms_auxiliary_extract.c2_middle_initial, work_claim_cms_auxiliary_extract.c2_mail_addr_1, work_claim_cms_auxiliary_extract.c2_mail_addr_2, work_claim_cms_auxiliary_extract.c2_city, work_claim_cms_auxiliary_extract.c2_state, work_claim_cms_auxiliary_extract.c2_zip, work_claim_cms_auxiliary_extract.c2_zip4, work_claim_cms_auxiliary_extract.c2_ph, work_claim_cms_auxiliary_extract.c2_ph_extension, work_claim_cms_auxiliary_extract.reserved_20, work_claim_cms_auxiliary_extract.c2_rep_ind, work_claim_cms_auxiliary_extract.c2_rep_last_name, work_claim_cms_auxiliary_extract.c2_rep_first_name, work_claim_cms_auxiliary_extract.c2_rep_firm_name, work_claim_cms_auxiliary_extract.c2_rep_tin, work_claim_cms_auxiliary_extract.c2_rep_mail_addr_1, work_claim_cms_auxiliary_extract.c2_rep_mail_addr_2, work_claim_cms_auxiliary_extract.c2_rep_city, work_claim_cms_auxiliary_extract.c2_rep_state, work_claim_cms_auxiliary_extract.c2_rep_zip, work_claim_cms_auxiliary_extract.c2_rep_zip4, work_claim_cms_auxiliary_extract.c2_rep_ph, work_claim_cms_auxiliary_extract.c2_rep_ph_extension, work_claim_cms_auxiliary_extract.reserved_34, work_claim_cms_auxiliary_extract.c3_relationship, work_claim_cms_auxiliary_extract.c3_tin, work_claim_cms_auxiliary_extract.c3_last_name, work_claim_cms_auxiliary_extract.c3_first_name, work_claim_cms_auxiliary_extract.c3_middle_initial, work_claim_cms_auxiliary_extract.c3_mail_addr_1, work_claim_cms_auxiliary_extract.c3_mail_addr_2, work_claim_cms_auxiliary_extract.c3_city, work_claim_cms_auxiliary_extract.c3_state, work_claim_cms_auxiliary_extract.c3_zip, work_claim_cms_auxiliary_extract.c3_zip4, work_claim_cms_auxiliary_extract.c3_ph, work_claim_cms_auxiliary_extract.c3_ph_extension, work_claim_cms_auxiliary_extract.reserved_48, work_claim_cms_auxiliary_extract.c3_rep_ind, work_claim_cms_auxiliary_extract.c3_rep_last_name, work_claim_cms_auxiliary_extract.c3_rep_first_name, work_claim_cms_auxiliary_extract.c3_rep_firm_name, work_claim_cms_auxiliary_extract.c3_rep_tin, work_claim_cms_auxiliary_extract.c3_rep_mail_addr_1, work_claim_cms_auxiliary_extract.c3_rep_mail_addr_2, work_claim_cms_auxiliary_extract.c3_rep_city, work_claim_cms_auxiliary_extract.c3_rep_state, work_claim_cms_auxiliary_extract.c3_rep_zip, work_claim_cms_auxiliary_extract.c3_rep_zip4, work_claim_cms_auxiliary_extract.c3_rep_ph, work_claim_cms_auxiliary_extract.c3_rep_ph_extension, work_claim_cms_auxiliary_extract.reserved_62, work_claim_cms_auxiliary_extract.c4_relationship, work_claim_cms_auxiliary_extract.c4_tin, work_claim_cms_auxiliary_extract.c4_last_name, work_claim_cms_auxiliary_extract.c4_first_name, work_claim_cms_auxiliary_extract.c4_middle_initial, work_claim_cms_auxiliary_extract.c4_mail_addr_1, work_claim_cms_auxiliary_extract.c4_mail_addr_2, work_claim_cms_auxiliary_extract.c4_city, work_claim_cms_auxiliary_extract.c4_state, work_claim_cms_auxiliary_extract.c4_zip, work_claim_cms_auxiliary_extract.c4_zip4, work_claim_cms_auxiliary_extract.c4_ph, work_claim_cms_auxiliary_extract.c4_ph_extension, work_claim_cms_auxiliary_extract.reserved_76, work_claim_cms_auxiliary_extract.c4_rep_ind, work_claim_cms_auxiliary_extract.c4_rep_last_name, work_claim_cms_auxiliary_extract.c4_rep_first_name, work_claim_cms_auxiliary_extract.c4_rep_firm_name, work_claim_cms_auxiliary_extract.c4_rep_tin, work_claim_cms_auxiliary_extract.c4_rep_mail_addr_1, work_claim_cms_auxiliary_extract.c4_rep_mail_addr_2, work_claim_cms_auxiliary_extract.c4_rep_city, work_claim_cms_auxiliary_extract.c4_rep_state, work_claim_cms_auxiliary_extract.c4_rep_zip, work_claim_cms_auxiliary_extract.c4_rep_zip4, work_claim_cms_auxiliary_extract.c4_rep_ph, work_claim_cms_auxiliary_extract.c4_rep_ph_extension, work_claim_cms_auxiliary_extract.tpoc_date_2, work_claim_cms_auxiliary_extract.tpoc_amount_2, work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_2, work_claim_cms_auxiliary_extract.tpoc_date_3, work_claim_cms_auxiliary_extract.tpoc_amount_3, work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_3, work_claim_cms_auxiliary_extract.tpoc_date_4, work_claim_cms_auxiliary_extract.tpoc_amount_4, work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_4, work_claim_cms_auxiliary_extract.tpoc_date_5, work_claim_cms_auxiliary_extract.tpoc_amount_5, work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_5, work_claim_cms_auxiliary_extract.reserved_102 \r\n\tFROM\r\n\t work_claim_cms_auxiliary_extract \r\n\tWHERE\r\n\t audit_id =@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n),\nSQ_work_claim_cms_auxiliary_extract_SSN AS (\n\tSELECT work_claim_cms_auxiliary_extract.work_claim_cms_auxiliary_extract_id, work_claim_cms_auxiliary_extract.injured_party_ssn \r\n\tFROM\r\n\t work_claim_cms_auxiliary_extract \r\n\tWHERE\r\n\t audit_id = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n),\nmplt_Detokinize_WebService_call_auxiliary_extract_SSN AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_SSN_FEIN_TAXID AS (\n\t\tSELECT\n\t\tIN_id AS id,\n\t\tIN_ssn_fein_taxid AS ssn_fein_taxid,\n\t\t-- *INF*: LTRIM(RTRIM(ssn_fein_taxid))\n\t\tLTRIM(RTRIM(ssn_fein_taxid)) AS V_ssn_fein_taxid,\n\t\t-- *INF*: IIF(LENGTH(V_ssn_fein_taxid)=0  or IS_NUMBER(V_ssn_fein_taxid),'FEIN','NONFEIN')\r\n\t\t-- --IIF(LENGTH(V_ssn_fein_taxid)=11 AND REG_MATCH(V_ssn_fein_taxid,'[\\da-zA-Z]+'),'NONFEIN','FEIN')\r\n\t\t-- \r\n\t\t-- \n\t\tIFF(\n\t\t    LENGTH(V_ssn_fein_taxid) = 0 or REGEXP_LIKE(V_ssn_fein_taxid, '^[0-9]+$'), 'FEIN', 'NONFEIN'\n\t\t) AS V_flag,\n\t\tV_flag AS flag,\n\t\tV_ssn_fein_taxid AS o_ssn_fein_taxid\n\t\tFROM INPUT\n\t),\n\tRTR_SSN_FEIN_TAXID AS (\n\t\tSELECT\n\t\tid,\n\t\tflag,\n\t\to_ssn_fein_taxid AS ssn_fein_taxid,\n\t\to_ssn_fein_taxid AS ssn_fein\n\t\tFROM EXP_SSN_FEIN_TAXID\n\t),\n\tRTR_SSN_FEIN_TAXID_FEIN_VALUES AS (SELECT * FROM RTR_SSN_FEIN_TAXID WHERE flag = 'FEIN'),\n\tRTR_SSN_FEIN_TAXID_NONFEIN_VALUES AS (SELECT * FROM RTR_SSN_FEIN_TAXID WHERE flag='NONFEIN'),\n\tEXP_Values AS (\n\t\tSELECT\n\t\tid AS ID,\n\t\t'Detokenize' AS Function,\n\t\t'SSN' AS Scheme,\n\t\tssn_fein_taxid AS SSN_FEIN_TAXID,\n\t\t'DATAFEED_JOBS' AS Requestedby,\n\t\t'Claims' AS Application,\n\t\t'DataFeeds' AS Caller,\n\t\t-- *INF*: 'https://intsvc.wbconnect.com/services/TokenService/Token.svc'\r\n\t\t-- \r\n\t\t-- \r\n\t\t-- \n\t\t'https://intsvc.wbconnect.com/services/TokenService/Token.svc' AS URL,\n\t\tssn_fein AS SSN_FEIN3\n\t\tFROM RTR_SSN_FEIN_TAXID_NONFEIN_VALUES\n\t),\n\tToken AS (-- Token\n\t\n\t\t##############################################\n\t\n\t\t# TODO: Place holder for Custom transformation\n\t\n\t\t##############################################\n\t),\n\tEXP_Response AS (\n\t\tSELECT\n\t\tREF_Id AS ID,\n\t\ttns_Data0 AS TokenResponse,\n\t\tREF_SSN_FEIN_TAXID,\n\t\t-- *INF*: ltrim(rtrim(REPLACECHR(0,TokenResponse,'-',NULL)))\r\n\t\t-- \n\t\tltrim(rtrim(REGEXP_REPLACE(TokenResponse,'-','','i'))) AS o_TokenResponse\n\t\tFROM Token\n\t),\n\tUnion_SSN_FEIN_TAXID AS (\n\t\tSELECT id AS ID, ssn_fein_taxid AS TokenReponse, ssn_fein_taxid AS SSN_FEIN\n\t\tFROM RTR_SSN_FEIN_TAXID_FEIN_VALUES\n\t\tUNION\n\t\tSELECT ID, o_TokenResponse AS TokenReponse, REF_SSN_FEIN_TAXID AS SSN_FEIN\n\t\tFROM EXP_Response\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tID AS OUT_id, \n\t\tTokenReponse AS OUT_TokenResponse, \n\t\tSSN_FEIN AS OUT_IN_ssn_fein_taxid\n\t\tFROM Union_SSN_FEIN_TAXID\n\t),\n),\nJNR_work_claim_cms_auxiliary_extract AS (SELECT\n\tSQ_work_claim_cms_auxiliary_extract.work_claim_cms_auxiliary_extract_id, \n\tSQ_work_claim_cms_auxiliary_extract.claim_med_ak_id, \n\tSQ_work_claim_cms_auxiliary_extract.claim_party_occurrence_ak_id, \n\tSQ_work_claim_cms_auxiliary_extract.claim_med_plan_ak_id, \n\tSQ_work_claim_cms_auxiliary_extract.claim_occurrence_ak_id, \n\tSQ_work_claim_cms_auxiliary_extract.claim_party_ak_id, \n\tSQ_work_claim_cms_auxiliary_extract.Record_Identifier, \n\tSQ_work_claim_cms_auxiliary_extract.DCN, \n\tSQ_work_claim_cms_auxiliary_extract.injured_party_hicn, \n\tSQ_work_claim_cms_auxiliary_extract.injured_party_ssn, \n\tSQ_work_claim_cms_auxiliary_extract.injured_party_last_name, \n\tSQ_work_claim_cms_auxiliary_extract.injured_party_first_name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Relationship, \n\tSQ_work_claim_cms_auxiliary_extract.C2_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Middle_Initial, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C2_City, \n\tSQ_work_claim_cms_auxiliary_extract.C2_State, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_20, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Ind, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Firm_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_City, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_State, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C2_Rep_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_34, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Relationship, \n\tSQ_work_claim_cms_auxiliary_extract.C3_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C3_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Middle_Initial, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C3_City, \n\tSQ_work_claim_cms_auxiliary_extract.C3_State, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_48, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Ind, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Firm_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_City, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_State, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C3_Rep_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_62, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Relationship, \n\tSQ_work_claim_cms_auxiliary_extract.C4_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C4_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Middle_Initial, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C4_City, \n\tSQ_work_claim_cms_auxiliary_extract.C4_State, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_76, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Ind, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Last_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_First_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Firm_Name, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_TIN, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Mail_Addr_1, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Mail_Addr_2, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_City, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_State, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Zip, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Zip4, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Ph, \n\tSQ_work_claim_cms_auxiliary_extract.C4_Rep_Ph_Extension, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Date_2, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Amount_2, \n\tSQ_work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_2, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Date_3, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Amount_3, \n\tSQ_work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_3, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Date_4, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Amount_4, \n\tSQ_work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_4, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Date_5, \n\tSQ_work_claim_cms_auxiliary_extract.TPOC_Amount_5, \n\tSQ_work_claim_cms_auxiliary_extract.funding_dld_tpoc_st_date_5, \n\tSQ_work_claim_cms_auxiliary_extract.Reserved_102, \n\tmplt_Detokinize_WebService_call_auxiliary_extract_SSN.OUT_id AS IN_mplt_id, \n\tmplt_Detokinize_WebService_call_auxiliary_extract_SSN.OUT_TokenResponse AS TokenResponse\n\tFROM SQ_work_claim_cms_auxiliary_extract\n\tINNER JOIN mplt_Detokinize_WebService_call_auxiliary_extract_SSN\n\tON mplt_Detokinize_WebService_call_auxiliary_extract_SSN.OUT_id = SQ_work_claim_cms_auxiliary_extract.work_claim_cms_auxiliary_extract_id\n),\nEXP_Auxialiary AS (\n\tSELECT\n\tclaim_med_ak_id,\n\tclaim_party_occurrence_ak_id,\n\tclaim_med_plan_ak_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_ak_id,\n\tRecord_Identifier,\n\tDCN,\n\tinjured_party_hicn,\n\tTokenResponse AS injured_party_ssn,\n\tinjured_party_last_name,\n\tinjured_party_first_name,\n\tC2_Relationship,\n\tC2_TIN,\n\tC2_Last_Name,\n\tC2_First_Name,\n\tC2_Middle_Initial,\n\tC2_Mail_Addr_1,\n\tC2_Mail_Addr_2,\n\tC2_City,\n\tC2_State,\n\tC2_Zip,\n\tC2_Zip4,\n\tC2_Ph,\n\tC2_Ph_Extension,\n\tReserved_20,\n\tC2_Rep_Ind,\n\tC2_Rep_Last_Name,\n\tC2_Rep_First_Name,\n\tC2_Rep_Firm_Name,\n\tC2_Rep_TIN,\n\tC2_Rep_Mail_Addr_1,\n\tC2_Rep_Mail_Addr_2,\n\tC2_Rep_City,\n\tC2_Rep_State,\n\tC2_Rep_Zip,\n\tC2_Rep_Zip4,\n\tC2_Rep_Ph,\n\tC2_Rep_Ph_Extension,\n\tReserved_34,\n\tC3_Relationship,\n\tC3_TIN,\n\tC3_Last_Name,\n\tC3_First_Name,\n\tC3_Middle_Initial,\n\tC3_Mail_Addr_1,\n\tC3_Mail_Addr_2,\n\tC3_City,\n\tC3_State,\n\tC3_Zip,\n\tC3_Zip4,\n\tC3_Ph,\n\tC3_Ph_Extension,\n\tReserved_48,\n\tC3_Rep_Ind,\n\tC3_Rep_Last_Name,\n\tC3_Rep_First_Name,\n\tC3_Rep_Firm_Name,\n\tC3_Rep_TIN,\n\tC3_Rep_Mail_Addr_1,\n\tC3_Rep_Mail_Addr_2,\n\tC3_Rep_City,\n\tC3_Rep_State,\n\tC3_Rep_Zip,\n\tC3_Rep_Zip4,\n\tC3_Rep_Ph,\n\tC3_Rep_Ph_Extension,\n\tReserved_62,\n\tC4_Relationship,\n\tC4_TIN,\n\tC4_Last_Name,\n\tC4_First_Name,\n\tC4_Middle_Initial,\n\tC4_Mail_Addr_1,\n\tC4_Mail_Addr_2,\n\tC4_City,\n\tC4_State,\n\tC4_Zip,\n\tC4_Zip4,\n\tC4_Ph,\n\tC4_Ph_Extension,\n\tReserved_76,\n\tC4_Rep_Ind,\n\tC4_Rep_Last_Name,\n\tC4_Rep_First_Name,\n\tC4_Rep_Firm_Name,\n\tC4_Rep_TIN,\n\tC4_Rep_Mail_Addr_1,\n\tC4_Rep_Mail_Addr_2,\n\tC4_Rep_City,\n\tC4_Rep_State,\n\tC4_Rep_Zip,\n\tC4_Rep_Zip4,\n\tC4_Rep_Ph,\n\tC4_Rep_Ph_Extension,\n\tTPOC_Date_2,\n\tTPOC_Amount_2,\n\tfunding_dld_tpoc_st_date_2,\n\tTPOC_Date_3,\n\tTPOC_Amount_3,\n\tfunding_dld_tpoc_st_date_3,\n\tTPOC_Date_4,\n\tTPOC_Amount_4,\n\tfunding_dld_tpoc_st_date_4,\n\tTPOC_Date_5,\n\tTPOC_Amount_5,\n\tfunding_dld_tpoc_st_date_5,\n\tReserved_102,\n\t'' AS O_Assing_null_val_to_TIN\n\tFROM JNR_work_claim_cms_auxiliary_extract\n),\nCMS_Claims_Input_File_auxiliary AS (\n\tINSERT INTO CMS_Claims_Input_File_auxiliary\n\t(Record_Identifier, DCN, Inj_Party_HICN, Inj_Party_SSN, Inj_Party_Last_Name, Inj_Party_First_Name, C2_Relationship, C2_TIN, C2_Last_Name, C2_First_Name, C2_Middle_Initial, C2_Mail_Addr_1, C2_Mail_Addr_2, C2_City, C2_State, C2_Zip, C2_Zip4, C2_Ph, C2_Ph_Extension, Reserved_20, C2_Rep_Ind, C2_Rep_Last_Name, C2_Rep_First_Name, C2_Rep_Firm_Name, C2_Rep_TIN, C2_Rep_Mail_Addr_1, C2_Rep_Mail_Addr_2, C2_Rep_City, C2_Rep_State, C2_Rep_Zip, C2_Rep_Zip4, C2_Rep_Ph, C2_Rep_Ph_Extension, Reserved_34, C3_Relationship, C3_TIN, C3_Last_Name, C3_First_Name, C3_Middle_Initial, C3_Mail_Addr_1, C3_Mail_Addr_2, C3_City, C3_State, C3_Zip, C3_Zip4, C3_Ph, C3_Ph_Extension, Reserved_48, C3_Rep_Ind, C3_Rep_Last_Name, C3_Rep_First_Name, C3_Rep_Firm_Name, C3_Rep_TIN, C3_Rep_Mail_Addr_1, C3_Rep_Mail_Addr_2, C3_Rep_City, C3_Rep_State, C3_Rep_Zip, C3_Rep_Zip4, C3_Rep_Ph, C3_Rep_Ph_Extension, Reserved_62, C4_Relationship, C4_TIN, C4_Last_Name, C4_First_Name, C4_Middle_Initial, C4_Mail_Addr_1, C4_Mail_Addr_2, C4_City, C4_State, C4_Zip, C4_Zip4, C4_Ph, C4_Ph_Extension, Reserved_76, C4_Rep_Ind, C4_Rep_Last_Name, C4_Rep_First_Name, C4_Rep_Firm_Name, C4_Rep_TIN, C4_Rep_Mail_Addr_1, C4_Rep_Mail_Addr_2, C4_Rep_City, C4_Rep_State, C4_Rep_Zip, C4_Rep_Zip4, C4_Rep_Ph, C4_Rep_Ph_Extension, TPOC_Date_2, TPOC_Amount_2, Funding_Dld_Beyond_TPOC_St_Date_2, TPOC_Date_3, TPOC_Amount_3, Funding_TPOC_St_Date_3, TPOC_Date_4, TPOC_Amount_4, Funding_TPOC_St_Date_4, TPOC_Date_5, TPOC_Amount_5, Funding_TPOC_St_Date_5, Reserved_102)\n\tSELECT \n\tRECORD_IDENTIFIER, \n\tDCN, \n\tinjured_party_hicn AS INJ_PARTY_HICN, \n\tinjured_party_ssn AS INJ_PARTY_SSN, \n\tinjured_party_last_name AS INJ_PARTY_LAST_NAME, \n\tinjured_party_first_name AS INJ_PARTY_FIRST_NAME, \n\tC2_RELATIONSHIP, \n\tO_Assing_null_val_to_TIN AS C2_TIN, \n\tC2_LAST_NAME, \n\tC2_FIRST_NAME, \n\tC2_MIDDLE_INITIAL, \n\tC2_MAIL_ADDR_1, \n\tC2_MAIL_ADDR_2, \n\tC2_CITY, \n\tC2_STATE, \n\tC2_ZIP, \n\tC2_ZIP4, \n\tC2_PH, \n\tC2_PH_EXTENSION, \n\tRESERVED_20, \n\tC2_REP_IND, \n\tC2_REP_LAST_NAME, \n\tC2_REP_FIRST_NAME, \n\tC2_REP_FIRM_NAME, \n\tO_Assing_null_val_to_TIN AS C2_REP_TIN, \n\tC2_REP_MAIL_ADDR_1, \n\tC2_REP_MAIL_ADDR_2, \n\tC2_REP_CITY, \n\tC2_REP_STATE, \n\tC2_REP_ZIP, \n\tC2_REP_ZIP4, \n\tC2_REP_PH, \n\tC2_REP_PH_EXTENSION, \n\tRESERVED_34, \n\tC3_RELATIONSHIP, \n\tO_Assing_null_val_to_TIN AS C3_TIN, \n\tC3_LAST_NAME, \n\tC3_FIRST_NAME, \n\tC3_MIDDLE_INITIAL, \n\tC3_MAIL_ADDR_1, \n\tC3_MAIL_ADDR_2, \n\tC3_CITY, \n\tC3_STATE, \n\tC3_ZIP, \n\tC3_ZIP4, \n\tC3_PH, \n\tC3_PH_EXTENSION, \n\tRESERVED_48, \n\tC3_REP_IND, \n\tC3_REP_LAST_NAME, \n\tC3_REP_FIRST_NAME, \n\tC3_REP_FIRM_NAME, \n\tO_Assing_null_val_to_TIN AS C3_REP_TIN, \n\tC3_REP_MAIL_ADDR_1, \n\tC3_REP_MAIL_ADDR_2, \n\tC3_REP_CITY, \n\tC3_REP_STATE, \n\tC3_REP_ZIP, \n\tC3_REP_ZIP4, \n\tC3_REP_PH, \n\tC3_REP_PH_EXTENSION, \n\tRESERVED_62, \n\tC4_RELATIONSHIP, \n\tO_Assing_null_val_to_TIN AS C4_TIN, \n\tC4_LAST_NAME, \n\tC4_FIRST_NAME, \n\tC4_MIDDLE_INITIAL, \n\tC4_MAIL_ADDR_1, \n\tC4_MAIL_ADDR_2, \n\tC4_CITY, \n\tC4_STATE, \n\tC4_ZIP, \n\tC4_ZIP4, \n\tC4_PH, \n\tC4_PH_EXTENSION, \n\tRESERVED_76, \n\tC4_REP_IND, \n\tC4_REP_LAST_NAME, \n\tC4_REP_FIRST_NAME, \n\tC4_REP_FIRM_NAME, \n\tO_Assing_null_val_to_TIN AS C4_REP_TIN, \n\tC4_REP_MAIL_ADDR_1, \n\tC4_REP_MAIL_ADDR_2, \n\tC4_REP_CITY, \n\tC4_REP_STATE, \n\tC4_REP_ZIP, \n\tC4_REP_ZIP4, \n\tC4_REP_PH, \n\tC4_REP_PH_EXTENSION, \n\tTPOC_DATE_2, \n\tTPOC_AMOUNT_2, \n\tfunding_dld_tpoc_st_date_2 AS FUNDING_DLD_BEYOND_TPOC_ST_DATE_2, \n\tTPOC_DATE_3, \n\tTPOC_AMOUNT_3, \n\tfunding_dld_tpoc_st_date_3 AS FUNDING_TPOC_ST_DATE_3, \n\tTPOC_DATE_4, \n\tTPOC_AMOUNT_4, \n\tfunding_dld_tpoc_st_date_4 AS FUNDING_TPOC_ST_DATE_4, \n\tTPOC_DATE_5, \n\tTPOC_AMOUNT_5, \n\tfunding_dld_tpoc_st_date_5 AS FUNDING_TPOC_ST_DATE_5, \n\tRESERVED_102\n\tFROM EXP_Auxialiary\n),\nSQ_Claim_File_Header AS (\n\tSELECT\n\t\tsup_cms_tin_office_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tsource_sys_id,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tcms_rre_id,\n\t\toffice_tin_num,\n\t\toffice_code,\n\t\toffice_name,\n\t\toffice_mail_address1,\n\t\toffice_mail_address2,\n\t\toffice_mail_city,\n\t\toffice_mail_state,\n\t\toffice_mail_zip,\n\t\toffice_mail_zip4\n\tFROM sup_cms_tin_office\n\tWHERE crrnt_snpsht_flag=1\n),\nEXP_Header AS (\n\tSELECT\n\t'NGCH' AS Record_Identifier,\n\tcms_rre_id,\n\t-- *INF*: lpad(rtrim(cms_rre_id),9,'0')\n\tlpad(rtrim(cms_rre_id), 9, '0') AS cms_rre_id_out,\n\t'NGHPCLM' AS Reporting_File_Type,\n\t-- *INF*: TO_CHAR(SYSDATE,'YYYYMMDD')\n\tTO_CHAR(CURRENT_TIMESTAMP, 'YYYYMMDD') AS File_Submission_date,\n\t'' AS Default_String\n\tFROM SQ_Claim_File_Header\n),\nCMS_Claims_Input_File_Header AS (\n\tINSERT INTO CMS_Claims_Input_File_HeaderTrailer\n\t(Record_Identifier, Reporter_Id, Reporting_File_Type, File_Submission_Date, File_Record_Count, Reserved)\n\tSELECT \n\tRECORD_IDENTIFIER, \n\tcms_rre_id_out AS REPORTER_ID, \n\tREPORTING_FILE_TYPE, \n\tFile_Submission_date AS FILE_SUBMISSION_DATE, \n\tDefault_String AS FILE_RECORD_COUNT, \n\tDefault_String AS RESERVED\n\tFROM EXP_Header\n),\nSQ_CMS_Claim_Input_File AS (\n\n-- TODO Manual --\n\n),\nEXP_1 AS (\n\tSELECT\n\tRecord_Identifier,\n\tDCN,\n\t-- *INF*: rtrim(DCN)\n\trtrim(DCN) AS DCN1,\n\tOther_values AS Other_Values\n\tFROM SQ_CMS_Claim_Input_File\n),\nSRT_1 AS (\n\tSELECT\n\tRecord_Identifier, \n\tDCN1 AS DCN, \n\tOther_Values\n\tFROM EXP_1\n\tORDER BY DCN ASC\n),\nCMS_Claim_Input_File AS (\n\tINSERT INTO CMS_Claim_Input_File\n\t(Record_Identifier, DCN, Other_values)\n\tSELECT \n\tRECORD_IDENTIFIER, \n\tDCN, \n\tOther_Values AS OTHER_VALUES\n\tFROM SRT_1\n),\nSQ_Claim_File_Trailer AS (\n\tSELECT\n\t\tsup_cms_tin_office_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tsource_sys_id,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tcms_rre_id,\n\t\toffice_tin_num,\n\t\toffice_code,\n\t\toffice_name,\n\t\toffice_mail_address1,\n\t\toffice_mail_address2,\n\t\toffice_mail_city,\n\t\toffice_mail_state,\n\t\toffice_mail_zip,\n\t\toffice_mail_zip4\n\tFROM sup_cms_tin_office1\n\tWHERE crrnt_snpsht_flag=1\n),\nEXP_Trailer AS (\n\tSELECT\n\t'NGCT' AS Record_Identifier,\n\tcms_rre_id,\n\t-- *INF*: lpad(rtrim(cms_rre_id),9,'0')\n\tlpad(rtrim(cms_rre_id), 9, '0') AS cms_rre_id_out,\n\t'NGHPCLM' AS Reporting_File_Type,\n\t-- *INF*: TO_CHAR(SYSDATE,'YYYYMMDD')\n\tTO_CHAR(CURRENT_TIMESTAMP, 'YYYYMMDD') AS File_Submission_date,\n\t-- *INF*: :LKP.LKP_Record_Count (1)\n\tLKP_RECORD_COUNT_1.claim_med_ak_id AS v_File_Record_Count,\n\t-- *INF*: LPAD(to_char(v_File_Record_Count),7,'0')\r\n\t-- \n\tLPAD(to_char(v_File_Record_Count), 7, '0') AS File_Record_Count,\n\t'' AS Default_String\n\tFROM SQ_Claim_File_Trailer\n\tLEFT JOIN LKP_RECORD_COUNT LKP_RECORD_COUNT_1\n\tON LKP_RECORD_COUNT_1.dummy_integer = 1\n\n),\nCMS_Claims_Input_File_Trailer AS (\n\tINSERT INTO CMS_Claims_Input_File_HeaderTrailer\n\t(Record_Identifier, Reporter_Id, Reporting_File_Type, File_Submission_Date, File_Record_Count, Reserved)\n\tSELECT \n\tRECORD_IDENTIFIER, \n\tcms_rre_id_out AS REPORTER_ID, \n\tREPORTING_FILE_TYPE, \n\tFile_Submission_date AS FILE_SUBMISSION_DATE, \n\tFILE_RECORD_COUNT, \n\tDefault_String AS RESERVED\n\tFROM EXP_Trailer\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}