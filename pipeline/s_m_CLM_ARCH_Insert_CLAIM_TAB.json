{
    "name": "s_m_CLM_ARCH_Insert_CLAIM_TAB",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_CLAIM_TAB",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nARCH_CLAIM_TAB_STAGE1 AS (\n\n\t-- TODO - To be translated\n),\nSQ_CLAIM_TAB_STAGE AS (\n\tSELECT\n\t\tclaim_tab_id AS CLAIM_TAB_ID,\n\t\tclm_claim_nbr AS CLM_CLAIM_NBR,\n\t\tclm_cause_loss_cd AS CLM_CAUSE_LOSS_CD,\n\t\tclm_claim_comments AS CLM_CLAIM_COMMENTS,\n\t\tclm_csr_claim_nbr AS CLM_CSR_CLAIM_NBR,\n\t\tclm_community_cd AS CLM_COMMUNITY_CD,\n\t\tclm_create_ts AS CLM_CREATE_TS,\n\t\tclm_entry_opr_id AS CLM_ENTRY_OPR_ID,\n\t\tclm_pmsd_ts AS CLM_PMSD_TS,\n\t\tclm_occurrence_id AS CLM_OCCURRENCE_ID,\n\t\tclm_reported_dt AS CLM_REPORTED_DT,\n\t\tclm_status_cd AS CLM_STATUS_CD,\n\t\tclm_update_opr_id AS CLM_UPDATE_OPR_ID,\n\t\tclm_upd_ts AS CLM_UPD_TS,\n\t\tclm_loss_occ_cd AS CLM_LOSS_OCC_CD,\n\t\tclm_ato_chg_by AS CLM_ATO_CHG_BY,\n\t\tclm_ato_chg_dt AS CLM_ATO_CHG_DT,\n\t\tclm_co_asn_dt AS CLM_CO_ASN_DT,\n\t\tclm_co_asn_rsn_cd AS CLM_CO_ASN_RSN_CD,\n\t\tclm_dir_ato_lmt AS CLM_DIR_ATO_LMT,\n\t\tclm_postal_cd AS CLM_POSTAL_CD,\n\t\tclm_fin_ind AS CLM_FIN_IND,\n\t\tclm_discovery_dt AS CLM_DISCOVERY_DT,\n\t\tclm_xpn_ato_lmt AS CLM_XPN_ATO_LMT,\n\t\tclm_ho_report_ind AS CLM_HO_REPORT_IND,\n\t\tclm_litigation_ind AS CLM_LITIGATION_IND,\n\t\tclm_recovery_ind AS CLM_RECOVERY_IND,\n\t\tclm_loss_dt AS CLM_LOSS_DT,\n\t\tclm_loss_tm AS CLM_LOSS_TM,\n\t\tclm_loss_city AS CLM_LOSS_CITY,\n\t\tclm_loss_county AS CLM_LOSS_COUNTY,\n\t\tclm_loss_des_id AS CLM_LOSS_DES_ID,\n\t\tclm_loss_state_cd AS CLM_LOSS_STATE_CD,\n\t\tclm_major_case_dt AS CLM_MAJOR_CASE_DT,\n\t\tclm_maj_case_rea AS CLM_MAJ_CASE_REA,\n\t\tclm_med_ato_lmt AS CLM_MED_ATO_LMT,\n\t\tclm_not_claim_ind AS CLM_NOT_CLAIM_IND,\n\t\tnot_of_occ_ind AS NOT_OF_OCC_IND,\n\t\tclm_pre_rpt_ind AS CLM_PRE_RPT_IND,\n\t\tclm_reported_tm AS CLM_REPORTED_TM,\n\t\tclm_demand_amt AS CLM_DEMAND_AMT,\n\t\tclm_archive_dt AS CLM_ARCHIVE_DT,\n\t\tclm_archive_plc_cd AS CLM_ARCHIVE_PLC_CD,\n\t\tclm_stampled_dt AS CLM_STAMPLED_DT,\n\t\tclm_type_cd AS CLM_TYPE_CD,\n\t\tclm_closed_dt AS CLM_CLOSED_DT,\n\t\tclm_severity_cd AS CLM_SEVERITY_CD,\n\t\tclm_indemnity_ind AS CLM_INDEMNITY_IND,\n\t\tclm_controvert_ind AS CLM_CONTROVERT_IND,\n\t\tclm_mediation_ind AS CLM_MEDIATION_IND,\n\t\tclm_doc_type_cd AS CLM_DOC_TYPE_CD,\n\t\tclm_loss_county_cd AS CLM_LOSS_COUNTY_CD,\n\t\tclm_res_lmt_ind AS CLM_RES_LMT_IND,\n\t\tclm_pmt_lmt_ind AS CLM_PMT_LMT_IND,\n\t\tclm_loss_place_id AS CLM_LOSS_PLACE_ID,\n\t\tclm_report_nbr AS CLM_REPORT_NBR,\n\t\tclm_violation_ind AS CLM_VIOLATION_IND,\n\t\tclm_road_type_cd AS CLM_ROAD_TYPE_CD,\n\t\tclm_road_srf_d AS CLM_ROAD_SRF_D,\n\t\tclm_speed_lim_nbr AS CLM_SPEED_LIM_NBR,\n\t\tclm_light_con_cd AS CLM_LIGHT_CON_CD,\n\t\tclm_densely_ind AS CLM_DENSELY_IND,\n\t\tclm_traf_light_ind AS CLM_TRAF_LIGHT_IND,\n\t\tclm_prc_sta_ind AS CLM_PRC_STA_IND,\n\t\tclm_claim_cat_cd AS CLM_CLAIM_CAT_CD,\n\t\tclm_subro_ind AS CLM_SUBRO_IND,\n\t\tclm_invest_ind AS CLM_INVEST_IND,\n\t\tclm_out_deduct_ind AS CLM_OUT_DEDUCT_IND,\n\t\tclm_subcont_ind AS CLM_SUBCONT_IND,\n\t\tclm_activity_sta AS CLM_ACTIVITY_STA,\n\t\tclm_rei_notify_dt AS CLM_REI_NOTIFY_DT,\n\t\tclm_emp_std_ind_cd AS CLM_EMP_STD_IND_CD,\n\t\tclm_at_fault_cd AS CLM_AT_FAULT_CD,\n\t\tclm_driver_nbr AS CLM_DRIVER_NBR,\n\t\tclm_drv_same_ind AS CLM_DRV_SAME_IND,\n\t\tclm_rep_to_car_dt AS CLM_REP_TO_CAR_DT,\n\t\tclm_viol_cit_desc AS CLM_VIOL_CIT_DESC,\n\t\tclm_how_clm_rptd AS CLM_HOW_CLM_RPTD,\n\t\tclm_method_rptd AS CLM_METHOD_RPTD,\n\t\tclm_agency_code AS CLM_AGENCY_CODE,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID,\n\t\tclm_wc_cat_code,\n\t\tclm_primary_loc_code,\n\t\tclm_secondary_dept_code,\n\t\tclm_xact_transaction_id,\n\t\tclm_survey,\n\t\tclm_survey_recipient,\n\t\tclm_survey_contact_method,\n\t\tclm_survey_primary_handler\n\tFROM CLAIM_TAB_STAGE\n),\nEXP_CLAIM_TAB_STAGE AS (\n\tSELECT\n\tCLAIM_TAB_ID,\n\tCLM_CLAIM_NBR,\n\tCLM_CAUSE_LOSS_CD,\n\tCLM_CLAIM_COMMENTS,\n\tCLM_CSR_CLAIM_NBR,\n\tCLM_COMMUNITY_CD,\n\tCLM_CREATE_TS,\n\tCLM_ENTRY_OPR_ID,\n\tCLM_PMSD_TS,\n\tCLM_OCCURRENCE_ID,\n\tCLM_REPORTED_DT,\n\tCLM_STATUS_CD,\n\tCLM_UPDATE_OPR_ID,\n\tCLM_UPD_TS,\n\tCLM_LOSS_OCC_CD,\n\tCLM_ATO_CHG_BY,\n\tCLM_ATO_CHG_DT,\n\tCLM_CO_ASN_DT,\n\tCLM_CO_ASN_RSN_CD,\n\tCLM_DIR_ATO_LMT,\n\tCLM_POSTAL_CD,\n\tCLM_FIN_IND,\n\tCLM_DISCOVERY_DT,\n\tCLM_XPN_ATO_LMT,\n\tCLM_HO_REPORT_IND,\n\tCLM_LITIGATION_IND,\n\tCLM_RECOVERY_IND,\n\tCLM_LOSS_DT,\n\tCLM_LOSS_TM,\n\tCLM_LOSS_CITY,\n\tCLM_LOSS_COUNTY,\n\tCLM_LOSS_DES_ID,\n\tCLM_LOSS_STATE_CD,\n\tCLM_MAJOR_CASE_DT,\n\tCLM_MAJ_CASE_REA,\n\tCLM_MED_ATO_LMT,\n\tCLM_NOT_CLAIM_IND,\n\tNOT_OF_OCC_IND,\n\tCLM_PRE_RPT_IND,\n\tCLM_REPORTED_TM,\n\tCLM_DEMAND_AMT,\n\tCLM_ARCHIVE_DT,\n\tCLM_ARCHIVE_PLC_CD,\n\tCLM_STAMPLED_DT,\n\tCLM_TYPE_CD,\n\tCLM_CLOSED_DT,\n\tCLM_SEVERITY_CD,\n\tCLM_INDEMNITY_IND,\n\tCLM_CONTROVERT_IND,\n\tCLM_MEDIATION_IND,\n\tCLM_DOC_TYPE_CD,\n\tCLM_LOSS_COUNTY_CD,\n\tCLM_RES_LMT_IND,\n\tCLM_PMT_LMT_IND,\n\tCLM_LOSS_PLACE_ID,\n\tCLM_REPORT_NBR,\n\tCLM_VIOLATION_IND,\n\tCLM_ROAD_TYPE_CD,\n\tCLM_ROAD_SRF_D,\n\tCLM_SPEED_LIM_NBR,\n\tCLM_LIGHT_CON_CD,\n\tCLM_DENSELY_IND,\n\tCLM_TRAF_LIGHT_IND,\n\tCLM_PRC_STA_IND,\n\tCLM_CLAIM_CAT_CD,\n\tCLM_SUBRO_IND,\n\tCLM_INVEST_IND,\n\tCLM_OUT_DEDUCT_IND,\n\tCLM_SUBCONT_IND,\n\tCLM_ACTIVITY_STA,\n\tCLM_REI_NOTIFY_DT,\n\tCLM_EMP_STD_IND_CD,\n\tCLM_AT_FAULT_CD,\n\tCLM_DRIVER_NBR,\n\tCLM_DRV_SAME_IND,\n\tCLM_REP_TO_CAR_DT,\n\tCLM_VIOL_CIT_DESC,\n\tCLM_HOW_CLM_RPTD,\n\tCLM_METHOD_RPTD,\n\tCLM_AGENCY_CODE,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP,\n\tclm_wc_cat_code,\n\tclm_primary_loc_code,\n\tclm_secondary_dept_code,\n\tclm_xact_transaction_id,\n\tclm_survey,\n\tclm_survey_recipient,\n\tclm_survey_contact_method,\n\tclm_survey_primary_handler\n\tFROM SQ_CLAIM_TAB_STAGE\n),\nARCH_CLAIM_TAB_STAGE AS (\n\tINSERT INTO ARCH_CLAIM_TAB_STAGE\n\t(claim_tab_id, clm_claim_nbr, clm_cause_loss_cd, clm_claim_comments, clm_csr_claim_nbr, clm_community_cd, clm_create_ts, clm_entry_opr_id, clm_pmsd_ts, clm_occurrence_id, clm_reported_dt, clm_status_cd, clm_update_opr_id, clm_upd_ts, clm_loss_occ_cd, clm_ato_chg_by, clm_ato_chg_dt, clm_co_asn_dt, clm_co_asn_rsn_cd, clm_dir_ato_lmt, clm_postal_cd, clm_fin_ind, clm_discovery_dt, clm_xpn_ato_lmt, clm_ho_report_ind, clm_litigation_ind, clm_recovery_ind, clm_loss_dt, clm_loss_tm, clm_loss_city, clm_loss_county, clm_loss_des_id, clm_loss_state_cd, clm_major_case_dt, clm_maj_case_rea, clm_med_ato_lmt, clm_not_claim_ind, not_of_occ_ind, clm_pre_rpt_ind, clm_reported_tm, clm_demand_amt, clm_archive_dt, clm_archive_plc_cd, clm_stampled_dt, clm_type_cd, clm_closed_dt, clm_severity_cd, clm_indemnity_ind, clm_controvert_ind, clm_mediation_ind, clm_doc_type_cd, clm_loss_county_cd, clm_res_lmt_ind, clm_pmt_lmt_ind, clm_loss_place_id, clm_report_nbr, clm_violation_ind, clm_road_type_cd, clm_road_srf_d, clm_speed_lim_nbr, clm_light_con_cd, clm_densely_ind, clm_traf_light_ind, clm_prc_sta_ind, clm_claim_cat_cd, clm_subro_ind, clm_invest_ind, clm_out_deduct_ind, clm_subcont_ind, clm_activity_sta, clm_rei_notify_dt, clm_emp_std_ind_cd, clm_at_fault_cd, clm_driver_nbr, clm_drv_same_ind, clm_rep_to_car_dt, clm_viol_cit_desc, clm_how_clm_rptd, clm_method_rptd, clm_agency_code, extract_date, as_of_date, record_count, source_system_id, audit_id, clm_wc_cat_code, clm_primary_loc_code, clm_secondary_dept_code, clm_xact_transaction_id, clm_survey, clm_survey_recipient, clm_survey_contact_method, clm_survey_primary_handler)\n\tSELECT \n\tCLAIM_TAB_ID AS CLAIM_TAB_ID, \n\tCLM_CLAIM_NBR AS CLM_CLAIM_NBR, \n\tCLM_CAUSE_LOSS_CD AS CLM_CAUSE_LOSS_CD, \n\tCLM_CLAIM_COMMENTS AS CLM_CLAIM_COMMENTS, \n\tCLM_CSR_CLAIM_NBR AS CLM_CSR_CLAIM_NBR, \n\tCLM_COMMUNITY_CD AS CLM_COMMUNITY_CD, \n\tCLM_CREATE_TS AS CLM_CREATE_TS, \n\tCLM_ENTRY_OPR_ID AS CLM_ENTRY_OPR_ID, \n\tCLM_PMSD_TS AS CLM_PMSD_TS, \n\tCLM_OCCURRENCE_ID AS CLM_OCCURRENCE_ID, \n\tCLM_REPORTED_DT AS CLM_REPORTED_DT, \n\tCLM_STATUS_CD AS CLM_STATUS_CD, \n\tCLM_UPDATE_OPR_ID AS CLM_UPDATE_OPR_ID, \n\tCLM_UPD_TS AS CLM_UPD_TS, \n\tCLM_LOSS_OCC_CD AS CLM_LOSS_OCC_CD, \n\tCLM_ATO_CHG_BY AS CLM_ATO_CHG_BY, \n\tCLM_ATO_CHG_DT AS CLM_ATO_CHG_DT, \n\tCLM_CO_ASN_DT AS CLM_CO_ASN_DT, \n\tCLM_CO_ASN_RSN_CD AS CLM_CO_ASN_RSN_CD, \n\tCLM_DIR_ATO_LMT AS CLM_DIR_ATO_LMT, \n\tCLM_POSTAL_CD AS CLM_POSTAL_CD, \n\tCLM_FIN_IND AS CLM_FIN_IND, \n\tCLM_DISCOVERY_DT AS CLM_DISCOVERY_DT, \n\tCLM_XPN_ATO_LMT AS CLM_XPN_ATO_LMT, \n\tCLM_HO_REPORT_IND AS CLM_HO_REPORT_IND, \n\tCLM_LITIGATION_IND AS CLM_LITIGATION_IND, \n\tCLM_RECOVERY_IND AS CLM_RECOVERY_IND, \n\tCLM_LOSS_DT AS CLM_LOSS_DT, \n\tCLM_LOSS_TM AS CLM_LOSS_TM, \n\tCLM_LOSS_CITY AS CLM_LOSS_CITY, \n\tCLM_LOSS_COUNTY AS CLM_LOSS_COUNTY, \n\tCLM_LOSS_DES_ID AS CLM_LOSS_DES_ID, \n\tCLM_LOSS_STATE_CD AS CLM_LOSS_STATE_CD, \n\tCLM_MAJOR_CASE_DT AS CLM_MAJOR_CASE_DT, \n\tCLM_MAJ_CASE_REA AS CLM_MAJ_CASE_REA, \n\tCLM_MED_ATO_LMT AS CLM_MED_ATO_LMT, \n\tCLM_NOT_CLAIM_IND AS CLM_NOT_CLAIM_IND, \n\tNOT_OF_OCC_IND AS NOT_OF_OCC_IND, \n\tCLM_PRE_RPT_IND AS CLM_PRE_RPT_IND, \n\tCLM_REPORTED_TM AS CLM_REPORTED_TM, \n\tCLM_DEMAND_AMT AS CLM_DEMAND_AMT, \n\tCLM_ARCHIVE_DT AS CLM_ARCHIVE_DT, \n\tCLM_ARCHIVE_PLC_CD AS CLM_ARCHIVE_PLC_CD, \n\tCLM_STAMPLED_DT AS CLM_STAMPLED_DT, \n\tCLM_TYPE_CD AS CLM_TYPE_CD, \n\tCLM_CLOSED_DT AS CLM_CLOSED_DT, \n\tCLM_SEVERITY_CD AS CLM_SEVERITY_CD, \n\tCLM_INDEMNITY_IND AS CLM_INDEMNITY_IND, \n\tCLM_CONTROVERT_IND AS CLM_CONTROVERT_IND, \n\tCLM_MEDIATION_IND AS CLM_MEDIATION_IND, \n\tCLM_DOC_TYPE_CD AS CLM_DOC_TYPE_CD, \n\tCLM_LOSS_COUNTY_CD AS CLM_LOSS_COUNTY_CD, \n\tCLM_RES_LMT_IND AS CLM_RES_LMT_IND, \n\tCLM_PMT_LMT_IND AS CLM_PMT_LMT_IND, \n\tCLM_LOSS_PLACE_ID AS CLM_LOSS_PLACE_ID, \n\tCLM_REPORT_NBR AS CLM_REPORT_NBR, \n\tCLM_VIOLATION_IND AS CLM_VIOLATION_IND, \n\tCLM_ROAD_TYPE_CD AS CLM_ROAD_TYPE_CD, \n\tCLM_ROAD_SRF_D AS CLM_ROAD_SRF_D, \n\tCLM_SPEED_LIM_NBR AS CLM_SPEED_LIM_NBR, \n\tCLM_LIGHT_CON_CD AS CLM_LIGHT_CON_CD, \n\tCLM_DENSELY_IND AS CLM_DENSELY_IND, \n\tCLM_TRAF_LIGHT_IND AS CLM_TRAF_LIGHT_IND, \n\tCLM_PRC_STA_IND AS CLM_PRC_STA_IND, \n\tCLM_CLAIM_CAT_CD AS CLM_CLAIM_CAT_CD, \n\tCLM_SUBRO_IND AS CLM_SUBRO_IND, \n\tCLM_INVEST_IND AS CLM_INVEST_IND, \n\tCLM_OUT_DEDUCT_IND AS CLM_OUT_DEDUCT_IND, \n\tCLM_SUBCONT_IND AS CLM_SUBCONT_IND, \n\tCLM_ACTIVITY_STA AS CLM_ACTIVITY_STA, \n\tCLM_REI_NOTIFY_DT AS CLM_REI_NOTIFY_DT, \n\tCLM_EMP_STD_IND_CD AS CLM_EMP_STD_IND_CD, \n\tCLM_AT_FAULT_CD AS CLM_AT_FAULT_CD, \n\tCLM_DRIVER_NBR AS CLM_DRIVER_NBR, \n\tCLM_DRV_SAME_IND AS CLM_DRV_SAME_IND, \n\tCLM_REP_TO_CAR_DT AS CLM_REP_TO_CAR_DT, \n\tCLM_VIOL_CIT_DESC AS CLM_VIOL_CIT_DESC, \n\tCLM_HOW_CLM_RPTD AS CLM_HOW_CLM_RPTD, \n\tCLM_METHOD_RPTD AS CLM_METHOD_RPTD, \n\tCLM_AGENCY_CODE AS CLM_AGENCY_CODE, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID, \n\tCLM_WC_CAT_CODE, \n\tCLM_PRIMARY_LOC_CODE, \n\tCLM_SECONDARY_DEPT_CODE, \n\tCLM_XACT_TRANSACTION_ID, \n\tCLM_SURVEY, \n\tCLM_SURVEY_RECIPIENT, \n\tCLM_SURVEY_CONTACT_METHOD, \n\tCLM_SURVEY_PRIMARY_HANDLER\n\tFROM EXP_CLAIM_TAB_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}