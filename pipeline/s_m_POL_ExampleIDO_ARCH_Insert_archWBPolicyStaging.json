{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_archWBPolicyStaging",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_archWBPolicyStaging",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WBPolicyStaging AS (\n\tSELECT\n\t\tWBPolicyStagingId,\n\t\tPolicyId,\n\t\tWB_PolicyId,\n\t\tSessionId,\n\t\tCustomerCare,\n\t\tDivision,\n\t\tTerrorism,\n\t\tProgram,\n\t\tAssociation,\n\t\tReceivedAMPM,\n\t\tReceivedDate,\n\t\tReceivedTimeHour,\n\t\tReceivedTimeMinute,\n\t\tPolicyVersion,\n\t\tPolicyVersionFormatted,\n\t\tIsPreliminaryAuditRequired,\n\t\tIsMidTermAuditRequired,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tWBProduct,\n\t\tWBProductType,\n\t\tRiskGrade,\n\t\tBCCCode,\n\t\tPlusPak,\n\t\tPolicyNumber,\n\t\tIsRollover,\n\t\tPriorCarrierNameOther,\n\t\tPremiumMining,\n\t\tQuoteType,\n\t\tDescriptionOfChildCarePremises,\n\t\tAssociationMessages,\n\t\tAssociationMessagesMCRA,\n\t\tAssociationDiscount,\n\t\tAssociationDiscountFactor,\n\t\tProgramFactor,\n\t\tClearedIdentification,\n\t\tClearedIdentificationDateTimeStamp,\n\t\tLegalNoticeRequired,\n\t\tAssignedUnderwriterFirstName,\n\t\tAssignedUnderwriterLastName,\n\t\tStatusCode,\n\t\tCode,\n\t\tBCCCodeDesc,\n\t\tConsentToRate,\n\t\tMultipleLocationCredit,\n\t\tComments,\n\t\tDecision,\n\t\tMessage,\n\t\tAutomaticRenewalIndicator,\n\t\tPolicyCoverage,\n\t\tIsBindableFlag,\n\t\tPurePremium,\n\t\tRuleType,\n\t\tPolicyProgram,\n\t\tReinsuranceIndicator,\n\t\tRequestingEntity,\n\t\tOriginalBillingAccountNumber,\n\t\tOriginalPayPlan,\n\t\tOriginalTargetDueDate,\n\t\tPreviousPolicyVersion,\n\t\tEndorseProcessedBy,\n\t\tPriorCarrierName,\n\t\tPolicyIssueCodeDesc,\n\t\tPolicyIssueCodeOverride,\n\t\tPenguinTechGenerated,\n\t\tTotalFloodLimit,\n\t\tTotalFloodDeductible,\n\t\tPoolCode,\n\t\tIssuedUWID,\n\t\tIssuedUnderwriter,\n\t\tExternalQuoteSource,\n\t\tTurnstileGenerated,\n\t\tLCSurveyOrderedIndicator,\n\t\tLCSurveyOrderedDate\n\tFROM WBPolicyStaging\n),\nEXP_Metadata AS (\n\tSELECT\n\tWBPolicyStagingId,\n\tPolicyId,\n\tWB_PolicyId,\n\tSessionId,\n\tCustomerCare,\n\tDivision,\n\tTerrorism,\n\tProgram,\n\tAssociation,\n\tReceivedAMPM,\n\tReceivedDate,\n\tReceivedTimeHour,\n\tReceivedTimeMinute,\n\tPolicyVersion,\n\tPolicyVersionFormatted,\n\tIsPreliminaryAuditRequired AS i_IsPreliminaryAuditRequired,\n\t-- *INF*: DECODE(i_IsPreliminaryAuditRequired, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_IsPreliminaryAuditRequired,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_IsPreliminaryAuditRequired,\n\tIsMidTermAuditRequired AS i_IsMidTermAuditRequired,\n\t-- *INF*: DECODE(i_IsMidTermAuditRequired, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_IsMidTermAuditRequired,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_IsMidTermAuditRequired,\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tWBProduct,\n\tWBProductType,\n\tRiskGrade,\n\tBCCCode,\n\tPlusPak AS i_PlusPak,\n\t-- *INF*: DECODE(i_PlusPak, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_PlusPak,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_PlusPak,\n\tPolicyNumber,\n\tIsRollover AS i_IsRollover,\n\t-- *INF*: DECODE(i_IsRollover, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_IsRollover,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_IsRollover,\n\tPriorCarrierNameOther,\n\tPremiumMining,\n\tQuoteType,\n\tDescriptionOfChildCarePremises,\n\tAssociationMessages,\n\tAssociationMessagesMCRA,\n\tAssociationDiscount,\n\tAssociationDiscountFactor,\n\tProgramFactor,\n\tClearedIdentification AS i_ClearedIdentification,\n\t-- *INF*: DECODE(i_ClearedIdentification, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_ClearedIdentification,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ClearedIdentification,\n\tClearedIdentificationDateTimeStamp,\n\tLegalNoticeRequired,\n\tAssignedUnderwriterFirstName,\n\tAssignedUnderwriterLastName,\n\tStatusCode,\n\tCode,\n\tBCCCodeDesc,\n\tConsentToRate AS i_ConsentToRate,\n\t-- *INF*: DECODE(i_ConsentToRate, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_ConsentToRate,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ConsentToRate,\n\tMultipleLocationCredit AS i_MultipleLocationCredit,\n\t-- *INF*: DECODE(i_MultipleLocationCredit, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_MultipleLocationCredit,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_MultipleLocationCredit,\n\tComments,\n\tDecision,\n\tMessage,\n\tAutomaticRenewalIndicator AS i_AutomaticRenewalIndicator,\n\t-- *INF*: DECODE(i_AutomaticRenewalIndicator, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_AutomaticRenewalIndicator,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_AutomaticRenewalIndicator,\n\tPolicyCoverage,\n\tIsBindableFlag AS i_IsBindableFlag,\n\t-- *INF*: DECODE(i_IsBindableFlag, 'T', '1', 'F', '0', NULL)\n\tDECODE(\n\t    i_IsBindableFlag,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_IsBindableFlag,\n\tPurePremium,\n\tRuleType,\n\tPolicyProgram,\n\tReinsuranceIndicator AS i_ReinsuranceIndicator,\n\t-- *INF*: DECODE(i_ReinsuranceIndicator,'T','1','F','0')\n\tDECODE(\n\t    i_ReinsuranceIndicator,\n\t    'T', '1',\n\t    'F', '0'\n\t) AS o_ReinsuranceIndicator,\n\tRequestingEntity,\n\tOriginalBillingAccountNumber,\n\tOriginalPayPlan,\n\tOriginalTargetDueDate,\n\tPreviousPolicyVersion,\n\tEndorseProcessedBy,\n\tPriorCarrierName,\n\tPolicyIssueCodeDesc,\n\tPolicyIssueCodeOverride AS i_PolicyIssueCodeOverride,\n\t-- *INF*: DECODE(i_PolicyIssueCodeOverride, 'T', 1, 'F', 0)\n\tDECODE(\n\t    i_PolicyIssueCodeOverride,\n\t    'T', 1,\n\t    'F', 0\n\t) AS o_PolicyIssueCodeOverride,\n\tPenguinTechGenerated AS i_PenguinTechGenerated,\n\t-- *INF*: DECODE(i_PenguinTechGenerated, 'T', 1, 'F', 0,0)\n\tDECODE(\n\t    i_PenguinTechGenerated,\n\t    'T', 1,\n\t    'F', 0,\n\t    0\n\t) AS o_PenguinTechGenerated,\n\tTotalFloodLimit,\n\tTotalFloodDeductible,\n\tPoolCode,\n\tIssuedUWID,\n\tIssuedUnderwriter,\n\tExternalQuoteSource,\n\tTurnstileGenerated AS i_TurnstileGenerated,\n\t-- *INF*: DECODE(i_TurnstileGenerated, 'T', 1, 'F', 0,0)\n\tDECODE(\n\t    i_TurnstileGenerated,\n\t    'T', 1,\n\t    'F', 0,\n\t    0\n\t) AS o_TurnstileGenerated,\n\tLCSurveyOrderedIndicator,\n\t-- *INF*: DECODE(LCSurveyOrderedIndicator, 'T', '1', 'F', '0',null)\n\tDECODE(\n\t    LCSurveyOrderedIndicator,\n\t    'T', '1',\n\t    'F', '0',\n\t    null\n\t) AS o_LCSurveyOrderedIndicator,\n\tLCSurveyOrderedDate\n\tFROM SQ_WBPolicyStaging\n),\narchWBPolicyStaging AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archWBPolicyStaging\n\t(ExtractDate, SourceSystemId, AuditId, WBPolicyStagingId, PolicyId, WB_PolicyId, SessionId, PolicyCoverage, PurePremium, ReinsuranceIndicator, CustomerCare, Division, Terrorism, IsPreliminaryAuditRequired, IsMidTermAuditRequired, PolicyProgram, Association, ReceivedAMPM, ReceivedDate, ReceivedTimeHour, ReceivedTimeMinute, BCCCode, PlusPak, PolicyNumber, IsRollover, PriorCarrierNameOther, PremiumMining, QuoteType, BCCCodeDesc, DescriptionOfChildCarePremises, ConsentToRate, MultipleLocationCredit, WBProduct, WBProductType, RequestingEntity, OriginalBillingAccountNumber, OriginalPayPlan, OriginalTargetDueDate, PolicyVersion, PolicyVersionFormatted, AssociationDiscount, AssociationDiscountFactor, AssociationMessages, AssociationMessagesMCRA, RiskGrade, ProgramFactor, ClearedIdentification, ClearedIdentificationDateTimeStamp, LegalNoticeRequired, AutomaticRenewalIndicator, IsBindableFlag, AssignedUnderwriterFirstName, AssignedUnderwriterLastName, PreviousPolicyVersion, Code, Comments, Decision, Message, RuleType, Program, StatusCode, EndorseProcessedBy, PriorCarrierName, PolicyIssueCodeDesc, PolicyIssueCodeOverride, PenguinTechGenerated, TotalFloodLimit, TotalFloodDeductible, PoolCode, IssuedUWID, IssuedUnderwriter, ExternalQuoteSource, TurnstileGenerated, LCSurveyOrderedIndicator, LCSurveyOrderedDate)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID, \n\tWBPOLICYSTAGINGID, \n\tPOLICYID, \n\tWB_POLICYID, \n\tSESSIONID, \n\tPOLICYCOVERAGE, \n\tPUREPREMIUM, \n\to_ReinsuranceIndicator AS REINSURANCEINDICATOR, \n\tCUSTOMERCARE, \n\tDIVISION, \n\tTERRORISM, \n\to_IsPreliminaryAuditRequired AS ISPRELIMINARYAUDITREQUIRED, \n\to_IsMidTermAuditRequired AS ISMIDTERMAUDITREQUIRED, \n\tPOLICYPROGRAM, \n\tASSOCIATION, \n\tRECEIVEDAMPM, \n\tRECEIVEDDATE, \n\tRECEIVEDTIMEHOUR, \n\tRECEIVEDTIMEMINUTE, \n\tBCCCODE, \n\to_PlusPak AS PLUSPAK, \n\tPOLICYNUMBER, \n\to_IsRollover AS ISROLLOVER, \n\tPRIORCARRIERNAMEOTHER, \n\tPREMIUMMINING, \n\tQUOTETYPE, \n\tBCCCODEDESC, \n\tDESCRIPTIONOFCHILDCAREPREMISES, \n\to_ConsentToRate AS CONSENTTORATE, \n\to_MultipleLocationCredit AS MULTIPLELOCATIONCREDIT, \n\tWBPRODUCT, \n\tWBPRODUCTTYPE, \n\tREQUESTINGENTITY, \n\tORIGINALBILLINGACCOUNTNUMBER, \n\tORIGINALPAYPLAN, \n\tORIGINALTARGETDUEDATE, \n\tPOLICYVERSION, \n\tPOLICYVERSIONFORMATTED, \n\tASSOCIATIONDISCOUNT, \n\tASSOCIATIONDISCOUNTFACTOR, \n\tASSOCIATIONMESSAGES, \n\tASSOCIATIONMESSAGESMCRA, \n\tRISKGRADE, \n\tPROGRAMFACTOR, \n\to_ClearedIdentification AS CLEAREDIDENTIFICATION, \n\tCLEAREDIDENTIFICATIONDATETIMESTAMP, \n\tLEGALNOTICEREQUIRED, \n\to_AutomaticRenewalIndicator AS AUTOMATICRENEWALINDICATOR, \n\to_IsBindableFlag AS ISBINDABLEFLAG, \n\tASSIGNEDUNDERWRITERFIRSTNAME, \n\tASSIGNEDUNDERWRITERLASTNAME, \n\tPREVIOUSPOLICYVERSION, \n\tCODE, \n\tCOMMENTS, \n\tDECISION, \n\tMESSAGE, \n\tRULETYPE, \n\tPROGRAM, \n\tSTATUSCODE, \n\tENDORSEPROCESSEDBY, \n\tPRIORCARRIERNAME, \n\tPOLICYISSUECODEDESC, \n\to_PolicyIssueCodeOverride AS POLICYISSUECODEOVERRIDE, \n\to_PenguinTechGenerated AS PENGUINTECHGENERATED, \n\tTOTALFLOODLIMIT, \n\tTOTALFLOODDEDUCTIBLE, \n\tPOOLCODE, \n\tISSUEDUWID, \n\tISSUEDUNDERWRITER, \n\tEXTERNALQUOTESOURCE, \n\to_TurnstileGenerated AS TURNSTILEGENERATED, \n\to_LCSurveyOrderedIndicator AS LCSURVEYORDEREDINDICATOR, \n\tLCSURVEYORDEREDDATE\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}