{
    "name": "s_m_FEED_Load_ISS_Extract_File_GL_RemoveDupOnsetOffset",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_ISS_Extract_File_GL_RemoveDupOnsetOffset",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_ISSGL_Loss AS (\n\t--loss\r\n\tSELECT DISTINCT ISSGeneralLiabilityExtract.issgeneralliabilityextractid, \r\n\t                ISSGeneralLiabilityExtract.auditid, \r\n\t                ISSGeneralLiabilityExtract.createddate, \r\n\t                ISSGeneralLiabilityExtract.edwpremiummastercalculationpkid, \r\n\t                ISSGeneralLiabilityExtract.edwlossmastercalculationpkid, \r\n\t                ISSGeneralLiabilityExtract.typebureaucode, \r\n\t                ISSGeneralLiabilityExtract.bureaulineofinsurance, \r\n\t                ISSGeneralLiabilityExtract.bureaucompanynumber, \r\n\t                ISSGeneralLiabilityExtract.stateprovincecode, \r\n\t                ISSGeneralLiabilityExtract.premiummasterrundate, \r\n\t                ISSGeneralLiabilityExtract.lossmasterrundate, \r\n\t                ISSGeneralLiabilityExtract.policykey, \r\n\t                ISSGeneralLiabilityExtract.premiummasterclasscode, \r\n\t                ISSGeneralLiabilityExtract.lossmasterclasscode, \r\n\t                ISSGeneralLiabilityExtract.claimnumber, \r\n\t                ISSGeneralLiabilityExtract.claimantnumber, \r\n\t                ISSGeneralLiabilityExtract.riskterritorycode, \r\n\t                ISSGeneralLiabilityExtract.policyeffectivedate, \r\n\t                ISSGeneralLiabilityExtract.causeofloss, \r\n\t                ISSGeneralLiabilityExtract.sublinecode, \r\n\t                ISSGeneralLiabilityExtract.packagemodificationadjustmentgroupdescription, \r\n\t                ISSGeneralLiabilityExtract.premiummasterdirectwrittenpremiumamount, \r\n\t                ISSGeneralLiabilityExtract.paidlossamount, \r\n\t                ISSGeneralLiabilityExtract.outstandinglossamount, \r\n\t                ISSGeneralLiabilityExtract.policyexpirationdate, \r\n\t                ISSGeneralLiabilityExtract.inceptiontodatepaidlossamount, \r\n\t                ISSGeneralLiabilityExtract.claimantcoveragedetailid, \r\n\t                ISSGeneralLiabilityExtract.annualstatementlinenumber, \r\n\t                ISSGeneralLiabilityExtract.writtenexposure, \r\n\t                ISSGeneralLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount, \r\n\t                ISSGeneralLiabilityExtract.claimlossdate, \r\n\t                ISSGeneralLiabilityExtract.typeofpolicycontract, \r\n\t                ISSGeneralLiabilityExtract.claimsentryyear, \r\n\t                ISSGeneralLiabilityExtract.paidallocatedlossadjustmentexpenseamount, \r\n\t                ISSGeneralLiabilityExtract.zippostalcode, \r\n\t                ISSGeneralLiabilityExtract.transactioneffectivedate , \r\n\t                ISSGeneralLiabilityExtract.locationnumber \r\n\tFROM            ISSGeneralLiabilityExtract \r\n\tWHERE           edwlossmastercalculationpkid<>-1 \r\n\t@{pipeline().parameters.WHERE_CLAUSE_GL_LOSS}\n),\nEXP_GL_LOSS AS (\n\tSELECT\n\tISSGeneralLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSGL_Loss\n),\nSQ_ISSGL_Premium_RemoveDuplicate AS (\n\tWITH ROLLUP_TABLE_TEMP\r\n\tAS\r\n\t(SELECT\r\n\t\t\tSUM(PremiumMasterDirectWrittenPremiumAmount) ROLL_UP_DWP_AMT\r\n\t\t\t,MAX(ISSGeneralLiabilityExtractId) MAX_ISS_KEY\r\n\t\t\t,COUNT(1) AS count\r\n\t\tFROM ISSGeneralLiabilityExtract a\r\n\t\tWHERE a.edwpremiummastercalculationpkid <> -1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_GL_PREMIUM}\r\n\t\tGROUP BY CONCAT(typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, policyexpirationdate, claimantcoveragedetailid, annualstatementlinenumber, abs(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber)\r\n\t\tHAVING COUNT(1) > 1)\r\n\t\r\n\t\r\n\tSELECT\r\n\t\tISSGeneralLiabilityExtract.issgeneralliabilityextractid\r\n\t\t,ISSGeneralLiabilityExtract.auditid\r\n\t\t,ISSGeneralLiabilityExtract.createddate\r\n\t\t,ISSGeneralLiabilityExtract.edwpremiummastercalculationpkid\r\n\t\t,ISSGeneralLiabilityExtract.edwlossmastercalculationpkid\r\n\t\t,ISSGeneralLiabilityExtract.typebureaucode\r\n\t\t,ISSGeneralLiabilityExtract.bureaulineofinsurance\r\n\t\t,ISSGeneralLiabilityExtract.bureaucompanynumber\r\n\t\t,ISSGeneralLiabilityExtract.stateprovincecode\r\n\t\t,ISSGeneralLiabilityExtract.premiummasterrundate\r\n\t\t,ISSGeneralLiabilityExtract.lossmasterrundate\r\n\t\t,ISSGeneralLiabilityExtract.policykey\r\n\t\t,ISSGeneralLiabilityExtract.premiummasterclasscode\r\n\t\t,ISSGeneralLiabilityExtract.lossmasterclasscode\r\n\t\t,ISSGeneralLiabilityExtract.claimnumber\r\n\t\t,ISSGeneralLiabilityExtract.claimantnumber\r\n\t\t,ISSGeneralLiabilityExtract.riskterritorycode\r\n\t\t,ISSGeneralLiabilityExtract.policyeffectivedate\r\n\t\t,ISSGeneralLiabilityExtract.causeofloss\r\n\t\t,ISSGeneralLiabilityExtract.sublinecode\r\n\t\t,ISSGeneralLiabilityExtract.packagemodificationadjustmentgroupdescription\r\n\t\t,ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT AS PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,ISSGeneralLiabilityExtract.paidlossamount\r\n\t\t,ISSGeneralLiabilityExtract.outstandinglossamount\r\n\t\t,ISSGeneralLiabilityExtract.policyexpirationdate\r\n\t\t,ISSGeneralLiabilityExtract.inceptiontodatepaidlossamount\r\n\t\t,ISSGeneralLiabilityExtract.claimantcoveragedetailid\r\n\t\t,ISSGeneralLiabilityExtract.annualstatementlinenumber\r\n\t\t,CASE\r\n\t\t\tWHEN ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT > 0 THEN ABS(ISSGeneralLiabilityExtract.WrittenExposure)\r\n\t\t\tELSE (-1 * ABS(ISSGeneralLiabilityExtract.WrittenExposure))\r\n\t\tEND AS WrittenExposure\r\n\t\t,ISSGeneralLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount\r\n\t\t,ISSGeneralLiabilityExtract.claimlossdate\r\n\t\t,ISSGeneralLiabilityExtract.typeofpolicycontract\r\n\t\t,ISSGeneralLiabilityExtract.claimsentryyear\r\n\t\t,ISSGeneralLiabilityExtract.paidallocatedlossadjustmentexpenseamount\r\n\t\t,ISSGeneralLiabilityExtract.zippostalcode\r\n\t\t,ISSGeneralLiabilityExtract.transactioneffectivedate\r\n\t\t,ISSGeneralLiabilityExtract.locationnumber\r\n\tFROM ROLLUP_TABLE_TEMP\r\n\tINNER JOIN ISSGeneralLiabilityExtract\r\n\t\tON ISSGeneralLiabilityExtract.ISSGeneralLiabilityExtractId = ROLLUP_TABLE_TEMP.MAX_ISS_KEY\r\n\tWHERE ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT <> 0\n),\nEXP_Premium_Duplicate AS (\n\tSELECT\n\tISSGeneralLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSGL_Premium_RemoveDuplicate\n),\nSQ_ISSGL_Premium_Unique AS (\n\twith prem_unique AS \r\n\t( \r\n\t         SELECT   concat( typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription,policyexpirationdate, claimantcoveragedetailid,annualstatementlinenumber, abs(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) concct, \r\n\t                  count(*)                                                                                                                                                                                                        count \r\n\t         FROM     ISSGeneralLiabilityExtract  a\r\n\t\t\t WHERE    a.edwpremiummastercalculationpkid<>-1 \r\n\t\t\t @{pipeline().parameters.WHERE_CLAUSE_GL_PREMIUM}\r\n\t         GROUP BY concat( typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription,policyexpirationdate, claimantcoveragedetailid,annualstatementlinenumber, abs(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) \r\n\t         HAVING   count(*) =1 \r\n\t\t\t) \r\n\t\t\t--premiumunique \r\n\tSELECT     ISSGeneralLiabilityExtract.issgeneralliabilityextractid, \r\n\t           ISSGeneralLiabilityExtract.auditid, \r\n\t           ISSGeneralLiabilityExtract.createddate, \r\n\t           ISSGeneralLiabilityExtract.edwpremiummastercalculationpkid, \r\n\t           ISSGeneralLiabilityExtract.edwlossmastercalculationpkid, \r\n\t           ISSGeneralLiabilityExtract.typebureaucode, \r\n\t           ISSGeneralLiabilityExtract.bureaulineofinsurance, \r\n\t           ISSGeneralLiabilityExtract.bureaucompanynumber, \r\n\t           ISSGeneralLiabilityExtract.stateprovincecode, \r\n\t           ISSGeneralLiabilityExtract.premiummasterrundate, \r\n\t           ISSGeneralLiabilityExtract.lossmasterrundate, \r\n\t           ISSGeneralLiabilityExtract.policykey, \r\n\t           ISSGeneralLiabilityExtract.premiummasterclasscode, \r\n\t           ISSGeneralLiabilityExtract.lossmasterclasscode, \r\n\t           ISSGeneralLiabilityExtract.claimnumber, \r\n\t           ISSGeneralLiabilityExtract.claimantnumber, \r\n\t           ISSGeneralLiabilityExtract.riskterritorycode, \r\n\t           ISSGeneralLiabilityExtract.policyeffectivedate, \r\n\t           ISSGeneralLiabilityExtract.causeofloss, \r\n\t           ISSGeneralLiabilityExtract.sublinecode, \r\n\t           ISSGeneralLiabilityExtract.packagemodificationadjustmentgroupdescription, \r\n\t           ISSGeneralLiabilityExtract.premiummasterdirectwrittenpremiumamount, \r\n\t           ISSGeneralLiabilityExtract.paidlossamount, \r\n\t           ISSGeneralLiabilityExtract.outstandinglossamount, \r\n\t           ISSGeneralLiabilityExtract.policyexpirationdate, \r\n\t           ISSGeneralLiabilityExtract.inceptiontodatepaidlossamount, \r\n\t           ISSGeneralLiabilityExtract.claimantcoveragedetailid, \r\n\t           ISSGeneralLiabilityExtract.annualstatementlinenumber, \r\n\t           ISSGeneralLiabilityExtract.writtenexposure, \r\n\t           ISSGeneralLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount, \r\n\t           ISSGeneralLiabilityExtract.claimlossdate, \r\n\t           ISSGeneralLiabilityExtract.typeofpolicycontract, \r\n\t           ISSGeneralLiabilityExtract.claimsentryyear, \r\n\t           ISSGeneralLiabilityExtract.paidallocatedlossadjustmentexpenseamount, \r\n\t           ISSGeneralLiabilityExtract.zippostalcode, \r\n\t           ISSGeneralLiabilityExtract.transactioneffectivedate , \r\n\t           ISSGeneralLiabilityExtract.locationnumber \r\n\tFROM       ISSGeneralLiabilityExtract \r\n\tINNER JOIN prem_unique b \r\n\tON         ( \r\n\t                                 Concat( typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, policyexpirationdate, claimantcoveragedetailid,annualstatementlinenumber, abs(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) =b.concct) \r\n\tWHERE      ISSGeneralLiabilityExtract.edwpremiummastercalculationpkid<>-1 \r\n\t@{pipeline().parameters.WHERE_CLAUSE_GL_PREMIUM}\n),\nEXP_Premium_Unique AS (\n\tSELECT\n\tISSGeneralLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSGL_Premium_Unique\n),\nUnion_GL_Data AS (\n\tSELECT ISSGeneralLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_GL_LOSS\n\tUNION\n\tSELECT ISSGeneralLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_Premium_Unique\n\tUNION\n\tSELECT ISSGeneralLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_Premium_Duplicate\n),\nEXP_CleanData_GL AS (\n\tSELECT\n\tISSGeneralLiabilityExtractId AS i_WorkISSExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tPolicyKey AS i_PolicyKey,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tClaimNumber AS i_ClaimNumber,\n\tClaimantNumber AS i_ClaimantNumber,\n\tRiskTerritoryCode AS i_RiskTerritoryCode,\n\tPolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tCauseOfLoss AS i_CauseOfLoss,\n\tSublineCode AS i_SublineCode,\n\tPackageModificationAdjustmentGroupDescription AS i_PackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tPolicyExpirationDate AS i_PolicyExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tWrittenExposure AS i_WrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount AS i_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate AS i_Claimlossdate,\n\tTypeofPolicycontract AS i_TypeofPolicycontract,\n\tClaimsEntryYear AS i_ClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount AS i_PaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode AS i_ZipPostalCode,\n\tTransactionEffectiveDate AS i_TransactionEffectiveDate,\n\tLocationNumber AS i_LocationNumber,\n\ti_WorkISSExtractId AS o_WorkISSExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: LTRIM(RTRIM(i_TypeBureauCode))\n\tLTRIM(RTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: LTRIM(RTRIM(i_BureauLineOfInsurance))\n\tLTRIM(RTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\t-- *INF*: LTRIM(RTRIM(i_BureauCompanyNumber))\n\tLTRIM(RTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: LTRIM(RTRIM(i_StateProvinceCode))\n\tLTRIM(RTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyKey))\n\tLTRIM(RTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: LTRIM(RTRIM(i_PremiumMasterClassCode))\n\tLTRIM(RTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_LossMasterClassCode))\n\tLTRIM(RTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimNumber))\n\tLTRIM(RTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimantNumber))\n\tLTRIM(RTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\t-- *INF*: LTRIM(RTRIM(i_RiskTerritoryCode))\n\tLTRIM(RTRIM(i_RiskTerritoryCode)) AS o_RiskTerritoryCode,\n\ti_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: LTRIM(RTRIM(i_CauseOfLoss))\n\tLTRIM(RTRIM(i_CauseOfLoss)) AS o_CauseOfLoss,\n\t-- *INF*: LTRIM(RTRIM(i_DeductibleAmount))\n\tLTRIM(RTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: LTRIM(RTRIM(i_CoverageCode))\n\tLTRIM(RTRIM(i_CoverageCode)) AS o_CoverageCode,\n\t-- *INF*: LTRIM(RTRIM(i_ConstructionCode))\n\tLTRIM(RTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(i_ISOFireProtectionCode))\n\tLTRIM(RTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: LTRIM(RTRIM(i_SublineCode))\n\tLTRIM(RTRIM(i_SublineCode)) AS o_SublineCode,\n\t-- *INF*: LTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription))\n\tLTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription)) AS o_PackageModificationAdjustmentGroupDescription,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyForm))\n\tLTRIM(RTRIM(i_PolicyForm)) AS o_PolicyForm,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_PolicyExpirationDate AS o_PolicyExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailID,\n\ti_AnnualStatementLineNumber AS o_AnnualStatementLineNumber,\n\ti_WrittenExposure AS o_WrittenExposure,\n\ti_OutstandingAllocatedLossAdjustmentExpenseAmount AS o_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\ti_Claimlossdate AS o_Claimlossdate,\n\t-- *INF*: LTRIM(RTRIM(i_TypeofPolicycontract))\n\tLTRIM(RTRIM(i_TypeofPolicycontract)) AS o_TypeofPolicycontract,\n\ti_ClaimsEntryYear AS o_ClaimsEntryYear,\n\ti_PaidAllocatedlossAdjustmentExpenseAmount AS o_PaidAllocatedlossAdjustmentExpenseAmount,\n\ti_ZipPostalCode AS o_ZipPostalCode,\n\ti_TransactionEffectiveDate AS o_TransactionEffectiveDate,\n\ti_LocationNumber AS o_LocationNumber\n\tFROM Union_GL_Data\n),\nEXP_Target_GL AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_GL_GL'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_GL_GL' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\to_WorkISSExtractId AS WorkISSExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_PolicyKey AS PolicyKey,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_RiskTerritoryCode AS RiskTerritoryCode,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_CoverageCode AS CoverageCode,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_SublineCode AS SublineCode,\n\to_PackageModificationAdjustmentGroupDescription AS PackageModificationAdjustmentGroupDescription,\n\to_PolicyForm AS PolicyForm,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailID AS ClaimantCoverageDetailID,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_WrittenExposure AS WrittenExposure,\n\to_OutstandingAllocatedLossAdjustmentExpenseAmount AS OutstandingAllocatedLossAdjustmentExpenseAmount,\n\to_Claimlossdate AS Claimlossdate,\n\to_TypeofPolicycontract AS TypeofPolicycontract,\n\to_ClaimsEntryYear AS ClaimsEntryYear,\n\to_PaidAllocatedlossAdjustmentExpenseAmount AS PaidAllocatedlossAdjustmentExpenseAmount,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate,\n\to_LocationNumber AS LocationNumber\n\tFROM EXP_CleanData_GL\n),\nSRT_FlatFile_GL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tClaimlossdate, \n\tTypeofPolicycontract, \n\tClaimsEntryYear, \n\tWrittenExposure, \n\tPaidAllocatedlossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tZipPostalCode, \n\tTransactionEffectiveDate, \n\tLocationNumber\n\tFROM EXP_Target_GL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_GL AS (\n\tINSERT INTO ISSFlatFile_GL\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, WrittenExposure, PaidAllocatedlossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tCLAIMLOSSDATE, \n\tTYPEOFPOLICYCONTRACT, \n\tCLAIMSENTRYYEAR, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tZIPPOSTALCODE, \n\tTRANSACTIONEFFECTIVEDATE, \n\tLOCATIONNUMBER\n\tFROM SRT_FlatFile_GL\n),\nSQ_ISSPL_Loss AS (\n\t--loss\r\n\tSELECT DISTINCT ISSProfessionalLiabilityExtract.ISSProfessionalLiabilityExtractid, \r\n\t                ISSProfessionalLiabilityExtract.auditid, \r\n\t                ISSProfessionalLiabilityExtract.createddate, \r\n\t                ISSProfessionalLiabilityExtract.edwpremiummastercalculationpkid, \r\n\t                ISSProfessionalLiabilityExtract.edwlossmastercalculationpkid, \r\n\t                ISSProfessionalLiabilityExtract.typebureaucode, \r\n\t                ISSProfessionalLiabilityExtract.bureaulineofinsurance, \r\n\t                ISSProfessionalLiabilityExtract.bureaucompanynumber, \r\n\t                ISSProfessionalLiabilityExtract.stateprovincecode, \r\n\t                ISSProfessionalLiabilityExtract.premiummasterrundate, \r\n\t                ISSProfessionalLiabilityExtract.lossmasterrundate, \r\n\t                ISSProfessionalLiabilityExtract.policykey, \r\n\t                ISSProfessionalLiabilityExtract.premiummasterclasscode, \r\n\t                ISSProfessionalLiabilityExtract.lossmasterclasscode, \r\n\t                ISSProfessionalLiabilityExtract.claimnumber, \r\n\t                ISSProfessionalLiabilityExtract.claimantnumber, \r\n\t                ISSProfessionalLiabilityExtract.riskterritorycode, \r\n\t                ISSProfessionalLiabilityExtract.policyeffectivedate, \r\n\t                ISSProfessionalLiabilityExtract.causeofloss, \r\n\t                ISSProfessionalLiabilityExtract.sublinecode, \r\n\t                ISSProfessionalLiabilityExtract.packagemodificationadjustmentgroupdescription, \r\n\t                ISSProfessionalLiabilityExtract.premiummasterdirectwrittenpremiumamount, \r\n\t                ISSProfessionalLiabilityExtract.paidlossamount, \r\n\t                ISSProfessionalLiabilityExtract.outstandinglossamount, \r\n\t                ISSProfessionalLiabilityExtract.policyexpirationdate, \r\n\t                ISSProfessionalLiabilityExtract.inceptiontodatepaidlossamount, \r\n\t                ISSProfessionalLiabilityExtract.claimantcoveragedetailid, \r\n\t                ISSProfessionalLiabilityExtract.annualstatementlinenumber, \r\n\t                ISSProfessionalLiabilityExtract.writtenexposure, \r\n\t                ISSProfessionalLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount, \r\n\t                ISSProfessionalLiabilityExtract.claimlossdate, \r\n\t                ISSProfessionalLiabilityExtract.typeofpolicycontract, \r\n\t                ISSProfessionalLiabilityExtract.claimsentryyear, \r\n\t                ISSProfessionalLiabilityExtract.paidallocatedlossadjustmentexpenseamount, \r\n\t                ISSProfessionalLiabilityExtract.zippostalcode, \r\n\t                ISSProfessionalLiabilityExtract.transactioneffectivedate , \r\n\t                ISSProfessionalLiabilityExtract.locationnumber \r\n\tFROM            ISSProfessionalLiabilityExtract \r\n\tWHERE           edwlossmastercalculationpkid<>-1 \r\n\t@{pipeline().parameters.WHERE_CLAUSE_PL_LOSS}\n),\nEXP_PL_LOSS AS (\n\tSELECT\n\tISSProfessionalLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSPL_Loss\n),\nSQ_ISSPL_Premium_RemoveDuplicate AS (\n\tWITH ROLLUP_TABLE_TEMP\r\n\tAS\r\n\t(SELECT\r\n\t\t\tSUM(PremiumMasterDirectWrittenPremiumAmount) ROLL_UP_DWP_AMT\r\n\t\t\t,MAX(ISSProfessionalLiabilityExtractid) MAX_ISS_KEY\r\n\t\tFROM ISSProfessionalLiabilityExtract\r\n\t\tWHERE EDWPremiumMasterCalculationPKId <> -1\r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_PL_PREMIUM}\r\n\t\tGROUP BY CONCAT(typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, ABS(premiummasterdirectwrittenpremiumamount), policyexpirationdate, claimantcoveragedetailid, annualstatementlinenumber, ABS(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber)\r\n\t\tHAVING COUNT(1) > 1)\r\n\t\r\n\t\r\n\tSELECT\r\n\t\tISSProfessionalLiabilityExtract.ISSProfessionalLiabilityExtractid\r\n\t\t,ISSProfessionalLiabilityExtract.auditid\r\n\t\t,ISSProfessionalLiabilityExtract.createddate\r\n\t\t,ISSProfessionalLiabilityExtract.edwpremiummastercalculationpkid\r\n\t\t,ISSProfessionalLiabilityExtract.edwlossmastercalculationpkid\r\n\t\t,ISSProfessionalLiabilityExtract.typebureaucode\r\n\t\t,ISSProfessionalLiabilityExtract.bureaulineofinsurance\r\n\t\t,ISSProfessionalLiabilityExtract.bureaucompanynumber\r\n\t\t,ISSProfessionalLiabilityExtract.stateprovincecode\r\n\t\t,ISSProfessionalLiabilityExtract.premiummasterrundate\r\n\t\t,ISSProfessionalLiabilityExtract.lossmasterrundate\r\n\t\t,ISSProfessionalLiabilityExtract.policykey\r\n\t\t,ISSProfessionalLiabilityExtract.premiummasterclasscode\r\n\t\t,ISSProfessionalLiabilityExtract.lossmasterclasscode\r\n\t\t,ISSProfessionalLiabilityExtract.claimnumber\r\n\t\t,ISSProfessionalLiabilityExtract.claimantnumber\r\n\t\t,ISSProfessionalLiabilityExtract.riskterritorycode\r\n\t\t,ISSProfessionalLiabilityExtract.policyeffectivedate\r\n\t\t,ISSProfessionalLiabilityExtract.causeofloss\r\n\t\t,ISSProfessionalLiabilityExtract.sublinecode\r\n\t\t,ISSProfessionalLiabilityExtract.packagemodificationadjustmentgroupdescription\r\n\t\t,ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT AS PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,ISSProfessionalLiabilityExtract.paidlossamount\r\n\t\t,ISSProfessionalLiabilityExtract.outstandinglossamount\r\n\t\t,ISSProfessionalLiabilityExtract.policyexpirationdate\r\n\t\t,ISSProfessionalLiabilityExtract.inceptiontodatepaidlossamount\r\n\t\t,ISSProfessionalLiabilityExtract.claimantcoveragedetailid\r\n\t\t,ISSProfessionalLiabilityExtract.annualstatementlinenumber\r\n\t\t,CASE\r\n\t\t\tWHEN ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT > 0 THEN ABS(ISSProfessionalLiabilityExtract.WrittenExposure)\r\n\t\t\tELSE (-1 * ABS(ISSProfessionalLiabilityExtract.WrittenExposure))\r\n\t\tEND AS WrittenExposure\r\n\t\t,ISSProfessionalLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount\r\n\t\t,ISSProfessionalLiabilityExtract.claimlossdate\r\n\t\t,ISSProfessionalLiabilityExtract.typeofpolicycontract\r\n\t\t,ISSProfessionalLiabilityExtract.claimsentryyear\r\n\t\t,ISSProfessionalLiabilityExtract.paidallocatedlossadjustmentexpenseamount\r\n\t\t,ISSProfessionalLiabilityExtract.zippostalcode\r\n\t\t,ISSProfessionalLiabilityExtract.transactioneffectivedate\r\n\t\t,ISSProfessionalLiabilityExtract.locationnumber\r\n\tFROM ROLLUP_TABLE_TEMP\r\n\tINNER JOIN ISSProfessionalLiabilityExtract\r\n\t\tON ISSProfessionalLiabilityExtract.ISSProfessionalLiabilityExtractid = ROLLUP_TABLE_TEMP.MAX_ISS_KEY\r\n\tWHERE ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT <> 0\n),\nEXP_PL_Premium_RemoveDuplicate AS (\n\tSELECT\n\tISSProfessionalLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSPL_Premium_RemoveDuplicate\n),\nSQ_ISSPL_PremiumUnique AS (\n\twith prem_unique AS \r\n\t( \r\n\t         SELECT   CONCAT(typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, ABS(premiummasterdirectwrittenpremiumamount), policyexpirationdate, claimantcoveragedetailid, annualstatementlinenumber, ABS(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) concct, \r\n\t                  count(*)                                                                                                                                                                                                        count \r\n\t         FROM     ISSProfessionalLiabilityExtract  a\r\n\t\t\t WHERE    a.edwpremiummastercalculationpkid<>-1 \r\n\t\t\t @{pipeline().parameters.WHERE_CLAUSE_PL_PREMIUM}\r\n\t         GROUP BY CONCAT(typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, ABS(premiummasterdirectwrittenpremiumamount), policyexpirationdate, claimantcoveragedetailid, annualstatementlinenumber, ABS(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) \r\n\t         HAVING   count(*) =1 \r\n\t\t\t) \r\n\t\t\t--premiumunique \r\n\tSELECT     ISSProfessionalLiabilityExtract.ISSProfessionalLiabilityExtractid, \r\n\t           ISSProfessionalLiabilityExtract.auditid, \r\n\t           ISSProfessionalLiabilityExtract.createddate, \r\n\t           ISSProfessionalLiabilityExtract.edwpremiummastercalculationpkid, \r\n\t           ISSProfessionalLiabilityExtract.edwlossmastercalculationpkid, \r\n\t           ISSProfessionalLiabilityExtract.typebureaucode, \r\n\t           ISSProfessionalLiabilityExtract.bureaulineofinsurance, \r\n\t           ISSProfessionalLiabilityExtract.bureaucompanynumber, \r\n\t           ISSProfessionalLiabilityExtract.stateprovincecode, \r\n\t           ISSProfessionalLiabilityExtract.premiummasterrundate, \r\n\t           ISSProfessionalLiabilityExtract.lossmasterrundate, \r\n\t           ISSProfessionalLiabilityExtract.policykey, \r\n\t           ISSProfessionalLiabilityExtract.premiummasterclasscode, \r\n\t           ISSProfessionalLiabilityExtract.lossmasterclasscode, \r\n\t           ISSProfessionalLiabilityExtract.claimnumber, \r\n\t           ISSProfessionalLiabilityExtract.claimantnumber, \r\n\t           ISSProfessionalLiabilityExtract.riskterritorycode, \r\n\t           ISSProfessionalLiabilityExtract.policyeffectivedate, \r\n\t           ISSProfessionalLiabilityExtract.causeofloss, \r\n\t           ISSProfessionalLiabilityExtract.sublinecode, \r\n\t           ISSProfessionalLiabilityExtract.packagemodificationadjustmentgroupdescription, \r\n\t           ISSProfessionalLiabilityExtract.premiummasterdirectwrittenpremiumamount, \r\n\t           ISSProfessionalLiabilityExtract.paidlossamount, \r\n\t           ISSProfessionalLiabilityExtract.outstandinglossamount, \r\n\t           ISSProfessionalLiabilityExtract.policyexpirationdate, \r\n\t           ISSProfessionalLiabilityExtract.inceptiontodatepaidlossamount, \r\n\t           ISSProfessionalLiabilityExtract.claimantcoveragedetailid, \r\n\t           ISSProfessionalLiabilityExtract.annualstatementlinenumber, \r\n\t           ISSProfessionalLiabilityExtract.writtenexposure, \r\n\t           ISSProfessionalLiabilityExtract.outstandingallocatedlossadjustmentexpenseamount, \r\n\t           ISSProfessionalLiabilityExtract.claimlossdate, \r\n\t           ISSProfessionalLiabilityExtract.typeofpolicycontract, \r\n\t           ISSProfessionalLiabilityExtract.claimsentryyear, \r\n\t           ISSProfessionalLiabilityExtract.paidallocatedlossadjustmentexpenseamount, \r\n\t           ISSProfessionalLiabilityExtract.zippostalcode, \r\n\t           ISSProfessionalLiabilityExtract.transactioneffectivedate , \r\n\t           ISSProfessionalLiabilityExtract.locationnumber \r\n\tFROM       ISSProfessionalLiabilityExtract \r\n\tINNER JOIN prem_unique b \r\n\tON         ( \r\n\t                                 CONCAT(typebureaucode, bureaulineofinsurance, bureaucompanynumber, stateprovincecode, policykey, premiummasterclasscode, lossmasterclasscode, claimnumber, claimantnumber, riskterritorycode, policyeffectivedate, causeofloss, sublinecode, packagemodificationadjustmentgroupdescription, ABS(premiummasterdirectwrittenpremiumamount), policyexpirationdate, claimantcoveragedetailid, annualstatementlinenumber, ABS(WrittenExposure), claimlossdate, typeofpolicycontract, claimsentryyear, zippostalcode, transactioneffectivedate, locationnumber) =b.concct) \r\n\tWHERE      ISSProfessionalLiabilityExtract.edwpremiummastercalculationpkid<>-1 \r\n\t@{pipeline().parameters.WHERE_CLAUSE_PL_PREMIUM}\n),\nEXP_PL_Premium_Unique AS (\n\tSELECT\n\tISSProfessionalLiabilityExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tWrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate,\n\tTypeofPolicycontract,\n\tClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode,\n\tTransactionEffectiveDate,\n\tLocationNumber\n\tFROM SQ_ISSPL_PremiumUnique\n),\nUnion_PL_Data AS (\n\tSELECT ISSProfessionalLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_PL_LOSS\n\tUNION\n\tSELECT ISSProfessionalLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_PL_Premium_Unique\n\tUNION\n\tSELECT ISSProfessionalLiabilityExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, WrittenExposure, OutstandingAllocatedLossAdjustmentExpenseAmount, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, PaidAllocatedlossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber\n\tFROM EXP_PL_Premium_RemoveDuplicate\n),\nEXP_CleanData_PL AS (\n\tSELECT\n\tISSProfessionalLiabilityExtractId AS i_WorkISSExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tPolicyKey AS i_PolicyKey,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tClaimNumber AS i_ClaimNumber,\n\tClaimantNumber AS i_ClaimantNumber,\n\tRiskTerritoryCode AS i_RiskTerritoryCode,\n\tPolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tCauseOfLoss AS i_CauseOfLoss,\n\tSublineCode AS i_SublineCode,\n\tPackageModificationAdjustmentGroupDescription AS i_PackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tPolicyExpirationDate AS i_PolicyExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tWrittenExposure AS i_WrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount AS i_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate AS i_Claimlossdate,\n\tTypeofPolicycontract AS i_TypeofPolicycontract,\n\tClaimsEntryYear AS i_ClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount AS i_PaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode AS i_ZipPostalCode,\n\tTransactionEffectiveDate AS i_TransactionEffectiveDate,\n\tLocationNumber AS i_LocationNumber,\n\ti_WorkISSExtractId AS o_WorkISSExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: LTRIM(RTRIM(i_TypeBureauCode))\n\tLTRIM(RTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: LTRIM(RTRIM(i_BureauLineOfInsurance))\n\tLTRIM(RTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\t-- *INF*: LTRIM(RTRIM(i_BureauCompanyNumber))\n\tLTRIM(RTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: LTRIM(RTRIM(i_StateProvinceCode))\n\tLTRIM(RTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyKey))\n\tLTRIM(RTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: LTRIM(RTRIM(i_PremiumMasterClassCode))\n\tLTRIM(RTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_LossMasterClassCode))\n\tLTRIM(RTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimNumber))\n\tLTRIM(RTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimantNumber))\n\tLTRIM(RTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\t-- *INF*: LTRIM(RTRIM(i_RiskTerritoryCode))\n\tLTRIM(RTRIM(i_RiskTerritoryCode)) AS o_RiskTerritoryCode,\n\ti_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: LTRIM(RTRIM(i_CauseOfLoss))\n\tLTRIM(RTRIM(i_CauseOfLoss)) AS o_CauseOfLoss,\n\t-- *INF*: LTRIM(RTRIM(i_DeductibleAmount))\n\tLTRIM(RTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: LTRIM(RTRIM(i_CoverageCode))\n\tLTRIM(RTRIM(i_CoverageCode)) AS o_CoverageCode,\n\t-- *INF*: LTRIM(RTRIM(i_ConstructionCode))\n\tLTRIM(RTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(i_ISOFireProtectionCode))\n\tLTRIM(RTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: LTRIM(RTRIM(i_SublineCode))\n\tLTRIM(RTRIM(i_SublineCode)) AS o_SublineCode,\n\t-- *INF*: LTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription))\n\tLTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription)) AS o_PackageModificationAdjustmentGroupDescription,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyForm))\n\tLTRIM(RTRIM(i_PolicyForm)) AS o_PolicyForm,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_PolicyExpirationDate AS o_PolicyExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailID,\n\ti_AnnualStatementLineNumber AS o_AnnualStatementLineNumber,\n\ti_WrittenExposure AS o_WrittenExposure,\n\ti_OutstandingAllocatedLossAdjustmentExpenseAmount AS o_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\ti_Claimlossdate AS o_Claimlossdate,\n\t-- *INF*: LTRIM(RTRIM(i_TypeofPolicycontract))\n\tLTRIM(RTRIM(i_TypeofPolicycontract)) AS o_TypeofPolicycontract,\n\ti_ClaimsEntryYear AS o_ClaimsEntryYear,\n\ti_PaidAllocatedlossAdjustmentExpenseAmount AS o_PaidAllocatedlossAdjustmentExpenseAmount,\n\ti_ZipPostalCode AS o_ZipPostalCode,\n\ti_TransactionEffectiveDate AS o_TransactionEffectiveDate,\n\ti_LocationNumber AS o_LocationNumber\n\tFROM Union_PL_Data\n),\nEXP_Target_PL AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_GL_PL_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_GL_PL_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\to_WorkISSExtractId AS WorkISSExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_PolicyKey AS PolicyKey,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_RiskTerritoryCode AS RiskTerritoryCode,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_CoverageCode AS CoverageCode,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_SublineCode AS SublineCode,\n\to_PackageModificationAdjustmentGroupDescription AS PackageModificationAdjustmentGroupDescription,\n\to_PolicyForm AS PolicyForm,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailID AS ClaimantCoverageDetailID,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_WrittenExposure AS WrittenExposure,\n\to_OutstandingAllocatedLossAdjustmentExpenseAmount AS OutstandingAllocatedLossAdjustmentExpenseAmount,\n\to_Claimlossdate AS Claimlossdate,\n\to_TypeofPolicycontract AS TypeofPolicycontract,\n\to_ClaimsEntryYear AS ClaimsEntryYear,\n\to_PaidAllocatedlossAdjustmentExpenseAmount AS PaidAllocatedlossAdjustmentExpenseAmount,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate,\n\to_LocationNumber AS LocationNumber\n\tFROM EXP_CleanData_PL\n),\nSRT_FlatFile_PL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tClaimlossdate, \n\tTypeofPolicycontract, \n\tClaimsEntryYear, \n\tWrittenExposure, \n\tPaidAllocatedlossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tZipPostalCode, \n\tTransactionEffectiveDate, \n\tLocationNumber\n\tFROM EXP_Target_PL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_PL AS (\n\tINSERT INTO ISSFlatFile_GL\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, WrittenExposure, PaidAllocatedlossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate, LocationNumber)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tCLAIMLOSSDATE, \n\tTYPEOFPOLICYCONTRACT, \n\tCLAIMSENTRYYEAR, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tZIPPOSTALCODE, \n\tTRANSACTIONEFFECTIVEDATE, \n\tLOCATIONNUMBER\n\tFROM SRT_FlatFile_PL\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WHERE_CLAUSE_GL_LOSS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_GL_PREMIUM": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_PL_LOSS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_PL_PREMIUM": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}