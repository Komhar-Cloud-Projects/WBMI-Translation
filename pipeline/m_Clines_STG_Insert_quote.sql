WITH
SQ_quote AS (
	SELECT
		quote_id,
		pkg_id,
		name,
		eff_date,
		eff_date_set_by_chc_id,
		lob_chc_id,
		status_chc_id,
		umb_prem_last_quoted,
		total_prem_last_quoted,
		notes_to_uw,
		corp_owner_chc_id,
		app_or_quote_chc_id,
		pms_pol_num,
		first_quoted_user_id,
		first_quoted_date,
		app_cmpltd_user_id,
		app_cmpltd_date,
		created_user_id,
		created_date,
		modified_user_id,
		modified_date,
		hidden_flag,
		request_for_quote_flag,
		version_num,
		offering_id,
		pol_sym,
		pol_num,
		pol_mod,
		pol_mco,
		rcvd_date,
		strtgc_bus_unit_dvsn_prog_id,
		exp_date,
		bindable_flag,
		risk_grade_wbmi_id,
		prfrm_clearance_flag,
		reins_req_flag,
		pol_pco,
		tax_and_surchg_amt,
		bus_class_code,
		last_quoted_user_id,
		last_quoted_date
	FROM quote
),
EXP_Values AS (
	SELECT
	quote_id,
	pkg_id,
	name,
	eff_date,
	eff_date_set_by_chc_id,
	lob_chc_id,
	status_chc_id,
	umb_prem_last_quoted,
	total_prem_last_quoted,
	notes_to_uw,
	corp_owner_chc_id,
	app_or_quote_chc_id,
	pms_pol_num,
	first_quoted_user_id,
	first_quoted_date,
	app_cmpltd_user_id,
	app_cmpltd_date,
	created_user_id,
	created_date,
	modified_user_id,
	modified_date,
	hidden_flag,
	request_for_quote_flag,
	version_num,
	offering_id,
	pol_sym,
	pol_num,
	pol_mod,
	pol_mco,
	rcvd_date,
	strtgc_bus_unit_dvsn_prog_id,
	exp_date,
	bindable_flag,
	risk_grade_wbmi_id,
	prfrm_clearance_flag,
	reins_req_flag,
	pol_pco,
	tax_and_surchg_amt,
	bus_class_code,
	last_quoted_user_id,
	last_quoted_date,
	SYSDATE AS extract_date,
	@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_system_id
	FROM SQ_quote
),
quote_cl_stage AS (
	TRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.quote_cl_stage;
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.quote_cl_stage
	(quote_id, pkg_id, name, eff_date, eff_date_set_by_chc_id, lob_chc_id, status_chc_id, umb_prem_last_quoted, total_prem_last_quoted, notes_to_uw, corp_owner_chc_id, app_or_quote_chc_id, pms_pol_num, first_quoted_user_id, first_quoted_date, app_cmpltd_user_id, app_cmpltd_date, created_user_id, created_date, modified_user_id, modified_date, hidden_flag, request_for_quote_flag, version_num, offering_id, pol_sym, pol_num, pol_mod, pol_mco, rcvd_date, strtgc_bus_unit_dvsn_prog_id, exp_date, bindable_flag, risk_grade_wbmi_id, prfrm_clearance_flag, reins_req_flag, pol_pco, tax_and_surchg_amt, bus_class_code, last_quoted_user_id, last_quoted_date, extract_date, source_system_id)
	SELECT 
	QUOTE_ID, 
	PKG_ID, 
	NAME, 
	EFF_DATE, 
	EFF_DATE_SET_BY_CHC_ID, 
	LOB_CHC_ID, 
	STATUS_CHC_ID, 
	UMB_PREM_LAST_QUOTED, 
	TOTAL_PREM_LAST_QUOTED, 
	NOTES_TO_UW, 
	CORP_OWNER_CHC_ID, 
	APP_OR_QUOTE_CHC_ID, 
	PMS_POL_NUM, 
	FIRST_QUOTED_USER_ID, 
	FIRST_QUOTED_DATE, 
	APP_CMPLTD_USER_ID, 
	APP_CMPLTD_DATE, 
	CREATED_USER_ID, 
	CREATED_DATE, 
	MODIFIED_USER_ID, 
	MODIFIED_DATE, 
	HIDDEN_FLAG, 
	REQUEST_FOR_QUOTE_FLAG, 
	VERSION_NUM, 
	OFFERING_ID, 
	POL_SYM, 
	POL_NUM, 
	POL_MOD, 
	POL_MCO, 
	RCVD_DATE, 
	STRTGC_BUS_UNIT_DVSN_PROG_ID, 
	EXP_DATE, 
	BINDABLE_FLAG, 
	RISK_GRADE_WBMI_ID, 
	PRFRM_CLEARANCE_FLAG, 
	REINS_REQ_FLAG, 
	POL_PCO, 
	TAX_AND_SURCHG_AMT, 
	BUS_CLASS_CODE, 
	LAST_QUOTED_USER_ID, 
	LAST_QUOTED_DATE, 
	EXTRACT_DATE, 
	SOURCE_SYSTEM_ID
	FROM EXP_Values
),