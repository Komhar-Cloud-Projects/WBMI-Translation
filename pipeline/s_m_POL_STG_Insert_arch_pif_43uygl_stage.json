{
    "name": "s_m_POL_STG_Insert_arch_pif_43uygl_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43uygl_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif43UYGLStage AS (\n\tSELECT\n\t\tPif43UYGLStageId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifModule,\n\t\tPmduyg1RecLength,\n\t\tPmduyg1ActionCode,\n\t\tPmduyg1FileId,\n\t\tPmduyg1SegmentId,\n\t\tPmduyg1SegmentStatus,\n\t\tPmduyg1YearTransaction,\n\t\tPmduyg1MonthTransaction,\n\t\tPmduyg1DayTransaction,\n\t\tPmduyg1SegmentLevelCode,\n\t\tPmduyg1SegmentPartCode,\n\t\tPmduyg1SubPartCode,\n\t\tPmduyg1InsuranceLine,\n\t\tPmduyg1LocationNumber,\n\t\tPmduyg1PmsDefGlSubline,\n\t\tPmduyg1ClassCodeGroup,\n\t\tPmduyg1ClassCodeMember,\n\t\tPmduyg1ClassCode,\n\t\tPmduyg1RiskSequence,\n\t\tPmduyg1RiskTypeInd,\n\t\tPmduyg1YearItemEffective,\n\t\tPmduyg1MonthItemEffective,\n\t\tPmduyg1DayItemEffective,\n\t\tPmduyg1AddInterestType,\n\t\tPmduyg1AddInterestSeq,\n\t\tPmduyg1ProdwCovType,\n\t\tPmduyg1YearProcess,\n\t\tPmduyg1MonthProcess,\n\t\tPmduyg1DayProcess,\n\t\tPmduyg1ManualGenerateInd,\n\t\tPmduyg1BasicRate,\n\t\tPmduyg1BasicRateMgInd,\n\t\tPmduyg1ModifiedRate,\n\t\tPmduyg1ModifiedRateMgInd,\n\t\tPmduyg1PkgModMgInd,\n\t\tPmduyg1PkgModFactor,\n\t\tPmduyg1DeductibleCredit,\n\t\tPmduyg1DedCrdtMgInd,\n\t\tPmduyg1DeductibleCreditPd,\n\t\tPmduyg1DedCrdtMgIndPd,\n\t\tPmduyg1CalcPremFctr,\n\t\tPmduyg1TermFactor,\n\t\tPmduyg1PremTmMgInd,\n\t\tPmduyg1PremiumTerm,\n\t\tPmduyg1PremDeposMgInd,\n\t\tPmduyg1PremiumDeposit,\n\t\tPmduyg1ClaimsMadeFactor,\n\t\tPmduyg1IncrLimMgInd,\n\t\tPmduyg1IncreaseLimitsFactor,\n\t\tPmduyg1PdIncrLimMgInd,\n\t\tPmduyg1PdIncrLimitFactor,\n\t\tPmduyg1BiWeightMgInd,\n\t\tPmduyg1BiWeightFactor,\n\t\tPmduyg1PdWeightMgInd,\n\t\tPmduyg1PdWeightFactor,\n\t\tPmduyg1FringeRate1,\n\t\tPmduyg1FringeRateMgInd1,\n\t\tPmduyg1FringeRate2,\n\t\tPmduyg1FringeRateMgInd2,\n\t\tPmduyg1FringeRate3,\n\t\tPmduyg1FringeRateMgInd3,\n\t\tPmduyg1Rdf,\n\t\tPmduyg1Rmf,\n\t\tPmduyg1TransitionFactor,\n\t\tPmduyg1ConstantFactor,\n\t\tPmduyg1ConstantMgInd,\n\t\tPmduyg1CoverageChange,\n\t\tPmduyg1RateAtLimits,\n\t\tPmduyg1CompanyDeviation,\n\t\tPmduyg1BiSplitIlf,\n\t\tPmduyg1PdSplitIlf,\n\t\tPmduyg1TotalSplitIlf,\n\t\tPmduyg1AddInterestFactor,\n\t\tPmduyg1AddIntFactorMgInd,\n\t\tPmduyg1ClaimsMadeMgInd,\n\t\tPmduyg1AuditTransFactor,\n\t\tPmduyg1RdfMgInd,\n\t\tPmduyg1DecChangeFlag,\n\t\tPmduyg1TransFactorNew,\n\t\tPmduyg1NyTortFactor,\n\t\tPmguyg1LossCostMult,\n\t\tPmduyg1FullyEarnedSw,\n\t\tPmduyg1TerrorismRate,\n\t\tPmduyg1AvgTerrorRate,\n\t\tPmduyg1BroadFactor,\n\t\tPmduyg1BroadMin,\n\t\tPmduyg1BroadMax,\n\t\tPmduyg1ProdwFactor,\n\t\tPmduyg1ProdwFactorMgInd,\n\t\tPmduyg1PmsFutureUse,\n\t\tPmduyg1EdgeFactor,\n\t\tPmduyg1EmpBen0100Fact,\n\t\tPmduyg1EmpBen101400Fact,\n\t\tPmduyg1EmpBen401700Fact,\n\t\tPmduyg1EmpBen7011000Fact,\n\t\tPmduyg1ProgramFactor,\n\t\tPmduyg1AssociationFactor,\n\t\tPmduyg1CustomerUse,\n\t\tPmduyg1BldgNum,\n\t\tPmduyg1RestaurantSqFt,\n\t\tPmduyg1LpwIncidentFactor,\n\t\tPmduyg1SapFactor,\n\t\tPmduyg1RestaurantSqFt6,\n\t\tPmduyg1Yr2000CustUse,\n\t\tPmduyg1WbcKey,\n\t\tExtractDate,\n\t\tAsOfDate,\n\t\tRecordCount,\n\t\tSourceSystemId\n\tFROM Pif43UYGLStage\n),\nEXP_Values AS (\n\tSELECT\n\tPif43UYGLStageId AS Pif43UYStageId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifModule,\n\tPmduyg1RecLength,\n\tPmduyg1ActionCode,\n\tPmduyg1FileId,\n\tPmduyg1SegmentId,\n\tPmduyg1SegmentStatus,\n\tPmduyg1YearTransaction,\n\tPmduyg1MonthTransaction,\n\tPmduyg1DayTransaction,\n\tPmduyg1SegmentLevelCode,\n\tPmduyg1SegmentPartCode,\n\tPmduyg1SubPartCode,\n\tPmduyg1InsuranceLine,\n\tPmduyg1LocationNumber,\n\tPmduyg1PmsDefGlSubline,\n\tPmduyg1ClassCodeGroup,\n\tPmduyg1ClassCodeMember,\n\tPmduyg1ClassCode,\n\tPmduyg1RiskSequence,\n\tPmduyg1RiskTypeInd,\n\tPmduyg1YearItemEffective,\n\tPmduyg1MonthItemEffective,\n\tPmduyg1DayItemEffective,\n\tPmduyg1AddInterestType,\n\tPmduyg1AddInterestSeq,\n\tPmduyg1ProdwCovType,\n\tPmduyg1YearProcess,\n\tPmduyg1MonthProcess,\n\tPmduyg1DayProcess,\n\tPmduyg1ManualGenerateInd,\n\tPmduyg1BasicRate,\n\tPmduyg1BasicRateMgInd,\n\tPmduyg1ModifiedRate,\n\tPmduyg1ModifiedRateMgInd,\n\tPmduyg1PkgModMgInd,\n\tPmduyg1PkgModFactor,\n\tPmduyg1DeductibleCredit,\n\tPmduyg1DedCrdtMgInd,\n\tPmduyg1DeductibleCreditPd,\n\tPmduyg1DedCrdtMgIndPd,\n\tPmduyg1CalcPremFctr,\n\tPmduyg1TermFactor,\n\tPmduyg1PremTmMgInd,\n\tPmduyg1PremiumTerm,\n\tPmduyg1PremDeposMgInd,\n\tPmduyg1PremiumDeposit,\n\tPmduyg1ClaimsMadeFactor,\n\tPmduyg1IncrLimMgInd,\n\tPmduyg1IncreaseLimitsFactor,\n\tPmduyg1PdIncrLimMgInd,\n\tPmduyg1PdIncrLimitFactor,\n\tPmduyg1BiWeightMgInd,\n\tPmduyg1BiWeightFactor,\n\tPmduyg1PdWeightMgInd,\n\tPmduyg1PdWeightFactor,\n\tPmduyg1FringeRate1,\n\tPmduyg1FringeRateMgInd1,\n\tPmduyg1FringeRate2,\n\tPmduyg1FringeRateMgInd2,\n\tPmduyg1FringeRate3,\n\tPmduyg1FringeRateMgInd3,\n\tPmduyg1Rdf,\n\tPmduyg1Rmf,\n\tPmduyg1TransitionFactor,\n\tPmduyg1ConstantFactor,\n\tPmduyg1ConstantMgInd,\n\tPmduyg1CoverageChange,\n\tPmduyg1RateAtLimits,\n\tPmduyg1CompanyDeviation,\n\tPmduyg1BiSplitIlf,\n\tPmduyg1PdSplitIlf,\n\tPmduyg1TotalSplitIlf,\n\tPmduyg1AddInterestFactor,\n\tPmduyg1AddIntFactorMgInd,\n\tPmduyg1ClaimsMadeMgInd,\n\tPmduyg1AuditTransFactor,\n\tPmduyg1RdfMgInd,\n\tPmduyg1DecChangeFlag,\n\tPmduyg1TransFactorNew,\n\tPmduyg1NyTortFactor,\n\tPmguyg1LossCostMult,\n\tPmduyg1FullyEarnedSw,\n\tPmduyg1TerrorismRate,\n\tPmduyg1AvgTerrorRate,\n\tPmduyg1BroadFactor,\n\tPmduyg1BroadMin,\n\tPmduyg1BroadMax,\n\tPmduyg1ProdwFactor,\n\tPmduyg1ProdwFactorMgInd,\n\tPmduyg1PmsFutureUse,\n\tPmduyg1EdgeFactor,\n\tPmduyg1EmpBen0100Fact AS Pmduyg1EmpBen0100Factor,\n\tPmduyg1EmpBen101400Fact AS Pmduyg1EmpBen101400Factor,\n\tPmduyg1EmpBen401700Fact AS Pmduyg1EmpBen401700Factor,\n\tPmduyg1EmpBen7011000Fact AS Pmduyg1EmpBen7011000Factor,\n\tPmduyg1ProgramFactor,\n\tPmduyg1AssociationFactor,\n\tPmduyg1CustomerUse,\n\tPmduyg1BldgNum,\n\tPmduyg1RestaurantSqFt,\n\tPmduyg1LpwIncidentFactor,\n\tPmduyg1SapFactor,\n\tPmduyg1RestaurantSqFt6,\n\tPmduyg1Yr2000CustUse,\n\tPmduyg1WbcKey,\n\tExtractDate,\n\tAsOfDate,\n\tRecordCount,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_Pif43UYGLStage\n),\nArchPif43UYGLStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UYGLStage\n\t(Pif43UYGLStageId, PifSymbol, PifPolicyNumber, PifModule, Pmduyg1RecLength, Pmduyg1ActionCode, Pmduyg1FileId, Pmduyg1SegmentId, Pmduyg1SegmentStatus, Pmduyg1YearTransaction, Pmduyg1MonthTransaction, Pmduyg1DayTransaction, Pmduyg1SegmentLevelCode, Pmduyg1SegmentPartCode, Pmduyg1SubPartCode, Pmduyg1InsuranceLine, Pmduyg1LocationNumber, Pmduyg1PmsDefGlSubline, Pmduyg1ClassCodeGroup, Pmduyg1ClassCodeMember, Pmduyg1ClassCode, Pmduyg1RiskSequence, Pmduyg1RiskTypeInd, Pmduyg1YearItemEffective, Pmduyg1MonthItemEffective, Pmduyg1DayItemEffective, Pmduyg1AddInterestType, Pmduyg1AddInterestSeq, Pmduyg1ProdwCovType, Pmduyg1YearProcess, Pmduyg1MonthProcess, Pmduyg1DayProcess, Pmduyg1ManualGenerateInd, Pmduyg1BasicRate, Pmduyg1BasicRateMgInd, Pmduyg1ModifiedRate, Pmduyg1ModifiedRateMgInd, Pmduyg1PkgModMgInd, Pmduyg1PkgModFactor, Pmduyg1DeductibleCredit, Pmduyg1DedCrdtMgInd, Pmduyg1DeductibleCreditPd, Pmduyg1DedCrdtMgIndPd, Pmduyg1CalcPremFctr, Pmduyg1TermFactor, Pmduyg1PremTmMgInd, Pmduyg1PremiumTerm, Pmduyg1PremDeposMgInd, Pmduyg1PremiumDeposit, Pmduyg1ClaimsMadeFactor, Pmduyg1IncrLimMgInd, Pmduyg1IncreaseLimitsFactor, Pmduyg1PdIncrLimMgInd, Pmduyg1PdIncrLimitFactor, Pmduyg1BiWeightMgInd, Pmduyg1BiWeightFactor, Pmduyg1PdWeightMgInd, Pmduyg1PdWeightFactor, Pmduyg1FringeRate1, Pmduyg1FringeRateMgInd1, Pmduyg1FringeRate2, Pmduyg1FringeRateMgInd2, Pmduyg1FringeRate3, Pmduyg1FringeRateMgInd3, Pmduyg1Rdf, Pmduyg1Rmf, Pmduyg1TransitionFactor, Pmduyg1ConstantFactor, Pmduyg1ConstantMgInd, Pmduyg1CoverageChange, Pmduyg1RateAtLimits, Pmduyg1CompanyDeviation, Pmduyg1BiSplitIlf, Pmduyg1PdSplitIlf, Pmduyg1TotalSplitIlf, Pmduyg1AddInterestFactor, Pmduyg1AddIntFactorMgInd, Pmduyg1ClaimsMadeMgInd, Pmduyg1AuditTransFactor, Pmduyg1RdfMgInd, Pmduyg1DecChangeFlag, Pmduyg1TransFactorNew, Pmduyg1NyTortFactor, Pmguyg1LossCostMult, Pmduyg1FullyEarnedSw, Pmduyg1TerrorismRate, Pmduyg1AvgTerrorRate, Pmduyg1BroadFactor, Pmduyg1BroadMin, Pmduyg1BroadMax, Pmduyg1ProdwFactor, Pmduyg1ProdwFactorMgInd, Pmduyg1PmsFutureUse, Pmduyg1EdgeFactor, Pmduyg1EmpBen0100Fact, Pmduyg1EmpBen101400Fact, Pmduyg1EmpBen401700Fact, Pmduyg1EmpBen7011000Fact, Pmduyg1ProgramFactor, Pmduyg1AssociationFactor, Pmduyg1CustomerUse, Pmduyg1BldgNum, Pmduyg1RestaurantSqFt, Pmduyg1LpwIncidentFactor, Pmduyg1SapFactor, Pmduyg1RestaurantSqFt6, Pmduyg1Yr2000CustUse, Pmduyg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)\n\tSELECT \n\tPif43UYStageId AS PIF43UYGLSTAGEID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFMODULE, \n\tPMDUYG1RECLENGTH, \n\tPMDUYG1ACTIONCODE, \n\tPMDUYG1FILEID, \n\tPMDUYG1SEGMENTID, \n\tPMDUYG1SEGMENTSTATUS, \n\tPMDUYG1YEARTRANSACTION, \n\tPMDUYG1MONTHTRANSACTION, \n\tPMDUYG1DAYTRANSACTION, \n\tPMDUYG1SEGMENTLEVELCODE, \n\tPMDUYG1SEGMENTPARTCODE, \n\tPMDUYG1SUBPARTCODE, \n\tPMDUYG1INSURANCELINE, \n\tPMDUYG1LOCATIONNUMBER, \n\tPMDUYG1PMSDEFGLSUBLINE, \n\tPMDUYG1CLASSCODEGROUP, \n\tPMDUYG1CLASSCODEMEMBER, \n\tPMDUYG1CLASSCODE, \n\tPMDUYG1RISKSEQUENCE, \n\tPMDUYG1RISKTYPEIND, \n\tPMDUYG1YEARITEMEFFECTIVE, \n\tPMDUYG1MONTHITEMEFFECTIVE, \n\tPMDUYG1DAYITEMEFFECTIVE, \n\tPMDUYG1ADDINTERESTTYPE, \n\tPMDUYG1ADDINTERESTSEQ, \n\tPMDUYG1PRODWCOVTYPE, \n\tPMDUYG1YEARPROCESS, \n\tPMDUYG1MONTHPROCESS, \n\tPMDUYG1DAYPROCESS, \n\tPMDUYG1MANUALGENERATEIND, \n\tPMDUYG1BASICRATE, \n\tPMDUYG1BASICRATEMGIND, \n\tPMDUYG1MODIFIEDRATE, \n\tPMDUYG1MODIFIEDRATEMGIND, \n\tPMDUYG1PKGMODMGIND, \n\tPMDUYG1PKGMODFACTOR, \n\tPMDUYG1DEDUCTIBLECREDIT, \n\tPMDUYG1DEDCRDTMGIND, \n\tPMDUYG1DEDUCTIBLECREDITPD, \n\tPMDUYG1DEDCRDTMGINDPD, \n\tPMDUYG1CALCPREMFCTR, \n\tPMDUYG1TERMFACTOR, \n\tPMDUYG1PREMTMMGIND, \n\tPMDUYG1PREMIUMTERM, \n\tPMDUYG1PREMDEPOSMGIND, \n\tPMDUYG1PREMIUMDEPOSIT, \n\tPMDUYG1CLAIMSMADEFACTOR, \n\tPMDUYG1INCRLIMMGIND, \n\tPMDUYG1INCREASELIMITSFACTOR, \n\tPMDUYG1PDINCRLIMMGIND, \n\tPMDUYG1PDINCRLIMITFACTOR, \n\tPMDUYG1BIWEIGHTMGIND, \n\tPMDUYG1BIWEIGHTFACTOR, \n\tPMDUYG1PDWEIGHTMGIND, \n\tPMDUYG1PDWEIGHTFACTOR, \n\tPMDUYG1FRINGERATE1, \n\tPMDUYG1FRINGERATEMGIND1, \n\tPMDUYG1FRINGERATE2, \n\tPMDUYG1FRINGERATEMGIND2, \n\tPMDUYG1FRINGERATE3, \n\tPMDUYG1FRINGERATEMGIND3, \n\tPMDUYG1RDF, \n\tPMDUYG1RMF, \n\tPMDUYG1TRANSITIONFACTOR, \n\tPMDUYG1CONSTANTFACTOR, \n\tPMDUYG1CONSTANTMGIND, \n\tPMDUYG1COVERAGECHANGE, \n\tPMDUYG1RATEATLIMITS, \n\tPMDUYG1COMPANYDEVIATION, \n\tPMDUYG1BISPLITILF, \n\tPMDUYG1PDSPLITILF, \n\tPMDUYG1TOTALSPLITILF, \n\tPMDUYG1ADDINTERESTFACTOR, \n\tPMDUYG1ADDINTFACTORMGIND, \n\tPMDUYG1CLAIMSMADEMGIND, \n\tPMDUYG1AUDITTRANSFACTOR, \n\tPMDUYG1RDFMGIND, \n\tPMDUYG1DECCHANGEFLAG, \n\tPMDUYG1TRANSFACTORNEW, \n\tPMDUYG1NYTORTFACTOR, \n\tPMGUYG1LOSSCOSTMULT, \n\tPMDUYG1FULLYEARNEDSW, \n\tPMDUYG1TERRORISMRATE, \n\tPMDUYG1AVGTERRORRATE, \n\tPMDUYG1BROADFACTOR, \n\tPMDUYG1BROADMIN, \n\tPMDUYG1BROADMAX, \n\tPMDUYG1PRODWFACTOR, \n\tPMDUYG1PRODWFACTORMGIND, \n\tPMDUYG1PMSFUTUREUSE, \n\tPMDUYG1EDGEFACTOR, \n\tPmduyg1EmpBen0100Factor AS PMDUYG1EMPBEN0100FACT, \n\tPmduyg1EmpBen101400Factor AS PMDUYG1EMPBEN101400FACT, \n\tPmduyg1EmpBen401700Factor AS PMDUYG1EMPBEN401700FACT, \n\tPmduyg1EmpBen7011000Factor AS PMDUYG1EMPBEN7011000FACT, \n\tPMDUYG1PROGRAMFACTOR, \n\tPMDUYG1ASSOCIATIONFACTOR, \n\tPMDUYG1CUSTOMERUSE, \n\tPMDUYG1BLDGNUM, \n\tPMDUYG1RESTAURANTSQFT, \n\tPMDUYG1LPWINCIDENTFACTOR, \n\tPMDUYG1SAPFACTOR, \n\tPMDUYG1RESTAURANTSQFT6, \n\tPMDUYG1YR2000CUSTUSE, \n\tPMDUYG1WBCKEY, \n\tEXTRACTDATE, \n\tASOFDATE, \n\tRECORDCOUNT, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID\n\tFROM EXP_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}