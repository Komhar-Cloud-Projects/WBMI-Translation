{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_archDCCFPropertyStaging",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_archDCCFPropertyStaging",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_DCCFPropertyStaging AS (\n\tSELECT\n\t\tCF_RiskId,\n\t\tCF_PropertyId,\n\t\tSessionId,\n\t\tId,\n\t\tBG1Coverages,\n\t\tBG1PremRatingGroup,\n\t\tBG1SpecificOccupancyGroupLA,\n\t\tBG1SpecificRate,\n\t\tBG1SpecificRateForNY,\n\t\tBG1SpecificRateLCMSelect,\n\t\tBG1SpecificRateSelect,\n\t\tBG2HeavyMachinery,\n\t\tBG2PremRatingGroup,\n\t\tBG2SpecificRate,\n\t\tBG2Symbol,\n\t\tBG2SymbolApply,\n\t\tBG2SymbolPrefix,\n\t\tBG2TrailerAutoHomesMS,\n\t\tBlanketHighestRateNote,\n\t\tBuildingMaterialsSuppliesOfOthersPremiumBLDRK,\n\t\tBurglarAlarm,\n\t\tBurglarAlarmExtentOfProtection,\n\t\tBurglarAlarmGrade,\n\t\tCauseOfLoss,\n\t\tClassLimit,\n\t\tCoinsurancePercentage,\n\t\tCoinsurancePercentageGroupRated,\n\t\tCoinsuranceRequirement,\n\t\tCoinsuranceValueReporting,\n\t\tCollapseBLDRK,\n\t\tCommunicationSupply,\n\t\tComputerFailure,\n\t\tContentType,\n\t\tCSP,\n\t\tEarthquakeSelect,\n\t\tEligibleForDeductibleInsurancePlan,\n\t\tExteriorWallsOfClayMS,\n\t\tIncidentalApartment,\n\t\tLimitedSprinklerExposure,\n\t\tNonSprinkleredBuilding,\n\t\tOccupancyType,\n\t\tOtherCauseOfLossRiskType,\n\t\tOtherPremRatingGroup,\n\t\tOtherProtectiveDeviceFactor,\n\t\tOtherProtectiveDevices,\n\t\tPowerSupply,\n\t\tProviderType,\n\t\tPublicPropertySelect,\n\t\tRenovationsBLDRK,\n\t\tReportingFormBLDRK,\n\t\tSpecializedUse,\n\t\tSprinkleredBuilding,\n\t\tSprinklerPercentage,\n\t\tStateOwnedPropCredit,\n\t\tSubContractors,\n\t\tTenantsImprovementsBetterments,\n\t\tTheftOfBuildingMaterialsBLDRK,\n\t\tUnitNumber,\n\t\tValuation,\n\t\tWatchmanProtection,\n\t\tWaterSupply,\n\t\tWindstormProtectiveDevices,\n\t\tYardConstruction,\n\t\tExtractDate,\n\t\tSourceSystemId\n\tFROM DCCFPropertyStaging\n),\nEXP_Metadata AS (\n\tSELECT\n\tCF_RiskId,\n\tCF_PropertyId,\n\tSessionId,\n\tId,\n\tBG1Coverages,\n\tBG1PremRatingGroup,\n\tBG1SpecificOccupancyGroupLA,\n\tBG1SpecificRate,\n\tBG1SpecificRateForNY AS i_BG1SpecificRateForNY,\n\t-- *INF*: DECODE(i_BG1SpecificRateForNY,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_BG1SpecificRateForNY,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateForNY,\n\tBG1SpecificRateLCMSelect AS i_BG1SpecificRateLCMSelect,\n\t-- *INF*: DECODE(i_BG1SpecificRateLCMSelect,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_BG1SpecificRateLCMSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateLCMSelect,\n\tBG1SpecificRateSelect AS i_BG1SpecificRateSelect,\n\t-- *INF*: DECODE(i_BG1SpecificRateSelect,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_BG1SpecificRateSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateSelect,\n\tBG2HeavyMachinery,\n\tBG2PremRatingGroup,\n\tBG2SpecificRate,\n\tBG2Symbol,\n\tBG2SymbolApply AS i_BG2SymbolApply,\n\t-- *INF*: DECODE(i_BG2SymbolApply,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_BG2SymbolApply,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG2SymbolApply,\n\tBG2SymbolPrefix,\n\tBG2TrailerAutoHomesMS AS i_BG2TrailerAutoHomesMS,\n\t-- *INF*: DECODE(i_BG2TrailerAutoHomesMS,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_BG2TrailerAutoHomesMS,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG2TrailerAutoHomesMS,\n\tBlanketHighestRateNote,\n\tBuildingMaterialsSuppliesOfOthersPremiumBLDRK,\n\tBurglarAlarm,\n\tBurglarAlarmExtentOfProtection,\n\tBurglarAlarmGrade,\n\tCauseOfLoss,\n\tClassLimit,\n\tCoinsurancePercentage,\n\tCoinsurancePercentageGroupRated,\n\tCoinsuranceRequirement,\n\tCoinsuranceValueReporting,\n\tCollapseBLDRK,\n\tCommunicationSupply,\n\tComputerFailure AS i_ComputerFailure,\n\t-- *INF*: DECODE(i_ComputerFailure,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ComputerFailure,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ComputerFailure,\n\tContentType,\n\tCSP,\n\tEarthquakeSelect AS i_EarthquakeSelect,\n\t-- *INF*: DECODE(i_EarthquakeSelect,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_EarthquakeSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_EarthquakeSelect,\n\tEligibleForDeductibleInsurancePlan AS i_EligibleForDeductibleInsurancePlan,\n\t-- *INF*: DECODE(i_EligibleForDeductibleInsurancePlan,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_EligibleForDeductibleInsurancePlan,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_EligibleForDeductibleInsurancePlan,\n\tExteriorWallsOfClayMS AS i_ExteriorWallsOfClayMS,\n\t-- *INF*: DECODE(i_ExteriorWallsOfClayMS,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ExteriorWallsOfClayMS,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ExteriorWallsOfClayMS,\n\tIncidentalApartment AS i_IncidentalApartment,\n\t-- *INF*: DECODE(i_IncidentalApartment,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_IncidentalApartment,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_IncidentalApartment,\n\tLimitedSprinklerExposure AS i_LimitedSprinklerExposure,\n\t-- *INF*: DECODE(i_LimitedSprinklerExposure,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_LimitedSprinklerExposure,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_LimitedSprinklerExposure,\n\tNonSprinkleredBuilding AS i_NonSprinkleredBuilding,\n\t-- *INF*: DECODE(i_NonSprinkleredBuilding,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_NonSprinkleredBuilding,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_NonSprinkleredBuilding,\n\tOccupancyType,\n\tOtherCauseOfLossRiskType,\n\tOtherPremRatingGroup,\n\tOtherProtectiveDeviceFactor,\n\tOtherProtectiveDevices AS i_OtherProtectiveDevices,\n\t-- *INF*: DECODE(i_OtherProtectiveDevices,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_OtherProtectiveDevices,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_OtherProtectiveDevices,\n\tPowerSupply,\n\tProviderType,\n\tPublicPropertySelect AS i_PublicPropertySelect,\n\t-- *INF*: DECODE(i_PublicPropertySelect,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_PublicPropertySelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PublicPropertySelect,\n\tRenovationsBLDRK AS i_RenovationsBLDRK,\n\t-- *INF*: DECODE(i_RenovationsBLDRK,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_RenovationsBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_RenovationsBLDRK,\n\tReportingFormBLDRK AS i_ReportingFormBLDRK,\n\t-- *INF*: DECODE(i_ReportingFormBLDRK,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_ReportingFormBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ReportingFormBLDRK,\n\tSpecializedUse,\n\tSprinkleredBuilding AS i_SprinkleredBuilding,\n\t-- *INF*: DECODE(i_SprinkleredBuilding,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_SprinkleredBuilding,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_SprinkleredBuilding,\n\tSprinklerPercentage,\n\tStateOwnedPropCredit AS i_StateOwnedPropCredit,\n\t-- *INF*: DECODE(i_StateOwnedPropCredit,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_StateOwnedPropCredit,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_StateOwnedPropCredit,\n\tSubContractors,\n\tTenantsImprovementsBetterments AS i_TenantsImprovementsBetterments,\n\t-- *INF*: DECODE(i_TenantsImprovementsBetterments,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_TenantsImprovementsBetterments,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_TenantsImprovementsBetterments,\n\tTheftOfBuildingMaterialsBLDRK AS i_TheftOfBuildingMaterialsBLDRK,\n\t-- *INF*: DECODE(i_TheftOfBuildingMaterialsBLDRK,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_TheftOfBuildingMaterialsBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_TheftOfBuildingMaterialsBLDRK,\n\tUnitNumber,\n\tValuation,\n\tWatchmanProtection,\n\tWaterSupply AS i_WaterSupply,\n\t-- *INF*: DECODE(i_WaterSupply,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_WaterSupply,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_WaterSupply,\n\tWindstormProtectiveDevices AS i_WindstormProtectiveDevices,\n\t-- *INF*: DECODE(i_WindstormProtectiveDevices,'T',1,'F',0,NULL)\n\tDECODE(\n\t    i_WindstormProtectiveDevices,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_WindstormProtectiveDevices,\n\tYardConstruction,\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_DCCFPropertyStaging\n),\narchDCCFPropertyStaging AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archDCCFPropertyStaging\n\t(CF_RiskId, CF_PropertyId, SessionId, Id, BG1Coverages, BG1PremRatingGroup, BG1SpecificOccupancyGroupLA, BG1SpecificRate, BG1SpecificRateForNY, BG1SpecificRateLCMSelect, BG1SpecificRateSelect, BG2HeavyMachinery, BG2PremRatingGroup, BG2SpecificRate, BG2Symbol, BG2SymbolApply, BG2SymbolPrefix, BG2TrailerAutoHomesMS, BlanketHighestRateNote, BuildingMaterialsSuppliesOfOthersPremiumBLDRK, BurglarAlarm, BurglarAlarmExtentOfProtection, BurglarAlarmGrade, CauseOfLoss, ClassLimit, CoinsurancePercentage, CoinsurancePercentageGroupRated, CoinsuranceRequirement, CoinsuranceValueReporting, CollapseBLDRK, CommunicationSupply, ComputerFailure, ContentType, CSP, EarthquakeSelect, EligibleForDeductibleInsurancePlan, ExteriorWallsOfClayMS, IncidentalApartment, LimitedSprinklerExposure, NonSprinkleredBuilding, OccupancyType, OtherCauseOfLossRiskType, OtherPremRatingGroup, OtherProtectiveDeviceFactor, OtherProtectiveDevices, PowerSupply, ProviderType, PublicPropertySelect, RenovationsBLDRK, ReportingFormBLDRK, SpecializedUse, SprinkleredBuilding, SprinklerPercentage, StateOwnedPropCredit, SubContractors, TenantsImprovementsBetterments, TheftOfBuildingMaterialsBLDRK, UnitNumber, Valuation, WatchmanProtection, WaterSupply, WindstormProtectiveDevices, YardConstruction, ExtractDate, SourceSystemId, AuditId)\n\tSELECT \n\tCF_RISKID, \n\tCF_PROPERTYID, \n\tSESSIONID, \n\tID, \n\tBG1COVERAGES, \n\tBG1PREMRATINGGROUP, \n\tBG1SPECIFICOCCUPANCYGROUPLA, \n\tBG1SPECIFICRATE, \n\to_BG1SpecificRateForNY AS BG1SPECIFICRATEFORNY, \n\to_BG1SpecificRateLCMSelect AS BG1SPECIFICRATELCMSELECT, \n\to_BG1SpecificRateSelect AS BG1SPECIFICRATESELECT, \n\tBG2HEAVYMACHINERY, \n\tBG2PREMRATINGGROUP, \n\tBG2SPECIFICRATE, \n\tBG2SYMBOL, \n\to_BG2SymbolApply AS BG2SYMBOLAPPLY, \n\tBG2SYMBOLPREFIX, \n\to_BG2TrailerAutoHomesMS AS BG2TRAILERAUTOHOMESMS, \n\tBLANKETHIGHESTRATENOTE, \n\tBUILDINGMATERIALSSUPPLIESOFOTHERSPREMIUMBLDRK, \n\tBURGLARALARM, \n\tBURGLARALARMEXTENTOFPROTECTION, \n\tBURGLARALARMGRADE, \n\tCAUSEOFLOSS, \n\tCLASSLIMIT, \n\tCOINSURANCEPERCENTAGE, \n\tCOINSURANCEPERCENTAGEGROUPRATED, \n\tCOINSURANCEREQUIREMENT, \n\tCOINSURANCEVALUEREPORTING, \n\tCOLLAPSEBLDRK, \n\tCOMMUNICATIONSUPPLY, \n\to_ComputerFailure AS COMPUTERFAILURE, \n\tCONTENTTYPE, \n\tCSP, \n\to_EarthquakeSelect AS EARTHQUAKESELECT, \n\to_EligibleForDeductibleInsurancePlan AS ELIGIBLEFORDEDUCTIBLEINSURANCEPLAN, \n\to_ExteriorWallsOfClayMS AS EXTERIORWALLSOFCLAYMS, \n\to_IncidentalApartment AS INCIDENTALAPARTMENT, \n\to_LimitedSprinklerExposure AS LIMITEDSPRINKLEREXPOSURE, \n\to_NonSprinkleredBuilding AS NONSPRINKLEREDBUILDING, \n\tOCCUPANCYTYPE, \n\tOTHERCAUSEOFLOSSRISKTYPE, \n\tOTHERPREMRATINGGROUP, \n\tOTHERPROTECTIVEDEVICEFACTOR, \n\to_OtherProtectiveDevices AS OTHERPROTECTIVEDEVICES, \n\tPOWERSUPPLY, \n\tPROVIDERTYPE, \n\to_PublicPropertySelect AS PUBLICPROPERTYSELECT, \n\to_RenovationsBLDRK AS RENOVATIONSBLDRK, \n\to_ReportingFormBLDRK AS REPORTINGFORMBLDRK, \n\tSPECIALIZEDUSE, \n\to_SprinkleredBuilding AS SPRINKLEREDBUILDING, \n\tSPRINKLERPERCENTAGE, \n\to_StateOwnedPropCredit AS STATEOWNEDPROPCREDIT, \n\tSUBCONTRACTORS, \n\to_TenantsImprovementsBetterments AS TENANTSIMPROVEMENTSBETTERMENTS, \n\to_TheftOfBuildingMaterialsBLDRK AS THEFTOFBUILDINGMATERIALSBLDRK, \n\tUNITNUMBER, \n\tVALUATION, \n\tWATCHMANPROTECTION, \n\to_WaterSupply AS WATERSUPPLY, \n\to_WindstormProtectiveDevices AS WINDSTORMPROTECTIVEDEVICES, \n\tYARDCONSTRUCTION, \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}