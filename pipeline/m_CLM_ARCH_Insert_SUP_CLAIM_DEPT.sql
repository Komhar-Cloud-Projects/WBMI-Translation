WITH
SQ_SUP_CLAIM_DEPT_STAGE AS (
	SELECT
		SUP_CLAIM_DEPT_ID,
		DEPT_CODE,
		DIVISION_CODE,
		DEPT_DESC,
		EXTRACT_DATE,
		AS_OF_DATE,
		RECORD_COUNT,
		SOURCE_SYSTEM_ID
	FROM SUP_CLAIM_DEPT_STAGE
),
EXP_SUP_CLAIM_DEPT_STAGE AS (
	SELECT
	SUP_CLAIM_DEPT_ID,
	DEPT_CODE,
	DIVISION_CODE,
	DEPT_DESC,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_SUP_CLAIM_DEPT_STAGE
),
ARCH_SUP_CLAIM_DEPT_STAGE AS (
	INSERT INTO ARCH_SUP_CLAIM_DEPT_STAGE
	(SUP_CLAIM_DEPT_ID, DEPT_CODE, DIVISION_CODE, DEPT_DESC, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)
	SELECT 
	SUP_CLAIM_DEPT_ID, 
	DEPT_CODE, 
	DIVISION_CODE, 
	DEPT_DESC, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_SUP_CLAIM_DEPT_STAGE
),