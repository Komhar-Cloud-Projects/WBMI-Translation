{
    "name": "s_m_POL_STG_Insert_ArchPif43NXBPStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_ArchPif43NXBPStage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif43NXBPStage AS (\n\tSELECT\n\t\tPif43NXBPStageId,\n\t\tExtractDate,\n\t\tSourceSystemid AS SourceSystemId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifPolicyModule,\n\t\tPMDNXB1SegmentID,\n\t\tPMDNXB1SegmentStatus,\n\t\tPMDNXB1YearTransaction,\n\t\tPMDNXB1MonthTransaction,\n\t\tPMDNXB1DayTransaction,\n\t\tPMDNXB1SegmentLevelCode,\n\t\tPMDNXB1SegmentPartCode,\n\t\tPMDNXB1SubPartCode,\n\t\tPMDNXB1InsuranceLine,\n\t\tPMDNXB1LocationNumber,\n\t\tPMDNXB1SubLocationNumber,\n\t\tPMDNXB1YearItemEffective,\n\t\tPMDNXB1MonthItemEffective,\n\t\tPMDNXB1DayItemEffective,\n\t\tPMDNXB1YearProcess,\n\t\tPMDNXB1MonthProcess,\n\t\tPMDNXB1DayProcess,\n\t\tPMDNXB1TexasIndicator,\n\t\tPMDNXB1CompanyNumber,\n\t\tPMDNXB1StateCode,\n\t\tPMDNXB1TerritoryCode,\n\t\tPMDNXB1BuildingClassCode,\n\t\tPMDNXB1PropertyClassCode,\n\t\tPMDNXB1BuildingDescriptionIndicator,\n\t\tPMDNXB1PropertyDescriptionIndicator,\n\t\tPMDNXB1BuildingRateNumber,\n\t\tPMDNXB1PropertyRateNumber,\n\t\tPMDNXB1TypeForm,\n\t\tPMDNXB1OccupancyType,\n\t\tPMDNXB1BuildingActiveCash,\n\t\tPMDNXB1ConstructionType,\n\t\tPMDNXB1RiskType,\n\t\tPMDNXB1RatingId,\n\t\tPMDNXB1ProtectionClass,\n\t\tPMDNXB1PropertyRateGroup,\n\t\tPMDNXB1BuildingAutoIncrement,\n\t\tPMDNXB1LiabilityLimit,\n\t\tPMDNXB1FireLegalLimit,\n\t\tPMDNXB1DrugLiability,\n\t\tPMDNXB1IndividualRiskModifier,\n\t\tPMDNXB1TotalOperationsPremium,\n\t\tPMDNXB1FinalBusinessPremium,\n\t\tPMDNXB1LocationCounter,\n\t\tPMDNXB1DECChangeFlag,\n\t\tPMDNXB1SpoilageClassGroup,\n\t\tPMDNXB1AttorneysFees,\n\t\tPMDNXB1CommissionReduction,\n\t\tPMDNXB1DeletedPropertyRateGroup,\n\t\tPMDNXB1DeletedBuildingRateNumber,\n\t\tPMDNXB1DeletedPropertyRateNumber,\n\t\tPMDNXB1DeletedBuildingClassCode,\n\t\tPMDNXB1DeletedPropertyClassCode,\n\t\tPMDNXB1LocationDeletedSwitch,\n\t\tPMDNXB1FutureUse,\n\t\tPMDNXB1MedicalPayLimit,\n\t\tPMDNXB1ProductCompletedOperationsAggregrateLimit,\n\t\tPMDNXB1PackageModificationAdjustmentCode,\n\t\tPMDNXB1PackageModificationAdjustmentFactor,\n\t\tPMDNXB1OtherFactor,\n\t\tPMDNXB1AggregateLimit,\n\t\tPMDNXB1PersonalAdvertisingLimit,\n\t\tPMDNXB1WholeSalersIndicator,\n\t\tPMDNXB1DeletedTypeForm,\n\t\tPMDNXB1DragSwitch,\n\t\tPMDNXB1YearBuilt,\n\t\tPMDNXB1NumberOfApartments,\n\t\tPMDNXB1Extinguisher,\n\t\tPMDNXB1PropertyLiability,\n\t\tPMDNXB1CustomerUsage,\n\t\tPMDNXB1Year2000CustomerUse\n\tFROM Pif43NXBPStage\n),\nEXP_MetaData AS (\n\tSELECT\n\tPif43NXBPStageId,\n\tExtractDate,\n\tSourceSystemId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifPolicyModule,\n\tPMDNXB1SegmentID,\n\tPMDNXB1SegmentStatus,\n\tPMDNXB1YearTransaction,\n\tPMDNXB1MonthTransaction,\n\tPMDNXB1DayTransaction,\n\tPMDNXB1SegmentLevelCode,\n\tPMDNXB1SegmentPartCode,\n\tPMDNXB1SubPartCode,\n\tPMDNXB1InsuranceLine,\n\tPMDNXB1LocationNumber,\n\tPMDNXB1SubLocationNumber,\n\tPMDNXB1YearItemEffective,\n\tPMDNXB1MonthItemEffective,\n\tPMDNXB1DayItemEffective,\n\tPMDNXB1YearProcess,\n\tPMDNXB1MonthProcess,\n\tPMDNXB1DayProcess,\n\tPMDNXB1TexasIndicator,\n\tPMDNXB1CompanyNumber,\n\tPMDNXB1StateCode,\n\tPMDNXB1TerritoryCode,\n\tPMDNXB1BuildingClassCode,\n\tPMDNXB1PropertyClassCode,\n\tPMDNXB1BuildingDescriptionIndicator,\n\tPMDNXB1PropertyDescriptionIndicator,\n\tPMDNXB1BuildingRateNumber,\n\tPMDNXB1PropertyRateNumber,\n\tPMDNXB1TypeForm,\n\tPMDNXB1OccupancyType,\n\tPMDNXB1BuildingActiveCash,\n\tPMDNXB1ConstructionType,\n\tPMDNXB1RiskType,\n\tPMDNXB1RatingId,\n\tPMDNXB1ProtectionClass,\n\tPMDNXB1PropertyRateGroup,\n\tPMDNXB1BuildingAutoIncrement,\n\tPMDNXB1LiabilityLimit,\n\tPMDNXB1FireLegalLimit,\n\tPMDNXB1DrugLiability,\n\tPMDNXB1IndividualRiskModifier,\n\tPMDNXB1TotalOperationsPremium,\n\tPMDNXB1FinalBusinessPremium,\n\tPMDNXB1LocationCounter,\n\tPMDNXB1DECChangeFlag,\n\tPMDNXB1SpoilageClassGroup,\n\tPMDNXB1AttorneysFees,\n\tPMDNXB1CommissionReduction,\n\tPMDNXB1DeletedPropertyRateGroup,\n\tPMDNXB1DeletedBuildingRateNumber,\n\tPMDNXB1DeletedPropertyRateNumber,\n\tPMDNXB1DeletedBuildingClassCode,\n\tPMDNXB1DeletedPropertyClassCode,\n\tPMDNXB1LocationDeletedSwitch,\n\tPMDNXB1FutureUse,\n\tPMDNXB1MedicalPayLimit,\n\tPMDNXB1ProductCompletedOperationsAggregrateLimit,\n\tPMDNXB1PackageModificationAdjustmentCode,\n\tPMDNXB1PackageModificationAdjustmentFactor,\n\tPMDNXB1OtherFactor,\n\tPMDNXB1AggregateLimit,\n\tPMDNXB1PersonalAdvertisingLimit,\n\tPMDNXB1WholeSalersIndicator,\n\tPMDNXB1DeletedTypeForm,\n\tPMDNXB1DragSwitch,\n\tPMDNXB1YearBuilt,\n\tPMDNXB1NumberOfApartments,\n\tPMDNXB1Extinguisher,\n\tPMDNXB1PropertyLiability,\n\tPMDNXB1CustomerUsage,\n\tPMDNXB1Year2000CustomerUse,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditID\n\tFROM SQ_Pif43NXBPStage\n),\nArchPif43NXBPStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43NXBPStage\n\t(ExtractDate, SourceSystemId, AuditId, Pif43NXBPStageId, PifSymbol, PifPolicyNumber, PifPolicyModule, PMDNXB1SegmentID, PMDNXB1SegmentStatus, PMDNXB1YearTransaction, PMDNXB1MonthTransaction, PMDNXB1DayTransaction, PMDNXB1SegmentLevelCode, PMDNXB1SegmentPartCode, PMDNXB1SubPartCode, PMDNXB1InsuranceLine, PMDNXB1LocationNumber, PMDNXB1SubLocationNumber, PMDNXB1YearItemEffective, PMDNXB1MonthItemEffective, PMDNXB1DayItemEffective, PMDNXB1YearProcess, PMDNXB1MonthProcess, PMDNXB1DayProcess, PMDNXB1TexasIndicator, PMDNXB1CompanyNumber, PMDNXB1StateCode, PMDNXB1TerritoryCode, PMDNXB1BuildingClassCode, PMDNXB1PropertyClassCode, PMDNXB1BuildingDescriptionIndicator, PMDNXB1PropertyDescriptionIndicator, PMDNXB1BuildingRateNumber, PMDNXB1PropertyRateNumber, PMDNXB1TypeForm, PMDNXB1OccupancyType, PMDNXB1BuildingActiveCash, PMDNXB1ConstructionType, PMDNXB1RiskType, PMDNXB1RatingId, PMDNXB1ProtectionClass, PMDNXB1PropertyRateGroup, PMDNXB1BuildingAutoIncrement, PMDNXB1LiabilityLimit, PMDNXB1FireLegalLimit, PMDNXB1DrugLiability, PMDNXB1IndividualRiskModifier, PMDNXB1TotalOperationsPremium, PMDNXB1FinalBusinessPremium, PMDNXB1LocationCounter, PMDNXB1DECChangeFlag, PMDNXB1SpoilageClassGroup, PMDNXB1AttorneysFees, PMDNXB1CommissionReduction, PMDNXB1DeletedPropertyRateGroup, PMDNXB1DeletedBuildingRateNumber, PMDNXB1DeletedPropertyRateNumber, PMDNXB1DeletedBuildingClassCode, PMDNXB1DeletedPropertyClassCode, PMDNXB1LocationDeletedSwitch, PMDNXB1FutureUse, PMDNXB1MedicalPayLimit, PMDNXB1ProductCompletedOperationsAggregrateLimit, PMDNXB1PackageModificationAdjustmentCode, PMDNXB1PackageModificationAdjustmentFactor, PMDNXB1OtherFactor, PMDNXB1AggregateLimit, PMDNXB1PersonalAdvertisingLimit, PMDNXB1WholeSalersIndicator, PMDNXB1DeletedTypeForm, PMDNXB1DragSwitch, PMDNXB1YearBuilt, PMDNXB1NumberOfApartments, PMDNXB1Extinguisher, PMDNXB1PropertyLiability, PMDNXB1CustomerUsage, PMDNXB1Year2000CustomerUse)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditID AS AUDITID, \n\tPIF43NXBPSTAGEID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFPOLICYMODULE, \n\tPMDNXB1SEGMENTID, \n\tPMDNXB1SEGMENTSTATUS, \n\tPMDNXB1YEARTRANSACTION, \n\tPMDNXB1MONTHTRANSACTION, \n\tPMDNXB1DAYTRANSACTION, \n\tPMDNXB1SEGMENTLEVELCODE, \n\tPMDNXB1SEGMENTPARTCODE, \n\tPMDNXB1SUBPARTCODE, \n\tPMDNXB1INSURANCELINE, \n\tPMDNXB1LOCATIONNUMBER, \n\tPMDNXB1SUBLOCATIONNUMBER, \n\tPMDNXB1YEARITEMEFFECTIVE, \n\tPMDNXB1MONTHITEMEFFECTIVE, \n\tPMDNXB1DAYITEMEFFECTIVE, \n\tPMDNXB1YEARPROCESS, \n\tPMDNXB1MONTHPROCESS, \n\tPMDNXB1DAYPROCESS, \n\tPMDNXB1TEXASINDICATOR, \n\tPMDNXB1COMPANYNUMBER, \n\tPMDNXB1STATECODE, \n\tPMDNXB1TERRITORYCODE, \n\tPMDNXB1BUILDINGCLASSCODE, \n\tPMDNXB1PROPERTYCLASSCODE, \n\tPMDNXB1BUILDINGDESCRIPTIONINDICATOR, \n\tPMDNXB1PROPERTYDESCRIPTIONINDICATOR, \n\tPMDNXB1BUILDINGRATENUMBER, \n\tPMDNXB1PROPERTYRATENUMBER, \n\tPMDNXB1TYPEFORM, \n\tPMDNXB1OCCUPANCYTYPE, \n\tPMDNXB1BUILDINGACTIVECASH, \n\tPMDNXB1CONSTRUCTIONTYPE, \n\tPMDNXB1RISKTYPE, \n\tPMDNXB1RATINGID, \n\tPMDNXB1PROTECTIONCLASS, \n\tPMDNXB1PROPERTYRATEGROUP, \n\tPMDNXB1BUILDINGAUTOINCREMENT, \n\tPMDNXB1LIABILITYLIMIT, \n\tPMDNXB1FIRELEGALLIMIT, \n\tPMDNXB1DRUGLIABILITY, \n\tPMDNXB1INDIVIDUALRISKMODIFIER, \n\tPMDNXB1TOTALOPERATIONSPREMIUM, \n\tPMDNXB1FINALBUSINESSPREMIUM, \n\tPMDNXB1LOCATIONCOUNTER, \n\tPMDNXB1DECCHANGEFLAG, \n\tPMDNXB1SPOILAGECLASSGROUP, \n\tPMDNXB1ATTORNEYSFEES, \n\tPMDNXB1COMMISSIONREDUCTION, \n\tPMDNXB1DELETEDPROPERTYRATEGROUP, \n\tPMDNXB1DELETEDBUILDINGRATENUMBER, \n\tPMDNXB1DELETEDPROPERTYRATENUMBER, \n\tPMDNXB1DELETEDBUILDINGCLASSCODE, \n\tPMDNXB1DELETEDPROPERTYCLASSCODE, \n\tPMDNXB1LOCATIONDELETEDSWITCH, \n\tPMDNXB1FUTUREUSE, \n\tPMDNXB1MEDICALPAYLIMIT, \n\tPMDNXB1PRODUCTCOMPLETEDOPERATIONSAGGREGRATELIMIT, \n\tPMDNXB1PACKAGEMODIFICATIONADJUSTMENTCODE, \n\tPMDNXB1PACKAGEMODIFICATIONADJUSTMENTFACTOR, \n\tPMDNXB1OTHERFACTOR, \n\tPMDNXB1AGGREGATELIMIT, \n\tPMDNXB1PERSONALADVERTISINGLIMIT, \n\tPMDNXB1WHOLESALERSINDICATOR, \n\tPMDNXB1DELETEDTYPEFORM, \n\tPMDNXB1DRAGSWITCH, \n\tPMDNXB1YEARBUILT, \n\tPMDNXB1NUMBEROFAPARTMENTS, \n\tPMDNXB1EXTINGUISHER, \n\tPMDNXB1PROPERTYLIABILITY, \n\tPMDNXB1CUSTOMERUSAGE, \n\tPMDNXB1YEAR2000CUSTOMERUSE\n\tFROM EXP_MetaData\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}