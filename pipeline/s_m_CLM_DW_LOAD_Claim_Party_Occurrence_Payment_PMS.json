{
    "name": "s_m_CLM_DW_LOAD_Claim_Party_Occurrence_Payment_PMS",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DW_LOAD_Claim_Party_Occurrence_Payment_PMS",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_CLAIM_OCCURRENCE AS (\n\tSELECT\n\tclaim_occurrence_ak_id,\n\tclaim_occurrence_key\n\tFROM (\n\t\tSELECT \r\n\t\t   claim_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, \r\n\t\t   claim_occurrence.claim_occurrence_key as claim_occurrence_key \r\n\t\tFROM \r\n\t\t   claim_occurrence\r\n\t\tWHERE\r\n\t\t   source_sys_id = '@{pipeline().parameters.SOURCE_SYS_ID}' AND crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_key ORDER BY claim_occurrence_ak_id) = 1\n),\nLKP_CLAIM_PARTY_OCCURRENCE AS (\n\tSELECT\n\tclaim_party_occurrence_ak_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_ak_id,\n\tclaim_party_role_code\n\tFROM (\n\t\tSELECT claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_party_ak_id as claim_party_ak_id, LTRIM(RTRIM(claim_party_occurrence.claim_party_role_code)) as claim_party_role_code FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_party_occurrence  \r\n\t\tWHERE     (source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}')  AND (CRRNT_SNPSHT_FLAG='1')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,claim_party_ak_id,claim_party_role_code ORDER BY claim_party_occurrence_ak_id) = 1\n),\nLKP_CLAIMANT_DETAIL_COVERAGE AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tclaim_party_occurrence_ak_id,\n\tloc_unit_num,\n\tsub_loc_unit_num,\n\tins_line,\n\trisk_unit_grp,\n\trisk_unit_grp_seq_num,\n\trisk_unit,\n\trisk_unit_seq_num,\n\tmajor_peril_code,\n\tmajor_peril_seq,\n\tpms_loss_disability,\n\treserve_ctgry,\n\tcause_of_loss,\n\tpms_mbr,\n\tpms_type_exposure\n\tFROM (\n\t\tSELECT claimant_coverage_detail.claimant_cov_det_ak_id as claimant_cov_det_ak_id, claimant_coverage_detail.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, convert(decimal,LTRIM(RTRIM(claimant_coverage_detail.loc_unit_num))) as loc_unit_num, convert(decimal,LTRIM(RTRIM(claimant_coverage_detail.sub_loc_unit_num))) as sub_loc_unit_num, claimant_coverage_detail.ins_line as ins_line, LTRIM(RTRIM(claimant_coverage_detail.risk_unit_grp)) as risk_unit_grp, LTRIM(RTRIM(claimant_coverage_detail.risk_unit_grp_seq_num)) as risk_unit_grp_seq_num, LTRIM(RTRIM(claimant_coverage_detail.risk_unit)) as risk_unit, CONVERT(DECIMAL,claimant_coverage_detail.risk_unit_seq_num) as risk_unit_seq_num, LTRIM(RTRIM(claimant_coverage_detail.major_peril_code)) as major_peril_code, claimant_coverage_detail.major_peril_seq as major_peril_seq, claimant_coverage_detail.pms_loss_disability as pms_loss_disability, claimant_coverage_detail.reserve_ctgry as reserve_ctgry, claimant_coverage_detail.cause_of_loss as cause_of_loss, claimant_coverage_detail.pms_mbr as pms_mbr, claimant_coverage_detail.pms_type_exposure as pms_type_exposure FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_detail\r\n\t\t  WHERE     (source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}')  AND (CRRNT_SNPSHT_FLAG='1')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,loc_unit_num,sub_loc_unit_num,ins_line,risk_unit_grp,risk_unit_grp_seq_num,risk_unit,risk_unit_seq_num,major_peril_code,major_peril_seq,pms_loss_disability,reserve_ctgry,cause_of_loss,pms_mbr,pms_type_exposure ORDER BY claimant_cov_det_ak_id) = 1\n),\nLKP_CLAIM_PARTY AS (\n\tSELECT\n\tclaim_party_ak_id,\n\tclaim_party_key\n\tFROM (\n\t\tSELECT \r\n\t\t   claim_party.claim_party_ak_id as claim_party_ak_id, \r\n\t\t   claim_party.claim_party_key as claim_party_key \r\n\t\tFROM \r\n\t\t   claim_party\r\n\t\tWHERE \r\n\t\t   source_sys_id = 'PMS' AND crrnt_snpsht_flag = '1'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_key ORDER BY claim_party_ak_id) = 1\n),\nLKP_PMS_Adjustor AS (\n\tSELECT\n\tadnm_type_adjustor,\n\tin_Claim_Adjustor_Nbr,\n\tadnm_adjustor_nbr\n\tFROM (\n\t\tSELECT \n\t\t\tadnm_type_adjustor,\n\t\t\tin_Claim_Adjustor_Nbr,\n\t\t\tadnm_adjustor_nbr\n\t\tFROM pms_adjuster_master_stage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY adnm_adjustor_nbr ORDER BY adnm_type_adjustor) = 1\n),\nSQ_pifmstr_PIF_4578_stage AS (\n\tSELECT LTRIM(RTRIM(pif_4578_stage.pif_symbol)), \r\n\tLTRIM(RTRIM(pif_4578_stage.pif_policy_number)), \r\n\tLTRIM(RTRIM(pif_4578_stage.pif_module)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_insurance_line)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_location_number)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_sub_location_number)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_risk_unit_group)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_class_code_group)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_class_code_member)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_unit)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_sequence_risk_unit)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_type_exposure)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_major_peril)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_major_peril_seq)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_year)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_month)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_day)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_occurence)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_claimant)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_member)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_disability)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_reserve_category)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_entry_operator)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_cause)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_adjustor_no)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_bank_number)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_amount)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_no)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_check_ind)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_transaction_date)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_pay_to_1)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_pay_to_2)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_pay_to_3)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_draft_mail_to)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_payee_phrase)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_memo_phrase)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_1099_number)), \r\n\tLTRIM(RTRIM(pif_4578_stage.loss_claim_payee_name)), \r\n\tLTRIM(RTRIM(pif_4578_stage.source_system_id)) \r\n\tFROM\r\n\t pif_4578_stage \r\n\tWHERE\r\n\t (pif_4578_stage.loss_part = '7') AND \r\n\t(pif_4578_stage.logical_flag ='0')\r\n\tAND LEN(LTRIM(RTRIM(pif_4578_stage.loss_draft_no))) > 0\n),\nEXP_CLAIM_TRANSACTION_VALIDATE AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tloss_insurance_line,\n\t-- *INF*: IIF(ISNULL(loss_insurance_line) OR LENGTH(LTRIM(RTRIM(loss_insurance_line))) = 0, 'N/A', LTRIM(RTRIM(loss_insurance_line)))\n\tIFF(\n\t    loss_insurance_line IS NULL OR LENGTH(LTRIM(RTRIM(loss_insurance_line))) = 0, 'N/A',\n\t    LTRIM(RTRIM(loss_insurance_line))\n\t) AS v_loss_insurance_line,\n\tloss_location_number,\n\t-- *INF*: IIF(ISNULL(loss_location_number), '0', to_char(loss_location_number))\n\tIFF(loss_location_number IS NULL, '0', to_char(loss_location_number)) AS v_loss_location_number,\n\tloss_sub_location_number,\n\t-- *INF*: IIF(ISNULL(loss_sub_location_number), '0', to_char(loss_sub_location_number))\n\tIFF(loss_sub_location_number IS NULL, '0', to_char(loss_sub_location_number)) AS v_loss_sub_location_number,\n\tloss_risk_unit_group,\n\t-- *INF*: IIF(ISNULL(loss_risk_unit_group) OR LENGTH(LTRIM(RTRIM(loss_risk_unit_group))) = 0, 'N/A', LTRIM(RTRIM(loss_risk_unit_group)))\n\tIFF(\n\t    loss_risk_unit_group IS NULL OR LENGTH(LTRIM(RTRIM(loss_risk_unit_group))) = 0, 'N/A',\n\t    LTRIM(RTRIM(loss_risk_unit_group))\n\t) AS v_loss_risk_unit_group,\n\tloss_class_code_group,\n\tloss_class_code_member,\n\tloss_unit,\n\t-- *INF*: IIF(ISNULL(loss_unit) OR LENGTH(LTRIM(RTRIM(loss_unit))) = 0, 'N/A', LTRIM(RTRIM(loss_unit)))\n\tIFF(\n\t    loss_unit IS NULL OR LENGTH(LTRIM(RTRIM(loss_unit))) = 0, 'N/A', LTRIM(RTRIM(loss_unit))\n\t) AS v_loss_unit,\n\tloss_sequence_risk_unit,\n\t-- *INF*: IIF(TO_DECIMAL(loss_sequence_risk_unit) = 0 OR ISNULL(LTRIM(RTRIM(loss_sequence_risk_unit))), '0',\r\n\t-- to_char(TO_DECIMAL(loss_sequence_risk_unit)) )\n\tIFF(\n\t    CAST(loss_sequence_risk_unit AS FLOAT) = 0 OR LTRIM(RTRIM(loss_sequence_risk_unit)) IS NULL,\n\t    '0',\n\t    to_char(CAST(loss_sequence_risk_unit AS FLOAT))\n\t) AS v_loss_sequence_risk_unit,\n\tloss_type_exposure,\n\t-- *INF*: IIF(ISNULL(loss_type_exposure) OR LENGTH(LTRIM(RTRIM(loss_type_exposure))) = 0, 'N/A', LTRIM(RTRIM(loss_type_exposure)))\n\tIFF(\n\t    loss_type_exposure IS NULL OR LENGTH(LTRIM(RTRIM(loss_type_exposure))) = 0, 'N/A',\n\t    LTRIM(RTRIM(loss_type_exposure))\n\t) AS v_loss_type_exposure,\n\tloss_major_peril,\n\t-- *INF*: IIF(ISNULL(loss_major_peril) OR LENGTH(LTRIM(RTRIM(loss_major_peril))) = 0, 'N/A', LTRIM(RTRIM(loss_major_peril)))\n\tIFF(\n\t    loss_major_peril IS NULL OR LENGTH(LTRIM(RTRIM(loss_major_peril))) = 0, 'N/A',\n\t    LTRIM(RTRIM(loss_major_peril))\n\t) AS v_loss_major_peril,\n\tloss_major_peril_seq,\n\t-- *INF*: IIF(ISNULL(loss_major_peril_seq) OR LENGTH(LTRIM(RTRIM(loss_major_peril_seq))) = 0, 'N/A', LTRIM(RTRIM(loss_major_peril_seq)))\n\tIFF(\n\t    loss_major_peril_seq IS NULL OR LENGTH(LTRIM(RTRIM(loss_major_peril_seq))) = 0, 'N/A',\n\t    LTRIM(RTRIM(loss_major_peril_seq))\n\t) AS v_loss_major_peril_seq,\n\t-- *INF*: IIF(ISNULL(TO_CHAR(loss_class_code_group)||TO_CHAR(loss_class_code_member)) ,'N/A',TO_CHAR(loss_class_code_group)||TO_CHAR(loss_class_code_member))\n\tIFF(\n\t    TO_CHAR(loss_class_code_group) || TO_CHAR(loss_class_code_member) IS NULL, 'N/A',\n\t    TO_CHAR(loss_class_code_group) || TO_CHAR(loss_class_code_member)\n\t) AS V_risk_unit_grp_seq_num_1,\n\t-- *INF*: LPAD(V_risk_unit_grp_seq_num_1,3,'0')\n\tLPAD(V_risk_unit_grp_seq_num_1, 3, '0') AS V_risk_unit_grp_seq_num,\n\tloss_year,\n\tloss_month,\n\tloss_day,\n\t-- *INF*: TO_CHAR(loss_year)\n\tTO_CHAR(loss_year) AS V_loss_year,\n\t-- *INF*: to_char(loss_month)\n\tto_char(loss_month) AS V_loss_month,\n\t-- *INF*: to_char(loss_day)\n\tto_char(loss_day) AS V_loss_day,\n\t-- *INF*: IIF ( LENGTH(V_loss_month) = 1, '0' || V_loss_month, V_loss_month)\r\n\t-- ||  \r\n\t-- IIF ( LENGTH(V_loss_day ) = 1, '0' || V_loss_day, V_loss_day )\r\n\t-- ||  \r\n\t-- V_loss_year\n\tIFF(LENGTH(V_loss_month) = 1, '0' || V_loss_month, V_loss_month) || IFF(LENGTH(V_loss_day) = 1, '0' || V_loss_day, V_loss_day) || V_loss_year AS v_loss_date,\n\tloss_occurence,\n\tpif_symbol || pif_policy_number || pif_module || v_loss_date || loss_occurence AS v_loss_occurence_key,\n\tloss_claimant,\n\t-- *INF*: :LKP.LKP_PMS_ADJUSTOR(IN_loss_adjustor_no)\r\n\t-- \r\n\t-- --'CMT'\n\tLKP_PMS_ADJUSTOR_IN_loss_adjustor_no.adnm_type_adjustor AS v_party_role_code_payee,\n\tv_party_role_code_payee AS o_party_role_code_payee,\n\t'CMT' AS v_party_role_code_claimant,\n\tIN_loss_adjustor_no || v_party_role_code_payee AS v_loss_party_key_payee,\n\t-- *INF*: v_loss_occurence_key||TO_CHAR(loss_claimant)||v_party_role_code_claimant\n\tv_loss_occurence_key || TO_CHAR(loss_claimant) || v_party_role_code_claimant AS v_loss_party_key_claimant,\n\tloss_member,\n\t-- *INF*: IIF(ISNULL(loss_member) OR LENGTH(LTRIM(RTRIM(loss_member))) = 0, 'N/A', loss_member)\n\tIFF(loss_member IS NULL OR LENGTH(LTRIM(RTRIM(loss_member))) = 0, 'N/A', loss_member) AS v_loss_member,\n\tloss_disability,\n\t-- *INF*: IIF(ISNULL(loss_disability) OR LENGTH(LTRIM(RTRIM(loss_disability))) = 0, 'N/A', loss_disability)\n\tIFF(\n\t    loss_disability IS NULL OR LENGTH(LTRIM(RTRIM(loss_disability))) = 0, 'N/A', loss_disability\n\t) AS v_loss_disability,\n\tloss_reserve_category,\n\t-- *INF*: IIF(ISNULL(loss_reserve_category) OR LENGTH(LTRIM(RTRIM(loss_reserve_category))) = 0, 'N/A', loss_reserve_category)\n\tIFF(\n\t    loss_reserve_category IS NULL OR LENGTH(LTRIM(RTRIM(loss_reserve_category))) = 0, 'N/A',\n\t    loss_reserve_category\n\t) AS v_loss_reserve_category,\n\tloss_cause,\n\t-- *INF*: decode(true,\r\n\t-- ISNULL(loss_cause), 'N/A',\r\n\t-- LENGTH(LTRIM(RTRIM(loss_cause))) = 0, 'N/A',\r\n\t-- (v_loss_major_peril = '032' AND loss_cause = '07'), '06',\r\n\t-- LTRIM(RTRIM(loss_cause)))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(loss_cause) OR LENGTH(LTRIM(RTRIM(loss_cause))) = 0, 'N/A',loss_cause)\n\tdecode(\n\t    true,\n\t    loss_cause IS NULL, 'N/A',\n\t    LENGTH(LTRIM(RTRIM(loss_cause))) = 0, 'N/A',\n\t    (v_loss_major_peril = '032' AND loss_cause = '07'), '06',\n\t    LTRIM(RTRIM(loss_cause))\n\t) AS v_loss_cause,\n\t-- *INF*: :LKP.LKP_CLAIM_OCCURRENCE(v_loss_occurence_key)\r\n\t-- \r\n\t-- --:LKP.LKPTRANS(v_loss_occurence_key)\n\tLKP_CLAIM_OCCURRENCE_v_loss_occurence_key.claim_occurrence_ak_id AS v_claim_occurence_ak_id,\n\t-- *INF*: :LKP.LKP_CLAIM_PARTY(v_loss_party_key_payee)\n\tLKP_CLAIM_PARTY_v_loss_party_key_payee.claim_party_ak_id AS v_claim_party_ak_id_payee,\n\t-- *INF*: :LKP.LKP_CLAIM_PARTY_OCCURRENCE(v_claim_occurence_ak_id,v_claim_party_ak_id_payee,v_party_role_code_payee)\n\tLKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_payee_v_party_role_code_payee.claim_party_occurrence_ak_id AS v_claim_party_occurence_ak_id_payee,\n\tv_claim_party_occurence_ak_id_payee AS o_claim_party_occurence_ak_id_payee,\n\t-- *INF*: :LKP.LKP_CLAIM_PARTY(v_loss_party_key_claimant)\n\tLKP_CLAIM_PARTY_v_loss_party_key_claimant.claim_party_ak_id AS v_claim_party_ak_id_claimant,\n\t-- *INF*: :LKP.LKP_CLAIM_PARTY_OCCURRENCE(v_claim_occurence_ak_id,v_claim_party_ak_id_claimant,v_party_role_code_claimant)\n\tLKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_claimant_v_party_role_code_claimant.claim_party_occurrence_ak_id AS v_claim_party_occurence_ak_id_claimant,\n\t-- *INF*: :LKP.LKP_CLAIMANT_DETAIL_COVERAGE(v_claim_party_occurence_ak_id_claimant, v_loss_location_number, v_loss_sub_location_number,  v_loss_insurance_line, v_loss_risk_unit_group, V_risk_unit_grp_seq_num ,v_loss_unit, v_loss_sequence_risk_unit, v_loss_major_peril, v_loss_major_peril_seq, v_loss_disability, v_loss_reserve_category, v_loss_cause, v_loss_member, v_loss_type_exposure)\n\tLKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.claimant_cov_det_ak_id AS v_claimant_coverage_detail_ak_id,\n\tv_claimant_coverage_detail_ak_id AS claimant_coverage_detail_ak_id,\n\tloss_entry_operator AS IN_LOSS_ENTRY_OPERATOR,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))) = 0, 'N/A', IN_LOSS_ENTRY_OPERATOR)\r\n\t-- \r\n\t-- --IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))),'N/A',IIF(IS_SPACES(IN_LOSS_ENTRY_OPERATOR),'N/A',LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_ENTRY_OPERATOR))) = 0,\n\t    'N/A',\n\t    IN_LOSS_ENTRY_OPERATOR\n\t) AS LOSS_ENTRY_OPERATOR,\n\tloss_bank_number AS IN_LOSS_BANK_NUMBER,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_BANK_NUMBER)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_BANK_NUMBER)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_BANK_NUMBER))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_BANK_NUMBER))\n\t) AS LOSS_BANK_NUMBER,\n\tloss_draft_amount AS IN_LOSS_DRAFT_AMOUNT,\n\t-- *INF*: IIF(ISNULL(IN_LOSS_DRAFT_AMOUNT),0,IN_LOSS_DRAFT_AMOUNT)\n\tIFF(IN_LOSS_DRAFT_AMOUNT IS NULL, 0, IN_LOSS_DRAFT_AMOUNT) AS LOSS_DRAFT_AMOUNT,\n\tloss_draft_no AS IN_LOSS_DRAFT_NO,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_DRAFT_NO))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_DRAFT_NO))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_NO))) = 0, 'N/A', LTRIM(RTRIM(IN_LOSS_DRAFT_NO)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_NO)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_NO)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_DRAFT_NO)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_NO))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_NO))\n\t) AS LOSS_DRAFT_NO,\n\tloss_draft_check_ind AS IN_LOSS_DRAFT_CHECK_IND,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_CHECK_IND))\n\t) AS LOSS_DRAFT_CHECK_IND,\n\tloss_transaction_date AS IN_LOSS_TRANSACTION_DATE,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_TRANSACTION_DATE))),TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'),to_date(LTRIM(RTRIM(IN_LOSS_TRANSACTION_DATE)),'YYYYMMDD'))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_TRANSACTION_DATE)) IS NULL,\n\t    TO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS'),\n\t    TO_TIMESTAMP(LTRIM(RTRIM(IN_LOSS_TRANSACTION_DATE)), 'YYYYMMDD')\n\t) AS LOSS_TRANSACTION_DATE,\n\tloss_draft_pay_to_1 AS IN_LOSS_DRAFT_PAY_TO_1,\n\tloss_draft_pay_to_2 AS IN_LOSS_DRAFT_PAY_TO_2,\n\tloss_draft_pay_to_3 AS IN_LOSS_DRAFT_PAY_TO_3,\n\tIN_LOSS_DRAFT_PAY_TO_1||IN_LOSS_DRAFT_PAY_TO_2||IN_LOSS_DRAFT_PAY_TO_3 AS v_pay_to_code,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(v_pay_to_code))) OR IS_SPACES(LTRIM(RTRIM(v_pay_to_code))) OR LENGTH(LTRIM(RTRIM(v_pay_to_code))) = 0, 'N/A',LTRIM(RTRIM(v_pay_to_code)))\n\tIFF(\n\t    LTRIM(RTRIM(v_pay_to_code)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(v_pay_to_code)))>0\n\t    and TRIM(LTRIM(RTRIM(v_pay_to_code)))=''\n\t    or LENGTH(LTRIM(RTRIM(v_pay_to_code))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(v_pay_to_code))\n\t) AS pay_to_code,\n\tloss_draft_mail_to AS IN_LOSS_DRAFT_MAIL_TO,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_DRAFT_MAIL_TO))\n\t) AS LOSS_DRAFT_MAIL_TO,\n\tloss_payee_phrase AS IN_LOSS_PAYEE_PHRASE,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_PAYEE_PHRASE))\n\t) AS LOSS_PAYEE_PHRASE,\n\tloss_memo_phrase AS IN_LOSS_MEMO_PHRASE,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_MEMO_PHRASE))\n\t) AS LOSS_MEMO_PHRASE,\n\tloss_1099_number AS IN_LOSS_1099_NUMBER,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_1099_NUMBER))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_1099_NUMBER))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_1099_NUMBER))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_1099_NUMBER)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_1099_NUMBER)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_1099_NUMBER)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_1099_NUMBER)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_1099_NUMBER))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_1099_NUMBER))\n\t) AS LOSS_1099_NUMBER,\n\tloss_claim_payee_name AS IN_LOSS_CLAIM_PAYEE_NAME,\n\t-- *INF*: IIF(ISNULL(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME))) OR IS_SPACES(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME))) OR LENGTH(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME))) = 0, 'N/A',LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME)))\n\tIFF(\n\t    LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME)) IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_LOSS_CLAIM_PAYEE_NAME))\n\t) AS LOSS_CLAIM_PAYEE_NAME,\n\tloss_adjustor_no AS IN_loss_adjustor_no,\n\t-- *INF*: IIF(ISNULL(IN_loss_adjustor_no) OR IS_SPACES(LTRIM(RTRIM(IN_loss_adjustor_no))) OR LENGTH(LTRIM(RTRIM(IN_loss_adjustor_no))) = 0, 'N/A', LTRIM(RTRIM(IN_loss_adjustor_no)))\n\tIFF(\n\t    IN_loss_adjustor_no IS NULL\n\t    or LENGTH(LTRIM(RTRIM(IN_loss_adjustor_no)))>0\n\t    and TRIM(LTRIM(RTRIM(IN_loss_adjustor_no)))=''\n\t    or LENGTH(LTRIM(RTRIM(IN_loss_adjustor_no))) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(IN_loss_adjustor_no))\n\t) AS v_loss_adjustor_no,\n\tv_loss_adjustor_no AS o_loss_adjustor_no,\n\tsource_system_id\n\tFROM SQ_pifmstr_PIF_4578_stage\n\tLEFT JOIN LKP_PMS_ADJUSTOR LKP_PMS_ADJUSTOR_IN_loss_adjustor_no\n\tON LKP_PMS_ADJUSTOR_IN_loss_adjustor_no.adnm_adjustor_nbr = IN_loss_adjustor_no\n\n\tLEFT JOIN LKP_CLAIM_OCCURRENCE LKP_CLAIM_OCCURRENCE_v_loss_occurence_key\n\tON LKP_CLAIM_OCCURRENCE_v_loss_occurence_key.claim_occurrence_key = v_loss_occurence_key\n\n\tLEFT JOIN LKP_CLAIM_PARTY LKP_CLAIM_PARTY_v_loss_party_key_payee\n\tON LKP_CLAIM_PARTY_v_loss_party_key_payee.claim_party_key = v_loss_party_key_payee\n\n\tLEFT JOIN LKP_CLAIM_PARTY_OCCURRENCE LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_payee_v_party_role_code_payee\n\tON LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_payee_v_party_role_code_payee.claim_occurrence_ak_id = v_claim_occurence_ak_id\n\tAND LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_payee_v_party_role_code_payee.claim_party_ak_id = v_claim_party_ak_id_payee\n\tAND LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_payee_v_party_role_code_payee.claim_party_role_code = v_party_role_code_payee\n\n\tLEFT JOIN LKP_CLAIM_PARTY LKP_CLAIM_PARTY_v_loss_party_key_claimant\n\tON LKP_CLAIM_PARTY_v_loss_party_key_claimant.claim_party_key = v_loss_party_key_claimant\n\n\tLEFT JOIN LKP_CLAIM_PARTY_OCCURRENCE LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_claimant_v_party_role_code_claimant\n\tON LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_claimant_v_party_role_code_claimant.claim_occurrence_ak_id = v_claim_occurence_ak_id\n\tAND LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_claimant_v_party_role_code_claimant.claim_party_ak_id = v_claim_party_ak_id_claimant\n\tAND LKP_CLAIM_PARTY_OCCURRENCE_v_claim_occurence_ak_id_v_claim_party_ak_id_claimant_v_party_role_code_claimant.claim_party_role_code = v_party_role_code_claimant\n\n\tLEFT JOIN LKP_CLAIMANT_DETAIL_COVERAGE LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure\n\tON LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.claim_party_occurrence_ak_id = v_claim_party_occurence_ak_id_claimant\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.loc_unit_num = v_loss_location_number\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.sub_loc_unit_num = v_loss_sub_location_number\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.ins_line = v_loss_insurance_line\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.risk_unit_grp = v_loss_risk_unit_group\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.risk_unit_grp_seq_num = V_risk_unit_grp_seq_num\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.risk_unit = v_loss_unit\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.risk_unit_seq_num = v_loss_sequence_risk_unit\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.major_peril_code = v_loss_major_peril\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.major_peril_seq = v_loss_major_peril_seq\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.pms_loss_disability = v_loss_disability\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.reserve_ctgry = v_loss_reserve_category\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.cause_of_loss = v_loss_cause\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.pms_mbr = v_loss_member\n\tAND LKP_CLAIMANT_DETAIL_COVERAGE_v_claim_party_occurence_ak_id_claimant_v_loss_location_number_v_loss_sub_location_number_v_loss_insurance_line_v_loss_risk_unit_group_V_risk_unit_grp_seq_num_v_loss_unit_v_loss_sequence_risk_unit_v_loss_major_peril_v_loss_major_peril_seq_v_loss_disability_v_loss_reserve_category_v_loss_cause_v_loss_member_v_loss_type_exposure.pms_type_exposure = v_loss_type_exposure\n\n),\nAGG_claim_transaction_stage AS (\n\tSELECT\n\tclaimant_coverage_detail_ak_id,\n\tLOSS_DRAFT_NO,\n\tLOSS_DRAFT_AMOUNT,\n\tLOSS_TRANSACTION_DATE,\n\tpay_to_code,\n\tLOSS_ENTRY_OPERATOR,\n\tLOSS_DRAFT_MAIL_TO,\n\tLOSS_BANK_NUMBER,\n\tLOSS_DRAFT_CHECK_IND,\n\tLOSS_PAYEE_PHRASE,\n\tLOSS_MEMO_PHRASE,\n\tLOSS_1099_NUMBER,\n\tLOSS_CLAIM_PAYEE_NAME,\n\tsource_system_id AS SOURCE_SYSTEM_ID,\n\to_claim_party_occurence_ak_id_payee,\n\to_loss_adjustor_no AS loss_adjustor_no,\n\to_party_role_code_payee AS o_party_role_code\n\tFROM EXP_CLAIM_TRANSACTION_VALIDATE\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_coverage_detail_ak_id, LOSS_DRAFT_NO, LOSS_DRAFT_AMOUNT, LOSS_TRANSACTION_DATE ORDER BY NULL) = 1\n),\nEXP_get_values AS (\n\tSELECT\n\tLOSS_ENTRY_OPERATOR,\n\tLOSS_DRAFT_NO,\n\tLOSS_DRAFT_AMOUNT,\n\tLOSS_TRANSACTION_DATE AS LOSS_TRANSACTION_DATE_payment,\n\tloss_adjustor_no AS LOSS_ADJUSTOR_NO,\n\to_party_role_code AS PARTY_ROLE_CODE,\n\tpay_to_code,\n\tLOSS_DRAFT_MAIL_TO AS loss_draft_mail_to,\n\tSOURCE_SYSTEM_ID,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tclaimant_coverage_detail_ak_id,\n\to_claim_party_occurence_ak_id_payee\n\tFROM AGG_claim_transaction_stage\n),\nLKP_claim_payment AS (\n\tSELECT\n\tclaim_pay_ak_id,\n\tpms_claimant_cov_det_ak_id,\n\tmicro_ecd_draft_num,\n\ttotal_pay_amt,\n\tpay_issued_date\n\tFROM (\n\t\tSELECT \r\n\t\tclaim_payment.claim_pay_ak_id as claim_pay_ak_id, \r\n\t\tclaim_payment.pms_claimant_cov_det_ak_id as pms_claimant_cov_det_ak_id, \r\n\t\tLTRIM(RTRIM(claim_payment.micro_ecd_draft_num)) as micro_ecd_draft_num, \r\n\t\tclaim_payment.total_pay_amt as total_pay_amt, \r\n\t\tclaim_payment.pay_issued_date as pay_issued_date \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_payment\r\n\t\tWHERE source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pms_claimant_cov_det_ak_id,micro_ecd_draft_num,total_pay_amt,pay_issued_date ORDER BY claim_pay_ak_id) = 1\n),\nFIL_remove_claim_payment AS (\n\tSELECT\n\tLKP_claim_payment.claim_pay_ak_id, \n\tEXP_get_values.LOSS_ENTRY_OPERATOR, \n\tEXP_get_values.LOSS_DRAFT_NO, \n\tEXP_get_values.LOSS_DRAFT_AMOUNT, \n\tEXP_get_values.LOSS_TRANSACTION_DATE_payment, \n\tEXP_get_values.LOSS_ADJUSTOR_NO, \n\tEXP_get_values.pay_to_code, \n\tEXP_get_values.loss_draft_mail_to, \n\tEXP_get_values.SOURCE_SYSTEM_ID, \n\tEXP_get_values.crrnt_snpsht_flag, \n\tEXP_get_values.audit_id, \n\tEXP_get_values.o_claim_party_occurence_ak_id_payee\n\tFROM EXP_get_values\n\tLEFT JOIN LKP_claim_payment\n\tON LKP_claim_payment.pms_claimant_cov_det_ak_id = EXP_get_values.claimant_coverage_detail_ak_id AND LKP_claim_payment.micro_ecd_draft_num = EXP_get_values.LOSS_DRAFT_NO AND LKP_claim_payment.total_pay_amt = EXP_get_values.LOSS_DRAFT_AMOUNT AND LKP_claim_payment.pay_issued_date = EXP_get_values.LOSS_TRANSACTION_DATE_payment\n\tWHERE IIF(ISNULL(claim_pay_ak_id), FALSE, TRUE)\n),\nEXP_Claim_party_occ_payment_get_values AS (\n\tSELECT\n\to_claim_party_occurence_ak_id_payee,\n\tclaim_pay_ak_id,\n\tLOSS_ADJUSTOR_NO,\n\t'N/A' AS Payee_type,\n\t'N/A' AS Payee_type_seq_nbr,\n\tSOURCE_SYSTEM_ID,\n\tcrrnt_snpsht_flag,\n\taudit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_dt,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_dt,\n\tsysdate AS created_date,\n\tsysdate AS modified_date\n\tFROM FIL_remove_claim_payment\n),\nLKP_claim_party_occ_payment AS (\n\tSELECT\n\tclaim_party_occurrence_pay_id,\n\tclaim_pay_ak_id,\n\tclaim_party_occurrence_ak_id,\n\tpayee_code,\n\tIN_claim_pay_ak_id,\n\to_claim_party_occurence_ak_id_payee,\n\tIN_LOSS_ADJUSTOR_NO\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_party_occurrence_pay_id,\n\t\t\tclaim_pay_ak_id,\n\t\t\tclaim_party_occurrence_ak_id,\n\t\t\tpayee_code,\n\t\t\tIN_claim_pay_ak_id,\n\t\t\to_claim_party_occurence_ak_id_payee,\n\t\t\tIN_LOSS_ADJUSTOR_NO\n\t\tFROM claim_party_occurrence_payment\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,claim_party_occurrence_ak_id,payee_code ORDER BY claim_party_occurrence_pay_id) = 1\n),\nRTR_Claim_party_occ_payment AS (\n\tSELECT\n\tLKP_claim_party_occ_payment.claim_party_occurrence_pay_id,\n\tEXP_Claim_party_occ_payment_get_values.claim_pay_ak_id,\n\tEXP_Claim_party_occ_payment_get_values.o_claim_party_occurence_ak_id_payee,\n\tEXP_Claim_party_occ_payment_get_values.Payee_type,\n\tEXP_Claim_party_occ_payment_get_values.LOSS_ADJUSTOR_NO,\n\tEXP_Claim_party_occ_payment_get_values.Payee_type_seq_nbr,\n\tEXP_Claim_party_occ_payment_get_values.SOURCE_SYSTEM_ID,\n\tEXP_Claim_party_occ_payment_get_values.crrnt_snpsht_flag,\n\tEXP_Claim_party_occ_payment_get_values.audit_id,\n\tEXP_Claim_party_occ_payment_get_values.eff_from_dt,\n\tEXP_Claim_party_occ_payment_get_values.eff_to_dt,\n\tEXP_Claim_party_occ_payment_get_values.created_date,\n\tEXP_Claim_party_occ_payment_get_values.modified_date\n\tFROM EXP_Claim_party_occ_payment_get_values\n\tLEFT JOIN LKP_claim_party_occ_payment\n\tON LKP_claim_party_occ_payment.claim_pay_ak_id = EXP_Claim_party_occ_payment_get_values.claim_pay_ak_id AND LKP_claim_party_occ_payment.claim_party_occurrence_ak_id = EXP_Claim_party_occ_payment_get_values.o_claim_party_occurence_ak_id_payee AND LKP_claim_party_occ_payment.payee_code = EXP_Claim_party_occ_payment_get_values.LOSS_ADJUSTOR_NO\n),\nRTR_Claim_party_occ_payment_INSERT AS (SELECT * FROM RTR_Claim_party_occ_payment WHERE ISNULL(claim_party_occurrence_pay_id)),\nRTR_Claim_party_occ_payment_UPDATE AS (SELECT * FROM RTR_Claim_party_occ_payment WHERE NOT ISNULL(claim_party_occurrence_pay_id)),\nUPD_Claim_party_occ_update AS (\n\tSELECT\n\tclaim_party_occurrence_pay_id AS claim_party_occurrence_pay_id3, \n\tclaim_pay_ak_id AS claim_pay_ak_id3, \n\to_claim_party_occurence_ak_id_payee, \n\tPayee_type AS Payee_type3, \n\tLOSS_ADJUSTOR_NO AS LOSS_ADJUSTOR_NO3, \n\tPayee_type_seq_nbr AS Payee_type_seq_nbr3, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_dt AS eff_from_dt3, \n\teff_to_dt AS eff_to_dt3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3\n\tFROM RTR_Claim_party_occ_payment_UPDATE\n),\nclaim_party_occurrence_payment_update AS (\n\tMERGE INTO claim_party_occurrence_payment AS T\n\tUSING UPD_Claim_party_occ_update AS S\n\tON T.claim_party_occurrence_pay_id = S.claim_party_occurrence_pay_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.payee_code = S.LOSS_ADJUSTOR_NO3, T.modified_date = S.modified_date3\n),\nSEQ_Claim_Party_Occurrence_Payment_AK AS (\n\tCREATE SEQUENCE SEQ_Claim_Party_Occurrence_Payment_AK\n\tSTART = 0\n\tINCREMENT = 1;\n),\nUPD_Claim_party_occ_insert AS (\n\tSELECT\n\tclaim_pay_ak_id AS claim_pay_ak_id1, \n\to_claim_party_occurence_ak_id_payee, \n\tPayee_type AS Payee_type1, \n\tLOSS_ADJUSTOR_NO AS LOSS_ADJUSTOR_NO1, \n\tPayee_type_seq_nbr AS Payee_type_seq_nbr1, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_dt AS eff_from_dt1, \n\teff_to_dt AS eff_to_dt1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1\n\tFROM RTR_Claim_party_occ_payment_INSERT\n),\nclaim_party_occurrence_payment_insert AS (\n\tINSERT INTO claim_party_occurrence_payment\n\t(claim_party_occurrence_pay_ak_id, claim_pay_ak_id, claim_party_occurrence_ak_id, payee_type, payee_code, claim_payee_seq_num, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date)\n\tSELECT \n\tSEQ_Claim_Party_Occurrence_Payment_AK.NEXTVAL AS CLAIM_PARTY_OCCURRENCE_PAY_AK_ID, \n\tclaim_pay_ak_id1 AS CLAIM_PAY_AK_ID, \n\to_claim_party_occurence_ak_id_payee AS CLAIM_PARTY_OCCURRENCE_AK_ID, \n\tPayee_type1 AS PAYEE_TYPE, \n\tLOSS_ADJUSTOR_NO1 AS PAYEE_CODE, \n\tPayee_type_seq_nbr1 AS CLAIM_PAYEE_SEQ_NUM, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_dt1 AS EFF_FROM_DATE, \n\teff_to_dt1 AS EFF_TO_DATE, \n\tSOURCE_SYSTEM_ID1 AS SOURCE_SYS_ID, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE\n\tFROM UPD_Claim_party_occ_insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYS_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Claims DataWarehouse/"
        },
        "annotations": []
    }
}