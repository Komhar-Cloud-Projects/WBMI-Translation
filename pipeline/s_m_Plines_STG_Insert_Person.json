{
    "name": "s_m_Plines_STG_Insert_Person",
    "properties": {
        "activities": [
            {
                "name": "m_Plines_STG_Insert_Person",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_person AS (\n\tSELECT\n\t\tperson_seq,\n\t\tpolicy_num,\n\t\tpolicy_sym,\n\t\tpolicy_mod,\n\t\tpolicy_mco,\n\t\tperson_num,\n\t\trelationship_to_insd_type_code,\n\t\tsex,\n\t\tmarital_status_type_code,\n\t\tdob,\n\t\toccupation_descript,\n\t\toccupation_class_type_code,\n\t\tlicense_date,\n\t\tin_college_flag,\n\t\tgood_student_flag,\n\t\ttraining_flag,\n\t\tacc_prev_course_date,\n\t\tis_licensed_flag,\n\t\tdriver_license_num,\n\t\tdriver_license_state_type_code,\n\t\tcustody_flag,\n\t\texcl_driver_flag,\n\t\tnon_rel_veh_owner_flag,\n\t\tnon_rel_has_ins_flag,\n\t\tnon_rel_has_standard_ins_f,\n\t\tnon_rel_ins_company,\n\t\tmilitary_serv_flag,\n\t\tlicense_susp_or_revoke_flag,\n\t\tfinancial_resp_flag,\n\t\tfinancial_filing_date,\n\t\tfirst_name,\n\t\tmiddle_initial,\n\t\tlast_name,\n\t\tau_driver_flag,\n\t\teno_driver_flag,\n\t\tvisited_status_type_code,\n\t\twt_driver_flag,\n\t\trv_driver_flag,\n\t\trv_experience_flag,\n\t\tboating_experience_flag,\n\t\tboating_course_cert_flag,\n\t\temployer,\n\t\tbus_phone,\n\t\tpip_excl,\n\t\tsr22_uw_author_type_code,\n\t\tsr22_file_type_code,\n\t\tsr22_wbm_complete_flag,\n\t\tsr22_wbm_to_complete_flag,\n\t\tsr22_author_by_wbm_flag,\n\t\tparent_support_cov_flag,\n\t\thave_cycle_license_flag,\n\t\thave_cycle_license_num_year,\n\t\tcredit_score,\n\t\tcredit_score_date,\n\t\tcredit_score_source,\n\t\tcredit_score_status,\n\t\tcredit_score_msmq_message,\n\t\tmailing_address_flag,\n\t\tmodified_date,\n\t\tmodified_user_id,\n\t\tpif_person_name,\n\t\tendorsement_person_view_code,\n\t\texc_flag,\n\t\texc_date,\n\t\tcollege_full_time_flag,\n\t\tcollege_res_student_flag,\n\t\tcollege_name,\n\t\tcollege_city,\n\t\tcollege_state_type_code,\n\t\tacc_convctn_na_flag,\n\t\tchoicepoint_ref_num,\n\t\tpif_driver_discount,\n\t\tmember_household_flag,\n\t\tpif_excl_flag,\n\t\tpif_in_college_flag,\n\t\tage_at_renl_or_endorse,\n\t\tsuffix_name,\n\t\tnum_of_mile_from_home,\n\t\tdriver_tier,\n\t\tpif_relationship_to_insd_type_code,\n\t\tgraduate_good_student_flag,\n\t\tpif_financial_resp_flag,\n\t\tpif_good_student_flag,\n\t\tpif_graduate_good_student_flag,\n\t\tpip_excl_flag,\n\t\tpif_pip_excl_flag,\n\t\tnum_yrs_licd,\n\t\tlicense_exp_date,\n\t\tis_licensed_5_or_more_years_flag,\n\t\temployer_business_descript,\n\t\tper_status_type_code,\n\t\tchild_under_17_flag\n\tFROM person\n),\nEXP_PERSON AS (\n\tSELECT\n\tperson_seq,\n\tpolicy_num,\n\tpolicy_sym,\n\tpolicy_mod,\n\tpolicy_mco,\n\tperson_num,\n\trelationship_to_insd_type_code,\n\tsex,\n\tmarital_status_type_code,\n\tdob,\n\toccupation_descript,\n\toccupation_class_type_code,\n\tlicense_date,\n\tin_college_flag,\n\tgood_student_flag,\n\ttraining_flag,\n\tacc_prev_course_date,\n\tis_licensed_flag,\n\tdriver_license_num,\n\tdriver_license_state_type_code,\n\tcustody_flag,\n\texcl_driver_flag,\n\tnon_rel_veh_owner_flag,\n\tnon_rel_has_ins_flag,\n\tnon_rel_has_standard_ins_f,\n\tnon_rel_ins_company,\n\tmilitary_serv_flag,\n\tlicense_susp_or_revoke_flag,\n\tfinancial_resp_flag,\n\tfinancial_filing_date,\n\tfirst_name,\n\tmiddle_initial,\n\tlast_name,\n\tau_driver_flag,\n\teno_driver_flag,\n\tvisited_status_type_code,\n\twt_driver_flag,\n\trv_driver_flag,\n\trv_experience_flag,\n\tboating_experience_flag,\n\tboating_course_cert_flag,\n\temployer,\n\tbus_phone,\n\tpip_excl,\n\tsr22_uw_author_type_code,\n\tsr22_file_type_code,\n\tsr22_wbm_complete_flag,\n\tsr22_wbm_to_complete_flag,\n\tsr22_author_by_wbm_flag,\n\tparent_support_cov_flag,\n\thave_cycle_license_flag,\n\thave_cycle_license_num_year,\n\tcredit_score,\n\tcredit_score_date,\n\tcredit_score_source,\n\tcredit_score_status,\n\tcredit_score_msmq_message,\n\tmailing_address_flag,\n\tmodified_date,\n\tmodified_user_id,\n\tpif_person_name,\n\tendorsement_person_view_code,\n\texc_flag,\n\texc_date,\n\tcollege_full_time_flag,\n\tcollege_res_student_flag,\n\tcollege_name,\n\tcollege_city,\n\tcollege_state_type_code,\n\tacc_convctn_na_flag,\n\tchoicepoint_ref_num,\n\tpif_driver_discount,\n\tmember_household_flag,\n\tpif_excl_flag,\n\tpif_in_college_flag,\n\tage_at_renl_or_endorse,\n\tsuffix_name,\n\tnum_of_mile_from_home,\n\tdriver_tier,\n\tpif_relationship_to_insd_type_code,\n\tgraduate_good_student_flag,\n\tpif_financial_resp_flag,\n\tpif_good_student_flag,\n\tpif_graduate_good_student_flag,\n\tpip_excl_flag,\n\tpif_pip_excl_flag,\n\tnum_yrs_licd,\n\tlicense_exp_date,\n\tis_licensed_5_or_more_years_flag,\n\temployer_business_descript,\n\tper_status_type_code,\n\tchild_under_17_flag,\n\tSYSDATE AS EXTRACT_DATE,\n\tSYSDATE AS AS_OF_DATE,\n\t'' AS RECORD_COUNT,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID\n\tFROM SQ_person\n),\nperson_stage AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.person_stage;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.person_stage\n\t(person_seq, policy_num, policy_sym, policy_mod, policy_mco, person_num, relationship_to_insd_type_code, sex, marital_status_type_code, dob, occupation_descript, occupation_class_type_code, license_date, in_college_flag, good_student_flag, training_flag, acc_prev_course_date, is_licensed_flag, driver_license_state_type_code, custody_flag, excl_driver_flag, non_rel_veh_owner_flag, non_rel_has_ins_flag, non_rel_has_standard_ins_f, non_rel_ins_company, military_serv_flag, license_susp_or_revoke_flag, financial_resp_flag, financial_filing_date, first_name, middle_initial, last_name, au_driver_flag, eno_driver_flag, visited_status_type_code, wt_driver_flag, rv_driver_flag, rv_experience_flag, boating_experience_flag, boating_course_cert_flag, employer, bus_phone, pip_excl, sr22_uw_author_type_code, sr22_file_type_code, sr22_wbm_complete_flag, sr22_wbm_to_complete_flag, sr22_author_by_wbm_flag, parent_support_cov_flag, have_cycle_license_flag, have_cycle_license_num_year, credit_score, credit_score_date, credit_score_source, credit_score_status, credit_score_msmq_message, mailing_address_flag, modified_date, modified_user_id, pif_person_name, endorsement_person_view_code, exc_flag, exc_date, college_full_time_flag, college_res_student_flag, college_name, college_city, college_state_type_code, acc_convctn_na_flag, choicepoint_ref_num, pif_driver_discount, member_household_flag, pif_excl_flag, pif_in_college_flag, age_at_renl_or_endorse, suffix_name, num_of_mile_from_home, driver_tier, pif_relationship_to_insd_type_code, graduate_good_student_flag, pif_financial_resp_flag, pif_good_student_flag, pif_graduate_good_student_flag, pip_excl_flag, pif_pip_excl_flag, num_yrs_licd, license_exp_date, is_licensed_5_or_more_years_flag, employer_business_descript, per_status_type_code, child_under_17_flag, extract_date, as_of_date, record_count, source_system_id)\n\tSELECT \n\tPERSON_SEQ, \n\tPOLICY_NUM, \n\tPOLICY_SYM, \n\tPOLICY_MOD, \n\tPOLICY_MCO, \n\tPERSON_NUM, \n\tRELATIONSHIP_TO_INSD_TYPE_CODE, \n\tSEX, \n\tMARITAL_STATUS_TYPE_CODE, \n\tDOB, \n\tOCCUPATION_DESCRIPT, \n\tOCCUPATION_CLASS_TYPE_CODE, \n\tLICENSE_DATE, \n\tIN_COLLEGE_FLAG, \n\tGOOD_STUDENT_FLAG, \n\tTRAINING_FLAG, \n\tACC_PREV_COURSE_DATE, \n\tIS_LICENSED_FLAG, \n\tDRIVER_LICENSE_STATE_TYPE_CODE, \n\tCUSTODY_FLAG, \n\tEXCL_DRIVER_FLAG, \n\tNON_REL_VEH_OWNER_FLAG, \n\tNON_REL_HAS_INS_FLAG, \n\tNON_REL_HAS_STANDARD_INS_F, \n\tNON_REL_INS_COMPANY, \n\tMILITARY_SERV_FLAG, \n\tLICENSE_SUSP_OR_REVOKE_FLAG, \n\tFINANCIAL_RESP_FLAG, \n\tFINANCIAL_FILING_DATE, \n\tFIRST_NAME, \n\tMIDDLE_INITIAL, \n\tLAST_NAME, \n\tAU_DRIVER_FLAG, \n\tENO_DRIVER_FLAG, \n\tVISITED_STATUS_TYPE_CODE, \n\tWT_DRIVER_FLAG, \n\tRV_DRIVER_FLAG, \n\tRV_EXPERIENCE_FLAG, \n\tBOATING_EXPERIENCE_FLAG, \n\tBOATING_COURSE_CERT_FLAG, \n\tEMPLOYER, \n\tBUS_PHONE, \n\tPIP_EXCL, \n\tSR22_UW_AUTHOR_TYPE_CODE, \n\tSR22_FILE_TYPE_CODE, \n\tSR22_WBM_COMPLETE_FLAG, \n\tSR22_WBM_TO_COMPLETE_FLAG, \n\tSR22_AUTHOR_BY_WBM_FLAG, \n\tPARENT_SUPPORT_COV_FLAG, \n\tHAVE_CYCLE_LICENSE_FLAG, \n\tHAVE_CYCLE_LICENSE_NUM_YEAR, \n\tCREDIT_SCORE, \n\tCREDIT_SCORE_DATE, \n\tCREDIT_SCORE_SOURCE, \n\tCREDIT_SCORE_STATUS, \n\tCREDIT_SCORE_MSMQ_MESSAGE, \n\tMAILING_ADDRESS_FLAG, \n\tMODIFIED_DATE, \n\tMODIFIED_USER_ID, \n\tPIF_PERSON_NAME, \n\tENDORSEMENT_PERSON_VIEW_CODE, \n\tEXC_FLAG, \n\tEXC_DATE, \n\tCOLLEGE_FULL_TIME_FLAG, \n\tCOLLEGE_RES_STUDENT_FLAG, \n\tCOLLEGE_NAME, \n\tCOLLEGE_CITY, \n\tCOLLEGE_STATE_TYPE_CODE, \n\tACC_CONVCTN_NA_FLAG, \n\tCHOICEPOINT_REF_NUM, \n\tPIF_DRIVER_DISCOUNT, \n\tMEMBER_HOUSEHOLD_FLAG, \n\tPIF_EXCL_FLAG, \n\tPIF_IN_COLLEGE_FLAG, \n\tAGE_AT_RENL_OR_ENDORSE, \n\tSUFFIX_NAME, \n\tNUM_OF_MILE_FROM_HOME, \n\tDRIVER_TIER, \n\tPIF_RELATIONSHIP_TO_INSD_TYPE_CODE, \n\tGRADUATE_GOOD_STUDENT_FLAG, \n\tPIF_FINANCIAL_RESP_FLAG, \n\tPIF_GOOD_STUDENT_FLAG, \n\tPIF_GRADUATE_GOOD_STUDENT_FLAG, \n\tPIP_EXCL_FLAG, \n\tPIF_PIP_EXCL_FLAG, \n\tNUM_YRS_LICD, \n\tLICENSE_EXP_DATE, \n\tIS_LICENSED_5_OR_MORE_YEARS_FLAG, \n\tEMPLOYER_BUSINESS_DESCRIPT, \n\tPER_STATUS_TYPE_CODE, \n\tCHILD_UNDER_17_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID\n\tFROM EXP_PERSON\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/CommonStaging/"
        },
        "annotations": []
    }
}