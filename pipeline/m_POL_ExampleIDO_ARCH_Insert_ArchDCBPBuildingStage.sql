WITH
SQ_DCBPBuildingStage AS (
	SELECT
		DCBPBuildingStageId,
		BPLocationId,
		BPBuildingId,
		SessionId,
		Id,
		AutomaticFireAlarm,
		BuildingGroup,
		BuildingType,
		ConstructionARate,
		ConstructionCode,
		CSP,
		Description,
		DesignCode,
		DesignExposure,
		DoorStrength,
		DoorType,
		InternalPressureDesign,
		MaximumSquareFeet,
		MixedConstruction,
		MixedConstructionSub,
		NumberOfStories,
		OpeningProtection,
		OpeningProtectionSC,
		PredominantBuildingEQ,
		PredominantBuildingEQSL,
		PredominantBuildingLiabClassGroup,
		PredominantBuildingLiabExpBase,
		PredominantBuildingOccupancyType,
		PredominantBuildingRateNumber,
		PredominantBuildingSICCode,
		PredominantLiabilityEQ,
		PredominantLiabilityEQSL,
		PredominantLiabilityLiabClassGroup,
		PredominantLiabilityLiabExpBase,
		PredominantLiabilityOccupancyType,
		PredominantLiabilityRateNumber,
		PredominantLiabilitySICCode,
		PredominantPersonalPropertyEQ,
		PredominantPersonalPropertyEQSL,
		PredominantPersonalPropertyLiabClassGroup,
		PredominantPersonalPropertyLiabExpBase,
		PredominantPersonalPropertyOccupancyType,
		PredominantPersonalPropertyRateNumber,
		PredominantPersonalPropertySICCode,
		ProtectiveDeviceP9,
		RoofCovering,
		RoofCoveringSC,
		RoofDeck,
		RoofDeckAttachment,
		RoofGeometry,
		RoofShape,
		RoofWallConnection,
		RoofWallConstruction,
		SCArea,
		SecondaryWaterResistance,
		SecurityService,
		ServiceContract,
		Sprinkler,
		SquareFt,
		Terrain,
		Vacant,
		WindBorneDebrisRegion,
		WindowProtection,
		WindSpeedDesignSpeed,
		WindSpeedGustWindSpeedOfDesign,
		WindSpeedGustWindSpeedOfLocation,
		WindstormHailRoofDamageACV,
		WindstormLossMitigation,
		WindstormProtectiveDevices,
		YearBuilt,
		ExtractDate,
		SourceSystemId
	FROM DCBPBuildingStage
),
EXP_Metadata AS (
	SELECT
	DCBPBuildingStageId,
	BPLocationId,
	BPBuildingId,
	SessionId,
	Id,
	AutomaticFireAlarm,
	BuildingGroup,
	BuildingType,
	ConstructionARate,
	ConstructionCode,
	CSP,
	Description,
	DesignCode,
	DesignExposure,
	DoorStrength,
	DoorType,
	InternalPressureDesign,
	MaximumSquareFeet,
	MixedConstruction,
	MixedConstructionSub,
	NumberOfStories,
	OpeningProtection,
	OpeningProtectionSC,
	PredominantBuildingEQ,
	PredominantBuildingEQSL,
	PredominantBuildingLiabClassGroup,
	PredominantBuildingLiabExpBase,
	PredominantBuildingOccupancyType,
	PredominantBuildingRateNumber,
	PredominantBuildingSICCode,
	PredominantLiabilityEQ,
	PredominantLiabilityEQSL,
	PredominantLiabilityLiabClassGroup,
	PredominantLiabilityLiabExpBase,
	PredominantLiabilityOccupancyType,
	PredominantLiabilityRateNumber,
	PredominantLiabilitySICCode,
	PredominantPersonalPropertyEQ,
	PredominantPersonalPropertyEQSL,
	PredominantPersonalPropertyLiabClassGroup,
	PredominantPersonalPropertyLiabExpBase,
	PredominantPersonalPropertyOccupancyType,
	PredominantPersonalPropertyRateNumber,
	PredominantPersonalPropertySICCode,
	ProtectiveDeviceP9,
	RoofCovering,
	RoofCoveringSC,
	RoofDeck,
	RoofDeckAttachment,
	RoofGeometry,
	RoofShape,
	RoofWallConnection,
	RoofWallConstruction,
	SCArea,
	SecondaryWaterResistance,
	SecurityService,
	ServiceContract,
	Sprinkler,
	SquareFt,
	Terrain,
	Vacant,
	WindBorneDebrisRegion,
	WindowProtection,
	WindSpeedDesignSpeed,
	WindSpeedGustWindSpeedOfDesign,
	WindSpeedGustWindSpeedOfLocation,
	WindstormHailRoofDamageACV,
	WindstormLossMitigation,
	WindstormProtectiveDevices,
	YearBuilt,
	ExtractDate,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_DCBPBuildingStage
),
ArchDCBPBuildingStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchDCBPBuildingStage
	(DCBPBuildingStageId, BPLocationId, BPBuildingId, SessionId, Id, AutomaticFireAlarm, BuildingGroup, BuildingType, ConstructionARate, ConstructionCode, CSP, Description, DesignCode, DesignExposure, DoorStrength, DoorType, InternalPressureDesign, MaximumSquareFeet, MixedConstruction, MixedConstructionSub, NumberOfStories, OpeningProtection, OpeningProtectionSC, PredominantBuildingEQ, PredominantBuildingEQSL, PredominantBuildingLiabClassGroup, PredominantBuildingLiabExpBase, PredominantBuildingOccupancyType, PredominantBuildingRateNumber, PredominantBuildingSICCode, PredominantLiabilityEQ, PredominantLiabilityEQSL, PredominantLiabilityLiabClassGroup, PredominantLiabilityLiabExpBase, PredominantLiabilityOccupancyType, PredominantLiabilityRateNumber, PredominantLiabilitySICCode, PredominantPersonalPropertyEQ, PredominantPersonalPropertyEQSL, PredominantPersonalPropertyLiabClassGroup, PredominantPersonalPropertyLiabExpBase, PredominantPersonalPropertyOccupancyType, PredominantPersonalPropertyRateNumber, PredominantPersonalPropertySICCode, ProtectiveDeviceP9, RoofCovering, RoofCoveringSC, RoofDeck, RoofDeckAttachment, RoofGeometry, RoofShape, RoofWallConnection, RoofWallConstruction, SCArea, SecondaryWaterResistance, SecurityService, ServiceContract, Sprinkler, SquareFt, Terrain, Vacant, WindBorneDebrisRegion, WindowProtection, WindSpeedDesignSpeed, WindSpeedGustWindSpeedOfDesign, WindSpeedGustWindSpeedOfLocation, WindstormHailRoofDamageACV, WindstormLossMitigation, WindstormProtectiveDevices, YearBuilt, ExtractDate, SourceSystemId, AuditId)
	SELECT 
	DCBPBUILDINGSTAGEID, 
	BPLOCATIONID, 
	BPBUILDINGID, 
	SESSIONID, 
	ID, 
	AUTOMATICFIREALARM, 
	BUILDINGGROUP, 
	BUILDINGTYPE, 
	CONSTRUCTIONARATE, 
	CONSTRUCTIONCODE, 
	CSP, 
	DESCRIPTION, 
	DESIGNCODE, 
	DESIGNEXPOSURE, 
	DOORSTRENGTH, 
	DOORTYPE, 
	INTERNALPRESSUREDESIGN, 
	MAXIMUMSQUAREFEET, 
	MIXEDCONSTRUCTION, 
	MIXEDCONSTRUCTIONSUB, 
	NUMBEROFSTORIES, 
	OPENINGPROTECTION, 
	OPENINGPROTECTIONSC, 
	PREDOMINANTBUILDINGEQ, 
	PREDOMINANTBUILDINGEQSL, 
	PREDOMINANTBUILDINGLIABCLASSGROUP, 
	PREDOMINANTBUILDINGLIABEXPBASE, 
	PREDOMINANTBUILDINGOCCUPANCYTYPE, 
	PREDOMINANTBUILDINGRATENUMBER, 
	PREDOMINANTBUILDINGSICCODE, 
	PREDOMINANTLIABILITYEQ, 
	PREDOMINANTLIABILITYEQSL, 
	PREDOMINANTLIABILITYLIABCLASSGROUP, 
	PREDOMINANTLIABILITYLIABEXPBASE, 
	PREDOMINANTLIABILITYOCCUPANCYTYPE, 
	PREDOMINANTLIABILITYRATENUMBER, 
	PREDOMINANTLIABILITYSICCODE, 
	PREDOMINANTPERSONALPROPERTYEQ, 
	PREDOMINANTPERSONALPROPERTYEQSL, 
	PREDOMINANTPERSONALPROPERTYLIABCLASSGROUP, 
	PREDOMINANTPERSONALPROPERTYLIABEXPBASE, 
	PREDOMINANTPERSONALPROPERTYOCCUPANCYTYPE, 
	PREDOMINANTPERSONALPROPERTYRATENUMBER, 
	PREDOMINANTPERSONALPROPERTYSICCODE, 
	PROTECTIVEDEVICEP9, 
	ROOFCOVERING, 
	ROOFCOVERINGSC, 
	ROOFDECK, 
	ROOFDECKATTACHMENT, 
	ROOFGEOMETRY, 
	ROOFSHAPE, 
	ROOFWALLCONNECTION, 
	ROOFWALLCONSTRUCTION, 
	SCAREA, 
	SECONDARYWATERRESISTANCE, 
	SECURITYSERVICE, 
	SERVICECONTRACT, 
	SPRINKLER, 
	SQUAREFT, 
	TERRAIN, 
	VACANT, 
	WINDBORNEDEBRISREGION, 
	WINDOWPROTECTION, 
	WINDSPEEDDESIGNSPEED, 
	WINDSPEEDGUSTWINDSPEEDOFDESIGN, 
	WINDSPEEDGUSTWINDSPEEDOFLOCATION, 
	WINDSTORMHAILROOFDAMAGEACV, 
	WINDSTORMLOSSMITIGATION, 
	WINDSTORMPROTECTIVEDEVICES, 
	YEARBUILT, 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_Metadata
),