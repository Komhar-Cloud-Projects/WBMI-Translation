{
    "name": "s_m_CLM_STG_Update_PIF_42GJ_42GQ",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_STG_Update_PIF_42GJ_42GQ",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nlkp_42gj_stage AS (\n\tSELECT\n\tpif_42gj_stage_id,\n\tIN_pif_symbol,\n\tIN_pif_policy_number,\n\tIN_pif_module,\n\tIN_ipfc4j_loss_year,\n\tIN_ipfc4j_loss_month,\n\tIN_ipfc4j_loss_day,\n\tIN_ipfc4j_loss_occurence,\n\tIN_ipfc4j_loss_claimant,\n\tIN_ipfc4j_use_code,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tipfc4j_loss_year,\n\tipfc4j_loss_month,\n\tipfc4j_loss_day,\n\tipfc4j_loss_occurence,\n\tipfc4j_loss_claimant,\n\tipfc4j_use_code\n\tFROM (\n\t\tSELECT \n\t\t\tpif_42gj_stage_id,\n\t\t\tIN_pif_symbol,\n\t\t\tIN_pif_policy_number,\n\t\t\tIN_pif_module,\n\t\t\tIN_ipfc4j_loss_year,\n\t\t\tIN_ipfc4j_loss_month,\n\t\t\tIN_ipfc4j_loss_day,\n\t\t\tIN_ipfc4j_loss_occurence,\n\t\t\tIN_ipfc4j_loss_claimant,\n\t\t\tIN_ipfc4j_use_code,\n\t\t\tpif_symbol,\n\t\t\tpif_policy_number,\n\t\t\tpif_module,\n\t\t\tipfc4j_loss_year,\n\t\t\tipfc4j_loss_month,\n\t\t\tipfc4j_loss_day,\n\t\t\tipfc4j_loss_occurence,\n\t\t\tipfc4j_loss_claimant,\n\t\t\tipfc4j_use_code\n\t\tFROM pif_42gj_stage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module,ipfc4j_loss_year,ipfc4j_loss_month,ipfc4j_loss_day,ipfc4j_loss_occurence,ipfc4j_loss_claimant,ipfc4j_use_code ORDER BY pif_42gj_stage_id) = 1\n),\nSQ_PIF_42GQ_CMT_stage AS (\n\tSELECT\n\t\tpif_42gq_cmt_stage_id,\n\t\tpif_symbol,\n\t\tpif_policy_number,\n\t\tpif_module,\n\t\tipfcgq_rec_length,\n\t\tipfcgq_action_code,\n\t\tipfcgq_file_id,\n\t\tipfcgq_segment_id,\n\t\tipfcgq_segment_level_code,\n\t\tipfcgq_segment_part_code,\n\t\tipfcgq_sub_part_code,\n\t\tipfcgq_year_of_loss,\n\t\tipfcgq_month_of_loss,\n\t\tipfcgq_day_of_loss,\n\t\tipfcgq_loss_occurence,\n\t\tipfcgq_loss_claimant,\n\t\tipfcgq_claimant_use_code,\n\t\tipfcgq_claimant_use_seq,\n\t\tipfcgq_year_process,\n\t\tipfcgq_month_process,\n\t\tipfcgq_day_process,\n\t\tipfcgq_year_change_entry,\n\t\tipfcgq_month_change_entry,\n\t\tipfcgq_day_change_entry,\n\t\tipfcgq_sequence_change_entry,\n\t\tipfcgq_segment_status,\n\t\tipfcgq_entry_operator,\n\t\tipfcgq_loss_payee_num,\n\t\tipfcgq_loss_payee_type,\n\t\tipfcgq_reinsurance_indicator,\n\t\tipfcgq_loss_adjustor_no,\n\t\tipfcgq_loss_examiner,\n\t\tipfcgq_other_assignment,\n\t\tipfcgq_account_entered_date,\n\t\tipfcgq_time_employed_years,\n\t\tipfcgq_time_employed_months,\n\t\tipfcgq_claim_number,\n\t\tipfcgq_claim_filler,\n\t\tipfcgq_claim_status,\n\t\tipfcgq_loss_original_reserve,\n\t\tipfcgq_os_loss_reserve,\n\t\tipfcgq_os_expense_reserve,\n\t\tipfcgq_total_loss,\n\t\tipfcgq_total_expense,\n\t\tipfcgq_total_recoveries,\n\t\tipfcgq_beg_os_loss_reserve,\n\t\tipfcgq_contact_year,\n\t\tipfcgq_contact_month,\n\t\tipfcgq_contact_day,\n\t\tipfcgq_denial_year,\n\t\tipfcgq_denial_month,\n\t\tipfcgq_denial_day,\n\t\tipfcgq_loss_handling_office,\n\t\tipfcgq_loss_handling_branch,\n\t\tipfcgq_loss_aia_codes_1_2,\n\t\tipfcgq_loss_aia_codes_3_4,\n\t\tipfcgq_loss_aia_codes_5_6,\n\t\tipfcgq_aia_sub_code,\n\t\tipfcgq_loss_age,\n\t\tipfcgq_claimant_type,\n\t\tipfcgq_loss_claimant_name,\n\t\tipfcgq_claimant_birth_year,\n\t\tipfcgq_claimant_birth_month,\n\t\tipfcgq_claimant_birth_day,\n\t\tipfcgq_loss_sex,\n\t\tipfcgq_marital_status,\n\t\tipfcgq_accident_cov_state,\n\t\tipfcgq_cib_report_ind,\n\t\tipfcgq_official_report_ind,\n\t\tipfcgq_death_indicator,\n\t\tipfcgq_excess_loss_ind,\n\t\tipfcgq_loss_suit,\n\t\tipfcgq_other_insurance,\n\t\tipfcgq_recorded_statement,\n\t\tipfcgq_loss_cause,\n\t\tipfcgq_loss_coverage_code,\n\t\tipfcgq_catastrophe_no,\n\t\tipfcgq_excess_catastrophe_no,\n\t\tipfcgq_type_disability,\n\t\tipfcgq_liab_over_ind,\n\t\tipfcgq_leg_exp_clmts,\n\t\tipfcgq_percent_disability,\n\t\tipfcgq_loss_cov_code_2,\n\t\tipfcgq_event_cat_code,\n\t\tipfcgq_claim_code_basis,\n\t\tipfcgq_acct_state_only,\n\t\tipfcgq_mngd_care_org,\n\t\tipfcgq_number_of_part78,\n\t\tipfcgq_offset_onset_ind,\n\t\tipfcgq_date_hire,\n\t\tipfcgq_pms_future_use_gq,\n\t\tipfcgq_direct_reporting,\n\t\tipfcgq_cust_spl_use_gq,\n\t\tipfcgq_yr2000_cust_use,\n\t\tinf_action,\n\t\tinf_timestamp,\n\t\tlogical_flag,\n\t\textract_date,\n\t\tas_of_date,\n\t\trecord_count,\n\t\tsource_system_id\n\tFROM PIF_42GQ_CMT_stage\n),\nEXP_Update_STAGE_42GJ AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tipfcgq_year_of_loss,\n\tipfcgq_month_of_loss,\n\tipfcgq_day_of_loss,\n\tipfcgq_loss_occurence,\n\tipfcgq_loss_claimant,\n\tipfcgq_claimant_use_code,\n\tlogical_flag,\n\t-- *INF*: DECODE(logical_flag,\r\n\t-- '0','5',\r\n\t-- '1','5',\r\n\t-- '-1','2',\r\n\t-- '-2','3',\r\n\t-- '-3','4',\r\n\t-- '6','6','9')\n\tDECODE(\n\t    logical_flag,\n\t    '0', '5',\n\t    '1', '5',\n\t    '-1', '2',\n\t    '-2', '3',\n\t    '-3', '4',\n\t    '6', '6',\n\t    '9'\n\t) AS logical_flag_insert,\n\t-- *INF*: :LKP.LKP_42GJ_STAGE(pif_symbol,pif_policy_number,pif_module,ipfcgq_year_of_loss,ipfcgq_month_of_loss,ipfcgq_day_of_loss,ipfcgq_loss_occurence,ipfcgq_loss_claimant,ipfcgq_claimant_use_code)\n\tLKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.pif_42gj_stage_id AS pif_42gj_stage_id,\n\tSYSDATE AS extract_date,\n\tSYSDATE AS as_of_date,\n\tsource_system_id\n\tFROM SQ_PIF_42GQ_CMT_stage\n\tLEFT JOIN LKP_42GJ_STAGE LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code\n\tON LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.pif_symbol = pif_symbol\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.pif_policy_number = pif_policy_number\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.pif_module = pif_module\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_loss_year = ipfcgq_year_of_loss\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_loss_month = ipfcgq_month_of_loss\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_loss_day = ipfcgq_day_of_loss\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_loss_occurence = ipfcgq_loss_occurence\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_loss_claimant = ipfcgq_loss_claimant\n\tAND LKP_42GJ_STAGE_pif_symbol_pif_policy_number_pif_module_ipfcgq_year_of_loss_ipfcgq_month_of_loss_ipfcgq_day_of_loss_ipfcgq_loss_occurence_ipfcgq_loss_claimant_ipfcgq_claimant_use_code.ipfc4j_use_code = ipfcgq_claimant_use_code\n\n),\nfil_New_rows AS (\n\tSELECT\n\tpif_symbol, \n\tpif_policy_number, \n\tpif_module, \n\tipfcgq_year_of_loss, \n\tipfcgq_month_of_loss, \n\tipfcgq_day_of_loss, \n\tipfcgq_loss_occurence, \n\tipfcgq_loss_claimant, \n\tipfcgq_claimant_use_code, \n\tlogical_flag_insert, \n\tpif_42gj_stage_id, \n\textract_date, \n\tas_of_date, \n\tsource_system_id\n\tFROM EXP_Update_STAGE_42GJ\n\tWHERE ISNULL(pif_42gj_stage_id)\n),\nPIF_42GJ_stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.PIF_42GJ_stage\n\t(pif_symbol, pif_policy_number, pif_module, ipfc4j_loss_year, ipfc4j_loss_month, ipfc4j_loss_day, ipfc4j_loss_occurence, ipfc4j_loss_claimant, ipfc4j_use_code, logical_flag, extract_date, as_of_date, source_system_id)\n\tSELECT \n\tPIF_SYMBOL, \n\tPIF_POLICY_NUMBER, \n\tPIF_MODULE, \n\tipfcgq_year_of_loss AS IPFC4J_LOSS_YEAR, \n\tipfcgq_month_of_loss AS IPFC4J_LOSS_MONTH, \n\tipfcgq_day_of_loss AS IPFC4J_LOSS_DAY, \n\tipfcgq_loss_occurence AS IPFC4J_LOSS_OCCURENCE, \n\tipfcgq_loss_claimant AS IPFC4J_LOSS_CLAIMANT, \n\tipfcgq_claimant_use_code AS IPFC4J_USE_CODE, \n\tlogical_flag_insert AS LOGICAL_FLAG, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tSOURCE_SYSTEM_ID\n\tFROM fil_New_rows\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}