{
    "name": "s_m_CLM_DW_LOAD_MissingPolicyEntry_DCT_PL",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DW_LOAD_MissingPolicyEntry_DCT_PL",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Policy AS (\n\tSELECT\n\tpol_ak_id,\n\tpol_key\n\tFROM (\n\t\tSELECT A.pol_ak_id as pol_ak_id, A.pol_key as pol_key FROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy A\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter B\r\n\t\ton A.StrategicProfitCenterAKId=B.StrategicProfitCenterAKId\r\n\t\twhere A.source_sys_id='DCT'\r\n\t\tand A. crrnt_snpsht_flag=1\r\n\t\tand B.StrategicProfitCenterAbbreviation='WB - PL'\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key ORDER BY pol_ak_id) = 1\n),\nLKP_StrategicProfitCenterAKId AS (\n\tSELECT\n\tStrategicProfitCenterAKId,\n\tStrategicProfitCenterCode\n\tFROM (\n\t\tSELECT \n\t\t\tStrategicProfitCenterAKId,\n\t\t\tStrategicProfitCenterCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.StrategicProfitCenter\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StrategicProfitCenterCode ORDER BY StrategicProfitCenterAKId) = 1\n),\nLKP_InsuranceSegment AS (\n\tSELECT\n\tInsuranceSegmentAKId,\n\tInsuranceSegmentCode\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceSegmentAKId,\n\t\t\tInsuranceSegmentCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceSegment\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceSegmentCode ORDER BY InsuranceSegmentAKId) = 1\n),\nSQ_policy AS (\n\tselect A.Pol_id\r\n\t      ,9999 audit_id\r\n\t      ,getdate() modified_date\r\n\t      ,B.contract_cust_ak_id\r\n\t      ,B.agency_ak_id\r\n\t      ,B.mco\r\n\t      ,B.pol_co_num\r\n\t      ,B.pol_eff_date\r\n\t      ,B.pol_exp_date\r\n\t      ,B.orig_incptn_date\r\n\t      ,B.prim_bus_class_code\r\n\t      ,B.reins_code\r\n\t      ,B.pms_pol_lob_code\r\n\t      ,B.pol_co_line_code\r\n\t      ,B.pol_cancellation_ind\r\n\t      ,B.pol_cancellation_date\r\n\t      ,B.pol_cancellation_rsn_code\r\n\t      ,B.state_of_domicile_code\r\n\t      ,B.wbconnect_upload_code\r\n\t      ,B.serv_center_support_code\r\n\t      ,B.pol_term\r\n\t      ,B.terrorism_risk_ind\r\n\t      ,B.prior_pol_key\r\n\t      ,B.pol_status_code\r\n\t      ,B.pol_issue_code\r\n\t      ,B.pol_age\r\n\t      ,B.industry_risk_grade_code\r\n\t      ,B.uw_review_yr\r\n\t      ,B.mvr_request_code\r\n\t      ,B.renl_code\r\n\t      ,B.amend_num\r\n\t      ,B.anniversary_rerate_code\r\n\t      ,B.pol_audit_frqncy\r\n\t      ,B.final_audit_code\r\n\t      ,B.zip_ind\r\n\t      ,B.guarantee_ind\r\n\t      ,B.variation_code\r\n\t      ,B.county\r\n\t      ,B.non_smoker_disc_code\r\n\t      ,B.renl_disc\r\n\t      ,B.renl_safe_driver_disc_count\r\n\t      ,B.nonrenewal_flag_date\r\n\t      ,B.audit_complt_date\r\n\t      ,B.orig_acct_date\r\n\t      ,B.pol_enter_date\r\n\t      ,B.excess_claim_code\r\n\t      ,B.pol_status_on_pif\r\n\t      ,B.target_mrkt_code\r\n\t      ,B.pkg_code\r\n\t      ,B.pol_kind_code\r\n\t      ,B.bus_seg_code\r\n\t      ,B.pif_upload_audit_ind\r\n\t      ,B.err_flag_bal_txn\r\n\t      ,B.err_flag_bal_reins\r\n\t      ,B.producer_code_ak_id\r\n\t      ,B.prdcr_code\r\n\t      ,B.ClassOfBusiness\r\n\t      ,B.strtgc_bus_dvsn_ak_id\r\n\t      ,B.ErrorFlagBalancePremiumTransaction\r\n\t      ,B.RenewalPolicyNumber\r\n\t      ,B.RenewalPolicySymbol\r\n\t      ,B.RenewalPolicyMod\r\n\t      ,B.BillingType\r\n\t      ,B.producer_code_id\r\n\t      ,B.sup_bus_class_code_id\r\n\t      ,B.sup_pol_term_id\r\n\t      ,B.sup_pol_status_code_id\r\n\t      ,B.sup_pol_issue_code_id\r\n\t      ,B.sup_pol_audit_frqncy_id\r\n\t      ,B.sup_industry_risk_grade_code_id\r\n\t      ,B.sup_state_id\r\n\t      ,B.SurchargeExemptCode\r\n\t      ,B.SupSurchargeExemptID\r\n\t      ,B.StrategicProfitCenterAKId\r\n\t      ,B.InsuranceSegmentAKId\r\n\t      ,B.PolicyOfferingAKId\r\n\t      ,B.ProgramAKId\r\n\t      ,B.AgencyAKId\r\n\t      ,B.UnderwritingAssociateAKId\r\n\t      ,B.ObligeeName\r\n\t      ,B.AutomatedUnderwritingServicesIndicator\r\n\t      ,B.AutomaticRenewalIndicator\r\n\t      ,B.AssociationCode\r\n\t      ,B.RolloverPolicyIndicator\r\n\t      ,B.RolloverPriorCarrier\r\n\t      ,B.MailToInsuredFlag\r\n\t      ,B.AgencyEmployeeAKId\r\n\t      ,B.PolicyIssueCodeOverride\r\n\t      ,B.PoolCode\r\n\t      ,B.DCBillFlag\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy A\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Policy B\r\n\ton A.pol_ak_id=B.pol_ak_id\r\n\tand A.audit_id=999\r\n\tand B.audit_id not in (999,9999)\r\n\tinner join (\r\n\tselect C.Pol_ak_id,min(C.pol_id) Min_pol_id\r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy A\r\n\tinner join @{pipeline().parameters.TARGET_TABLE_OWNER}.StrategicProfitCenter B\r\n\ton A.StrategicProfitCenterAKId=B.StrategicProfitCenterAKId\r\n\tand A.audit_id=999\r\n\tand A.source_sys_id='DCT'\r\n\tand B.StrategicProfitCenterAbbreviation='WB - PL'\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy C\r\n\ton A.pol_ak_id=C.pol_ak_id\r\n\tand C.audit_id<>999\r\n\tand C.source_sys_id='DCT'\r\n\tgroup by C.Pol_ak_id) C\r\n\ton B.Pol_id=C.Min_pol_id\n),\nUPD_PolicyData AS (\n\tSELECT\n\tpol_id, \n\taudit_id, \n\tmodified_date, \n\tcontract_cust_ak_id, \n\tagency_ak_id, \n\tmco, \n\tpol_co_num, \n\tpol_eff_date, \n\tpol_exp_date, \n\torig_incptn_date, \n\tprim_bus_class_code, \n\treins_code, \n\tpms_pol_lob_code, \n\tpol_co_line_code, \n\tpol_cancellation_ind, \n\tpol_cancellation_date, \n\tpol_cancellation_rsn_code, \n\tstate_of_domicile_code, \n\twbconnect_upload_code, \n\tserv_center_support_code, \n\tpol_term, \n\tterrorism_risk_ind, \n\tprior_pol_key, \n\tpol_status_code, \n\tpol_issue_code, \n\tpol_age, \n\tindustry_risk_grade_code, \n\tuw_review_yr, \n\tmvr_request_code, \n\trenl_code, \n\tamend_num, \n\tanniversary_rerate_code, \n\tpol_audit_frqncy, \n\tfinal_audit_code, \n\tzip_ind, \n\tguarantee_ind, \n\tvariation_code, \n\tcounty, \n\tnon_smoker_disc_code, \n\trenl_disc, \n\trenl_safe_driver_disc_count, \n\tnonrenewal_flag_date, \n\taudit_complt_date, \n\torig_acct_date, \n\tpol_enter_date, \n\texcess_claim_code, \n\tpol_status_on_pif, \n\ttarget_mrkt_code, \n\tpkg_code, \n\tpol_kind_code, \n\tbus_seg_code, \n\tpif_upload_audit_ind, \n\terr_flag_bal_txn, \n\terr_flag_bal_reins, \n\tproducer_code_ak_id, \n\tprdcr_code, \n\tClassOfBusiness, \n\tstrtgc_bus_dvsn_ak_id, \n\tErrorFlagBalancePremiumTransaction, \n\tRenewalPolicyNumber, \n\tRenewalPolicySymbol, \n\tRenewalPolicyMod, \n\tBillingType, \n\tproducer_code_id, \n\tsup_bus_class_code_id, \n\tsup_pol_term_id, \n\tsup_pol_status_code_id, \n\tsup_pol_issue_code_id, \n\tsup_pol_audit_frqncy_id, \n\tsup_industry_risk_grade_code_id, \n\tsup_state_id, \n\tSurchargeExemptCode, \n\tSupSurchargeExemptID, \n\tStrategicProfitCenterAKId, \n\tInsuranceSegmentAKId, \n\tPolicyOfferingAKId, \n\tProgramAKId, \n\tAgencyAKId, \n\tUnderwritingAssociateAKId, \n\tObligeeName, \n\tAutomatedUnderwritingServicesIndicator, \n\tAutomaticRenewalIndicator, \n\tAssociationCode, \n\tRolloverPolicyIndicator, \n\tRolloverPriorCarrier, \n\tMailToInsuredFlag, \n\tAgencyEmployeeAKId, \n\tPolicyIssueCodeOverride, \n\tDCBillFlag, \n\tPoolCode\n\tFROM SQ_policy\n),\npolicy_Update AS (\n\tMERGE INTO @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy AS T\n\tUSING UPD_PolicyData AS S\n\tON T.pol_id = S.pol_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.audit_id = S.audit_id, T.modified_date = S.modified_date, T.contract_cust_ak_id = S.contract_cust_ak_id, T.agency_ak_id = S.agency_ak_id, T.mco = S.mco, T.pol_co_num = S.pol_co_num, T.pol_eff_date = S.pol_eff_date, T.pol_exp_date = S.pol_exp_date, T.orig_incptn_date = S.orig_incptn_date, T.prim_bus_class_code = S.prim_bus_class_code, T.reins_code = S.reins_code, T.pms_pol_lob_code = S.pms_pol_lob_code, T.pol_co_line_code = S.pol_co_line_code, T.pol_cancellation_ind = S.pol_cancellation_ind, T.pol_cancellation_date = S.pol_cancellation_date, T.pol_cancellation_rsn_code = S.pol_cancellation_rsn_code, T.state_of_domicile_code = S.state_of_domicile_code, T.wbconnect_upload_code = S.wbconnect_upload_code, T.serv_center_support_code = S.serv_center_support_code, T.pol_term = S.pol_term, T.terrorism_risk_ind = S.terrorism_risk_ind, T.prior_pol_key = S.prior_pol_key, T.pol_status_code = S.pol_status_code, T.pol_issue_code = S.pol_issue_code, T.pol_age = S.pol_age, T.industry_risk_grade_code = S.industry_risk_grade_code, T.uw_review_yr = S.uw_review_yr, T.mvr_request_code = S.mvr_request_code, T.renl_code = S.renl_code, T.amend_num = S.amend_num, T.anniversary_rerate_code = S.anniversary_rerate_code, T.pol_audit_frqncy = S.pol_audit_frqncy, T.final_audit_code = S.final_audit_code, T.zip_ind = S.zip_ind, T.guarantee_ind = S.guarantee_ind, T.variation_code = S.variation_code, T.county = S.county, T.non_smoker_disc_code = S.non_smoker_disc_code, T.renl_disc = S.renl_disc, T.renl_safe_driver_disc_count = S.renl_safe_driver_disc_count, T.nonrenewal_flag_date = S.nonrenewal_flag_date, T.audit_complt_date = S.audit_complt_date, T.orig_acct_date = S.orig_acct_date, T.pol_enter_date = S.pol_enter_date, T.excess_claim_code = S.excess_claim_code, T.pol_status_on_pif = S.pol_status_on_pif, T.target_mrkt_code = S.target_mrkt_code, T.pkg_code = S.pkg_code, T.pol_kind_code = S.pol_kind_code, T.bus_seg_code = S.bus_seg_code, T.pif_upload_audit_ind = S.pif_upload_audit_ind, T.err_flag_bal_txn = S.err_flag_bal_txn, T.err_flag_bal_reins = S.err_flag_bal_reins, T.producer_code_ak_id = S.producer_code_ak_id, T.prdcr_code = S.prdcr_code, T.ClassOfBusiness = S.ClassOfBusiness, T.strtgc_bus_dvsn_ak_id = S.strtgc_bus_dvsn_ak_id, T.ErrorFlagBalancePremiumTransaction = S.ErrorFlagBalancePremiumTransaction, T.RenewalPolicyNumber = S.RenewalPolicyNumber, T.RenewalPolicySymbol = S.RenewalPolicySymbol, T.RenewalPolicyMod = S.RenewalPolicyMod, T.BillingType = S.BillingType, T.producer_code_id = S.producer_code_id, T.sup_bus_class_code_id = S.sup_bus_class_code_id, T.sup_pol_term_id = S.sup_pol_term_id, T.sup_pol_status_code_id = S.sup_pol_status_code_id, T.sup_pol_issue_code_id = S.sup_pol_issue_code_id, T.sup_pol_audit_frqncy_id = S.sup_pol_audit_frqncy_id, T.sup_industry_risk_grade_code_id = S.sup_industry_risk_grade_code_id, T.sup_state_id = S.sup_state_id, T.SurchargeExemptCode = S.SurchargeExemptCode, T.SupSurchargeExemptID = S.SupSurchargeExemptID, T.StrategicProfitCenterAKId = S.StrategicProfitCenterAKId, T.InsuranceSegmentAKId = S.InsuranceSegmentAKId, T.PolicyOfferingAKId = S.PolicyOfferingAKId, T.ProgramAKId = S.ProgramAKId, T.AgencyAKId = S.AgencyAKId, T.UnderwritingAssociateAKId = S.UnderwritingAssociateAKId, T.ObligeeName = S.ObligeeName, T.AutomatedUnderwritingServicesIndicator = S.AutomatedUnderwritingServicesIndicator, T.AutomaticRenewalIndicator = S.AutomaticRenewalIndicator, T.AssociationCode = S.AssociationCode, T.RolloverPolicyIndicator = S.RolloverPolicyIndicator, T.RolloverPriorCarrier = S.RolloverPriorCarrier, T.MailToInsuredFlag = S.MailToInsuredFlag, T.AgencyEmployeeAKId = S.AgencyEmployeeAKId, T.PolicyIssueCodeOverride = S.PolicyIssueCodeOverride, T.PoolCode = S.PoolCode, T.DCBillFlag = S.DCBillFlag\n),\nSQ_claim_coverage_stage AS (\n\tselect B.cvr_policy_key,B.cvr_pol_nbr,B.cvr_pol_mod_nbr,B.cvr_policy_eff_dt Pol_eff_date,B.cvr_polisy_exp_dt Pol_exp_date\r\n\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.CLM_COV_PKG_STAGE  A \r\n\tinner JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_coverage_stage B\r\n\tON A.CCP_CLAIM_NBR = B.cvr_claim_nbr\r\n\tand cvr_policy_src_id='DUC'\r\n\tand A.ccp_pol_cov_id like 'P|%'\r\n\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_tab_stage C\r\n\ton A.ccp_claim_nbr=C.clm_claim_nbr\r\n\t@{pipeline().parameters.WHERE}\r\n\tgroup by B.cvr_policy_key,B.cvr_pol_nbr,B.cvr_pol_mod_nbr,B.cvr_policy_eff_dt,B.cvr_polisy_exp_dt\n),\nEXP_Source_Data_Collect AS (\n\tSELECT\n\tcvr_policy_key,\n\tcvr_pol_nbr,\n\tcvr_pol_mod_nbr,\n\t-- *INF*: IIF(ISNULL(cvr_policy_key),'',LTRIM(RTRIM(cvr_policy_key)))\n\tIFF(cvr_policy_key IS NULL, '', LTRIM(RTRIM(cvr_policy_key))) AS v_Pol_key,\n\t-- *INF*: IIF(ISNULL(cvr_pol_nbr),'',LTRIM(RTRIM(cvr_pol_nbr)))\n\tIFF(cvr_pol_nbr IS NULL, '', LTRIM(RTRIM(cvr_pol_nbr))) AS v_PolicyNumber,\n\t-- *INF*: IIF(ISNULL(cvr_pol_mod_nbr),'00',LTRIM(RTRIM(cvr_pol_mod_nbr)))\n\tIFF(cvr_pol_mod_nbr IS NULL, '00', LTRIM(RTRIM(cvr_pol_mod_nbr))) AS v_PolicyVersion,\n\t-- *INF*: IIF(v_Pol_key='',\r\n\t-- IIF(v_PolicyNumber='','',v_PolicyNumber||v_PolicyVersion),v_Pol_key)\n\tIFF(\n\t    v_Pol_key = '',\n\t    IFF(\n\t        v_PolicyNumber = '', '', v_PolicyNumber || v_PolicyVersion\n\t    ),\n\t    v_Pol_key\n\t) AS v_PolicyKey,\n\t-- *INF*: :LKP.LKP_POLICY(v_PolicyKey)\n\tLKP_POLICY_v_PolicyKey.pol_ak_id AS v_lkp_PolicyAkid,\n\tv_lkp_PolicyAkid AS lkp_PolicyAkid,\n\tv_PolicyNumber AS PolicyNumber,\n\tv_PolicyVersion AS PolicyVersion,\n\tv_PolicyKey AS PolicyKey,\n\tpol_eff_date AS Pol_eff_date,\n\tpol_exp_date AS Pol_exp_date,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_INSURANCESEGMENT('1')),-1,:LKP.LKP_INSURANCESEGMENT('1'))\n\tIFF(\n\t    LKP_INSURANCESEGMENT__1.InsuranceSegmentAKId IS NULL, - 1,\n\t    LKP_INSURANCESEGMENT__1.InsuranceSegmentAKId\n\t) AS o_InsuranceSegmentAkid,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_STRATEGICPROFITCENTERAKID('1')),-1,:LKP.LKP_STRATEGICPROFITCENTERAKID('1'))\n\tIFF(\n\t    LKP_STRATEGICPROFITCENTERAKID__1.StrategicProfitCenterAKId IS NULL, - 1,\n\t    LKP_STRATEGICPROFITCENTERAKID__1.StrategicProfitCenterAKId\n\t) AS o_StrategicProfitAkid\n\tFROM SQ_claim_coverage_stage\n\tLEFT JOIN LKP_POLICY LKP_POLICY_v_PolicyKey\n\tON LKP_POLICY_v_PolicyKey.pol_key = v_PolicyKey\n\n\tLEFT JOIN LKP_INSURANCESEGMENT LKP_INSURANCESEGMENT__1\n\tON LKP_INSURANCESEGMENT__1.InsuranceSegmentCode = '1'\n\n\tLEFT JOIN LKP_STRATEGICPROFITCENTERAKID LKP_STRATEGICPROFITCENTERAKID__1\n\tON LKP_STRATEGICPROFITCENTERAKID__1.StrategicProfitCenterCode = '1'\n\n),\nFIL_Missing_Policy AS (\n\tSELECT\n\tlkp_PolicyAkid, \n\tPolicyNumber, \n\tPolicyVersion, \n\tPolicyKey, \n\tPol_eff_date, \n\tPol_exp_date, \n\to_InsuranceSegmentAkid AS InsuranceSegmentAkid, \n\to_StrategicProfitAkid AS StrategicProfitAkid\n\tFROM EXP_Source_Data_Collect\n\tWHERE ISNULL(lkp_PolicyAkid)=1\n),\nSEQ_policy_cus_ak_id AS (\n\tCREATE SEQUENCE SEQ_policy_cus_ak_id\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_DefaultingValues AS (\n\tSELECT\n\t1 AS crrnt_snpsht_flag,\n\t999 AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_sys_id,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\tSEQ_policy_cus_ak_id.NEXTVAL AS pol_ak_id,\n\t-1 AS contract_cust_ak_id,\n\t-1 AS agency_ak_id,\n\t'000' AS pol_sym,\n\tPolicyNumber AS pol_num,\n\tPolicyVersion AS pol_mod,\n\tPolicyKey AS pol_key,\n\t'05' AS mco,\n\t'N/A' AS pol_co_num,\n\tPol_eff_date AS pol_eff_date,\n\tPol_exp_date AS pol_exp_date,\n\tSYSDATE AS orig_incptn_date,\n\t'N/A' AS prim_bus_class_code,\n\t'N/A' AS reins_code,\n\t'N/A' AS pms_pol_lob_code,\n\t'N/A' AS pol_co_line_code,\n\t'0' AS pol_cancellation_ind,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS pol_cancellation_date,\n\t'N/A' AS pol_cancellation_rsn_code,\n\t'N/A' AS state_of_domicile_code,\n\t'N/A' AS wbconnect_upload_code,\n\t'N/A' AS serv_center_support_code,\n\t'N/A' AS pol_term,\n\t'N/A' AS terrorism_risk_ind,\n\t'N/A' AS prior_pol_key,\n\t'N/A' AS pol_status_code,\n\t'N/A' AS pol_issue_code,\n\t'N/A' AS pol_age,\n\t'N/A' AS industry_risk_grade_code,\n\t'N/A' AS uw_review_yr,\n\t'N/A' AS mvr_request_code,\n\t'N/A' AS renl_code,\n\t'N/A' AS amend_num,\n\t'N/A' AS anniversary_rerate_code,\n\t'N/A' AS pol_audit_frqncy,\n\t'N/A' AS final_audit_code,\n\t'N/A' AS zip_ind,\n\t'N/A' AS guarantee_ind,\n\t'N/A' AS variation_code,\n\t'N/A' AS county,\n\t'N/A' AS non_smoker_disc_code,\n\t0 AS renl_disc,\n\t0 AS renl_safe_driver_disc_count,\n\t-- *INF*: TO_DATE('2100-12-31 23:59:59 ','YYYY-MM-DD HH24:MI:SS')\n\tTO_TIMESTAMP('2100-12-31 23:59:59 ', 'YYYY-MM-DD HH24:MI:SS') AS nonrenewal_flag_date,\n\t-- *INF*: TO_DATE('2100-12-31 23:59:59 ','YYYY-MM-DD HH24:MI:SS')\n\tTO_TIMESTAMP('2100-12-31 23:59:59 ', 'YYYY-MM-DD HH24:MI:SS') AS audit_complt_date,\n\t-- *INF*: TO_DATE('2100-12-31 23:59:59 ','YYYY-MM-DD HH24:MI:SS')\n\tTO_TIMESTAMP('2100-12-31 23:59:59 ', 'YYYY-MM-DD HH24:MI:SS') AS orig_acct_date,\n\tSYSDATE AS pol_enter_date,\n\t'N/A' AS excess_claim_code,\n\t'N/A' AS pol_status_on_pif,\n\t'N/A' AS target_mrkt_code,\n\t'N/A' AS pkg_code,\n\t'N/A' AS pol_kind_code,\n\t'N/A' AS bus_seg_code,\n\t'N/A' AS pif_upload_audit_ind,\n\t0 AS err_flag_bal_txn,\n\t0 AS err_flag_bal_reins,\n\t-1 AS producer_code_ak_id,\n\t'N/A' AS prdcr_code,\n\t'N/A' AS ClassOfBusiness,\n\t'1' AS strtgc_bus_dvsn_ak_id,\n\t0 AS ErrorFlagBalancePremiumTransaction,\n\t'N/A' AS RenewalPolicyNumber,\n\t'N/A' AS RenewalPolicySymbol,\n\t'N/A' AS RenewalPolicyMod,\n\t'N/A' AS BillingType,\n\t-1 AS producer_code_id,\n\t-1 AS sup_bus_class_code_id,\n\t-1 AS sup_pol_term_id,\n\t-1 AS sup_pol_status_code_id,\n\t-1 AS sup_pol_issue_code_id,\n\t-1 AS sup_pol_audit_frqncy_id,\n\t-1 AS sup_industry_risk_grade_code_id,\n\t-1 AS sup_state_id,\n\t'N/A' AS SurchargeExemptCode,\n\t-1 AS SupSurchargeExemptID,\n\tStrategicProfitAkid AS StrategicProfitCenterAKId,\n\tInsuranceSegmentAkid AS InsuranceSegmentAKId,\n\t-1 AS PolicyOfferingAKId,\n\t-1 AS ProgramAKId,\n\t-1 AS AgencyAKId,\n\t-1 AS UnderwritingAssociateAKId,\n\t'N/A' AS ObligeeName,\n\t'0' AS AutomatedUnderwritingServicesIndicator,\n\t'0' AS AutomaticRenewalIndicator,\n\t'N/A' AS AssociationCode,\n\t'0' AS RolloverPolicyIndicator,\n\t'N/A' AS RolloverPriorCarrier,\n\t'0' AS MailToInsuredFlag,\n\t-1 AS AgencyEmployeeAKId,\n\t'0' AS PolicyIssueCodeOverride,\n\t'N/A' AS PoolCode,\n\t'0' AS DCBillFlag\n\tFROM FIL_Missing_Policy\n),\npolicy AS (\n\tINSERT INTO @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy\n\t(crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_sys_id, created_date, modified_date, pol_ak_id, contract_cust_ak_id, agency_ak_id, pol_sym, pol_num, pol_mod, pol_key, mco, pol_co_num, pol_eff_date, pol_exp_date, orig_incptn_date, prim_bus_class_code, reins_code, pms_pol_lob_code, pol_co_line_code, pol_cancellation_ind, pol_cancellation_date, pol_cancellation_rsn_code, state_of_domicile_code, wbconnect_upload_code, serv_center_support_code, pol_term, terrorism_risk_ind, prior_pol_key, pol_status_code, pol_issue_code, pol_age, industry_risk_grade_code, uw_review_yr, mvr_request_code, renl_code, amend_num, anniversary_rerate_code, pol_audit_frqncy, final_audit_code, zip_ind, guarantee_ind, variation_code, county, non_smoker_disc_code, renl_disc, renl_safe_driver_disc_count, nonrenewal_flag_date, audit_complt_date, orig_acct_date, pol_enter_date, excess_claim_code, pol_status_on_pif, target_mrkt_code, pkg_code, pol_kind_code, bus_seg_code, pif_upload_audit_ind, err_flag_bal_txn, err_flag_bal_reins, producer_code_ak_id, prdcr_code, ClassOfBusiness, strtgc_bus_dvsn_ak_id, ErrorFlagBalancePremiumTransaction, RenewalPolicyNumber, RenewalPolicySymbol, RenewalPolicyMod, BillingType, producer_code_id, sup_bus_class_code_id, sup_pol_term_id, sup_pol_status_code_id, sup_pol_issue_code_id, sup_pol_audit_frqncy_id, sup_industry_risk_grade_code_id, sup_state_id, SurchargeExemptCode, SupSurchargeExemptID, StrategicProfitCenterAKId, InsuranceSegmentAKId, PolicyOfferingAKId, ProgramAKId, AgencyAKId, UnderwritingAssociateAKId, ObligeeName, AutomatedUnderwritingServicesIndicator, AutomaticRenewalIndicator, AssociationCode, RolloverPolicyIndicator, RolloverPriorCarrier, MailToInsuredFlag, AgencyEmployeeAKId, PolicyIssueCodeOverride, PoolCode, DCBillFlag)\n\tSELECT \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tSOURCE_SYS_ID, \n\tCREATED_DATE, \n\tMODIFIED_DATE, \n\tPOL_AK_ID, \n\tCONTRACT_CUST_AK_ID, \n\tAGENCY_AK_ID, \n\tPOL_SYM, \n\tPOL_NUM, \n\tPOL_MOD, \n\tPOL_KEY, \n\tMCO, \n\tPOL_CO_NUM, \n\tPOL_EFF_DATE, \n\tPOL_EXP_DATE, \n\tORIG_INCPTN_DATE, \n\tPRIM_BUS_CLASS_CODE, \n\tREINS_CODE, \n\tPMS_POL_LOB_CODE, \n\tPOL_CO_LINE_CODE, \n\tPOL_CANCELLATION_IND, \n\tPOL_CANCELLATION_DATE, \n\tPOL_CANCELLATION_RSN_CODE, \n\tSTATE_OF_DOMICILE_CODE, \n\tWBCONNECT_UPLOAD_CODE, \n\tSERV_CENTER_SUPPORT_CODE, \n\tPOL_TERM, \n\tTERRORISM_RISK_IND, \n\tPRIOR_POL_KEY, \n\tPOL_STATUS_CODE, \n\tPOL_ISSUE_CODE, \n\tPOL_AGE, \n\tINDUSTRY_RISK_GRADE_CODE, \n\tUW_REVIEW_YR, \n\tMVR_REQUEST_CODE, \n\tRENL_CODE, \n\tAMEND_NUM, \n\tANNIVERSARY_RERATE_CODE, \n\tPOL_AUDIT_FRQNCY, \n\tFINAL_AUDIT_CODE, \n\tZIP_IND, \n\tGUARANTEE_IND, \n\tVARIATION_CODE, \n\tCOUNTY, \n\tNON_SMOKER_DISC_CODE, \n\tRENL_DISC, \n\tRENL_SAFE_DRIVER_DISC_COUNT, \n\tNONRENEWAL_FLAG_DATE, \n\tAUDIT_COMPLT_DATE, \n\tORIG_ACCT_DATE, \n\tPOL_ENTER_DATE, \n\tEXCESS_CLAIM_CODE, \n\tPOL_STATUS_ON_PIF, \n\tTARGET_MRKT_CODE, \n\tPKG_CODE, \n\tPOL_KIND_CODE, \n\tBUS_SEG_CODE, \n\tPIF_UPLOAD_AUDIT_IND, \n\tERR_FLAG_BAL_TXN, \n\tERR_FLAG_BAL_REINS, \n\tPRODUCER_CODE_AK_ID, \n\tPRDCR_CODE, \n\tCLASSOFBUSINESS, \n\tSTRTGC_BUS_DVSN_AK_ID, \n\tERRORFLAGBALANCEPREMIUMTRANSACTION, \n\tRENEWALPOLICYNUMBER, \n\tRENEWALPOLICYSYMBOL, \n\tRENEWALPOLICYMOD, \n\tBILLINGTYPE, \n\tPRODUCER_CODE_ID, \n\tSUP_BUS_CLASS_CODE_ID, \n\tSUP_POL_TERM_ID, \n\tSUP_POL_STATUS_CODE_ID, \n\tSUP_POL_ISSUE_CODE_ID, \n\tSUP_POL_AUDIT_FRQNCY_ID, \n\tSUP_INDUSTRY_RISK_GRADE_CODE_ID, \n\tSUP_STATE_ID, \n\tSURCHARGEEXEMPTCODE, \n\tSUPSURCHARGEEXEMPTID, \n\tSTRATEGICPROFITCENTERAKID, \n\tINSURANCESEGMENTAKID, \n\tPOLICYOFFERINGAKID, \n\tPROGRAMAKID, \n\tAGENCYAKID, \n\tUNDERWRITINGASSOCIATEAKID, \n\tOBLIGEENAME, \n\tAUTOMATEDUNDERWRITINGSERVICESINDICATOR, \n\tAUTOMATICRENEWALINDICATOR, \n\tASSOCIATIONCODE, \n\tROLLOVERPOLICYINDICATOR, \n\tROLLOVERPRIORCARRIER, \n\tMAILTOINSUREDFLAG, \n\tAGENCYEMPLOYEEAKID, \n\tPOLICYISSUECODEOVERRIDE, \n\tPOOLCODE, \n\tDCBILLFLAG\n\tFROM EXP_DefaultingValues\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsDataWarehouse/"
        },
        "annotations": []
    }
}