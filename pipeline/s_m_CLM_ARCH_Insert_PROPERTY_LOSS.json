{
    "name": "s_m_CLM_ARCH_Insert_PROPERTY_LOSS",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_PROPERTY_LOSS",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PROPERTY_LOSS_STAGE AS (\n\tSELECT PROPERTY_LOSS_STAGE.PROPERTY_LOSS_ID, PROPERTY_LOSS_STAGE.CPR_CLAIM_NBR, PROPERTY_LOSS_STAGE.CPR_OBJECT_TYPE_CD, PROPERTY_LOSS_STAGE.CPR_OBJECT_SEQ_NBR, PROPERTY_LOSS_STAGE.CPR_PPY_DES_ID, PROPERTY_LOSS_STAGE.CPR_BEF_LOSS_AMT, PROPERTY_LOSS_STAGE.CPR_AGREE_ACT_IND, PROPERTY_LOSS_STAGE.CPR_EST_TOTAL_LOSS, PROPERTY_LOSS_STAGE.CPR_PURCHASED_AMT, PROPERTY_LOSS_STAGE.CPR_EST_DAY_REPAIR, PROPERTY_LOSS_STAGE.CPR_PURPOSE_USE_ID, PROPERTY_LOSS_STAGE.CPR_PHD_OWN_IND, PROPERTY_LOSS_STAGE.CPR_ENTRY_OPR_ID, PROPERTY_LOSS_STAGE.CPR_UPDATE_OPR_ID, PROPERTY_LOSS_STAGE.CPR_CREATE_TS, PROPERTY_LOSS_STAGE.CPR_PMSD_TS, PROPERTY_LOSS_STAGE.CPR_UPD_TS, PROPERTY_LOSS_STAGE.CPR_WHEN_SEE_ID, PROPERTY_LOSS_STAGE.CPR_PPY_LOC_ID, PROPERTY_LOSS_STAGE.CPR_DAMAGE_DES_ID, PROPERTY_LOSS_STAGE.CPR_MSC_PPY_IND, PROPERTY_LOSS_STAGE.CPR_ISU_OWNER_IND, PROPERTY_LOSS_STAGE.CPR_BODILY_INJ_NBR, PROPERTY_LOSS_STAGE.CPR_FATALITY_NBR, PROPERTY_LOSS_STAGE.CPR_REAL_VALUE_AMT, PROPERTY_LOSS_STAGE.CPR_CAUSE_OF_FIRE, PROPERTY_LOSS_STAGE.CPR_BURNING_MAT_CD, PROPERTY_LOSS_STAGE.CPR_LEAKING_LIQUID, PROPERTY_LOSS_STAGE.CPR_LKG_DAM_PLC_CD, PROPERTY_LOSS_STAGE.CPR_PURCHASE_DT, PROPERTY_LOSS_STAGE.CPR_CUR_VAL_AMT, PROPERTY_LOSS_STAGE.CPR_EST_WORK_TIME, PROPERTY_LOSS_STAGE.CPR_ACT_DAY_REPAIR, PROPERTY_LOSS_STAGE.CPR_ACT_WORK_TIME, PROPERTY_LOSS_STAGE.CPR_EST_TOTAL_PPY, PROPERTY_LOSS_STAGE.CPR_EST_PPY_NEW, PROPERTY_LOSS_STAGE.CPR_EST_REP_AMT, PROPERTY_LOSS_STAGE.CPR_ACT_TOTAL_LOSS, PROPERTY_LOSS_STAGE.CPR_ACT_PPY_NEW, PROPERTY_LOSS_STAGE.CPR_ACT_REP_AMT, PROPERTY_LOSS_STAGE.CPR_ACT_TOT_PPY, PROPERTY_LOSS_STAGE.CPR_ACT_WORK_AMT, PROPERTY_LOSS_STAGE.CPR_EST_WORK_AMT, PROPERTY_LOSS_STAGE.CPR_OTHER_PPY_ID, PROPERTY_LOSS_STAGE.CPR_DAM_MAC_CD, PROPERTY_LOSS_STAGE.CPR_MUL_USERS_IND, PROPERTY_LOSS_STAGE.CPR_ACL_MAT_AMT, PROPERTY_LOSS_STAGE.CPR_EST_MAT_AMT, PROPERTY_LOSS_STAGE.EXTRACT_DATE, PROPERTY_LOSS_STAGE.AS_OF_DATE, PROPERTY_LOSS_STAGE.RECORD_COUNT, PROPERTY_LOSS_STAGE.SOURCE_SYSTEM_ID \r\n\tFROM\r\n\t PROPERTY_LOSS_STAGE\r\n\tWHERE\r\n\tPROPERTY_LOSS_STAGE.CPR_CREATE_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tOR\r\n\tPROPERTY_LOSS_STAGE.CPR_UPD_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_PROPERTY_LOSS_STAGE AS (\n\tSELECT\n\tPROPERTY_LOSS_ID,\n\tCPR_CLAIM_NBR,\n\tCPR_OBJECT_TYPE_CD,\n\tCPR_OBJECT_SEQ_NBR,\n\tCPR_PPY_DES_ID,\n\tCPR_BEF_LOSS_AMT,\n\tCPR_AGREE_ACT_IND,\n\tCPR_EST_TOTAL_LOSS,\n\tCPR_PURCHASED_AMT,\n\tCPR_EST_DAY_REPAIR,\n\tCPR_PURPOSE_USE_ID,\n\tCPR_PHD_OWN_IND,\n\tCPR_ENTRY_OPR_ID,\n\tCPR_UPDATE_OPR_ID,\n\tCPR_CREATE_TS,\n\tCPR_PMSD_TS,\n\tCPR_UPD_TS,\n\tCPR_WHEN_SEE_ID,\n\tCPR_PPY_LOC_ID,\n\tCPR_DAMAGE_DES_ID,\n\tCPR_MSC_PPY_IND,\n\tCPR_ISU_OWNER_IND,\n\tCPR_BODILY_INJ_NBR,\n\tCPR_FATALITY_NBR,\n\tCPR_REAL_VALUE_AMT,\n\tCPR_CAUSE_OF_FIRE,\n\tCPR_BURNING_MAT_CD,\n\tCPR_LEAKING_LIQUID,\n\tCPR_LKG_DAM_PLC_CD,\n\tCPR_PURCHASE_DT,\n\tCPR_CUR_VAL_AMT,\n\tCPR_EST_WORK_TIME,\n\tCPR_ACT_DAY_REPAIR,\n\tCPR_ACT_WORK_TIME,\n\tCPR_EST_TOTAL_PPY,\n\tCPR_EST_PPY_NEW,\n\tCPR_EST_REP_AMT,\n\tCPR_ACT_TOTAL_LOSS,\n\tCPR_ACT_PPY_NEW,\n\tCPR_ACT_REP_AMT,\n\tCPR_ACT_TOT_PPY,\n\tCPR_ACT_WORK_AMT,\n\tCPR_EST_WORK_AMT,\n\tCPR_OTHER_PPY_ID,\n\tCPR_DAM_MAC_CD,\n\tCPR_MUL_USERS_IND,\n\tCPR_ACL_MAT_AMT,\n\tCPR_EST_MAT_AMT,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_PROPERTY_LOSS_STAGE\n),\nARCH_PROPERTY_LOSS_STAGE AS (\n\tINSERT INTO ARCH_PROPERTY_LOSS_STAGE\n\t(PROPERTY_LOSS_ID, CPR_CLAIM_NBR, CPR_OBJECT_TYPE_CD, CPR_OBJECT_SEQ_NBR, CPR_PPY_DES_ID, CPR_BEF_LOSS_AMT, CPR_AGREE_ACT_IND, CPR_EST_TOTAL_LOSS, CPR_PURCHASED_AMT, CPR_EST_DAY_REPAIR, CPR_PURPOSE_USE_ID, CPR_PHD_OWN_IND, CPR_ENTRY_OPR_ID, CPR_UPDATE_OPR_ID, CPR_CREATE_TS, CPR_PMSD_TS, CPR_UPD_TS, CPR_WHEN_SEE_ID, CPR_PPY_LOC_ID, CPR_DAMAGE_DES_ID, CPR_MSC_PPY_IND, CPR_ISU_OWNER_IND, CPR_BODILY_INJ_NBR, CPR_FATALITY_NBR, CPR_REAL_VALUE_AMT, CPR_CAUSE_OF_FIRE, CPR_BURNING_MAT_CD, CPR_LEAKING_LIQUID, CPR_LKG_DAM_PLC_CD, CPR_PURCHASE_DT, CPR_CUR_VAL_AMT, CPR_EST_WORK_TIME, CPR_ACT_DAY_REPAIR, CPR_ACT_WORK_TIME, CPR_EST_TOTAL_PPY, CPR_EST_PPY_NEW, CPR_EST_REP_AMT, CPR_ACT_TOTAL_LOSS, CPR_ACT_PPY_NEW, CPR_ACT_REP_AMT, CPR_ACT_TOT_PPY, CPR_ACT_WORK_AMT, CPR_EST_WORK_AMT, CPR_OTHER_PPY_ID, CPR_DAM_MAC_CD, CPR_MUL_USERS_IND, CPR_ACL_MAT_AMT, CPR_EST_MAT_AMT, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)\n\tSELECT \n\tPROPERTY_LOSS_ID, \n\tCPR_CLAIM_NBR, \n\tCPR_OBJECT_TYPE_CD, \n\tCPR_OBJECT_SEQ_NBR, \n\tCPR_PPY_DES_ID, \n\tCPR_BEF_LOSS_AMT, \n\tCPR_AGREE_ACT_IND, \n\tCPR_EST_TOTAL_LOSS, \n\tCPR_PURCHASED_AMT, \n\tCPR_EST_DAY_REPAIR, \n\tCPR_PURPOSE_USE_ID, \n\tCPR_PHD_OWN_IND, \n\tCPR_ENTRY_OPR_ID, \n\tCPR_UPDATE_OPR_ID, \n\tCPR_CREATE_TS, \n\tCPR_PMSD_TS, \n\tCPR_UPD_TS, \n\tCPR_WHEN_SEE_ID, \n\tCPR_PPY_LOC_ID, \n\tCPR_DAMAGE_DES_ID, \n\tCPR_MSC_PPY_IND, \n\tCPR_ISU_OWNER_IND, \n\tCPR_BODILY_INJ_NBR, \n\tCPR_FATALITY_NBR, \n\tCPR_REAL_VALUE_AMT, \n\tCPR_CAUSE_OF_FIRE, \n\tCPR_BURNING_MAT_CD, \n\tCPR_LEAKING_LIQUID, \n\tCPR_LKG_DAM_PLC_CD, \n\tCPR_PURCHASE_DT, \n\tCPR_CUR_VAL_AMT, \n\tCPR_EST_WORK_TIME, \n\tCPR_ACT_DAY_REPAIR, \n\tCPR_ACT_WORK_TIME, \n\tCPR_EST_TOTAL_PPY, \n\tCPR_EST_PPY_NEW, \n\tCPR_EST_REP_AMT, \n\tCPR_ACT_TOTAL_LOSS, \n\tCPR_ACT_PPY_NEW, \n\tCPR_ACT_REP_AMT, \n\tCPR_ACT_TOT_PPY, \n\tCPR_ACT_WORK_AMT, \n\tCPR_EST_WORK_AMT, \n\tCPR_OTHER_PPY_ID, \n\tCPR_DAM_MAC_CD, \n\tCPR_MUL_USERS_IND, \n\tCPR_ACL_MAT_AMT, \n\tCPR_EST_MAT_AMT, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_PROPERTY_LOSS_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsStaging/"
        },
        "annotations": []
    }
}