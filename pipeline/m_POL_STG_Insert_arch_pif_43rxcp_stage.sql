WITH
SQ_Pif43RXCPStage AS (
	SELECT
		Pif43RXCPStageId,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		Pmdrxp1RecLength,
		Pmdrxp1ActionCode,
		Pmdrxp1FileId,
		Pmdrxp1SegmentId,
		Pmdrxp1SegmentStatus,
		Pmdrxp1YearTransaction,
		Pmdrxp1MonthTransaction,
		Pmdrxp1DayTransaction,
		Pmdrxp1SegmentLevelCode,
		Pmdrxp1SegmentPartCode,
		Pmdrxp1SubPartCode,
		Pmdrxp1InsuranceLine,
		Pmdrxp1LocationNumber,
		Pmdrxp1SubLocationNumber,
		Pmdrxp1PmsDefSubjOfIns,
		Pmdrxp1YearItemEffective,
		Pmdrxp1MonthItemEffective,
		Pmdrxp1DayItemEffective,
		Pmdrxp1PeakSeasonIndicator,
		Pmdrxp1YearProcess,
		Pmdrxp1MonthProcess,
		Pmdrxp1DayProcess,
		Pmdrxp1RatingState,
		Pmdrxp1Territory,
		Pmdrxp1ReportingFrequency,
		Pmdrxp1ContentReportingPct,
		Pmdrxp1AmountOfInsurance,
		Pmdrxp1PmaCode,
		Pmdrxp1CspClsCode,
		Pmdrxp1ClsDescCode,
		Pmdrxp1ClassDescSource,
		Pmdrxp1RatePlan,
		Pmdrxp1BldgCspClsCode,
		Pmdrxp1Deductible,
		Pmdrxp1CoinsurancePercent,
		Pmdrxp1YearCvgExpir,
		Pmdrxp1MonthCvgExpir,
		Pmdrxp1DayCvgExpir,
		Pmdrxp1UmCvgTypeInd,
		Pmdrxp1RntlValMonthlyLim,
		Pmdrxp1MonthSeasIncept,
		Pmdrxp1DaySeasIncept,
		Pmdrxp1MonthSeasExpir,
		Pmdrxp1DaySeasExpir,
		Pmdrxp1SprinklerLeakage,
		Pmdrxp1Vandalism,
		Pmdrxp1WindAndHail,
		Pmdrxp1AgreedValueInd,
		Pmdrxp1CoverageCodes,
		Pmdrxp1TheftExclusionInd,
		Pmdrxp1RateGroup,
		Pmdrxp1InfoVariableByState,
		Pmdrxp1StatementValues,
		Pmdrxp1AcqLocDolLim,
		Pmdrxp1InflGdPctAnnInc,
		Pmdrxp1TotContrIns,
		Pmdrxp1ReplCostInd,
		Pmdrxp1OrdPayrollLimitation,
		Pmdrxp1ExtExpCovCode,
		Pmdrxp1TypeOfBusInd,
		Pmdrxp1MaxPeriodIndemnity,
		Pmdrxp1OrdPayrollExclusion,
		Pmdrxp1MonthlyLimitation,
		Pmdrxp1ExtPeriodIndemnity,
		Pmdrxp1BldRiskInd,
		Pmdrxp1DependentPropInd,
		Pmdrxp1DeductibleCode,
		Pmdrxp1OtherDeductible,
		Pmdrxp1TrailerCntsAddlPrem,
		Pmdrxp1WhDeductibleFactor,
		Pmdrxp1DecChangeFlag,
		Pmdrxp1SpecFmClassLimit,
		Pmdrxp1SpecFmClsInd,
		Pmdrxp1RateGroupInd,
		Pmdrxp1PmaInd,
		Pmdrxp1RerateImInd,
		Pmdrxp1BusncExcExpInd,
		Pmdrxp1BlrskExcCollpInd,
		Pmdrxp1SubOfIns,
		Pmdrxp1VacancyPeakInd,
		Pmdrxp1MineSubLimit,
		Pmdrxp1PolicyExemptInd,
		Pmdrxp1TenantImprvmntInd,
		Pmdrxp1SprinkLeakExcFctr,
		Pmdrxp1AcctsReceivFact,
		Pmdrxp1ValPapersFact,
		Pmdrxp1ValPapLoadFact,
		Pmdrxp1PmscFutureUse,
		Pmdrxp1CondoCode,
		Pmdrxp1OffUtility,
		Pmdrxp1OffCovOption,
		Pmdrxp1ClassTabInd,
		Pmdrxp1EqPremExtra,
		Pmdrxp1PgPremExtra,
		Pmdrxp1FcPremExtra,
		Pmdrxp1SdPremExtra,
		Pmdrxp1WbPremExtra,
		Pmdrxp1AnimalsBaseRate,
		Pmdrxp1AnimalsPremTerm,
		Pmdrxp1TxEcTerr,
		Pmdrxp1TxPlaceCode,
		Pmdrxp1KeyContClass,
		Pmdrxp1TxCounty,
		Pmdrxp1StatClassCode,
		Pmdrxp1TerrorismAmtIns,
		Pmdrxp1BusinessClass,
		Pmdrxp1CspClsOver,
		Pmdrxp1BldClsOver,
		Pmdrxp1Rcp,
		Pmdrxp1Str,
		Pmdrxp1Spr,
		Pmdrxp1PpPremExtra,
		Pmdrxp1EqSpPremExtra,
		Pmdrxp1AnimalPremExtra,
		Pmdrxp1LossasPremExtra,
		Pmdrxp1MisrepPremExtra,
		Pmdrxp1RecDelInd,
		Pmdrxp1Yr2000CustUse,
		Pmdrxp1WbcKey,
		ExtractDate,
		AsOfDate,
		RecordCount,
		SourceSystemId
	FROM Pif43RXCPStage
),
EXP_VALUES AS (
	SELECT
	Pif43RXCPStageId,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	Pmdrxp1RecLength,
	Pmdrxp1ActionCode,
	Pmdrxp1FileId,
	Pmdrxp1SegmentId,
	Pmdrxp1SegmentStatus,
	Pmdrxp1YearTransaction,
	Pmdrxp1MonthTransaction,
	Pmdrxp1DayTransaction,
	Pmdrxp1SegmentLevelCode,
	Pmdrxp1SegmentPartCode,
	Pmdrxp1SubPartCode,
	Pmdrxp1InsuranceLine,
	Pmdrxp1LocationNumber,
	Pmdrxp1SubLocationNumber,
	Pmdrxp1PmsDefSubjOfIns,
	Pmdrxp1YearItemEffective,
	Pmdrxp1MonthItemEffective,
	Pmdrxp1DayItemEffective,
	Pmdrxp1PeakSeasonIndicator,
	Pmdrxp1YearProcess,
	Pmdrxp1MonthProcess,
	Pmdrxp1DayProcess,
	Pmdrxp1RatingState,
	Pmdrxp1Territory,
	Pmdrxp1ReportingFrequency,
	Pmdrxp1ContentReportingPct,
	Pmdrxp1AmountOfInsurance,
	Pmdrxp1PmaCode,
	Pmdrxp1CspClsCode,
	Pmdrxp1ClsDescCode,
	Pmdrxp1ClassDescSource,
	Pmdrxp1RatePlan,
	Pmdrxp1BldgCspClsCode,
	Pmdrxp1Deductible,
	Pmdrxp1CoinsurancePercent,
	Pmdrxp1YearCvgExpir,
	Pmdrxp1MonthCvgExpir,
	Pmdrxp1DayCvgExpir,
	Pmdrxp1UmCvgTypeInd,
	Pmdrxp1RntlValMonthlyLim,
	Pmdrxp1MonthSeasIncept,
	Pmdrxp1DaySeasIncept,
	Pmdrxp1MonthSeasExpir,
	Pmdrxp1DaySeasExpir,
	Pmdrxp1SprinklerLeakage,
	Pmdrxp1Vandalism,
	Pmdrxp1WindAndHail,
	Pmdrxp1AgreedValueInd,
	Pmdrxp1CoverageCodes,
	Pmdrxp1TheftExclusionInd,
	Pmdrxp1RateGroup,
	Pmdrxp1InfoVariableByState,
	Pmdrxp1StatementValues,
	Pmdrxp1AcqLocDolLim,
	Pmdrxp1InflGdPctAnnInc,
	Pmdrxp1TotContrIns,
	Pmdrxp1ReplCostInd,
	Pmdrxp1OrdPayrollLimitation,
	Pmdrxp1ExtExpCovCode,
	Pmdrxp1TypeOfBusInd,
	Pmdrxp1MaxPeriodIndemnity,
	Pmdrxp1OrdPayrollExclusion,
	Pmdrxp1MonthlyLimitation,
	Pmdrxp1ExtPeriodIndemnity,
	Pmdrxp1BldRiskInd,
	Pmdrxp1DependentPropInd,
	Pmdrxp1DeductibleCode,
	Pmdrxp1OtherDeductible,
	Pmdrxp1TrailerCntsAddlPrem,
	Pmdrxp1WhDeductibleFactor,
	Pmdrxp1DecChangeFlag,
	Pmdrxp1SpecFmClassLimit,
	Pmdrxp1SpecFmClsInd,
	Pmdrxp1RateGroupInd,
	Pmdrxp1PmaInd,
	Pmdrxp1RerateImInd,
	Pmdrxp1BusncExcExpInd,
	Pmdrxp1BlrskExcCollpInd,
	Pmdrxp1SubOfIns,
	Pmdrxp1VacancyPeakInd,
	Pmdrxp1MineSubLimit,
	Pmdrxp1PolicyExemptInd,
	Pmdrxp1TenantImprvmntInd,
	Pmdrxp1SprinkLeakExcFctr,
	Pmdrxp1AcctsReceivFact,
	Pmdrxp1ValPapersFact,
	Pmdrxp1ValPapLoadFact,
	Pmdrxp1PmscFutureUse,
	Pmdrxp1CondoCode,
	Pmdrxp1OffUtility,
	Pmdrxp1OffCovOption,
	Pmdrxp1ClassTabInd,
	Pmdrxp1EqPremExtra,
	Pmdrxp1PgPremExtra,
	Pmdrxp1FcPremExtra,
	Pmdrxp1SdPremExtra,
	Pmdrxp1WbPremExtra,
	Pmdrxp1AnimalsBaseRate,
	Pmdrxp1AnimalsPremTerm,
	Pmdrxp1TxEcTerr,
	Pmdrxp1TxPlaceCode,
	Pmdrxp1KeyContClass,
	Pmdrxp1TxCounty,
	Pmdrxp1StatClassCode,
	Pmdrxp1TerrorismAmtIns,
	Pmdrxp1BusinessClass,
	Pmdrxp1CspClsOver,
	Pmdrxp1BldClsOver,
	Pmdrxp1Rcp,
	Pmdrxp1Str,
	Pmdrxp1Spr,
	Pmdrxp1PpPremExtra,
	Pmdrxp1EqSpPremExtra,
	Pmdrxp1AnimalPremExtra,
	Pmdrxp1LossasPremExtra,
	Pmdrxp1MisrepPremExtra,
	Pmdrxp1RecDelInd,
	Pmdrxp1Yr2000CustUse,
	Pmdrxp1WbcKey,
	ExtractDate,
	AsOfDate,
	RecordCount,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_Pif43RXCPStage
),
TGT_ArchPif43RXCPStage_INSERT AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43RXCPStage
	(Pif43RXCPStageId, PifSymbol, PifPolicyNumber, PifModule, Pmdrxp1RecLength, Pmdrxp1ActionCode, Pmdrxp1FileId, Pmdrxp1SegmentId, Pmdrxp1SegmentStatus, Pmdrxp1YearTransaction, Pmdrxp1MonthTransaction, Pmdrxp1DayTransaction, Pmdrxp1SegmentLevelCode, Pmdrxp1SegmentPartCode, Pmdrxp1SubPartCode, Pmdrxp1InsuranceLine, Pmdrxp1LocationNumber, Pmdrxp1SubLocationNumber, Pmdrxp1PmsDefSubjOfIns, Pmdrxp1YearItemEffective, Pmdrxp1MonthItemEffective, Pmdrxp1DayItemEffective, Pmdrxp1PeakSeasonIndicator, Pmdrxp1YearProcess, Pmdrxp1MonthProcess, Pmdrxp1DayProcess, Pmdrxp1RatingState, Pmdrxp1Territory, Pmdrxp1ReportingFrequency, Pmdrxp1ContentReportingPct, Pmdrxp1AmountOfInsurance, Pmdrxp1PmaCode, Pmdrxp1CspClsCode, Pmdrxp1ClsDescCode, Pmdrxp1ClassDescSource, Pmdrxp1RatePlan, Pmdrxp1BldgCspClsCode, Pmdrxp1Deductible, Pmdrxp1CoinsurancePercent, Pmdrxp1YearCvgExpir, Pmdrxp1MonthCvgExpir, Pmdrxp1DayCvgExpir, Pmdrxp1UmCvgTypeInd, Pmdrxp1RntlValMonthlyLim, Pmdrxp1MonthSeasIncept, Pmdrxp1DaySeasIncept, Pmdrxp1MonthSeasExpir, Pmdrxp1DaySeasExpir, Pmdrxp1SprinklerLeakage, Pmdrxp1Vandalism, Pmdrxp1WindAndHail, Pmdrxp1AgreedValueInd, Pmdrxp1CoverageCodes, Pmdrxp1TheftExclusionInd, Pmdrxp1RateGroup, Pmdrxp1InfoVariableByState, Pmdrxp1StatementValues, Pmdrxp1AcqLocDolLim, Pmdrxp1InflGdPctAnnInc, Pmdrxp1TotContrIns, Pmdrxp1ReplCostInd, Pmdrxp1OrdPayrollLimitation, Pmdrxp1ExtExpCovCode, Pmdrxp1TypeOfBusInd, Pmdrxp1MaxPeriodIndemnity, Pmdrxp1OrdPayrollExclusion, Pmdrxp1MonthlyLimitation, Pmdrxp1ExtPeriodIndemnity, Pmdrxp1BldRiskInd, Pmdrxp1DependentPropInd, Pmdrxp1DeductibleCode, Pmdrxp1OtherDeductible, Pmdrxp1TrailerCntsAddlPrem, Pmdrxp1WhDeductibleFactor, Pmdrxp1DecChangeFlag, Pmdrxp1SpecFmClassLimit, Pmdrxp1SpecFmClsInd, Pmdrxp1RateGroupInd, Pmdrxp1PmaInd, Pmdrxp1RerateImInd, Pmdrxp1BusncExcExpInd, Pmdrxp1BlrskExcCollpInd, Pmdrxp1SubOfIns, Pmdrxp1VacancyPeakInd, Pmdrxp1MineSubLimit, Pmdrxp1PolicyExemptInd, Pmdrxp1TenantImprvmntInd, Pmdrxp1SprinkLeakExcFctr, Pmdrxp1AcctsReceivFact, Pmdrxp1ValPapersFact, Pmdrxp1ValPapLoadFact, Pmdrxp1PmscFutureUse, Pmdrxp1CondoCode, Pmdrxp1OffUtility, Pmdrxp1OffCovOption, Pmdrxp1ClassTabInd, Pmdrxp1EqPremExtra, Pmdrxp1PgPremExtra, Pmdrxp1FcPremExtra, Pmdrxp1SdPremExtra, Pmdrxp1WbPremExtra, Pmdrxp1AnimalsBaseRate, Pmdrxp1AnimalsPremTerm, Pmdrxp1TxEcTerr, Pmdrxp1TxPlaceCode, Pmdrxp1KeyContClass, Pmdrxp1TxCounty, Pmdrxp1StatClassCode, Pmdrxp1TerrorismAmtIns, Pmdrxp1BusinessClass, Pmdrxp1CspClsOver, Pmdrxp1BldClsOver, Pmdrxp1Rcp, Pmdrxp1Str, Pmdrxp1Spr, Pmdrxp1PpPremExtra, Pmdrxp1EqSpPremExtra, Pmdrxp1AnimalPremExtra, Pmdrxp1LossasPremExtra, Pmdrxp1MisrepPremExtra, Pmdrxp1RecDelInd, Pmdrxp1Yr2000CustUse, Pmdrxp1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)
	SELECT 
	PIF43RXCPSTAGEID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDRXP1RECLENGTH, 
	PMDRXP1ACTIONCODE, 
	PMDRXP1FILEID, 
	PMDRXP1SEGMENTID, 
	PMDRXP1SEGMENTSTATUS, 
	PMDRXP1YEARTRANSACTION, 
	PMDRXP1MONTHTRANSACTION, 
	PMDRXP1DAYTRANSACTION, 
	PMDRXP1SEGMENTLEVELCODE, 
	PMDRXP1SEGMENTPARTCODE, 
	PMDRXP1SUBPARTCODE, 
	PMDRXP1INSURANCELINE, 
	PMDRXP1LOCATIONNUMBER, 
	PMDRXP1SUBLOCATIONNUMBER, 
	PMDRXP1PMSDEFSUBJOFINS, 
	PMDRXP1YEARITEMEFFECTIVE, 
	PMDRXP1MONTHITEMEFFECTIVE, 
	PMDRXP1DAYITEMEFFECTIVE, 
	PMDRXP1PEAKSEASONINDICATOR, 
	PMDRXP1YEARPROCESS, 
	PMDRXP1MONTHPROCESS, 
	PMDRXP1DAYPROCESS, 
	PMDRXP1RATINGSTATE, 
	PMDRXP1TERRITORY, 
	PMDRXP1REPORTINGFREQUENCY, 
	PMDRXP1CONTENTREPORTINGPCT, 
	PMDRXP1AMOUNTOFINSURANCE, 
	PMDRXP1PMACODE, 
	PMDRXP1CSPCLSCODE, 
	PMDRXP1CLSDESCCODE, 
	PMDRXP1CLASSDESCSOURCE, 
	PMDRXP1RATEPLAN, 
	PMDRXP1BLDGCSPCLSCODE, 
	PMDRXP1DEDUCTIBLE, 
	PMDRXP1COINSURANCEPERCENT, 
	PMDRXP1YEARCVGEXPIR, 
	PMDRXP1MONTHCVGEXPIR, 
	PMDRXP1DAYCVGEXPIR, 
	PMDRXP1UMCVGTYPEIND, 
	PMDRXP1RNTLVALMONTHLYLIM, 
	PMDRXP1MONTHSEASINCEPT, 
	PMDRXP1DAYSEASINCEPT, 
	PMDRXP1MONTHSEASEXPIR, 
	PMDRXP1DAYSEASEXPIR, 
	PMDRXP1SPRINKLERLEAKAGE, 
	PMDRXP1VANDALISM, 
	PMDRXP1WINDANDHAIL, 
	PMDRXP1AGREEDVALUEIND, 
	PMDRXP1COVERAGECODES, 
	PMDRXP1THEFTEXCLUSIONIND, 
	PMDRXP1RATEGROUP, 
	PMDRXP1INFOVARIABLEBYSTATE, 
	PMDRXP1STATEMENTVALUES, 
	PMDRXP1ACQLOCDOLLIM, 
	PMDRXP1INFLGDPCTANNINC, 
	PMDRXP1TOTCONTRINS, 
	PMDRXP1REPLCOSTIND, 
	PMDRXP1ORDPAYROLLLIMITATION, 
	PMDRXP1EXTEXPCOVCODE, 
	PMDRXP1TYPEOFBUSIND, 
	PMDRXP1MAXPERIODINDEMNITY, 
	PMDRXP1ORDPAYROLLEXCLUSION, 
	PMDRXP1MONTHLYLIMITATION, 
	PMDRXP1EXTPERIODINDEMNITY, 
	PMDRXP1BLDRISKIND, 
	PMDRXP1DEPENDENTPROPIND, 
	PMDRXP1DEDUCTIBLECODE, 
	PMDRXP1OTHERDEDUCTIBLE, 
	PMDRXP1TRAILERCNTSADDLPREM, 
	PMDRXP1WHDEDUCTIBLEFACTOR, 
	PMDRXP1DECCHANGEFLAG, 
	PMDRXP1SPECFMCLASSLIMIT, 
	PMDRXP1SPECFMCLSIND, 
	PMDRXP1RATEGROUPIND, 
	PMDRXP1PMAIND, 
	PMDRXP1RERATEIMIND, 
	PMDRXP1BUSNCEXCEXPIND, 
	PMDRXP1BLRSKEXCCOLLPIND, 
	PMDRXP1SUBOFINS, 
	PMDRXP1VACANCYPEAKIND, 
	PMDRXP1MINESUBLIMIT, 
	PMDRXP1POLICYEXEMPTIND, 
	PMDRXP1TENANTIMPRVMNTIND, 
	PMDRXP1SPRINKLEAKEXCFCTR, 
	PMDRXP1ACCTSRECEIVFACT, 
	PMDRXP1VALPAPERSFACT, 
	PMDRXP1VALPAPLOADFACT, 
	PMDRXP1PMSCFUTUREUSE, 
	PMDRXP1CONDOCODE, 
	PMDRXP1OFFUTILITY, 
	PMDRXP1OFFCOVOPTION, 
	PMDRXP1CLASSTABIND, 
	PMDRXP1EQPREMEXTRA, 
	PMDRXP1PGPREMEXTRA, 
	PMDRXP1FCPREMEXTRA, 
	PMDRXP1SDPREMEXTRA, 
	PMDRXP1WBPREMEXTRA, 
	PMDRXP1ANIMALSBASERATE, 
	PMDRXP1ANIMALSPREMTERM, 
	PMDRXP1TXECTERR, 
	PMDRXP1TXPLACECODE, 
	PMDRXP1KEYCONTCLASS, 
	PMDRXP1TXCOUNTY, 
	PMDRXP1STATCLASSCODE, 
	PMDRXP1TERRORISMAMTINS, 
	PMDRXP1BUSINESSCLASS, 
	PMDRXP1CSPCLSOVER, 
	PMDRXP1BLDCLSOVER, 
	PMDRXP1RCP, 
	PMDRXP1STR, 
	PMDRXP1SPR, 
	PMDRXP1PPPREMEXTRA, 
	PMDRXP1EQSPPREMEXTRA, 
	PMDRXP1ANIMALPREMEXTRA, 
	PMDRXP1LOSSASPREMEXTRA, 
	PMDRXP1MISREPPREMEXTRA, 
	PMDRXP1RECDELIND, 
	PMDRXP1YR2000CUSTUSE, 
	PMDRXP1WBCKEY, 
	EXTRACTDATE, 
	ASOFDATE, 
	RECORDCOUNT, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_VALUES
),