{
    "name": "s_m_CLM_ARCH_Insert_PIF_42GP_STAGE",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_PIF_42GP_STAGE",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PIF_42GP_stage AS (\n\tSELECT\n\t\tpif_42gp_stage_id AS PIF_42GP_stage_id,\n\t\tpif_symbol AS PIF_SYMBOL,\n\t\tpif_policy_number AS PIF_POLICY_NUMBER,\n\t\tpif_module AS PIF_MODULE,\n\t\tipfcgp_rec_length AS IPFCGP_REC_LENGTH,\n\t\tipfcgp_action_code AS IPFCGP_ACTION_CODE,\n\t\tipfcgp_file_id AS IPFCGP_FILE_ID,\n\t\tipfcgp_segment_id AS IPFCGP_SEGMENT_ID,\n\t\tipfcgp_segment_level_code AS IPFCGP_SEGMENT_LEVEL_CODE,\n\t\tipfcgp_segment_part_code AS IPFCGP_SEGMENT_PART_CODE,\n\t\tipfcgp_sub_part_code AS IPFCGP_SUB_PART_CODE,\n\t\tipfcgp_year_of_loss AS IPFCGP_YEAR_OF_LOSS,\n\t\tipfcgp_month_of_loss AS IPFCGP_MONTH_OF_LOSS,\n\t\tipfcgp_day_of_loss AS IPFCGP_DAY_OF_LOSS,\n\t\tipfcgp_loss_occurence AS IPFCGP_LOSS_OCCURENCE,\n\t\tipfcgp_year_process AS IPFCGP_YEAR_PROCESS,\n\t\tipfcgp_month_process AS IPFCGP_MONTH_PROCESS,\n\t\tipfcgp_day_process AS IPFCGP_DAY_PROCESS,\n\t\tipfcgp_year_change_entry AS IPFCGP_YEAR_CHANGE_ENTRY,\n\t\tipfcgp_month_change_entry AS IPFCGP_MONTH_CHANGE_ENTRY,\n\t\tipfcgp_day_change_entry AS IPFCGP_DAY_CHANGE_ENTRY,\n\t\tipfcgp_sequence_change_entry AS IPFCGP_SEQUENCE_CHANGE_ENTRY,\n\t\tipfcgp_segment_status AS IPFCGP_SEGMENT_STATUS,\n\t\tipfcgp_entry_operator AS IPFCGP_ENTRY_OPERATOR,\n\t\tipfcgp_reinsurance_indicator AS IPFCGP_REINSURANCE_INDICATOR,\n\t\tipfcgp_loss_adjustor_no AS IPFCGP_LOSS_ADJUSTOR_NO,\n\t\tipfcgp_loss_examiner AS IPFCGP_LOSS_EXAMINER,\n\t\tipfcgp_other_assignment AS IPFCGP_OTHER_ASSIGNMENT,\n\t\tipfcgp_account_entered_date AS IPFCGP_ACCOUNT_ENTERED_DATE,\n\t\tipfcgp_loss_handling_office AS IPFCGP_LOSS_HANDLING_OFFICE,\n\t\tipfcgp_loss_handling_branch AS IPFCGP_LOSS_HANDLING_BRANCH,\n\t\tipfcgp_loss_plant_location AS IPFCGP_LOSS_PLANT_LOCATION,\n\t\tipfcgp_loss_accident_state AS IPFCGP_LOSS_ACCIDENT_STATE,\n\t\tipfcgp_loss_catastrophe_no AS IPFCGP_LOSS_CATASTROPHE_NO,\n\t\tipfcgp_excess_catastrophe AS IPFCGP_EXCESS_CATASTROPHE,\n\t\tipfcgp_company_year AS IPFCGP_COMPANY_YEAR,\n\t\tipfcgp_company_month AS IPFCGP_COMPANY_MONTH,\n\t\tipfcgp_company_day AS IPFCGP_COMPANY_DAY,\n\t\tipfcgp_loss_time,\n\t\tipfcgp_loss_day AS IPFCGP_LOSS_DAY,\n\t\tipfcgp_police_authority AS IPFCGP_POLICE_AUTHORITY,\n\t\tipfcgp_agent_received_year AS IPFCGP_AGENT_RECEIVED_YEAR,\n\t\tipfcgp_agent_received_month AS IPFCGP_AGENT_RECEIVED_MONTH,\n\t\tipfcgp_agent_received_day AS IPFCGP_AGENT_RECEIVED_DAY,\n\t\tipfcgp_bulk_claimant_count AS IPFCGP_BULK_CLAIMANT_COUNT,\n\t\tipfcgp_discovery_year AS IPFCGP_DISCOVERY_YEAR,\n\t\tipfcgp_discovery_month AS IPFCGP_DISCOVERY_MONTH,\n\t\tipfcgp_discovery_day AS IPFCGP_DISCOVERY_DAY,\n\t\tipfcgp_claim_number AS IPFCGP_CLAIM_NUMBER,\n\t\tipfcgp_claim_filler AS IPFCGP_CLAIM_FILLER,\n\t\tipfcgp_excess_loss_ind AS IPFCGP_EXCESS_LOSS_IND,\n\t\tipfcgp_claim_status AS IPFCGP_CLAIM_STATUS,\n\t\tipfcgp_loss_original_reserve AS IPFCGP_LOSS_ORIGINAL_RESERVE,\n\t\tipfcgp_os_loss_reserve AS IPFCGP_OS_LOSS_RESERVE,\n\t\tipfcgp_os_expense_reserve AS IPFCGP_OS_EXPENSE_RESERVE,\n\t\tipfcgp_total_loss AS IPFCGP_TOTAL_LOSS,\n\t\tipfcgp_total_expense AS IPFCGP_TOTAL_EXPENSE,\n\t\tipfcgp_total_recoveries AS IPFCGP_TOTAL_RECOVERIES,\n\t\tipfcgp_beg_os_loss_reserve AS IPFCGP_BEG_OS_LOSS_RESERVE,\n\t\tipfcgp_accident_description AS IPFCGP_ACCIDENT_DESCRIPTION,\n\t\tipfcgp_number_of_part78 AS IPFCGP_NUMBER_OF_PART78,\n\t\tipfcgp_notice_of_occurrence AS IPFCGP_NOTICE_OF_OCCURRENCE,\n\t\tipfcgp_offset_onset_ind AS IPFCGP_OFFSET_ONSET_IND,\n\t\tipfcgp_master_claim_number AS IPFCGP_MASTER_CLAIM_NUMBER,\n\t\tipfcgp_processing_location AS IPFCGP_PROCESSING_LOCATION,\n\t\tipfcgp_crime_zip_basic AS IPFCGP_CRIME_ZIP_BASIC,\n\t\tipfcgp_crime_zip_expanded AS IPFCGP_CRIME_ZIP_EXPANDED,\n\t\tipfcgp_cr_sub_line AS IPFCGP_CR_SUB_LINE,\n\t\tipfcgp_pms_future_use_gp AS IPFCGP_PMS_FUTURE_USE_GP,\n\t\tipfcgp_direct_reporting AS IPFCGP_DIRECT_REPORTING,\n\t\tipfcgp_litigated_savings AS IPFCGP_LITIGATED_SAVINGS,\n\t\tipfcgp_cust_spl_use_gp AS IPFCGP_CUST_SPL_USE_GP,\n\t\tipfcgp_yr2000_cust_use AS IPFCGP_YR2000_CUST_USE,\n\t\tinf_action,\n\t\tinf_timestamp,\n\t\tlogical_flag,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID\n\tFROM PIF_42GP_stage\n),\nEXP_arch_PIF_42GP_stage AS (\n\tSELECT\n\tPIF_42GP_stage_id,\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE,\n\tIPFCGP_REC_LENGTH,\n\tIPFCGP_ACTION_CODE,\n\tIPFCGP_FILE_ID,\n\tIPFCGP_SEGMENT_ID,\n\tIPFCGP_SEGMENT_LEVEL_CODE,\n\tIPFCGP_SEGMENT_PART_CODE,\n\tIPFCGP_SUB_PART_CODE,\n\tIPFCGP_YEAR_OF_LOSS,\n\tIPFCGP_MONTH_OF_LOSS,\n\tIPFCGP_DAY_OF_LOSS,\n\tIPFCGP_LOSS_OCCURENCE,\n\tIPFCGP_YEAR_PROCESS,\n\tIPFCGP_MONTH_PROCESS,\n\tIPFCGP_DAY_PROCESS,\n\tIPFCGP_YEAR_CHANGE_ENTRY,\n\tIPFCGP_MONTH_CHANGE_ENTRY,\n\tIPFCGP_DAY_CHANGE_ENTRY,\n\tIPFCGP_SEQUENCE_CHANGE_ENTRY,\n\tIPFCGP_SEGMENT_STATUS,\n\tIPFCGP_ENTRY_OPERATOR,\n\tIPFCGP_REINSURANCE_INDICATOR,\n\tIPFCGP_LOSS_ADJUSTOR_NO,\n\tIPFCGP_LOSS_EXAMINER,\n\tIPFCGP_OTHER_ASSIGNMENT,\n\tIPFCGP_ACCOUNT_ENTERED_DATE,\n\tIPFCGP_LOSS_HANDLING_OFFICE,\n\tIPFCGP_LOSS_HANDLING_BRANCH,\n\tIPFCGP_LOSS_PLANT_LOCATION,\n\tIPFCGP_LOSS_ACCIDENT_STATE,\n\tIPFCGP_LOSS_CATASTROPHE_NO,\n\tIPFCGP_EXCESS_CATASTROPHE,\n\tIPFCGP_COMPANY_YEAR,\n\tIPFCGP_COMPANY_MONTH,\n\tIPFCGP_COMPANY_DAY,\n\tIPFCGP_LOSS_DAY,\n\tipfcgp_loss_time,\n\tIPFCGP_POLICE_AUTHORITY,\n\tIPFCGP_AGENT_RECEIVED_YEAR,\n\tIPFCGP_AGENT_RECEIVED_MONTH,\n\tIPFCGP_AGENT_RECEIVED_DAY,\n\tIPFCGP_BULK_CLAIMANT_COUNT,\n\tIPFCGP_DISCOVERY_YEAR,\n\tIPFCGP_DISCOVERY_MONTH,\n\tIPFCGP_DISCOVERY_DAY,\n\tIPFCGP_CLAIM_NUMBER,\n\tIPFCGP_CLAIM_FILLER,\n\tIPFCGP_EXCESS_LOSS_IND,\n\tIPFCGP_CLAIM_STATUS,\n\tIPFCGP_LOSS_ORIGINAL_RESERVE,\n\tIPFCGP_OS_LOSS_RESERVE,\n\tIPFCGP_OS_EXPENSE_RESERVE,\n\tIPFCGP_TOTAL_LOSS,\n\tIPFCGP_TOTAL_EXPENSE,\n\tIPFCGP_TOTAL_RECOVERIES,\n\tIPFCGP_BEG_OS_LOSS_RESERVE,\n\tIPFCGP_ACCIDENT_DESCRIPTION,\n\tIPFCGP_NUMBER_OF_PART78,\n\tIPFCGP_NOTICE_OF_OCCURRENCE,\n\tIPFCGP_OFFSET_ONSET_IND,\n\tIPFCGP_MASTER_CLAIM_NUMBER,\n\tIPFCGP_PROCESSING_LOCATION,\n\tIPFCGP_CRIME_ZIP_BASIC,\n\tIPFCGP_CRIME_ZIP_EXPANDED,\n\tIPFCGP_CR_SUB_LINE,\n\tIPFCGP_PMS_FUTURE_USE_GP,\n\tIPFCGP_DIRECT_REPORTING,\n\tIPFCGP_LITIGATED_SAVINGS,\n\tIPFCGP_CUST_SPL_USE_GP,\n\tIPFCGP_YR2000_CUST_USE,\n\tinf_action,\n\tinf_timestamp,\n\tlogical_flag,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_PIF_42GP_stage\n),\narch_PIF_42GP_stage AS (\n\tINSERT INTO arch_PIF_42GP_stage\n\t(pif_42gp_stage_id, pif_symbol, pif_policy_number, pif_module, ipfcgp_rec_length, ipfcgp_action_code, ipfcgp_file_id, ipfcgp_segment_id, ipfcgp_segment_level_code, ipfcgp_segment_part_code, ipfcgp_sub_part_code, ipfcgp_year_of_loss, ipfcgp_month_of_loss, ipfcgp_day_of_loss, ipfcgp_loss_occurence, ipfcgp_year_process, ipfcgp_month_process, ipfcgp_day_process, ipfcgp_year_change_entry, ipfcgp_month_change_entry, ipfcgp_day_change_entry, ipfcgp_sequence_change_entry, ipfcgp_segment_status, ipfcgp_entry_operator, ipfcgp_reinsurance_indicator, ipfcgp_loss_adjustor_no, ipfcgp_loss_examiner, ipfcgp_other_assignment, ipfcgp_account_entered_date, ipfcgp_loss_handling_office, ipfcgp_loss_handling_branch, ipfcgp_loss_plant_location, ipfcgp_loss_accident_state, ipfcgp_loss_catastrophe_no, ipfcgp_excess_catastrophe, ipfcgp_company_year, ipfcgp_company_month, ipfcgp_company_day, ipfcgp_loss_time, ipfcgp_loss_day, ipfcgp_police_authority, ipfcgp_agent_received_year, ipfcgp_agent_received_month, ipfcgp_agent_received_day, ipfcgp_bulk_claimant_count, ipfcgp_discovery_year, ipfcgp_discovery_month, ipfcgp_discovery_day, ipfcgp_claim_number, ipfcgp_claim_filler, ipfcgp_excess_loss_ind, ipfcgp_claim_status, ipfcgp_loss_original_reserve, ipfcgp_os_loss_reserve, ipfcgp_os_expense_reserve, ipfcgp_total_loss, ipfcgp_total_expense, ipfcgp_total_recoveries, ipfcgp_beg_os_loss_reserve, ipfcgp_accident_description, ipfcgp_number_of_part78, ipfcgp_notice_of_occurrence, ipfcgp_offset_onset_ind, ipfcgp_master_claim_number, ipfcgp_processing_location, ipfcgp_crime_zip_basic, ipfcgp_crime_zip_expanded, ipfcgp_cr_sub_line, ipfcgp_pms_future_use_gp, ipfcgp_direct_reporting, ipfcgp_litigated_savings, ipfcgp_cust_spl_use_gp, ipfcgp_yr2000_cust_use, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)\n\tSELECT \n\tPIF_42GP_stage_id AS PIF_42GP_STAGE_ID, \n\tPIF_SYMBOL AS PIF_SYMBOL, \n\tPIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, \n\tPIF_MODULE AS PIF_MODULE, \n\tIPFCGP_REC_LENGTH AS IPFCGP_REC_LENGTH, \n\tIPFCGP_ACTION_CODE AS IPFCGP_ACTION_CODE, \n\tIPFCGP_FILE_ID AS IPFCGP_FILE_ID, \n\tIPFCGP_SEGMENT_ID AS IPFCGP_SEGMENT_ID, \n\tIPFCGP_SEGMENT_LEVEL_CODE AS IPFCGP_SEGMENT_LEVEL_CODE, \n\tIPFCGP_SEGMENT_PART_CODE AS IPFCGP_SEGMENT_PART_CODE, \n\tIPFCGP_SUB_PART_CODE AS IPFCGP_SUB_PART_CODE, \n\tIPFCGP_YEAR_OF_LOSS AS IPFCGP_YEAR_OF_LOSS, \n\tIPFCGP_MONTH_OF_LOSS AS IPFCGP_MONTH_OF_LOSS, \n\tIPFCGP_DAY_OF_LOSS AS IPFCGP_DAY_OF_LOSS, \n\tIPFCGP_LOSS_OCCURENCE AS IPFCGP_LOSS_OCCURENCE, \n\tIPFCGP_YEAR_PROCESS AS IPFCGP_YEAR_PROCESS, \n\tIPFCGP_MONTH_PROCESS AS IPFCGP_MONTH_PROCESS, \n\tIPFCGP_DAY_PROCESS AS IPFCGP_DAY_PROCESS, \n\tIPFCGP_YEAR_CHANGE_ENTRY AS IPFCGP_YEAR_CHANGE_ENTRY, \n\tIPFCGP_MONTH_CHANGE_ENTRY AS IPFCGP_MONTH_CHANGE_ENTRY, \n\tIPFCGP_DAY_CHANGE_ENTRY AS IPFCGP_DAY_CHANGE_ENTRY, \n\tIPFCGP_SEQUENCE_CHANGE_ENTRY AS IPFCGP_SEQUENCE_CHANGE_ENTRY, \n\tIPFCGP_SEGMENT_STATUS AS IPFCGP_SEGMENT_STATUS, \n\tIPFCGP_ENTRY_OPERATOR AS IPFCGP_ENTRY_OPERATOR, \n\tIPFCGP_REINSURANCE_INDICATOR AS IPFCGP_REINSURANCE_INDICATOR, \n\tIPFCGP_LOSS_ADJUSTOR_NO AS IPFCGP_LOSS_ADJUSTOR_NO, \n\tIPFCGP_LOSS_EXAMINER AS IPFCGP_LOSS_EXAMINER, \n\tIPFCGP_OTHER_ASSIGNMENT AS IPFCGP_OTHER_ASSIGNMENT, \n\tIPFCGP_ACCOUNT_ENTERED_DATE AS IPFCGP_ACCOUNT_ENTERED_DATE, \n\tIPFCGP_LOSS_HANDLING_OFFICE AS IPFCGP_LOSS_HANDLING_OFFICE, \n\tIPFCGP_LOSS_HANDLING_BRANCH AS IPFCGP_LOSS_HANDLING_BRANCH, \n\tIPFCGP_LOSS_PLANT_LOCATION AS IPFCGP_LOSS_PLANT_LOCATION, \n\tIPFCGP_LOSS_ACCIDENT_STATE AS IPFCGP_LOSS_ACCIDENT_STATE, \n\tIPFCGP_LOSS_CATASTROPHE_NO AS IPFCGP_LOSS_CATASTROPHE_NO, \n\tIPFCGP_EXCESS_CATASTROPHE AS IPFCGP_EXCESS_CATASTROPHE, \n\tIPFCGP_COMPANY_YEAR AS IPFCGP_COMPANY_YEAR, \n\tIPFCGP_COMPANY_MONTH AS IPFCGP_COMPANY_MONTH, \n\tIPFCGP_COMPANY_DAY AS IPFCGP_COMPANY_DAY, \n\tIPFCGP_LOSS_TIME, \n\tIPFCGP_LOSS_DAY AS IPFCGP_LOSS_DAY, \n\tIPFCGP_POLICE_AUTHORITY AS IPFCGP_POLICE_AUTHORITY, \n\tIPFCGP_AGENT_RECEIVED_YEAR AS IPFCGP_AGENT_RECEIVED_YEAR, \n\tIPFCGP_AGENT_RECEIVED_MONTH AS IPFCGP_AGENT_RECEIVED_MONTH, \n\tIPFCGP_AGENT_RECEIVED_DAY AS IPFCGP_AGENT_RECEIVED_DAY, \n\tIPFCGP_BULK_CLAIMANT_COUNT AS IPFCGP_BULK_CLAIMANT_COUNT, \n\tIPFCGP_DISCOVERY_YEAR AS IPFCGP_DISCOVERY_YEAR, \n\tIPFCGP_DISCOVERY_MONTH AS IPFCGP_DISCOVERY_MONTH, \n\tIPFCGP_DISCOVERY_DAY AS IPFCGP_DISCOVERY_DAY, \n\tIPFCGP_CLAIM_NUMBER AS IPFCGP_CLAIM_NUMBER, \n\tIPFCGP_CLAIM_FILLER AS IPFCGP_CLAIM_FILLER, \n\tIPFCGP_EXCESS_LOSS_IND AS IPFCGP_EXCESS_LOSS_IND, \n\tIPFCGP_CLAIM_STATUS AS IPFCGP_CLAIM_STATUS, \n\tIPFCGP_LOSS_ORIGINAL_RESERVE AS IPFCGP_LOSS_ORIGINAL_RESERVE, \n\tIPFCGP_OS_LOSS_RESERVE AS IPFCGP_OS_LOSS_RESERVE, \n\tIPFCGP_OS_EXPENSE_RESERVE AS IPFCGP_OS_EXPENSE_RESERVE, \n\tIPFCGP_TOTAL_LOSS AS IPFCGP_TOTAL_LOSS, \n\tIPFCGP_TOTAL_EXPENSE AS IPFCGP_TOTAL_EXPENSE, \n\tIPFCGP_TOTAL_RECOVERIES AS IPFCGP_TOTAL_RECOVERIES, \n\tIPFCGP_BEG_OS_LOSS_RESERVE AS IPFCGP_BEG_OS_LOSS_RESERVE, \n\tIPFCGP_ACCIDENT_DESCRIPTION AS IPFCGP_ACCIDENT_DESCRIPTION, \n\tIPFCGP_NUMBER_OF_PART78 AS IPFCGP_NUMBER_OF_PART78, \n\tIPFCGP_NOTICE_OF_OCCURRENCE AS IPFCGP_NOTICE_OF_OCCURRENCE, \n\tIPFCGP_OFFSET_ONSET_IND AS IPFCGP_OFFSET_ONSET_IND, \n\tIPFCGP_MASTER_CLAIM_NUMBER AS IPFCGP_MASTER_CLAIM_NUMBER, \n\tIPFCGP_PROCESSING_LOCATION AS IPFCGP_PROCESSING_LOCATION, \n\tIPFCGP_CRIME_ZIP_BASIC AS IPFCGP_CRIME_ZIP_BASIC, \n\tIPFCGP_CRIME_ZIP_EXPANDED AS IPFCGP_CRIME_ZIP_EXPANDED, \n\tIPFCGP_CR_SUB_LINE AS IPFCGP_CR_SUB_LINE, \n\tIPFCGP_PMS_FUTURE_USE_GP AS IPFCGP_PMS_FUTURE_USE_GP, \n\tIPFCGP_DIRECT_REPORTING AS IPFCGP_DIRECT_REPORTING, \n\tIPFCGP_LITIGATED_SAVINGS AS IPFCGP_LITIGATED_SAVINGS, \n\tIPFCGP_CUST_SPL_USE_GP AS IPFCGP_CUST_SPL_USE_GP, \n\tIPFCGP_YR2000_CUST_USE AS IPFCGP_YR2000_CUST_USE, \n\tINF_ACTION, \n\tINF_TIMESTAMP, \n\tLOGICAL_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_arch_PIF_42GP_stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsStaging/"
        },
        "annotations": []
    }
}