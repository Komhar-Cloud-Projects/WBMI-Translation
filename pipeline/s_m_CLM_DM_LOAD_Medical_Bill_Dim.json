{
    "name": "s_m_CLM_DM_LOAD_Medical_Bill_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Medical_Bill_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_medical_bill AS (\n\tSELECT medical_bill.med_bill_id, medical_bill.med_bill_ak_id, medical_bill.med_bill_key, medical_bill.vendor_bill_num, medical_bill.patient_acct_num, medical_bill.patient_full_name, medical_bill.patient_last_name, medical_bill.patient_first_name, medical_bill.patient_mid_name, medical_bill.patient_addr, medical_bill.patient_city, medical_bill.patient_state, medical_bill.patient_zip_code, medical_bill.patient_birthdate, medical_bill.patient_gndr, medical_bill.patient_ssn, medical_bill.patient_inj_date, medical_bill.refer_physician, medical_bill.inpatient_outpatient_ind, medical_bill.bill_issued_date, medical_bill.bill_rcvd_date, medical_bill.bus_rcvd_date, medical_bill.bill_process_date, medical_bill.patient_admit_date, medical_bill.patient_discharge_date, medical_bill.bill_cover_from_date, medical_bill.bill_cover_to_date, medical_bill.daily_hospital_rate, medical_bill.bill_review_cost, medical_bill.total_bill_charge, medical_bill.total_bill_review_red, medical_bill.total_network_red, medical_bill.total_recommend_pay, medical_bill.total_addtional_charge, medical_bill.bill_type, medical_bill.bill_status_code, medical_bill.fee_sched_code, medical_bill.network_name, medical_bill.network_num, medical_bill.serv_line_num, medical_bill.deleted_ind, medical_bill.emplyr, medical_bill.acct_id, medical_bill.bill_review_vendor_code, medical_bill.med_bill_vendor_ak_id\r\n\t, medical_bill.med_bill_review_code \r\n\t, medical_bill.autopay_ind\r\n\t,medical_bill.eor_rcvd_date\r\n\t, medical_bill.OriginalVendorBillNumber\r\n\t, medical_bill.AutoAdjudicatedIndicator\r\n\tFROM\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.medical_bill\r\n\tWHERE\tcreated_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tAND\t\tcrrnt_snpsht_flag = 1\n),\nEXP_PASS_THROUGH AS (\n\tSELECT\n\tmed_bill_id,\n\tmed_bill_ak_id,\n\tmed_bill_key,\n\tmed_bill_vendor_ak_id,\n\tvendor_bill_num,\n\tpatient_acct_num,\n\tpatient_full_name,\n\tpatient_last_name,\n\tpatient_first_name,\n\tpatient_mid_name,\n\tpatient_addr,\n\tpatient_city,\n\tpatient_state,\n\tpatient_zip_code,\n\tpatient_birthdate,\n\tpatient_gndr,\n\tpatient_ssn,\n\tpatient_inj_date,\n\trefer_physician,\n\tinpatient_outpatient_ind,\n\tbill_issued_date,\n\tbill_rcvd_date,\n\tbus_rcvd_date,\n\tbill_process_date,\n\tpatient_admit_date,\n\tpatient_discharge_date,\n\tbill_cover_from_date,\n\tbill_cover_to_date,\n\tdaily_hospital_rate,\n\tbill_review_cost,\n\ttotal_bill_charge,\n\ttotal_bill_review_red,\n\ttotal_network_red,\n\ttotal_recommend_pay,\n\ttotal_addtional_charge,\n\tbill_type,\n\tbill_status_code,\n\tfee_sched_code,\n\tnetwork_name,\n\tnetwork_num,\n\tserv_line_num,\n\tdeleted_ind,\n\templyr,\n\tacct_id,\n\tbill_review_vendor_code,\n\tmed_bill_review_code AS in_med_bill_review_code,\n\t-- *INF*: iif(isnull(in_med_bill_review_code),'N/A',in_med_bill_review_code)\n\tIFF(in_med_bill_review_code IS NULL, 'N/A', in_med_bill_review_code) AS med_bill_review_code,\n\tautopay_ind AS in_autopay_ind,\n\t-- *INF*: iif(isnull(in_autopay_ind),'N/A',in_autopay_ind)\n\tIFF(in_autopay_ind IS NULL, 'N/A', in_autopay_ind) AS autopay_ind,\n\teor_rcvd_date,\n\tOriginalVendorBillNumber,\n\tAutoAdjudicatedIndicator\n\tFROM SQ_medical_bill\n),\nLKP_Provider_Group AS (\n\tSELECT\n\tmed_provider_id,\n\tmed_provider_ak_id,\n\tin_med_bill_ak_id,\n\tmed_bill_ak_id,\n\tprovider_type_code,\n\tbus_name,\n\tfull_name,\n\tlast_name,\n\tfirst_name,\n\tmid_name,\n\tprfx,\n\tsfx,\n\ttitle,\n\tspecialty_code,\n\taddr,\n\tcity,\n\tstate,\n\tzip,\n\ttax_id\n\tFROM (\n\t\tSELECT \r\n\t\tmedical_provider.med_provider_id as med_provider_id, \r\n\t\tmedical_provider.med_provider_ak_id as med_provider_ak_id, \r\n\t\tmedical_provider.provider_type_code as provider_type_code, \r\n\t\tmedical_provider.bus_name as bus_name, \r\n\t\tmedical_provider.full_name as full_name, \r\n\t\tmedical_provider.last_name as last_name, \r\n\t\tmedical_provider.first_name as first_name, \r\n\t\tmedical_provider.mid_name as mid_name, \r\n\t\tmedical_provider.prfx as prfx, \r\n\t\tmedical_provider.sfx as sfx, \r\n\t\tmedical_provider.title as title, \r\n\t\tmedical_provider.specialty_code as specialty_code, \r\n\t\tmedical_provider.addr as addr, \r\n\t\tmedical_provider.city as city, \r\n\t\tmedical_provider.state as state, \r\n\t\tmedical_provider.zip as zip, \r\n\t\tmedical_provider.tax_id as tax_id, \r\n\t\tmedical_provider.med_bill_ak_id as med_bill_ak_id \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.medical_provider medical_provider\r\n\t\tWHERE provider_type_code = 'GROUP' and crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_ak_id ORDER BY med_provider_id) = 1\n),\nLKP_Provider_Individual AS (\n\tSELECT\n\tmed_provider_id,\n\tmed_provider_ak_id,\n\tin_med_bill_ak_id,\n\tmed_bill_ak_id,\n\tprovider_type_code,\n\tbus_name,\n\tfull_name,\n\tlast_name,\n\tfirst_name,\n\tmid_name,\n\tprfx,\n\tsfx,\n\ttitle,\n\tspecialty_code,\n\taddr,\n\tcity,\n\tstate,\n\tzip,\n\ttax_id\n\tFROM (\n\t\tSELECT \r\n\t\tmedical_provider.med_provider_id as med_provider_id, \r\n\t\tmedical_provider.med_provider_ak_id as med_provider_ak_id, \r\n\t\tmedical_provider.provider_type_code as provider_type_code, \r\n\t\tmedical_provider.bus_name as bus_name, \r\n\t\tmedical_provider.full_name as full_name, \r\n\t\tmedical_provider.last_name as last_name, \r\n\t\tmedical_provider.first_name as first_name, \r\n\t\tmedical_provider.mid_name as mid_name, \r\n\t\tmedical_provider.prfx as prfx, \r\n\t\tmedical_provider.sfx as sfx, \r\n\t\tmedical_provider.title as title, \r\n\t\tmedical_provider.specialty_code as specialty_code, \r\n\t\tmedical_provider.addr as addr, \r\n\t\tmedical_provider.city as city, \r\n\t\tmedical_provider.state as state, \r\n\t\tmedical_provider.zip as zip, \r\n\t\tmedical_provider.tax_id as tax_id, \r\n\t\tmedical_provider.med_bill_ak_id as med_bill_ak_id \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.medical_provider medical_provider\r\n\t\tWHERE provider_type_code = 'INDIV'\r\n\t\tand crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_ak_id ORDER BY med_provider_id) = 1\n),\nLKP_medical_bill_vendor AS (\n\tSELECT\n\tmed_bill_vendor_ak_id,\n\tvendor_code,\n\tvendor_name,\n\tvendor_addr,\n\tvendor_city,\n\tvendor_state,\n\tvendor_zip,\n\tvendor_ph,\n\tvendor_fax\n\tFROM (\n\t\tSELECT \n\t\t\tmed_bill_vendor_ak_id,\n\t\t\tvendor_code,\n\t\t\tvendor_name,\n\t\t\tvendor_addr,\n\t\t\tvendor_city,\n\t\t\tvendor_state,\n\t\t\tvendor_zip,\n\t\t\tvendor_ph,\n\t\t\tvendor_fax\n\t\tFROM medical_bill_vendor\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_vendor_ak_id ORDER BY med_bill_vendor_ak_id) = 1\n),\nLKP_sup_claim_medical_bill_review_code AS (\n\tSELECT\n\tmed_bill_review_code_descript,\n\tin_med_bill_review_code,\n\tmed_bill_review_code\n\tFROM (\n\t\tSELECT\tmed_bill_review_code_descript\tas med_bill_review_code_descript\r\n\t\t,\t\tmed_bill_review_code\t\t\tas med_bill_review_code \r\n\t\tFROM\tsup_claim_medical_bill_review_code\r\n\t\tWHERE\tcrrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_review_code ORDER BY med_bill_review_code_descript) = 1\n),\nEXPTRANS AS (\n\tSELECT\n\tEXP_PASS_THROUGH.med_bill_id,\n\tEXP_PASS_THROUGH.med_bill_ak_id,\n\tEXP_PASS_THROUGH.med_bill_key,\n\tEXP_PASS_THROUGH.vendor_bill_num,\n\tEXP_PASS_THROUGH.patient_acct_num,\n\tEXP_PASS_THROUGH.patient_full_name,\n\tEXP_PASS_THROUGH.patient_last_name,\n\tEXP_PASS_THROUGH.patient_first_name,\n\tEXP_PASS_THROUGH.patient_mid_name,\n\tEXP_PASS_THROUGH.patient_addr,\n\tEXP_PASS_THROUGH.patient_city,\n\tEXP_PASS_THROUGH.patient_state,\n\tEXP_PASS_THROUGH.patient_zip_code,\n\tEXP_PASS_THROUGH.patient_birthdate,\n\tEXP_PASS_THROUGH.patient_gndr,\n\tEXP_PASS_THROUGH.patient_ssn,\n\tEXP_PASS_THROUGH.patient_inj_date,\n\tEXP_PASS_THROUGH.refer_physician,\n\tEXP_PASS_THROUGH.inpatient_outpatient_ind,\n\tEXP_PASS_THROUGH.bill_issued_date,\n\tEXP_PASS_THROUGH.bill_rcvd_date,\n\tEXP_PASS_THROUGH.bus_rcvd_date,\n\tEXP_PASS_THROUGH.bill_process_date,\n\tEXP_PASS_THROUGH.patient_admit_date,\n\tEXP_PASS_THROUGH.patient_discharge_date,\n\tEXP_PASS_THROUGH.bill_cover_from_date,\n\tEXP_PASS_THROUGH.bill_cover_to_date,\n\tEXP_PASS_THROUGH.daily_hospital_rate,\n\tEXP_PASS_THROUGH.bill_review_cost,\n\tEXP_PASS_THROUGH.total_bill_charge,\n\tEXP_PASS_THROUGH.total_bill_review_red,\n\tEXP_PASS_THROUGH.total_network_red,\n\tEXP_PASS_THROUGH.total_recommend_pay,\n\tEXP_PASS_THROUGH.total_addtional_charge,\n\tEXP_PASS_THROUGH.bill_type,\n\tEXP_PASS_THROUGH.bill_status_code,\n\tEXP_PASS_THROUGH.fee_sched_code,\n\tEXP_PASS_THROUGH.network_name,\n\tEXP_PASS_THROUGH.network_num,\n\tEXP_PASS_THROUGH.serv_line_num,\n\tEXP_PASS_THROUGH.deleted_ind,\n\tEXP_PASS_THROUGH.emplyr,\n\tEXP_PASS_THROUGH.acct_id,\n\tEXP_PASS_THROUGH.bill_review_vendor_code,\n\tLKP_Provider_Group.bus_name AS group_bus_name,\n\tLKP_Provider_Group.full_name AS group_full_name,\n\tLKP_Provider_Group.last_name AS group_last_name,\n\tLKP_Provider_Group.first_name AS group_first_name,\n\tLKP_Provider_Group.mid_name AS group_mid_name,\n\tLKP_Provider_Group.prfx AS group_prfx,\n\tLKP_Provider_Group.sfx AS group_sfx,\n\tLKP_Provider_Group.title AS group_title,\n\tLKP_Provider_Group.specialty_code AS group_specialty_code,\n\tLKP_Provider_Group.addr AS group_addr,\n\tLKP_Provider_Group.city AS group_city,\n\tLKP_Provider_Group.state AS group_state,\n\tLKP_Provider_Group.zip AS group_zip,\n\tLKP_Provider_Group.tax_id AS group_tax_id,\n\tLKP_Provider_Individual.full_name AS individual_full_name,\n\tLKP_Provider_Individual.last_name AS individual_last_name,\n\tLKP_Provider_Individual.first_name AS individual_first_name,\n\tLKP_Provider_Individual.mid_name AS individual_mid_name,\n\tLKP_Provider_Individual.prfx AS individual_prfx,\n\tLKP_Provider_Individual.sfx AS individual_sfx,\n\tLKP_Provider_Individual.title AS individual_title,\n\tLKP_Provider_Individual.specialty_code AS individual_specialty_code,\n\tLKP_Provider_Individual.addr AS individual_addr,\n\tLKP_Provider_Individual.city AS individual_city,\n\tLKP_Provider_Individual.state AS individual_state,\n\tLKP_Provider_Individual.zip AS individual_zip,\n\tLKP_Provider_Individual.tax_id AS individual_tax_id,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tsysdate AS created_date,\n\tsysdate AS modified_date,\n\tLKP_medical_bill_vendor.vendor_code,\n\tLKP_medical_bill_vendor.vendor_name,\n\tLKP_medical_bill_vendor.vendor_addr,\n\tLKP_medical_bill_vendor.vendor_city,\n\tLKP_medical_bill_vendor.vendor_state,\n\tLKP_medical_bill_vendor.vendor_zip,\n\tLKP_medical_bill_vendor.vendor_ph,\n\tLKP_medical_bill_vendor.vendor_fax,\n\tLKP_sup_claim_medical_bill_review_code.in_med_bill_review_code AS med_bill_review_code,\n\tLKP_sup_claim_medical_bill_review_code.med_bill_review_code_descript AS in_med_bill_review_code_descript,\n\t-- *INF*: iif(isnull(in_med_bill_review_code_descript),'Not Applicable',in_med_bill_review_code_descript)\n\tIFF(\n\t    in_med_bill_review_code_descript IS NULL, 'Not Applicable', in_med_bill_review_code_descript\n\t) AS med_bill_review_code_descript,\n\tEXP_PASS_THROUGH.autopay_ind,\n\tEXP_PASS_THROUGH.eor_rcvd_date,\n\tEXP_PASS_THROUGH.OriginalVendorBillNumber,\n\tEXP_PASS_THROUGH.AutoAdjudicatedIndicator\n\tFROM EXP_PASS_THROUGH\n\tLEFT JOIN LKP_Provider_Group\n\tON LKP_Provider_Group.med_bill_ak_id = EXP_PASS_THROUGH.med_bill_ak_id\n\tLEFT JOIN LKP_Provider_Individual\n\tON LKP_Provider_Individual.med_bill_ak_id = EXP_PASS_THROUGH.med_bill_ak_id\n\tLEFT JOIN LKP_medical_bill_vendor\n\tON LKP_medical_bill_vendor.med_bill_vendor_ak_id = EXP_PASS_THROUGH.med_bill_vendor_ak_id\n\tLEFT JOIN LKP_sup_claim_medical_bill_review_code\n\tON LKP_sup_claim_medical_bill_review_code.med_bill_review_code = EXP_PASS_THROUGH.med_bill_review_code\n),\nLKP_MED_BILL_DIM_Exists AS (\n\tSELECT\n\tmed_bill_dim_id,\n\tedw_med_bill_ak_id,\n\tedw_med_bill_ak_id1\n\tFROM (\n\t\tSELECT \n\t\t\tmed_bill_dim_id,\n\t\t\tedw_med_bill_ak_id,\n\t\t\tedw_med_bill_ak_id1\n\t\tFROM medical_bill_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_med_bill_ak_id ORDER BY med_bill_dim_id) = 1\n),\nRTRTRANS AS (\n\tSELECT\n\tEXPTRANS.med_bill_id,\n\tEXPTRANS.med_bill_ak_id,\n\tEXPTRANS.med_bill_key,\n\tEXPTRANS.vendor_bill_num,\n\tEXPTRANS.patient_acct_num,\n\tEXPTRANS.patient_full_name,\n\tEXPTRANS.patient_last_name,\n\tEXPTRANS.patient_first_name,\n\tEXPTRANS.patient_mid_name,\n\tEXPTRANS.patient_addr,\n\tEXPTRANS.patient_city,\n\tEXPTRANS.patient_state,\n\tEXPTRANS.patient_zip_code,\n\tEXPTRANS.patient_birthdate,\n\tEXPTRANS.patient_gndr,\n\tEXPTRANS.patient_ssn,\n\tEXPTRANS.patient_inj_date,\n\tEXPTRANS.refer_physician,\n\tEXPTRANS.inpatient_outpatient_ind,\n\tEXPTRANS.bill_issued_date,\n\tEXPTRANS.bill_rcvd_date,\n\tEXPTRANS.bus_rcvd_date,\n\tEXPTRANS.bill_process_date,\n\tEXPTRANS.patient_admit_date,\n\tEXPTRANS.patient_discharge_date,\n\tEXPTRANS.bill_cover_from_date,\n\tEXPTRANS.bill_cover_to_date,\n\tEXPTRANS.daily_hospital_rate,\n\tEXPTRANS.bill_review_cost,\n\tEXPTRANS.total_bill_charge,\n\tEXPTRANS.total_bill_review_red,\n\tEXPTRANS.total_network_red,\n\tEXPTRANS.total_recommend_pay,\n\tEXPTRANS.total_addtional_charge,\n\tEXPTRANS.bill_type,\n\tEXPTRANS.bill_status_code,\n\tEXPTRANS.fee_sched_code,\n\tEXPTRANS.network_name,\n\tEXPTRANS.network_num,\n\tEXPTRANS.serv_line_num,\n\tEXPTRANS.deleted_ind,\n\tEXPTRANS.emplyr,\n\tEXPTRANS.acct_id,\n\tEXPTRANS.bill_review_vendor_code,\n\tEXPTRANS.group_bus_name,\n\tEXPTRANS.group_full_name,\n\tEXPTRANS.group_last_name,\n\tEXPTRANS.group_first_name,\n\tEXPTRANS.group_mid_name,\n\tEXPTRANS.group_prfx,\n\tEXPTRANS.group_sfx,\n\tEXPTRANS.group_title,\n\tEXPTRANS.group_specialty_code,\n\tEXPTRANS.group_addr,\n\tEXPTRANS.group_city,\n\tEXPTRANS.group_state,\n\tEXPTRANS.group_zip,\n\tEXPTRANS.group_tax_id,\n\tEXPTRANS.individual_full_name,\n\tEXPTRANS.individual_last_name,\n\tEXPTRANS.individual_first_name,\n\tEXPTRANS.individual_mid_name,\n\tEXPTRANS.individual_prfx,\n\tEXPTRANS.individual_sfx,\n\tEXPTRANS.individual_title,\n\tEXPTRANS.individual_specialty_code,\n\tEXPTRANS.individual_addr,\n\tEXPTRANS.individual_city,\n\tEXPTRANS.individual_state,\n\tEXPTRANS.individual_zip,\n\tEXPTRANS.individual_tax_id,\n\tEXPTRANS.crrnt_snpsht_flag,\n\tEXPTRANS.audit_id,\n\tEXPTRANS.eff_from_date,\n\tEXPTRANS.eff_to_date,\n\tEXPTRANS.created_date,\n\tEXPTRANS.modified_date,\n\tLKP_MED_BILL_DIM_Exists.med_bill_dim_id,\n\tEXPTRANS.vendor_code,\n\tEXPTRANS.vendor_name,\n\tEXPTRANS.vendor_addr,\n\tEXPTRANS.vendor_city,\n\tEXPTRANS.vendor_state,\n\tEXPTRANS.vendor_zip,\n\tEXPTRANS.vendor_ph,\n\tEXPTRANS.vendor_fax,\n\tEXPTRANS.med_bill_review_code,\n\tEXPTRANS.med_bill_review_code_descript,\n\tEXPTRANS.autopay_ind,\n\tEXPTRANS.eor_rcvd_date AS eor_rcv_date,\n\tEXPTRANS.OriginalVendorBillNumber,\n\tEXPTRANS.AutoAdjudicatedIndicator\n\tFROM EXPTRANS\n\tLEFT JOIN LKP_MED_BILL_DIM_Exists\n\tON LKP_MED_BILL_DIM_Exists.edw_med_bill_ak_id = EXPTRANS.med_bill_ak_id\n),\nRTRTRANS_update AS (SELECT * FROM RTRTRANS WHERE not isnull(med_bill_dim_id)),\nRTRTRANS_DEFAULT1 AS (SELECT * FROM RTRTRANS WHERE NOT ( (not isnull(med_bill_dim_id)) )),\nmedical_bill_dim_insert AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.medical_bill_dim\n\t(edw_med_bill_pk_id, edw_med_bill_ak_id, med_bill_key, vendor_bill_num, patient_acct_num, patient_full_name, patient_last_name, patient_first_name, patient_mid_name, patient_addr, patient_city, patient_state, patient_zip_code, patient_birthdate, patient_gndr, patient_ssn, patient_inj_date, refer_physician, inpatient_outpatient_ind, bill_issued_date, bill_rcvd_date, bus_rcvd_date, bill_process_date, patient_admit_date, patient_discharge_date, bill_cover_from_date, bill_cover_to_date, daily_hospital_rate, bill_review_cost, total_bill_review_red, total_addtional_charge, bill_type, bill_status_code, fee_sched_code, network_name, network_num, serv_line_num, deleted_ind, emplyr, acct_id, bill_review_vendor_code, bus_name, group_provider_full_name, group_provider_last_name, group_provider_first_name, group_provider_mid_name, group_provider_prfx, group_provider_sfx, group_provider_title, group_provider_specialty_code, group_provider_addr, group_provider_city, group_provider_state, group_provider_zip, group_provider_tax_id, individual_provider_full_name, individual_provider_last_name, individual_provider_first_name, individual_provider_mid_name, individual_provider_prfx, individual_provider_sfx, individual_provider_title, individual_provider_specialty_code, individual_provider_addr, individual_provider_city, individual_provider_state, individual_provider_zip, individual_provider_tax_id, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, bill_review_vendor_name, bill_review_vendor_addr, bill_review_vendor_city, bill_review_vendor_state, bill_review_vendor_zip, bill_review_vendor_ph, bill_review_vendor_fax, med_bill_review_code, med_bill_review_code_descript, autopay_ind, eor_rcvd_date, OriginalVendorBillNumber, AutoAdjudicatedIndicator)\n\tSELECT \n\tmed_bill_id AS EDW_MED_BILL_PK_ID, \n\tmed_bill_ak_id AS EDW_MED_BILL_AK_ID, \n\tMED_BILL_KEY, \n\tVENDOR_BILL_NUM, \n\tPATIENT_ACCT_NUM, \n\tPATIENT_FULL_NAME, \n\tPATIENT_LAST_NAME, \n\tPATIENT_FIRST_NAME, \n\tPATIENT_MID_NAME, \n\tPATIENT_ADDR, \n\tPATIENT_CITY, \n\tPATIENT_STATE, \n\tPATIENT_ZIP_CODE, \n\tPATIENT_BIRTHDATE, \n\tPATIENT_GNDR, \n\tPATIENT_SSN, \n\tPATIENT_INJ_DATE, \n\tREFER_PHYSICIAN, \n\tINPATIENT_OUTPATIENT_IND, \n\tBILL_ISSUED_DATE, \n\tBILL_RCVD_DATE, \n\tBUS_RCVD_DATE, \n\tBILL_PROCESS_DATE, \n\tPATIENT_ADMIT_DATE, \n\tPATIENT_DISCHARGE_DATE, \n\tBILL_COVER_FROM_DATE, \n\tBILL_COVER_TO_DATE, \n\tDAILY_HOSPITAL_RATE, \n\tBILL_REVIEW_COST, \n\tTOTAL_BILL_REVIEW_RED, \n\tTOTAL_ADDTIONAL_CHARGE, \n\tBILL_TYPE, \n\tBILL_STATUS_CODE, \n\tFEE_SCHED_CODE, \n\tNETWORK_NAME, \n\tNETWORK_NUM, \n\tSERV_LINE_NUM, \n\tDELETED_IND, \n\tEMPLYR, \n\tACCT_ID, \n\tBILL_REVIEW_VENDOR_CODE, \n\tgroup_bus_name AS BUS_NAME, \n\tgroup_full_name AS GROUP_PROVIDER_FULL_NAME, \n\tgroup_last_name AS GROUP_PROVIDER_LAST_NAME, \n\tgroup_first_name AS GROUP_PROVIDER_FIRST_NAME, \n\tgroup_mid_name AS GROUP_PROVIDER_MID_NAME, \n\tgroup_prfx AS GROUP_PROVIDER_PRFX, \n\tgroup_sfx AS GROUP_PROVIDER_SFX, \n\tgroup_title AS GROUP_PROVIDER_TITLE, \n\tgroup_specialty_code AS GROUP_PROVIDER_SPECIALTY_CODE, \n\tgroup_addr AS GROUP_PROVIDER_ADDR, \n\tgroup_city AS GROUP_PROVIDER_CITY, \n\tgroup_state AS GROUP_PROVIDER_STATE, \n\tgroup_zip AS GROUP_PROVIDER_ZIP, \n\tgroup_tax_id AS GROUP_PROVIDER_TAX_ID, \n\tindividual_full_name AS INDIVIDUAL_PROVIDER_FULL_NAME, \n\tindividual_last_name AS INDIVIDUAL_PROVIDER_LAST_NAME, \n\tindividual_first_name AS INDIVIDUAL_PROVIDER_FIRST_NAME, \n\tindividual_mid_name AS INDIVIDUAL_PROVIDER_MID_NAME, \n\tindividual_prfx AS INDIVIDUAL_PROVIDER_PRFX, \n\tindividual_sfx AS INDIVIDUAL_PROVIDER_SFX, \n\tindividual_title AS INDIVIDUAL_PROVIDER_TITLE, \n\tindividual_specialty_code AS INDIVIDUAL_PROVIDER_SPECIALTY_CODE, \n\tindividual_addr AS INDIVIDUAL_PROVIDER_ADDR, \n\tindividual_city AS INDIVIDUAL_PROVIDER_CITY, \n\tindividual_state AS INDIVIDUAL_PROVIDER_STATE, \n\tindividual_zip AS INDIVIDUAL_PROVIDER_ZIP, \n\tindividual_tax_id AS INDIVIDUAL_PROVIDER_TAX_ID, \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tCREATED_DATE, \n\tMODIFIED_DATE, \n\tvendor_name AS BILL_REVIEW_VENDOR_NAME, \n\tvendor_addr AS BILL_REVIEW_VENDOR_ADDR, \n\tvendor_city AS BILL_REVIEW_VENDOR_CITY, \n\tvendor_state AS BILL_REVIEW_VENDOR_STATE, \n\tvendor_zip AS BILL_REVIEW_VENDOR_ZIP, \n\tvendor_ph AS BILL_REVIEW_VENDOR_PH, \n\tvendor_fax AS BILL_REVIEW_VENDOR_FAX, \n\tMED_BILL_REVIEW_CODE, \n\tMED_BILL_REVIEW_CODE_DESCRIPT, \n\tAUTOPAY_IND, \n\teor_rcv_date AS EOR_RCVD_DATE, \n\tORIGINALVENDORBILLNUMBER, \n\tAUTOADJUDICATEDINDICATOR\n\tFROM RTRTRANS_DEFAULT1\n),\nUPD_Medical_Bill_Dim_U AS (\n\tSELECT\n\tmed_bill_id, \n\tmed_bill_ak_id, \n\tmed_bill_key, \n\tvendor_bill_num, \n\tpatient_acct_num, \n\tpatient_full_name, \n\tpatient_last_name, \n\tpatient_first_name, \n\tpatient_mid_name, \n\tpatient_addr, \n\tpatient_city, \n\tpatient_state, \n\tpatient_zip_code, \n\tpatient_birthdate, \n\tpatient_gndr, \n\tpatient_ssn, \n\tpatient_inj_date, \n\trefer_physician, \n\tinpatient_outpatient_ind, \n\tbill_issued_date, \n\tbill_rcvd_date, \n\tbus_rcvd_date, \n\tbill_process_date, \n\tpatient_admit_date, \n\tpatient_discharge_date, \n\tbill_cover_from_date, \n\tbill_cover_to_date, \n\tdaily_hospital_rate, \n\tbill_review_cost, \n\ttotal_bill_charge, \n\ttotal_bill_review_red, \n\ttotal_network_red, \n\ttotal_recommend_pay, \n\ttotal_addtional_charge, \n\tbill_type, \n\tbill_status_code, \n\tfee_sched_code, \n\tnetwork_name, \n\tnetwork_num, \n\tserv_line_num, \n\tdeleted_ind, \n\templyr, \n\tacct_id, \n\tbill_review_vendor_code, \n\tgroup_bus_name, \n\tgroup_full_name, \n\tgroup_last_name, \n\tgroup_first_name, \n\tgroup_mid_name, \n\tgroup_prfx, \n\tgroup_sfx, \n\tgroup_title, \n\tgroup_specialty_code, \n\tgroup_addr, \n\tgroup_city, \n\tgroup_state, \n\tgroup_zip, \n\tgroup_tax_id, \n\tindividual_full_name, \n\tindividual_last_name, \n\tindividual_first_name, \n\tindividual_mid_name, \n\tindividual_prfx, \n\tindividual_sfx, \n\tindividual_title, \n\tindividual_specialty_code, \n\tindividual_addr, \n\tindividual_city, \n\tindividual_state, \n\tindividual_zip, \n\tindividual_tax_id, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\tmodified_date, \n\tmed_bill_dim_id AS med_bill_dim_id1, \n\tvendor_code, \n\tvendor_name, \n\tvendor_addr, \n\tvendor_city, \n\tvendor_state, \n\tvendor_zip, \n\tvendor_ph, \n\tvendor_fax, \n\tmed_bill_review_code, \n\tmed_bill_review_code_descript, \n\tautopay_ind, \n\teor_rcv_date AS eor_rcv_date1, \n\tOriginalVendorBillNumber AS OriginalVendorBillNumber1, \n\tAutoAdjudicatedIndicator AS AutoAdjudicatedIndicator1\n\tFROM RTRTRANS_update\n),\nmedical_bill_dim_update AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.medical_bill_dim AS T\n\tUSING UPD_Medical_Bill_Dim_U AS S\n\tON T.med_bill_dim_id = S.med_bill_dim_id1\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.edw_med_bill_pk_id = S.med_bill_id, T.edw_med_bill_ak_id = S.med_bill_ak_id, T.med_bill_key = S.med_bill_key, T.vendor_bill_num = S.vendor_bill_num, T.patient_acct_num = S.patient_acct_num, T.patient_full_name = S.patient_full_name, T.patient_last_name = S.patient_last_name, T.patient_first_name = S.patient_first_name, T.patient_mid_name = S.patient_mid_name, T.patient_addr = S.patient_addr, T.patient_city = S.patient_city, T.patient_state = S.patient_state, T.patient_zip_code = S.patient_zip_code, T.patient_birthdate = S.patient_birthdate, T.patient_gndr = S.patient_gndr, T.patient_ssn = S.patient_ssn, T.patient_inj_date = S.patient_inj_date, T.refer_physician = S.refer_physician, T.inpatient_outpatient_ind = S.inpatient_outpatient_ind, T.bill_issued_date = S.bill_issued_date, T.bill_rcvd_date = S.bill_rcvd_date, T.bus_rcvd_date = S.bus_rcvd_date, T.bill_process_date = S.bill_process_date, T.patient_admit_date = S.patient_admit_date, T.patient_discharge_date = S.patient_discharge_date, T.bill_cover_from_date = S.bill_cover_from_date, T.bill_cover_to_date = S.bill_cover_to_date, T.daily_hospital_rate = S.daily_hospital_rate, T.bill_review_cost = S.bill_review_cost, T.total_bill_review_red = S.total_bill_review_red, T.total_addtional_charge = S.total_addtional_charge, T.bill_type = S.bill_type, T.bill_status_code = S.bill_status_code, T.fee_sched_code = S.fee_sched_code, T.network_name = S.network_name, T.network_num = S.network_num, T.serv_line_num = S.serv_line_num, T.deleted_ind = S.deleted_ind, T.emplyr = S.emplyr, T.acct_id = S.acct_id, T.bill_review_vendor_code = S.bill_review_vendor_code, T.bus_name = S.group_bus_name, T.group_provider_full_name = S.group_full_name, T.group_provider_last_name = S.group_last_name, T.group_provider_first_name = S.group_first_name, T.group_provider_mid_name = S.group_mid_name, T.group_provider_prfx = S.group_prfx, T.group_provider_sfx = S.group_sfx, T.group_provider_title = S.group_title, T.group_provider_specialty_code = S.group_specialty_code, T.group_provider_addr = S.group_addr, T.group_provider_city = S.group_city, T.group_provider_state = S.group_state, T.group_provider_zip = S.group_zip, T.group_provider_tax_id = S.group_tax_id, T.individual_provider_full_name = S.individual_full_name, T.individual_provider_last_name = S.individual_last_name, T.individual_provider_first_name = S.individual_first_name, T.individual_provider_mid_name = S.individual_mid_name, T.individual_provider_prfx = S.individual_prfx, T.individual_provider_sfx = S.individual_sfx, T.individual_provider_title = S.individual_title, T.individual_provider_specialty_code = S.individual_specialty_code, T.individual_provider_addr = S.individual_addr, T.individual_provider_city = S.individual_city, T.individual_provider_state = S.individual_state, T.individual_provider_zip = S.individual_zip, T.individual_provider_tax_id = S.individual_tax_id, T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.audit_id = S.audit_id, T.modified_date = S.modified_date, T.bill_review_vendor_name = S.vendor_name, T.bill_review_vendor_addr = S.vendor_addr, T.bill_review_vendor_city = S.vendor_city, T.bill_review_vendor_state = S.vendor_state, T.bill_review_vendor_zip = S.vendor_zip, T.bill_review_vendor_ph = S.vendor_ph, T.bill_review_vendor_fax = S.vendor_fax, T.med_bill_review_code = S.med_bill_review_code, T.med_bill_review_code_descript = S.med_bill_review_code_descript, T.autopay_ind = S.autopay_ind, T.eor_rcvd_date = S.eor_rcv_date1, T.OriginalVendorBillNumber = S.OriginalVendorBillNumber1, T.AutoAdjudicatedIndicator = S.AutoAdjudicatedIndicator1\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsDataMart/"
        },
        "annotations": []
    }
}