{
    "name": "s_m_POL_FEED_ActuarialAnalysis39Monthly_Premium",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_ActuarialAnalysis39Monthly_Premium",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_CDD AS (\n\tSELECT\n\tpma_desc,\n\tpma_code\n\tFROM (\n\t\tSELECT DISTINCT \r\n\t\tcd.PackageModificationAdjustmentGroupCode as pma_code,\r\n\t\tcd.PackageModificationAdjustmentGroupDescription as pma_desc\r\n\t\tFROM CoverageDetailDim cd\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pma_code ORDER BY pma_desc) = 1\n),\nSQ_MonthlyActuarialAnalysis39_Premium AS (\n\tSELECT ird.InsuranceReferenceDimId,\r\n\t\tpol_current.ProgramCode AS prog_code,\r\n\t\tpol_current.AssociationCode AS assn_code,\r\n\t\tircd.CoverageSummaryCode AS cov_summ_code,\r\n\t\tircd.CoverageSummaryDescription AS cov_summ_desc,\r\n\t\tircd.CoverageGroupCode AS cov_grp_code,\r\n\t\tircd.CoverageGroupDescription AS cov_grp_desc,\r\n\t\tircd.CoverageCode AS cov_code,\r\n\t\tircd.CoverageDescription AS cov_desc,\r\n\t\tircd.RatedCoverageCode AS rated_cov_code,\r\n\t\tircd.RatedCoverageDescription AS rated_cov_desc,\r\n\t\tCASE WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND PmsMajorPerilDescription = 'GL CLM-MDE' THEN 'CLAIMSMADE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND PmsMajorPerilDescription = 'GL OCCUR' THEN 'OCCURRENCE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND DctCoverageVersion = 'CLAIMSMADE' THEN 'CLAIMSMADE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND DctCoverageVersion = 'OCCURRENCE' THEN 'OCCURRENCE' ELSE 'N/A' END AS cov_trigger_type,\r\n\t\tpol_current.pol_key AS pol_key,\r\n\t\tpol_current.pol_sym AS pol_sym,\r\n\t\tpol_current.pol_num AS pol_no,\r\n\t\tpol_current.pol_mod AS pol_ver,\r\n\t\tcd.RatingStateProvinceCode AS rating_state_code,\r\n\t      cd.RatingStateProvinceAbbreviation AS RatingStateAbbreviation,\r\n\t\tc.clndr_yr AS acctg_year,\r\n\t\tc.clndr_month AS acctg_mo,\r\n\t\taed_current.ProducerCode AS producer_code,\r\n\t\t(CASE WHEN aed_current.AgencyEmployeeRole = 'Producer' THEN aed_current.AgencyEmployeeFirstName + ' ' + aed_current.agencyemployeelastname ELSE 'N/A' END) AS producer_name,\r\n\t\tccd_current.cust_num AS cust_num,\r\n\t\tccd_current.NAME AS insured_name,\r\n\t\tasl.asl_dim_id,\r\n\t\tpol_current.prim_bus_class_code AS prim_bus_class_code,\r\n\t\tpol_current.prim_bus_class_code_descript AS prim_bus_class_desc,\r\n\t      pol_current.serv_center_support_code,\r\n\t\tad_current.AssignedStateCode AS agency_state_code,\r\n\t\tad_current.AgencyCode AS agency_code,\r\n\t\tad_current.AgencyDoingBusinessAsName AS agency_name,\r\n\t\ts.SalesDivisionDimID,\r\n\t\t(CASE WHEN U.AssociateRole <> 'UNDERWRITER ASSISTANT' THEN U.UnderwriterDisplayName ELSE 'N/A' END) AS uw_name,\r\n\t\t(CASE WHEN U.AssociateRole = 'UNDERWRITER ASSISTANT' THEN U.UnderwriterDisplayName ELSE 'N/A' END) AS asst_uw_name,\r\n\t\tU.UnderwriterManagerDisplayName AS uw_mgr_name,\r\n\t--\tLEFT(SD.LegalPrimaryAgencyCode, 2) AS prim_agency_state_code,\r\n\t--\tSD.LegalPrimaryAgencyCode AS prim_agency_code,\r\n\t--\tSD.AgencyDoingBusinessAsName AS prim_agency_name,\r\n\t\t(CASE WHEN pol_current.pol_issue_code = 'N'\r\n\t\tTHEN 'Y' ELSE 'N' END\r\n\t\t) AS new_bus_indic,\r\n\t\tpol_current.state_of_domicile_code AS prim_rating_state_code,\r\n\t\tccd_current.sic_code AS sic_code,\r\n\t\tccd_current.sic_code_descript AS sic_code_desc,\r\n\t\tu.UnderwritingRegionCodeDescription AS uw_region_name,\r\n\t\tpol_current.orig_incptn_date AS pol_orig_incptn_date,\r\n\t\tpol_current.pol_eff_date AS pol_eff_date,\r\n\t\tpol_current.pol_exp_date AS pol_exp_date,\r\n\t\tcd.PackageModificationAdjustmentGroupCode AS pma_code,\r\n\t\tcd.IncreasedLimitGroupCode AS ilf_tbl,\r\n\t\tsum(mptf.DirectWrittenPremium) AS dwp,\r\n\t\tsum(mptf.SubjectWrittenPremium) AS subj_dwp,\r\n\t\tsum(mptf.OtherModifiedPremium) AS other_dwp,\r\n\t\tsum(mptf.ExperienceModifiedPremium) AS expmod_dwp,\r\n\t\tsum(mptf.ScheduleModifiedPremium) AS schmod_dwp,\r\n\t(\r\n\tCASE WHEN C.clndr_yr < 2022 THEN\r\n\tCASE WHEN\r\n\t (ird.PolicyOfferingCode = '600'\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode = '330'\r\n\tOR ird.StrategicProfitCenterCode = '5'\r\n\tOR ird.InsuranceSegmentCode = '3'\r\n\tOR (ircd.CoverageGroupCode IN ('BOILER') OR ircd.CoverageGroupCode LIKE '%TRIA'\r\n\tOR ircd.CoverageGroupDescription IN ('Earthquake', 'MCCA Surcharge')\r\n\t)\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode IN ('811', '310', '312', '590', '812', '890', '900', '506' , '505' , '507')\r\n\tOR (ird.InsuranceReferenceLineOfBusinessCode = '100' AND cd.ClassCode IN ('9741', '9740'))\r\n\tOR (ird.RatingPlanAbbreviation IN ('LRARO', 'Retro'))\r\n\tOR apc.asl_prdct_code in ('200', '220')\r\n\tOR cd.ClassCode = '0174' ) THEN 'N' ELSE 'Y'\r\n\tEND\r\n\tWHEN   C.clndr_yr > = 2022 AND ird.StrategicProfitCenterCode = '5' AND ird.RatingPlanAbbreviation NOT IN ('LRARO', 'Retro') THEN 'Y'\r\n\tELSE\r\n\tCASE WHEN ird.PolicyOfferingCode = '600'\r\n\tOR ird.InsuranceSegmentCode = '3'\r\n\tOR (ircd.CoverageGroupCode IN ('BOILER')\r\n\tOR ircd.CoverageGroupCode LIKE '%TRIA'\r\n\tOR ircd.CoverageGroupDescription IN ('MCCA Surcharge')\r\n\t)\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode IN ('590', '812', '890', '900', '506' , '505' , '507')\r\n\tOR (ird.RatingPlanAbbreviation IN ('LRARO', 'Retro'))\r\n\tOR apc.asl_prdct_code in ('200', '220')\r\n\tOR cd.ClassCode = '0174' THEN 'N' ELSE 'Y' END\r\n\tEND\r\n\t) AS agency_contigent_ind,\r\n\t\tcdgl.ISOGeneralLiabilityClassGroupCode,\r\n\t\tcdcp.ISOCommercialPropertyRatingGroupCode,\r\n\t\tcdcp.RateType,\r\n\t\tcdcp.ISOCommercialPropertyCauseofLossGroup,\r\n\t\tcdca.VehicleTypeSize,\r\n\t\tcdca.BusinessUseClass,\r\n\t\tcdca.RadiusOfOperation,\r\n\t\tcdca.FleetType,\r\n\t\tcdca.SecondaryClassGroup,\r\n\t\tcdc.IndustryGroup,\r\n\t\tcdcp.ISOSpecialCauseOfLossCategoryCode,\r\n\t\tisnull(bcd.BusinessSegmentCode, 'N/A') AS BusinessSegmentCode,\r\n\t\tisnull(bcd.StrategicBusinessGroupCode, 'N/A') AS StrategicBusinessGroupCode,\r\n\t\tpol_Current.edw_pol_ak_id,\r\n\t\tisnull(ircd.ISOMajorCrimeGroup,'N/A') AS ISOMajorCrimeGroup,\r\n\t\tad_Current.AgencyStatusCode,\r\n\t--\tSD.AgencyStatusCode as PrimaryAgencyStatusCode,\r\n\t\tad_Current.EDWAgencyAKID,\r\n\t\tcd.CensusBlockGroupCountyCode,\r\n\t\tcd.CensusBlockGroupTractCode,\r\n\t\tcd.CensusBlockGroupBlockGroupCode,\r\n\t\tcd.Latitude,\r\n\t\tcd.Longitude,\r\n\t\tcd.RatingTerritory,\r\n\t\t ccd.mailing_zip_postal_code\r\n\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.ModifiedPremiumTransactionMonthlyFact mptf\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim ird ON ird.InsuranceReferenceDimId = mptf.InsuranceReferenceDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailDim cd ON cd.CoverageDetailDimId = mptf.CoverageDetailDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.calendar_dim c ON c.clndr_id = mptf.RunDateId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceCoverageDim ircd ON ircd.InsuranceReferenceCoverageDimId = mptf.InsuranceReferenceCoverageDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol ON pol.pol_dim_id = mptf.PolicyDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol_Current ON pol.edw_pol_ak_id = pol_Current.edw_pol_ak_id\r\n\t\tAND pol_Current.crrnt_snpsht_flag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyEmployeeDim aed ON aed.AgencyEmployeeDimID = pol_current.AgencyEmployeeDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyEmployeeDim aed_current ON aed.EDWAgencyEmployeeAKID = aed_current.EDWAgencyEmployeeAKID\r\n\t\tAND aed_current.CurrentSnapshotFlag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.UnderwritingDivisionDim U ON u.UnderwritingDivisionDimID = pol_current.UnderwritingDivisionDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocationDim rld ON rld.RiskLocationDimID = mptf.RiskLocationDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim ad ON ad.AgencyDimID = mptf.AgencyDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim ad_Current ON ad.EDWAgencyAKID = ad_Current.EDWAgencyAKID\r\n\t\tAND ad_Current.CurrentSnapshotFlag = 1\r\n\t--JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim SD ON SD.AgencyCode = ad_Current.LegalPrimaryAgencyCode\r\n\t--\tAND SD.CurrentSnapshotFlag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.SalesDivisionDim s ON s.SalesDivisionDimID = ad_current.SalesDivisionDimId\r\n\t\tAND S.CurrentSnapshotFlag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer_dim ccd ON ccd.contract_cust_dim_id = mptf.ContractCustomerDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer_dim ccd_Current ON ccd.edw_contract_cust_ak_id = ccd_Current.edw_contract_cust_ak_id\r\n\t\tAND ccd_Current.crrnt_snpsht_flag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.asl_dim asl ON asl.asl_dim_id = mptf.AnnualStatementLineDimID\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransactionTypeDim ptt ON ptt.PremiumTransactionTypeDimID = mptf.PremiumTransactionTypeDimId\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailGeneralLiabilityDim cdgl ON mptf.CoverageDetailDimId = cdgl.CoverageDetailDimId\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialPropertyDim cdcp ON mptf.CoverageDetailDimId = cdcp.CoverageDetailDimId\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCommercialAutoDim cdca ON mptf.CoverageDetailDimId = cdca.CoverageDetailDimId\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailCrimeDim cdc ON mptf.CoverageDetailDimId = cdc.CoverageDetailDimId\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.BusinessClassDim bcd ON pol_current.BusinessClassDimId = bcd.BusinessClassDimId\r\n\t\tAND bcd.CurrentSnapshotFlag = 1\r\n\tLEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.asl_product_code_dim apc on apc.asl_prdct_code_dim_id=mptf.AnnualStatementLineProductCodeDimId\r\n\tWHERE 1=1 \r\n\t@{pipeline().parameters.WHERE_CLAUSE}\r\n\tGROUP BY ird.InsuranceReferenceDimId,\r\n\t\tpol_current.ProgramCode,\r\n\t\tpol_current.AssociationCode,\r\n\t\tircd.CoverageSummaryCode,\r\n\t\tircd.CoverageSummaryDescription,\r\n\t\tircd.CoverageGroupCode,\r\n\t\tircd.CoverageGroupDescription,\r\n\t\tircd.CoverageCode,\r\n\t\tircd.CoverageDescription,\r\n\t\tircd.RatedCoverageCode,\r\n\t\tircd.RatedCoverageDescription,\r\n\t\tCASE WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND PmsMajorPerilDescription = 'GL CLM-MDE' THEN 'CLAIMSMADE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND PmsMajorPerilDescription = 'GL OCCUR' THEN 'OCCURRENCE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND DctCoverageVersion = 'CLAIMSMADE' THEN 'CLAIMSMADE' WHEN ircd.InsuranceLineCode = 'GL'\r\n\t\t\t\tAND DctCoverageVersion = 'OCCURRENCE' THEN 'OCCURRENCE' ELSE 'N/A' END,\r\n\t\tpol_current.pol_key,\r\n\t\tpol_current.pol_sym,\r\n\t\tpol_current.pol_num,\r\n\t\tpol_current.pol_mod,\r\n\t\tcd.RatingStateProvinceCode,\r\n\t      cd.RatingStateProvinceAbbreviation,\r\n\t\tc.clndr_yr,\r\n\t\tc.clndr_month,\r\n\t\taed_current.ProducerCode,\r\n\t\t(CASE WHEN aed_current.AgencyEmployeeRole = 'Producer' THEN aed_current.AgencyEmployeeFirstName + ' ' + aed_current.agencyemployeelastname ELSE 'N/A' END),\r\n\t\tccd_current.cust_num,\r\n\t\tccd_current.NAME,\r\n\t\tasl.asl_dim_id,\r\n\t\tpol_current.prim_bus_class_code,\r\n\t\tpol_current.prim_bus_class_code_descript,\r\n\t      pol_current.serv_center_support_code,\r\n\t\tad_current.AssignedStateCode,\r\n\t\tad_current.AgencyCode,\r\n\t\tad_current.AgencyDoingBusinessAsName,\r\n\t\ts.SalesDivisionDimID,\r\n\t\t(CASE WHEN U.AssociateRole <> 'UNDERWRITER ASSISTANT' THEN U.UnderwriterDisplayName ELSE 'N/A' END),\r\n\t\t(CASE WHEN U.AssociateRole = 'UNDERWRITER ASSISTANT' THEN U.UnderwriterDisplayName ELSE 'N/A' END),\r\n\t\tU.UnderwriterManagerDisplayName,\r\n\t--\tLEFT(SD.LegalPrimaryAgencyCode, 2),\r\n\t--\tSD.LegalPrimaryAgencyCode,\r\n\t--\tSD.AgencyDoingBusinessAsName,\r\n\t\t(CASE WHEN pol_current.pol_issue_code = 'N'\r\n\t\tTHEN 'Y' ELSE 'N' END),\r\n\t\tpol_current.state_of_domicile_code,\r\n\t\tccd_current.sic_code,\r\n\t\tccd_current.sic_code_descript,\r\n\t\tu.UnderwritingRegionCodeDescription,\r\n\t\tpol_current.orig_incptn_date,\r\n\t\tpol_current.pol_eff_date,\r\n\t\tpol_current.pol_exp_date,\r\n\t\tcd.PackageModificationAdjustmentGroupCode,\r\n\t\tcd.IncreasedLimitGroupCode,\r\n\t(\r\n\tCASE WHEN C.clndr_yr < 2022 THEN\r\n\tCASE WHEN\r\n\t (ird.PolicyOfferingCode = '600'\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode = '330'\r\n\tOR ird.StrategicProfitCenterCode = '5'\r\n\tOR ird.InsuranceSegmentCode = '3'\r\n\tOR (ircd.CoverageGroupCode IN ('BOILER') OR ircd.CoverageGroupCode LIKE '%TRIA'\r\n\tOR ircd.CoverageGroupDescription IN ('Earthquake', 'MCCA Surcharge')\r\n\t)\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode IN ('811', '310', '312', '590', '812', '890', '900', '506' , '505' , '507')\r\n\tOR (ird.InsuranceReferenceLineOfBusinessCode = '100' AND cd.ClassCode IN ('9741', '9740'))\r\n\tOR (ird.RatingPlanAbbreviation IN ('LRARO', 'Retro'))\r\n\tOR apc.asl_prdct_code in ('200', '220')\r\n\tOR cd.ClassCode = '0174' ) THEN 'N' ELSE 'Y'\r\n\tEND\r\n\tWHEN   C.clndr_yr > = 2022 AND ird.StrategicProfitCenterCode = '5' AND ird.RatingPlanAbbreviation NOT IN ('LRARO', 'Retro') THEN 'Y'\r\n\tELSE\r\n\tCASE WHEN ird.PolicyOfferingCode = '600'\r\n\tOR ird.InsuranceSegmentCode = '3'\r\n\tOR (ircd.CoverageGroupCode IN ('BOILER')\r\n\tOR ircd.CoverageGroupCode LIKE '%TRIA'\r\n\tOR ircd.CoverageGroupDescription IN ('MCCA Surcharge')\r\n\t)\r\n\tOR ird.InsuranceReferenceLineOfBusinessCode IN ('590', '812', '890', '900', '506' , '505' , '507')\r\n\tOR (ird.RatingPlanAbbreviation IN ('LRARO', 'Retro'))\r\n\tOR apc.asl_prdct_code in ('200', '220')\r\n\tOR cd.ClassCode = '0174' THEN 'N' ELSE 'Y' END\r\n\tEND\r\n\t) ,\r\n\t\tcdgl.ISOGeneralLiabilityClassGroupCode,\r\n\t\tcdcp.ISOCommercialPropertyRatingGroupCode,\r\n\t\tcdcp.RateType,\r\n\t\tcdcp.ISOCommercialPropertyCauseofLossGroup,\r\n\t\tcdca.VehicleTypeSize,\r\n\t\tcdca.BusinessUseClass,\r\n\t\tcdca.RadiusOfOperation,\r\n\t\tcdca.FleetType,\r\n\t\tcdca.SecondaryClassGroup,\r\n\t\tcdc.IndustryGroup,\r\n\t\tcdcp.ISOSpecialCauseOfLossCategoryCode,\r\n\t\tisnull(bcd.BusinessSegmentCode, 'N/A'),\r\n\t\tisnull(bcd.StrategicBusinessGroupCode, 'N/A'),\r\n\t\tpol_Current.edw_pol_ak_id,\r\n\t\tisnull(ircd.ISOMajorCrimeGroup,'N/A'),\r\n\t\tad_Current.AgencyStatusCode,\r\n\t--\tSD.AgencyStatusCode,\r\n\t\tad_Current.EDWAgencyAKID,\r\n\t\tcd.CensusBlockGroupCountyCode,\r\n\t\tcd.CensusBlockGroupTractCode,\r\n\t\tcd.CensusBlockGroupBlockGroupCode,\r\n\t\tcd.Latitude,\r\n\t\tcd.Longitude,\r\n\t\tcd.RatingTerritory,\r\n\t\t ccd.mailing_zip_postal_code\n),\nLKP_ASL_DIM AS (\n\tSELECT\n\tasl_dim_id,\n\tasl_code,\n\tasl_code_desc,\n\tsched_p_code,\n\tsched_p_desc,\n\tsub_asl_code,\n\tsub_asl_code_desc,\n\tsub_non_asl_code,\n\tsub_non_asl_code_desc\n\tFROM (\n\t\tSELECT\r\n\t\tasl.asl_dim_id AS asl_dim_id , \r\n\t\tasl.asl_code AS asl_code, \r\n\t\tasl.asl_code_descript AS asl_code_desc,     \r\n\t\tasl.sched_p_num as sched_p_code,  \r\n\t\tasl.sched_p_name as sched_p_desc,\r\n\t\tasl.sub_asl_code as sub_asl_code,\r\n\t\tasl.sub_asl_code_descript as sub_asl_code_desc,  \r\n\t\tasl.sub_non_asl_code as sub_non_asl_code,\r\n\t\tasl.sub_non_asl_code_descript as sub_non_asl_code_desc\r\n\t\tFROM  asl_dim asl\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY asl_dim_id ORDER BY asl_dim_id) = 1\n),\nLKP_AgencyRelationship AS (\n\tSELECT\n\tPrim_Agency_Code,\n\tPrim_Agency_State_Code,\n\tprim_agency_name,\n\tprim_agency_status_code,\n\tprim_agency_state_abbr,\n\tprim_agency_city,\n\tprim_agency_zip_code,\n\tEDWAgencyAKID\n\tFROM (\n\t\tselect Latest_LPAC.EDWAgencyAKId as EDWAgencyAKId ,\r\n\t\t  SD.agencycode as prim_agency_code,\r\n\t\t  Left((SD.agencycode),2) as prim_agency_state_code,\r\n\t\t  SD.AgencyDoingBusinessAsName as prim_agency_name,\r\n\t\tSD.AgencyStatusCode as prim_agency_status_code,\r\n\t\tSD.PhysicalStateAbbreviation as prim_agency_state_abbr,\r\n\t\tSD.PhysicalCity as prim_agency_city,\r\n\t\tSD.PhysicalZipCode as prim_agency_zip_code\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim SD \r\n\t\tInner Join  (\r\n\t\t Select EDWAgencyAKId,EDWLegalPrimaryAgencyAKId from \r\n\t\t  (\r\n\t\t\tselect EDWAgencyAKId, \r\n\t\t  EDWLegalPrimaryAgencyAKId, row_number() over (partition by edwAgencyAKID order by AgencyRelationshipexpirationdate desc ) As rowNum \r\n\t\t  from @{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyRelationshipCurrent\r\n\t\t  where AgencyRelationshipexpirationdate != '1800-01-01'\r\n\t\t  ) a\r\n\t\t  where a.rowNum = 1 \r\n\t\t  ) Latest_LPAC\r\n\t\t  on Latest_LPAC.EDWLegalPrimaryAgencyAKId=SD.EDWAgencyAKId\r\n\t\t  where SD.CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID ORDER BY Prim_Agency_Code) = 1\n),\nLKP_BusinessClassDim_SBG AS (\n\tSELECT\n\tBusinessSegmentDescription,\n\tStrategicBusinessGroupDescription,\n\tBusinessSegmentCode,\n\tStrategicBusinessGroupCode\n\tFROM (\n\t\tSELECT distinct \r\n\t\tBusinessSegmentDescription as BusinessSegmentDescription, \r\n\t\tStrategicBusinessGroupDescription as StrategicBusinessGroupDescription, \r\n\t\tBusinessSegmentCode as BusinessSegmentCode, \r\n\t\tStrategicBusinessGroupCode as StrategicBusinessGroupCode \r\n\t\tFROM BusinessClassDim\r\n\t\twhere\r\n\t\tCurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY BusinessSegmentCode,StrategicBusinessGroupCode ORDER BY BusinessSegmentDescription) = 1\n),\nLKP_CalendarDim AS (\n\tSELECT\n\tYear,\n\tMonth,\n\tacctg_qtr,\n\tacctg_year,\n\tacctg_mo\n\tFROM (\n\t\tSELECT DISTINCT \r\n\t\tc.clndr_yr as Year, \r\n\t\tc.clndr_month as Month, \r\n\t\tc.clndr_qtr as acctg_qtr, \r\n\t\tc.clndr_yr as acctg_year,\r\n\t\tc.clndr_month as acctg_mo\r\n\t\tFROM calendar_dim c\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY acctg_year,acctg_mo ORDER BY Year) = 1\n),\nLKP_InsuranceReferenceDim AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tent_grp_abbr,\n\tspc_abbr,\n\tlegal_ent_abbr,\n\tpol_offering_code,\n\tpol_offering_abbr,\n\tproduct_code,\n\tproduct_abbr,\n\tlob_code,\n\tlob_abbr,\n\tlob_desc,\n\tins_seg_code,\n\tins_seg_desc,\n\trating_plan,\n\tacctg_prod_abbr\n\tFROM (\n\t\tSELECT \r\n\t\tird.InsuranceReferenceDimId as InsuranceReferenceDimId  ,\r\n\t\tird.EnterpriseGroupAbbreviation as ent_grp_abbr,\r\n\t\tird.StrategicProfitCenterAbbreviation as spc_abbr,\r\n\t\tird.InsuranceReferenceLegalEntityAbbreviation as legal_ent_abbr,\r\n\t\tird.PolicyOfferingCode as pol_offering_code,\r\n\t\tird.PolicyOfferingAbbreviation as pol_offering_abbr,\r\n\t\tird.ProductCode as product_code,\r\n\t\tird.ProductAbbreviation as product_abbr,\r\n\t\tird.InsuranceReferenceLineOfBusinessCode as lob_code,\r\n\t\tird.InsuranceReferenceLineOfBusinessAbbreviation as lob_abbr,\r\n\t\tird.InsuranceReferenceLineOfBusinessDescription as lob_desc,\r\n\t\tird.InsuranceSegmentCode as ins_seg_code,\r\n\t\tird.InsuranceSegmentDescription as ins_seg_desc,\r\n\t\tird.RatingPlanDescription as rating_plan,\r\n\t\tird.AccountingProductAbbreviation as acctg_prod_abbr\r\n\t\tFROM InsuranceReferenceDim ird\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceReferenceDimId ORDER BY InsuranceReferenceDimId) = 1\n),\nLKP_PolicyCurrentStatusDim AS (\n\tSELECT\n\tPolicyCancellationDate,\n\tEDWPolicyAKId\n\tFROM (\n\t\tSELECT P.EDWPolicyAKId as EDWPolicyAKId, \r\n\t\tP.PolicyCancellationDate as PolicyCancellationDate\r\n\t\tFROM PolicyCurrentStatusDim P\r\n\t\tWHERE P.RunDate = (SELECT max(Pl.RunDate) FROM PolicyCurrentStatusDim Pl WHERE P.EDWPolicyAKId = Pl.EDWPolicyAKId) \r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWPolicyAKId ORDER BY PolicyCancellationDate) = 1\n),\nLKP_SalesDivisionDim AS (\n\tSELECT\n\tSalesDivisionDimID,\n\trsm_name,\n\tsal_terri_desc\n\tFROM (\n\t\tSELECT \r\n\t\ts.SalesDivisionDimID AS   SalesDivisionDimID ,\r\n\t\ts.RegionalSalesManagerDisplayName as rsm_name,\r\n\t\ts.SalesTerritoryCodeDescription as sal_terri_desc\r\n\t\tFROM   SalesDivisionDim s\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SalesDivisionDimID ORDER BY SalesDivisionDimID) = 1\n),\nLKP_policy_dim_descriptions AS (\n\tSELECT\n\tProgramDescription,\n\tAssociationDescription,\n\tQuoteChannel,\n\tQuoteChannelOrigin,\n\tedw_pol_ak_id\n\tFROM (\n\t\tselect edw_pol_ak_id as edw_pol_ak_id,\r\n\t\tAssociationDescription as AssociationDescription,\r\n\t\tProgramDescription as ProgramDescription,\r\n\t\tquotechannel as quotechannel,\r\n\t\tquotechannelorigin as quotechannelorigin \r\n\t\tfrom policy_dim \r\n\t\twhere crrnt_snpsht_flag = 1 \r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_ak_id ORDER BY ProgramDescription) = 1\n),\nEXP_Values AS (\n\tSELECT\n\tLKP_InsuranceReferenceDim.ent_grp_abbr,\n\tLKP_InsuranceReferenceDim.spc_abbr,\n\tv_pc_abbr AS pc_abbr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ins_seg_code = '3','Pool',\r\n\t-- pol_offering_code = '600','Bonds',\r\n\t-- spc_abbr = 'NSI','Specialty',\r\n\t-- spc_abbr = 'WB - PL','Personal',\r\n\t-- spc_abbr = 'WB - CL','Commercial',\r\n\t-- spc_abbr = 'NSI','Specialty',\r\n\t-- spc_abbr)\n\tDECODE(\n\t    TRUE,\n\t    ins_seg_code = '3', 'Pool',\n\t    pol_offering_code = '600', 'Bonds',\n\t    spc_abbr = 'NSI', 'Specialty',\n\t    spc_abbr = 'WB - PL', 'Personal',\n\t    spc_abbr = 'WB - CL', 'Commercial',\n\t    spc_abbr = 'NSI', 'Specialty',\n\t    spc_abbr\n\t) AS v_pc_abbr,\n\tLKP_InsuranceReferenceDim.legal_ent_abbr,\n\tLKP_InsuranceReferenceDim.pol_offering_code,\n\tLKP_InsuranceReferenceDim.pol_offering_abbr,\n\tLKP_InsuranceReferenceDim.product_code,\n\tLKP_InsuranceReferenceDim.product_abbr,\n\tLKP_InsuranceReferenceDim.lob_code,\n\tLKP_InsuranceReferenceDim.lob_abbr,\n\tLKP_InsuranceReferenceDim.lob_desc,\n\tLKP_InsuranceReferenceDim.ins_seg_code,\n\tLKP_InsuranceReferenceDim.ins_seg_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prog_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.assn_code,\n\tLKP_policy_dim_descriptions.ProgramDescription,\n\tLKP_policy_dim_descriptions.AssociationDescription,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_summ_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_summ_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_grp_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_grp_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cov_trigger_type,\n\tLKP_InsuranceReferenceDim.rating_plan,\n\t'N/A' AS type_of_loss,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_key,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_sym,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_no,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_ver,\n\tSQ_MonthlyActuarialAnalysis39_Premium.rating_state_code,\n\tnull AS loss_year,\n\tnull AS loss_qtr,\n\tnull AS loss_mo,\n\tnull AS claim_cat_code,\n\tLKP_CalendarDim.Year AS year,\n\tLKP_CalendarDim.Month AS month,\n\tLKP_CalendarDim.acctg_qtr,\n\tSQ_MonthlyActuarialAnalysis39_Premium.acctg_year,\n\tSQ_MonthlyActuarialAnalysis39_Premium.acctg_mo,\n\tSQ_MonthlyActuarialAnalysis39_Premium.producer_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.producer_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.cust_num,\n\tSQ_MonthlyActuarialAnalysis39_Premium.insured_name,\n\tLKP_ASL_DIM.asl_code,\n\tLKP_ASL_DIM.asl_code_desc,\n\tLKP_ASL_DIM.sched_p_code,\n\tLKP_ASL_DIM.sched_p_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.BusinessSegmentCode AS bus_seg_code,\n\tLKP_BusinessClassDim_SBG.BusinessSegmentDescription AS bus_seg_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prim_bus_class_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prim_bus_class_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.agency_state_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.agency_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.agency_name,\n\tLKP_SalesDivisionDim.rsm_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.uw_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.asst_uw_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.uw_mgr_name,\n\tLKP_AgencyRelationship.Prim_Agency_State_Code AS i_prim_agency_state_code,\n\tLKP_AgencyRelationship.Prim_Agency_Code AS i_prim_agency_code,\n\tLKP_AgencyRelationship.prim_agency_name AS i_prim_agency_name,\n\t-- *INF*: IIF(ISNULL(i_prim_agency_state_code),'NA',i_prim_agency_state_code)\n\tIFF(i_prim_agency_state_code IS NULL, 'NA', i_prim_agency_state_code) AS v_prim_agency_state_code,\n\t-- *INF*: IIF(ISNULL(i_prim_agency_code),'N/A',i_prim_agency_code)\n\tIFF(i_prim_agency_code IS NULL, 'N/A', i_prim_agency_code) AS v_prim_agency_code,\n\t-- *INF*: IIF(ISNULL(i_prim_agency_name),'N/A',i_prim_agency_name)\n\tIFF(i_prim_agency_name IS NULL, 'N/A', i_prim_agency_name) AS v_prim_agency_name,\n\tv_prim_agency_state_code AS o_prim_agency_state_code,\n\tv_prim_agency_code AS o_prim_agency_code,\n\tv_prim_agency_name AS o_prim_agency_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.new_bus_indic,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prim_rating_state_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.sic_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.sic_code_desc,\n\tLKP_ASL_DIM.sub_asl_code,\n\tLKP_ASL_DIM.sub_asl_code_desc,\n\tLKP_ASL_DIM.sub_non_asl_code,\n\tLKP_ASL_DIM.sub_non_asl_code_desc,\n\tLKP_SalesDivisionDim.sal_terri_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.uw_region_name,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_orig_incptn_date,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_eff_date,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pol_exp_date,\n\tLKP_PolicyCurrentStatusDim.PolicyCancellationDate AS pol_canc_date,\n\tLKP_InsuranceReferenceDim.acctg_prod_abbr,\n\tSQ_MonthlyActuarialAnalysis39_Premium.pma_code,\n\t-- *INF*: :LKP.LKP_CDD(pma_code)\n\tLKP_CDD_pma_code.pma_desc AS v_pma_desc,\n\tv_pma_desc AS pma_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.ilf_tbl,\n\t0 AS claim_num,\n\t-- *INF*: LAST_DAY(ADD_TO_DATE(ROUND(SYSDATE,'DD'), 'MM', -1))\n\tLAST_DAY(DATEADD(MONTH,- 1,ROUND(CURRENT_TIMESTAMP, 'DD'))) AS last_booked_date,\n\t0 AS pass_thru_amt,\n\t0 AS div_pay_amt,\n\t0 AS dep,\n\tSQ_MonthlyActuarialAnalysis39_Premium.dwp,\n\t0 AS subj_dep,\n\tSQ_MonthlyActuarialAnalysis39_Premium.subj_dwp,\n\t0 AS other_dep,\n\tSQ_MonthlyActuarialAnalysis39_Premium.other_dwp,\n\t0 AS expmod_dep,\n\tSQ_MonthlyActuarialAnalysis39_Premium.expmod_dwp,\n\t0 AS schmod_dep,\n\tSQ_MonthlyActuarialAnalysis39_Premium.schmod_dwp,\n\t0 AS loss_inc,\n\t0 AS loss_pd,\n\t0 AS alae_pd,\n\t0 AS alae_inc,\n\t0 AS ph_div_payable,\n\tSQ_MonthlyActuarialAnalysis39_Premium.agency_contigent_ind,\n\tSQ_MonthlyActuarialAnalysis39_Premium.gl_class_grp,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prop_rating_group,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prop_rate_type,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prop_col_grp,\n\tSQ_MonthlyActuarialAnalysis39_Premium.auto_veh_type,\n\tSQ_MonthlyActuarialAnalysis39_Premium.auto_use_class,\n\tSQ_MonthlyActuarialAnalysis39_Premium.auto_radius,\n\tSQ_MonthlyActuarialAnalysis39_Premium.auto_fleet_type,\n\tSQ_MonthlyActuarialAnalysis39_Premium.auto_sec_class_grp,\n\tSQ_MonthlyActuarialAnalysis39_Premium.crime_ind_grp,\n\tSQ_MonthlyActuarialAnalysis39_Premium.prop_spec_col_cat,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(gl_class_grp))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(gl_class_grp)) AS o_gl_class_grp,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rating_group)) \n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rating_group)) AS o_prop_rating_group,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rate_type))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rate_type)) AS o_prop_rate_type,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_col_grp))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_col_grp)) AS o_prop_col_grp,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_veh_type))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_veh_type)) AS o_auto_veh_type,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_use_class))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_use_class)) AS o_auto_use_class,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_radius))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_radius)) AS o_auto_radius,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_fleet_type))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_fleet_type)) AS o_auto_fleet_type,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_sec_class_grp))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_sec_class_grp)) AS o_auto_sec_class_grp,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(crime_ind_grp))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(crime_ind_grp)) AS o_crime_ind_grp,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_spec_col_cat))\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_spec_col_cat)) AS o_prop_spec_col_cat,\n\tSQ_MonthlyActuarialAnalysis39_Premium.StrategicBusinessGroupCode AS sbg_code,\n\tLKP_BusinessClassDim_SBG.StrategicBusinessGroupDescription AS sbg_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.ISOMajorCrimeGroup,\n\tSQ_MonthlyActuarialAnalysis39_Premium.AgencyStatusCode AS i_AgencyStatusCode,\n\t-- *INF*: IIF(ISNULL(i_AgencyStatusCode),'0',i_AgencyStatusCode)\n\tIFF(i_AgencyStatusCode IS NULL, '0', i_AgencyStatusCode) AS v_AgencyStatusCode,\n\tv_AgencyStatusCode AS o_AgencyStatusCode,\n\tLKP_AgencyRelationship.prim_agency_status_code AS i_PrimaryAgencyStatusCode,\n\t-- *INF*: IIF(ISNULL(i_PrimaryAgencyStatusCode),'0',i_PrimaryAgencyStatusCode)\n\tIFF(i_PrimaryAgencyStatusCode IS NULL, '0', i_PrimaryAgencyStatusCode) AS v_PrimaryAgencyStatusCode,\n\tv_PrimaryAgencyStatusCode AS o_PrimaryAgencyStatusCode,\n\t'Premium' AS Rec_Type,\n\tyear*10+1 AS year_rt,\n\tSQ_MonthlyActuarialAnalysis39_Premium.rated_cov_code,\n\tSQ_MonthlyActuarialAnalysis39_Premium.rated_cov_desc,\n\tSQ_MonthlyActuarialAnalysis39_Premium.CensusBlockGroupCountyCode AS i_CensusBlockGroupCountyCode,\n\t-- *INF*: IIF(ISNULL(i_CensusBlockGroupCountyCode),'N/A',i_CensusBlockGroupCountyCode)\n\tIFF(i_CensusBlockGroupCountyCode IS NULL, 'N/A', i_CensusBlockGroupCountyCode) AS v_CensusBlockGroupCountyCode,\n\tv_CensusBlockGroupCountyCode AS o_CensusBlockGroupCountyCode,\n\tSQ_MonthlyActuarialAnalysis39_Premium.CensusBlockGroupTractCode AS i_CensusBlockGroupTractCode,\n\t-- *INF*: IIF(ISNULL(i_CensusBlockGroupTractCode),'N/A',i_CensusBlockGroupTractCode)\n\tIFF(i_CensusBlockGroupTractCode IS NULL, 'N/A', i_CensusBlockGroupTractCode) AS v_CensusBlockGroupTractCode,\n\tv_CensusBlockGroupTractCode AS o_CensusBlockGroupTractCode,\n\tSQ_MonthlyActuarialAnalysis39_Premium.CensusBlockGroupBlockGroupCode AS i_CensusBlockGroupBlockGroupCode,\n\t-- *INF*: IIF(ISNULL(i_CensusBlockGroupBlockGroupCode),'N/A',i_CensusBlockGroupBlockGroupCode)\n\tIFF(i_CensusBlockGroupBlockGroupCode IS NULL, 'N/A', i_CensusBlockGroupBlockGroupCode) AS v_CensusBlockGroupBlockGroupCode,\n\tv_CensusBlockGroupBlockGroupCode AS o_CensusBlockGroupBlockGroupCode,\n\tSQ_MonthlyActuarialAnalysis39_Premium.Latitude AS i_Latitude,\n\t-- *INF*: IIF(ISNULL(i_Latitude),0.00,i_Latitude)\n\tIFF(i_Latitude IS NULL, 0.00, i_Latitude) AS v_Latitude,\n\tv_Latitude AS o_Latitude,\n\tSQ_MonthlyActuarialAnalysis39_Premium.Longitude AS i_Longitude,\n\t-- *INF*: IIF(ISNULL(i_Longitude),0.00,i_Longitude)\n\tIFF(i_Longitude IS NULL, 0.00, i_Longitude) AS v_Longitude,\n\tv_Longitude AS o_Longitude,\n\tSQ_MonthlyActuarialAnalysis39_Premium.RatingTerritory AS i_RatingTerritory,\n\t-- *INF*: SUBSTR(IIF(ISNULL(i_RatingTerritory),'N/A',i_RatingTerritory),0 ,3)\n\tSUBSTR(\n\t    IFF(\n\t        i_RatingTerritory IS NULL, 'N/A', i_RatingTerritory\n\t    ), 0, 3) AS v_RatingTerritory,\n\tv_RatingTerritory AS o_RatingTerritory,\n\t'N/A' AS Catalyst,\n\t'N/A' AS CauseOfDamage,\n\t'N/A' AS DamageCaused,\n\t'N/A' AS ItemDamaged,\n\tSQ_MonthlyActuarialAnalysis39_Premium.serv_center_support_code,\n\t'0' AS o_Defaultvalue,\n\tLKP_policy_dim_descriptions.QuoteChannel,\n\t-- *INF*: iif(isnull(QuoteChannel) , 'N/A' , QuoteChannel)\n\tIFF(QuoteChannel IS NULL, 'N/A', QuoteChannel) AS v_QuoteChannel,\n\tv_QuoteChannel AS o_QuoteChannel,\n\tLKP_policy_dim_descriptions.QuoteChannelOrigin,\n\t-- *INF*: iif(isnull(QuoteChannelOrigin) , 'N/A' , QuoteChannelOrigin)\n\tIFF(QuoteChannelOrigin IS NULL, 'N/A', QuoteChannelOrigin) AS v_QuoteChannelOrigin,\n\tv_QuoteChannelOrigin AS o_QuoteChannelOrigin,\n\tSQ_MonthlyActuarialAnalysis39_Premium.RatingStateAbbreviation AS i_RatingStateAbbreviation,\n\t-- *INF*: iif(isnull(i_RatingStateAbbreviation) , 'N/A' , i_RatingStateAbbreviation)\n\tIFF(i_RatingStateAbbreviation IS NULL, 'N/A', i_RatingStateAbbreviation) AS v_RatingStateAbbreviation,\n\tv_RatingStateAbbreviation AS o_RatingStateAbbreviation,\n\tSQ_MonthlyActuarialAnalysis39_Premium.mailing_zip_postal_code,\n\t-- *INF*: MD5(\r\n\t-- :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ent_grp_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(spc_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_pc_abbr)) \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(legal_ent_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_offering_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_offering_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(product_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(product_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(lob_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(lob_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(lob_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ins_seg_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ins_seg_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prog_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ProgramDescription))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(assn_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(AssociationDescription))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_summ_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_summ_desc))\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_grp_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_grp_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_desc))\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cov_trigger_type))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(rating_plan))\r\n\t-- || '^' || 'N/A'      --type_of_loss\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_key))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_sym))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_no))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_ver))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(rating_state_code))\r\n\t-- || '^' || 'NULL'    --loss_year\r\n\t-- || '^' || 'NULL'    --loss_qtr\r\n\t-- || '^' || 'NULL'    --loss_mo\r\n\t-- \r\n\t-- || '^' || 'NULL'   --claim_cat_code\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(year))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(month))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_qtr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_year))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_mo))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(producer_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(producer_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(cust_num))\r\n\t-- \r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(insured_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(asl_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(asl_code_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sched_p_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sched_p_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(bus_seg_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(bus_seg_desc))\r\n\t-- ---wreq-10769 getting seg code,desc,sbg from lkp businessclassdim\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sbg_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sbg_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prim_bus_class_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prim_bus_class_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(agency_state_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(agency_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(agency_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(rsm_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(uw_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(asst_uw_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(uw_mgr_name))\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_state_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_name))\r\n\t-- \r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(new_bus_indic))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prim_rating_state_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sic_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sic_code_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sub_asl_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sub_asl_code_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sub_non_asl_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sub_non_asl_code_desc))\r\n\t-- \r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(sal_terri_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(uw_region_name))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_orig_incptn_date))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_eff_date))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_exp_date))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pol_canc_date))\r\n\t-- \r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_prod_abbr))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(pma_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_pma_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ilf_tbl))\r\n\t-- \r\n\t-- || '^' || '0'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(TO_CHAR(LAST_DAY(ADD_TO_DATE(ROUND(SYSDATE,'DD'), 'MM', -1)),'YYYY-MM-DD'))\r\n\t-- || '^' || '0.00'         --pass_thru_amt\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(dwp,2)))\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(subj_dwp,2)))\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(other_dwp,2)))\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(expmod_dwp,2)))\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(schmod_dwp,2)))\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || '0.00'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(agency_contigent_ind))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(gl_class_grp))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rating_group))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rate_type))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_col_grp))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_veh_type))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_use_class))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_radius))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_fleet_type))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(auto_sec_class_grp))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(crime_ind_grp))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(prop_spec_col_cat))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(ISOMajorCrimeGroup))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_AgencyStatusCode))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_PrimaryAgencyStatusCode))\r\n\t-- || '^' || 'Premium'\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(year*10+1))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(rated_cov_code))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(rated_cov_desc))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupCountyCode)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupTractCode)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupBlockGroupCode)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_Longitude))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(to_char(v_Latitude))\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_RatingTerritory)\r\n\t-- || '^' || 'N/A'      --Catalyst\r\n\t-- || '^' || 'N/A'      --CauseOfDamage\r\n\t-- || '^' || 'N/A'      --DamageCaused\r\n\t-- || '^' || 'N/A'      --ItemDamaged\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(serv_center_support_code)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_QuoteChannel)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_QuoteChannelOrigin)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(v_RatingStateAbbreviation)\r\n\t-- || '^' || :UDF.DEFAULT_VALUE_FOR_STRINGS(mailing_zip_postal_code)\r\n\t-- )\n\tMD5(UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ent_grp_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(spc_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_pc_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(legal_ent_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_offering_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_offering_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(product_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(product_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(lob_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(lob_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(lob_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ins_seg_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ins_seg_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prog_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ProgramDescription)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(assn_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(AssociationDescription)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_summ_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_summ_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_grp_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_grp_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cov_trigger_type)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(rating_plan)) || '^' || 'N/A' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_key)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_sym)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_no)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_ver)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(rating_state_code)) || '^' || 'NULL' || '^' || 'NULL' || '^' || 'NULL' || '^' || 'NULL' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(year)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(month)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_qtr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_year)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_mo)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(producer_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(producer_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(cust_num)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(insured_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(asl_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(asl_code_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sched_p_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sched_p_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(bus_seg_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(bus_seg_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sbg_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sbg_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prim_bus_class_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prim_bus_class_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(agency_state_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(agency_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(agency_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(rsm_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(uw_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(asst_uw_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(uw_mgr_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_state_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_prim_agency_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(new_bus_indic)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prim_rating_state_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sic_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sic_code_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sub_asl_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sub_asl_code_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sub_non_asl_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sub_non_asl_code_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(sal_terri_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(uw_region_name)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_orig_incptn_date)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_eff_date)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_exp_date)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pol_canc_date)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(acctg_prod_abbr)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(pma_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_pma_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ilf_tbl)) || '^' || '0' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(TO_CHAR(LAST_DAY(DATEADD(MONTH,- 1,ROUND(CURRENT_TIMESTAMP, 'DD'))), 'YYYY-MM-DD')) || '^' || '0.00' || '^' || '0.00' || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(dwp, 2))) || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(subj_dwp, 2))) || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(other_dwp, 2))) || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(expmod_dwp, 2))) || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ROUND(schmod_dwp, 2))) || '^' || '0.00' || '^' || '0.00' || '^' || '0.00' || '^' || '0.00' || '^' || '0.00' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(agency_contigent_ind)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(gl_class_grp)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rating_group)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_rate_type)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_col_grp)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_veh_type)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_use_class)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_radius)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_fleet_type)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(auto_sec_class_grp)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(crime_ind_grp)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(prop_spec_col_cat)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(ISOMajorCrimeGroup)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_AgencyStatusCode)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_PrimaryAgencyStatusCode)) || '^' || 'Premium' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(year * 10 + 1)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(rated_cov_code)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(rated_cov_desc)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupCountyCode) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupTractCode) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_CensusBlockGroupBlockGroupCode) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_Longitude)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(to_char(v_Latitude)) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_RatingTerritory) || '^' || 'N/A' || '^' || 'N/A' || '^' || 'N/A' || '^' || 'N/A' || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(serv_center_support_code) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_QuoteChannel) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_QuoteChannelOrigin) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(v_RatingStateAbbreviation) || '^' || UDF_DEFAULT_VALUE_FOR_STRINGS(mailing_zip_postal_code)) AS v_HashKey,\n\tv_HashKey AS HashKey\n\tFROM SQ_MonthlyActuarialAnalysis39_Premium\n\tLEFT JOIN LKP_ASL_DIM\n\tON LKP_ASL_DIM.asl_dim_id = SQ_MonthlyActuarialAnalysis39_Premium.asl_dim_id\n\tLEFT JOIN LKP_AgencyRelationship\n\tON LKP_AgencyRelationship.EDWAgencyAKID = SQ_MonthlyActuarialAnalysis39_Premium.EDWAgencyAKID\n\tLEFT JOIN LKP_BusinessClassDim_SBG\n\tON LKP_BusinessClassDim_SBG.BusinessSegmentCode = SQ_MonthlyActuarialAnalysis39_Premium.BusinessSegmentCode AND LKP_BusinessClassDim_SBG.StrategicBusinessGroupCode = SQ_MonthlyActuarialAnalysis39_Premium.StrategicBusinessGroupCode\n\tLEFT JOIN LKP_CalendarDim\n\tON LKP_CalendarDim.acctg_year = SQ_MonthlyActuarialAnalysis39_Premium.acctg_year AND LKP_CalendarDim.acctg_mo = SQ_MonthlyActuarialAnalysis39_Premium.acctg_mo\n\tLEFT JOIN LKP_InsuranceReferenceDim\n\tON LKP_InsuranceReferenceDim.InsuranceReferenceDimId = SQ_MonthlyActuarialAnalysis39_Premium.InsuranceReferenceDimId\n\tLEFT JOIN LKP_PolicyCurrentStatusDim\n\tON LKP_PolicyCurrentStatusDim.EDWPolicyAKId = SQ_MonthlyActuarialAnalysis39_Premium.edw_pol_ak_id\n\tLEFT JOIN LKP_SalesDivisionDim\n\tON LKP_SalesDivisionDim.SalesDivisionDimID = SQ_MonthlyActuarialAnalysis39_Premium.SalesDivisionDimID\n\tLEFT JOIN LKP_policy_dim_descriptions\n\tON LKP_policy_dim_descriptions.edw_pol_ak_id = SQ_MonthlyActuarialAnalysis39_Premium.edw_pol_ak_id\n\tLEFT JOIN LKP_CDD LKP_CDD_pma_code\n\tON LKP_CDD_pma_code.pma_code = pma_code\n\n),\nLKP_AA39Monthly AS (\n\tSELECT\n\tHashKey,\n\tin_HashKey\n\tFROM (\n\t\tSELECT HashKey AS HashKey\r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.AA39Monthly\r\n\t\tWHERE Rec_Type = 'Premium' \r\n\t\t@{pipeline().parameters.WHERE_CLAUSE_LKP} --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY HashKey ORDER BY HashKey) = 1\n),\nEXP_Detect AS (\n\tSELECT\n\tLKP_AA39Monthly.HashKey AS lkp_HashKey,\n\tEXP_Values.ent_grp_abbr,\n\tEXP_Values.spc_abbr,\n\tEXP_Values.pc_abbr,\n\tEXP_Values.legal_ent_abbr,\n\tEXP_Values.pol_offering_code,\n\tEXP_Values.pol_offering_abbr,\n\tEXP_Values.product_code,\n\tEXP_Values.product_abbr,\n\tEXP_Values.lob_code,\n\tEXP_Values.lob_abbr,\n\tEXP_Values.lob_desc,\n\tEXP_Values.ins_seg_code,\n\tEXP_Values.ins_seg_desc,\n\tEXP_Values.prog_code,\n\tEXP_Values.ProgramDescription AS prog_desc,\n\tEXP_Values.assn_code,\n\tEXP_Values.AssociationDescription AS assn_desc,\n\tEXP_Values.cov_summ_code,\n\tEXP_Values.cov_summ_desc,\n\tEXP_Values.cov_grp_code,\n\tEXP_Values.cov_grp_desc,\n\tEXP_Values.cov_code,\n\tEXP_Values.cov_desc,\n\tEXP_Values.cov_trigger_type,\n\tEXP_Values.rating_plan,\n\tEXP_Values.type_of_loss,\n\tEXP_Values.pol_key,\n\tEXP_Values.pol_sym,\n\tEXP_Values.pol_no,\n\tEXP_Values.pol_ver,\n\tEXP_Values.rating_state_code,\n\tEXP_Values.loss_year,\n\tEXP_Values.loss_qtr,\n\tEXP_Values.loss_mo,\n\tEXP_Values.year,\n\tEXP_Values.month,\n\tEXP_Values.acctg_qtr,\n\tEXP_Values.acctg_year,\n\tEXP_Values.acctg_mo,\n\tEXP_Values.producer_code,\n\tEXP_Values.producer_name,\n\tEXP_Values.cust_num,\n\tEXP_Values.insured_name,\n\tEXP_Values.asl_code,\n\tEXP_Values.asl_code_desc,\n\tEXP_Values.sched_p_code,\n\tEXP_Values.sched_p_desc,\n\tEXP_Values.bus_seg_code,\n\tEXP_Values.bus_seg_desc,\n\tEXP_Values.prim_bus_class_code,\n\tEXP_Values.prim_bus_class_desc,\n\tEXP_Values.agency_state_code,\n\tEXP_Values.agency_code,\n\tEXP_Values.agency_name,\n\tEXP_Values.rsm_name,\n\tEXP_Values.uw_name,\n\tEXP_Values.asst_uw_name,\n\tEXP_Values.uw_mgr_name,\n\tEXP_Values.o_prim_agency_state_code AS prim_agency_state_code,\n\tEXP_Values.o_prim_agency_code AS prim_agency_code,\n\tEXP_Values.o_prim_agency_name AS prim_agency_name,\n\tEXP_Values.new_bus_indic,\n\tEXP_Values.prim_rating_state_code,\n\tEXP_Values.sic_code,\n\tEXP_Values.sic_code_desc,\n\tEXP_Values.sub_asl_code,\n\tEXP_Values.sub_asl_code_desc,\n\tEXP_Values.sub_non_asl_code,\n\tEXP_Values.sub_non_asl_code_desc,\n\tEXP_Values.sal_terri_desc,\n\tEXP_Values.uw_region_name,\n\tEXP_Values.pol_orig_incptn_date,\n\tEXP_Values.pol_eff_date,\n\tEXP_Values.pol_exp_date,\n\tEXP_Values.pol_canc_date,\n\tEXP_Values.acctg_prod_abbr,\n\tEXP_Values.pma_code,\n\tEXP_Values.pma_desc,\n\tEXP_Values.ilf_tbl,\n\tEXP_Values.claim_num,\n\tEXP_Values.last_booked_date,\n\tEXP_Values.pass_thru_amt,\n\tEXP_Values.div_pay_amt,\n\tEXP_Values.dep,\n\tEXP_Values.dwp,\n\tEXP_Values.subj_dep,\n\tEXP_Values.subj_dwp,\n\tEXP_Values.other_dep,\n\tEXP_Values.other_dwp,\n\tEXP_Values.expmod_dep,\n\tEXP_Values.expmod_dwp,\n\tEXP_Values.schmod_dep,\n\tEXP_Values.schmod_dwp,\n\tEXP_Values.loss_inc,\n\tEXP_Values.loss_pd,\n\tEXP_Values.alae_pd,\n\tEXP_Values.alae_inc,\n\tEXP_Values.ph_div_payable,\n\tEXP_Values.agency_contigent_ind,\n\tEXP_Values.o_gl_class_grp AS gl_class_grp,\n\tEXP_Values.o_prop_rating_group AS prop_rating_group,\n\tEXP_Values.o_prop_rate_type AS prop_rate_type,\n\tEXP_Values.o_prop_col_grp AS prop_col_grp,\n\tEXP_Values.o_auto_veh_type AS auto_veh_type,\n\tEXP_Values.o_auto_use_class AS auto_use_class,\n\tEXP_Values.o_auto_radius AS auto_radius,\n\tEXP_Values.o_auto_fleet_type AS auto_fleet_type,\n\tEXP_Values.o_auto_sec_class_grp AS auto_sec_class_grp,\n\tEXP_Values.o_crime_ind_grp AS crime_ind_grp,\n\tEXP_Values.o_prop_spec_col_cat AS prop_spec_col_cat,\n\tEXP_Values.Rec_Type,\n\tEXP_Values.year_rt,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(lkp_HashKey),'INSERT'\r\n\t-- ,'UNCHANGE')\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    lkp_HashKey IS NULL, 'INSERT',\n\t    'UNCHANGE'\n\t) AS v_ChangeFlag,\n\tv_ChangeFlag AS o_ChangeFlag,\n\tEXP_Values.sbg_code,\n\tEXP_Values.sbg_desc,\n\tEXP_Values.ISOMajorCrimeGroup,\n\tEXP_Values.o_AgencyStatusCode AS AgencyStatusCode,\n\tEXP_Values.o_PrimaryAgencyStatusCode AS PrimaryAgencyStatusCode,\n\tEXP_Values.rated_cov_code,\n\tEXP_Values.rated_cov_desc,\n\tEXP_Values.o_CensusBlockGroupCountyCode AS CensusBlockGroupCountyCode,\n\tEXP_Values.o_CensusBlockGroupTractCode AS CensusBlockGroupTractCode,\n\tEXP_Values.o_CensusBlockGroupBlockGroupCode AS CensusBlockGroupBlockGroupCode,\n\tEXP_Values.o_Latitude AS Latitude,\n\tEXP_Values.o_Longitude AS Longitude,\n\tEXP_Values.o_RatingTerritory AS RatingTerritory,\n\tEXP_Values.Catalyst,\n\tEXP_Values.CauseOfDamage,\n\tEXP_Values.DamageCaused,\n\tEXP_Values.ItemDamaged,\n\tEXP_Values.HashKey,\n\tEXP_Values.serv_center_support_code,\n\tEXP_Values.claim_cat_code,\n\tEXP_Values.o_Defaultvalue AS CustomerInforceInd,\n\tEXP_Values.o_Defaultvalue AS CustomerProductInforceInd,\n\tEXP_Values.o_QuoteChannel AS QuoteChannel,\n\tEXP_Values.o_QuoteChannelOrigin AS QuoteChannelOrigin,\n\tEXP_Values.o_RatingStateAbbreviation AS RatingStateAbbreviation,\n\tEXP_Values.mailing_zip_postal_code\n\tFROM EXP_Values\n\tLEFT JOIN LKP_AA39Monthly\n\tON LKP_AA39Monthly.HashKey = EXP_Values.HashKey\n),\nRTR_Insert AS (\n\tSELECT\n\tent_grp_abbr,\n\tspc_abbr,\n\tpc_abbr,\n\tlegal_ent_abbr,\n\tpol_offering_code,\n\tpol_offering_abbr,\n\tproduct_code,\n\tproduct_abbr,\n\tlob_code,\n\tlob_abbr,\n\tlob_desc,\n\tins_seg_code,\n\tins_seg_desc,\n\tprog_code,\n\tprog_desc,\n\tassn_code,\n\tassn_desc,\n\tcov_summ_code,\n\tcov_summ_desc,\n\tcov_grp_code,\n\tcov_grp_desc,\n\tcov_code,\n\tcov_desc,\n\tcov_trigger_type,\n\trating_plan,\n\ttype_of_loss,\n\tpol_key,\n\tpol_sym,\n\tpol_no,\n\tpol_ver,\n\trating_state_code,\n\tloss_year,\n\tloss_qtr,\n\tloss_mo,\n\tyear,\n\tmonth,\n\tacctg_qtr,\n\tacctg_year,\n\tacctg_mo,\n\tproducer_code,\n\tproducer_name,\n\tcust_num,\n\tinsured_name,\n\tasl_code,\n\tasl_code_desc,\n\tsched_p_code,\n\tsched_p_desc,\n\tbus_seg_code,\n\tbus_seg_desc,\n\tprim_bus_class_code,\n\tprim_bus_class_desc,\n\tagency_state_code,\n\tagency_code,\n\tagency_name,\n\trsm_name,\n\tuw_name,\n\tasst_uw_name,\n\tuw_mgr_name,\n\tprim_agency_state_code,\n\tprim_agency_code,\n\tprim_agency_name,\n\tnew_bus_indic,\n\tprim_rating_state_code,\n\tsic_code,\n\tsic_code_desc,\n\tsub_asl_code,\n\tsub_asl_code_desc,\n\tsub_non_asl_code,\n\tsub_non_asl_code_desc,\n\tsal_terri_desc,\n\tuw_region_name,\n\tpol_orig_incptn_date,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_canc_date,\n\tacctg_prod_abbr,\n\tpma_code,\n\tpma_desc,\n\tilf_tbl,\n\tclaim_num,\n\tlast_booked_date,\n\tpass_thru_amt,\n\tdiv_pay_amt,\n\tdep,\n\tdwp,\n\tsubj_dep,\n\tsubj_dwp,\n\tother_dep,\n\tother_dwp,\n\texpmod_dep,\n\texpmod_dwp,\n\tschmod_dep,\n\tschmod_dwp,\n\tloss_inc,\n\tloss_pd,\n\talae_pd,\n\talae_inc,\n\tph_div_payable,\n\tagency_contigent_ind,\n\tgl_class_grp,\n\tprop_rating_group,\n\tprop_rate_type,\n\tprop_col_grp,\n\tauto_veh_type,\n\tauto_use_class,\n\tauto_radius,\n\tauto_fleet_type,\n\tauto_sec_class_grp,\n\tcrime_ind_grp,\n\tprop_spec_col_cat,\n\tRec_Type,\n\tyear_rt,\n\tHashKey,\n\to_ChangeFlag AS ChangeFlag,\n\tsbg_code,\n\tsbg_desc,\n\tISOMajorCrimeGroup,\n\tAgencyStatusCode,\n\tPrimaryAgencyStatusCode,\n\trated_cov_code,\n\trated_cov_desc,\n\tCensusBlockGroupCountyCode,\n\tCensusBlockGroupTractCode,\n\tCensusBlockGroupBlockGroupCode,\n\tLatitude,\n\tLongitude,\n\tRatingTerritory,\n\tCatalyst,\n\tCauseOfDamage,\n\tDamageCaused,\n\tItemDamaged,\n\tserv_center_support_code,\n\tclaim_cat_code,\n\tCustomerInforceInd,\n\tCustomerProductInforceInd,\n\tQuoteChannel,\n\tQuoteChannelOrigin,\n\tRatingStateAbbreviation,\n\tmailing_zip_postal_code\n\tFROM EXP_Detect\n),\nRTR_Insert_INSERT AS (SELECT * FROM RTR_Insert WHERE ChangeFlag='INSERT'),\nRTR_Insert_NOCHANGE AS (SELECT * FROM RTR_Insert WHERE ChangeFlag='UNCHANGE'),\nAA39Monthly_Premium AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.AA39Monthly\n\t(ent_grp_abbr, spc_abbr, legal_ent_abbr, pol_offering_code, pol_offering_abbr, product_code, product_abbr, lob_code, lob_abbr, lob_desc, ins_seg_code, ins_seg_desc, prog_code, prog_desc, assn_code, assn_desc, cov_summ_code, cov_summ_desc, cov_grp_code, cov_grp_desc, cov_code, cov_desc, cov_trigger_type, rating_plan, type_of_loss, pol_key, pol_sym, pol_no, pol_ver, rating_state_code, loss_year, loss_qtr, loss_mo, year, month, acctg_qtr, acctg_year, acctg_mo, producer_code, producer_name, cust_num, insured_name, asl_code, asl_code_desc, sched_p_code, sched_p_desc, bus_seg_code, bus_seg_desc, prim_bus_class_code, prim_bus_class_desc, agency_state_code, agency_code, agency_name, rsm_name, uw_name, asst_uw_name, uw_mgr_name, prim_agency_state_code, prim_agency_code, prim_agency_name, new_bus_indic, prim_rating_state_code, sic_code, sic_code_desc, sub_asl_code, sub_asl_code_desc, sub_non_asl_code, sub_non_asl_code_desc, sal_terri_desc, uw_region_name, pol_orig_incptn_date, pol_eff_date, pol_exp_date, pol_canc_date, acctg_prod_abbr, pma_code, pma_desc, ilf_tbl, claim_num, last_booked_date, pass_thru_amt, div_pay_amt, dep, dwp, subj_dep, subj_dwp, other_dep, other_dwp, expmod_dep, expmod_dwp, schmod_dep, schmod_dwp, loss_inc, loss_pd, alae_pd, alae_inc, ph_div_payable, agency_contigent_ind, gl_class_grp, prop_rating_group, prop_rate_type, prop_col_grp, auto_veh_type, auto_use_class, auto_radius, auto_fleet_type, auto_sec_class_grp, crime_ind_grp, prop_spec_col_cat, Rec_Type, Year_rt, HashKey, sbg_code, sbg_desc, maj_crime_grp, agency_status_code, prim_agency_status_code, rated_cov_code, rated_cov_desc, CBG_County, CBG_Tract, CBG_Block, Territory_code, Latitude, Longitude, cs_catalyst, cs_cause_of_damage, cs_damage_caused, cs_item_damaged, serv_center_support_code, claim_cat_code, CustomerInforceInd, CustomerProductInforceInd, QuoteChannel, QuoteChannelOrigin, RatingStateAbbreviation, pc_abbr, mailing_zip_postal_code)\n\tSELECT \n\tENT_GRP_ABBR, \n\tSPC_ABBR, \n\tLEGAL_ENT_ABBR, \n\tPOL_OFFERING_CODE, \n\tPOL_OFFERING_ABBR, \n\tPRODUCT_CODE, \n\tPRODUCT_ABBR, \n\tLOB_CODE, \n\tLOB_ABBR, \n\tLOB_DESC, \n\tINS_SEG_CODE, \n\tINS_SEG_DESC, \n\tPROG_CODE, \n\tPROG_DESC, \n\tASSN_CODE, \n\tASSN_DESC, \n\tCOV_SUMM_CODE, \n\tCOV_SUMM_DESC, \n\tCOV_GRP_CODE, \n\tCOV_GRP_DESC, \n\tCOV_CODE, \n\tCOV_DESC, \n\tCOV_TRIGGER_TYPE, \n\tRATING_PLAN, \n\tTYPE_OF_LOSS, \n\tPOL_KEY, \n\tPOL_SYM, \n\tPOL_NO, \n\tPOL_VER, \n\tRATING_STATE_CODE, \n\tLOSS_YEAR, \n\tLOSS_QTR, \n\tLOSS_MO, \n\tYEAR, \n\tMONTH, \n\tACCTG_QTR, \n\tACCTG_YEAR, \n\tACCTG_MO, \n\tPRODUCER_CODE, \n\tPRODUCER_NAME, \n\tCUST_NUM, \n\tINSURED_NAME, \n\tASL_CODE, \n\tASL_CODE_DESC, \n\tSCHED_P_CODE, \n\tSCHED_P_DESC, \n\tBUS_SEG_CODE, \n\tBUS_SEG_DESC, \n\tPRIM_BUS_CLASS_CODE, \n\tPRIM_BUS_CLASS_DESC, \n\tAGENCY_STATE_CODE, \n\tAGENCY_CODE, \n\tAGENCY_NAME, \n\tRSM_NAME, \n\tUW_NAME, \n\tASST_UW_NAME, \n\tUW_MGR_NAME, \n\tPRIM_AGENCY_STATE_CODE, \n\tPRIM_AGENCY_CODE, \n\tPRIM_AGENCY_NAME, \n\tNEW_BUS_INDIC, \n\tPRIM_RATING_STATE_CODE, \n\tSIC_CODE, \n\tSIC_CODE_DESC, \n\tSUB_ASL_CODE, \n\tSUB_ASL_CODE_DESC, \n\tSUB_NON_ASL_CODE, \n\tSUB_NON_ASL_CODE_DESC, \n\tSAL_TERRI_DESC, \n\tUW_REGION_NAME, \n\tPOL_ORIG_INCPTN_DATE, \n\tPOL_EFF_DATE, \n\tPOL_EXP_DATE, \n\tPOL_CANC_DATE, \n\tACCTG_PROD_ABBR, \n\tPMA_CODE, \n\tPMA_DESC, \n\tILF_TBL, \n\tCLAIM_NUM, \n\tLAST_BOOKED_DATE, \n\tPASS_THRU_AMT, \n\tDIV_PAY_AMT, \n\tDEP, \n\tDWP, \n\tSUBJ_DEP, \n\tSUBJ_DWP, \n\tOTHER_DEP, \n\tOTHER_DWP, \n\tEXPMOD_DEP, \n\tEXPMOD_DWP, \n\tSCHMOD_DEP, \n\tSCHMOD_DWP, \n\tLOSS_INC, \n\tLOSS_PD, \n\tALAE_PD, \n\tALAE_INC, \n\tPH_DIV_PAYABLE, \n\tAGENCY_CONTIGENT_IND, \n\tGL_CLASS_GRP, \n\tPROP_RATING_GROUP, \n\tPROP_RATE_TYPE, \n\tPROP_COL_GRP, \n\tAUTO_VEH_TYPE, \n\tAUTO_USE_CLASS, \n\tAUTO_RADIUS, \n\tAUTO_FLEET_TYPE, \n\tAUTO_SEC_CLASS_GRP, \n\tCRIME_IND_GRP, \n\tPROP_SPEC_COL_CAT, \n\tREC_TYPE, \n\tyear_rt AS YEAR_RT, \n\tHASHKEY, \n\tSBG_CODE, \n\tSBG_DESC, \n\tISOMajorCrimeGroup AS MAJ_CRIME_GRP, \n\tAgencyStatusCode AS AGENCY_STATUS_CODE, \n\tPrimaryAgencyStatusCode AS PRIM_AGENCY_STATUS_CODE, \n\tRATED_COV_CODE, \n\tRATED_COV_DESC, \n\tCensusBlockGroupCountyCode AS CBG_COUNTY, \n\tCensusBlockGroupTractCode AS CBG_TRACT, \n\tCensusBlockGroupBlockGroupCode AS CBG_BLOCK, \n\tRatingTerritory AS TERRITORY_CODE, \n\tLATITUDE, \n\tLONGITUDE, \n\tCatalyst AS CS_CATALYST, \n\tCauseOfDamage AS CS_CAUSE_OF_DAMAGE, \n\tDamageCaused AS CS_DAMAGE_CAUSED, \n\tItemDamaged AS CS_ITEM_DAMAGED, \n\tSERV_CENTER_SUPPORT_CODE, \n\tCLAIM_CAT_CODE, \n\tCUSTOMERINFORCEIND, \n\tCUSTOMERPRODUCTINFORCEIND, \n\tQUOTECHANNEL, \n\tQUOTECHANNELORIGIN, \n\tRATINGSTATEABBREVIATION, \n\tPC_ABBR, \n\tMAILING_ZIP_POSTAL_CODE\n\tFROM RTR_Insert_INSERT\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V3": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_LKP": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}