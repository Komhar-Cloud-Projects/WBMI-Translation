{
    "name": "s_m_Plines_STG_Insert_Policy",
    "properties": {
        "activities": [
            {
                "name": "m_Plines_STG_Insert_Policy",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_policy AS (\n\tSELECT\n\t\tpolicy_num,\n\t\tpolicy_sym,\n\t\tpolicy_mod,\n\t\tpolicy_mco,\n\t\tissue_type_code,\n\t\tproducer_user_id,\n\t\tagency_state_type_num,\n\t\tagency_pay_type_code,\n\t\tagency_num,\n\t\tcust_num,\n\t\tpolicy_status_type_code,\n\t\tbridge_date,\n\t\tsubmit_date,\n\t\tprocess_date,\n\t\tprim_state_code,\n\t\tpolicy_term_type_code,\n\t\tlob_type_code,\n\t\tcsr_user_id,\n\t\tlock_user_id,\n\t\tlock_session_id,\n\t\tbridge_type_code,\n\t\tcomputer_gen_comment_flag,\n\t\tcreate_date,\n\t\tagency_cust_num,\n\t\tstreet,\n\t\tcity,\n\t\tstate_type_code,\n\t\tzip_type_code,\n\t\tinside_city_limit_flag,\n\t\tcounty_type_code,\n\t\teff_date,\n\t\texp_date,\n\t\tpay_plan_type_code,\n\t\tassoc_plus_type_code,\n\t\teft_acct_type_code,\n\t\teft_routing_num,\n\t\teft_acct_num,\n\t\tgroup_bill_type_code,\n\t\tgroup_bill_emp_num,\n\t\tgroup_bill_last_pay_date,\n\t\tpaid_by_credit_card_flag,\n\t\tcredit_card_type_code,\n\t\tcredit_card_num,\n\t\tcredit_card_exp,\n\t\tmail_street,\n\t\tmail_city,\n\t\tmail_state_type_code,\n\t\tmail_zip_type_code,\n\t\tmail_county_type_code,\n\t\tdeposit,\n\t\tbalance,\n\t\tmin_deposit,\n\t\tcredit_score,\n\t\tshort_term_flag,\n\t\thome_phone,\n\t\temail,\n\t\tquote_num,\n\t\tquote_version,\n\t\tbridge_wizard_flag,\n\t\tmulticar_flag,\n\t\tother_auto_ins_flag,\n\t\tother_auto_ins_descript,\n\t\tmn_auth_flag,\n\t\thads_flag,\n\t\twc_policy_cancelled_flag,\n\t\tprior_auto_ins_flag,\n\t\tprior_plines_policy_flag,\n\t\tprior_wbm_policy_flag,\n\t\tapp_quote_view_flag,\n\t\tmodified_date,\n\t\tmodified_user_id,\n\t\tpolicy_last_modified_date,\n\t\tpif_insured_name,\n\t\tendorsement_eff_date,\n\t\tinception_date,\n\t\tendorsement_policy_view_code,\n\t\tpif_download_date,\n\t\tmanually_rated_flag,\n\t\tcur_addr_less_than_3_yrs_flag,\n\t\tcondo_assoc_name,\n\t\tcondo_assoc_policy_num,\n\t\tpif_assoc_plus_type_code,\n\t\taus_cumulative_score,\n\t\tpolicy_rated_flag,\n\t\tpolicy_rated_date,\n\t\tacct_status_type_code,\n\t\tacct_setup_by_user_id,\n\t\tacct_setup_date,\n\t\tunderwriter_notes,\n\t\texisting_prime_rewards_flag,\n\t\taus_refresh_flag,\n\t\tcell_phone,\n\t\trpt_notification_flag,\n\t\toperator_id,\n\t\trollover_ind,\n\t\trollover_producer_code,\n\t\trollover_orig_policy_eff_date,\n\t\tservice_center_flag,\n\t\tcommercial_policy_num,\n\t\tpost_graduate_degree_type_code,\n\t\teft_withdrawal_calendar_day,\n\t\tupdated_credit_score,\n\t\tcredit_score_override_flag,\n\t\tcredit_score_override_uw_code,\n\t\taus_status_code\n\tFROM policy\n),\nEXP_POLICY AS (\n\tSELECT\n\tpolicy_num,\n\tpolicy_sym,\n\tpolicy_mod,\n\tpolicy_mco,\n\tissue_type_code,\n\tproducer_user_id,\n\tagency_state_type_num,\n\tagency_pay_type_code,\n\tagency_num,\n\tcust_num,\n\tpolicy_status_type_code,\n\tbridge_date,\n\tsubmit_date,\n\tprocess_date,\n\tprim_state_code,\n\tpolicy_term_type_code,\n\tlob_type_code,\n\tcsr_user_id,\n\tlock_user_id,\n\tlock_session_id,\n\tbridge_type_code,\n\tcomputer_gen_comment_flag,\n\tcreate_date,\n\tagency_cust_num,\n\tstreet,\n\tcity,\n\tstate_type_code,\n\tzip_type_code,\n\tinside_city_limit_flag,\n\tcounty_type_code,\n\teff_date,\n\texp_date,\n\tpay_plan_type_code,\n\tassoc_plus_type_code,\n\teft_acct_type_code,\n\teft_routing_num,\n\teft_acct_num,\n\tgroup_bill_type_code,\n\tgroup_bill_emp_num,\n\tgroup_bill_last_pay_date,\n\tpaid_by_credit_card_flag,\n\tcredit_card_type_code,\n\tcredit_card_num,\n\tcredit_card_exp,\n\tmail_street,\n\tmail_city,\n\tmail_state_type_code,\n\tmail_zip_type_code,\n\tmail_county_type_code,\n\tdeposit,\n\tbalance,\n\tmin_deposit,\n\tcredit_score,\n\tshort_term_flag,\n\thome_phone,\n\temail,\n\tquote_num,\n\tquote_version,\n\tbridge_wizard_flag,\n\tmulticar_flag,\n\tother_auto_ins_flag,\n\tother_auto_ins_descript,\n\tmn_auth_flag,\n\thads_flag,\n\twc_policy_cancelled_flag,\n\tprior_auto_ins_flag,\n\tprior_plines_policy_flag,\n\tprior_wbm_policy_flag,\n\tapp_quote_view_flag,\n\tmodified_date,\n\tmodified_user_id,\n\tpolicy_last_modified_date,\n\tpif_insured_name,\n\tendorsement_eff_date,\n\tinception_date,\n\tendorsement_policy_view_code,\n\tpif_download_date,\n\tmanually_rated_flag,\n\tcur_addr_less_than_3_yrs_flag,\n\tcondo_assoc_name,\n\tcondo_assoc_policy_num,\n\tpif_assoc_plus_type_code,\n\taus_cumulative_score,\n\tpolicy_rated_flag,\n\tpolicy_rated_date,\n\tacct_status_type_code,\n\tacct_setup_by_user_id,\n\tacct_setup_date,\n\tunderwriter_notes,\n\texisting_prime_rewards_flag,\n\taus_refresh_flag,\n\tcell_phone,\n\trpt_notification_flag,\n\toperator_id,\n\trollover_ind,\n\trollover_producer_code,\n\trollover_orig_policy_eff_date,\n\tservice_center_flag,\n\tcommercial_policy_num,\n\tpost_graduate_degree_type_code,\n\teft_withdrawal_calendar_day,\n\tupdated_credit_score,\n\tcredit_score_override_flag,\n\tcredit_score_override_uw_code,\n\taus_status_code,\n\tSYSDATE AS EXTRACT_DATE,\n\tSYSDATE AS AS_OF_DATE,\n\t'' AS RECORD_COUNT,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID\n\tFROM SQ_policy\n),\npolicy_plines_stage AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.policy_plines_stage;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.policy_plines_stage\n\t(policy_num, policy_sym, policy_mod, policy_mco, issue_type_code, producer_user_id, agency_state_type_num, agency_pay_type_code, agency_num, cust_num, policy_status_type_code, bridge_date, submit_date, process_date, prim_state_code, policy_term_type_code, lob_type_code, csr_user_id, lock_user_id, lock_session_id, bridge_type_code, computer_gen_comment_flag, create_date, agency_cust_num, street, city, state_type_code, zip_type_code, inside_city_limit_flag, county_type_code, eff_date, exp_date, pay_plan_type_code, assoc_plus_type_code, eft_acct_type_code, eft_routing_num, group_bill_type_code, group_bill_emp_num, group_bill_last_pay_date, paid_by_credit_card_flag, credit_card_type_code, credit_card_exp, mail_street, mail_city, mail_state_type_code, mail_zip_type_code, mail_county_type_code, deposit, balance, min_deposit, credit_score, short_term_flag, home_phone, email, quote_num, quote_version, bridge_wizard_flag, multicar_flag, other_auto_ins_flag, other_auto_ins_descript, mn_auth_flag, hads_flag, wc_policy_cancelled_flag, prior_auto_ins_flag, prior_plines_policy_flag, prior_wbm_policy_flag, app_quote_view_flag, modified_date, modified_user_id, policy_last_modified_date, pif_insured_name, endorsement_eff_date, inception_date, endorsement_policy_view_code, pif_download_date, manually_rated_flag, cur_addr_less_than_3_yrs_flag, condo_assoc_name, condo_assoc_policy_num, pif_assoc_plus_type_code, aus_cumulative_score, policy_rated_flag, policy_rated_date, acct_status_type_code, acct_setup_by_user_id, acct_setup_date, underwriter_notes, existing_prime_rewards_flag, aus_refresh_flag, cell_phone, rpt_notification_flag, operator_id, rollover_ind, rollover_producer_code, rollover_orig_policy_eff_date, service_center_flag, commercial_policy_num, post_graduate_degree_type_code, eft_withdrawal_calendar_day, updated_credit_score, credit_score_override_flag, credit_score_override_uw_code, aus_status_code, extract_date, as_of_date, record_count, source_system_id)\n\tSELECT \n\tPOLICY_NUM, \n\tPOLICY_SYM, \n\tPOLICY_MOD, \n\tPOLICY_MCO, \n\tISSUE_TYPE_CODE, \n\tPRODUCER_USER_ID, \n\tAGENCY_STATE_TYPE_NUM, \n\tAGENCY_PAY_TYPE_CODE, \n\tAGENCY_NUM, \n\tCUST_NUM, \n\tPOLICY_STATUS_TYPE_CODE, \n\tBRIDGE_DATE, \n\tSUBMIT_DATE, \n\tPROCESS_DATE, \n\tPRIM_STATE_CODE, \n\tPOLICY_TERM_TYPE_CODE, \n\tLOB_TYPE_CODE, \n\tCSR_USER_ID, \n\tLOCK_USER_ID, \n\tLOCK_SESSION_ID, \n\tBRIDGE_TYPE_CODE, \n\tCOMPUTER_GEN_COMMENT_FLAG, \n\tCREATE_DATE, \n\tAGENCY_CUST_NUM, \n\tSTREET, \n\tCITY, \n\tSTATE_TYPE_CODE, \n\tZIP_TYPE_CODE, \n\tINSIDE_CITY_LIMIT_FLAG, \n\tCOUNTY_TYPE_CODE, \n\tEFF_DATE, \n\tEXP_DATE, \n\tPAY_PLAN_TYPE_CODE, \n\tASSOC_PLUS_TYPE_CODE, \n\tEFT_ACCT_TYPE_CODE, \n\tEFT_ROUTING_NUM, \n\tGROUP_BILL_TYPE_CODE, \n\tGROUP_BILL_EMP_NUM, \n\tGROUP_BILL_LAST_PAY_DATE, \n\tPAID_BY_CREDIT_CARD_FLAG, \n\tCREDIT_CARD_TYPE_CODE, \n\tCREDIT_CARD_EXP, \n\tMAIL_STREET, \n\tMAIL_CITY, \n\tMAIL_STATE_TYPE_CODE, \n\tMAIL_ZIP_TYPE_CODE, \n\tMAIL_COUNTY_TYPE_CODE, \n\tDEPOSIT, \n\tBALANCE, \n\tMIN_DEPOSIT, \n\tCREDIT_SCORE, \n\tSHORT_TERM_FLAG, \n\tHOME_PHONE, \n\tEMAIL, \n\tQUOTE_NUM, \n\tQUOTE_VERSION, \n\tBRIDGE_WIZARD_FLAG, \n\tMULTICAR_FLAG, \n\tOTHER_AUTO_INS_FLAG, \n\tOTHER_AUTO_INS_DESCRIPT, \n\tMN_AUTH_FLAG, \n\tHADS_FLAG, \n\tWC_POLICY_CANCELLED_FLAG, \n\tPRIOR_AUTO_INS_FLAG, \n\tPRIOR_PLINES_POLICY_FLAG, \n\tPRIOR_WBM_POLICY_FLAG, \n\tAPP_QUOTE_VIEW_FLAG, \n\tMODIFIED_DATE, \n\tMODIFIED_USER_ID, \n\tPOLICY_LAST_MODIFIED_DATE, \n\tPIF_INSURED_NAME, \n\tENDORSEMENT_EFF_DATE, \n\tINCEPTION_DATE, \n\tENDORSEMENT_POLICY_VIEW_CODE, \n\tPIF_DOWNLOAD_DATE, \n\tMANUALLY_RATED_FLAG, \n\tCUR_ADDR_LESS_THAN_3_YRS_FLAG, \n\tCONDO_ASSOC_NAME, \n\tCONDO_ASSOC_POLICY_NUM, \n\tPIF_ASSOC_PLUS_TYPE_CODE, \n\tAUS_CUMULATIVE_SCORE, \n\tPOLICY_RATED_FLAG, \n\tPOLICY_RATED_DATE, \n\tACCT_STATUS_TYPE_CODE, \n\tACCT_SETUP_BY_USER_ID, \n\tACCT_SETUP_DATE, \n\tUNDERWRITER_NOTES, \n\tEXISTING_PRIME_REWARDS_FLAG, \n\tAUS_REFRESH_FLAG, \n\tCELL_PHONE, \n\tRPT_NOTIFICATION_FLAG, \n\tOPERATOR_ID, \n\tROLLOVER_IND, \n\tROLLOVER_PRODUCER_CODE, \n\tROLLOVER_ORIG_POLICY_EFF_DATE, \n\tSERVICE_CENTER_FLAG, \n\tCOMMERCIAL_POLICY_NUM, \n\tPOST_GRADUATE_DEGREE_TYPE_CODE, \n\tEFT_WITHDRAWAL_CALENDAR_DAY, \n\tUPDATED_CREDIT_SCORE, \n\tCREDIT_SCORE_OVERRIDE_FLAG, \n\tCREDIT_SCORE_OVERRIDE_UW_CODE, \n\tAUS_STATUS_CODE, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID\n\tFROM EXP_POLICY\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "CommonStaging/"
        },
        "annotations": []
    }
}