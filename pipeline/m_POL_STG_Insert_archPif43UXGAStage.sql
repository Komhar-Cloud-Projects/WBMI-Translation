WITH
SQ_Pif43UXGAStage AS (
	SELECT
		Pif43UXGAStageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		PMDUXA1SegmentId,
		PMDUXA1SegmentStatus,
		PMDUXA1YearTransaction,
		PMDUXA1MonthTransaction,
		PMDUXA1DayTransaction,
		PMDUXA1SegmentLevelCode,
		PMDUXA1SegmentPartCode,
		PMDUXA1SubPartCode,
		PMDUXA1InsuranceLine,
		PMDUXA1Location,
		PMDUXA1SubLocationNumber,
		PMDUXA1RiskUnitGroup,
		PMDUXA1SeqRiskUnitGroup,
		PMDUXA1DpdTypeNumb,
		PMDUXA1Sequence,
		PMDUXA1YearItemEffective,
		PMDUXA1MonthItemEffective,
		PMDUXA1DayItemEffective,
		PMDUXA1AddInterestType,
		PMDUXA1AddInterestSeq,
		PMDUXA1YearProcess,
		PMDUXA1MonthProcess,
		PMDUXA1DayProcess,
		PMDUXA1YearExpiration,
		PMDUXA1MonthExpiration,
		PMDUXA1DayExpiration,
		PMDUXA1DealerSw,
		PMDUXA1ClassCode,
		PMDUXA1Tort,
		PMDUXA1RegNoPersons,
		PMDUXA1RegRatingUnits,
		PMDUXA1RegMgind,
		PMDUXA1OtherNoPersons,
		PMDUXA1OtherRatingUnits,
		PMDUXA1OtherMgind,
		PMDUXA1Und25NoPersons,
		PMDUXA1Und25RatingUnits,
		PMDUXA1UndMgind,
		PMDUXA1Ov25NoPersons,
		PMDUXA1Ov25RatingUnits,
		PMDUXA1OvMgind,
		PMDUXA1EmpRegOperRu,
		PMDUXA1EmpOtherRu,
		PMDUXA1NempUnd25Ru,
		PMDUXA1NempOver25Ru,
		PMDUXA1TotalRatingUnits,
		PMDUXA1NdPayroll,
		PMDUXA1PmscFutureUse,
		PMDUXA1DecChangeFlag,
		PMDUXA1CompSpInd,
		PMDUXA1CollInd,
		PMDUXA1CustFutureUse,
		PMDUXA1Yr2000CustUse
	FROM Pif43UXGAStage
),
EXP_Pif43UXGAStage AS (
	SELECT
	Pif43UXGAStageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	PMDUXA1SegmentId,
	PMDUXA1SegmentStatus,
	PMDUXA1YearTransaction,
	PMDUXA1MonthTransaction,
	PMDUXA1DayTransaction,
	PMDUXA1SegmentLevelCode,
	PMDUXA1SegmentPartCode,
	PMDUXA1SubPartCode,
	PMDUXA1InsuranceLine,
	PMDUXA1Location,
	PMDUXA1SubLocationNumber,
	PMDUXA1RiskUnitGroup,
	PMDUXA1SeqRiskUnitGroup,
	PMDUXA1DpdTypeNumb,
	PMDUXA1Sequence,
	PMDUXA1YearItemEffective,
	PMDUXA1MonthItemEffective,
	PMDUXA1DayItemEffective,
	PMDUXA1AddInterestType,
	PMDUXA1AddInterestSeq,
	PMDUXA1YearProcess,
	PMDUXA1MonthProcess,
	PMDUXA1DayProcess,
	PMDUXA1YearExpiration,
	PMDUXA1MonthExpiration,
	PMDUXA1DayExpiration,
	PMDUXA1DealerSw,
	PMDUXA1ClassCode,
	PMDUXA1Tort,
	PMDUXA1RegNoPersons,
	PMDUXA1RegRatingUnits,
	PMDUXA1RegMgind,
	PMDUXA1OtherNoPersons,
	PMDUXA1OtherRatingUnits,
	PMDUXA1OtherMgind,
	PMDUXA1Und25NoPersons,
	PMDUXA1Und25RatingUnits,
	PMDUXA1UndMgind,
	PMDUXA1Ov25NoPersons,
	PMDUXA1Ov25RatingUnits,
	PMDUXA1OvMgind,
	PMDUXA1EmpRegOperRu,
	PMDUXA1EmpOtherRu,
	PMDUXA1NempUnd25Ru,
	PMDUXA1NempOver25Ru,
	PMDUXA1TotalRatingUnits,
	PMDUXA1NdPayroll,
	PMDUXA1PmscFutureUse,
	PMDUXA1DecChangeFlag,
	PMDUXA1CompSpInd,
	PMDUXA1CollInd,
	PMDUXA1CustFutureUse,
	PMDUXA1Yr2000CustUse,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif43UXGAStage
),
ArchPif43UXGAStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UXGAStage
	(ExtractDate, SourceSystemid, AuditId, PifSymbol, PifPolicyNumber, PifModule, PMDUXA1SegmentId, PMDUXA1SegmentStatus, PMDUXA1YearTransaction, PMDUXA1MonthTransaction, PMDUXA1DayTransaction, PMDUXA1SegmentLevelCode, PMDUXA1SegmentPartCode, PMDUXA1SubPartCode, PMDUXA1InsuranceLine, PMDUXA1Location, PMDUXA1SubLocationNumber, PMDUXA1RiskUnitGroup, PMDUXA1SeqRiskUnitGroup, PMDUXA1DpdTypeNumb, PMDUXA1Sequence, PMDUXA1YearItemEffective, PMDUXA1MonthItemEffective, PMDUXA1DayItemEffective, PMDUXA1AddInterestType, PMDUXA1AddInterestSeq, PMDUXA1YearProcess, PMDUXA1MonthProcess, PMDUXA1DayProcess, PMDUXA1YearExpiration, PMDUXA1MonthExpiration, PMDUXA1DayExpiration, PMDUXA1DealerSw, PMDUXA1ClassCode, PMDUXA1Tort, PMDUXA1RegNoPersons, PMDUXA1RegRatingUnits, PMDUXA1RegMgind, PMDUXA1OtherNoPersons, PMDUXA1OtherRatingUnits, PMDUXA1OtherMgind, PMDUXA1Und25NoPersons, PMDUXA1Und25RatingUnits, PMDUXA1UndMgind, PMDUXA1Ov25NoPersons, PMDUXA1Ov25RatingUnits, PMDUXA1OvMgind, PMDUXA1EmpRegOperRu, PMDUXA1EmpOtherRu, PMDUXA1NempUnd25Ru, PMDUXA1NempOver25Ru, PMDUXA1TotalRatingUnits, PMDUXA1NdPayroll, PMDUXA1PmscFutureUse, PMDUXA1DecChangeFlag, PMDUXA1CompSpInd, PMDUXA1CollInd, PMDUXA1CustFutureUse, PMDUXA1Yr2000CustUse)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_audit_id AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDUXA1SEGMENTID, 
	PMDUXA1SEGMENTSTATUS, 
	PMDUXA1YEARTRANSACTION, 
	PMDUXA1MONTHTRANSACTION, 
	PMDUXA1DAYTRANSACTION, 
	PMDUXA1SEGMENTLEVELCODE, 
	PMDUXA1SEGMENTPARTCODE, 
	PMDUXA1SUBPARTCODE, 
	PMDUXA1INSURANCELINE, 
	PMDUXA1LOCATION, 
	PMDUXA1SUBLOCATIONNUMBER, 
	PMDUXA1RISKUNITGROUP, 
	PMDUXA1SEQRISKUNITGROUP, 
	PMDUXA1DPDTYPENUMB, 
	PMDUXA1SEQUENCE, 
	PMDUXA1YEARITEMEFFECTIVE, 
	PMDUXA1MONTHITEMEFFECTIVE, 
	PMDUXA1DAYITEMEFFECTIVE, 
	PMDUXA1ADDINTERESTTYPE, 
	PMDUXA1ADDINTERESTSEQ, 
	PMDUXA1YEARPROCESS, 
	PMDUXA1MONTHPROCESS, 
	PMDUXA1DAYPROCESS, 
	PMDUXA1YEAREXPIRATION, 
	PMDUXA1MONTHEXPIRATION, 
	PMDUXA1DAYEXPIRATION, 
	PMDUXA1DEALERSW, 
	PMDUXA1CLASSCODE, 
	PMDUXA1TORT, 
	PMDUXA1REGNOPERSONS, 
	PMDUXA1REGRATINGUNITS, 
	PMDUXA1REGMGIND, 
	PMDUXA1OTHERNOPERSONS, 
	PMDUXA1OTHERRATINGUNITS, 
	PMDUXA1OTHERMGIND, 
	PMDUXA1UND25NOPERSONS, 
	PMDUXA1UND25RATINGUNITS, 
	PMDUXA1UNDMGIND, 
	PMDUXA1OV25NOPERSONS, 
	PMDUXA1OV25RATINGUNITS, 
	PMDUXA1OVMGIND, 
	PMDUXA1EMPREGOPERRU, 
	PMDUXA1EMPOTHERRU, 
	PMDUXA1NEMPUND25RU, 
	PMDUXA1NEMPOVER25RU, 
	PMDUXA1TOTALRATINGUNITS, 
	PMDUXA1NDPAYROLL, 
	PMDUXA1PMSCFUTUREUSE, 
	PMDUXA1DECCHANGEFLAG, 
	PMDUXA1COMPSPIND, 
	PMDUXA1COLLIND, 
	PMDUXA1CUSTFUTUREUSE, 
	PMDUXA1YR2000CUSTUSE
	FROM EXP_Pif43UXGAStage
),