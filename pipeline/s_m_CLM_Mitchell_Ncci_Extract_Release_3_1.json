{
    "name": "s_m_CLM_Mitchell_Ncci_Extract_Release_3_1",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_Mitchell_Ncci_Extract_Release_3_1",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_MAX_CREATE_DATE AS (\n\tSELECT\n\tWORK_HIST_CREATE_DATE,\n\tWC_CLAIMANT_DET_AK_ID\n\tFROM (\n\t\tSELECT  \r\n\t\tp.wc_claimant_det_ak_id                    as  WC_CLAIMANT_DET_AK_ID ,\r\n\t\tp.work_hist_create_date                   as WORK_HIST_CREATE_DATE \r\n\t\tFROM (\r\n\t\tSELECT a.wc_claimant_det_ak_id                                as  WC_CLAIMANT_DET_AK_ID ,\r\n\t\tMAX(a.work_hist_created_date )                   as WORK_HIST_CREATE_DATE \r\n\t\tFROM workers_comp_claimant_work_history a\r\n\t\twhere a.crrnt_snpsht_flag = 1\r\n\t\tGROUP BY a.wc_claimant_det_ak_id ) p\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WC_CLAIMANT_DET_AK_ID ORDER BY WORK_HIST_CREATE_DATE DESC) = 1\n),\nSQ_workers_comp_claimant_detail AS (\n\tselect a.wc_claimant_det_ak_id\r\n\t\t, a.maint_type_code\r\n\t\t, CONVERT(CHAR(10),a.send_to_state_time,112)\r\n\t\t, a.claim_party_occurrence_ak_id\r\n\t\t, a.jurisdiction_state_code \r\n\t\t, (case a.state_claim_num when 'N/A'  then ' ' else a.state_claim_num end) state_claim_num\r\n\t\t, a.wc_claimant_num\r\n\t\t, (case a.sic_code when 'N/A'  then '' else a.sic_code end) sic_code\r\n\t\t, a.emp_dept_num\r\n\t\t, (case a.nature_inj_code when 'N/A' then '' else a.nature_inj_code end) nature_inj_code\r\n\t\t, (case a.body_part_code when 'N/A' then '' else a.body_part_code end) body_part_code\r\n\t\t, (case a.cause_inj_code when 'N/A' then '' else a.cause_inj_code end) cause_inj_code\r\n\t\t, (case a.inital_treatment_code when 'N/A'  then ''  else a.inital_treatment_code end) inital_treatment_code\r\n\t\t, CONVERT(CHAR(10),a.emplyr_notified_date,112)\r\n\t\t, CONVERT(CHAR(10),a.reported_to_carrier_date,112)\r\n\t\t, (case a.marital_status when 'N/A' then '' else a.marital_status end) marital_status\r\n\t\t, a.num_of_dependents\r\n\t\t, CONVERT(CHAR(10),a.disability_date,112)\r\n\t\t, b.claim_party_death_date\r\n\t\t, (case a.emplymnt_status_code when 'N/A' then '' else  a.emplymnt_status_code end) emplymnt_status_code\r\n\t\t, a.hired_date\r\n\t\t, a.avg_wkly_wage\r\n\t\t, a.wage_period_code\r\n\t\t, Cast(Round(a.emp_day_week,0)as int) as emp_day_week\r\n\t\t, a.full_pay_inj_day_ind\r\n\t\t, a.pre_exst_disability_ind\r\n\t\t, a.max_med_improvement_date\r\n\t\t, a.obtained_lgl_representation_date\r\n\t\t, a.inj_result_death_ind\r\n\t\t, a.fringe_bnft_discontinued_amt\r\n\t\t, a.med_auth_ind\r\n\t\t, a.education_lvl\r\n\t\t, a.auth_to_release_ssn_ind\r\n\t\t, a.occuptn_code\r\n\t\t, a.inj_loc_comment\r\n\t\t, (case a.premises_code when 'N/A' then '' else a.premises_code end) premises_code\r\n\t\t, a.claim_ctgry_code\r\n\t\t, a.wage_rate_amt\r\n\t\t, (case a.emp_id_num when 'N/A' then '' else a.emp_id_num end) emp_id_num\r\n\t\t, (case a.emp_id_type when 'N/A' then '' else a.emp_id_type end) emp_id_type\r\n\t\t, (case a.work_week_days when 'N/A' then '' else a.work_week_days end) work_week_days \r\n\t\t, (case a.work_week_type when 'N/A' then '' else a.work_week_type end) work_week_type\r\n\t\t, CONVERT(CHAR(10),a.emplyr_lost_time_notified_date,112)\r\n\t\t, (case a.NaicsCode when 'N/A' then '' else a.NaicsCode end) NaicsCode\r\n\t\t, (case a.salary_paid_ind when 'N/A' then '' else a.salary_paid_ind end) salary_paid_ind \r\n\t\t, (case a.emp_security_id  when 'N/A' then '' else a.emp_security_id  end) emp_security_id \r\n\t\t, (case a.act_status_code  when 'N/A' then '' else a.act_status_code  end) act_status_code \r\n\t\t, (case a.FullDenialReasonCode  when 'N/A' then '' else a.FullDenialReasonCode end) FullDenialReasonCode\r\n\t\t, (case a.IAIABCLossTypeCode  when 'N/A' then '' else a.IAIABCLossTypeCode end) IAIABCLossTypeCode\r\n\t\t, (case a.FROILateReasonCode  when 'N/A' then '' else a.FROILateReasonCode end) FROILateReasonCode\r\n\t\t, (case a.ManualClassificationCode  when 'N/A' then '' else a.ManualClassificationCode  end) ManualClassificationCode\r\n\t\t, a.num_of_exemptions\r\n\t\t, b.claim_party_key\r\n\t\t, b.tax_fed_id\r\n\t\t, (case b.claim_party_full_name when 'N/A' then '' else b.claim_party_full_name end) claim_party_full_name\r\n\t\t, (case b.claim_party_addr when 'N/A' then '' else b.claim_party_addr end) claim_party_addr \r\n\t\t, (case b.tax_ssn_id when 'N/A' then '' else b.tax_ssn_id end) tax_ssn_id\r\n\t\t, (case b.claim_party_first_name when 'N/A' then '' else b.claim_party_first_name end) claim_party_first_name                  \r\n\t\t, (case b.claim_party_mid_name when 'N/A' then '' else b.claim_party_mid_name end) claim_party_mid_name\r\n\t\t, (case b.claim_party_last_name when 'N/A' then '' else b.claim_party_last_name end) claim_party_last_name\r\n\t\t, (case b.claim_party_city when 'N/A' then '' else b.claim_party_city end) claim_party_city\r\n\t\t, (case b.claim_party_state when 'N/A' then '' else b.claim_party_state end) claim_party_state\r\n\t\t, (case b.claim_party_zip when 'N/A' then '' else b.claim_party_zip end) claim_party_zip\r\n\t\t, b.ph_num\r\n\t\t, CONVERT(CHAR(10),b.claim_party_birthdate,112)\r\n\t\t, b.claim_party_gndr\r\n\t\t, (case b.claim_party_name_sfx when 'N/A' then '' else b.claim_party_name_sfx end) claim_party_name_sfx\r\n\t\t, f.occuptn_descript\r\n\t\t, d.claim_party_role_code\r\n\t\t, d.claim_party_ak_id\r\n\t\t, SPC.StrategicProfitCenterDescription\r\n\t\t, c.claim_occurrence_ak_id\r\n\t\t, c.pol_key_ak_id\r\n\t\t, c.claim_loss_date\r\n\t\t, CONVERT(CHAR(10),c.claim_loss_date,112)\r\n\t\t, c.claim_occurrence_key\r\n\t\t, c.loss_loc_zip\r\n\t\t, c.claim_loss_descript\r\n\t\t, (case c.source_claim_occurrence_status_code when 'N/A' then '' else c.source_claim_occurrence_status_code end) source_claim_occurrence_status_code\r\n\t\t, c.loss_loc_county\r\n\t\t, c.loss_loc_city\r\n\t\t, c.loss_loc_addr\r\n\t\t, c.loss_loc_state\r\n\t\t, h.claim_rep_email\r\n\t\t, h.claim_rep_full_name\r\n\t\t, rep.ph_num\r\n\t\t, rep.ph_extension\r\n\t\t, a.FROIClaimType \r\n\t\t, a.FROICancelReasonCode\r\n\t\t, a.FROIFullDenialReasonNarrative \r\n\t\t, a.BodyPartLocationCode \r\n\t\t, a.FingersToesLocationCode \r\n\t\t, a.FROICancelReasonNarrative\r\n\t\t, a.FirstDisabilityDateAfterWaitingPeriod \r\n\t\t, a.InjurySeverityType \r\n\t\t,a.CurrentDateDisabilityBegan\r\n\t\t,a.DateEmployerHadKnowledgeofCurrentDateofDisability\r\n\t\t,a.DateWBMIHadKnowledgeofCurrentDateofDisability\r\n\t     ,a.DateClaimAdminHadKnowledgeClaimMetReportingRequirements\r\n\tFROM workers_comp_claimant_detail a\r\n\tINNER JOIN claim_party_occurrence d ON a.claim_party_occurrence_ak_id = d.claim_party_occurrence_ak_id\r\n\t\tAND d.crrnt_snpsht_flag = 1\r\n\t\tAND a.crrnt_snpsht_flag = 1\r\n\tINNER JOIN claim_occurrence c ON d.claim_occurrence_ak_id = c.claim_occurrence_ak_id\r\n\t\tAND claim_occurrence_type_code = 'WCC'\r\n\t\tAND c.crrnt_snpsht_flag = 1\r\n\t\tAND d.crrnt_snpsht_flag = 1\r\n\tINNER JOIN claim_party b ON d.claim_party_ak_id = b.claim_party_ak_id\r\n\t\tAND b.crrnt_snpsht_flag = 1\r\n\tLEFT JOIN sup_workers_comp_occupation f ON a.occuptn_code = f.occuptn_code\r\n\t\tAND f.crrnt_snpsht_flag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Policy pol ON pol.pol_ak_id = c.pol_key_ak_id\r\n\t\tAND pol.crrnt_snpsht_flag = 1\r\n\tINNER JOIN StrategicProfitCenter SPC ON SPC.StrategicProfitCenterAkID = pol.StrategicProfitCenterAkID\r\n\t\tAND SPC.CurrentSnapshotFlag = 1\r\n\tINNER JOIN claim_representative_occurrence g ON g.claim_occurrence_ak_id = c.claim_occurrence_ak_id\r\n\t\tAND g.crrnt_snpsht_flag = 1\r\n\t\tAND g.claim_rep_role_code = 'H'\r\n\tINNER JOIN claim_representative h ON h.claim_rep_ak_id = g.claim_rep_ak_id\r\n\t\tAND h.crrnt_snpsht_flag = 1\r\n\tINNER JOIN claim_party rep ON rep.claim_party_key = h.claim_rep_key\r\n\t\tAND rep.crrnt_snpsht_flag = 1\r\n\tLEFT JOIN @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkNcciMitchell dfm ON a.wc_claimant_num = dfm.ClaimAdminClaimNumber\r\n\t\tAND a.crrnt_snpsht_flag = 1\r\n\t\tAND CONVERT(CHAR(10), a.send_to_state_time, 112) = dfm.MaitenanceTypeCodeDate\r\n\tWHERE a.crrnt_snpsht_flag = 1\r\n\t\tAND a.jurisdiction_state_code IN (@{pipeline().parameters.STATE_CODE})\r\n\t\tAND a.send_to_state_ind = 'Y' --need to uncomment after XML mapping\r\n\t\tAND a.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\tAND dfm.ClaimAdminClaimNumber IS NULL --need to uncomment after XML mapping changes\r\n\t\tAND a.source_sys_id <> 'PMS' \r\n\t     @{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_SOURCE AS (\n\tSELECT\n\t'148' AS TransactionSetID,\n\twc_claimant_det_ak_id,\n\tmaint_type_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(maint_type_code))='N/A','',\r\n\t-- LTRIM(RTRIM(maint_type_code)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(maint_type_code)) = 'N/A', '',\n\t    LTRIM(RTRIM(maint_type_code))\n\t) AS o_maint_type_code,\n\tsend_to_state_time,\n\t-- *INF*: send_to_state_time\r\n\t-- \r\n\t-- \r\n\t-- --IIF(send_to_state_time=TO_CHAR(TO_DATE('1800/01/01','YYYY/MM/DD'),'YYYYMMDD'),' ',IIF(send_to_state_time <= TO_CHAR(SYSDATE,'YYYYMMDD'),IIF(send_to_state_time >= convert_claim_loss_date, send_to_state_time,' ')))\n\tsend_to_state_time AS v_send_to_state_time,\n\tv_send_to_state_time AS o_send_to_state_time,\n\tclaim_party_occurrence_ak_id,\n\tjurisdiction_state_code AS in_jurisdiction_state_code,\n\tstate_claim_num AS in_state_claim_num,\n\t-- *INF*: :LKP.LKP_MAX_CREATE_DATE(wc_claimant_det_ak_id)\n\tLKP_MAX_CREATE_DATE_wc_claimant_det_ak_id.WORK_HIST_CREATE_DATE AS v_max_created_date,\n\tv_max_created_date AS o_max_created_date,\n\twc_claimant_num AS in_wc_claimant_num,\n\tin_wc_claimant_num AS v_wc_claimant_num,\n\tv_wc_claimant_num AS o_wc_claimant_num,\n\tsic_code AS in_sic_code,\n\t-- *INF*: IIF(LTRIM(RTRIM(in_sic_code))='N/A','',\r\n\t-- LTRIM(RTRIM(in_sic_code)) )\r\n\t-- \n\tIFF(LTRIM(RTRIM(in_sic_code)) = 'N/A', '', LTRIM(RTRIM(in_sic_code))) AS v_sic_code,\n\tv_sic_code AS o_sic_code,\n\temp_dept_num AS in_emp_dept_num,\n\t-- *INF*: IIF(LTRIM(RTRIM(in_emp_dept_num))='N/A','WC0001',\r\n\t-- SUBSTR(ltrim(rtrim(in_emp_dept_num)),1,15)  )\n\tIFF(\n\t    LTRIM(RTRIM(in_emp_dept_num)) = 'N/A', 'WC0001',\n\t    SUBSTR(ltrim(rtrim(in_emp_dept_num)), 1, 15)\n\t) AS v_emp_dept_num,\n\tv_emp_dept_num AS o_emp_dept_num,\n\tnature_inj_code AS in_nature_inj_code,\n\t-- *INF*: LTRIM(RTRIM(in_nature_inj_code))\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_nature_inj_code))='N/A','',LTRIM(RTRIM(in_nature_inj_code)) )\r\n\t-- \r\n\t-- --IIF (in_nature_inj_code='N/A','',RPAD(in_nature_inj_code,2,' '))\r\n\t-- \r\n\t-- --Straight move.  Truncate to 2 posiions. If N/A send 2 blank spaces\n\tLTRIM(RTRIM(in_nature_inj_code)) AS v_nature_inj_code,\n\t-- *INF*: v_nature_inj_code\r\n\t-- \r\n\t-- --Straight move.  Truncate to 2 posiions. If N/A send 2 blank spaces\n\tv_nature_inj_code AS o_nature_inj_code,\n\tbody_part_code AS in_body_part_code,\n\t-- *INF*: LTRIM(RTRIM(in_body_part_code))\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_body_part_code))='N/A','',LTRIM(RTRIM(in_body_part_code)) )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(in_body_part_code='N/A','',RPAD(in_body_part_code,2,' '))\n\tLTRIM(RTRIM(in_body_part_code)) AS v_body_part_code,\n\tv_body_part_code AS o_body_part_code,\n\tcause_inj_code AS in_cause_inj_code,\n\t-- *INF*: LTRIM(RTRIM(in_cause_inj_code))\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_cause_inj_code))='N/A','',LTRIM(RTRIM(in_cause_inj_code)) )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(in_cause_inj_code='N/A','',RPAD(in_cause_inj_code,2,' '))\n\tLTRIM(RTRIM(in_cause_inj_code)) AS v_cause_inj_code,\n\tv_cause_inj_code AS o_cause_inj_code,\n\tinital_treatment_code AS in_inital_treatment_code,\n\t-- *INF*: IIF(ISNULL(in_inital_treatment_code),'',ltrim(rtrim(in_inital_treatment_code)) )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(in_inital_treatment_code),'',IIF(in_inital_treatment_code='N/A','',RPAD(in_inital_treatment_code,2,' ')))\r\n\t-- \r\n\t-- --Straight Move. Truncate to 2 positions. Left justify pad with space. If no value or = 'N/A' then send 2 blank spaces\n\tIFF(in_inital_treatment_code IS NULL, '', ltrim(rtrim(in_inital_treatment_code))) AS v_inital_treatment_code,\n\tv_inital_treatment_code AS o_inital_treatment_code,\n\treported_to_carrier_date AS in_reported_to_carrier_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_reported_to_carrier_date)) = '18000101',TO_CHAR(claim_loss_date,'YYYYMMDD'),\r\n\t-- LTRIM(RTRIM(in_reported_to_carrier_date))\r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --LTRIM(RTRIM(in_reported_to_carrier_date)) != '18000101', LTRIM(RTRIM(in_reported_to_carrier_date)),\r\n\t-- --LTRIM(RTRIM(in_reported_to_carrier_date)) = '18000101', \r\n\t-- --TO_CHAR(claim_loss_date,'YYYYMMDD'),\r\n\t-- --'')\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_reported_to_carrier_date))  = '18000101',TO_CHAR(claim_loss_date,'YYYYMMDD'),LTRIM(RTRIM(in_reported_to_carrier_date)))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_reported_to_carrier_date))--='18000101',RPAD('',8,' '),LTRIM(RTRIM(in_reported_to_carrier_date)))\r\n\t-- \r\n\t-- --IIF(in_reported_to_carrier_date=TO_CHAR(TO_DATE('18000101','YYYYMMDD'),'YYYYMMDD'),RPAD('',8,' '),in_reported_to_carrier_date)\r\n\t-- \r\n\t-- --convert(char(10),reported_to_carrier_date,112), if = '1800-01-01' send 8 blank spaces\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(in_reported_to_carrier_date)) = '18000101', TO_CHAR(claim_loss_date, 'YYYYMMDD'),\n\t    LTRIM(RTRIM(in_reported_to_carrier_date))\n\t) AS v_reported_to_carrier_date,\n\tv_reported_to_carrier_date AS o_reported_to_carrier_date,\n\templyr_notified_date AS in_emplyr_notified_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_emplyr_notified_date)) = '18000101',TO_CHAR(claim_loss_date,'YYYYMMDD'),\r\n\t-- LTRIM(RTRIM(in_emplyr_notified_date)) \r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --LTRIM(RTRIM(in_emplyr_notified_date)) != '18000101' ,LTRIM(RTRIM(in_emplyr_notified_date)),\r\n\t-- --LTRIM(RTRIM(in_emplyr_notified_date)) = '18000101'  AND LTRIM(RTRIM(in_reported_to_carrier_date))  != --'18000101',LTRIM(RTRIM(in_reported_to_carrier_date)),\r\n\t-- --LTRIM(RTRIM(in_emplyr_notified_date)) = '18000101'  AND LTRIM(RTRIM(in_reported_to_carrier_date)) = '18000101',TO_CHAR(claim_loss_date,'YYYYMMDD'),\r\n\t-- --'')\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(in_emplyr_notified_date))  = '18000101',TO_CHAR(claim_loss_date,'YYYYMMDD'),LTRIM(RTRIM(in_emplyr_notified_date)))\r\n\t-- \r\n\t-- --Must be valid date\r\n\t-- --Must < =today's date\r\n\t-- --Must < =MTC dtate\r\n\t-- --Must be  > date of injury\r\n\t-- \r\n\t-- --convert(char(10),emplyr_notified_date,112), if = '1800-01-01' then claim_occurrence.claim_loss_date.\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(in_emplyr_notified_date)) = '18000101', TO_CHAR(claim_loss_date, 'YYYYMMDD'),\n\t    LTRIM(RTRIM(in_emplyr_notified_date))\n\t) AS v_emplyr_notified_date,\n\t-- *INF*: v_emplyr_notified_date\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --convert(char(10),emplyr_notified_date,112), if = '1800-01-01' then claim_occurrence.claim_loss_date.\n\tv_emplyr_notified_date AS o_emplyr_notified_date,\n\tmarital_status,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(marital_status)) = 'N/A', '' ,\r\n\t-- LTRIM(RTRIM(marital_status)) )\r\n\t-- \r\n\t-- \r\n\t-- --LTRIM(RTRIM(marital_status))\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(marital_status)) = 'N/A', '',\n\t    LTRIM(RTRIM(marital_status))\n\t) AS v_marital_status,\n\tv_marital_status AS o_marital_status,\n\tclaim_party_death_date AS in_death_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_inj_result_death_ind)) = 'Y' \r\n\t-- \t\tAND TO_CHAR(in_death_date,'YYYYMMDD') != '18000101'\r\n\t-- \t\tAND TO_CHAR(in_death_date,'YYYYMMDD') != '99991231'\r\n\t-- \t\tAND TO_CHAR(in_death_date,'YYYYMMDD') != '29991231',\r\n\t-- \t\tTO_CHAR(in_death_date,'YYYYMMDD'),\r\n\t-- \t'')\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(in_inj_result_death_ind)) = 'Y' AND TO_CHAR(in_death_date, 'YYYYMMDD') != '18000101' AND TO_CHAR(in_death_date, 'YYYYMMDD') != '99991231' AND TO_CHAR(in_death_date, 'YYYYMMDD') != '29991231', TO_CHAR(in_death_date, 'YYYYMMDD'),\n\t    ''\n\t) AS v_death_date,\n\tv_death_date AS o_death_date,\n\tinj_result_death_ind AS in_inj_result_death_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(in_jurisdiction_state_code)),'MN','KS','KY','NE','NC','VA'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tTO_CHAR(in_death_date,'YYYYMMDD') <> '18000101' AND LTRIM(RTRIM(in_inj_result_death_ind)) <> 'N/A', \r\n\t-- \t\t\t\tLTRIM(RTRIM(in_inj_result_death_ind)),\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(in_jurisdiction_state_code)),'IL'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(in_inj_result_death_ind)) <> 'N/A',\r\n\t-- \t\t\t\tLTRIM(RTRIM(in_inj_result_death_ind)),\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(in_jurisdiction_state_code)),'IA'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(in_inj_result_death_ind)) = 'Y', \r\n\t-- \t\t\t\tLTRIM(RTRIM(in_inj_result_death_ind)),\r\n\t-- \t\t ''),\r\n\t-- \tIN(LTRIM(RTRIM(in_jurisdiction_state_code)),'IN'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(LTRIM(RTRIM(in_inj_result_death_ind))),\r\n\t-- \t'')\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(in_jurisdiction_state_code)) IN ('MN','KS','KY','NE','NC','VA'), DECODE(\n\t        TRUE,\n\t        TO_CHAR(in_death_date, 'YYYYMMDD') <> '18000101' AND LTRIM(RTRIM(in_inj_result_death_ind)) <> 'N/A', LTRIM(RTRIM(in_inj_result_death_ind)),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(in_jurisdiction_state_code)) IN ('IL'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(in_inj_result_death_ind)) <> 'N/A', LTRIM(RTRIM(in_inj_result_death_ind)),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(in_jurisdiction_state_code)) IN ('IA'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(in_inj_result_death_ind)) = 'Y', LTRIM(RTRIM(in_inj_result_death_ind)),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(in_jurisdiction_state_code)) IN ('IN'), UDF_DEFAULT_VALUE_TO_BLANKS(LTRIM(RTRIM(in_inj_result_death_ind))),\n\t    ''\n\t) AS v_inj_result_death_ind,\n\tv_inj_result_death_ind AS o_inj_result_death_ind,\n\tnum_of_dependents,\n\tdisability_date AS in_disability_date,\n\t-- *INF*: IIF(ltrim(rtrim(in_disability_date))='18000101','',LTRIM(RTRIM(in_disability_date)) )\r\n\t-- \r\n\t-- \r\n\t-- --convert(char(10),disability_date,112). If disability_date = '1800-01-01' then send 8 blank spaces.\n\tIFF(ltrim(rtrim(in_disability_date)) = '18000101', '', LTRIM(RTRIM(in_disability_date))) AS v_disability_date,\n\tv_disability_date AS o_disability_date,\n\templymnt_status_code AS in_emplymnt_status_code,\n\t-- *INF*: LTRIM(RTRIM(in_emplymnt_status_code)) \r\n\t-- \n\tLTRIM(RTRIM(in_emplymnt_status_code)) AS v_emplymnt_status_code,\n\tv_emplymnt_status_code AS o_emplymnt_status_code,\n\thired_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- TO_CHAR(hired_date,'YYYYMMDD') = '18000101', '' ,\r\n\t-- TO_CHAR(hired_date,'YYYYMMDD') \r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(TO_CHAR(hired_date,'YYYYMMDD') != '18000101'\r\n\t-- --,TO_CHAR(hired_date,'YYYYMMDD'),'')\r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    TO_CHAR(hired_date, 'YYYYMMDD') = '18000101', '',\n\t    TO_CHAR(hired_date, 'YYYYMMDD')\n\t) AS v_hired_date,\n\tv_hired_date AS o_hired_date,\n\tavg_wkly_wage AS in_avg_wkly_wage,\n\t-- *INF*: TO_CHAR((in_avg_wkly_wage* 100))\r\n\t-- \r\n\t-- --IIF(in_avg_wkly_wage = ROUND(in_avg_wkly_wage) , lpad(TO_CHAR(ROUND(in_avg_wkly_wage)),8,'0') || '.00' ,  \r\n\t-- --lpad(TO_CHAR(in_avg_wkly_wage),11,'0') )     \r\n\t-- \r\n\t-- \n\tTO_CHAR((in_avg_wkly_wage * 100)) AS v_avg_wkly_wage,\n\t-- *INF*: v_avg_wkly_wage\r\n\t-- \r\n\t-- --v_avg_wkly_wage_reformatted\n\tv_avg_wkly_wage AS o_avg_wkly_wage,\n\twage_period_code AS in_wage_period_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(v_avg_wkly_wage))  != '' AND LTRIM(RTRIM(v_avg_wkly_wage)) != '0','01',\r\n\t-- '' )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(LTRIM(RTRIM(in_wage_period_code)),\r\n\t-- --'W','01',\r\n\t-- --'B','02',\r\n\t-- --'M','04',\r\n\t-- --'D','06',\r\n\t-- --'H','07',\r\n\t-- --'')\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(v_avg_wkly_wage)) != '' AND LTRIM(RTRIM(v_avg_wkly_wage)) != '0', '01',\n\t    ''\n\t) AS v_wage_period_code,\n\tv_wage_period_code AS wage_period_code,\n\temp_day_week,\n\tfull_pay_inj_day_ind AS in_full_pay_inj_day_ind,\n\t-- *INF*: DECODE(LTRIM(RTRIM(in_full_pay_inj_day_ind)),\r\n\t-- 'N','N',\r\n\t-- 'Y','Y',\r\n\t-- 'N/A','',\r\n\t-- '')\r\n\t-- \r\n\t-- --IIF(in_full_pay_inj_day_ind='N',in_full_pay_inj_day_ind,\r\n\t-- --IIF(in_full_pay_inj_day_ind='Y',in_full_pay_inj_day_ind,\r\n\t-- --IIF(in_full_pay_inj_day_ind='N/A','  ')))\r\n\t-- \r\n\t-- --Straight Move 'Y'; else 'N'; \r\n\t-- --If 'N/A' move 2 blank spaces\n\tDECODE(\n\t    LTRIM(RTRIM(in_full_pay_inj_day_ind)),\n\t    'N', 'N',\n\t    'Y', 'Y',\n\t    'N/A', '',\n\t    ''\n\t) AS v_full_pay_inj_day_ind,\n\tv_full_pay_inj_day_ind AS o_full_pay_inj_day_ind,\n\tpre_exst_disability_ind AS in_pre_exst_disability_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_pre_exst_disability_ind)) = 'N/A','',\r\n\t-- LTRIM(RTRIM(in_pre_exst_disability_ind)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(in_pre_exst_disability_ind)) = 'N/A', '',\n\t    LTRIM(RTRIM(in_pre_exst_disability_ind))\n\t) AS v_pre_exst_disability_ind,\n\tv_pre_exst_disability_ind AS o_pre_exst_disability_ind,\n\tmax_med_improvement_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- TO_CHAR(max_med_improvement_date,'YYYYMMDD') != '18000101',TO_CHAR(max_med_improvement_date,'YYYYMMDD'),\r\n\t-- '' )\r\n\t-- \r\n\t-- --IIF(TO_CHAR(max_med_improvement_date,'YYYYMMDD')='18000101','',TO_CHAR(max_med_improvement_date,'YYYYMMDD'))\n\tDECODE(\n\t    TRUE,\n\t    TO_CHAR(max_med_improvement_date, 'YYYYMMDD') != '18000101', TO_CHAR(max_med_improvement_date, 'YYYYMMDD'),\n\t    ''\n\t) AS v_max_med_improvement_date,\n\tv_max_med_improvement_date AS o_max_med_improvement_date,\n\tobtained_lgl_representation_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- TO_CHAR(obtained_lgl_representation_date,'YYYYMMDD') != '18000101',TO_CHAR(obtained_lgl_representation_date,'YYYYMMDD') ,\r\n\t-- '' )\r\n\t-- \r\n\t-- --IIF(TO_CHAR(obtained_lgl_representation_date,'YYYYMMDD')--='18000101','',TO_CHAR(obtained_lgl_representation_date,'YYYYMMDD'))\n\tDECODE(\n\t    TRUE,\n\t    TO_CHAR(obtained_lgl_representation_date, 'YYYYMMDD') != '18000101', TO_CHAR(obtained_lgl_representation_date, 'YYYYMMDD'),\n\t    ''\n\t) AS v_obtained_lgl_representation_date,\n\tv_obtained_lgl_representation_date AS o_obtained_lgl_representation_date,\n\tfringe_bnft_discontinued_amt,\n\tmed_auth_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(med_auth_ind))='N/A','',\r\n\t-- LTRIM(RTRIM(med_auth_ind)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(med_auth_ind)) = 'N/A', '',\n\t    LTRIM(RTRIM(med_auth_ind))\n\t) AS v_med_auth_ind,\n\tv_med_auth_ind AS o_med_auth_ind,\n\teducation_lvl,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(education_lvl))='N/A','',\r\n\t-- LTRIM(RTRIM(education_lvl)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(education_lvl)) = 'N/A', '',\n\t    LTRIM(RTRIM(education_lvl))\n\t) AS v_education_lvl,\n\tv_education_lvl AS o_education_lvl,\n\tauth_to_release_ssn_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(auth_to_release_ssn_ind))='N/A','',\r\n\t-- LTRIM(RTRIM(auth_to_release_ssn_ind)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(auth_to_release_ssn_ind)) = 'N/A', '',\n\t    LTRIM(RTRIM(auth_to_release_ssn_ind))\n\t) AS v_auth_to_release_ssn_ind,\n\tv_auth_to_release_ssn_ind AS o_auth_to_release_ssn_ind,\n\toccuptn_code,\n\tinj_loc_comment,\n\tpremises_code,\n\tclaim_ctgry_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(claim_ctgry_code)) = 'N/A','',\r\n\t-- SUBSTR(LTRIM(RTRIM(claim_ctgry_code)),1,1) )\r\n\t-- \r\n\t-- --DECODE(LTRIM(RTRIM(claim_ctgry_code)),\r\n\t-- --'MO','M',\r\n\t-- --'IN','I',\r\n\t-- --'NO','N',\r\n\t-- --'')\r\n\t-- \r\n\t-- --When 'MO' then 'M' when 'I' then 'I' when 'NO' then 'N' else ' '\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(claim_ctgry_code)) = 'N/A', '',\n\t    SUBSTR(LTRIM(RTRIM(claim_ctgry_code)), 1, 1)\n\t) AS v_claim_ctgry_code,\n\tv_claim_ctgry_code AS o_claim_ctgry_code,\n\twage_rate_amt,\n\t-- *INF*: IIF(LTRIM(RTRIM(in_emplymnt_status_code))<>'9'  AND in_avg_wkly_wage=0,\r\n\t-- to_char(wage_rate_amt),to_char(in_avg_wkly_wage) )\r\n\t-- \r\n\t-- \r\n\t-- --Case when workers_comp_claimant_detail.emplymnt_status_code <> 9 And CASE When workers_comp_claimant_detial.avg_wkly_wage = 0 then\r\n\t-- --workers_comp_claimant_detail.wage_rate_amt  Else\r\n\t-- -- workers_comp_claimant_detail.avg_wkly_wage\r\n\t-- \n\tIFF(\n\t    LTRIM(RTRIM(in_emplymnt_status_code)) <> '9' AND in_avg_wkly_wage = 0,\n\t    to_char(wage_rate_amt),\n\t    to_char(in_avg_wkly_wage)\n\t) AS v_average_wage,\n\t-- *INF*: v_average_wage\r\n\t-- \r\n\t-- --Case when workers_comp_claimant_detail.emplymnt_status_code <> 9 And CASE When workers_comp_claimant_detial.avg_wkly_wage = 0 then\r\n\t-- --workers_comp_claimant_detail.wage_rate_amt  Else\r\n\t-- -- workers_comp_claimant_detail.avg_wkly_wage\r\n\t-- \n\tv_average_wage AS o_average_wage,\n\temp_id_num,\n\t-- *INF*: DECODE(LTRIM(RTRIM(emp_id_num)),\r\n\t-- 'N/A','',\r\n\t-- LTRIM(RTRIM(emp_id_num)) )\r\n\t-- \n\tDECODE(\n\t    LTRIM(RTRIM(emp_id_num)),\n\t    'N/A', '',\n\t    LTRIM(RTRIM(emp_id_num))\n\t) AS v_emp_id_num,\n\tv_emp_id_num AS o_emp_id_num,\n\temp_id_type,\n\t-- *INF*: LTRIM(RTRIM(emp_id_type))\n\tLTRIM(RTRIM(emp_id_type)) AS v_emp_id_type,\n\tv_emp_id_type AS o_emp_id_type,\n\twork_week_days,\n\twork_week_type,\n\templyr_lost_time_notified_date,\n\t-- *INF*: IIF(ltrim(rtrim(emplyr_lost_time_notified_date))='18000101','',LTRIM(RTRIM(emplyr_lost_time_notified_date)) )\n\tIFF(\n\t    ltrim(rtrim(emplyr_lost_time_notified_date)) = '18000101', '',\n\t    LTRIM(RTRIM(emplyr_lost_time_notified_date))\n\t) AS v_emplyr_lost_time_notified_date,\n\tv_emplyr_lost_time_notified_date AS o_emplyr_lost_time_notified_date,\n\tNaicsCode,\n\t-- *INF*: LTRIM(RTRIM(NaicsCode))\n\tLTRIM(RTRIM(NaicsCode)) AS o_NaicsCode,\n\tsalary_paid_ind,\n\t-- *INF*: LTRIM(RTRIM(salary_paid_ind))\n\tLTRIM(RTRIM(salary_paid_ind)) AS v_salary_paid_ind,\n\tv_salary_paid_ind AS o_salary_paid_ind,\n\temp_security_id,\n\tact_status_code,\n\tFullDenialReasonCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- FullDenialReasonCode = 'N/A','',\r\n\t-- LTRIM(RTRIM(FullDenialReasonCode)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    FullDenialReasonCode = 'N/A', '',\n\t    LTRIM(RTRIM(FullDenialReasonCode))\n\t) AS o_FullDenialReasonCode,\n\tIAIABCLossTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IAIABCLossTypeCode = 'N/A','',\r\n\t-- LTRIM(RTRIM(IAIABCLossTypeCode)) )\n\tDECODE(\n\t    TRUE,\n\t    IAIABCLossTypeCode = 'N/A', '',\n\t    LTRIM(RTRIM(IAIABCLossTypeCode))\n\t) AS o_IAIABCLossTypeCode,\n\tFROILateReasonCode,\n\tManualClassificationCode,\n\tnum_of_exemptions,\n\t-- *INF*: TO_CHAR(num_of_exemptions)\n\tTO_CHAR(num_of_exemptions) AS o_num_of_exemptions,\n\tclaim_party_key,\n\ttax_fed_id,\n\tclaim_party_full_name,\n\tclaim_party_addr AS in_claim_party_addr,\n\t-- *INF*: REPLACESTR(0,LTRIM(RTRIM(in_claim_party_addr)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'\\',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t--        '/',\r\n\t-- \t'')\n\tREGEXP_REPLACE(LTRIM(RTRIM(in_claim_party_addr)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','\\','|',';',':','\"',CHR(39),',','<','.','>','?','/','','i') AS v_claim_party_addr,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',v_claim_party_addr,'' )\n\tIFF(claim_party_role_code = 'CLMT', v_claim_party_addr, '') AS o_claim_party_addr,\n\ttax_ssn_id AS in_tax_ssn_id,\n\t-- *INF*: IIF(in_tax_ssn_id =  'N/A' ,'', LTRIM(RTRIM(REPLACECHR(0,in_tax_ssn_id,'-',''))))\r\n\t-- \r\n\t-- \r\n\t-- --IF claim_party.tax_ssn_id =  'N/A'  THEN ' ' ELSE  Remove '-' with '' in claim_party.tax_ssn_id \n\tIFF(in_tax_ssn_id = 'N/A', '', LTRIM(RTRIM(REGEXP_REPLACE(in_tax_ssn_id,'-','','i')))) AS v_tax_ssn_id,\n\tv_tax_ssn_id AS o_tax_ssn_id,\n\tclaim_party_first_name AS in_claim_party_first_name,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',SUBSTR(LTRIM(RTRIM(in_claim_party_first_name)),1,15),'')\r\n\t-- \r\n\t-- --Case when claim_party_occurrence.claim_party_role_code = 'CLMT' then Substring(claim_party.claim_party_first_name,1,15).  Truncate to 15 positions. Left justify and pad if length is less than 15\n\tIFF(\n\t    claim_party_role_code = 'CLMT', SUBSTR(LTRIM(RTRIM(in_claim_party_first_name)), 1, 15), ''\n\t) AS v_claim_party_first_name,\n\tv_claim_party_first_name AS o_claim_party_first_name,\n\tclaim_party_mid_name AS in_claim_party_mid_name,\n\t-- *INF*: REPLACESTR(0,LTRIM(RTRIM(in_claim_party_mid_name)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'\\',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t--        '/',\r\n\t-- \t'')\n\tREGEXP_REPLACE(LTRIM(RTRIM(in_claim_party_mid_name)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','\\','|',';',':','\"',CHR(39),',','<','.','>','?','/','','i') AS v_mid_name_reformatted,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- claim_party_role_code='CLMT', DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(v_mid_name_reformatted))='N/A','',\r\n\t-- LTRIM(RTRIM(v_mid_name_reformatted)) ),\r\n\t-- '' )\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(v_mid_name_reformatted))='N/A','',LTRIM(RTRIM(v_mid_name_reformatted)))\n\tDECODE(\n\t    TRUE,\n\t    claim_party_role_code = 'CLMT', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_mid_name_reformatted)) = 'N/A', '',\n\t        LTRIM(RTRIM(v_mid_name_reformatted))\n\t    ),\n\t    ''\n\t) AS o_claim_party_mid_name,\n\tclaim_party_last_name AS in_claim_party_last_name,\n\t-- *INF*: REPLACESTR(0,LTRIM(RTRIM(in_claim_party_last_name)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'\\',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t--        '/',\r\n\t-- \t'')\n\tREGEXP_REPLACE(LTRIM(RTRIM(in_claim_party_last_name)),'`','~','!','@','#','$','%','^','&','*','(',')','_','=','+','[','{',']','}','\\','|',';',':','\"',CHR(39),',','<','.','>','?','/','','i') AS v_last_name_reformatted,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',v_last_name_reformatted,'' )\n\tIFF(claim_party_role_code = 'CLMT', v_last_name_reformatted, '') AS o_claim_party_last_name,\n\tclaim_party_city AS in_claim_party_city,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',SUBSTR(LTRIM(RTRIM(in_claim_party_city)),1,15),'')\r\n\t-- \r\n\t-- --Case when claim_party_occurrence.claim_party_role_code = 'CLMT' then Substring(claim_party.claim_party_city,1,15)  if length is less than 15, then left justify and pad with spaces.\r\n\t-- \r\n\t-- --v_claim_party_city\n\tIFF(claim_party_role_code = 'CLMT', SUBSTR(LTRIM(RTRIM(in_claim_party_city)), 1, 15), '') AS v_claim_party_city,\n\tv_claim_party_city AS o_claim_party_city,\n\tclaim_party_state AS in_claim_party_state,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',SUBSTR(LTRIM(RTRIM(in_claim_party_state)),1,2),'')\r\n\t-- \r\n\t-- --Case when claim_party_occurrence.claim_party_role_code = 'CLMT' then Substring(claim_party.claim_party_state,1,2)\n\tIFF(claim_party_role_code = 'CLMT', SUBSTR(LTRIM(RTRIM(in_claim_party_state)), 1, 2), '') AS v_claim_party_state,\n\tv_claim_party_state AS o_claim_party_state,\n\tclaim_party_zip AS in_claim_party_zip,\n\t-- *INF*: IIF(claim_party_role_code='CLMT',REPLACECHR(0,LTRIM(RTRIM(in_claim_party_zip)),'-',''),'') \r\n\t-- \r\n\t-- --claim_party_occurrence.claim_party_role_code = 'CLMT' then Replace(Substring(claim_party.claim_party_zip,1,9),'-','')Left justified; pad with spaces.\n\tIFF(\n\t    claim_party_role_code = 'CLMT', REGEXP_REPLACE(LTRIM(RTRIM(in_claim_party_zip)),'-','','i'),\n\t    ''\n\t) AS v_claim_party_zip,\n\tv_claim_party_zip AS o_claim_party_zip,\n\tph_num AS in_ph_num,\n\t-- *INF*: REPLACECHR(0,ltrim(rtrim(in_ph_num)),'-','')\r\n\t-- \r\n\t-- --Replace (-) and truncate to 9 positions.\r\n\t-- --Left justified; pad with spaces.\n\tREGEXP_REPLACE(ltrim(rtrim(in_ph_num)),'-','','i') AS v_ph_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(v_ph_num))='N/A','',\r\n\t-- LTRIM(RTRIM(v_ph_num)) )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(claim_party_role_code='CLMT',v_ph_num,'' )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(v_ph_num)) = 'N/A', '',\n\t    LTRIM(RTRIM(v_ph_num))\n\t) AS o_ph_num,\n\tclaim_party_birthdate AS in_claim_party_birthdate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- claim_party_role_code='CLMT',DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_claim_party_birthdate))  = '18000101','',\r\n\t-- LTRIM(RTRIM(in_claim_party_birthdate)) ),\r\n\t-- '' )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    claim_party_role_code = 'CLMT', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(in_claim_party_birthdate)) = '18000101', '',\n\t        LTRIM(RTRIM(in_claim_party_birthdate))\n\t    ),\n\t    ''\n\t) AS v_claim_party_birthdate,\n\tv_claim_party_birthdate AS o_claim_party_birthdate,\n\tclaim_party_gndr AS in_claim_party_gndr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- claim_party_role_code = 'CLMT', DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(in_claim_party_gndr))='N/A','',\r\n\t-- LTRIM(RTRIM(in_claim_party_gndr)) ),\r\n\t-- '' )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(claim_party_role_code = 'CLMT',IIF(LTRIM(RTRIM(in_claim_party_gndr))='N/A','',LTRIM(RTRIM(in_claim_party_gndr)) ))\r\n\t-- \r\n\t-- --Case when claim_party_occurrence.claim_party_role_code = 'CLMT' then left justify and truncate to 1 position claim_party.claim_party_gndr. If N/A then send blank space.\n\tDECODE(\n\t    TRUE,\n\t    claim_party_role_code = 'CLMT', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(in_claim_party_gndr)) = 'N/A', '',\n\t        LTRIM(RTRIM(in_claim_party_gndr))\n\t    ),\n\t    ''\n\t) AS v_claim_party_gndr,\n\tv_claim_party_gndr AS o_claim_party_gndr,\n\tclaim_party_name_sfx,\n\toccuptn_descript AS in_occuptn_descript,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(in_occuptn_descript),'',\r\n\t-- LTRIM(RTRIM(in_occuptn_descript))='N/A','',\r\n\t-- LTRIM(RTRIM(in_occuptn_descript)) )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(in_occuptn_descript),'',IIF( @{pipeline().parameters.STATE_CODE} = 'MN' , ' ', in_occuptn_descript))\r\n\t-- \r\n\t-- --IF (@{pipeline().parameters.STATE_CODE} = 'MN' ) THEN  ' ' ELSE  sup_workers_comp_occupation.occuptn_descript\n\tDECODE(\n\t    TRUE,\n\t    in_occuptn_descript IS NULL, '',\n\t    LTRIM(RTRIM(in_occuptn_descript)) = 'N/A', '',\n\t    LTRIM(RTRIM(in_occuptn_descript))\n\t) AS v_occuptn_descript,\n\tv_occuptn_descript AS o_occuptn_descript,\n\tclaim_party_role_code,\n\tclaim_party_ak_id,\n\tStrategicProfitCenterDescription,\n\t-- *INF*: '390698170'\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(LTRIM(RTRIM(StrategicProfitCenterDescription)),\r\n\t-- --'West Bend Commercial Lines', '390698170',\r\n\t-- --'Argent','390698170',\r\n\t-- --'Other','390698170',\r\n\t-- --'NSI','095680231',\r\n\t-- --'')\r\n\t-- \n\t'390698170' AS InsurerFEIN,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(StrategicProfitCenterDescription)),'NSI','West Bend Commercial Lines','Argent','Other'),'West Bend',\r\n\t-- '')\r\n\t-- \r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'West Bend Commercial Lines' or 'Argent'\r\n\t-- --hard-coded:  'West Bend'\r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'NSI'\r\n\t-- --hard-coded: NSI\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(StrategicProfitCenterDescription)) IN ('NSI','West Bend Commercial Lines','Argent','Other'), 'West Bend',\n\t    ''\n\t) AS v_InsurerName,\n\tv_InsurerName AS o_InsurerName,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(StrategicProfitCenterDescription)),'NSI','West Bend Commercial Lines','Argent','Other'),'1900 S. 18TH AVE',\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'NSI' then '8401 GREENWAY BLVD'\r\n\t-- --When SPC.StrategicProfitCenterDescription = 'West Bend Commercial Lines' or 'Argent' \r\n\t-- --then '1900 S. 18TH AVE' \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(StrategicProfitCenterDescription)) IN ('NSI','West Bend Commercial Lines','Argent','Other'), '1900 S. 18TH AVE',\n\t    ''\n\t) AS v_ClaimAdminAddress1,\n\tv_ClaimAdminAddress1 AS o_ClaimAdminAddress1,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(StrategicProfitCenterDescription)),'NSI','West Bend Commercial Lines','Argent','Other'),'WEST BEND',\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'NSI' then 'MIDDLETON'\r\n\t-- --When SPC.StrategicProfitCenterDescription = 'West Bend Commercial Lines' or 'Argent'\r\n\t-- --then 'WEST BEND'\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(StrategicProfitCenterDescription)) IN ('NSI','West Bend Commercial Lines','Argent','Other'), 'WEST BEND',\n\t    ''\n\t) AS v_ClaimAdministratorCity,\n\tv_ClaimAdministratorCity AS o_ClaimAdministratorCity,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(StrategicProfitCenterDescription)),'NSI','West Bend Commercial Lines','Argent','Other'),'WI',\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'NSI' then 'WI'\r\n\t-- --When SPC.StrategicProfitCenterDescription = 'West Bend Commercial Lines' or 'Argent'\r\n\t-- --then 'WI'\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(StrategicProfitCenterDescription)) IN ('NSI','West Bend Commercial Lines','Argent','Other'), 'WI',\n\t    ''\n\t) AS v_ClaimAdministratorStateCode,\n\tv_ClaimAdministratorStateCode AS o_ClaimAdministratorStateCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(StrategicProfitCenterDescription)),'NSI','West Bend Commercial Lines','Argent','Other'),'530959791',\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- --Case when SPC.StrategicProfitCenterDescription = 'NSI' then '535620976'\r\n\t-- --When SPC.StrategicProfitCenterDescription = 'West Bend Commercial Lines' or 'Argent'\r\n\t-- --then '530959791'\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(StrategicProfitCenterDescription)) IN ('NSI','West Bend Commercial Lines','Argent','Other'), '530959791',\n\t    ''\n\t) AS v_ClaimAdministratorPostalCode,\n\tv_ClaimAdministratorPostalCode AS o_ClaimAdministratorPostalCode,\n\t'390698170' AS ClaimAdministratorFEIN,\n\tclaim_occurrence_ak_id,\n\tpol_key_ak_id,\n\tclaim_loss_date,\n\t-- *INF*: LPAD(TO_CHAR(GET_DATE_PART(claim_loss_date,'HH24')),2,'0')||LPAD(TO_CHAR(GET_DATE_PART(claim_loss_date,'MI')),2,'0')\n\tLPAD(TO_CHAR(DATE_PART(claim_loss_date, 'HH24')), 2, '0') || LPAD(TO_CHAR(DATE_PART(claim_loss_date, 'MI')), 2, '0') AS v_claim_loss_time,\n\tv_claim_loss_time AS o_claim_loss_time,\n\tclaim_loss_date_convert AS convert_claim_loss_date,\n\t-- *INF*: --DECODE(TRUE,\r\n\t-- --LTRIM(RTRIM(in_jurisdiction_state_code))='IA',TO_CHAR(claim_loss_date,'MM/DD/YYYY'),\r\n\t-- convert_claim_loss_date -- )\n\tconvert_claim_loss_date AS v_convert_claim_loss_date,\n\t-- *INF*: IIF(LTRIM(RTRIM(v_convert_claim_loss_date))='18000101','',v_convert_claim_loss_date )\n\tIFF(LTRIM(RTRIM(v_convert_claim_loss_date)) = '18000101', '', v_convert_claim_loss_date) AS o_convert_claim_loss_date,\n\tclaim_occurrence_key,\n\tloss_loc_zip AS in_loss_loc_zip,\n\t-- *INF*: IIF(ISNULL(in_loss_loc_zip)  OR LTRIM(RTRIM(in_loss_loc_zip))='N/A','',REPLACECHR(0,in_loss_loc_zip,'-','') )\r\n\t-- \r\n\t-- --Replace '-' and truncate to 9 positions. Left justified; pad with spaces.\n\tIFF(\n\t    in_loss_loc_zip IS NULL OR LTRIM(RTRIM(in_loss_loc_zip)) = 'N/A', '',\n\t    REGEXP_REPLACE(in_loss_loc_zip,'-','','i')\n\t) AS v_loss_loc_zip,\n\tv_loss_loc_zip AS o_loss_loc_zip,\n\tclaim_loss_descript AS in_claim_loss_descript,\n\t-- *INF*: REPLACESTR(0,LTRIM(RTRIM(in_claim_loss_descript)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'\\',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t-- \t'/',\r\n\t-- \t'')\r\n\t-- \r\n\t-- --Eliminate the following characters in claim_occurrence.claim_loss_descript ,( '`', '~', '!', '@' ,'#', '$', '%', '^', '&', '*', '(', ')', '-', '_', '=', '+', '[', '{', ']', '}', '\\', '|', ';', ':', '\"',  CHR(39), ',', '<', '.', '>', '?', '/'')\n\tREGEXP_REPLACE(LTRIM(RTRIM(in_claim_loss_descript)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','\\','|',';',':','\"',CHR(39),',','<','.','>','?','/','','i') AS v_claim_loss_descript,\n\tv_claim_loss_descript AS o_claim_loss_descript,\n\tsource_claim_occurrence_status_code,\n\tloss_loc_county,\n\t-- *INF*: IIF(LTRIM(RTRIM(loss_loc_county))='N/A','',LTRIM(RTRIM(loss_loc_county)) )\n\tIFF(LTRIM(RTRIM(loss_loc_county)) = 'N/A', '', LTRIM(RTRIM(loss_loc_county))) AS v_loss_loc_county,\n\tv_loss_loc_county AS o_loss_loc_county,\n\tloss_loc_city,\n\t-- *INF*: IIF(LTRIM(RTRIM(loss_loc_city))='N/A','',LTRIM(RTRIM(loss_loc_city)) )\r\n\t-- \n\tIFF(LTRIM(RTRIM(loss_loc_city)) = 'N/A', '', LTRIM(RTRIM(loss_loc_city))) AS v_loss_loc_city,\n\tv_loss_loc_city AS o_loss_loc_city,\n\tloss_loc_addr,\n\t-- *INF*: IIF(LTRIM(RTRIM(loss_loc_addr))='N/A','',LTRIM(RTRIM(loss_loc_addr)) )\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(LTRIM(RTRIM(loss_loc_addr)) = 'N/A', '', LTRIM(RTRIM(loss_loc_addr))) AS v_loss_loc_addr,\n\tv_loss_loc_addr AS o_loss_loc_addr,\n\tloss_loc_state,\n\t-- *INF*: IIF(LTRIM(RTRIM(loss_loc_state))='N/A','',LTRIM(RTRIM(loss_loc_state)))\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(loss_loc_state)  OR LTRIM(RTRIM(loss_loc_state))='N/A','',LTRIM(RTRIM(loss_loc_state)))\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(LTRIM(RTRIM(loss_loc_state)) = 'N/A', '', LTRIM(RTRIM(loss_loc_state))) AS v_loss_loc_state,\n\tv_loss_loc_state AS o_loss_loc_state,\n\tclaim_rep_email,\n\t-- *INF*: LTRIM(RTRIM(claim_rep_email))\n\tLTRIM(RTRIM(claim_rep_email)) AS v_claim_rep_email,\n\tv_claim_rep_email AS o_claim_rep_email,\n\tclaim_rep_full_name,\n\t-- *INF*: LTRIM(RTRIM(claim_rep_full_name))\n\tLTRIM(RTRIM(claim_rep_full_name)) AS v_claim_rep_full_name,\n\tv_claim_rep_full_name AS o_claim_rep_full_name,\n\tSYSDATE AS CurrentDate,\n\tRep_Ph_Num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(Rep_Ph_Num) OR IS_SPACES(Rep_Ph_Num) OR LENGTH(Rep_Ph_Num) = 0,'',\r\n\t-- LTRIM(RTRIM(Rep_Ph_Num))='N/A','',\r\n\t-- LTRIM(RTRIM(Rep_Ph_Num))\r\n\t--  )\n\tDECODE(\n\t    TRUE,\n\t    Rep_Ph_Num IS NULL OR LENGTH(Rep_Ph_Num)>0 AND TRIM(Rep_Ph_Num)='' OR LENGTH(Rep_Ph_Num) = 0, '',\n\t    LTRIM(RTRIM(Rep_Ph_Num)) = 'N/A', '',\n\t    LTRIM(RTRIM(Rep_Ph_Num))\n\t) AS v_Rep_Ph_Num,\n\tRep_Ph_Extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(Rep_Ph_Extension)OR IS_SPACES(Rep_Ph_Extension) OR LENGTH(Rep_Ph_Extension) = 0,'',\r\n\t-- LTRIM(RTRIM(Rep_Ph_Extension))='N/A','',\r\n\t-- LTRIM(RTRIM(Rep_Ph_Extension)) )\n\tDECODE(\n\t    TRUE,\n\t    Rep_Ph_Extension IS NULL OR LENGTH(Rep_Ph_Extension)>0 AND TRIM(Rep_Ph_Extension)='' OR LENGTH(Rep_Ph_Extension) = 0, '',\n\t    LTRIM(RTRIM(Rep_Ph_Extension)) = 'N/A', '',\n\t    LTRIM(RTRIM(Rep_Ph_Extension))\n\t) AS v_Rep_Ph_Extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_Rep_Ph_Num='','',\r\n\t-- SUBSTR(v_Rep_Ph_Num ,1,10)|| SUBSTR(v_Rep_Ph_Extension,1,5)\r\n\t-- )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    v_Rep_Ph_Num = '', '',\n\t    SUBSTR(v_Rep_Ph_Num, 1, 10) || SUBSTR(v_Rep_Ph_Extension, 1, 5)\n\t) AS claim_rep_phone,\n\tFROIClaimType,\n\tFROICancelReasonCode,\n\tFROIFullDenialReasonNarrative,\n\tBodyPartLocationCode,\n\tFingersToesLocationCode,\n\tFROICancelReasonNarrative,\n\tFirstDisabilityDateAfterWaitingPeriod,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tTO_CHAR(FirstDisabilityDateAfterWaitingPeriod,'YYYYMMDD') != '18000101',\r\n\t-- \t\tTO_CHAR(FirstDisabilityDateAfterWaitingPeriod,'YYYYMMDD') ,\r\n\t-- \t'')\n\tDECODE(\n\t    TRUE,\n\t    TO_CHAR(FirstDisabilityDateAfterWaitingPeriod, 'YYYYMMDD') != '18000101', TO_CHAR(FirstDisabilityDateAfterWaitingPeriod, 'YYYYMMDD'),\n\t    ''\n\t) AS v_FirstDisabilityDateAfterWaitingPeriod,\n\tv_FirstDisabilityDateAfterWaitingPeriod AS o_FirstDisabilityDateAfterWaitingPeriod,\n\tInjurySeverityType,\n\tCurrentDateDisabilityBegan,\n\tDateEmployerHadKnowledgeofCurrentDateofDisability,\n\tDateWBMIHadKnowledgeofCurrentDateofDisability,\n\tDateClaimAdminHadKnowledgeClaimMetReportingRequirements\n\tFROM SQ_workers_comp_claimant_detail\n\tLEFT JOIN LKP_MAX_CREATE_DATE LKP_MAX_CREATE_DATE_wc_claimant_det_ak_id\n\tON LKP_MAX_CREATE_DATE_wc_claimant_det_ak_id.WC_CLAIMANT_DET_AK_ID = wc_claimant_det_ak_id\n\n),\nLKP_CLASS_CODE_CCD AS (\n\tSELECT\n\trisk_unit,\n\tClassCode,\n\tclaim_party_occurrence_ak_id\n\tFROM (\n\t\tselect\r\n\t\ta.risk_unit as risk_unit\r\n\t\t,a.ClassCode as ClassCode\r\n\t\t,a.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id FROM claimant_coverage_detail a\r\n\t\twhere a.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id ORDER BY risk_unit) = 1\n),\nLKP_Claim_Occurrence AS (\n\tSELECT\n\tclaim_party_key,\n\tIN_claim_occurrence_ak_id,\n\tclaim_occurrence_ak_id\n\tFROM (\n\t\tselect CP.claim_party_key as claim_party_key,\r\n\t\tCO.claim_occurrence_ak_id as claim_occurrence_ak_id\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO\r\n\t\ton CPO.claim_occurrence_ak_id=CO.claim_occurrence_ak_id \r\n\t\tand CPO.claim_party_role_code='EMPR'\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party CP\r\n\t\ton CP.claim_party_ak_id = CPO.claim_party_ak_id\r\n\t\twhere CP.crrnt_snpsht_flag=1 and CPO.crrnt_snpsht_flag=1 and CO.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id ORDER BY claim_party_key) = 1\n),\nLKP_CLT_ref_relation_stage AS (\n\tSELECT\n\tcirf_ref_id,\n\tclient_id,\n\tcirf_eff_dt,\n\tcirf_exp_dt\n\tFROM (\n\t\tselect client_id as client_id \r\n\t\t,cirf_ref_id as cirf_ref_id\r\n\t\t,cirf_eff_dt as cirf_eff_dt\r\n\t\t,cirf_exp_dt as cirf_exp_dt\r\n\t\tfrom @{pipeline().parameters.SOURCE_STAGE_CONNECTION}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.clt_ref_relation_stage\r\n\t\twhere history_vld_nbr=0\r\n\t\tand ref_typ_cd = 'UIAI'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY client_id,cirf_eff_dt,cirf_exp_dt ORDER BY cirf_ref_id) = 1\n),\nLKP_CurrentDateLastDayWorked AS (\n\tSELECT\n\tmax_emp_last_day_worked,\n\twc_claimant_det_ak_id\n\tFROM (\n\t\tSELECT  \r\n\t\tp.max_emp_last_day_worked           as MAX_EMP_LAST_DAY_WORKED,\r\n\t\tp.wc_claimant_det_ak_id                    as  WC_CLAIMANT_DET_AK_ID \r\n\t\tFROM (\r\n\t\tSELECT a.wc_claimant_det_ak_id                                as  WC_CLAIMANT_DET_AK_ID ,\r\n\t\tMAX(a.emp_last_day_worked)                     as max_emp_last_day_worked\r\n\t\tFROM workers_comp_claimant_work_history a\r\n\t\twhere a.crrnt_snpsht_flag = 1\r\n\t\tGROUP BY a.wc_claimant_det_ak_id ) p\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY wc_claimant_det_ak_id ORDER BY max_emp_last_day_worked) = 1\n),\nLKP_Get_Policy_Details AS (\n\tSELECT\n\tpol_key,\n\tpol_eff_date,\n\tpol_exp_date,\n\tsource_sys_id,\n\tpol_key_ak_id\n\tFROM (\n\t\tSELECT \r\n\t\tpolicy.pol_key as pol_key,policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_mod as pol_mod, policy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_ak_id as pol_key_ak_id,\r\n\t\tpolicy.source_sys_id as source_sys_id \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy policy\r\n\t\twhere policy.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key_ak_id ORDER BY pol_key) = 1\n),\nLKP_Previous_MaintenanceTypeCode AS (\n\tSELECT\n\tMaintenanceTypeCode,\n\tWCClaimantDetailAKId\n\tFROM (\n\t\tselect distinct WCClaimantDetailAKId as WCClaimantDetailAKId, \r\n\t\tFIRST_VALUE(MaintenanceTypeCode) OVER (PARTITION BY WCClaimantDetailAKId ORDER BY MaitenanceTypeCodeDate DESC) as MaintenanceTypeCode\r\n\t\tfrom dbo.WorkNcciMitchell \r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WCClaimantDetailAKId ORDER BY MaintenanceTypeCode) = 1\n),\nLKP_RTW_TYPE_AND_DATE AS (\n\tSELECT\n\tmin_emp_last_day_worked,\n\twc_claimant_det_ak_id\n\tFROM (\n\t\tSELECT  \r\n\t\tp.wc_claimant_det_ak_id                    as  WC_CLAIMANT_DET_AK_ID \r\n\t\t,p.min_emp_last_day_worked                   as MIN_EMP_LAST_DAY_WORKED\r\n\t\tFROM (\r\n\t\tSELECT a.wc_claimant_det_ak_id                                as  WC_CLAIMANT_DET_AK_ID ,\r\n\t\tMIN(a.emp_last_day_worked)                     as min_emp_last_day_worked\r\n\t\tFROM workers_comp_claimant_work_history a\r\n\t\twhere a.crrnt_snpsht_flag = 1\r\n\t\tGROUP BY a.wc_claimant_det_ak_id ) p\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY wc_claimant_det_ak_id ORDER BY min_emp_last_day_worked) = 1\n),\nLKP_TO_GET_EMPLOYER_DETAILS AS (\n\tSELECT\n\tclaim_party_full_name,\n\tclaim_party_addr,\n\tclaim_party_city,\n\tclaim_party_state,\n\tclaim_party_zip,\n\taddr_type,\n\ttax_ssn_id,\n\ttax_fed_id,\n\tph_num,\n\tin_claim_occurrence_ak_id,\n\tclaim_party_id\n\tFROM (\n\t\tselect \r\n\t\ta.claim_occurrence_ak_id as claim_party_id\r\n\t\t,b.claim_party_full_name as claim_party_full_name\r\n\t\t,b.claim_party_addr as claim_party_addr \r\n\t\t,b.claim_party_city as claim_party_city\r\n\t\t,b.claim_party_state as claim_party_state\r\n\t\t,b.claim_party_zip as claim_party_zip\r\n\t\t,b.tax_ssn_id as tax_ssn_id\r\n\t\t,b.tax_fed_id as  tax_fed_id\r\n\t\t,b.addr_type as addr_type\r\n\t\t,b.ph_num as ph_num\r\n\t\tfrom \r\n\t\tclaim_party_occurrence a\r\n\t\t, claim_party b\r\n\t\twhere a.claim_party_ak_id = b.claim_party_ak_id\r\n\t\tand a.claim_party_role_code ='EMPR'\r\n\t\tand a.crrnt_snpsht_flag = 1\r\n\t\tand b.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_id ORDER BY claim_party_full_name) = 1\n),\nLKP_TO_GET_EMPR_CONTACT_DETAILS AS (\n\tSELECT\n\tclaim_party_full_name,\n\tph_extension,\n\tin_claim_occurrence_ak_id,\n\tclaim_party_id\n\tFROM (\n\t\tselect \r\n\t\ta.claim_occurrence_ak_id as claim_party_id\r\n\t\t,b.claim_party_full_name as claim_party_full_name\r\n\t\t,b.ph_extension as ph_extension\r\n\t\tfrom \r\n\t\tclaim_party_occurrence a\r\n\t\t, claim_party b\r\n\t\twhere a.claim_party_ak_id = b.claim_party_ak_id\r\n\t\tand a.claim_party_role_code ='CNCT'\r\n\t\tand a.crrnt_snpsht_flag = 1\r\n\t\tand b.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_id ORDER BY claim_party_full_name) = 1\n),\nLKP_TO_GET_INSURED_DETAILS AS (\n\tSELECT\n\tclaim_party_full_name,\n\tclaim_party_addr,\n\tclaim_party_city,\n\tclaim_party_state,\n\tclaim_party_zip,\n\ttax_ssn_id,\n\ttax_fed_id,\n\tin_claim_occurrence_ak_id,\n\tclaim_party_id\n\tFROM (\n\t\tselect \r\n\t\ta.claim_occurrence_ak_id as claim_party_id\r\n\t\t,b.claim_party_full_name as claim_party_full_name\r\n\t\t,b.claim_party_addr as claim_party_addr \r\n\t\t,b.claim_party_city as claim_party_city\r\n\t\t,b.claim_party_state as claim_party_state\r\n\t\t,b.claim_party_zip as claim_party_zip\r\n\t\t,b.tax_ssn_id as tax_ssn_id\r\n\t\t,b.tax_fed_id as  tax_fed_id \r\n\t\tfrom \r\n\t\tclaim_party_occurrence a\r\n\t\t, claim_party b\r\n\t\twhere a.claim_party_ak_id = b.claim_party_ak_id\r\n\t\tand a.claim_party_role_code ='PLHR'\r\n\t\tand a.crrnt_snpsht_flag = 1\r\n\t\tand b.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_id ORDER BY claim_party_full_name) = 1\n),\nLKP_WRK_HISTORY AS (\n\tSELECT\n\tearliest_return_to_work_date,\n\tlatest_return_to_work_date,\n\tearliest_return_to_work_type,\n\tearliest_restrictions_ind,\n\tearliest_return_to_work_with_same_emplyr_ind,\n\tlatest_return_to_work_type,\n\tlatest_restrictions_ind,\n\tlatest_return_to_work_with_same_emplyr_ind,\n\twc_claimant_det_ak_id\n\tFROM (\n\t\tSELECT A.min_return_to_work_date AS earliest_return_to_work_date,\r\n\t\t\tA.max_return_to_work_date AS latest_return_to_work_date,\r\n\t\t\tearliest.return_to_work_type AS earliest_return_to_work_type,\r\n\t\t\tearliest.wc_claimant_det_ak_id AS wc_claimant_det_ak_id,\r\n\t\t\tearliest.return_to_work_with_restriction_ind as earliest_restrictions_ind,\r\n\t\t\tearliest.return_to_work_with_same_emplyr_ind AS earliest_return_to_work_with_same_emplyr_ind,\r\n\t\t\tlatest.return_to_work_type AS latest_return_to_work_type,\r\n\t\t\tlatest.return_to_work_with_restriction_ind AS latest_restrictions_ind,\r\n\t\t\tlatest.return_to_work_with_same_emplyr_ind AS latest_return_to_work_with_same_emplyr_ind\t\r\n\t\tFROM workers_comp_claimant_work_history earliest\r\n\t\tINNER JOIN (\r\n\t\t\tSELECT MIN(h.return_to_work_date) AS min_return_to_work_date,\r\n\t\t\t\tMAX(h.return_to_work_date) AS max_return_to_work_date,\r\n\t\t\t\th.wc_claimant_det_ak_id AS wc_claimant_det_ak_id,\r\n\t\t\t\tw.jurisdiction_state_code as jurisdiction_state_code\r\n\t\t\tFROM workers_comp_claimant_work_history h\r\n\t\t\tINNER JOIN vw_workers_comp_claimant_detail w ON w.wc_claimant_det_ak_id = h.wc_claimant_det_ak_id\r\n\t\t\t\tAND (\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\tw.jurisdiction_state_code IN ('KS','MO','IA','WI','IN','NE','IL','NC','MN','TN')\r\n\t\t\t\t\t\tAND h.return_to_work_type IN ('A','R')\r\n\t\t\t\t\t\tAND h.return_to_work_date <> '01/01/1800'\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t)\r\n\t\t\tWHERE h.crrnt_snpsht_flag = 1\r\n\t\t\t\tAND w.crrnt_snpsht_flag = 1\r\n\t\t\tGROUP BY h.wc_claimant_det_ak_id, w.jurisdiction_state_code\r\n\t\t\t) A ON A.wc_claimant_det_ak_id = earliest.wc_claimant_det_ak_id\r\n\t\t\tAND A.min_return_to_work_date = earliest.return_to_work_date\r\n\t\t\tAND earliest.crrnt_snpsht_flag = 1\r\n\t\t\tAND (\r\n\t\t\t\t\r\n\t\t\t\t(\r\n\t\t\t\t\tA.jurisdiction_state_code IN ('KS','MO','IA','WI','IN','NE','IL','NC','MN','TN')\r\n\t\t\t\t\tAND earliest.return_to_work_type IN ('A','R')\r\n\t\t\t\t\tAND earliest.return_to_work_date <> '01/01/1800'\r\n\t\t\t\t\t)\r\n\t\t\t\t)\r\n\t\tINNER JOIN workers_comp_claimant_work_history latest ON A.wc_claimant_det_ak_id = latest.wc_claimant_det_ak_id\r\n\t\t\tAND A.max_return_to_work_date = latest.return_to_work_date\r\n\t\t\tAND latest.crrnt_snpsht_flag = 1\r\n\t\t\tAND (\r\n\t\t\t\t\r\n\t\t\t\t(\r\n\t\t\t\t\tA.jurisdiction_state_code IN ('KS','MO','IA','WI','IN','NE','IL','NC','MN','TN')\r\n\t\t\t\t\tAND latest.return_to_work_type IN ('A','R')\r\n\t\t\t\t\tAND latest.return_to_work_date <> '01/01/1800'\r\n\t\t\t\t\t)\r\n\t\t\t\t)--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY wc_claimant_det_ak_id ORDER BY earliest_return_to_work_date) = 1\n),\nLKP_arch_claim_object_stage AS (\n\tSELECT\n\tcob_risk_unit,\n\tcob_client_id,\n\tcob_claim_nbr\n\tFROM (\n\t\tSELECT arch_claim_object_stage.cob_risk_unit as cob_risk_unit, arch_claim_object_stage.cob_client_id as cob_client_id, arch_claim_object_stage.cob_claim_nbr as cob_claim_nbr FROM arch_claim_object_stage\r\n\t\torder by as_of_date desc --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY cob_client_id,cob_claim_nbr ORDER BY cob_risk_unit) = 1\n),\nWorkNcciMitchell_Get_Max_Date AS (\n\tSELECT\n\tCreatedDate,\n\tModifiedDate,\n\tin_wc_claimant_det_ak_id,\n\tWCClaimantDetailAKId\n\tFROM (\n\t\tSELECT WCClaimantDetailAKId AS WCClaimantDetailAKId,\r\n\t\t\tMAX(CreatedDate) AS CreatedDate\r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkNcciMitchell\r\n\t\tWHERE MaintenanceTypeCode <> 'CO'\r\n\t\tGROUP BY WCClaimantDetailAKId\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WCClaimantDetailAKId ORDER BY CreatedDate) = 1\n),\nWorkNcciMitchell_Get_MaintCode AS (\n\tSELECT\n\tMaintenanceTypeCode,\n\tMaitenanceTypeCodeDate,\n\tin_wc_claimant_det_ak_id,\n\tin_CreatedDate,\n\tWCClaimantDetailAKId,\n\tCreatedDate\n\tFROM (\n\t\tSELECT MaintenanceTypeCode AS MaintenanceTypeCode, MaitenanceTypeCodeDate AS MaitenanceTypeCodeDate,\r\n\t\tWCClaimantDetailAKId AS WCClaimantDetailAKId,\r\n\t\tCreatedDate AS CreatedDate\r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkNcciMitchell \r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WCClaimantDetailAKId,CreatedDate ORDER BY MaintenanceTypeCode) = 1\n),\nEXP_STATE_SPECIFIC AS (\n\tSELECT\n\tSYSDATE AS Createddate,\n\tSYSDATE AS Modifiedate,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Audit_ID,\n\tEXP_SOURCE.wc_claimant_det_ak_id,\n\tEXP_SOURCE.TransactionSetID,\n\tEXP_SOURCE.o_maint_type_code AS maint_type_code,\n\t-- *INF*: LTRIM(RTRIM(maint_type_code))\r\n\t-- \r\n\t-- \n\tLTRIM(RTRIM(maint_type_code)) AS v_maint_type_code,\n\tv_maint_type_code AS o_maint_type_code,\n\tEXP_SOURCE.in_jurisdiction_state_code AS jurisdiction_state_code,\n\t-- *INF*: LTRIM(RTRIM(jurisdiction_state_code)) \n\tLTRIM(RTRIM(jurisdiction_state_code)) AS v_jurisdiction_state_code,\n\t-- *INF*: LTRIM(RTRIM(v_jurisdiction_state_code))\r\n\t-- \r\n\t-- \r\n\t-- \n\tLTRIM(RTRIM(v_jurisdiction_state_code)) AS o_jurisdiction_state_code,\n\tEXP_SOURCE.o_send_to_state_time AS send_to_state_time,\n\tEXP_SOURCE.in_state_claim_num AS state_claim_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code, 'IL','MN'),\r\n\t-- \t\tIIF(IN(v_maint_type_code, '02', 'UR'),\r\n\t-- \t\t\tLTRIM(RTRIM(state_claim_num)), ''\r\n\t-- \t\t),\r\n\t-- \tLTRIM(RTRIM(state_claim_num))\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('IL','MN'), IFF(\n\t        v_maint_type_code IN ('02','UR'), LTRIM(RTRIM(state_claim_num)), ''\n\t    ),\n\t    LTRIM(RTRIM(state_claim_num))\n\t) AS v_state_claim_num,\n\tv_state_claim_num AS o_state_claim_num,\n\tEXP_SOURCE.InsurerFEIN,\n\tEXP_SOURCE.o_InsurerName AS InsurerName,\n\t-- *INF*: IIF(v_jurisdiction_state_code='MN',NULL,LTRIM(RTRIM(InsurerName)) )\r\n\t-- \n\tIFF(v_jurisdiction_state_code = 'MN', NULL, LTRIM(RTRIM(InsurerName))) AS v_InsurerName,\n\t-- *INF*: LTRIM(RTRIM(v_InsurerName))\r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --IN(LTRIM(RTRIM(jurisdiction_state_code)),'KS'),NULL,\r\n\t-- --v_InsurerName )\n\tLTRIM(RTRIM(v_InsurerName)) AS o_InsurerName,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IN','NE','TN','KY','NC','VA'),'N',\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IN','NE','TN','KY','NC','VA'), 'N',\n\t    NULL\n\t) AS IsTPA,\n\tEXP_SOURCE.o_ClaimAdminAddress1 AS ClaimAdminAddress1,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','NE','IA','WI','TN','KS','IN','KY','IL','NC','VA'),LTRIM(RTRIM(ClaimAdminAddress1)),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','NE','IA','WI','TN','KS','IN','KY','IL','NC','VA'), LTRIM(RTRIM(ClaimAdminAddress1)),\n\t    NULL\n\t) AS v_ClaimAdminAddress1,\n\tv_ClaimAdminAddress1 AS o_ClaimAdminAddress1,\n\tEXP_SOURCE.o_ClaimAdministratorCity AS ClaimAdministratorCity,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','NE','IA','WI','TN','KS','IN','IL','NC','VA'),LTRIM(RTRIM(ClaimAdministratorCity)),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','NE','IA','WI','TN','KS','IN','IL','NC','VA'), LTRIM(RTRIM(ClaimAdministratorCity)),\n\t    NULL\n\t) AS v_ClaimAdministratorCity,\n\tv_ClaimAdministratorCity AS o_ClaimAdministratorCity,\n\tEXP_SOURCE.o_ClaimAdministratorStateCode AS ClaimAdministratorStateCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','NE','IA','WI','TN','KS','IN','IL','NC','VA'),LTRIM(RTRIM(ClaimAdministratorStateCode)),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','NE','IA','WI','TN','KS','IN','IL','NC','VA'), LTRIM(RTRIM(ClaimAdministratorStateCode)),\n\t    NULL\n\t) AS v_ClaimAdministratorStateCode,\n\tv_ClaimAdministratorStateCode AS o_ClaimAdministratorStateCode,\n\tEXP_SOURCE.o_ClaimAdministratorPostalCode AS ClaimAdministratorPostalCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','KS','IA','WI','TN','IN','KY','NE','IL','NC','VA'),LTRIM(RTRIM(ClaimAdministratorPostalCode)),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','KS','IA','WI','TN','IN','KY','NE','IL','NC','VA'), LTRIM(RTRIM(ClaimAdministratorPostalCode)),\n\t    NULL\n\t) AS v_ClaimAdministratorPostalCode,\n\tv_ClaimAdministratorPostalCode AS o_ClaimAdministratorPostalCode,\n\tEXP_SOURCE.o_wc_claimant_num AS wc_claimant_num,\n\t-- *INF*: ltrim(rtrim(wc_claimant_num))\n\tltrim(rtrim(wc_claimant_num)) AS v_wc_claimant_num,\n\tv_wc_claimant_num AS o_wc_claimant_num,\n\tv_wc_claimant_num AS o_InsuredReportNumber,\n\tLKP_TO_GET_INSURED_DETAILS.tax_ssn_id AS tax_ssn_id_insured,\n\t-- *INF*: iif(isnull(tax_ssn_id_insured),'',replacechr(0,ltrim(rtrim(tax_ssn_id_insured)),'-',''))\n\tIFF(\n\t    tax_ssn_id_insured IS NULL, '', REGEXP_REPLACE(ltrim(rtrim(tax_ssn_id_insured)),'-','','i')\n\t) AS tax_ssn_id_insured_reformatted,\n\t-- *INF*: IIF(LTRIM(RTRIM(tax_ssn_id_insured_reformatted))='N/A'  OR ISNULL(LTRIM(RTRIM(tax_ssn_id_insured_reformatted))),'',\r\n\t-- LTRIM(RTRIM(tax_ssn_id_insured_reformatted)))\r\n\t-- \n\tIFF(\n\t    LTRIM(RTRIM(tax_ssn_id_insured_reformatted)) = 'N/A'\n\t    or LTRIM(RTRIM(tax_ssn_id_insured_reformatted)) IS NULL,\n\t    '',\n\t    LTRIM(RTRIM(tax_ssn_id_insured_reformatted))\n\t) AS v_tax_ssn_id_insd,\n\tLKP_TO_GET_INSURED_DETAILS.tax_fed_id AS tax_fed_id_insured,\n\t-- *INF*: IIF(ISNULL(tax_fed_id_insured),'',REPLACECHR(0,LTRIM(RTRIM(tax_fed_id_insured)),'-',''))\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --tax_fed_id_insured = 'N/A'   AND  emp_tax_ssn_id != 'N/A', LTRIM(RTRIM(REPLACECHR(0,emp_tax_ssn_id,'-',''))),\r\n\t-- --tax_fed_id_insured  !=  'N/A'   AND emp_tax_ssn_id  = 'N/A', LTRIM(RTRIM(REPLACECHR(0,tax_fed_id_insured,'-',''))),\r\n\t-- --emp_tax_ssn_id = 'N/A' AND tax_fed_id_insured = 'N/A' ,RPAD('',9,' '))\n\tIFF(\n\t    tax_fed_id_insured IS NULL, '', REGEXP_REPLACE(LTRIM(RTRIM(tax_fed_id_insured)),'-','','i')\n\t) AS tax_fed_id_insured_reformatted,\n\t-- *INF*: IIF(LTRIM(RTRIM(tax_fed_id_insured_reformatted))='N/A'  OR ISNULL(LTRIM(RTRIM(tax_fed_id_insured_reformatted))),'',\r\n\t-- LTRIM(RTRIM(tax_fed_id_insured_reformatted)))\r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --tax_fed_id_insured = 'N/A'   AND  emp_tax_ssn_id != 'N/A', LTRIM(RTRIM(REPLACECHR(0,emp_tax_ssn_id,'-',''))),\r\n\t-- --tax_fed_id_insured  !=  'N/A'   AND emp_tax_ssn_id  = 'N/A', LTRIM(RTRIM(REPLACECHR(0,tax_fed_id_insured,'-',''))),\r\n\t-- --emp_tax_ssn_id = 'N/A' AND tax_fed_id_insured = 'N/A' ,RPAD('',9,' '))\n\tIFF(\n\t    LTRIM(RTRIM(tax_fed_id_insured_reformatted)) = 'N/A'\n\t    or LTRIM(RTRIM(tax_fed_id_insured_reformatted)) IS NULL,\n\t    '',\n\t    LTRIM(RTRIM(tax_fed_id_insured_reformatted))\n\t) AS v_tax_fed_id_insured,\n\tv_tax_fed_id_insured AS o_tax_fed_id_insured,\n\tLKP_TO_GET_INSURED_DETAILS.claim_party_full_name AS full_name_insured,\n\t-- *INF*: IIF(ISNULL(full_name_insured) OR ltrim(rtrim(full_name_insured))='N/A' ,'',full_name_insured)\n\tIFF(\n\t    full_name_insured IS NULL OR ltrim(rtrim(full_name_insured)) = 'N/A', '', full_name_insured\n\t) AS v_full_name_insured,\n\t-- *INF*: REPLACESTR(0,ltrim(rtrim(v_full_name_insured)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t--        '/',\r\n\t-- \t'')\n\tREGEXP_REPLACE(ltrim(rtrim(v_full_name_insured)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','|',';',':','\"',CHR(39),',','<','.','>','?','/','','i') AS v_full_name_reformatted_insured,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','WI','NE','KS','IA','IN','TN','KY','IL','NC','VA'),v_full_name_reformatted_insured,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','WI','NE','KS','IA','IN','TN','KY','IL','NC','VA'), v_full_name_reformatted_insured,\n\t    NULL\n\t) AS o_full_name_insured,\n\tLKP_TO_GET_INSURED_DETAILS.claim_party_addr AS addr_insured,\n\t-- *INF*: REPLACESTR(0,ltrim(rtrim(addr_insured)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t-- \t'')\n\tREGEXP_REPLACE(ltrim(rtrim(addr_insured)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','|',';',':','\"',CHR(39),',','<','.','>','?','','i') AS addr_reformatted_insured,\n\t-- *INF*: IIF(ISNULL(addr_reformatted_insured),'',addr_reformatted_insured)\n\tIFF(addr_reformatted_insured IS NULL, '', addr_reformatted_insured) AS v_addr_insured,\n\tLKP_TO_GET_INSURED_DETAILS.claim_party_city AS city_insured,\n\t-- *INF*: IIF(ISNULL(city_insured),'',LTRIM(RTRIM(city_insured)))\r\n\t-- \r\n\t-- \n\tIFF(city_insured IS NULL, '', LTRIM(RTRIM(city_insured))) AS v_city_insured,\n\tLKP_TO_GET_INSURED_DETAILS.claim_party_state AS state_insured,\n\t-- *INF*: IIF(ISNULL(state_insured),'',LTRIM(RTRIM(state_insured)))\r\n\t-- \r\n\t-- \n\tIFF(state_insured IS NULL, '', LTRIM(RTRIM(state_insured))) AS v_state_insured,\n\tLKP_TO_GET_INSURED_DETAILS.claim_party_zip AS zip_insured,\n\t-- *INF*: IIF(ISNULL(zip_insured),\r\n\t-- \t\t'',\r\n\t-- \tREPLACECHR(0, REPLACECHR(0,ltrim(rtrim(zip_insured)),'-',''), ' ', '')\r\n\t-- \t)\n\tIFF(\n\t    zip_insured IS NULL, '',\n\t    REGEXP_REPLACE(REGEXP_REPLACE(ltrim(rtrim(zip_insured)),'-','','i'),' ','','i')\n\t) AS v_zip_insured,\n\tLKP_TO_GET_EMPLOYER_DETAILS.claim_party_full_name AS full_name_emplr,\n\t-- *INF*: REPLACESTR(0,ltrim(rtrim(full_name_emplr)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t-- \t'')\n\tREGEXP_REPLACE(ltrim(rtrim(full_name_emplr)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','|',';',':','\"',CHR(39),',','<','.','>','?','','i') AS full_name_emplr_reformatted,\n\t-- *INF*: IIF(iif(isnull(full_name_emplr_reformatted),v_full_name_reformatted_insured,ltrim(rtrim(full_name_emplr_reformatted)))  = 'N/A'\r\n\t-- ,''\r\n\t-- ,iif(isnull(full_name_emplr_reformatted),v_full_name_reformatted_insured,ltrim(rtrim(full_name_emplr_reformatted))) )\r\n\t-- \r\n\t-- \n\tIFF(\n\t    IFF(\n\t        full_name_emplr_reformatted IS NULL, v_full_name_reformatted_insured,\n\t        ltrim(rtrim(full_name_emplr_reformatted))\n\t    ) = 'N/A',\n\t    '',\n\t    IFF(\n\t        full_name_emplr_reformatted IS NULL, v_full_name_reformatted_insured,\n\t        ltrim(rtrim(full_name_emplr_reformatted))\n\t    )\n\t) AS v_full_name_emplr,\n\tv_full_name_emplr AS o_full_name_emplr,\n\tLKP_TO_GET_EMPLOYER_DETAILS.claim_party_addr AS addr_emplr,\n\t-- *INF*: REPLACESTR(0,ltrim(rtrim(addr_emplr)),\r\n\t-- \t'`',\r\n\t-- \t'~',\r\n\t-- \t'!',\r\n\t-- \t'@'\r\n\t-- \t,'#',\r\n\t-- \t'$',\r\n\t-- \t'%',\r\n\t-- \t'^',\r\n\t-- \t'&',\r\n\t-- \t'*',\r\n\t-- \t'(',\r\n\t-- \t')',\r\n\t-- \t'-',\r\n\t-- \t'_',\r\n\t-- \t'=',\r\n\t-- \t'+',\r\n\t-- \t'[',\r\n\t-- \t'{',\r\n\t-- \t']',\r\n\t-- \t'}',\r\n\t-- \t'|',\r\n\t-- \t';',\r\n\t-- \t':',\r\n\t-- \t'\"', \r\n\t-- \tCHR(39),\r\n\t-- \t',',\r\n\t-- \t'<',\r\n\t-- \t'.',\r\n\t-- \t'>',\r\n\t-- \t'?',\r\n\t-- \t'')\n\tREGEXP_REPLACE(ltrim(rtrim(addr_emplr)),'`','~','!','@','#','$','%','^','&','*','(',')','-','_','=','+','[','{',']','}','|',';',':','\"',CHR(39),',','<','.','>','?','','i') AS addr_emplr_reformatted,\n\t-- *INF*: IIF(iif(isnull(addr_emplr_reformatted),v_addr_insured,ltrim(rtrim(addr_emplr_reformatted)))  = 'N/A'\r\n\t-- ,''\r\n\t-- ,iif(isnull(addr_emplr_reformatted),v_addr_insured,ltrim(rtrim(addr_emplr_reformatted))) )\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(addr_emplr_reformatted),v_addr_insured,addr_emplr_reformatted)\n\tIFF(\n\t    IFF(\n\t        addr_emplr_reformatted IS NULL, v_addr_insured, ltrim(rtrim(addr_emplr_reformatted))\n\t    ) = 'N/A',\n\t    '',\n\t    IFF(\n\t        addr_emplr_reformatted IS NULL, v_addr_insured, ltrim(rtrim(addr_emplr_reformatted))\n\t    )\n\t) AS v_addr_emplr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','WI','IN','KS','TN','KY','NE','IL','NC'),v_addr_emplr,NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','WI','IN','KS','TN','KY','NE','IL','NC'), v_addr_emplr,\n\t    NULL\n\t) AS o_addr_emplr,\n\tLKP_TO_GET_EMPLOYER_DETAILS.claim_party_city AS city_emplr,\n\t-- *INF*: IIF(iif(isnull(city_emplr),v_city_insured,ltrim(rtrim(city_emplr)))  = 'N/A'\r\n\t-- ,''\r\n\t-- ,iif(isnull(city_emplr),v_city_insured,ltrim(rtrim(city_emplr))) )\r\n\t-- \r\n\t-- \n\tIFF(\n\t    IFF(\n\t        city_emplr IS NULL, v_city_insured, ltrim(rtrim(city_emplr))\n\t    ) = 'N/A', '',\n\t    IFF(\n\t        city_emplr IS NULL, v_city_insured, ltrim(rtrim(city_emplr))\n\t    )\n\t) AS v_city_emplr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','WI','IN','KS','NE','TN','KY','IL','NC'),v_city_emplr,\r\n\t-- NULL )\r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','WI','IN','KS','NE','TN','KY','IL','NC'), v_city_emplr,\n\t    NULL\n\t) AS o_city_emplr,\n\tLKP_TO_GET_EMPLOYER_DETAILS.claim_party_state AS state_emplr,\n\t-- *INF*: IIF(iif(isnull(state_emplr),v_state_insured,ltrim(rtrim(state_emplr)))  = 'N/A'\r\n\t-- ,''\r\n\t-- ,iif(isnull(state_emplr),v_state_insured,ltrim(rtrim(state_emplr))) )\n\tIFF(\n\t    IFF(\n\t        state_emplr IS NULL, v_state_insured, ltrim(rtrim(state_emplr))\n\t    ) = 'N/A',\n\t    '',\n\t    IFF(\n\t        state_emplr IS NULL, v_state_insured, ltrim(rtrim(state_emplr))\n\t    )\n\t) AS v_state_emplr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','WI','IN','KS','NE','IL','TN','KY','NC'),v_state_emplr,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','WI','IN','KS','NE','IL','TN','KY','NC'), v_state_emplr,\n\t    NULL\n\t) AS v_state_emplr_by_jurisdiction,\n\tv_state_emplr_by_jurisdiction AS o_state_emplr,\n\tLKP_TO_GET_EMPLOYER_DETAILS.claim_party_zip AS zip_emplr,\n\t-- *INF*: REPLACECHR(0, REPLACECHR(0,LTRIM(RTRIM(zip_emplr)),'-',''), ' ', '')\n\tREGEXP_REPLACE(REGEXP_REPLACE(LTRIM(RTRIM(zip_emplr)),'-','','i'),' ','','i') AS v_zip_emplr_reformatted,\n\t-- *INF*: IIF(iif(isnull(v_zip_emplr_reformatted),v_zip_insured,ltrim(rtrim(v_zip_emplr_reformatted)))  = 'N/A'\r\n\t-- ,''\r\n\t-- ,iif(isnull(v_zip_emplr_reformatted),v_zip_insured,v_zip_emplr_reformatted) )\n\tIFF(\n\t    IFF(\n\t        v_zip_emplr_reformatted IS NULL, v_zip_insured,\n\t        ltrim(rtrim(v_zip_emplr_reformatted))\n\t    ) = 'N/A',\n\t    '',\n\t    IFF(\n\t        v_zip_emplr_reformatted IS NULL, v_zip_insured, v_zip_emplr_reformatted\n\t    )\n\t) AS v_zip_emplr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','WI','IN','KS','TN','KY','NE','IL','NC'),v_zip_emplr,\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','WI','IN','KS','TN','KY','NE','IL','NC'), v_zip_emplr,\n\t    NULL\n\t) AS o_zip_emplr,\n\t-- *INF*: IIF(IN(v_state_emplr_by_jurisdiction,'AB','BC','MB','NB','NL','NT','NS','NU','ON','PE','QC','SK','YT'),\r\n\t-- 'CA',\r\n\t-- NULL)\n\tIFF(\n\t    v_state_emplr_by_jurisdiction IN ('AB','BC','MB','NB','NL','NT','NS','NU','ON','PE','QC','SK','YT'),\n\t    'CA',\n\t    NULL\n\t) AS o_EmployerPhysicalCountry,\n\tLKP_TO_GET_EMPLOYER_DETAILS.addr_type AS addr_type_empr,\n\tLKP_TO_GET_EMPLOYER_DETAILS.tax_ssn_id AS tax_ssn_id_emplr,\n\t-- *INF*: IIF(ISNULL(tax_ssn_id_emplr),'',REPLACECHR(0,LTRIM(RTRIM(tax_ssn_id_emplr)),'-',''))\n\tIFF(tax_ssn_id_emplr IS NULL, '', REGEXP_REPLACE(LTRIM(RTRIM(tax_ssn_id_emplr)),'-','','i')) AS tax_ssn_id_emplr_reformatted,\n\tLKP_TO_GET_EMPLOYER_DETAILS.tax_fed_id AS tax_fed_id_emplr,\n\t-- *INF*: IIF(ISNULL(tax_fed_id_emplr),'',replacechr(0,ltrim(rtrim(tax_fed_id_emplr)),'-',''))\n\tIFF(tax_fed_id_emplr IS NULL, '', REGEXP_REPLACE(ltrim(rtrim(tax_fed_id_emplr)),'-','','i')) AS tax_fed_id_emplr_reformatted,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- NOT IN(tax_fed_id_emplr_reformatted,'','N/A'),tax_fed_id_emplr_reformatted,\r\n\t-- DECODE(TRUE,\r\n\t-- NOT IN(tax_ssn_id_emplr_reformatted,'','N/A'),tax_ssn_id_emplr_reformatted,\r\n\t-- DECODE(TRUE,\r\n\t-- NOT IN(tax_fed_id_insured_reformatted,'','N/A'),tax_fed_id_insured_reformatted,\r\n\t-- DECODE(TRUE,\r\n\t-- NOT IN(tax_ssn_id_insured_reformatted,'','N/A'),tax_ssn_id_insured_reformatted,\r\n\t-- '' ) ) ) )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    NOT tax_fed_id_emplr_reformatted IN ('','N/A'), tax_fed_id_emplr_reformatted,\n\t    DECODE(\n\t        TRUE,\n\t        NOT tax_ssn_id_emplr_reformatted IN ('','N/A'), tax_ssn_id_emplr_reformatted,\n\t        DECODE(\n\t                TRUE,\n\t                NOT tax_fed_id_insured_reformatted IN ('','N/A'), tax_fed_id_insured_reformatted,\n\t                DECODE(\n\t                    TRUE,\n\t                    NOT tax_ssn_id_insured_reformatted IN ('','N/A'), tax_ssn_id_insured_reformatted,\n\t                    ''\n\t                )\n\t            )\n\t    )\n\t) AS v_tax_fed_id_emplr,\n\tv_tax_fed_id_emplr AS o_tax_fed_id_emplr,\n\tEXP_SOURCE.o_emp_dept_num AS emp_dept_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IN'),emp_dept_num,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN'), emp_dept_num,\n\t    NULL\n\t) AS o_emp_dept_num,\n\tLKP_Get_Policy_Details.source_sys_id,\n\tLKP_Get_Policy_Details.pol_key,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\tNULL,\r\n\t-- \t:UDF.DEFAULT_VALUE_TO_BLANKS(LTRIM(RTRIM(pol_key)))\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), NULL,\n\t    UDF_DEFAULT_VALUE_TO_BLANKS(LTRIM(RTRIM(pol_key)))\n\t) AS v_pol_key,\n\tv_pol_key AS o_pol_key,\n\tLKP_Get_Policy_Details.pol_eff_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(pol_eff_date),'',\r\n\t-- TO_CHAR(pol_eff_date,'YYYYMMDD')='18000101','',\r\n\t-- TO_CHAR(pol_eff_date,'YYYYMMDD') )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(pol_eff_date)\r\n\t-- --,''\r\n\t-- --,TO_CHAR(pol_eff_date,'YYYYMMDD'))\n\tDECODE(\n\t    TRUE,\n\t    pol_eff_date IS NULL, '',\n\t    TO_CHAR(pol_eff_date, 'YYYYMMDD') = '18000101', '',\n\t    TO_CHAR(pol_eff_date, 'YYYYMMDD')\n\t) AS v_pol_eff_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','KS','TN','IN','IL','MN'),v_pol_eff_date,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','KS','TN','IN','IL','MN'), v_pol_eff_date,\n\t    NULL\n\t) AS o_pol_eff_date,\n\tLKP_Get_Policy_Details.pol_exp_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(pol_exp_date),'',\r\n\t-- TO_CHAR(pol_exp_date,'YYYYMMDD')='18000101','',\r\n\t-- TO_CHAR(pol_exp_date,'YYYYMMDD') )\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(pol_exp_date)\r\n\t-- --,''\r\n\t-- --,TO_CHAR(pol_exp_date,'YYYYMMDD'))\n\tDECODE(\n\t    TRUE,\n\t    pol_exp_date IS NULL, '',\n\t    TO_CHAR(pol_exp_date, 'YYYYMMDD') = '18000101', '',\n\t    TO_CHAR(pol_exp_date, 'YYYYMMDD')\n\t) AS v_pol_exp_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO','TN','KS','IN','IL','MN'),v_pol_exp_date,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO','TN','KS','IN','IL','MN'), v_pol_exp_date,\n\t    NULL\n\t) AS o_pol_exp_date,\n\tEXP_SOURCE.o_convert_claim_loss_date AS claim_loss_date,\n\tEXP_SOURCE.o_claim_loss_time AS claim_loss_time,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(claim_loss_date))='18000101', '',\r\n\t-- claim_loss_time='0000', '',\r\n\t--  claim_loss_time )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(claim_loss_date)) = '18000101', '',\n\t    claim_loss_time = '0000', '',\n\t    claim_loss_time\n\t) AS v_claim_loss_time,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IL','WI','IA','KS','KY','NE','NC','VA','TN'),v_claim_loss_time,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IL','WI','IA','KS','KY','NE','NC','VA','TN'), v_claim_loss_time,\n\t    NULL\n\t) AS o_claim_loss_time,\n\tEXP_SOURCE.o_loss_loc_zip AS loss_loc_zip,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','IN','NE','WI','TN','KY','IA','NC','VA','IL'),\r\n\t-- \t\tloss_loc_zip,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS') AND LTRIM(RTRIM(premises_code))='E',\r\n\t-- \t\tloss_loc_zip ,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS') AND LTRIM(RTRIM(premises_code)) != 'E', \r\n\t-- \t\t'' ,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','IN','NE','WI','TN','KY','IA','NC','VA','IL'), loss_loc_zip,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS') AND LTRIM(RTRIM(premises_code)) = 'E', loss_loc_zip,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS') AND LTRIM(RTRIM(premises_code)) != 'E', '',\n\t    NULL\n\t) AS o_loss_loc_zip,\n\tEXP_SOURCE.o_nature_inj_code AS nature_inj_code,\n\tEXP_SOURCE.o_body_part_code AS body_part_code,\n\tEXP_SOURCE.o_cause_inj_code AS cause_inj_code,\n\tEXP_SOURCE.o_claim_loss_descript AS claim_loss_descript,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IL'),SUBSTR(\r\n\t-- LTRIM(RTRIM(claim_loss_descript )),1,150),\r\n\t-- LTRIM(RTRIM(claim_loss_descript )) )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IL'), SUBSTR(LTRIM(RTRIM(claim_loss_descript)), 1, 150),\n\t    LTRIM(RTRIM(claim_loss_descript))\n\t) AS o_claim_loss_descript,\n\tEXP_SOURCE.o_inital_treatment_code AS inital_treatment_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IN','MO','KS','IL','TN'),inital_treatment_code,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IN','MO','KS','IL','TN'), inital_treatment_code,\n\t    NULL\n\t) AS o_inital_treatment_code,\n\tEXP_SOURCE.o_emplyr_notified_date AS emplyr_notified_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'WI'),\r\n\t-- \t\tNULL ,\r\n\t-- \templyr_notified_date)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI'), NULL,\n\t    emplyr_notified_date\n\t) AS o_emplyr_notified_date,\n\tEXP_SOURCE.o_reported_to_carrier_date AS reported_to_carrier_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','KS','IA','IN','KY','NE','IL','NC','VA','TN'),\r\n\t-- \t\treported_to_carrier_date,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','KS','IA','IN','KY','NE','IL','NC','VA','TN'), reported_to_carrier_date,\n\t    NULL\n\t) AS o_reported_to_carrier_date,\n\tEXP_SOURCE.o_tax_ssn_id AS emp_tax_ssn_id,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'IL'),\r\n\t-- \t\t'',\r\n\t-- \tLTRIM(RTRIM(emp_tax_ssn_id))\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('IL'), '',\n\t    LTRIM(RTRIM(emp_tax_ssn_id))\n\t) AS o_emp_tax_ssn_id,\n\tEXP_SOURCE.o_claim_party_last_name AS emp_claim_party_last_name,\n\tEXP_SOURCE.o_claim_party_first_name AS emp_claim_party_first_name,\n\tEXP_SOURCE.o_claim_party_mid_name AS emp_claim_party_mid_name,\n\tNULL AS o_emp_claim_party_mid_name,\n\tEXP_SOURCE.o_claim_party_addr AS emp_claim_party_addr,\n\t-- *INF*: LTRIM(RTRIM(emp_claim_party_addr))\r\n\t-- \n\tLTRIM(RTRIM(emp_claim_party_addr)) AS o_emp_claim_party_addr,\n\tEXP_SOURCE.o_claim_party_city AS emp_claim_party_city,\n\tEXP_SOURCE.o_claim_party_state AS emp_claim_party_state,\n\tEXP_SOURCE.o_claim_party_zip AS emp_claim_party_zip,\n\t-- *INF*: LTRIM(RTRIM(emp_claim_party_zip))\r\n\t-- \r\n\t-- \n\tLTRIM(RTRIM(emp_claim_party_zip)) AS o_emp_claim_party_zip,\n\tEXP_SOURCE.o_ph_num AS emp_ph_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'WI'),emp_ph_num,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI'), emp_ph_num,\n\t    NULL\n\t) AS o_emp_ph_num,\n\tEXP_SOURCE.o_claim_party_birthdate AS emp_claim_party_birthdate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','WI','MO','NE','KS','IA','IN','TN','KY','IL','NC','VA'),emp_claim_party_birthdate,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','WI','MO','NE','KS','IA','IN','TN','KY','IL','NC','VA'), emp_claim_party_birthdate,\n\t    NULL\n\t) AS o_emp_claim_party_birthdate,\n\tEXP_SOURCE.o_claim_party_gndr AS emp_claim_party_gndr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'NE'),NULL ,\r\n\t-- emp_claim_party_gndr)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE'), NULL,\n\t    emp_claim_party_gndr\n\t) AS o_emp_claim_party_gndr,\n\tEXP_SOURCE.claim_party_name_sfx AS emp_claim_party_name_sfx,\n\t-- *INF*: --DECODE(TRUE,\r\n\t-- --IN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- --LTRIM(RTRIM(emp_claim_party_name_sfx)),\r\n\t-- NULL\n\tNULL AS o_emp_claim_party_name_sfx,\n\tEXP_SOURCE.o_marital_status AS marital_status,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'MN','VA'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(marital_status)),'E','L','P'),'S',\r\n\t-- \t\t\tIN(LTRIM(RTRIM(marital_status)),'C','D','S','W'),'U',\r\n\t-- \t\t\tLTRIM(RTRIM(marital_status))='M','M',\r\n\t-- \t\t\tLTRIM(RTRIM(marital_status))='U','K',\r\n\t-- \t\t\tNULL),\r\n\t-- \tLTRIM(RTRIM(jurisdiction_state_code))='IL',\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(marital_status)),'C','D','E','L','P','S','W','U'),'S',\r\n\t-- \t\t\tLTRIM(RTRIM(marital_status))='M','M',\r\n\t-- \t\t\tNULL),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(marital_status)),'C','D','S','W'),'U',\r\n\t-- \t\t\tIN(LTRIM(RTRIM(marital_status)),'E','L','P'),'S',\r\n\t-- \t\t\tLTRIM(RTRIM(marital_status))='M','M',\r\n\t-- \t\t\tNULL),\r\n\t-- \tLTRIM(RTRIM(marital_status))\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('MN','VA'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(marital_status)) IN ('E','L','P'), 'S',\n\t        LTRIM(RTRIM(marital_status)) IN ('C','D','S','W'), 'U',\n\t        LTRIM(RTRIM(marital_status)) = 'M', 'M',\n\t        LTRIM(RTRIM(marital_status)) = 'U', 'K',\n\t        NULL\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'IL', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(marital_status)) IN ('C','D','E','L','P','S','W','U'), 'S',\n\t        LTRIM(RTRIM(marital_status)) = 'M', 'M',\n\t        NULL\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(marital_status)) IN ('C','D','S','W'), 'U',\n\t        LTRIM(RTRIM(marital_status)) IN ('E','L','P'), 'S',\n\t        LTRIM(RTRIM(marital_status)) = 'M', 'M',\n\t        NULL\n\t    ),\n\t    LTRIM(RTRIM(marital_status))\n\t) AS v_marital_status,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','VA'),v_marital_status,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','VA'), v_marital_status,\n\t    NULL\n\t) AS o_marital_status,\n\tEXP_SOURCE.num_of_dependents,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'WI','KS','IA','IN','TN','NC','MN'),\r\n\t-- \tNULL,\r\n\t-- \tnum_of_dependents)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI','KS','IA','IN','TN','NC','MN'), NULL,\n\t    num_of_dependents\n\t) AS o_num_of_dependents,\n\tEXP_SOURCE.o_disability_date AS disability_date,\n\t'' AS v_disability_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'NE','TN','NC','VA'),NULL ,\r\n\t-- disability_date )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE','TN','NC','VA'), NULL,\n\t    disability_date\n\t) AS o_disability_date,\n\tEXP_SOURCE.o_death_date AS death_date,\n\tdeath_date AS o_death_date,\n\tEXP_SOURCE.o_emplymnt_status_code AS emplymnt_status_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','KY','IL','TN'),LTRIM(RTRIM(emplymnt_status_code)),\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','KY','IL','TN'), LTRIM(RTRIM(emplymnt_status_code)),\n\t    NULL\n\t) AS o_emplymnt_status_code,\n\tLKP_CLASS_CODE_CCD.risk_unit,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(risk_unit))='N/A' OR ISNULL(risk_unit),'',\r\n\t-- SUBSTR(LTRIM(RTRIM(risk_unit)),1,4) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(risk_unit)) = 'N/A' OR risk_unit IS NULL, '',\n\t    SUBSTR(LTRIM(RTRIM(risk_unit)), 1, 4)\n\t) AS v_risk_unit,\n\tLKP_CLASS_CODE_CCD.ClassCode AS ClassCode_DCT,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(ClassCode_DCT))='N/A' OR ISNULL(ClassCode_DCT),'', LTRIM(RTRIM(ClassCode_DCT)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(ClassCode_DCT)) = 'N/A' OR ClassCode_DCT IS NULL, '',\n\t    LTRIM(RTRIM(ClassCode_DCT))\n\t) AS v_ClassCode_DCT,\n\tEXP_SOURCE.ManualClassificationCode,\n\tLKP_arch_claim_object_stage.cob_risk_unit,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(cob_risk_unit))='N/A' OR ISNULL(cob_risk_unit),'',\r\n\t-- SUBSTR(LTRIM(RTRIM(cob_risk_unit)),1,4) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(cob_risk_unit)) = 'N/A' OR cob_risk_unit IS NULL, '',\n\t    SUBSTR(LTRIM(RTRIM(cob_risk_unit)), 1, 4)\n\t) AS v_cob_risk_unit,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(source_sys_id)) = 'PMS',\r\n\t-- DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(v_risk_unit)) != '',LTRIM(RTRIM(v_risk_unit)),\r\n\t-- LTRIM(RTRIM(v_cob_risk_unit)) ),\r\n\t-- LTRIM(RTRIM(v_ClassCode_DCT)) \r\n\t-- )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(source_sys_id)) = 'PMS', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_risk_unit)) != '', LTRIM(RTRIM(v_risk_unit)),\n\t        LTRIM(RTRIM(v_cob_risk_unit))\n\t    ),\n\t    LTRIM(RTRIM(v_ClassCode_DCT))\n\t) AS v_class_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'WI','NE','MN'),\r\n\t-- \tNULL,\r\n\t-- v_class_code)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI','NE','MN'), NULL,\n\t    v_class_code\n\t) AS v_class_code_state,\n\tv_class_code_state AS o_class_code,\n\tEXP_SOURCE.o_occuptn_descript AS occuptn_descript,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','WI','IA','IL','NC','TN'),LTRIM(RTRIM(occuptn_descript)),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','WI','IA','IL','NC','TN'), LTRIM(RTRIM(occuptn_descript)),\n\t    NULL\n\t) AS v_occuptn_descript,\n\tv_occuptn_descript AS o_occuptn_descript,\n\tEXP_SOURCE.o_hired_date AS hired_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'WI','KS','IA','KY','IL','NC'),hired_date,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI','KS','IA','KY','IL','NC'), hired_date,\n\t    NULL\n\t) AS o_hired_date,\n\tEXP_SOURCE.o_avg_wkly_wage AS avg_wkly_wage,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NE','IA','KS','IN','VA','TN'),\r\n\t-- \t\tNULL,\r\n\t-- \tavg_wkly_wage)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE','IA','KS','IN','VA','TN'), NULL,\n\t    avg_wkly_wage\n\t) AS o_avg_wkly_wage,\n\tEXP_SOURCE.wage_period_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KY','IL','NC'),\r\n\t-- \t\tIIF(TO_DECIMAL(RTRIM(LTRIM(avg_wkly_wage)), 2) = 0.0, NULL, '01'),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NE','IA','KS','IN','VA','TN') ,\r\n\t-- \t\tNULL,\r\n\t-- \twage_period_code)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KY','IL','NC'), IFF(\n\t        CAST(RTRIM(LTRIM(avg_wkly_wage)) AS FLOAT) = 0.0, NULL, '01'\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE','IA','KS','IN','VA','TN'), NULL,\n\t    wage_period_code\n\t) AS o_wage_period_code,\n\tEXP_SOURCE.emp_day_week,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'NC','IL'),emp_day_week,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC','IL'), emp_day_week,\n\t    NULL\n\t) AS o_emp_day_week,\n\tEXP_SOURCE.o_max_created_date AS max_,\n\tLKP_RTW_TYPE_AND_DATE.min_emp_last_day_worked,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(min_emp_last_day_worked) OR TO_CHAR(min_emp_last_day_worked,'YYYYMMDD')  = '18000101','',\r\n\t-- TO_CHAR(min_emp_last_day_worked,'YYYYMMDD') )\r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    min_emp_last_day_worked IS NULL OR TO_CHAR(min_emp_last_day_worked, 'YYYYMMDD') = '18000101', '',\n\t    TO_CHAR(min_emp_last_day_worked, 'YYYYMMDD')\n\t) AS v_emp_last_day_worked,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'WI','KS','KY','IL','MN'),\r\n\t-- \t\tv_emp_last_day_worked,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI','KS','KY','IL','MN'), v_emp_last_day_worked,\n\t    NULL\n\t) AS o_emp_last_day_worked,\n\tEXP_SOURCE.o_full_pay_inj_day_ind AS full_pay_inj_day_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'NC'),full_pay_inj_day_ind,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN')AND claim_loss_date=disability_date,full_pay_inj_day_ind,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC'), full_pay_inj_day_ind,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN') AND claim_loss_date = disability_date, full_pay_inj_day_ind,\n\t    NULL\n\t) AS o_full_pay_inj_day_ind,\n\tLKP_WRK_HISTORY.earliest_return_to_work_type AS min_return_to_work_type,\n\t-- *INF*: decode(true,\r\n\t-- isnull(min_return_to_work_type),'',\r\n\t-- ltrim(rtrim(min_return_to_work_type))='N/A','',\r\n\t-- ltrim(rtrim(min_return_to_work_type)) )\n\tdecode(\n\t    true,\n\t    min_return_to_work_type IS NULL, '',\n\t    ltrim(rtrim(min_return_to_work_type)) = 'N/A', '',\n\t    ltrim(rtrim(min_return_to_work_type))\n\t) AS v_return_to_work_type,\n\tLKP_WRK_HISTORY.earliest_return_to_work_date AS min_return_to_work_date,\n\t-- *INF*: DECODE(true,\r\n\t-- \tisnull(min_return_to_work_date),\r\n\t-- \t\t'',\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','NE','IL','NC'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(ltrim(rtrim(v_return_to_work_type)),'A','R') AND to_char(min_return_to_work_date,'YYYYMMDD') != '18000101' AND (:UDF.DEFAULT_VALUE_TO_BLANKS(min_return_to_work_type) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(earliest_return_to_work_with_same_emplyr_ind) <> ''), \r\n\t-- \t\t\t\tto_char(min_return_to_work_date,'YYYYMMDD'),\r\n\t-- \t\t\t'' ),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tltrim(rtrim(v_return_to_work_type))='A' AND to_char(min_return_to_work_date,'YYYYMMDD') != '18000101', \r\n\t-- \t\t\t\tto_char(min_return_to_work_date,'YYYYMMDD'),\r\n\t-- \t\t\t'' ),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','MO','IA','WI','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(ltrim(rtrim(v_return_to_work_type)),'A','R') AND to_char(min_return_to_work_date,'YYYYMMDD') != '18000101', \r\n\t-- \t\t\t\tto_char(min_return_to_work_date,'YYYYMMDD'),\r\n\t-- \t\t\t'' ),\r\n\t-- \t'' )\n\tDECODE(\n\t    true,\n\t    min_return_to_work_date IS NULL, '',\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','NE','IL','NC'), DECODE(\n\t        TRUE,\n\t        ltrim(rtrim(v_return_to_work_type)) IN ('A','R') AND to_char(min_return_to_work_date, 'YYYYMMDD') != '18000101' AND (UDF_DEFAULT_VALUE_TO_BLANKS(min_return_to_work_type) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(earliest_return_to_work_with_same_emplyr_ind) <> ''), to_char(min_return_to_work_date, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN'), DECODE(\n\t        TRUE,\n\t        ltrim(rtrim(v_return_to_work_type)) = 'A' AND to_char(min_return_to_work_date, 'YYYYMMDD') != '18000101', to_char(min_return_to_work_date, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','MO','IA','WI','TN'), DECODE(\n\t        TRUE,\n\t        ltrim(rtrim(v_return_to_work_type)) IN ('A','R') AND to_char(min_return_to_work_date, 'YYYYMMDD') != '18000101', to_char(min_return_to_work_date, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    ''\n\t) AS v_return_to_work_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KY','IA','VA'),\r\n\t-- \t\tNULL,\r\n\t-- \tv_return_to_work_date)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KY','IA','VA'), NULL,\n\t    v_return_to_work_date\n\t) AS o_min_return_to_work_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IN','NE','IL','NC'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(min_return_to_work_date),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tTO_CHAR(min_return_to_work_date,'YYYYMMDD') != '18000101' AND  IN(LTRIM(RTRIM(min_return_to_work_type)),'A','R'),\r\n\t-- \t\t\t\tLTRIM(RTRIM(min_return_to_work_type)),\r\n\t-- \t\t\t''), \r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IN','NE','IL','NC'), DECODE(\n\t        TRUE,\n\t        min_return_to_work_date IS NULL, '',\n\t        TO_CHAR(min_return_to_work_date, 'YYYYMMDD') != '18000101' AND LTRIM(RTRIM(min_return_to_work_type)) IN ('A','R'), LTRIM(RTRIM(min_return_to_work_type)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_R00189_MinReturnToWorkTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(min_return_to_work_date),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tTO_CHAR(min_return_to_work_date,'YYYYMMDD') != '18000101' AND  LTRIM(RTRIM(min_return_to_work_type)) = 'A',\r\n\t-- \t\t\t\t'A',\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IN','NE','IL','TN','NC'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(min_return_to_work_date),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tTO_CHAR(min_return_to_work_date,'YYYYMMDD') != '18000101' AND  IN(LTRIM(RTRIM(min_return_to_work_type)),'A','R'),\r\n\t-- \t\t\t\tLTRIM(RTRIM(min_return_to_work_type)),\r\n\t-- \t\t\t''), \r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN'), DECODE(\n\t        TRUE,\n\t        min_return_to_work_date IS NULL, '',\n\t        TO_CHAR(min_return_to_work_date, 'YYYYMMDD') != '18000101' AND LTRIM(RTRIM(min_return_to_work_type)) = 'A', 'A',\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IN','NE','IL','TN','NC'), DECODE(\n\t        TRUE,\n\t        min_return_to_work_date IS NULL, '',\n\t        TO_CHAR(min_return_to_work_date, 'YYYYMMDD') != '18000101' AND LTRIM(RTRIM(min_return_to_work_type)) IN ('A','R'), LTRIM(RTRIM(min_return_to_work_type)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_R00403_InitialReturnToWorkTypeCode,\n\tEXP_SOURCE.o_pre_exst_disability_ind AS pre_exst_disability_ind,\n\t-- *INF*:  DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IN','IL','WI','MO'),'',\r\n\t-- pre_exst_disability_ind )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IN','IL','WI','MO'), '',\n\t    pre_exst_disability_ind\n\t) AS o_pre_exst_disability_ind,\n\tEXP_SOURCE.o_max_med_improvement_date AS max_med_improvement_date,\n\t-- *INF*: max_med_improvement_date\r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --@{pipeline().parameters.STATE_CODE}='MN','',\r\n\t-- --max_med_improvement_date)\n\tmax_med_improvement_date AS v_max_med_improvement_date,\n\tv_max_med_improvement_date AS o_max_med_improvement_date,\n\tLKP_WRK_HISTORY.latest_return_to_work_date AS CurrentRTWDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t--         IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(CurrentRTWDate),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tIN(LTRIM(RTRIM(v_return_to_work_type)),'A','R') AND TO_CHAR(CurrentRTWDate,'YYYYMMDD') != '18000101' AND CurrentRTWDate > min_return_to_work_date,\r\n\t-- \t\t\t\tTO_CHAR(CurrentRTWDate,'YYYYMMDD'),\r\n\t-- \t\t\t''),\r\n\t-- \t\t\t\r\n\t-- \t IN(LTRIM(RTRIM(jurisdiction_state_code)),'NC'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(CurrentRTWDate),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tIN(LTRIM(RTRIM(v_return_to_work_type)),'A','R') AND TO_CHAR(CurrentRTWDate,'YYYYMMDD') != '18000101' AND CurrentRTWDate > min_return_to_work_date,\r\n\t-- \t\t\t\tTO_CHAR(CurrentRTWDate,'YYYYMMDD'),\r\n\t-- \t\t\t''),\t\t\r\n\t-- \t\t\t\t\t\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tISNULL(CurrentRTWDate),\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tIN(LTRIM(RTRIM(v_return_to_work_type)),'A','R') AND TO_CHAR(CurrentRTWDate,'YYYYMMDD') != '18000101',\r\n\t-- \t\t\t\tTO_CHAR(CurrentRTWDate,'YYYYMMDD'),\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NE'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(v_return_to_work_type)),'A','R') \r\n\t-- \t\t\tAND TO_CHAR(CurrentRTWDate,'YYYYMMDD') != '18000101' \r\n\t-- \t\t\tAND (:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind) <> '')\r\n\t-- \t\t\tAND CurrentRTWDate <> min_return_to_work_date, \r\n\t-- \t\t\t\tTO_CHAR(CurrentRTWDate,'YYYYMMDD'),\r\n\t-- \t\t\t'' ),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','IL'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(v_return_to_work_type)),'A','R') AND TO_CHAR(CurrentRTWDate,'YYYYMMDD') != '18000101' AND (:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind) <> '' OR :UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind) <> ''), \r\n\t-- \t\t\t\tTO_CHAR(CurrentRTWDate,'YYYYMMDD'),\r\n\t-- \t\t\t'' ),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN'), DECODE(\n\t        TRUE,\n\t        CurrentRTWDate IS NULL, '',\n\t        LTRIM(RTRIM(v_return_to_work_type)) IN ('A','R') AND TO_CHAR(CurrentRTWDate, 'YYYYMMDD') != '18000101' AND CurrentRTWDate > min_return_to_work_date, TO_CHAR(CurrentRTWDate, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC'), DECODE(\n\t        TRUE,\n\t        CurrentRTWDate IS NULL, '',\n\t        LTRIM(RTRIM(v_return_to_work_type)) IN ('A','R') AND TO_CHAR(CurrentRTWDate, 'YYYYMMDD') != '18000101' AND CurrentRTWDate > min_return_to_work_date, TO_CHAR(CurrentRTWDate, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS'), DECODE(\n\t        TRUE,\n\t        CurrentRTWDate IS NULL, '',\n\t        LTRIM(RTRIM(v_return_to_work_type)) IN ('A','R') AND TO_CHAR(CurrentRTWDate, 'YYYYMMDD') != '18000101', TO_CHAR(CurrentRTWDate, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_return_to_work_type)) IN ('A','R') AND TO_CHAR(CurrentRTWDate, 'YYYYMMDD') != '18000101' AND (UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind) <> '') AND CurrentRTWDate <> min_return_to_work_date, TO_CHAR(CurrentRTWDate, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','IL'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_return_to_work_type)) IN ('A','R') AND TO_CHAR(CurrentRTWDate, 'YYYYMMDD') != '18000101' AND (UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind) <> '' OR UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind) <> ''), TO_CHAR(CurrentRTWDate, 'YYYYMMDD'),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_CurrentRTWDate,\n\tv_CurrentRTWDate AS o_CurrentRTWDate,\n\tEXP_SOURCE.source_claim_occurrence_status_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KY','IL','NC','MN','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(source_claim_occurrence_status_code))='',\r\n\t-- \t\t\t\t'',\r\n\t-- \t\t\tLTRIM(RTRIM(source_claim_occurrence_status_code))='O',\r\n\t-- \t\t\t\t'O',\r\n\t-- \t\t\t'C' ),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KY','IL','NC','MN','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(source_claim_occurrence_status_code)) = '', '',\n\t        LTRIM(RTRIM(source_claim_occurrence_status_code)) = 'O', 'O',\n\t        'C'\n\t    ),\n\t    NULL\n\t) AS o_source_claim_occurrence_status_code,\n\tEXP_SOURCE.o_claim_ctgry_code AS claim_ctgry_code,\n\tEXP_SOURCE.o_obtained_lgl_representation_date AS obtained_lgl_representation_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code )),'MN','IA','KY','NC','VA','TN'),\r\n\t-- @{pipeline().parameters.TEST_PRODUCTION_INDICATOR},\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KY','NC','VA','TN'), @{pipeline().parameters.TEST_PRODUCTION_INDICATOR},\n\t    NULL\n\t) AS Test_Prod_Ind,\n\tEXP_SOURCE.inj_loc_comment,\n\t-- *INF*: IIF(LTRIM(RTRIM(jurisdiction_state_code))='MN',LTRIM(RTRIM(inj_loc_comment)),'')\r\n\t-- \r\n\t-- \r\n\t-- --IIF(ISNULL(inj_loc_comment)  OR LTRIM(RTRIM(inj_loc_comment))='N/A',v_loss_loc_city||' '||v_loss_loc_state||' '|| loss_loc_zip , LTRIM(RTRIM(inj_loc_comment)))\r\n\t-- \n\tIFF(LTRIM(RTRIM(jurisdiction_state_code)) = 'MN', LTRIM(RTRIM(inj_loc_comment)), '') AS v_inj_loc_comment,\n\tv_inj_loc_comment AS o_inj_loc_comment,\n\tEXP_SOURCE.premises_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MO'),premises_code,\r\n\t-- '' )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MO'), premises_code,\n\t    ''\n\t) AS o_premises_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KY'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(premises_code)),'E','L') AND LTRIM(RTRIM(v_full_name_reformatted_insured)) = LTRIM(RTRIM(v_full_name_emplr)),\r\n\t-- \t\t\t\tLTRIM(RTRIM(v_full_name_reformatted_insured)),\r\n\t-- \t\t\tLTRIM(RTRIM(premises_code)) ='E' AND LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)),\r\n\t-- \t\t\t\tLTRIM(RTRIM(v_full_name_emplr)),\r\n\t-- \t\t\tLTRIM(RTRIM(premises_code)) ='L' AND LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)),\r\n\t-- \t\t\t\tLTRIM(RTRIM(v_full_name_reformatted_insured)),\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\t'',\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NC'),\r\n\t-- \t\tIIF(LTRIM(RTRIM(premises_code)) ='L' AND LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)),\r\n\t-- \t\t\t\tLTRIM(RTRIM(v_full_name_reformatted_insured)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KY'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(premises_code)) IN ('E','L') AND LTRIM(RTRIM(v_full_name_reformatted_insured)) = LTRIM(RTRIM(v_full_name_emplr)), LTRIM(RTRIM(v_full_name_reformatted_insured)),\n\t        LTRIM(RTRIM(premises_code)) = 'E' AND LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)), LTRIM(RTRIM(v_full_name_emplr)),\n\t        LTRIM(RTRIM(premises_code)) = 'L' AND LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)), LTRIM(RTRIM(v_full_name_reformatted_insured)),\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC'), IFF(\n\t        LTRIM(RTRIM(premises_code)) = 'L'\n\t        and LTRIM(RTRIM(v_full_name_reformatted_insured)) != LTRIM(RTRIM(v_full_name_emplr)),\n\t        LTRIM(RTRIM(v_full_name_reformatted_insured)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_AccSite_OrgName,\n\tv_AccSite_OrgName AS o_AccSite_OrgName,\n\tEXP_SOURCE.o_loss_loc_county AS loss_loc_county,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','IN','NC','MN','NE','TN'),\r\n\t-- \t\tloss_loc_county,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(premises_code)) != 'E' AND v_AccSiteLocationNarrative = '',\r\n\t-- \t\t\t\tLTRIM(RTRIM(loss_loc_county)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','IN','NC','MN','NE','TN'), loss_loc_county,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(premises_code)) != 'E' AND v_AccSiteLocationNarrative = '', LTRIM(RTRIM(loss_loc_county)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_loss_loc_county,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IN','IL','NC','MN','TN','NE'), v_loss_loc_county,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IN','IL','NC','MN','TN','NE'), v_loss_loc_county,\n\t    NULL\n\t) AS o_loss_loc_county,\n\tEXP_SOURCE.o_loss_loc_city AS loss_loc_city,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\t'',\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KY','NC'),\r\n\t-- \t\tloss_loc_city,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KY','NC'), loss_loc_city,\n\t    NULL\n\t) AS o_loss_loc_city,\n\tEXP_SOURCE.o_loss_loc_addr AS loss_loc_addr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\t'',\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KY','NC'),\r\n\t-- \t\tloss_loc_addr,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KY','NC'), loss_loc_addr,\n\t    NULL\n\t) AS o_loss_loc_addr,\n\tEXP_SOURCE.o_loss_loc_state AS loss_loc_state,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\t'',\r\n\t-- \tIN(ltrim(rtrim(jurisdiction_state_code)),'KS','IL'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(premises_code)) != 'E',\r\n\t-- \t\t\t\tloss_loc_state,\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NE','MN','KY','NC','IN','TN'),\r\n\t-- \t\tloss_loc_state,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    ltrim(rtrim(jurisdiction_state_code)) IN ('KS','IL'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(premises_code)) != 'E', loss_loc_state,\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE','MN','KY','NC','IN','TN'), loss_loc_state,\n\t    NULL\n\t) AS o_loss_loc_state,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(loss_loc_addr))='',NULL,\r\n\t-- LTRIM(RTRIM(loss_loc_addr)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(loss_loc_addr)) = '', NULL,\n\t    LTRIM(RTRIM(loss_loc_addr))\n\t) AS AccSiteLocNarrative_addr,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(loss_loc_city))='',NULL,\r\n\t-- LTRIM(RTRIM(loss_loc_city)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(loss_loc_city)) = '', NULL,\n\t    LTRIM(RTRIM(loss_loc_city))\n\t) AS AccSiteLocNarrative_city,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(loss_loc_county))='',NULL,\r\n\t-- LTRIM(RTRIM(loss_loc_county)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(loss_loc_county)) = '', NULL,\n\t    LTRIM(RTRIM(loss_loc_county))\n\t) AS AccSiteLocNarrative_county,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(loss_loc_state))='',NULL,\r\n\t-- LTRIM(RTRIM(loss_loc_state)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(loss_loc_state)) = '', NULL,\n\t    LTRIM(RTRIM(loss_loc_state))\n\t) AS AccSiteLocNarrative_state,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(loss_loc_zip))='',NULL,\r\n\t-- LTRIM(RTRIM(loss_loc_zip)) )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(loss_loc_zip)) = '', NULL,\n\t    LTRIM(RTRIM(loss_loc_zip))\n\t) AS AccSiteLocNarrative_zip,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(AccSiteLocNarrative_addr) AND ISNULL(AccSiteLocNarrative_city),NULL,\r\n\t-- NOT ISNULL(AccSiteLocNarrative_addr) AND NOT ISNULL(AccSiteLocNarrative_city), LTRIM(RTRIM(AccSiteLocNarrative_addr)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_city)),\r\n\t-- ISNULL(AccSiteLocNarrative_addr) AND NOT ISNULL(AccSiteLocNarrative_city), LTRIM(RTRIM(AccSiteLocNarrative_city)),\r\n\t-- LTRIM(RTRIM(AccSiteLocNarrative_addr)) )\n\tDECODE(\n\t    TRUE,\n\t    AccSiteLocNarrative_addr IS NULL AND AccSiteLocNarrative_city IS NULL, NULL,\n\t    AccSiteLocNarrative_addr IS NULL AND AccSiteLocNarrative_city IS NOT NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_addr)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_city)),\n\t    AccSiteLocNarrative_addr IS NULL AND AccSiteLocNarrative_city IS NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_city)),\n\t    LTRIM(RTRIM(AccSiteLocNarrative_addr))\n\t) AS AccNarrative_CONCAT_12,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(AccSiteLocNarrative_city) AND ISNULL(AccSiteLocNarrative_county),NULL,\r\n\t-- NOT ISNULL(AccSiteLocNarrative_city) AND NOT ISNULL(AccSiteLocNarrative_county), LTRIM(RTRIM(AccSiteLocNarrative_city)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_county)),\r\n\t-- ISNULL(AccSiteLocNarrative_city) AND NOT ISNULL(AccSiteLocNarrative_county), LTRIM(RTRIM(AccSiteLocNarrative_county)),\r\n\t-- LTRIM(RTRIM(AccSiteLocNarrative_city)) )\n\tDECODE(\n\t    TRUE,\n\t    AccSiteLocNarrative_city IS NULL AND AccSiteLocNarrative_county IS NULL, NULL,\n\t    AccSiteLocNarrative_city IS NULL AND AccSiteLocNarrative_county IS NOT NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_city)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_county)),\n\t    AccSiteLocNarrative_city IS NULL AND AccSiteLocNarrative_county IS NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_county)),\n\t    LTRIM(RTRIM(AccSiteLocNarrative_city))\n\t) AS CONCAT_City_County,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(CONCAT_City_County) AND ISNULL(AccSiteLocNarrative_state),NULL,\r\n\t-- NOT ISNULL(CONCAT_City_County) AND NOT ISNULL(AccSiteLocNarrative_state), LTRIM(RTRIM(CONCAT_City_County)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_state)),\r\n\t-- ISNULL(CONCAT_City_County) AND NOT ISNULL(AccSiteLocNarrative_state), LTRIM(RTRIM(AccSiteLocNarrative_state)),\r\n\t-- LTRIM(RTRIM(CONCAT_City_County)) )\n\tDECODE(\n\t    TRUE,\n\t    CONCAT_City_County IS NULL AND AccSiteLocNarrative_state IS NULL, NULL,\n\t    CONCAT_City_County IS NULL AND AccSiteLocNarrative_state IS NOT NOT NULL, LTRIM(RTRIM(CONCAT_City_County)) || ', ' || LTRIM(RTRIM(AccSiteLocNarrative_state)),\n\t    CONCAT_City_County IS NULL AND AccSiteLocNarrative_state IS NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_state)),\n\t    LTRIM(RTRIM(CONCAT_City_County))\n\t) AS CONCAT_City_County_State,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(CONCAT_City_County_State) AND ISNULL(AccSiteLocNarrative_zip),NULL,\r\n\t-- NOT ISNULL(CONCAT_City_County_State) AND NOT ISNULL(AccSiteLocNarrative_zip), LTRIM(RTRIM(CONCAT_City_County_State)) || ' ' || LTRIM(RTRIM(AccSiteLocNarrative_zip)),\r\n\t-- ISNULL(CONCAT_City_County_State) AND NOT ISNULL(AccSiteLocNarrative_zip), LTRIM(RTRIM(AccSiteLocNarrative_zip)),\r\n\t-- LTRIM(RTRIM(CONCAT_City_County_State)) )\n\tDECODE(\n\t    TRUE,\n\t    CONCAT_City_County_State IS NULL AND AccSiteLocNarrative_zip IS NULL, NULL,\n\t    CONCAT_City_County_State IS NULL AND AccSiteLocNarrative_zip IS NOT NOT NULL, LTRIM(RTRIM(CONCAT_City_County_State)) || ' ' || LTRIM(RTRIM(AccSiteLocNarrative_zip)),\n\t    CONCAT_City_County_State IS NULL AND AccSiteLocNarrative_zip IS NOT NULL, LTRIM(RTRIM(AccSiteLocNarrative_zip)),\n\t    LTRIM(RTRIM(CONCAT_City_County_State))\n\t) AS CONCAT_City_County_State_Zip,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','KS','IN','NE','IL','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(inj_loc_comment))='N/A',\r\n\t-- \t\t\t\tCONCAT_City_County_State_Zip,\r\n\t-- \t\t\tLTRIM(RTRIM(inj_loc_comment)) \r\n\t-- \t\t\t),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KS','IN','NE','IL','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(inj_loc_comment)) = 'N/A', CONCAT_City_County_State_Zip,\n\t        LTRIM(RTRIM(inj_loc_comment))\n\t    ),\n\t    NULL\n\t) AS v_AccSiteLocationNarrative,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN'),\r\n\t-- \t\tIIF(ISNULL(v_AccSite_OrgName) OR v_AccSite_OrgName = '',\r\n\t-- \t\t\tv_AccSiteLocationNarrative,\r\n\t-- \t\t\t''),\r\n\t-- \tv_AccSiteLocationNarrative)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN'), IFF(\n\t        v_AccSite_OrgName IS NULL OR v_AccSite_OrgName = '', v_AccSiteLocationNarrative, ''\n\t    ),\n\t    v_AccSiteLocationNarrative\n\t) AS o_AccSiteLocationNarrative,\n\tEXP_SOURCE.o_claim_rep_email AS Claim_rep_email,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(Claim_rep_email))='N/A','',\r\n\t-- LTRIM(RTRIM(Claim_rep_email)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(Claim_rep_email)) = 'N/A', '',\n\t    LTRIM(RTRIM(Claim_rep_email))\n\t) AS v_Claim_rep_email,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','IN','NE','IL','MN','TN'),\r\n\t-- \t\tLTRIM(RTRIM(v_Claim_rep_email)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','IN','NE','IL','MN','TN'), LTRIM(RTRIM(v_Claim_rep_email)),\n\t    NULL\n\t) AS o_Claim_rep_email,\n\tEXP_SOURCE.o_claim_rep_full_name AS claim_rep_full_name,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(claim_rep_full_name)) = 'N/A','',\r\n\t-- LTRIM(RTRIM(claim_rep_full_name)) )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(claim_rep_full_name)) = 'N/A', '',\n\t    LTRIM(RTRIM(claim_rep_full_name))\n\t) AS v_claim_rep_full_name,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','IN','NE','IL','MN', 'TN'),\r\n\t-- \t\tLTRIM(RTRIM(v_claim_rep_full_name)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','IN','NE','IL','MN','TN'), LTRIM(RTRIM(v_claim_rep_full_name)),\n\t    NULL\n\t) AS o_claim_rep_full_name,\n\tEXP_SOURCE.o_inj_result_death_ind AS inj_result_death_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IL','KY'),\r\n\t-- \t\tLTRIM(RTRIM(inj_result_death_ind)),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IN','NE','NC','VA','TN'),\r\n\t-- \t\tIIF(death_date<>'', \r\n\t-- \t\t\tLTRIM(RTRIM(inj_result_death_ind)),\r\n\t-- \t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IL','KY'), LTRIM(RTRIM(inj_result_death_ind)),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IN','NE','NC','VA','TN'), IFF(\n\t        death_date <> '', LTRIM(RTRIM(inj_result_death_ind)), ''\n\t    ),\n\t    NULL\n\t) AS o_inj_result_death_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(maint_type_code)),'02','AQ','UR'),LTRIM(RTRIM(jurisdiction_state_code)) || LTRIM(RTRIM(emp_id_num)),\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(maint_type_code)) IN ('02','AQ','UR'), LTRIM(RTRIM(jurisdiction_state_code)) || LTRIM(RTRIM(emp_id_num)),\n\t    NULL\n\t) AS v_EmployeeSecurityID,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN'),v_EmployeeSecurityID,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'TN'),\r\n\t-- \t    IIF(v_MaintenanceTypeCode='01', \r\n\t-- \t\t\tLTRIM(RTRIM(jurisdiction_state_code)),\r\n\t-- \t\tNULL),\r\n\t-- NULL )\r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN'), v_EmployeeSecurityID,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('TN'), IFF(\n\t        v_MaintenanceTypeCode = '01', LTRIM(RTRIM(jurisdiction_state_code)), NULL\n\t    ),\n\t    NULL\n\t) AS o_EmployeeSecurityID,\n\tEXP_SOURCE.o_emp_id_type AS emp_id_type,\n\t-- *INF*: LTRIM(RTRIM(emp_id_type))\n\tLTRIM(RTRIM(emp_id_type)) AS v_emp_id_type,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS'),v_emp_id_type,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS'), v_emp_id_type,\n\t    NULL\n\t) AS o_emp_id_type,\n\tEXP_SOURCE.o_emp_id_num AS emp_id_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(emp_id_type))='E', LTRIM(RTRIM(emp_id_num)),\r\n\t-- '' )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(emp_id_type)) = 'E', LTRIM(RTRIM(emp_id_num)),\n\t    ''\n\t) AS v_emp_id_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS','IA','IN','KY','NE','NC','VA','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(v_emp_id_type)) = 'E', \r\n\t-- \t\t\t\tLTRIM(RTRIM(emp_id_num)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS','IA','IN','KY','NE','NC','VA','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_emp_id_type)) = 'E', LTRIM(RTRIM(emp_id_num)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_EmployeeJurisdicationID,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','NE','VA','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(v_emp_id_type)) = 'V', \r\n\t-- \t\t\t\tLTRIM(RTRIM(emp_id_num)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','NE','VA','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_emp_id_type)) = 'V', LTRIM(RTRIM(emp_id_num)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS EmployeeEmploymentVisa,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','KY','NE','VA','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(v_emp_id_type)) = 'G', \r\n\t-- \t\t\t\tLTRIM(RTRIM(emp_id_num)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','KY','NE','VA','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_emp_id_type)) = 'G', LTRIM(RTRIM(emp_id_num)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS EmployeeGreenCard,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','NE','VA','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(v_emp_id_type)) = 'P', \r\n\t-- \t\t\t\tLTRIM(RTRIM(emp_id_num)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','NE','VA','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(v_emp_id_type)) = 'P', LTRIM(RTRIM(emp_id_num)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS EmployeePassportNumber,\n\tEXP_SOURCE.o_emplyr_lost_time_notified_date AS emplyr_lost_time_notified_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS','IL','MN'),emplyr_lost_time_notified_date,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS','IL','MN'), emplyr_lost_time_notified_date,\n\t    NULL\n\t) AS o_emplyr_lost_time_notified_date,\n\tEXP_SOURCE.o_salary_paid_ind AS salary_paid_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'WI','IA','NC','TN'),LTRIM(RTRIM(salary_paid_ind)),\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI','IA','NC','TN'), LTRIM(RTRIM(salary_paid_ind)),\n\t    NULL\n\t) AS o_salary_paid_ind,\n\tEXP_SOURCE.fringe_bnft_discontinued_amt,\n\tEXP_SOURCE.o_med_auth_ind AS med_auth_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(jurisdiction_state_code))='MN','', med_auth_ind )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'MN', '',\n\t    med_auth_ind\n\t) AS v_med_auth_ind,\n\tv_med_auth_ind AS o_med_auth_ind,\n\tEXP_SOURCE.o_education_lvl AS education_lvl,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(jurisdiction_state_code))='MN','',\r\n\t-- LTRIM(RTRIM(education_lvl)) )\r\n\t-- \r\n\t-- --IIF(LTRIM(RTRIM(jurisdiction_state_code))='MN','',IIF(LTRIM(RTRIM(education_lvl))='N/A','  ',LTRIM(RTRIM(education_lvl))))\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'MN', '',\n\t    LTRIM(RTRIM(education_lvl))\n\t) AS v_education_lvl,\n\tv_education_lvl AS o_education_lvl,\n\tEXP_SOURCE.o_auth_to_release_ssn_ind AS auth_to_release_ssn_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(jurisdiction_state_code))='MN','',\r\n\t-- auth_to_release_ssn_ind )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'MN', '',\n\t    auth_to_release_ssn_ind\n\t) AS v_auth_to_release_ssn_ind,\n\tv_auth_to_release_ssn_ind AS o_auth_to_release_ssn_ind,\n\tLKP_TO_GET_EMPLOYER_DETAILS.ph_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(ph_num),'',\r\n\t-- LTRIM(RTRIM(ph_num))='N/A','',\r\n\t-- REPLACECHR(0,LTRIM(RTRIM(ph_num)),'-','') )\n\tDECODE(\n\t    TRUE,\n\t    ph_num IS NULL, '',\n\t    LTRIM(RTRIM(ph_num)) = 'N/A', '',\n\t    REGEXP_REPLACE(LTRIM(RTRIM(ph_num)),'-','','i')\n\t) AS v_ph_num,\n\tLKP_TO_GET_EMPR_CONTACT_DETAILS.ph_extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(ph_extension),'',\r\n\t-- LTRIM(RTRIM(ph_extension))='N/A','',\r\n\t-- LTRIM(RTRIM(ph_extension)) )\n\tDECODE(\n\t    TRUE,\n\t    ph_extension IS NULL, '',\n\t    LTRIM(RTRIM(ph_extension)) = 'N/A', '',\n\t    LTRIM(RTRIM(ph_extension))\n\t) AS v_ph_extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'KS','NC','TN'),\r\n\t-- \t\tLTRIM(RTRIM(v_ph_num)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('KS','NC','TN'), LTRIM(RTRIM(v_ph_num)),\n\t    NULL\n\t) AS o_EmployerContactBusPhone,\n\tLKP_TO_GET_EMPR_CONTACT_DETAILS.claim_party_full_name AS contact_full_name,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'KS','NC','TN'),\r\n\t-- \t\tLTRIM(RTRIM(:UDF.DEFAULT_VALUE_TO_BLANKS(contact_full_name))),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('KS','NC','TN'), LTRIM(RTRIM(UDF_DEFAULT_VALUE_TO_BLANKS(contact_full_name))),\n\t    NULL\n\t) AS o_contact_full_name,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','KS','IN','KY','IL','NC','VA','TN'),v_city_emplr ,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KS','IN','KY','IL','NC','VA','TN'), v_city_emplr,\n\t    NULL\n\t) AS o_EmployerMailingCity,\n\t-- *INF*: IIF(IN(v_EmployerMailingState_by_jurisdiction,'AB','BC','MB','NB','NL','NT','NS','NU','ON','PE','QC','SK','YT'),\r\n\t-- 'CA',\r\n\t-- NULL)\n\tIFF(\n\t    v_EmployerMailingState_by_jurisdiction IN ('AB','BC','MB','NB','NL','NT','NS','NU','ON','PE','QC','SK','YT'),\n\t    'CA',\n\t    NULL\n\t) AS o_EmployerMailingCountry,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','KS','IN','KY','IL','NC','VA','TN'),v_zip_emplr,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KS','IN','KY','IL','NC','VA','TN'), v_zip_emplr,\n\t    NULL\n\t) AS o_EmployerMailingPostal,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','KS','IN','KY','IL','NC','VA','TN'),v_addr_emplr,\r\n\t-- NULL  )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KS','IN','KY','IL','NC','VA','TN'), v_addr_emplr,\n\t    NULL\n\t) AS o_EmployerMailingAddress1,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IA','KS','IN','KY','IL','NC','NE','VA','TN'),v_state_emplr,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IA','KS','IN','KY','IL','NC','NE','VA','TN'), v_state_emplr,\n\t    NULL\n\t) AS v_EmployerMailingState_by_jurisdiction,\n\tv_EmployerMailingState_by_jurisdiction AS o_EmployerMailingState,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),v_zip_insured,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), v_zip_insured,\n\t    NULL\n\t) AS o_InsuredPostalCode,\n\t'I' AS InsuredTypeCode,\n\t'I' AS InsurerTypeCode,\n\tEXP_SOURCE.claim_party_role_code,\n\tEXP_SOURCE.ClaimAdministratorFEIN,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IL','KS','IA','IN','KY','NE','NC','VA','TN'),ClaimAdministratorFEIN,\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IL','KS','IA','IN','KY','NE','NC','VA','TN'), ClaimAdministratorFEIN,\n\t    NULL\n\t) AS o_ClaimAdministratorFEIN,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS','IA','IN','KY','NE','IL','NC','VA','TN'),'WEST BEND MUTUAL INSURANCE CO',\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS','IA','IN','KY','NE','IL','NC','VA','TN'), 'WEST BEND MUTUAL INSURANCE CO',\n\t    NULL\n\t) AS ClaimAdministratorName,\n\tEXP_SOURCE.o_average_wage AS AverageWage,\n\tEXP_SOURCE.work_week_days,\n\tEXP_SOURCE.work_week_type,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(claim_loss_date)) >= '20140101',\r\n\t-- DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(work_week_type)) = 'F' AND LTRIM(RTRIM(work_week_days))='MTWHF','S',\r\n\t-- LTRIM(RTRIM(work_week_type)) = 'F','F',\r\n\t-- LTRIM(RTRIM(work_week_type)) = 'V','V',\r\n\t-- '' ),\r\n\t-- '' )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(claim_loss_date)) >= '20140101', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(work_week_type)) = 'F' AND LTRIM(RTRIM(work_week_days)) = 'MTWHF', 'S',\n\t        LTRIM(RTRIM(work_week_type)) = 'F', 'F',\n\t        LTRIM(RTRIM(work_week_type)) = 'V', 'V',\n\t        ''\n\t    ),\n\t    ''\n\t) AS v_work_week_type,\n\t-- *INF*: NULL\r\n\t-- \r\n\t-- --Removed Decode for MN, as we do not have to send it. For other states, it is always a NULL value\n\tNULL AS o_work_week_type,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'S') != 0, 'S',\r\n\t-- 'N' )\r\n\t-- \r\n\t-- --IIF(INSTR(inputValue, valueToSearch)=0, false, true) \n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'S') != 0, 'S',\n\t    'N'\n\t) AS Sunday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'M') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'M') != 0, 'S',\n\t    'N'\n\t) AS Monday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'T') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'T') != 0, 'S',\n\t    'N'\n\t) AS Tuesday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'W') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'W') != 0, 'S',\n\t    'N'\n\t) AS Wednesday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'H') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'H') != 0, 'S',\n\t    'N'\n\t) AS Thursday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'F') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'F') != 0, 'S',\n\t    'N'\n\t) AS Friday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- INSTR(LTRIM(RTRIM(work_week_days)),'A') != 0, 'S',\r\n\t-- 'N' )\n\tDECODE(\n\t    TRUE,\n\t    REGEXP_INSTR(LTRIM(RTRIM(work_week_days)), 'A') != 0, 'S',\n\t    'N'\n\t) AS Saturday,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(claim_loss_date)) >= '20140101',\r\n\t-- DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(work_week_type)) = 'F',\r\n\t-- Sunday || Monday || Tuesday || Wednesday || Thursday || Friday || Saturday ,\r\n\t-- '' ),\r\n\t-- '' )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --LTRIM(RTRIM(v_work_week_type)) = 'F','SSSSSSS',\r\n\t-- --IN(LTRIM(RTRIM(v_work_week_type)),'S','V','NNNNNNN' ),\r\n\t-- --'' )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(claim_loss_date)) >= '20140101', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(work_week_type)) = 'F', Sunday || Monday || Tuesday || Wednesday || Thursday || Friday || Saturday,\n\t        ''\n\t    ),\n\t    ''\n\t) AS v_WorkDaysScheduledCode,\n\t-- *INF*: NULL\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --Removed Decode for MN. States will pass NULL\n\tNULL AS o_WorkDaysScheduledCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','MO','KY'),\r\n\t-- \t\tDECODE(LTRIM(RTRIM(premises_code)),\r\n\t-- \t\t'E','E',\r\n\t-- \t\t'L','L',\r\n\t-- \t\t'O','X',\r\n\t-- \t\t'' ),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IL','NC'),\r\n\t-- \t\tDECODE(LTRIM(RTRIM(premises_code)),\r\n\t-- \t\t'E','E',\r\n\t-- \t\t'L','L',\r\n\t-- \t\t'X' ),\r\n\t--       IN(LTRIM(RTRIM(jurisdiction_state_code)),'TN'),\r\n\t-- \t\tDECODE(LTRIM(RTRIM(premises_code)),\r\n\t-- \t\t'E','E',\r\n\t-- \t\t'L','L',\r\n\t--              'R','R',\r\n\t-- \t\t'X' ),\r\n\t--        IN(LTRIM(RTRIM(jurisdiction_state_code)),'IN'),\r\n\t-- \t\tDECODE(LTRIM(RTRIM(premises_code)),\r\n\t-- \t\t'E','E',\r\n\t-- \t\t'L','L',\r\n\t-- \t\t'O','X',\r\n\t--              'R','R',\r\n\t-- \t\t'' ),\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','MO','KY'), DECODE(\n\t        LTRIM(RTRIM(premises_code)),\n\t        'E', 'E',\n\t        'L', 'L',\n\t        'O', 'X',\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IL','NC'), DECODE(\n\t        LTRIM(RTRIM(premises_code)),\n\t        'E', 'E',\n\t        'L', 'L',\n\t        'X'\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('TN'), DECODE(\n\t        LTRIM(RTRIM(premises_code)),\n\t        'E', 'E',\n\t        'L', 'L',\n\t        'R', 'R',\n\t        'X'\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN'), DECODE(\n\t        LTRIM(RTRIM(premises_code)),\n\t        'E', 'E',\n\t        'L', 'L',\n\t        'O', 'X',\n\t        'R', 'R',\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_AccidentPremisesCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS','IA','MO','TN','KY','IL','NC','IN'),\r\n\t-- \t\tv_AccidentPremisesCode,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS','IA','MO','TN','KY','IL','NC','IN'), v_AccidentPremisesCode,\n\t    NULL\n\t) AS o_AccidentPremisesCode,\n\t-- *INF*: NULL\r\n\t-- \r\n\t-- --Removed Decode. States value will be NULL\n\tNULL AS o_InsolventInsurerFEIN,\n\tEXP_SOURCE.o_sic_code AS sic_code,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tLTRIM(RTRIM(sic_code)) = '',\r\n\t-- \t\t'',\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),\r\n\t-- \t\tSUBSTR(LTRIM(RTRIM(sic_code)),1,4),\r\n\t-- \tCONCAT(SUBSTR(LTRIM(RTRIM(sic_code)),1,4),'SC')\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(sic_code)) = '', '',\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), SUBSTR(LTRIM(RTRIM(sic_code)), 1, 4),\n\t    CONCAT(SUBSTR(LTRIM(RTRIM(sic_code)), 1, 4), 'SC')\n\t) AS v_sic_code,\n\tEXP_SOURCE.o_NaicsCode AS NaicsCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'WI'),\r\n\t-- \t\tLTRIM(RTRIM(v_sic_code)),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','KS','IN','KY','NE','IL','IA','NC','VA','TN'),\r\n\t-- \t\tNaicsCode,\r\n\t-- \tLTRIM(RTRIM(jurisdiction_state_code))='MO',\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(NaicsCode)) != '',\r\n\t-- \t\t\t\tLTRIM(RTRIM(NaicsCode)),\r\n\t-- \t\t\tLTRIM(RTRIM(v_sic_code)) != '',\r\n\t-- \t\t\t\tLTRIM(RTRIM(v_sic_code)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI'), LTRIM(RTRIM(v_sic_code)),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','KS','IN','KY','NE','IL','IA','NC','VA','TN'), NaicsCode,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'MO', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(NaicsCode)) != '', LTRIM(RTRIM(NaicsCode)),\n\t        LTRIM(RTRIM(v_sic_code)) != '', LTRIM(RTRIM(v_sic_code)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_IndustryCode,\n\tEXP_SOURCE.emp_security_id,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(jurisdiction_state_code))='MN',LTRIM(RTRIM(emp_security_id)),\r\n\t--     LTRIM(RTRIM(jurisdiction_state_code))='TN' AND\r\n\t--     v_MaintenanceTypeCode='01', LTRIM(RTRIM(emp_security_id)),\r\n\t-- NULL )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'MN', LTRIM(RTRIM(emp_security_id)),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'TN' AND v_MaintenanceTypeCode = '01', LTRIM(RTRIM(emp_security_id)),\n\t    NULL\n\t) AS o_emp_security_id,\n\tEXP_SOURCE.act_status_code,\n\tLKP_WRK_HISTORY.earliest_restrictions_ind AS min_restrictions_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IN','NE','IL','MN','TN','NC'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IN','NE','IL','MN','TN','NC'), UDF_DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind),\n\t    NULL\n\t) AS o_min_restrictions_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IL'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(v_maint_type_code,'00','02') AND PreviousMaintenanceTypeCode = '04',\r\n\t-- \t\t\t\tsend_to_state_time,\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IL'), DECODE(\n\t        TRUE,\n\t        v_maint_type_code IN ('00','02') AND PreviousMaintenanceTypeCode = '04', send_to_state_time,\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_FullDenialRescissionDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(maint_type_code)) = '04' AND IN(LTRIM(RTRIM(act_status_code)),'DM','DN'),claim_loss_date,\r\n\t--  '' )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(maint_type_code)) = '04' AND LTRIM(RTRIM(act_status_code)) IN ('DM','DN'), claim_loss_date,\n\t    ''\n\t) AS v_FullDenialEffectiveDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IN','KY','NE','IL','VA','TN'),\r\n\t-- \t\tv_FullDenialEffectiveDate,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IN','KY','NE','IL','VA','TN'), v_FullDenialEffectiveDate,\n\t    NULL\n\t) AS o_FullDenialEffectiveDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'NC','VA'),\r\n\t-- \t\t'530959791',\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('NC','VA'), '530959791',\n\t    NULL\n\t) AS o_ClaimAdminAlternatePostalCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NC'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC'), UDF_DEFAULT_VALUE_TO_BLANKS(min_restrictions_ind),\n\t    NULL\n\t) AS o_PhysicalRestrictionsInd,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IA') ,'',\r\n\t-- NULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    NULL\n\t) AS o_SelfInsurerOrgTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IA') ,'',\r\n\t-- NULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA'), '',\n\t    NULL\n\t) AS o_SelfInsurerAuthTypeCode,\n\tEXP_SOURCE.o_FullDenialReasonCode AS FullDenialReasonCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IA','IN','KY','NE','IL','VA','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(maint_type_code)) = '04' AND IN(LTRIM(RTRIM(act_status_code)),'DM','DN'),\r\n\t-- \t\t\t\tLTRIM(RTRIM(FullDenialReasonCode)),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IA','IN','KY','NE','IL','VA','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(maint_type_code)) = '04' AND LTRIM(RTRIM(act_status_code)) IN ('DM','DN'), LTRIM(RTRIM(FullDenialReasonCode)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_FullDenialReasonCode,\n\tEXP_SOURCE.o_IAIABCLossTypeCode AS IAIABCLossTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','KY','IL','IA','MN','TN'),\r\n\t-- \t\tLTRIM(RTRIM(IAIABCLossTypeCode)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','KY','IL','IA','MN','TN'), LTRIM(RTRIM(IAIABCLossTypeCode)),\n\t    NULL\n\t) AS o_IAIABCLossTypeCode,\n\tEXP_SOURCE.FROILateReasonCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KY','IN','VA'),\r\n\t-- \t\tLTRIM(RTRIM(FROILateReasonCode)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KY','IN','VA'), LTRIM(RTRIM(FROILateReasonCode)),\n\t    NULL\n\t) AS o_FROILateReasonCode,\n\tWorkNcciMitchell_Get_MaintCode.MaintenanceTypeCode AS lkp_MaintenanceTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(lkp_MaintenanceTypeCode),'',\r\n\t-- lkp_MaintenanceTypeCode )\n\tDECODE(\n\t    TRUE,\n\t    lkp_MaintenanceTypeCode IS NULL, '',\n\t    lkp_MaintenanceTypeCode\n\t) AS v_MaintenanceTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'KS','NC'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(maint_type_code)) = 'CO', \r\n\t-- \t\t\t\tv_MaintenanceTypeCode,\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('KS','NC'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(maint_type_code)) = 'CO', v_MaintenanceTypeCode,\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_MaintenanceTypeCode,\n\tWorkNcciMitchell_Get_MaintCode.MaitenanceTypeCodeDate AS lkp_MaitenanceTypeCodeDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(lkp_MaitenanceTypeCodeDate),'',\r\n\t-- lkp_MaitenanceTypeCodeDate )\n\tDECODE(\n\t    TRUE,\n\t    lkp_MaitenanceTypeCodeDate IS NULL, '',\n\t    lkp_MaitenanceTypeCodeDate\n\t) AS v_MaitenanceTypeCodeDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'KS','NC','TN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tLTRIM(RTRIM(maint_type_code)) = 'CO', \r\n\t-- \t\t\t\tv_MaitenanceTypeCodeDate,\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('KS','NC','TN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(maint_type_code)) = 'CO', v_MaitenanceTypeCodeDate,\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_MaitenanceTypeCodeDate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IN','KY','NE','IL','MN'),\r\n\t-- \t\tDECODE(TRUE,\r\n\t-- \t\t\tIN(LTRIM(RTRIM(maint_type_code)), '00','AU','04'),\r\n\t-- \t\t\t\tv_tax_fed_id_insured,\r\n\t-- \t\t\t''),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','NC','VA','TN'),\r\n\t-- \t\tv_tax_fed_id_insured,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IN','KY','NE','IL','MN'), DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(maint_type_code)) IN ('00','AU','04'), v_tax_fed_id_insured,\n\t        ''\n\t    ),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','NC','VA','TN'), v_tax_fed_id_insured,\n\t    NULL\n\t) AS o_InsuredFEIN,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(maint_type_code)),'00','04','AU','UR')  AND NOT ISNULL(emp_tax_ssn_id) AND ltrim(rtrim(emp_tax_ssn_id))  != 'N/A','S',\r\n\t-- IN(LTRIM(RTRIM(maint_type_code)),'02','CO')  AND NOT ISNULL(EmployeeJurisdicationID)  AND ISNULL(v_EmployeeSecurityID),'A',\r\n\t-- '')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --Must = 'S' when MTC codes IN('00', '04', AU', 'UR') and DN0042 exists\r\n\t-- --Must = 'A' when MTC codes IN('02', 'CO') and DN0154 exists and DN0206 is blank\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(maint_type_code)) IN ('00','04','AU','UR') AND emp_tax_ssn_id IS NULL AND ltrim(rtrim(emp_tax_ssn_id)) != 'NOT N/A', 'S',\n\t    LTRIM(RTRIM(maint_type_code)) IN ('02','CO') AND EmployeeJurisdicationID IS NULL AND v_EmployeeSecurityID IS NOT NULL, 'A',\n\t    ''\n\t) AS v_EmployeeIDTypeQualifier,\n\t-- *INF*: v_EmployeeIDTypeQualifier\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --Must = 'S' when MTC codes IN('00', '04', AU', 'UR') and DN0042 exists\r\n\t-- --Must = 'A' when MTC codes IN('02', 'CO') and DN0154 exists and DN0206 is blank\n\tv_EmployeeIDTypeQualifier AS o_EmployeeIDTypeQualifier,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(jurisdiction_state_code)),'WI'),'',\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('WI'), '',\n\t    NULL\n\t) AS Filler,\n\tLKP_CLT_ref_relation_stage.cirf_ref_id AS in_cirf_ref_id,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(in_cirf_ref_id),v_tax_fed_id_emplr,\r\n\t-- LTRIM(RTRIM(in_cirf_ref_id)) = 'N/A',v_tax_fed_id_emplr,\r\n\t-- IS_SPACES(LTRIM(RTRIM(in_cirf_ref_id)))  OR LENGTH(LTRIM(RTRIM(in_cirf_ref_id)))=0,v_tax_fed_id_emplr,\r\n\t-- LTRIM(RTRIM(in_cirf_ref_id))\r\n\t-- )\n\tDECODE(\n\t    TRUE,\n\t    in_cirf_ref_id IS NULL, v_tax_fed_id_emplr,\n\t    LTRIM(RTRIM(in_cirf_ref_id)) = 'N/A', v_tax_fed_id_emplr,\n\t    LENGTH(LTRIM(RTRIM(in_cirf_ref_id)))>0 AND TRIM(LTRIM(RTRIM(in_cirf_ref_id)))='' OR LENGTH(LTRIM(RTRIM(in_cirf_ref_id))) = 0, v_tax_fed_id_emplr,\n\t    LTRIM(RTRIM(in_cirf_ref_id))\n\t) AS v_cirf_ref_id,\n\t-- *INF*: NULL\r\n\t-- \r\n\t-- -- This used to be sent for Iowa in FROI release 2.0 format.\r\n\t-- -- DECODE(TRUE,\r\n\t-- -- IN(LTRIM(RTRIM(jurisdiction_state_code)),'IA'),LTRIM(RTRIM(v_cirf_ref_id)),\r\n\t-- -- NULL )\n\tNULL AS o_cirf_ref_id,\n\tEXP_SOURCE.o_num_of_exemptions AS num_of_exemptions,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(jurisdiction_state_code)) = 'IA',\r\n\t-- DECODE(TRUE,\r\n\t-- IN(LTRIM(RTRIM(maint_type_code)),'02','04','CO','UI'),\r\n\t-- LTRIM(RTRIM(num_of_exemptions)),\r\n\t-- '' ),\r\n\t-- NULL )\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) = 'IA', DECODE(\n\t        TRUE,\n\t        LTRIM(RTRIM(maint_type_code)) IN ('02','04','CO','UI'), LTRIM(RTRIM(num_of_exemptions)),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_EmpNumEntitledExempt,\n\tEXP_SOURCE.claim_rep_phone,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IA','KS','IN','NE','IL','MN','TN'),\r\n\t-- \t\tLTRIM(RTRIM(claim_rep_phone)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IA','KS','IN','NE','IL','MN','TN'), LTRIM(RTRIM(claim_rep_phone)),\n\t    NULL\n\t) AS v_claim_rep_phone,\n\tEXP_SOURCE.FROIClaimType,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'MN','IN','KY','NE','IL','IA','NC', 'TN') AND FROIClaimType<>'N/A',\r\n\t-- \t\tFROIClaimType,\r\n\t-- \t'')\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('MN','IN','KY','NE','IL','IA','NC','TN') AND FROIClaimType <> 'N/A', FROIClaimType,\n\t    ''\n\t) AS v_FROIClaimType,\n\tv_FROIClaimType AS O_FROIClaimType,\n\tLKP_Previous_MaintenanceTypeCode.MaintenanceTypeCode AS PreviousMaintenanceTypeCode,\n\tEXP_SOURCE.FROICancelReasonCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'KS','NE','IL','IA','IN','TN') AND v_maint_type_code='01', \r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(FROICancelReasonCode),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('KS','NE','IL','IA','IN','TN') AND v_maint_type_code = '01', UDF_DEFAULT_VALUE_TO_BLANKS(FROICancelReasonCode),\n\t    NULL\n\t) AS v_FROICancelReasonCode,\n\tv_FROICancelReasonCode AS o_FROICancelReasonCode,\n\tEXP_SOURCE.FROIFullDenialReasonNarrative,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','KY','NE','IA','VA','TN'),\r\n\t-- \t\tIIF(LTRIM(RTRIM(maint_type_code)) = '04',\r\n\t-- \t\t\t:UDF.DEFAULT_VALUE_TO_BLANKS(FROIFullDenialReasonNarrative),\r\n\t-- \t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','KY','NE','IA','VA','TN'), IFF(\n\t        LTRIM(RTRIM(maint_type_code)) = '04',\n\t        UDF_DEFAULT_VALUE_TO_BLANKS(FROIFullDenialReasonNarrative),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_FROIFullDenialReasonNarrative,\n\tv_FROIFullDenialReasonNarrative AS o_FROIFullDenialReasonNarrative,\n\tLKP_WRK_HISTORY.earliest_return_to_work_with_same_emplyr_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','NE','NC','MN','TN'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(earliest_return_to_work_with_same_emplyr_ind),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','NE','NC','MN','TN'), UDF_DEFAULT_VALUE_TO_BLANKS(earliest_return_to_work_with_same_emplyr_ind),\n\t    NULL\n\t) AS o_R00228_R00405_InitialReturnToWorkWithSameEmployerIndicator,\n\tLKP_WRK_HISTORY.latest_return_to_work_type,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IN','IL'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NC','NE','MN'),\r\n\t-- \t\tIIF(v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\r\n\t-- \t\t\t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IN','IL'), UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC','NE','MN'), IFF(\n\t        v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\n\t        UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_type),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_latest_return_to_work_type,\n\tLKP_WRK_HISTORY.latest_restrictions_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'KS','IN','IL'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NE','MN','NC'),\r\n\t-- \t\tIIF(v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\r\n\t-- \t\t\t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('KS','IN','IL'), UDF_DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NE','MN','NC'), IFF(\n\t        v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\n\t        UDF_DEFAULT_VALUE_TO_BLANKS(latest_restrictions_ind),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_latest_restrictions_ind,\n\tLKP_WRK_HISTORY.latest_return_to_work_with_same_emplyr_ind,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind),\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'NC','NE','MN'),\r\n\t-- \t\tIIF(v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\r\n\t-- \t\t\t\t:UDF.DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind),\r\n\t-- \t\t\t''),\r\n\t-- \tNULL\r\n\t-- \t)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN'), UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind),\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('NC','NE','MN'), IFF(\n\t        v_CurrentRTWDate <> '' AND max_emp_last_day_worked > min_emp_last_day_worked,\n\t        UDF_DEFAULT_VALUE_TO_BLANKS(latest_return_to_work_with_same_emplyr_ind),\n\t        ''\n\t    ),\n\t    NULL\n\t) AS o_latest_return_to_work_with_same_emplyr_ind,\n\tEXP_SOURCE.BodyPartLocationCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','NE','IA','MN','TN'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(BodyPartLocationCode),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','NE','IA','MN','TN'), UDF_DEFAULT_VALUE_TO_BLANKS(BodyPartLocationCode),\n\t    NULL\n\t) AS o_BodyPartLocationCode,\n\tEXP_SOURCE.FingersToesLocationCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IN','NE','IA','MN','TN'),\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(FingersToesLocationCode),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IN','NE','IA','MN','TN'), UDF_DEFAULT_VALUE_TO_BLANKS(FingersToesLocationCode),\n\t    NULL\n\t) AS o_FingersToesLocationCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'MN','IL','NE','IN','KS','IA','TN'),\r\n\t-- \t\t'31',\r\n\t-- \tIN(v_jurisdiction_state_code,'KY','NC','VA'),\r\n\t-- \t\t'30',\r\n\t-- \tIN(v_jurisdiction_state_code,'WI','MO'),\r\n\t-- \t\t'10',\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('MN','IL','NE','IN','KS','IA','TN'), '31',\n\t    v_jurisdiction_state_code IN ('KY','NC','VA'), '30',\n\t    v_jurisdiction_state_code IN ('WI','MO'), '10',\n\t    NULL\n\t) AS v_VerIDReleaseNumber,\n\tv_VerIDReleaseNumber AS o_VerIDReleaseNumber,\n\tEXP_SOURCE.FROICancelReasonNarrative,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'NE','IA','IN','TN') AND v_maint_type_code='01',\r\n\t-- \t\t:UDF.DEFAULT_VALUE_TO_BLANKS(FROICancelReasonNarrative),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('NE','IA','IN','TN') AND v_maint_type_code = '01', UDF_DEFAULT_VALUE_TO_BLANKS(FROICancelReasonNarrative),\n\t    NULL\n\t) AS v_FROICancelReasonNarrative,\n\tv_FROICancelReasonNarrative AS o_FROICancelReasonNarrative,\n\tEXP_SOURCE.o_FirstDisabilityDateAfterWaitingPeriod AS FirstDisabilityDateAfterWaitingPeriod,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(jurisdiction_state_code)),'IL','MN'),\r\n\t-- \t\tFirstDisabilityDateAfterWaitingPeriod,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(jurisdiction_state_code)) IN ('IL','MN'), FirstDisabilityDateAfterWaitingPeriod,\n\t    NULL\n\t) AS v_FirstDisabilityDateAfterWaitingPeriod,\n\tv_FirstDisabilityDateAfterWaitingPeriod AS o_FirstDisabilityDateAfterWaitingPeriod,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'IN','VA','TN'),\r\n\t-- \t\t'US',\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('IN','VA','TN'), 'US',\n\t    NULL\n\t) AS o_ClaimAdminMailingCountry,\n\tEXP_SOURCE.InjurySeverityType AS in_InjurySeverityType,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'VA'),\r\n\t-- \t\tDECODE(UPPER(:UDF.DEFAULT_VALUE_FOR_STRINGS(in_InjurySeverityType)),\r\n\t-- \t\t\t'MAJOR', 'J',\r\n\t-- \t\t\t'MINOR', 'M',\r\n\t-- \t\t\t''),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('VA'), DECODE(\n\t        UPPER(UDF_DEFAULT_VALUE_FOR_STRINGS(in_InjurySeverityType)),\n\t        'MAJOR', 'J',\n\t        'MINOR', 'M',\n\t        ''\n\t    ),\n\t    NULL\n\t) AS v_InjurySeverityTypeCode,\n\tv_InjurySeverityTypeCode AS o_InjurySeverityTypeCode,\n\tEXP_SOURCE.CurrentDateDisabilityBegan,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(CurrentDateDisabilityBegan) OR TO_CHAR(CurrentDateDisabilityBegan,'YYYYMMDD')  = '21001231','',\r\n\t-- TO_CHAR(CurrentDateDisabilityBegan,'YYYYMMDD') )\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    CurrentDateDisabilityBegan IS NULL OR TO_CHAR(CurrentDateDisabilityBegan, 'YYYYMMDD') = '21001231', '',\n\t    TO_CHAR(CurrentDateDisabilityBegan, 'YYYYMMDD')\n\t) AS V_CurrentDateDisabilityBegan,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'MN'),V_CurrentDateDisabilityBegan,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('MN'), V_CurrentDateDisabilityBegan,\n\t    NULL\n\t) AS O_CurrentDateDisabilityBegan,\n\tEXP_SOURCE.DateEmployerHadKnowledgeofCurrentDateofDisability,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(DateEmployerHadKnowledgeofCurrentDateofDisability) OR TO_CHAR(DateEmployerHadKnowledgeofCurrentDateofDisability,'YYYYMMDD')  = '21001231','',\r\n\t-- TO_CHAR(DateEmployerHadKnowledgeofCurrentDateofDisability,'YYYYMMDD') )\n\tDECODE(\n\t    TRUE,\n\t    DateEmployerHadKnowledgeofCurrentDateofDisability IS NULL OR TO_CHAR(DateEmployerHadKnowledgeofCurrentDateofDisability, 'YYYYMMDD') = '21001231', '',\n\t    TO_CHAR(DateEmployerHadKnowledgeofCurrentDateofDisability, 'YYYYMMDD')\n\t) AS V_DateEmployerHadKnowledgeofCurrentDateofDisability,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'MN'),V_DateEmployerHadKnowledgeofCurrentDateofDisability,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('MN'), V_DateEmployerHadKnowledgeofCurrentDateofDisability,\n\t    NULL\n\t) AS O_DateEmployerHadKnowledgeofCurrentDateofDisability,\n\tEXP_SOURCE.DateWBMIHadKnowledgeofCurrentDateofDisability,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(DateWBMIHadKnowledgeofCurrentDateofDisability) OR TO_CHAR(DateWBMIHadKnowledgeofCurrentDateofDisability,'YYYYMMDD')  = '21001231','',\r\n\t-- TO_CHAR(DateWBMIHadKnowledgeofCurrentDateofDisability,'YYYYMMDD') )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    DateWBMIHadKnowledgeofCurrentDateofDisability IS NULL OR TO_CHAR(DateWBMIHadKnowledgeofCurrentDateofDisability, 'YYYYMMDD') = '21001231', '',\n\t    TO_CHAR(DateWBMIHadKnowledgeofCurrentDateofDisability, 'YYYYMMDD')\n\t) AS V_DateWBMIHadKnowledgeofCurrentDateofDisability,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'MN'),V_DateWBMIHadKnowledgeofCurrentDateofDisability,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('MN'), V_DateWBMIHadKnowledgeofCurrentDateofDisability,\n\t    NULL\n\t) AS O_DateWBMIHadKnowledgeofCurrentDateofDisability,\n\tEXP_SOURCE.DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(DateClaimAdminHadKnowledgeClaimMetReportingRequirements) OR TO_CHAR(DateClaimAdminHadKnowledgeClaimMetReportingRequirements,'YYYYMMDD')  = '21001231','',\r\n\t-- TO_CHAR(DateClaimAdminHadKnowledgeClaimMetReportingRequirements,'YYYYMMDD') )\n\tDECODE(\n\t    TRUE,\n\t    DateClaimAdminHadKnowledgeClaimMetReportingRequirements IS NULL OR TO_CHAR(DateClaimAdminHadKnowledgeClaimMetReportingRequirements, 'YYYYMMDD') = '21001231', '',\n\t    TO_CHAR(DateClaimAdminHadKnowledgeClaimMetReportingRequirements, 'YYYYMMDD')\n\t) AS V_DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(v_jurisdiction_state_code,'IN'),V_DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    v_jurisdiction_state_code IN ('IN'), V_DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\n\t    NULL\n\t) AS O_DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\n\tLKP_CurrentDateLastDayWorked.max_emp_last_day_worked,\n\t-- *INF*: IIF((NOT ISNULL(CurrentDateDisabilityBegan) OR TO_CHAR(CurrentDateDisabilityBegan,'YYYYMMDD')  != '21001231') AND v_jurisdiction_state_code = 'MN' AND max_emp_last_day_worked > min_emp_last_day_worked,\r\n\t-- max_emp_last_day_worked,NULL)\n\tIFF(\n\t    (CurrentDateDisabilityBegan IS NULL\n\t    or TO_CHAR(CurrentDateDisabilityBegan, 'YYYYMMDD') != '21001NOT 231')\n\t    and v_jurisdiction_state_code = 'MN'\n\t    and max_emp_last_day_worked > min_emp_last_day_worked,\n\t    max_emp_last_day_worked,\n\t    NULL\n\t) AS v_currentdatelastdayworked,\n\t-- *INF*: TO_CHAR(v_currentdatelastdayworked,'YYYYMMDD')\n\tTO_CHAR(v_currentdatelastdayworked, 'YYYYMMDD') AS o_currentdatelastdayworked,\n\t-- *INF*: IIF(v_emp_id_type='I' AND v_jurisdiction_state_code = 'IA' , emp_id_num , Null)\n\tIFF(v_emp_id_type = 'I' AND v_jurisdiction_state_code = 'IA', emp_id_num, Null) AS EmployeeIndividualTaxpayerIdentificationNumber\n\tFROM EXP_SOURCE\n\tLEFT JOIN LKP_CLASS_CODE_CCD\n\tON LKP_CLASS_CODE_CCD.claim_party_occurrence_ak_id = EXP_SOURCE.claim_party_occurrence_ak_id\n\tLEFT JOIN LKP_CLT_ref_relation_stage\n\tON LKP_CLT_ref_relation_stage.client_id = LKP_Claim_Occurrence.claim_party_key AND LKP_CLT_ref_relation_stage.cirf_eff_dt <= EXP_SOURCE.CurrentDate AND LKP_CLT_ref_relation_stage.cirf_exp_dt > EXP_SOURCE.CurrentDate\n\tLEFT JOIN LKP_CurrentDateLastDayWorked\n\tON LKP_CurrentDateLastDayWorked.wc_claimant_det_ak_id = EXP_SOURCE.wc_claimant_det_ak_id\n\tLEFT JOIN LKP_Get_Policy_Details\n\tON LKP_Get_Policy_Details.pol_key_ak_id = EXP_SOURCE.pol_key_ak_id\n\tLEFT JOIN LKP_Previous_MaintenanceTypeCode\n\tON LKP_Previous_MaintenanceTypeCode.WCClaimantDetailAKId = EXP_SOURCE.wc_claimant_det_ak_id\n\tLEFT JOIN LKP_RTW_TYPE_AND_DATE\n\tON LKP_RTW_TYPE_AND_DATE.wc_claimant_det_ak_id = EXP_SOURCE.wc_claimant_det_ak_id\n\tLEFT JOIN LKP_TO_GET_EMPLOYER_DETAILS\n\tON LKP_TO_GET_EMPLOYER_DETAILS.claim_party_id = EXP_SOURCE.claim_occurrence_ak_id\n\tLEFT JOIN LKP_TO_GET_EMPR_CONTACT_DETAILS\n\tON LKP_TO_GET_EMPR_CONTACT_DETAILS.claim_party_id = EXP_SOURCE.claim_occurrence_ak_id\n\tLEFT JOIN LKP_TO_GET_INSURED_DETAILS\n\tON LKP_TO_GET_INSURED_DETAILS.claim_party_id = EXP_SOURCE.claim_occurrence_ak_id\n\tLEFT JOIN LKP_WRK_HISTORY\n\tON LKP_WRK_HISTORY.wc_claimant_det_ak_id = EXP_SOURCE.wc_claimant_det_ak_id\n\tLEFT JOIN LKP_arch_claim_object_stage\n\tON LKP_arch_claim_object_stage.cob_client_id = EXP_SOURCE.claim_party_key AND LKP_arch_claim_object_stage.cob_claim_nbr = EXP_SOURCE.claim_occurrence_key\n\tLEFT JOIN WorkNcciMitchell_Get_MaintCode\n\tON WorkNcciMitchell_Get_MaintCode.WCClaimantDetailAKId = EXP_SOURCE.wc_claimant_det_ak_id AND WorkNcciMitchell_Get_MaintCode.CreatedDate = WorkNcciMitchell_Get_Max_Date.CreatedDate\n),\nEXPTRANS_TGT_PASS AS (\n\tSELECT\n\tCreateddate AS CreatedDate,\n\tModifiedate AS ModifiedDate,\n\tAudit_ID AS AuditID,\n\twc_claimant_det_ak_id AS WCClaimantDetailAKId,\n\tTransactionSetID,\n\to_maint_type_code AS MaintenanceTypeCode,\n\tsend_to_state_time AS MaitenanceTypeCodeDate,\n\to_jurisdiction_state_code AS JurisdictionStateCode,\n\to_state_claim_num AS JurisdictionClaimNumber,\n\tInsurerFEIN,\n\to_InsurerName AS InsurerName,\n\tIsTPA,\n\to_ClaimAdminAddress1 AS ClaimAdminAddress1,\n\to_ClaimAdministratorCity AS ClaimAdminCity,\n\to_ClaimAdministratorStateCode AS ClaimAdminStateCode,\n\to_ClaimAdministratorPostalCode AS ClaimAdminPostalCode,\n\to_wc_claimant_num AS ClaimAdminClaimNumber,\n\to_tax_fed_id_emplr AS EmployerFEIN,\n\to_full_name_insured AS InsuredName,\n\to_full_name_emplr AS EmployerName,\n\to_addr_emplr AS EmployerPhysicalAddress1,\n\to_city_emplr AS EmployerPhysicalCity,\n\to_state_emplr AS EmployerPhysicalStateCode,\n\to_zip_emplr AS EmployerPhysicalPostalCode,\n\to_IndustryCode AS IndustryCode,\n\to_emp_dept_num AS InsuredLocationIdentifier,\n\to_pol_key AS PolicyNumberIdentifier,\n\to_pol_eff_date AS PolicyEffectiveDate,\n\to_pol_exp_date AS PolicyExpirationDate,\n\tclaim_loss_date AS DateOfInjury,\n\to_claim_loss_time AS TimeOfInjury,\n\to_loss_loc_zip AS PostalCodeOfInjuryState,\n\tnature_inj_code AS NatureOfInjuryCode,\n\tbody_part_code AS PartOfBodyInjuryCode,\n\tcause_inj_code AS CauseOfInjuryCode,\n\to_claim_loss_descript AS AccidentDescriptionCause,\n\to_inital_treatment_code AS InitialTreatmentCode,\n\to_emplyr_notified_date AS DateReportedToEmployer,\n\to_reported_to_carrier_date AS DateReportedToClaimAdmin,\n\to_emp_tax_ssn_id AS SocialSecurityNumber,\n\temp_claim_party_last_name AS EmployeeLastName,\n\temp_claim_party_first_name AS EmployeeFirstName,\n\to_emp_claim_party_mid_name AS EmployeeMiddleInitial,\n\to_emp_claim_party_addr AS EmployeeAddress1,\n\temp_claim_party_city AS EmployeeCity,\n\temp_claim_party_state AS EmployeeState,\n\to_emp_claim_party_zip AS EmployeePostalCode,\n\to_emp_ph_num AS EmployeePhone,\n\to_emp_claim_party_birthdate AS EmployeeDateOfBirth,\n\to_emp_claim_party_gndr AS GenderCode,\n\to_marital_status AS MaritalStatusCode,\n\to_num_of_dependents AS NumberOfDependents,\n\to_disability_date AS InitialDateDisabilityBegan,\n\to_death_date AS EmployeeDateOfDeath,\n\to_emplymnt_status_code AS EmploymentStatusCode,\n\to_class_code AS ClassCode,\n\to_occuptn_descript AS OccupationDescription,\n\to_hired_date AS DateOfHire,\n\to_wage_period_code AS WagePeriodCode,\n\to_emp_day_week AS NumberOfDaysWorked,\n\to_emp_last_day_worked AS DateLastDayWorked,\n\to_full_pay_inj_day_ind AS FullWagesPaidInd,\n\to_min_return_to_work_date AS MinDateOfReturnToWork,\n\to_CurrentRTWDate AS CurrentReturnToWorkDate,\n\to_source_claim_occurrence_status_code AS ClaimStatus,\n\to_FROILateReasonCode AS LateReasonCode,\n\tTest_Prod_Ind AS TestProductionInd,\n\to_loss_loc_county AS AccSiteCountyParish,\n\to_AccSiteLocationNarrative AS AccSiteLocationNarrative,\n\to_AccSite_OrgName AS AccSiteOrganizationName,\n\to_loss_loc_city AS AccSiteCity,\n\to_loss_loc_addr AS AccSiteStreet,\n\to_loss_loc_state AS AccSiteState,\n\to_ClaimAdminMailingCountry AS ClaimAdminMailingCountry,\n\tv_claim_rep_phone AS ClaimAdminClaimRepPhone,\n\to_Claim_rep_email AS ClaimAdminClaimRepEmail,\n\to_claim_rep_full_name AS ClaimAdminClaimRepName,\n\to_inj_result_death_ind AS DeathResultofInjuryCode,\n\tEmployeeEmploymentVisa,\n\tEmployeeGreenCard,\n\to_EmployeeJurisdicationID AS EmployeeJurisdicationID,\n\tEmployeePassportNumber,\n\to_EmployerContactBusPhone AS EmployerContactBusPhone,\n\to_contact_full_name AS EmployerContactName,\n\to_EmployerPhysicalCountry AS EmployerPhysicalCountry,\n\to_EmployerMailingCity AS EmployerMailingCity,\n\to_EmployerMailingCountry AS EmployerMailingCountry,\n\to_EmployerMailingPostal AS EmployerMailingPostal,\n\to_EmployerMailingAddress1 AS EmployerMailingAddress1,\n\to_EmployerMailingState AS EmployerMailingState,\n\to_InsuredPostalCode AS InsuredPostalCode,\n\tInsuredTypeCode,\n\tInsurerTypeCode,\n\to_ClaimAdministratorFEIN AS ClaimAdministratorFEIN,\n\tClaimAdministratorName,\n\to_R00189_MinReturnToWorkTypeCode AS R00189_MinReturnToWorkTypeCode,\n\to_FullDenialRescissionDate AS FullDenialRescissionDate,\n\to_FROIFullDenialReasonNarrative AS FullDenialReasonNarrative,\n\to_FullDenialEffectiveDate AS FullDenialEffectiveDate,\n\to_ClaimAdminAlternatePostalCode AS ClaimAdminAlternatePostalCode,\n\to_work_week_type AS WorkWeekTypeCode,\n\to_WorkDaysScheduledCode AS WorkDaysScheduledCode,\n\to_emp_security_id AS EmployeeSecurityID,\n\to_EmpNumEntitledExempt AS EmpNumberEntitledExempt,\n\to_PhysicalRestrictionsInd AS PhysicalRestrictionsInd,\n\to_SelfInsurerOrgTypeCode AS SelfInsurerOrgTypeCode,\n\to_AccidentPremisesCode AS AccidentPremisesCode,\n\to_SelfInsurerAuthTypeCode AS SelfInsurerAuthTypeCode,\n\to_emp_claim_party_name_sfx AS EmployeeLastNameSuffix,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tLTRIM(RTRIM(JurisdictionStateCode))='IA' AND LTRIM(RTRIM(emp_id_type))='I',\r\n\t-- \t\t'T',\r\n\t--       LTRIM(RTRIM(SocialSecurityNumber)) != '',\r\n\t-- \t\t'S',\r\n\t-- \tLTRIM(RTRIM(EmployeeJurisdicationID)) != '',\r\n\t-- \t\t'A',\r\n\t-- \tLTRIM(RTRIM(EmployeeEmploymentVisa)) != '',\r\n\t-- \t\t'E',\r\n\t-- \tLTRIM(RTRIM(EmployeeGreenCard)) != '',\r\n\t-- \t\t'G',\r\n\t-- \tLTRIM(RTRIM(EmployeePassportNumber)) != '',\r\n\t-- \t\t'P',\r\n\t-- \t'')\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(JurisdictionStateCode)) = 'IA' AND LTRIM(RTRIM(emp_id_type)) = 'I', 'T',\n\t    LTRIM(RTRIM(SocialSecurityNumber)) != '', 'S',\n\t    LTRIM(RTRIM(EmployeeJurisdicationID)) != '', 'A',\n\t    LTRIM(RTRIM(EmployeeEmploymentVisa)) != '', 'E',\n\t    LTRIM(RTRIM(EmployeeGreenCard)) != '', 'G',\n\t    LTRIM(RTRIM(EmployeePassportNumber)) != '', 'P',\n\t    ''\n\t) AS v_EmployeeIDTypeQualifier,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tIN(LTRIM(RTRIM(JurisdictionStateCode)),'MN','IA','KS','IN','KY','NE','NC','VA','TN'),\r\n\t-- \t\tLTRIM(RTRIM(v_EmployeeIDTypeQualifier)),\r\n\t-- \tNULL)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(JurisdictionStateCode)) IN ('MN','IA','KS','IN','KY','NE','NC','VA','TN'), LTRIM(RTRIM(v_EmployeeIDTypeQualifier)),\n\t    NULL\n\t) AS EmployeeIDTypeQualifier,\n\to_salary_paid_ind AS EmployerPaidSalaryComp,\n\to_emplyr_lost_time_notified_date AS DateEmployerHadKnowledgeOfDisability,\n\to_avg_wkly_wage AS AverageWage,\n\to_IAIABCLossTypeCode AS TypeOfLossCode,\n\to_InsolventInsurerFEIN AS InsolventInsurerFEIN,\n\to_MaintenanceTypeCode AS MaintenanceTypeCorrectionCode,\n\to_MaitenanceTypeCodeDate AS MaintenanceTypeCorrectionCodeDate,\n\to_InsuredFEIN AS InsuredFEIN,\n\to_FullDenialReasonCode AS FullDenialReasonCode,\n\to_cirf_ref_id AS EmployerUINumber,\n\tFiller,\n\tO_FROIClaimType AS FROIClaimType,\n\to_FROICancelReasonCode AS FROICancelReasonCode,\n\to_latest_return_to_work_type AS CurrentReturnToWorkTypeCode,\n\to_latest_restrictions_ind AS CurrentPhysicalRestrictionsInd,\n\to_R00403_InitialReturnToWorkTypeCode AS R00403_InitialReturnToWorkTypeCode,\n\to_min_restrictions_ind AS InitialPhysicalRestrictionsIndicator,\n\to_R00228_R00405_InitialReturnToWorkWithSameEmployerIndicator AS R00228_R00405_InitialReturnToWorkWithSameEmployerIndicator,\n\to_latest_return_to_work_with_same_emplyr_ind AS CurrentReturnToWorkWithSameEmployerIndicator,\n\to_BodyPartLocationCode AS PartOfBodyInjuredLocationCode,\n\to_FingersToesLocationCode AS PartOfBodyInjuredFingersToes,\n\to_VerIDReleaseNumber AS VerIDReleaseNumber,\n\to_FROICancelReasonNarrative AS FROICancelReasonNarrative,\n\to_FirstDisabilityDateAfterWaitingPeriod AS FirstDisabilityDateAfterWaitingPeriod,\n\to_InjurySeverityTypeCode AS InjurySeverityTypeCode,\n\tO_CurrentDateDisabilityBegan,\n\tO_DateEmployerHadKnowledgeofCurrentDateofDisability,\n\tO_DateWBMIHadKnowledgeofCurrentDateofDisability,\n\tO_DateClaimAdminHadKnowledgeClaimMetReportingRequirements,\n\to_currentdatelastdayworked,\n\tEmployeeIndividualTaxpayerIdentificationNumber,\n\temp_id_type\n\tFROM EXP_STATE_SPECIFIC\n),\nWorkNcciMitchell AS (\n\tINSERT INTO WorkNcciMitchell\n\t(CreatedDate, ModifiedDate, AuditID, WCClaimantDetailAKId, TransactionSetID, MaintenanceTypeCode, MaitenanceTypeCodeDate, JurisdictionStateCode, JurisdictionClaimNumber, InsurerFEIN, InsurerName, IsTPA, ClaimAdminAddress1, ClaimAdminCity, ClaimAdminStateCode, ClaimAdminPostalCode, ClaimAdminClaimNumber, EmployerFEIN, InsuredName, EmployerName, EmployerPhysicalAddress1, EmployerPhysicalAddress2, EmployerPhysicalCity, EmployerPhysicalStateCode, EmployerPhysicalPostalCode, IndustryCode, InsuredLocationIdentifier, PolicyNumberIdentifier, PolicyEffectiveDate, PolicyExpirationDate, DateOfInjury, TimeOfInjury, PostalCodeOfInjuryState, NatureOfInjuryCode, PartOfBodyInjuryCode, CauseOfInjuryCode, AccidentDescriptionCause, InitialTreatmentCode, DateReportedToEmployer, DateReportedToClaimAdmin, SocialSecurityNumber, EmployeeLastName, EmployeeFirstName, EmployeeMiddleInitial, EmployeeAddress1, EmployeeAddress2, EmployeeCity, EmployeeState, EmployeePostalCode, EmployeePhone, EmployeeDateOfBirth, GenderCode, MaritalStatusCode, NumberOfDependents, InitialDateDisabilityBegan, EmployeeDateOfDeath, EmploymentStatusCode, ClassCode, OccupationDescription, DateOfHire, WagePeriodCode, NumberOfDaysWorked, DateLastDayWorked, FullWagesPaidInd, DateOfReturnToWork, CurrentReturnToWorkDate, ClaimStatus, ClaimType, LateReasonCode, TestProductionInd, AccSiteCountyParish, AccSiteLocationNarrative, AccSiteOrganizationName, AccSiteCity, AccSiteStreet, AccSiteState, ClaimAdminMailingCountry, ClaimAdminClaimRepPhone, ClaimAdminClaimRepEmail, ClaimAdminClaimRepName, CurrentDateDisBegan, CurrentDateLastDayWorked, DeathResultofInjuryCode, EmployeeEmploymentVisa, EmployeeGreenCard, EmployeeJurisdicationID, EmployeePassportNumber, EmployerContactBusPhone, EmployerContactName, EmployerPhysicalCountry, EmployerMailingCity, EmployerMailingCountry, EmployerMailingPostal, EmployerMailingAddress1, EmployerMailingState, InsuredPostalCode, InsuredTypeCode, InsurerTypeCode, ClaimAdministratorFEIN, ClaimAdministratorName, ReturnToWorkTypeCode, FullDenialRescissionDate, FullDenialReasonNarrative, FullDenialEffectiveDate, ClaimAdminAlternatePostalCode, WorkWeekTypeCode, WorkDaysScheduledCode, EmployeeSecurityID, EmpNumberEntitledExempt, PhysicalRestrictionsInd, SelfInsurerOrgTypeCode, AccidentPremisesCode, SelfInsurerAuthTypeCode, EmployeeLastNameSuffix, EmployeeIDTypeQualifier, EmployerPaidSalaryComp, DateEmployerHadKnowledgeOfDisability, AverageWage, TypeOfLossCode, InsolventInsurerFEIN, MaintenanceTypeCorrectionCode, MaintenanceTypeCorrectionCodeDate, InitialDateOfLostTime, InsuredFEIN, EmployerUINumber, FullDenialReasonCode, CancelReasonCode, CurrentReturnToWorkTypeCode, CurrentPhysicalRestrictionsInd, InitialReturnToWorkTypeCode, InitialPhysicalRestrictionsIndicator, InitialReturnToWorkWithSameEmployerIndicator, CurrentReturnToWorkWithSameEmployerIndicator, PartOfBodyInjuredLocationCode, PartOfBodyInjuredFingersToes, VerIDReleaseNumber, PartOfBodyInjuredLine, FROICancelReasonNarrative, InjurySeverityTypeCode, CurrentDateEmpKnowledgeofCurrentDateDisability, CurrentDateClaimAdminKnowledgeofCurrentDateDisability, DateClaimAdminHadKnowledgeClaimMetReportingRequirements, EmployeeIndividualTaxpayerIdentificationNumber)\n\tSELECT \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tAUDITID, \n\tWCCLAIMANTDETAILAKID, \n\tTRANSACTIONSETID, \n\tMAINTENANCETYPECODE, \n\tMAITENANCETYPECODEDATE, \n\tJURISDICTIONSTATECODE, \n\tJURISDICTIONCLAIMNUMBER, \n\tINSURERFEIN, \n\tINSURERNAME, \n\tISTPA, \n\tCLAIMADMINADDRESS1, \n\tCLAIMADMINCITY, \n\tCLAIMADMINSTATECODE, \n\tCLAIMADMINPOSTALCODE, \n\tCLAIMADMINCLAIMNUMBER, \n\tEMPLOYERFEIN, \n\tINSUREDNAME, \n\tEMPLOYERNAME, \n\tEMPLOYERPHYSICALADDRESS1, \n\tFiller AS EMPLOYERPHYSICALADDRESS2, \n\tEMPLOYERPHYSICALCITY, \n\tEMPLOYERPHYSICALSTATECODE, \n\tEMPLOYERPHYSICALPOSTALCODE, \n\tINDUSTRYCODE, \n\tINSUREDLOCATIONIDENTIFIER, \n\tPOLICYNUMBERIDENTIFIER, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYEXPIRATIONDATE, \n\tDATEOFINJURY, \n\tTIMEOFINJURY, \n\tPOSTALCODEOFINJURYSTATE, \n\tNATUREOFINJURYCODE, \n\tPARTOFBODYINJURYCODE, \n\tCAUSEOFINJURYCODE, \n\tACCIDENTDESCRIPTIONCAUSE, \n\tINITIALTREATMENTCODE, \n\tDATEREPORTEDTOEMPLOYER, \n\tDATEREPORTEDTOCLAIMADMIN, \n\tSOCIALSECURITYNUMBER, \n\tEMPLOYEELASTNAME, \n\tEMPLOYEEFIRSTNAME, \n\tEMPLOYEEMIDDLEINITIAL, \n\tEMPLOYEEADDRESS1, \n\tFiller AS EMPLOYEEADDRESS2, \n\tEMPLOYEECITY, \n\tEMPLOYEESTATE, \n\tEMPLOYEEPOSTALCODE, \n\tEMPLOYEEPHONE, \n\tEMPLOYEEDATEOFBIRTH, \n\tGENDERCODE, \n\tMARITALSTATUSCODE, \n\tNUMBEROFDEPENDENTS, \n\tINITIALDATEDISABILITYBEGAN, \n\tEMPLOYEEDATEOFDEATH, \n\tEMPLOYMENTSTATUSCODE, \n\tCLASSCODE, \n\tOCCUPATIONDESCRIPTION, \n\tDATEOFHIRE, \n\tWAGEPERIODCODE, \n\tNUMBEROFDAYSWORKED, \n\tDATELASTDAYWORKED, \n\tFULLWAGESPAIDIND, \n\tMinDateOfReturnToWork AS DATEOFRETURNTOWORK, \n\tCURRENTRETURNTOWORKDATE, \n\tCLAIMSTATUS, \n\tFROIClaimType AS CLAIMTYPE, \n\tLATEREASONCODE, \n\tTESTPRODUCTIONIND, \n\tACCSITECOUNTYPARISH, \n\tACCSITELOCATIONNARRATIVE, \n\tACCSITEORGANIZATIONNAME, \n\tACCSITECITY, \n\tACCSITESTREET, \n\tACCSITESTATE, \n\tCLAIMADMINMAILINGCOUNTRY, \n\tCLAIMADMINCLAIMREPPHONE, \n\tCLAIMADMINCLAIMREPEMAIL, \n\tCLAIMADMINCLAIMREPNAME, \n\tO_CurrentDateDisabilityBegan AS CURRENTDATEDISBEGAN, \n\to_currentdatelastdayworked AS CURRENTDATELASTDAYWORKED, \n\tDEATHRESULTOFINJURYCODE, \n\tEMPLOYEEEMPLOYMENTVISA, \n\tEMPLOYEEGREENCARD, \n\tEMPLOYEEJURISDICATIONID, \n\tEMPLOYEEPASSPORTNUMBER, \n\tEMPLOYERCONTACTBUSPHONE, \n\tEMPLOYERCONTACTNAME, \n\tEMPLOYERPHYSICALCOUNTRY, \n\tEMPLOYERMAILINGCITY, \n\tEMPLOYERMAILINGCOUNTRY, \n\tEMPLOYERMAILINGPOSTAL, \n\tEMPLOYERMAILINGADDRESS1, \n\tEMPLOYERMAILINGSTATE, \n\tINSUREDPOSTALCODE, \n\tINSUREDTYPECODE, \n\tINSURERTYPECODE, \n\tCLAIMADMINISTRATORFEIN, \n\tCLAIMADMINISTRATORNAME, \n\tR00189_MinReturnToWorkTypeCode AS RETURNTOWORKTYPECODE, \n\tFULLDENIALRESCISSIONDATE, \n\tFULLDENIALREASONNARRATIVE, \n\tFULLDENIALEFFECTIVEDATE, \n\tCLAIMADMINALTERNATEPOSTALCODE, \n\tWORKWEEKTYPECODE, \n\tWORKDAYSSCHEDULEDCODE, \n\tEMPLOYEESECURITYID, \n\tEMPNUMBERENTITLEDEXEMPT, \n\tPHYSICALRESTRICTIONSIND, \n\tSELFINSURERORGTYPECODE, \n\tACCIDENTPREMISESCODE, \n\tSELFINSURERAUTHTYPECODE, \n\tEMPLOYEELASTNAMESUFFIX, \n\tEMPLOYEEIDTYPEQUALIFIER, \n\tEMPLOYERPAIDSALARYCOMP, \n\tDATEEMPLOYERHADKNOWLEDGEOFDISABILITY, \n\tAVERAGEWAGE, \n\tTYPEOFLOSSCODE, \n\tINSOLVENTINSURERFEIN, \n\tMAINTENANCETYPECORRECTIONCODE, \n\tMAINTENANCETYPECORRECTIONCODEDATE, \n\tFirstDisabilityDateAfterWaitingPeriod AS INITIALDATEOFLOSTTIME, \n\tINSUREDFEIN, \n\tEMPLOYERUINUMBER, \n\tFULLDENIALREASONCODE, \n\tFROICancelReasonCode AS CANCELREASONCODE, \n\tCURRENTRETURNTOWORKTYPECODE, \n\tCURRENTPHYSICALRESTRICTIONSIND, \n\tR00403_InitialReturnToWorkTypeCode AS INITIALRETURNTOWORKTYPECODE, \n\tINITIALPHYSICALRESTRICTIONSINDICATOR, \n\tR00228_R00405_InitialReturnToWorkWithSameEmployerIndicator AS INITIALRETURNTOWORKWITHSAMEEMPLOYERINDICATOR, \n\tCURRENTRETURNTOWORKWITHSAMEEMPLOYERINDICATOR, \n\tPARTOFBODYINJUREDLOCATIONCODE, \n\tPARTOFBODYINJUREDFINGERSTOES, \n\tVERIDRELEASENUMBER, \n\tPartOfBodyInjuryCode AS PARTOFBODYINJUREDLINE, \n\tFROICANCELREASONNARRATIVE, \n\tINJURYSEVERITYTYPECODE, \n\tO_DateEmployerHadKnowledgeofCurrentDateofDisability AS CURRENTDATEEMPKNOWLEDGEOFCURRENTDATEDISABILITY, \n\tO_DateWBMIHadKnowledgeofCurrentDateofDisability AS CURRENTDATECLAIMADMINKNOWLEDGEOFCURRENTDATEDISABILITY, \n\tO_DateClaimAdminHadKnowledgeClaimMetReportingRequirements AS DATECLAIMADMINHADKNOWLEDGECLAIMMETREPORTINGREQUIREMENTS, \n\tEMPLOYEEINDIVIDUALTAXPAYERIDENTIFICATIONNUMBER\n\tFROM EXPTRANS_TGT_PASS\n),\nSQ_claim_party AS (\n\tselect\r\n\t   b.claim_party_full_name\r\n\t   ,b.ph_num\r\n\t   ,b.ph_extension\r\n\t   ,b.ph_type\r\n\t   ,a.source_sys_id\r\n\t   ,a.wc_claimant_det_ak_id\r\n\tfrom vw_workers_comp_claimant_detail a with (nolock)\r\n\tINNER JOIN claim_party_occurrence clmt with (nolock) \r\n\t   ON a.claim_party_occurrence_ak_id = clmt.claim_party_occurrence_ak_id \r\n\t   and clmt.crrnt_snpsht_flag = 1 and a.crrnt_snpsht_flag = 1\r\n\tINNER JOIN claim_party_occurrence witn with (nolock) \r\n\t   ON clmt.claim_occurrence_ak_id = witn.claim_occurrence_ak_id \r\n\t   and witn.crrnt_snpsht_flag = 1 and witn.claim_party_role_code IN ('WITN')\r\n\tINNER JOIN vw_claim_party1 b with (nolock) \r\n\t   ON witn.claim_party_ak_id = b.claim_party_ak_id and b.crrnt_snpsht_flag = 1\r\n\tleft join @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkNcciMitchell dfm\r\n\t   on a.wc_claimant_num=dfm.ClaimAdminClaimNumber \r\n\t   and a.crrnt_snpsht_flag=1\r\n\t   and CONVERT(CHAR(10),a.send_to_state_time,112)=dfm.MaitenanceTypeCodeDate\r\n\tWHERE a.crrnt_snpsht_flag = 1 \r\n\tand a.jurisdiction_state_code  IN (@{pipeline().parameters.STATE_CODE})\r\n\tand a.send_to_state_ind = 'Y'\r\n\tand a.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tand dfm.ClaimAdminClaimNumber is null\r\n\tand a.source_sys_id <> 'PMS'\r\n\tand 1=2\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXPTRANS AS (\n\tSELECT\n\twc_claimant_det_ak_id,\n\tclaim_party_full_name,\n\t-- *INF*: LTRIM(RTRIM(claim_party_full_name)) \n\tLTRIM(RTRIM(claim_party_full_name)) AS v_claim_party_full_name,\n\tv_claim_party_full_name AS o_claim_party_full_name,\n\tsource_sys_id,\n\tph_type,\n\tph_num,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(ph_num),'',\r\n\t-- LTRIM(RTRIM(ph_num))='N/A','',\r\n\t-- ph_num )\n\tDECODE(\n\t    TRUE,\n\t    ph_num IS NULL, '',\n\t    LTRIM(RTRIM(ph_num)) = 'N/A', '',\n\t    ph_num\n\t) AS v_ph_num,\n\tph_extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(ph_extension),'',\r\n\t-- LTRIM(RTRIM(ph_extension))='N/A','',\r\n\t-- LTRIM(RTRIM(ph_extension)) )\n\tDECODE(\n\t    TRUE,\n\t    ph_extension IS NULL, '',\n\t    LTRIM(RTRIM(ph_extension)) = 'N/A', '',\n\t    LTRIM(RTRIM(ph_extension))\n\t) AS v_ph_extension,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_ph_num='','',\r\n\t-- LTRIM(RTRIM(source_sys_id))='EXCEED' AND IN(LTRIM(RTRIM(ph_type)),'BS','IW'),DECODE(TRUE,\r\n\t-- LENGTH(v_ph_num) + LENGTH(v_ph_extension) <= 15, v_ph_num || v_ph_extension,\r\n\t-- v_ph_num ),\r\n\t-- '' )\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --LTRIM(RTRIM(source_sys_id))='EXCEED' AND IN(LTRIM(RTRIM(ph_type)),'BS','IW'),v_ph_num||v_ph_extension,\r\n\t-- --'' )\n\tDECODE(\n\t    TRUE,\n\t    v_ph_num = '', '',\n\t    LTRIM(RTRIM(source_sys_id)) = 'EXCEED' AND LTRIM(RTRIM(ph_type)) IN ('BS','IW'), DECODE(\n\t        TRUE,\n\t        LENGTH(v_ph_num) + LENGTH(v_ph_extension) <= 15, v_ph_num || v_ph_extension,\n\t        v_ph_num\n\t    ),\n\t    ''\n\t) AS v_BusinessPhone,\n\tv_BusinessPhone AS o_BusinessPhone\n\tFROM SQ_claim_party\n),\nLKP_WorkNcciMitchell AS (\n\tSELECT\n\tWorkNcciMitchellID,\n\tWCClaimantDetailAKId,\n\tin_wc_claimant_det_ak_id\n\tFROM (\n\t\tselect \r\n\t\ta.WorkNcciMitchellID as WorkNcciMItchellID\r\n\t\t,a.WCClaimantDetailAKId as WCClaimantDetailAKId\r\n\t\tfrom WorkNcciMitchell a\r\n\t\twhere a.AuditID=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY WCClaimantDetailAKId ORDER BY WorkNcciMitchellID) = 1\n),\nFILTRANS AS (\n\tSELECT\n\tLKP_WorkNcciMitchell.WorkNcciMitchellID, \n\tLKP_WorkNcciMitchell.WCClaimantDetailAKId, \n\tEXPTRANS.wc_claimant_det_ak_id, \n\tEXPTRANS.o_claim_party_full_name AS claim_party_full_name, \n\tEXPTRANS.o_BusinessPhone AS BusinessPhone\n\tFROM EXPTRANS\n\tLEFT JOIN LKP_WorkNcciMitchell\n\tON LKP_WorkNcciMitchell.WCClaimantDetailAKId = EXPTRANS.wc_claimant_det_ak_id\n\tWHERE NOT ISNULL(WorkNcciMitchellID)\n),\nEXPTRANS1 AS (\n\tSELECT\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\tWCClaimantDetailAKId,\n\tWorkNcciMitchellID,\n\twc_claimant_det_ak_id,\n\tclaim_party_full_name,\n\tBusinessPhone\n\tFROM FILTRANS\n),\nEXPTRANS_TGT_PASSTHROUGH AS (\n\tSELECT\n\tCreatedDate,\n\tModifiedDate,\n\tAuditID,\n\tWCClaimantDetailAKId,\n\tWorkNcciMitchellID,\n\tclaim_party_full_name,\n\tBusinessPhone\n\tFROM EXPTRANS1\n),\nWorkNcciMitchellWitness AS (\n\tINSERT INTO WorkNcciMitchellWitness\n\t(CreatedDate, ModifiedDate, AuditID, WCClaimantDetailAKId, WorkNcciMitchellID, WitnessFullName, WitnessBusinessPhone1)\n\tSELECT \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tAUDITID, \n\tWCCLAIMANTDETAILAKID, \n\tWORKNCCIMITCHELLID, \n\tclaim_party_full_name AS WITNESSFULLNAME, \n\tBusinessPhone AS WITNESSBUSINESSPHONE1\n\tFROM EXPTRANS_TGT_PASSTHROUGH\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "STATE_CODE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_STAGE_CONNECTION": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TEST_PRODUCTION_INDICATOR": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}