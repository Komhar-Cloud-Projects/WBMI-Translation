{
    "name": "s_m_CLM_DM_LOAD_Claim_Loss_Transaction_Fact_Dummy_Transactions",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Loss_Transaction_Fact_Dummy_Tran_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_calendar_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nLKP_InsuranceReferenceDim AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tStrategicProfitCenterCode,\n\tInsuranceSegmentCode,\n\tPolicyOfferingCode,\n\tProductCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRatingPlanCode\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceReferenceDimId,\n\t\t\tStrategicProfitCenterCode,\n\t\t\tInsuranceSegmentCode,\n\t\t\tPolicyOfferingCode,\n\t\t\tProductCode,\n\t\t\tInsuranceReferenceLineOfBusinessCode,\n\t\t\tRatingPlanCode\n\t\tFROM InsuranceReferenceDim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StrategicProfitCenterCode,InsuranceSegmentCode,PolicyOfferingCode,ProductCode,InsuranceReferenceLineOfBusinessCode,RatingPlanCode ORDER BY InsuranceReferenceDimId DESC) = 1\n),\nLKP_strategic_business_division_dim AS (\n\tSELECT\n\tstrtgc_bus_dvsn_dim_id,\n\tstrtgc_bus_dvsn_code\n\tFROM (\n\t\tSELECT strategic_business_division_dim.strtgc_bus_dvsn_dim_id as strtgc_bus_dvsn_dim_id, strategic_business_division_dim.strtgc_bus_dvsn_code as strtgc_bus_dvsn_code FROM strategic_business_division_dim\r\n\t\tWHERE\r\n\t\tpol_sym_1 = 'N/A'\r\n\t\t\r\n\t\t--- We are filtering the records as we need to tie to DuckCreek Claims.\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY strtgc_bus_dvsn_code ORDER BY strtgc_bus_dvsn_dim_id DESC) = 1\n),\nSQ_claimant_coverage_dim AS (\n\tSELECT CCDim.claimant_cov_dim_id, CCDim.edw_claimant_cov_det_ak_id\r\n\tFROM\r\n\t@{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_coverage_dim CCDim\r\n\tWHERE CCDim.claimant_cov_dim_id NOT IN  (SELECT claimant_cov_dim_id FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact)\r\n\tAND CCDim.crrnt_snpsht_flag = 1 AND CCDim.claimant_cov_dim_id <> -1 AND CCDim.audit_id >0\n),\nEXP_get_values AS (\n\tSELECT\n\tclaimant_cov_dim_id,\n\tedw_claimant_cov_det_ak_id,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date,\n\tv_trans_date AS trans_date\n\tFROM SQ_claimant_coverage_dim\n),\nLKP_claim_subrogation_dim AS (\n\tSELECT\n\tclaim_subrogation_dim_id,\n\treferred_to_subrogation_date,\n\tpay_start_date,\n\tclosure_date,\n\tedw_claimant_cov_det_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_subrogation_dim_id,\n\t\t\treferred_to_subrogation_date,\n\t\t\tpay_start_date,\n\t\t\tclosure_date,\n\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_subrogation_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_subrogation_dim_id) = 1\n),\nmplt_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nEXP_Cov_Dim_Ids AS (\n\tSELECT\n\tEXP_get_values.claimant_cov_dim_id,\n\tmplt_coverage_dim_id.cov_dim_id,\n\tLKP_claim_subrogation_dim.claim_subrogation_dim_id,\n\tLKP_claim_subrogation_dim.referred_to_subrogation_date,\n\tLKP_claim_subrogation_dim.pay_start_date,\n\tLKP_claim_subrogation_dim.closure_date,\n\tEXP_get_values.edw_claimant_cov_det_ak_id,\n\tEXP_get_values.trans_date\n\tFROM EXP_get_values\n\t -- Manually join with mplt_coverage_dim_id\n\tLEFT JOIN LKP_claim_subrogation_dim\n\tON LKP_claim_subrogation_dim.edw_claimant_cov_det_ak_id = EXP_get_values.edw_claimant_cov_det_ak_id AND LKP_claim_subrogation_dim.eff_from_date <= EXP_get_values.trans_date AND LKP_claim_subrogation_dim.eff_to_date >= EXP_get_values.trans_date\n),\nmplt_Claimant_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nEXP_Claimany_Dim_Ids AS (\n\tSELECT\n\tEXP_Cov_Dim_Ids.cov_dim_id,\n\tEXP_Cov_Dim_Ids.claim_subrogation_dim_id,\n\tEXP_Cov_Dim_Ids.referred_to_subrogation_date,\n\tEXP_Cov_Dim_Ids.pay_start_date,\n\tEXP_Cov_Dim_Ids.closure_date,\n\tEXP_Cov_Dim_Ids.trans_date,\n\tEXP_Cov_Dim_Ids.edw_claimant_cov_det_ak_id,\n\tEXP_Cov_Dim_Ids.claimant_cov_dim_id,\n\tmplt_Claimant_dim_id.claimant_dim_id\n\tFROM EXP_Cov_Dim_Ids\n\t -- Manually join with mplt_Claimant_dim_id\n),\nLKP_InsuranceReferenceDimId AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tStrategicProfitCenterCode,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT CCD.claimant_cov_det_ak_id AS claimant_cov_det_ak_id,\r\n\t\tIRD.InsuranceReferenceDimId AS InsuranceReferenceDimId,\r\n\t\tIRD.StrategicProfitCenterCode as StrategicProfitCenterCode\r\n\t\tFROM (\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton CCD.StatisticalCoverageAKID=SC.StatisticalCoverageAKId\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton SC.PolicyCoverageAKId=PC.PolicyCoverageAKID\r\n\t\twhere SC.SourceSystemId='PMS' and CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton CCD.RatingCoverageAKID=RC.RatingCoverageAKId and RC.CurrentSnapshotFlag=1\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RC.PolicyCoverageAKId=PC.PolicyCoverageAKID and PC.CurrentSnapshotFlag=1\r\n\t\twhere CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tnull RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\twhere CCD.crrnt_snpsht_flag =1 and CCD.StatisticalCoverageAKID=-1 and CCD.RatingCoverageAKID=-1\r\n\t\t ) CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO\r\n\t\ton CCD.Claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id\r\n\t\tand CPO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\ton CPO.Claim_Occurrence_ak_id = CO.claim_occurrence_ak_id\r\n\t\tand CO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy P\r\n\t\ton CO.pol_key_ak_id = P.pol_ak_id\r\n\t\tand P.crrnt_snpsht_flag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyOffering PO\r\n\t\ton P.PolicyOfferingAKId = PO.PolicyOfferingAKID\r\n\t\tand PO.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment ISe\r\n\t\ton P.InsuranceSegmentAKID = ISe.InsuranceSegmentAKID\r\n\t\tand ISe.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter SPC\r\n\t\ton P.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId\r\n\t\tand SPC.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.EnterpriseGroup EG\r\n\t\ton SPC.EnterPriseGroupId = EG.EnterpriseGroupId\r\n\t\tand EG.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity IRE\r\n\t\ton SPC.InsuranceReferenceLegalEntityId = IRE.InsuranceReferenceLegalEntityId\r\n\t\tand IRE.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.Product Pr\r\n\t\ton CCD.ProductAKId = Pr.ProductAKId\r\n\t\tand Pr.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLineOfBusiness IRLOB\r\n\t\ton CCD.InsuranceReferenceLineOfBusinessAKID = IRLOB.InsuranceReferenceLineOfBusinessAKId\r\n\t\tand IRLOB.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingPlan RPDT\r\n\t\ton CCD.RatingPlanAKId=RPDT.RatingPlanAKId and RPDT.CurrentSnapshotFlag=1\r\n\t\tjoin @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceDim IRD\r\n\t\ton isnull(Pr.ProductCode, '000') = IRD.ProductCode \r\n\t\tand isnull(PO.PolicyOfferingCode, '000') = IRD.PolicyOfferingCode \r\n\t\tand isnull(ISe.InsuranceSegmentCode, 'N/A') = IRD.InsuranceSegmentCode \r\n\t\tand isnull(SPC.StrategicProfitCenterCode, '6') = IRD.StrategicProfitCenterCode \r\n\t\tand isnull(IRLOB.InsuranceReferenceLineOfBusinessCode, '000') = IRD.InsuranceReferenceLineOfBusinessCode \r\n\t\tand isnull(EG.EnterpriseGroupCode, '1')=IRD.EnterpriseGroupCode \r\n\t\tand isnull(IRE.InsuranceReferenceLegalEntityCode, '1')=IRD.InsuranceReferenceLegalEntityCode\r\n\t\tand isnull(RPDT.RatingPlanCode, '1')=IRD.RatingPlanCode\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY InsuranceReferenceDimId) = 1\n),\nmplt_Claim_occurence_dim_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nLKP_SalesDivisionDim AS (\n\tSELECT\n\tSalesDivisionDimID,\n\tAgencyAKID\n\tFROM (\n\t\tSelect A.AgencyAKID AS AgencyAKID, \r\n\t\tSDD.SalesDivisionDimID AS SalesDivisionDimID\r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency A,\r\n\t\t@{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager RSM,@{pipeline().parameters.TARGET_TABLE_OWNER}.SalesDivisionDim SDD\r\n\t\tWHERE A.CurrentSnapshotFlag =1\r\n\t\tAND RSM.RegionalSalesManagerAKID = A.RegionalSalesManagerAKID\r\n\t\tAND RSM.CurrentSnapshotFlag = 1\r\n\t\tAND RSM.SalesDirectorAKID = SDD.EDWSalesDirectorAKID\r\n\t\tAND A.SalesTerritoryAKID = SDD.EDWSalesTerritoryAKID\r\n\t\tAND RSM.RegionalSalesManagerAKID = SDD.EDWRegionalSalesManagerAKID\r\n\t\tAND SDD.CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID ORDER BY SalesDivisionDimID) = 1\n),\nSEQ_Dummy_Transactions AS (\n\tCREATE SEQUENCE SEQ_Dummy_Transactions\n\tSTART = 1\n\tINCREMENT = 1;\n),\nmplt_Strategic_Business_Division_Dim1 AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)\n\t\t) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)\n\t\t) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, CURRENT_TIMESTAMP, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_Dim_ids AS (\n\tSELECT\n\t-1 AS default_dim_id,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'))\n\tLKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_id AS v_Default_date_id,\n\tv_Default_date_id AS Default_date_id,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_occurrence_dim_id),-1,claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_OUT,\n\tEXP_Claimany_Dim_Ids.claimant_dim_id,\n\t-- *INF*: IIF(ISNULL(claimant_dim_id),-1,claimant_dim_id)\n\tIFF(claimant_dim_id IS NULL, - 1, claimant_dim_id) AS claimant_dim_id_OUT,\n\tEXP_Claimany_Dim_Ids.claimant_cov_dim_id,\n\tEXP_Claimany_Dim_Ids.cov_dim_id,\n\t-- *INF*: IIF(ISNULL(cov_dim_id),-1,cov_dim_id)\n\tIFF(cov_dim_id IS NULL, - 1, cov_dim_id) AS cov_dim_id_OUT,\n\tmplt_Claim_occurence_dim_id.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id),-1,pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_OUT,\n\tmplt_Claim_occurence_dim_id.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tmplt_Claim_occurence_dim_id.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id),-1,agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_OUT,\n\tmplt_Claim_occurence_dim_id.claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(v_claim_loss_date_id IS NOT NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tmplt_Claim_occurence_dim_id.claim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(v_claim_discovery_date_id IS NOT NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tmplt_Claim_occurence_dim_id.claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_scripted_date_id), v_claim_scripted_date_id, -1)\n\tIFF(v_claim_scripted_date_id IS NOT NULL, v_claim_scripted_date_id, - 1) AS claim_scripted_date_id,\n\tmplt_Claim_occurence_dim_id.source_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_source_claim_rpted_date_id), v_source_claim_rpted_date_id, -1)\n\tIFF(v_source_claim_rpted_date_id IS NOT NULL, v_source_claim_rpted_date_id, - 1) AS source_claim_rpted_date_id,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(v_claim_occurrence_rpted_date_id IS NOT NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tmplt_Claim_occurence_dim_id.claim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date_id), v_claim_open_date_id, -1)\n\tIFF(v_claim_open_date_id IS NOT NULL, v_claim_open_date_id, - 1) AS claim_open_date_id,\n\tmplt_Claim_occurence_dim_id.claim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date_id), v_claim_close_date_id, -1)\n\tIFF(v_claim_close_date_id IS NOT NULL, v_claim_close_date_id, - 1) AS claim_close_date_id,\n\tmplt_Claim_occurence_dim_id.claim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date_id), v_claim_reopen_date_id, -1)\n\tIFF(v_claim_reopen_date_id IS NOT NULL, v_claim_reopen_date_id, - 1) AS claim_reopen_date_id,\n\tmplt_Claim_occurence_dim_id.claim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date_id), v_claim_closed_after_reopen_date_id, -1)\n\tIFF(\n\t    v_claim_closed_after_reopen_date_id IS NOT NULL, v_claim_closed_after_reopen_date_id, - 1\n\t) AS claim_closed_after_reopen_date_id,\n\tmplt_Claim_occurence_dim_id.claim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date_id), v_claim_notice_only_date_id, -1)\n\tIFF(v_claim_notice_only_date_id IS NOT NULL, v_claim_notice_only_date_id, - 1) AS claim_notice_only_date_id,\n\tmplt_Claim_occurence_dim_id.claim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(v_claim_cat_start_date_id IS NOT NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tmplt_Claim_occurence_dim_id.claim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(v_claim_cat_end_date_id IS NOT NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tmplt_Claim_occurence_dim_id.claim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, v_Default_date_id)\n\tIFF(\n\t    v_claim_rep_assigned_date_id IS NOT NULL, v_claim_rep_assigned_date_id, v_Default_date_id\n\t) AS claim_rep_assigned_date_id,\n\tmplt_Claim_occurence_dim_id.claim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, v_Default_date_id)\n\tIFF(\n\t    v_claim_rep_unassigned_date_id IS NOT NULL, v_claim_rep_unassigned_date_id,\n\t    v_Default_date_id\n\t) AS claim_rep_unassigned_date_id,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id),-1,claim_rep_dim_prim_claim_rep_id)\n\tIFF(claim_rep_dim_prim_claim_rep_id IS NULL, - 1, claim_rep_dim_prim_claim_rep_id) AS claim_rep_dim_prim_claim_rep_id_OUT,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id),-1,claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_OUT,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id),-1,claim_rep_dim_prim_litigation_handler_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_id\n\t) AS claim_rep_dim_prim_litigation_handler_id_OUT,\n\tmplt_Claim_occurence_dim_id.pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_eff_date_id),-1,v_pol_eff_date_id)\n\tIFF(v_pol_eff_date_id IS NULL, - 1, v_pol_eff_date_id) AS pol_eff_date_id,\n\tmplt_Claim_occurence_dim_id.pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_exp_date_id),-1,v_pol_exp_date_id)\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(v_pol_exp_date_id IS NULL, - 1, v_pol_exp_date_id) AS pol_exp_date_id,\n\t0 AS default_amt,\n\t-1 AS default_audit_id,\n\t'0000000000000000000000000' AS err_flag,\n\t-1 AS claim_rep_dim_trans_entry_oper_id,\n\tmplt_Claim_occurence_dim_id.AgencyDimID,\n\t-- *INF*: IIF(ISNULL(AgencyDimID),-1,AgencyDimID)\n\tIFF(AgencyDimID IS NULL, - 1, AgencyDimID) AS AgencyDimID_OUT,\n\tmplt_Claim_occurence_dim_id.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_id_OUT,\n\tmplt_Claim_occurence_dim_id.claim_case_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_id),-1,claim_case_dim_id)\n\tIFF(claim_case_dim_id IS NULL, - 1, claim_case_dim_id) AS claim_case_dim_id_out,\n\tSEQ_Dummy_Transactions.NEXTVAL,\n\t-1 * NEXTVAL AS out_edw_claim_trans_pk_id,\n\tEXP_Claimany_Dim_Ids.claim_subrogation_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_subrogation_dim_id), -1, claim_subrogation_dim_id)\n\tIFF(claim_subrogation_dim_id IS NULL, - 1, claim_subrogation_dim_id) AS claim_subrogation_dim_id_out,\n\tEXP_Claimany_Dim_Ids.referred_to_subrogation_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(referred_to_subrogation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_referred_to_subrogation_date_id,\n\t-- *INF*: IIF(ISNULL(v_referred_to_subrogation_date_id), -1, v_referred_to_subrogation_date_id)\n\tIFF(v_referred_to_subrogation_date_id IS NULL, - 1, v_referred_to_subrogation_date_id) AS referred_to_subrogation_date_id,\n\tEXP_Claimany_Dim_Ids.pay_start_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pay_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_start_date_id,\n\t-- *INF*: IIF(ISNULL(v_pay_start_date_id), -1, v_pay_start_date_id)\n\tIFF(v_pay_start_date_id IS NULL, - 1, v_pay_start_date_id) AS pay_start_date_id,\n\tEXP_Claimany_Dim_Ids.closure_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(closure_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\r\n\t-- \r\n\t-- \n\tLKP_CALENDAR_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_closure_date_id,\n\t-- *INF*: IIF(ISNULL(v_closure_date_id), -1, v_closure_date_id)\n\tIFF(v_closure_date_id IS NULL, - 1, v_closure_date_id) AS closure_date_id,\n\t'N/A' AS default_string,\n\tmplt_Strategic_Business_Division_Dim1.strtgc_bus_dvsn_dim_id,\n\tmplt_Claim_occurence_dim_id.AgencyAKID,\n\tmplt_Claim_occurence_dim_id.SalesTerritoryAKID,\n\tmplt_Claim_occurence_dim_id.RegionalSalesManagerAKID,\n\tmplt_Claim_occurence_dim_id.SalesDirectorAKID,\n\tmplt_Claim_occurence_dim_id.StrategicProfitCenterAKId,\n\tmplt_Claim_occurence_dim_id.InsuranceSegmentAKId,\n\tmplt_Claim_occurence_dim_id.PolicyOfferingAKId,\n\tLKP_SalesDivisionDim.SalesDivisionDimID,\n\t-- *INF*: IIF(ISNULL(SalesDivisionDimID),-1,SalesDivisionDimID)\n\tIFF(SalesDivisionDimID IS NULL, - 1, SalesDivisionDimID) AS SalesDivisionDimID_out,\n\tmplt_Claim_occurence_dim_id.pol_sym,\n\tLKP_InsuranceReferenceDimId.InsuranceReferenceDimId AS LKP_InsuranceReferenceDimId,\n\tLKP_InsuranceReferenceDimId.StrategicProfitCenterCode AS LKP_StrategicProfitCenterCode,\n\t-- *INF*: :LKP.LKP_STRATEGIC_BUSINESS_DIVISION_DIM(LKP_StrategicProfitCenterCode)\n\tLKP_STRATEGIC_BUSINESS_DIVISION_DIM_LKP_StrategicProfitCenterCode.strtgc_bus_dvsn_dim_id AS v_strtgc_bus_dvsn_dim_id_DCT,\n\t-- *INF*: IIF(isnull(v_strtgc_bus_dvsn_dim_id_DCT),-1,v_strtgc_bus_dvsn_dim_id_DCT)\n\tIFF(v_strtgc_bus_dvsn_dim_id_DCT IS NULL, - 1, v_strtgc_bus_dvsn_dim_id_DCT) AS v_strtgc_bus_dvsn_dim_id_DCT_out,\n\t-- *INF*: IIF(pol_sym = '000',v_strtgc_bus_dvsn_dim_id_DCT_out,strtgc_bus_dvsn_dim_id)\n\tIFF(pol_sym = '000', v_strtgc_bus_dvsn_dim_id_DCT_out, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_out,\n\t-- *INF*: iif(isnull(LKP_InsuranceReferenceDimId),-1,LKP_InsuranceReferenceDimId)\n\tIFF(LKP_InsuranceReferenceDimId IS NULL, - 1, LKP_InsuranceReferenceDimId) AS v_InsuranceReferenceDimId_out,\n\tv_InsuranceReferenceDimId_out AS InsuranceReferenceDimId,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_Claimany_Dim_Ids\n\t -- Manually join with mplt_Claim_occurence_dim_id\n\t -- Manually join with mplt_Strategic_Business_Division_Dim1\n\tLEFT JOIN LKP_InsuranceReferenceDimId\n\tON LKP_InsuranceReferenceDimId.claimant_cov_det_ak_id = EXP_Claimany_Dim_Ids.edw_claimant_cov_det_ak_id\n\tLEFT JOIN LKP_SalesDivisionDim\n\tON LKP_SalesDivisionDim.AgencyAKID = mplt_Claim_occurence_dim_id.AgencyAKID\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS\n\tON LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_date = TO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(referred_to_subrogation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(closure_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_STRATEGIC_BUSINESS_DIVISION_DIM LKP_STRATEGIC_BUSINESS_DIVISION_DIM_LKP_StrategicProfitCenterCode\n\tON LKP_STRATEGIC_BUSINESS_DIVISION_DIM_LKP_StrategicProfitCenterCode.strtgc_bus_dvsn_code = LKP_StrategicProfitCenterCode\n\n),\nclaim_loss_transaction_fact_dummy_claimant_cov_transaction_row AS (\n\tINSERT INTO claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\tERR_FLAG, \n\tdefault_audit_id AS AUDIT_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_TRANS_PK_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_REINS_TRANS_PK_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_HIST_ID, \n\tclaimant_dim_id_OUT AS CLAIMANT_DIM_ID, \n\tclaimant_dim_id_OUT AS CLAIMANT_DIM_HIST_ID, \n\tCLAIMANT_COV_DIM_ID, \n\tclaimant_cov_dim_id AS CLAIMANT_COV_DIM_HIST_ID, \n\tcov_dim_id_OUT AS COV_DIM_ID, \n\tcov_dim_id_OUT AS COV_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_TRANS_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_HIST_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tCLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tclaim_rep_dim_trans_entry_oper_id AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tclaim_created_by_id_OUT AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_HIST_ID, \n\tagency_dim_id_OUT AS AGENCY_DIM_ID, \n\tAgencyDimID_OUT AS AGENCY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tclaim_case_dim_id_out AS CLAIM_CASE_DIM_ID, \n\tclaim_case_dim_id_out AS CLAIM_CASE_DIM_HIST_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_MASTER_1099_LIST_DIM_ID, \n\tclaim_subrogation_dim_id_out AS CLAIM_SUBROGATION_DIM_ID, \n\tDefault_date_id AS CLAIM_TRANS_DATE_ID, \n\tDefault_date_id AS CLAIM_TRANS_REPROCESS_DATE_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tclaim_occurrence_rpted_date_id AS CLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\treferred_to_subrogation_date_id AS CLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tpay_start_date_id AS CLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tclosure_date_id AS CLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tDefault_date_id AS ACCT_ENTERED_DATE_ID, \n\tdefault_amt AS TRANS_AMT, \n\tdefault_amt AS TRANS_HIST_AMT, \n\tdefault_dim_id AS TAX_ID, \n\tdefault_amt AS DIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_SUBROGATION_PAID, \n\tdefault_amt AS DIRECT_SUBROGATION_OUTSTANDING, \n\tdefault_amt AS DIRECT_SUBROGATION_INCURRED, \n\tdefault_amt AS DIRECT_SALVAGE_PAID, \n\tdefault_amt AS DIRECT_SALVAGE_OUTSTANDING, \n\tdefault_amt AS DIRECT_SALVAGE_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_INCURRED, \n\tdefault_amt AS CEDED_LOSS_PAID, \n\tdefault_amt AS CEDED_LOSS_OUTSTANDING, \n\tdefault_amt AS CEDED_LOSS_INCURRED, \n\tdefault_amt AS CEDED_ALAE_PAID, \n\tdefault_amt AS CEDED_ALAE_OUTSTANDING, \n\tdefault_amt AS CEDED_ALAE_INCURRED, \n\tdefault_amt AS CEDED_SALVAGE_PAID, \n\tdefault_amt AS CEDED_SUBROGATION_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS TOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tdefault_amt AS NET_LOSS_PAID, \n\tdefault_amt AS NET_LOSS_OUTSTANDING, \n\tdefault_amt AS NET_LOSS_INCURRED, \n\tdefault_amt AS NET_ALAE_PAID, \n\tdefault_amt AS NET_ALAE_OUTSTANDING, \n\tdefault_amt AS NET_ALAE_INCURRED, \n\tdefault_dim_id AS ASL_DIM_ID, \n\tdefault_dim_id AS ASL_PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS LOSS_MASTER_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id_out AS STRTGC_BUS_DVSN_DIM_ID, \n\tdefault_dim_id AS PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS CLAIMRESERVEDIMID, \n\tdefault_dim_id AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tDefault_date_id AS FEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tINSURANCEREFERENCEDIMID, \n\tAgencyDimID_OUT AS AGENCYDIMID, \n\tSalesDivisionDimID_out AS SALESDIVISIONDIMID, \n\tdefault_dim_id AS INSURANCEREFERENCECOVERAGEDIMID, \n\tdefault_dim_id AS COVERAGEDETAILDIMID, \n\tMODIFIEDDATE\n\tFROM EXP_Dim_ids\n),\nSQ_claimant_dim AS (\n\tSELECT CD.claimant_dim_id, CD.edw_claim_party_occurrence_ak_id \r\n\tFROM\r\n\t @{pipeline().parameters.TARGET_TABLE_OWNER}.claimant_dim CD, @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO\r\n\tWHERE claimant_dim_id NOT IN  (SELECT claimant_dim_id from @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact)\r\n\tAND CD.crrnt_snpsht_flag = 1 AND  CPO.crrnt_snpsht_flag = 1 AND \r\n\tedw_claim_party_occurrence_pk_id = CPO.claim_party_occurrence_id AND\r\n\tCPO.claim_party_role_code IN ('CLMT','CMT')  AND  CD.claimant_dim_id  <> -1\n),\nEXP_Claimant_dim_values AS (\n\tSELECT\n\tclaimant_dim_id,\n\tedw_claim_party_occurrence_ak_id,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date,\n\tv_trans_date AS trans_date\n\tFROM SQ_claimant_dim\n),\nLKP_Claim_Party_Occurrence AS (\n\tSELECT\n\tclaim_occurrence_ak_id,\n\tclaim_case_ak_id,\n\tclaim_party_occurrence_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \r\n\t\t\tclaim_party_occurrence.claim_occurrence_ak_id       AS claim_occurrence_ak_id,\r\n\t\t       claim_party_occurrence.claim_case_ak_id             AS claim_case_ak_id,\r\n\t\t       claim_party_occurrence.claim_party_occurrence_ak_id AS claim_party_occurrence_ak_id,\r\n\t\t       claim_party_occurrence.eff_from_date                AS eff_from_date,\r\n\t\t       claim_party_occurrence.eff_to_date                  AS eff_to_date\r\n\t\tFROM   claim_party_occurrence \r\n\t\tWHERE  crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n),\nLKP_Claim_Case AS (\n\tSELECT\n\tclaim_case_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_case_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_case\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n),\nLKP_Claim_Case_Dim AS (\n\tSELECT\n\tclaim_case_dim_id,\n\tedw_claim_case_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_case_dim_id,\n\t\t\tedw_claim_case_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_case_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n),\nmplt_Claim_occurrence_CD AS (WITH\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_occurence_reserve_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_reserve_calculation_id,\n\t\tclaim_occurrence_ak_id,\n\t\tfinancial_type_code,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_reserve_calculation_id,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\tfinancial_type_code,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_reserve_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,financial_type_code,eff_from_date,eff_to_date ORDER BY claim_occurrence_reserve_calculation_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claim_occurrence_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_claim_occurrence_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_calculation_id,\n\t\tclaim_occurrence_reported_date,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_calculation_id,\n\t\t\t\tclaim_occurrence_reported_date,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_calculation_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterCode,\n\t\tInsuranceSegmentCode,\n\t\tPolicyOfferingCode,\n\t\tpol_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy.pol_id as pol_id, \r\n\t\t\tpolicy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id, \r\n\t\t\tpolicy.pol_sym as pol_sym, \r\n\t\t\tpolicy.pol_num as pol_num, \r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, \r\n\t\t\tpolicy.pol_exp_date as pol_exp_date, \r\n\t\t\tpolicy.strtgc_bus_dvsn_ak_id as strtgc_bus_dvsn_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID,\r\n\t\t\tSPC.StrategicProfitCenterCode as StrategicProfitCenterCode, INSG.InsuranceSegmentCode as InsuranceSegmentCode, \r\n\t\t\tPO.PolicyOfferingCode as PolicyOfferingCode, \r\n\t\t\tpolicy.pol_key as pol_key, \r\n\t\t\tpolicy.eff_from_date as eff_from_date, \r\n\t\t\tpolicy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy,\r\n\t\t\tStrategicProfitCenter SPC,\r\n\t\t\tInsuranceSegment INSG,\r\n\t\t\tPolicyOffering PO\r\n\t\t\tWHERE \r\n\t\t\tpolicy.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId and SPC.CurrentSnapshotFlag =  1\r\n\t\t\tand policy.InsuranceSegmentAKId = INSG.InsuranceSegmentAKId and INSG.CurrentSnapshotFlag = 1\r\n\t\t\tand policy.PolicyOfferingAKId = PO.PolicyOfferingAKId and PO.CurrentSnapshotFlag = 1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence.claim_occurrence_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_id), -1, claim_occurrence_id)\n\t\tIFF(claim_occurrence_id IS NULL, - 1, claim_occurrence_id) AS claim_occurrence_id_out,\n\t\t-- *INF*: IIF(ISNULL(claim_rep_occurrence_id), -1, claim_rep_occurrence_id)\n\t\tIFF(claim_rep_occurrence_id IS NULL, - 1, claim_rep_occurrence_id) AS claim_rep_occurrence_id_out,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_calculation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_calculation_id), -1, claim_occurrence_calculation_id)\n\t\tIFF(claim_occurrence_calculation_id IS NULL, - 1, claim_occurrence_calculation_id) AS claim_occurrence_calculation_id_out,\n\t\tEXP_get_values.IN_claim_occurrence_ak_id AS claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'D', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: iif(isnull(claim_occurrence_reserve_calc_direct_loss_id), -1, claim_occurrence_reserve_calc_direct_loss_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_direct_loss_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_direct_loss_id\n\t\t) AS out_claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'E', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_exp_id), -1, claim_occurrence_reserve_calc_exp_id)\n\t\tIFF(claim_occurrence_reserve_calc_exp_id IS NULL, - 1, claim_occurrence_reserve_calc_exp_id) AS out_claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'B', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_subrogation_id), -1, claim_occurrence_reserve_calc_subrogation_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_subrogation_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_subrogation_id\n\t\t) AS out_claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'S', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_salvage_id), -1, claim_occurrence_reserve_calc_salvage_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_salvage_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_salvage_id\n\t\t) AS out_claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'R', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_recovery_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_recovery_id), -1, claim_occurrence_reserve_calc_recovery_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_recovery_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_recovery_id\n\t\t) AS out_claim_occurrence_reserve_calc_recovery_id,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_reported_date AS claim_occurrence_rpted_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_calc\n\t\tON LKP_claim_occurrence_calc.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence_calc.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_calc.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.financial_type_code = 'D'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.financial_type_code = 'E'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.financial_type_code = 'B'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.financial_type_code = 'S'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.financial_type_code = 'R'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Agency_Key AS (\n\t\tSELECT\n\t\tagency_key,\n\t\tagency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_key,\n\t\t\t\tagency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_key DESC) = 1\n\t),\n\tLKP_contract_customer AS (\n\t\tSELECT\n\t\tcontract_cust_id,\n\t\tcontract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_id,\n\t\t\t\tcontract_cust_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tpol_dim_id,\n\t\t\t\tedw_pol_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM policy_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tEXP_Claim_Rep_Lkp_Values AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_agency_Dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tagency_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tagency_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_key,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_dim_id,\n\t\t\t\tedw_contract_cust_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_pk_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence.claim_loss_date, \n\t\tLKP_claim_occurrence.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence.claim_cat_start_date, \n\t\tLKP_claim_occurrence.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_examiner_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_agency_Dim.agency_dim_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_created_by_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.strtgc_bus_dvsn_ak_id, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tLKP_V2_policy.StrategicProfitCenterCode, \n\t\tLKP_V2_policy.InsuranceSegmentCode, \n\t\tLKP_V2_policy.PolicyOfferingCode\n\t\tFROM EXP_Claim_Rep_Lkp_Values\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_key = LKP_claim_occurrence.pol_key AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_Dim\n\t\tON LKP_agency_Dim.agency_key = LKP_Agency_Key.agency_key AND LKP_agency_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_pk_id = LKP_contract_customer.contract_cust_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Strategic_Business_Division_Dim2 AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)\n\t\t) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)\n\t\t) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, CURRENT_TIMESTAMP, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_Dim_Ids_Claimant_Dim AS (\n\tSELECT\n\t-1 AS default_dim_id,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'))\n\tLKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_id AS v_default_date_id,\n\tv_default_date_id AS Default_date_id,\n\tmplt_Claim_occurrence_CD.claim_occurrence_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_occurrence_dim_id),-1,claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_OUT,\n\tEXP_Claimant_dim_values.claimant_dim_id,\n\tmplt_Claim_occurrence_CD.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id),-1,pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_OUT,\n\tmplt_Claim_occurrence_CD.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tmplt_Claim_occurrence_CD.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id),-1,agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_OUT,\n\tmplt_Claim_occurrence_CD.claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(v_claim_loss_date_id IS NOT NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tmplt_Claim_occurrence_CD.claim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(v_claim_discovery_date_id IS NOT NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tmplt_Claim_occurrence_CD.claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_scripted_date_id), v_claim_scripted_date_id, -1)\n\tIFF(v_claim_scripted_date_id IS NOT NULL, v_claim_scripted_date_id, - 1) AS claim_scripted_date_id,\n\tmplt_Claim_occurrence_CD.source_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_source_claim_rpted_date_id), v_source_claim_rpted_date_id, -1)\n\tIFF(v_source_claim_rpted_date_id IS NOT NULL, v_source_claim_rpted_date_id, - 1) AS source_claim_rpted_date_id,\n\tmplt_Claim_occurrence_CD.claim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(v_claim_occurrence_rpted_date_id IS NOT NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tmplt_Claim_occurrence_CD.claim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date_id),v_claim_open_date_id, -1)\n\tIFF(v_claim_open_date_id IS NOT NULL, v_claim_open_date_id, - 1) AS claim_open_date_id,\n\tmplt_Claim_occurrence_CD.claim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date_id), v_claim_close_date_id, -1)\n\tIFF(v_claim_close_date_id IS NOT NULL, v_claim_close_date_id, - 1) AS claim_close_date_id,\n\tmplt_Claim_occurrence_CD.claim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date_id), v_claim_reopen_date_id, -1)\n\tIFF(v_claim_reopen_date_id IS NOT NULL, v_claim_reopen_date_id, - 1) AS claim_reopen_date_id,\n\tmplt_Claim_occurrence_CD.claim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date_id), v_claim_closed_after_reopen_date_id, -1)\n\tIFF(\n\t    v_claim_closed_after_reopen_date_id IS NOT NULL, v_claim_closed_after_reopen_date_id, - 1\n\t) AS claim_closed_after_reopen_date_id,\n\tmplt_Claim_occurrence_CD.claim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date_id), v_claim_notice_only_date_id, -1)\n\tIFF(v_claim_notice_only_date_id IS NOT NULL, v_claim_notice_only_date_id, - 1) AS claim_notice_only_date_id,\n\tmplt_Claim_occurrence_CD.claim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(v_claim_cat_start_date_id IS NOT NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tmplt_Claim_occurrence_CD.claim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(v_claim_cat_end_date_id IS NOT NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tmplt_Claim_occurrence_CD.claim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, v_default_date_id)\n\tIFF(\n\t    v_claim_rep_assigned_date_id IS NOT NULL, v_claim_rep_assigned_date_id, v_default_date_id\n\t) AS claim_rep_assigned_date_id,\n\tmplt_Claim_occurrence_CD.claim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, v_default_date_id)\n\tIFF(\n\t    v_claim_rep_unassigned_date_id IS NOT NULL, v_claim_rep_unassigned_date_id,\n\t    v_default_date_id\n\t) AS claim_rep_unassigned_date_id,\n\tmplt_Claim_occurrence_CD.claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id),-1,claim_rep_dim_prim_claim_rep_id)\n\tIFF(claim_rep_dim_prim_claim_rep_id IS NULL, - 1, claim_rep_dim_prim_claim_rep_id) AS claim_rep_dim_prim_claim_rep_id_OUT,\n\tmplt_Claim_occurrence_CD.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id),-1,claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_OUT,\n\tmplt_Claim_occurrence_CD.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id),-1,claim_rep_dim_prim_litigation_handler_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_id\n\t) AS claim_rep_dim_prim_litigation_handler_id_OUT,\n\tmplt_Claim_occurrence_CD.pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_eff_date_id),-1,v_pol_eff_date_id)\n\tIFF(v_pol_eff_date_id IS NULL, - 1, v_pol_eff_date_id) AS pol_eff_date_id,\n\tmplt_Claim_occurrence_CD.pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_exp_date_id),-1,v_pol_exp_date_id)\r\n\t-- \r\n\t-- \n\tIFF(v_pol_exp_date_id IS NULL, - 1, v_pol_exp_date_id) AS pol_exp_date_id,\n\t0 AS default_amt,\n\t-2 AS default_audit_id,\n\t'0000000000000000000000000' AS err_flag,\n\t-1 AS claim_rep_dim_trans_entry_oper_id,\n\tmplt_Claim_occurrence_CD.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_id_OUT,\n\tSEQ_Dummy_Transactions.NEXTVAL,\n\t-1 * NEXTVAL AS out_edw_claim_trans_pk_id,\n\tLKP_Claim_Case_Dim.claim_case_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_id), -1,claim_case_dim_id)\n\tIFF(claim_case_dim_id IS NULL, - 1, claim_case_dim_id) AS claim_case_dim_id_out,\n\t'N/A' AS default_string,\n\tmplt_Strategic_Business_Division_Dim2.strtgc_bus_dvsn_dim_id,\n\tmplt_Claim_occurrence_CD.pol_sym,\n\tmplt_Claim_occurrence_CD.strtgc_bus_dvsn_ak_id,\n\tmplt_Claim_occurrence_CD.StrategicProfitCenterCode,\n\tmplt_Claim_occurrence_CD.InsuranceSegmentCode,\n\tmplt_Claim_occurrence_CD.PolicyOfferingCode,\n\t'N/A' AS ProductCode,\n\t'N/A' AS InsuranceReferenceLineOfBusinessCode,\n\t'N/A' AS v_RatingPlanCode,\n\t-- *INF*: :LKP.LKP_STRATEGIC_BUSINESS_DIVISION_DIM(StrategicProfitCenterCode)\n\tLKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode.strtgc_bus_dvsn_dim_id AS v_strtgc_bus_dvsn_dim_id_DCT,\n\t-- *INF*: IIF(isnull(v_strtgc_bus_dvsn_dim_id_DCT),-1,v_strtgc_bus_dvsn_dim_id_DCT)\n\tIFF(v_strtgc_bus_dvsn_dim_id_DCT IS NULL, - 1, v_strtgc_bus_dvsn_dim_id_DCT) AS v_strtgc_bus_dvsn_dim_id_DCT_out,\n\t-- *INF*: IIF(pol_sym = '000',v_strtgc_bus_dvsn_dim_id_DCT_out,strtgc_bus_dvsn_dim_id)\n\tIFF(pol_sym = '000', v_strtgc_bus_dvsn_dim_id_DCT_out, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_out,\n\t-- *INF*: :LKP.LKP_INSURANCEREFERENCEDIM(StrategicProfitCenterCode,InsuranceSegmentCode,PolicyOfferingCode,ProductCode,InsuranceReferenceLineOfBusinessCode, v_RatingPlanCode)\n\tLKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceReferenceDimId AS v_InsuranceReferenceDimId,\n\t-- *INF*: iif(isnull(v_InsuranceReferenceDimId),-1,v_InsuranceReferenceDimId)\n\tIFF(v_InsuranceReferenceDimId IS NULL, - 1, v_InsuranceReferenceDimId) AS v_InsuranceReferenceDimId_out,\n\tv_InsuranceReferenceDimId_out AS InsuranceReferenceDimId,\n\tmplt_Claim_occurrence_CD.AgencyDimID,\n\t-- *INF*: iif(isnull(AgencyDimID),-1,AgencyDimID)\n\tIFF(AgencyDimID IS NULL, - 1, AgencyDimID) AS AgencyDimID_out,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_Claimant_dim_values\n\t -- Manually join with mplt_Claim_occurrence_CD\n\t -- Manually join with mplt_Strategic_Business_Division_Dim2\n\tLEFT JOIN LKP_Claim_Case_Dim\n\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_Claimant_dim_values.trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_Claimant_dim_values.trans_date\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS\n\tON LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_date = TO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_STRATEGIC_BUSINESS_DIVISION_DIM LKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode\n\tON LKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode.strtgc_bus_dvsn_code = StrategicProfitCenterCode\n\n\tLEFT JOIN LKP_INSURANCEREFERENCEDIM LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode\n\tON LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.StrategicProfitCenterCode = StrategicProfitCenterCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceSegmentCode = InsuranceSegmentCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.PolicyOfferingCode = PolicyOfferingCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.ProductCode = ProductCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceReferenceLineOfBusinessCode = InsuranceReferenceLineOfBusinessCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.RatingPlanCode = v_RatingPlanCode\n\n),\nclaim_loss_transaction_fact_dummy_claimant_transaction_row AS (\n\tINSERT INTO claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\tERR_FLAG, \n\tdefault_audit_id AS AUDIT_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_TRANS_PK_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_REINS_TRANS_PK_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_HIST_ID, \n\tCLAIMANT_DIM_ID, \n\tclaimant_dim_id AS CLAIMANT_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIMANT_COV_DIM_ID, \n\tdefault_dim_id AS CLAIMANT_COV_DIM_HIST_ID, \n\tdefault_dim_id AS COV_DIM_ID, \n\tdefault_dim_id AS COV_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_TRANS_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_HIST_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tCLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tclaim_rep_dim_trans_entry_oper_id AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tclaim_created_by_id_OUT AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_HIST_ID, \n\tagency_dim_id_OUT AS AGENCY_DIM_ID, \n\tdefault_dim_id AS AGENCY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tclaim_case_dim_id_out AS CLAIM_CASE_DIM_ID, \n\tclaim_case_dim_id_out AS CLAIM_CASE_DIM_HIST_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_MASTER_1099_LIST_DIM_ID, \n\tdefault_dim_id AS CLAIM_SUBROGATION_DIM_ID, \n\tDefault_date_id AS CLAIM_TRANS_DATE_ID, \n\tDefault_date_id AS CLAIM_TRANS_REPROCESS_DATE_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tclaim_occurrence_rpted_date_id AS CLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tDefault_date_id AS ACCT_ENTERED_DATE_ID, \n\tdefault_amt AS TRANS_AMT, \n\tdefault_amt AS TRANS_HIST_AMT, \n\tdefault_audit_id AS TAX_ID, \n\tdefault_amt AS DIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_SUBROGATION_PAID, \n\tdefault_amt AS DIRECT_SUBROGATION_OUTSTANDING, \n\tdefault_amt AS DIRECT_SUBROGATION_INCURRED, \n\tdefault_amt AS DIRECT_SALVAGE_PAID, \n\tdefault_amt AS DIRECT_SALVAGE_OUTSTANDING, \n\tdefault_amt AS DIRECT_SALVAGE_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_INCURRED, \n\tdefault_amt AS CEDED_LOSS_PAID, \n\tdefault_amt AS CEDED_LOSS_OUTSTANDING, \n\tdefault_amt AS CEDED_LOSS_INCURRED, \n\tdefault_amt AS CEDED_ALAE_PAID, \n\tdefault_amt AS CEDED_ALAE_OUTSTANDING, \n\tdefault_amt AS CEDED_ALAE_INCURRED, \n\tdefault_amt AS CEDED_SALVAGE_PAID, \n\tdefault_amt AS CEDED_SUBROGATION_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS TOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tdefault_amt AS NET_LOSS_PAID, \n\tdefault_amt AS NET_LOSS_OUTSTANDING, \n\tdefault_amt AS NET_LOSS_INCURRED, \n\tdefault_amt AS NET_ALAE_PAID, \n\tdefault_amt AS NET_ALAE_OUTSTANDING, \n\tdefault_amt AS NET_ALAE_INCURRED, \n\tdefault_dim_id AS ASL_DIM_ID, \n\tdefault_dim_id AS ASL_PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS LOSS_MASTER_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id_out AS STRTGC_BUS_DVSN_DIM_ID, \n\tdefault_dim_id AS PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS CLAIMRESERVEDIMID, \n\tdefault_dim_id AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tDefault_date_id AS FEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tINSURANCEREFERENCEDIMID, \n\tAgencyDimID_out AS AGENCYDIMID, \n\tdefault_dim_id AS SALESDIVISIONDIMID, \n\tdefault_dim_id AS INSURANCEREFERENCECOVERAGEDIMID, \n\tdefault_dim_id AS COVERAGEDETAILDIMID, \n\tMODIFIEDDATE\n\tFROM EXP_Dim_Ids_Claimant_Dim\n),\nSQ_claim_occurrence_dim AS (\n\tSELECT claim_occurrence_dim.claim_occurrence_dim_id, claim_occurrence_dim.edw_claim_occurrence_ak_id \r\n\tFROM\r\n\t@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence_dim\r\n\tWHERE claim_occurrence_dim_id NOT IN (\r\n\tSELECT claim_occurrence_dim_id FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact )\r\n\tAND crrnt_snpsht_flag = 1 AND claim_occurrence_dim_id <> -1\n),\nEXP_Claim_Occurrence_dim_Values AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tedw_claim_occurrence_ak_id,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date,\n\tv_trans_date AS trans_date\n\tFROM SQ_claim_occurrence_dim\n),\nmplt_Claim_occurrence_COD AS (WITH\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_occurence_reserve_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_reserve_calculation_id,\n\t\tclaim_occurrence_ak_id,\n\t\tfinancial_type_code,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_reserve_calculation_id,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\tfinancial_type_code,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_reserve_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,financial_type_code,eff_from_date,eff_to_date ORDER BY claim_occurrence_reserve_calculation_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claim_occurrence_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_claim_occurrence_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_calculation_id,\n\t\tclaim_occurrence_reported_date,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_calculation_id,\n\t\t\t\tclaim_occurrence_reported_date,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_calculation_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterCode,\n\t\tInsuranceSegmentCode,\n\t\tPolicyOfferingCode,\n\t\tpol_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy.pol_id as pol_id, \r\n\t\t\tpolicy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id, \r\n\t\t\tpolicy.pol_sym as pol_sym, \r\n\t\t\tpolicy.pol_num as pol_num, \r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, \r\n\t\t\tpolicy.pol_exp_date as pol_exp_date, \r\n\t\t\tpolicy.strtgc_bus_dvsn_ak_id as strtgc_bus_dvsn_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID,\r\n\t\t\tSPC.StrategicProfitCenterCode as StrategicProfitCenterCode, INSG.InsuranceSegmentCode as InsuranceSegmentCode, \r\n\t\t\tPO.PolicyOfferingCode as PolicyOfferingCode, \r\n\t\t\tpolicy.pol_key as pol_key, \r\n\t\t\tpolicy.eff_from_date as eff_from_date, \r\n\t\t\tpolicy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy,\r\n\t\t\tStrategicProfitCenter SPC,\r\n\t\t\tInsuranceSegment INSG,\r\n\t\t\tPolicyOffering PO\r\n\t\t\tWHERE \r\n\t\t\tpolicy.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId and SPC.CurrentSnapshotFlag =  1\r\n\t\t\tand policy.InsuranceSegmentAKId = INSG.InsuranceSegmentAKId and INSG.CurrentSnapshotFlag = 1\r\n\t\t\tand policy.PolicyOfferingAKId = PO.PolicyOfferingAKId and PO.CurrentSnapshotFlag = 1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence.claim_occurrence_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_id), -1, claim_occurrence_id)\n\t\tIFF(claim_occurrence_id IS NULL, - 1, claim_occurrence_id) AS claim_occurrence_id_out,\n\t\t-- *INF*: IIF(ISNULL(claim_rep_occurrence_id), -1, claim_rep_occurrence_id)\n\t\tIFF(claim_rep_occurrence_id IS NULL, - 1, claim_rep_occurrence_id) AS claim_rep_occurrence_id_out,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_calculation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_calculation_id), -1, claim_occurrence_calculation_id)\n\t\tIFF(claim_occurrence_calculation_id IS NULL, - 1, claim_occurrence_calculation_id) AS claim_occurrence_calculation_id_out,\n\t\tEXP_get_values.IN_claim_occurrence_ak_id AS claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'D', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: iif(isnull(claim_occurrence_reserve_calc_direct_loss_id), -1, claim_occurrence_reserve_calc_direct_loss_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_direct_loss_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_direct_loss_id\n\t\t) AS out_claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'E', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_exp_id), -1, claim_occurrence_reserve_calc_exp_id)\n\t\tIFF(claim_occurrence_reserve_calc_exp_id IS NULL, - 1, claim_occurrence_reserve_calc_exp_id) AS out_claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'B', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_subrogation_id), -1, claim_occurrence_reserve_calc_subrogation_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_subrogation_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_subrogation_id\n\t\t) AS out_claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'S', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_salvage_id), -1, claim_occurrence_reserve_calc_salvage_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_salvage_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_salvage_id\n\t\t) AS out_claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'R', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_recovery_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_recovery_id), -1, claim_occurrence_reserve_calc_recovery_id)\n\t\tIFF(\n\t\t    claim_occurrence_reserve_calc_recovery_id IS NULL, - 1,\n\t\t    claim_occurrence_reserve_calc_recovery_id\n\t\t) AS out_claim_occurrence_reserve_calc_recovery_id,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_reported_date AS claim_occurrence_rpted_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_calc\n\t\tON LKP_claim_occurrence_calc.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence_calc.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_calc.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.financial_type_code = 'D'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.financial_type_code = 'E'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.financial_type_code = 'B'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.financial_type_code = 'S'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.financial_type_code = 'R'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Agency_Key AS (\n\t\tSELECT\n\t\tagency_key,\n\t\tagency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_key,\n\t\t\t\tagency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_key DESC) = 1\n\t),\n\tLKP_contract_customer AS (\n\t\tSELECT\n\t\tcontract_cust_id,\n\t\tcontract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_id,\n\t\t\t\tcontract_cust_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tpol_dim_id,\n\t\t\t\tedw_pol_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM policy_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tEXP_Claim_Rep_Lkp_Values AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_agency_Dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tagency_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tagency_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_key,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_dim_id,\n\t\t\t\tedw_contract_cust_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_pk_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence.claim_loss_date, \n\t\tLKP_claim_occurrence.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence.claim_cat_start_date, \n\t\tLKP_claim_occurrence.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_examiner_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_agency_Dim.agency_dim_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_created_by_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.strtgc_bus_dvsn_ak_id, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tLKP_V2_policy.StrategicProfitCenterCode, \n\t\tLKP_V2_policy.InsuranceSegmentCode, \n\t\tLKP_V2_policy.PolicyOfferingCode\n\t\tFROM EXP_Claim_Rep_Lkp_Values\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_key = LKP_claim_occurrence.pol_key AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_Dim\n\t\tON LKP_agency_Dim.agency_key = LKP_Agency_Key.agency_key AND LKP_agency_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_pk_id = LKP_contract_customer.contract_cust_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Strategic_Business_Division_Dim AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)\n\t\t) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)\n\t\t) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, CURRENT_TIMESTAMP, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_get_Dim_Ids AS (\n\tSELECT\n\t-1 AS default_dim_id,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'))\n\tLKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_id AS v_default_date_id,\n\tv_default_date_id AS Default_date_id,\n\tmplt_Claim_occurrence_COD.claim_occurrence_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_occurrence_dim_id),-1,claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_OUT,\n\tmplt_Claim_occurrence_COD.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id),-1,pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_OUT,\n\tmplt_Claim_occurrence_COD.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tmplt_Claim_occurrence_COD.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id),-1,agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_OUT,\n\tmplt_Claim_occurrence_COD.claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(v_claim_loss_date_id IS NOT NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tmplt_Claim_occurrence_COD.claim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(v_claim_discovery_date_id IS NOT NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tmplt_Claim_occurrence_COD.claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_scripted_date_id), v_claim_scripted_date_id, -1)\n\tIFF(v_claim_scripted_date_id IS NOT NULL, v_claim_scripted_date_id, - 1) AS claim_scripted_date_id,\n\tmplt_Claim_occurrence_COD.source_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_source_claim_rpted_date_id), v_source_claim_rpted_date_id, -1)\n\tIFF(v_source_claim_rpted_date_id IS NOT NULL, v_source_claim_rpted_date_id, - 1) AS source_claim_rpted_date_id,\n\tmplt_Claim_occurrence_COD.claim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(v_claim_occurrence_rpted_date_id IS NOT NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tmplt_Claim_occurrence_COD.claim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date_id), v_claim_open_date_id, -1)\n\tIFF(v_claim_open_date_id IS NOT NULL, v_claim_open_date_id, - 1) AS claim_open_date_id,\n\tmplt_Claim_occurrence_COD.claim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date_id), v_claim_close_date_id, -1)\n\tIFF(v_claim_close_date_id IS NOT NULL, v_claim_close_date_id, - 1) AS claim_close_date_id,\n\tmplt_Claim_occurrence_COD.claim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date_id), v_claim_reopen_date_id, -1)\n\tIFF(v_claim_reopen_date_id IS NOT NULL, v_claim_reopen_date_id, - 1) AS claim_reopen_date_id,\n\tmplt_Claim_occurrence_COD.claim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date_id), v_claim_closed_after_reopen_date_id, -1)\n\tIFF(\n\t    v_claim_closed_after_reopen_date_id IS NOT NULL, v_claim_closed_after_reopen_date_id, - 1\n\t) AS claim_closed_after_reopen_date_id,\n\tmplt_Claim_occurrence_COD.claim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date_id), v_claim_notice_only_date_id, -1)\n\tIFF(v_claim_notice_only_date_id IS NOT NULL, v_claim_notice_only_date_id, - 1) AS claim_notice_only_date_id,\n\tmplt_Claim_occurrence_COD.claim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(v_claim_cat_start_date_id IS NOT NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tmplt_Claim_occurrence_COD.claim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(v_claim_cat_end_date_id IS NOT NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tmplt_Claim_occurrence_COD.claim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, v_default_date_id)\n\tIFF(\n\t    v_claim_rep_assigned_date_id IS NOT NULL, v_claim_rep_assigned_date_id, v_default_date_id\n\t) AS claim_rep_assigned_date_id,\n\tmplt_Claim_occurrence_COD.claim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, v_default_date_id)\n\tIFF(\n\t    v_claim_rep_unassigned_date_id IS NOT NULL, v_claim_rep_unassigned_date_id,\n\t    v_default_date_id\n\t) AS claim_rep_unassigned_date_id,\n\tmplt_Claim_occurrence_COD.claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id),-1,claim_rep_dim_prim_claim_rep_id)\n\tIFF(claim_rep_dim_prim_claim_rep_id IS NULL, - 1, claim_rep_dim_prim_claim_rep_id) AS claim_rep_dim_prim_claim_rep_id_OUT,\n\tmplt_Claim_occurrence_COD.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id),-1,claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_OUT,\n\tmplt_Claim_occurrence_COD.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id),-1,claim_rep_dim_prim_litigation_handler_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_id\n\t) AS claim_rep_dim_prim_litigation_handler_id_OUT,\n\tmplt_Claim_occurrence_COD.pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_eff_date_id),-1,v_pol_eff_date_id)\n\tIFF(v_pol_eff_date_id IS NULL, - 1, v_pol_eff_date_id) AS pol_eff_date_id,\n\tmplt_Claim_occurrence_COD.pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDAR_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(ISNULL(v_pol_exp_date_id),-1,v_pol_exp_date_id)\r\n\t-- \n\tIFF(v_pol_exp_date_id IS NULL, - 1, v_pol_exp_date_id) AS pol_exp_date_id,\n\t0 AS default_amt,\n\t-3 AS default_audit_id,\n\t'0000000000000000000000000' AS err_flag,\n\t-1 AS claim_rep_dim_trans_entry_oper_id,\n\tmplt_Claim_occurrence_COD.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_id_OUT,\n\tSEQ_Dummy_Transactions.NEXTVAL,\n\t-1 * NEXTVAL AS out_edw_claim_trans_pk_id,\n\t'N/A' AS default_string,\n\tmplt_Strategic_Business_Division_Dim.strtgc_bus_dvsn_dim_id,\n\tmplt_Claim_occurrence_COD.pol_sym,\n\tmplt_Claim_occurrence_COD.strtgc_bus_dvsn_ak_id,\n\tmplt_Claim_occurrence_COD.StrategicProfitCenterCode,\n\tmplt_Claim_occurrence_COD.InsuranceSegmentCode,\n\tmplt_Claim_occurrence_COD.PolicyOfferingCode,\n\t'N/A' AS ProductCode,\n\t'N/A' AS InsuranceReferenceLineOfBusinessCode,\n\t'N/A' AS v_RatingPlanCode,\n\t-- *INF*: :LKP.LKP_STRATEGIC_BUSINESS_DIVISION_DIM(StrategicProfitCenterCode)\n\tLKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode.strtgc_bus_dvsn_dim_id AS v_strtgc_bus_dvsn_dim_id_DCT,\n\t-- *INF*: IIF(isnull(v_strtgc_bus_dvsn_dim_id_DCT),-1,v_strtgc_bus_dvsn_dim_id_DCT)\n\tIFF(v_strtgc_bus_dvsn_dim_id_DCT IS NULL, - 1, v_strtgc_bus_dvsn_dim_id_DCT) AS v_strtgc_bus_dvsn_dim_id_DCT_out,\n\t-- *INF*: IIF(pol_sym = '000',v_strtgc_bus_dvsn_dim_id_DCT_out,strtgc_bus_dvsn_dim_id)\n\tIFF(pol_sym = '000', v_strtgc_bus_dvsn_dim_id_DCT_out, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_out,\n\t-- *INF*: :LKP.LKP_INSURANCEREFERENCEDIM(StrategicProfitCenterCode,InsuranceSegmentCode,PolicyOfferingCode,ProductCode,InsuranceReferenceLineOfBusinessCode, v_RatingPlanCode)\n\tLKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceReferenceDimId AS v_InsuranceReferenceDimId,\n\t-- *INF*: iif(isnull(v_InsuranceReferenceDimId),-1,v_InsuranceReferenceDimId)\n\tIFF(v_InsuranceReferenceDimId IS NULL, - 1, v_InsuranceReferenceDimId) AS v_InsuranceReferenceDimId_out,\n\tv_InsuranceReferenceDimId_out AS InsuranceReferenceDimId,\n\tmplt_Claim_occurrence_COD.AgencyDimID AS AgencyDimId,\n\t-- *INF*: iif(isnull(AgencyDimId),-1,AgencyDimId)\n\tIFF(AgencyDimId IS NULL, - 1, AgencyDimId) AS AgencyDimId_out,\n\tSYSDATE AS ModifiedDate\n\tFROM mplt_Claim_occurrence_COD\n\t -- Manually join with mplt_Strategic_Business_Division_Dim\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS\n\tON LKP_CALENDAR_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_date = TO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDAR_DIM LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDAR_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_STRATEGIC_BUSINESS_DIVISION_DIM LKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode\n\tON LKP_STRATEGIC_BUSINESS_DIVISION_DIM_StrategicProfitCenterCode.strtgc_bus_dvsn_code = StrategicProfitCenterCode\n\n\tLEFT JOIN LKP_INSURANCEREFERENCEDIM LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode\n\tON LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.StrategicProfitCenterCode = StrategicProfitCenterCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceSegmentCode = InsuranceSegmentCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.PolicyOfferingCode = PolicyOfferingCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.ProductCode = ProductCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.InsuranceReferenceLineOfBusinessCode = InsuranceReferenceLineOfBusinessCode\n\tAND LKP_INSURANCEREFERENCEDIM_StrategicProfitCenterCode_InsuranceSegmentCode_PolicyOfferingCode_ProductCode_InsuranceReferenceLineOfBusinessCode_v_RatingPlanCode.RatingPlanCode = v_RatingPlanCode\n\n),\nclaim_loss_transaction_fact_dummy_Claim_Occurrence_row AS (\n\tINSERT INTO claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\tERR_FLAG, \n\tdefault_audit_id AS AUDIT_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_TRANS_PK_ID, \n\tout_edw_claim_trans_pk_id AS EDW_CLAIM_REINS_TRANS_PK_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaim_occurrence_dim_id_OUT AS CLAIM_OCCURRENCE_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIMANT_DIM_ID, \n\tdefault_dim_id AS CLAIMANT_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIMANT_COV_DIM_ID, \n\tdefault_dim_id AS CLAIMANT_COV_DIM_HIST_ID, \n\tdefault_dim_id AS COV_DIM_ID, \n\tdefault_dim_id AS COV_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_TRANS_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_ID, \n\tdefault_dim_id AS REINS_COV_DIM_HIST_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tclaim_rep_dim_prim_claim_rep_id_OUT AS CLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_examiner_id_OUT AS CLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_OUT AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tCLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tclaim_rep_dim_trans_entry_oper_id AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tclaim_created_by_id_OUT AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_ID, \n\tpol_key_dim_id_OUT AS POL_DIM_HIST_ID, \n\tagency_dim_id_OUT AS AGENCY_DIM_ID, \n\tdefault_dim_id AS AGENCY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tdefault_dim_id AS CLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_CASE_DIM_ID, \n\tdefault_dim_id AS CLAIM_CASE_DIM_HIST_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_HIST_ID, \n\tdefault_dim_id AS CLAIM_MASTER_1099_LIST_DIM_ID, \n\tdefault_dim_id AS CLAIM_SUBROGATION_DIM_ID, \n\tDefault_date_id AS CLAIM_TRANS_DATE_ID, \n\tDefault_date_id AS CLAIM_TRANS_REPROCESS_DATE_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tclaim_occurrence_rpted_date_id AS CLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tDefault_date_id AS CLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tDefault_date_id AS ACCT_ENTERED_DATE_ID, \n\tdefault_amt AS TRANS_AMT, \n\tdefault_amt AS TRANS_HIST_AMT, \n\tdefault_audit_id AS TAX_ID, \n\tdefault_amt AS DIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tdefault_amt AS DIRECT_SUBROGATION_PAID, \n\tdefault_amt AS DIRECT_SUBROGATION_OUTSTANDING, \n\tdefault_amt AS DIRECT_SUBROGATION_INCURRED, \n\tdefault_amt AS DIRECT_SALVAGE_PAID, \n\tdefault_amt AS DIRECT_SALVAGE_OUTSTANDING, \n\tdefault_amt AS DIRECT_SALVAGE_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tdefault_amt AS TOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_PAID, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tdefault_amt AS DIRECT_OTHER_RECOVERY_INCURRED, \n\tdefault_amt AS CEDED_LOSS_PAID, \n\tdefault_amt AS CEDED_LOSS_OUTSTANDING, \n\tdefault_amt AS CEDED_LOSS_INCURRED, \n\tdefault_amt AS CEDED_ALAE_PAID, \n\tdefault_amt AS CEDED_ALAE_OUTSTANDING, \n\tdefault_amt AS CEDED_ALAE_INCURRED, \n\tdefault_amt AS CEDED_SALVAGE_PAID, \n\tdefault_amt AS CEDED_SUBROGATION_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_LOSS_PAID, \n\tdefault_amt AS CEDED_OTHER_RECOVERY_ALAE_PAID, \n\tdefault_amt AS TOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tdefault_amt AS NET_LOSS_PAID, \n\tdefault_amt AS NET_LOSS_OUTSTANDING, \n\tdefault_amt AS NET_LOSS_INCURRED, \n\tdefault_amt AS NET_ALAE_PAID, \n\tdefault_amt AS NET_ALAE_OUTSTANDING, \n\tdefault_amt AS NET_ALAE_INCURRED, \n\tdefault_dim_id AS ASL_DIM_ID, \n\tdefault_dim_id AS ASL_PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS LOSS_MASTER_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id_out AS STRTGC_BUS_DVSN_DIM_ID, \n\tdefault_dim_id AS PRDCT_CODE_DIM_ID, \n\tdefault_dim_id AS CLAIMRESERVEDIMID, \n\tdefault_dim_id AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tDefault_date_id AS FEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tINSURANCEREFERENCEDIMID, \n\tAgencyDimId_out AS AGENCYDIMID, \n\tdefault_dim_id AS SALESDIVISIONDIMID, \n\tdefault_dim_id AS INSURANCEREFERENCECOVERAGEDIMID, \n\tdefault_dim_id AS COVERAGEDETAILDIMID, \n\tMODIFIEDDATE\n\tFROM EXP_get_Dim_Ids\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Claims DataMart/"
        },
        "annotations": []
    }
}