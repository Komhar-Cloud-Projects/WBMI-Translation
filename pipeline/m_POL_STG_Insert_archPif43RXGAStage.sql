WITH
SQ_Pif43RXGAStage AS (
	SELECT
		Pif43RXGAStageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		PMDRXA1SegmentId,
		PMDRXA1SegmentStatus,
		PMDRXA1YearTransaction,
		PMDRXA1MonthTransaction,
		PMDRXA1DayTransaction,
		PMDRXA1SegmentLevelCode,
		PMDRXA1SegmentPartCode,
		PMDRXA1SubPartCode,
		PMDRXA1InsuranceLine,
		PMDRXA1LocationNumber,
		PMDRXA1Coverage,
		PMDRXA1Sequence,
		PMDRXA1YearItemEffective,
		PMDRXA1MonthItemEffective,
		PMDRXA1DayItemEffective,
		PMDRXA1YearProcess,
		PMDRXA1MonthProcess,
		PMDRXA1DayProcess,
		PMDRXA1PmsUsage,
		PMDRXA1LimitAgg,
		PMDRXA1Deductible,
		PMDRXA1Sym1stTwo,
		PMDRXA1Sym2ndTwo,
		PMDRXA1Sym3rdTwo,
		PMDRXA1ExperMod,
		PMDRXA1ScheduleMod,
		PMDRXA1ExpenseMod,
		PMDRXA1OtherMod,
		PMDRXA1PkgMod,
		PMDRXA1ComRedMod,
		PMDRXA1DecChangeFlag,
		PMDRXA1ConvertedTerr,
		PMDRXA1TerrManualOverride,
		PMDRXA1MultipleTerritories,
		PMDRXA1CustomerFutureUse,
		PMDRXA1Yr2000CustUse
	FROM Pif43RXGAStage
),
EXP_Pif43RXGAStage AS (
	SELECT
	Pif43RXGAStageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	PMDRXA1SegmentId,
	PMDRXA1SegmentStatus,
	PMDRXA1YearTransaction,
	PMDRXA1MonthTransaction,
	PMDRXA1DayTransaction,
	PMDRXA1SegmentLevelCode,
	PMDRXA1SegmentPartCode,
	PMDRXA1SubPartCode,
	PMDRXA1InsuranceLine,
	PMDRXA1LocationNumber,
	PMDRXA1Coverage,
	PMDRXA1Sequence,
	PMDRXA1YearItemEffective,
	PMDRXA1MonthItemEffective,
	PMDRXA1DayItemEffective,
	PMDRXA1YearProcess,
	PMDRXA1MonthProcess,
	PMDRXA1DayProcess,
	PMDRXA1PmsUsage,
	PMDRXA1LimitAgg,
	PMDRXA1Deductible,
	PMDRXA1Sym1stTwo,
	PMDRXA1Sym2ndTwo,
	PMDRXA1Sym3rdTwo,
	PMDRXA1ExperMod,
	PMDRXA1ScheduleMod,
	PMDRXA1ExpenseMod,
	PMDRXA1OtherMod,
	PMDRXA1PkgMod,
	PMDRXA1ComRedMod,
	PMDRXA1DecChangeFlag,
	PMDRXA1ConvertedTerr,
	PMDRXA1TerrManualOverride,
	PMDRXA1MultipleTerritories,
	PMDRXA1CustomerFutureUse,
	PMDRXA1Yr2000CustUse,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif43RXGAStage
),
ArchPif43RXGAStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43RXGAStage
	(ExtractDate, SourceSystemid, AuditId, PifSymbol, PifPolicyNumber, PifModule, PMDRXA1SegmentId, PMDRXA1SegmentStatus, PMDRXA1YearTransaction, PMDRXA1MonthTransaction, PMDRXA1DayTransaction, PMDRXA1SegmentLevelCode, PMDRXA1SegmentPartCode, PMDRXA1SubPartCode, PMDRXA1InsuranceLine, PMDRXA1LocationNumber, PMDRXA1Coverage, PMDRXA1Sequence, PMDRXA1YearItemEffective, PMDRXA1MonthItemEffective, PMDRXA1DayItemEffective, PMDRXA1YearProcess, PMDRXA1MonthProcess, PMDRXA1DayProcess, PMDRXA1PmsUsage, PMDRXA1LimitAgg, PMDRXA1Deductible, PMDRXA1Sym1stTwo, PMDRXA1Sym2ndTwo, PMDRXA1Sym3rdTwo, PMDRXA1ExperMod, PMDRXA1ScheduleMod, PMDRXA1ExpenseMod, PMDRXA1OtherMod, PMDRXA1PkgMod, PMDRXA1ComRedMod, PMDRXA1DecChangeFlag, PMDRXA1ConvertedTerr, PMDRXA1TerrManualOverride, PMDRXA1MultipleTerritories, PMDRXA1CustomerFutureUse, PMDRXA1Yr2000CustUse)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_audit_id AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDRXA1SEGMENTID, 
	PMDRXA1SEGMENTSTATUS, 
	PMDRXA1YEARTRANSACTION, 
	PMDRXA1MONTHTRANSACTION, 
	PMDRXA1DAYTRANSACTION, 
	PMDRXA1SEGMENTLEVELCODE, 
	PMDRXA1SEGMENTPARTCODE, 
	PMDRXA1SUBPARTCODE, 
	PMDRXA1INSURANCELINE, 
	PMDRXA1LOCATIONNUMBER, 
	PMDRXA1COVERAGE, 
	PMDRXA1SEQUENCE, 
	PMDRXA1YEARITEMEFFECTIVE, 
	PMDRXA1MONTHITEMEFFECTIVE, 
	PMDRXA1DAYITEMEFFECTIVE, 
	PMDRXA1YEARPROCESS, 
	PMDRXA1MONTHPROCESS, 
	PMDRXA1DAYPROCESS, 
	PMDRXA1PMSUSAGE, 
	PMDRXA1LIMITAGG, 
	PMDRXA1DEDUCTIBLE, 
	PMDRXA1SYM1STTWO, 
	PMDRXA1SYM2NDTWO, 
	PMDRXA1SYM3RDTWO, 
	PMDRXA1EXPERMOD, 
	PMDRXA1SCHEDULEMOD, 
	PMDRXA1EXPENSEMOD, 
	PMDRXA1OTHERMOD, 
	PMDRXA1PKGMOD, 
	PMDRXA1COMREDMOD, 
	PMDRXA1DECCHANGEFLAG, 
	PMDRXA1CONVERTEDTERR, 
	PMDRXA1TERRMANUALOVERRIDE, 
	PMDRXA1MULTIPLETERRITORIES, 
	PMDRXA1CUSTOMERFUTUREUSE, 
	PMDRXA1YR2000CUSTUSE
	FROM EXP_Pif43RXGAStage
),