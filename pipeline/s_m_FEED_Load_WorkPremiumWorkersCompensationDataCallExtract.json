{
    "name": "s_m_FEED_Load_WorkPremiumWorkersCompensationDataCallExtract",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_WorkPremiumWorkersCompensationDataCallEx_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_EarnedPremiumTransactionMonthlyFact AS (\n\tSELECT EarnedPremiumTransactionMonthlyFact.EarnedPremiumTransactionMonthlyFactID, \r\n\tEarnedPremiumTransactionMonthlyFact.MonthlyChangeinDirectEarnedPremium, \r\n\tEarnedPremiumTransactionMonthlyFact.EDWEarnedPremiumMonthlyCalculationPKID, \r\n\tcalendar_dim_PremiumTransactionRunDate.CalendarEndOfMonthDate, \r\n\tcalendar_dim_PremiumTransactionBookedDate.clndr_date,\r\n\tCoverageDetailWorkersCompensationDim.CoverageDetailDimId, \r\n\tpolicy_dim.edw_pol_ak_id, \r\n\tpolicy_dim.pol_key, \r\n\tpolicy_dim.pol_eff_date, \r\n\tpolicy_dim.pol_exp_date, \r\n\tLTRIM(RTRIM(CoverageDetailWorkersCompensationDim.NcciClassCode)) AS NcciClassCode, \r\n\tRiskLocationDim.StateProvinceCode, \r\n\tRiskLocationDim.StateProvinceCodeAbbreviation, \r\n\tInsuranceReferenceDim.InsuranceSegmentDescription, \r\n\tInsuranceReferenceDim.PolicyOfferingDescription, \r\n\tPremiumTransactionTypeDim.PremiumTypeCode, \r\n\tCoverageDetailDim.BaseRate, \r\n\tCoverageDetailWorkersCompensationDim.ConsentToRateFlag, \r\n\tCoverageDetailWorkersCompensationDim.RateOverride, \r\n\tInsuranceReferenceDim.StrategicProfitCenterAbbreviation,\r\n\tInsuranceReferenceCoverageDim.DctCoverageTypeCode\r\n\tFROM EarnedPremiumTransactionMonthlyFact, \r\n\tCoverageDetailDim, \r\n\tCoverageDetailWorkersCompensationDim, \r\n\tcalendar_dim calendar_dim_PremiumTransactionRunDate, \r\n\tcalendar_dim calendar_dim_PremiumTransactionBookedDate, \r\n\tpolicy_dim, \r\n\tRiskLocationDim, \r\n\tInsuranceReferenceDim, \r\n\tPremiumTransactionTypeDim,\r\n\tInsuranceReferenceCoverageDim\r\n\tWHERE ((@{pipeline().parameters.RUN_YEAR} != 0\r\n\tAND calendar_dim_PremiumTransactionRunDate.clndr_yr <= @{pipeline().parameters.RUN_YEAR}\r\n\tAND CONVERT(CHAR(4), policy_dim.pol_eff_date, 120) <= @{pipeline().parameters.RUN_YEAR} \r\n\tAND CONVERT(CHAR(4), policy_dim.pol_eff_date, 120) > @{pipeline().parameters.RUN_YEAR} - 5)\r\n\tOR\r\n\t(@{pipeline().parameters.RUN_YEAR} = 0 \r\n\tAND calendar_dim_PremiumTransactionRunDate.clndr_yr <=CONVERT(CHAR(4), GETDATE(), 120) - 1\r\n\tAND CONVERT(CHAR(4), policy_dim.pol_eff_date, 120) <= CONVERT(CHAR(4), GETDATE(), 120) - 1\r\n\tAND CONVERT(CHAR(4), policy_dim.pol_eff_date, 120) >CONVERT(CHAR(4), GETDATE(), 120) - 6\r\n\t))\r\n\tAND PremiumTransactionTypeDim.PremiumTypeCode = 'D'\r\n\tAND CoverageDetailWorkersCompensationDim.NcciClassCode NOT IN ('9740','9741','9752')\r\n\tAND EarnedPremiumTransactionMonthlyFact.CoverageDetailDimId = CoverageDetailDim.CoverageDetailDimId\r\n\tAND EarnedPremiumTransactionMonthlyFact.CoverageDetailDimId = CoverageDetailWorkersCompensationDim.CoverageDetailDimId\r\n\tAND EarnedPremiumTransactionMonthlyFact.PolicyDimID = policy_dim.pol_dim_id\r\n\tAND EarnedPremiumTransactionMonthlyFact.RiskLocationDimID = RiskLocationDim.RiskLocationDimID\r\n\tAND EarnedPremiumTransactionMonthlyFact.PremiumTransactionTypeDimID = PremiumTransactionTypeDim.PremiumTransactionTypeDimID\r\n\tAND EarnedPremiumTransactionMonthlyFact.InsuranceReferenceDimId = InsuranceReferenceDim.InsuranceReferenceDimId\r\n\tAND EarnedPremiumTransactionMonthlyFact.PremiumTransactionBookedDateID = calendar_dim_PremiumTransactionBookedDate.clndr_id\r\n\tAND EarnedPremiumTransactionMonthlyFact.PremiumTransactionRunDateID = calendar_dim_PremiumTransactionRunDate.clndr_id\r\n\tAND EarnedPremiumTransactionMonthlyFact.InsuranceReferenceCoverageDimId =   InsuranceReferenceCoverageDim.InsuranceReferenceCoverageDimId\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nLKP_SupWorkersCompensationPremiumAdjustmentFactor AS (\n\tSELECT\n\tEffectiveDate,\n\tWorkersCompensationPremiumAdjustmentFactor,\n\tWorkersCompensationPremiumAdjustmentType,\n\tStateCode,\n\tExpirationDate\n\tFROM (\n\t\tSELECT \n\t\t\tEffectiveDate,\n\t\t\tWorkersCompensationPremiumAdjustmentFactor,\n\t\t\tWorkersCompensationPremiumAdjustmentType,\n\t\t\tStateCode,\n\t\t\tExpirationDate\n\t\tFROM SupWorkersCompensationPremiumAdjustmentFactor\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StateCode,EffectiveDate,ExpirationDate ORDER BY EffectiveDate) = 1\n),\nEXP_STAGE AS (\n\tSELECT\n\tSQ_EarnedPremiumTransactionMonthlyFact.EarnedPremiumTransactionMonthlyFactID,\n\tSQ_EarnedPremiumTransactionMonthlyFact.MonthlyChangeinDirectEarnedPremium,\n\tSQ_EarnedPremiumTransactionMonthlyFact.EDWEarnedPremiumMonthlyCalculationPKID,\n\tSQ_EarnedPremiumTransactionMonthlyFact.CalendarEndOfMonthDate AS EarnedPremiumTransactionRundate_CalendarEndOfMonthDate,\n\tSQ_EarnedPremiumTransactionMonthlyFact.clndr_date AS EarnedPremiumTransactionBookeddate_clndr_date,\n\tSQ_EarnedPremiumTransactionMonthlyFact.CoverageDetailDimId,\n\tSQ_EarnedPremiumTransactionMonthlyFact.edw_pol_ak_id,\n\tSQ_EarnedPremiumTransactionMonthlyFact.pol_key,\n\tSQ_EarnedPremiumTransactionMonthlyFact.pol_eff_date,\n\tSQ_EarnedPremiumTransactionMonthlyFact.pol_exp_date,\n\tSQ_EarnedPremiumTransactionMonthlyFact.NcciClassCode,\n\tSQ_EarnedPremiumTransactionMonthlyFact.StateProvinceCode,\n\tSQ_EarnedPremiumTransactionMonthlyFact.StateProvinceCodeAbbreviation,\n\tSQ_EarnedPremiumTransactionMonthlyFact.InsuranceSegmentDescription,\n\tSQ_EarnedPremiumTransactionMonthlyFact.PolicyOfferingDescription,\n\tSQ_EarnedPremiumTransactionMonthlyFact.PremiumTypeCode,\n\tSQ_EarnedPremiumTransactionMonthlyFact.BaseRate,\n\tLKP_SupWorkersCompensationPremiumAdjustmentFactor.EffectiveDate AS i_WorkersCompensationPremiumAdjustmentFactorEffectiveDate,\n\t-- *INF*: IIF(ISNULL(i_WorkersCompensationPremiumAdjustmentFactorEffectiveDate) AND IN(StateProvinceCodeAbbreviation, 'IA', 'KS', 'MI', 'MN', 'MO','NE'),ERROR('WorkersCompensationPremiumAdjustmentFactor not found for state=' || StateProvinceCodeAbbreviation || ' and policy_eff_date=' || TO_CHAR(pol_eff_date) ), i_WorkersCompensationPremiumAdjustmentFactorEffectiveDate)\n\tIFF(\n\t    i_WorkersCompensationPremiumAdjustmentFactorEffectiveDate IS NULL\n\t    and StateProvinceCodeAbbreviation IN ('IA','KS','MI','MN','MO','NE'),\n\t    ERROR('WorkersCompensationPremiumAdjustmentFactor not found for state=' || StateProvinceCodeAbbreviation || '\n\t    and policy_eff_date=' || TO_CHAR(pol_eff_date)),\n\t    i_WorkersCompensationPremiumAdjustmentFactorEffectiveDate\n\t) AS o_WorkersCompensationPremiumAdjustmentFactorEffectiveDate,\n\tLKP_SupWorkersCompensationPremiumAdjustmentFactor.WorkersCompensationPremiumAdjustmentFactor,\n\tLKP_SupWorkersCompensationPremiumAdjustmentFactor.WorkersCompensationPremiumAdjustmentType,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(StateProvinceCodeAbbreviation,'ND','OH','WA','WY'),'N/A',\r\n\t-- IN(StateProvinceCodeAbbreviation, \r\n\t-- 'AL','AK','AR',\r\n\t-- 'CA','CO','CT',\r\n\t-- 'DC','DE',\r\n\t-- 'GA',\r\n\t-- 'HI',\r\n\t-- 'KS','KY',\r\n\t-- 'LA',\r\n\t-- 'MD','ME','MI','MN','MO','MS','MT',\r\n\t-- 'NC','NE','NH','NM','NV','NY',\r\n\t-- 'OK','OR',\r\n\t-- 'PA',\r\n\t-- 'RI',\r\n\t-- 'SC','SD',\r\n\t-- 'TN','TX',\r\n\t-- 'UT',\r\n\t-- 'VA','VT',\r\n\t-- 'WV'\r\n\t-- ),  'LossCostState',\r\n\t-- IN(StateProvinceCodeAbbreviation, 'AZ','FL','IA','ID','IL','IN', 'MA', 'NJ', 'WI'),  'RatingState',\r\n\t-- 'N/A')\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    StateProvinceCodeAbbreviation IN ('ND','OH','WA','WY'), 'N/A',\n\t    StateProvinceCodeAbbreviation IN ('AL','AK','AR','CA','CO','CT','DC','DE','GA','HI','KS','KY','LA','MD','ME','MI','MN','MO','MS','MT','NC','NE','NH','NM','NV','NY','OK','OR','PA','RI','SC','SD','TN','TX','UT','VA','VT','WV'), 'LossCostState',\n\t    StateProvinceCodeAbbreviation IN ('AZ','FL','IA','ID','IL','IN','MA','NJ','WI'), 'RatingState',\n\t    'N/A'\n\t) AS v_StateType,\n\tSQ_EarnedPremiumTransactionMonthlyFact.ConsentToRateFlag AS i_ConsentToRateFlag,\n\t-- *INF*: DECODE(i_ConsentToRateFlag,'T','1','F','0')\n\tDECODE(\n\t    i_ConsentToRateFlag,\n\t    'T', '1',\n\t    'F', '0'\n\t) AS o_ConsentToRateFlag,\n\tSQ_EarnedPremiumTransactionMonthlyFact.RateOverride,\n\tSQ_EarnedPremiumTransactionMonthlyFact.StrategicProfitCenterAbbreviation,\n\tSQ_EarnedPremiumTransactionMonthlyFact.DctCoverageTypeCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- StateProvinceCodeAbbreviation='IA' and pol_eff_date>=TO_DATE('20100101','YYYYMMDD'),0.95,\r\n\t-- StateProvinceCodeAbbreviation='IA' and pol_eff_date>=TO_DATE('20010501','YYYYMMDD'),0.9,\r\n\t-- StateProvinceCodeAbbreviation='IA' and pol_eff_date<TO_DATE('20010501','YYYYMMDD'),0.85,\r\n\t-- 1\r\n\t-- )\r\n\t-- ---INC0020661 - APPLY NEWLY APPLICABLE RATE OF 0.95 EFFECTIVE 1/1/2010 FOR DSR\n\tDECODE(\n\t    TRUE,\n\t    StateProvinceCodeAbbreviation = 'IA' and pol_eff_date >= TO_TIMESTAMP('20100101', 'YYYYMMDD'), 0.95,\n\t    StateProvinceCodeAbbreviation = 'IA' and pol_eff_date >= TO_TIMESTAMP('20010501', 'YYYYMMDD'), 0.9,\n\t    StateProvinceCodeAbbreviation = 'IA' and pol_eff_date < TO_TIMESTAMP('20010501', 'YYYYMMDD'), 0.85,\n\t    1\n\t) AS v_Deviation,\n\tv_StateType AS o_StateType,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_StateType = 'RatingState' AND IN(NcciClassCode, '9658', '9659'), 0.00,\r\n\t-- v_StateType = 'RatingState' AND IN(NcciClassCode,\r\n\t-- '9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679',\r\n\t-- '9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788',\r\n\t-- '9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878',\r\n\t-- '9900', '9901','9902','9903', '9904', '9905', '9906','9907','9908','9909',\r\n\t-- '9910','9911','9912','9913','9914','9915', '9916', '9917', '9918', '9919', \r\n\t-- '9920','9924','9925','9926','9927','9928','9929',\r\n\t-- '9930','9931', '9932','9933','9934','9935','9936','9937','9938','9939',\r\n\t-- '9940', '9941', '9942', '9943', '9944', '9945', '9946','9947','9948','9949',\r\n\t-- '9950','9951','9952','9953','9954','9955','9956','9957','9958','9959',\r\n\t-- '9960','9961','9962','9963','9964','9965','9966','9967','9968','9969',\r\n\t-- '9970','9971','9972','9973','9974','9975','9976','9978','9979',\r\n\t-- '9980','9982','9983','9986','9987','9988'\r\n\t-- ), 0.00,\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0063','0064'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9887','9889','9750','9751'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0931'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9721','9723','9722','9724','9655','9656'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0174'),0.00,   --included for PMS policies\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9890'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9604'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9757','9776'),0.00,\t\t\r\n\t-- v_StateType='RatingState' AND DctCoverageTypeCode='RetrospectiveCalculation',0.00,\r\n\t-- v_StateType='LossCostState',0,\t\t\t\r\n\t-- MonthlyChangeinDirectEarnedPremium)\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9658','9659'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679','9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788','9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878','9900','9901','9902','9903','9904','9905','9906','9907','9908','9909','9910','9911','9912','9913','9914','9915','9916','9917','9918','9919','9920','9924','9925','9926','9927','9928','9929','9930','9931','9932','9933','9934','9935','9936','9937','9938','9939','9940','9941','9942','9943','9944','9945','9946','9947','9948','9949','9950','9951','9952','9953','9954','9955','9956','9957','9958','9959','9960','9961','9962','9963','9964','9965','9966','9967','9968','9969','9970','9971','9972','9973','9974','9975','9976','9978','9979','9980','9982','9983','9986','9987','9988'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0063','0064'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9887','9889','9750','9751'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0931'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9721','9723','9722','9724','9655','9656'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0174'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9890'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9604'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9757','9776'), 0.00,\n\t    v_StateType = 'RatingState' AND DctCoverageTypeCode = 'RetrospectiveCalculation', 0.00,\n\t    v_StateType = 'LossCostState', 0,\n\t    MonthlyChangeinDirectEarnedPremium\n\t) AS o_RatingCompanyLevel,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_StateType = 'RatingState' AND IN(NcciClassCode, '9658', '9659'), 0.00,\r\n\t-- v_StateType = 'RatingState' AND IN(NcciClassCode,\r\n\t-- '9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679',\r\n\t-- '9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788',\r\n\t-- '9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878',\r\n\t-- '9900', '9901','9902','9903', '9904', '9905', '9906','9907','9908','9909',\r\n\t-- '9910','9911','9912','9913','9914','9915', '9916', '9917', '9918', '9919', \r\n\t-- '9920','9924','9925','9926','9927','9928','9929',\r\n\t-- '9930','9931', '9932','9933','9934','9935','9936','9937','9938','9939',\r\n\t-- '9940', '9941', '9942', '9943', '9944', '9945', '9946','9947','9948','9949',\r\n\t-- '9950','9951','9952','9953','9954','9955','9956','9957','9958','9959',\r\n\t-- '9960','9961','9962','9963','9964','9965','9966','9967','9968','9969',\r\n\t-- '9970','9971','9972','9973','9974','9975','9976','9978','9979',\r\n\t-- '9980','9982','9983','9986','9987','9988'\r\n\t-- ), 0.00,\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0063','0064'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9887','9889','9750','9751','0887'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0931'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9721','9723','9722','9724','9655','9656'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0174'),0.00,   --included for PMS policies\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0021','0022','0023','0032','0043'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9890'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9604'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9757','9776'),0.00,\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'9034','9036','9037','9039'),0.00,\r\n\t-- v_StateType='RatingState' AND DctCoverageTypeCode='RetrospectiveCalculation',0.00,\t\t\t\r\n\t-- v_StateType='LossCostState',0,\t\t\t\r\n\t-- MonthlyChangeinDirectEarnedPremium/v_Deviation)\n\tDECODE(\n\t    TRUE,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9658','9659'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679','9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788','9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878','9900','9901','9902','9903','9904','9905','9906','9907','9908','9909','9910','9911','9912','9913','9914','9915','9916','9917','9918','9919','9920','9924','9925','9926','9927','9928','9929','9930','9931','9932','9933','9934','9935','9936','9937','9938','9939','9940','9941','9942','9943','9944','9945','9946','9947','9948','9949','9950','9951','9952','9953','9954','9955','9956','9957','9958','9959','9960','9961','9962','9963','9964','9965','9966','9967','9968','9969','9970','9971','9972','9973','9974','9975','9976','9978','9979','9980','9982','9983','9986','9987','9988'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0063','0064'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9887','9889','9750','9751','0887'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0931'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9721','9723','9722','9724','9655','9656'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0174'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0021','0022','0023','0032','0043'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9890'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9604'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9757','9776'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('9034','9036','9037','9039'), 0.00,\n\t    v_StateType = 'RatingState' AND DctCoverageTypeCode = 'RetrospectiveCalculation', 0.00,\n\t    v_StateType = 'LossCostState', 0,\n\t    MonthlyChangeinDirectEarnedPremium / v_Deviation\n\t) AS o_RatingDSRLevel,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9658','9659'),0.00,\r\n\t-- v_StateType = 'LossCostState' AND IN(NcciClassCode,\r\n\t-- '9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679',\r\n\t-- '9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788',\r\n\t-- '9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878',\r\n\t-- '9900', '9901','9902','9903', '9904', '9905', '9906','9907','9908','9909',\r\n\t-- '9910','9911','9912','9913','9914','9915', '9916', '9917', '9918', '9919', \r\n\t-- '9920','9924','9925','9926','9927','9928','9929',\r\n\t-- '9930','9931', '9932','9933','9934','9935','9936','9937','9938','9939',\r\n\t-- '9940', '9941', '9942', '9943', '9944', '9945', '9946','9947','9948','9949',\r\n\t-- '9950','9951','9952','9953','9954','9955','9956','9957','9958','9959',\r\n\t-- '9960','9961','9962','9963','9964','9965','9966','9967','9968','9969',\r\n\t-- '9970','9971','9972','9973','9974','9975','9976','9978','9979',\r\n\t-- '9980','9982','9983','9986','9987','9988'\r\n\t-- ), 0.00,\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0063','0064'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9887','9889','9750','9751','0887'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0931'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9721','9723','9722','9724','9655','9656'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0174'),0.00,   --included for PMS policies\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0277','0278'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9890','9880'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9604'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9757','9776'),0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9611','9612','9613'),0.00,\t\t\t\r\n\t-- v_StateType='LossCostState' AND DctCoverageTypeCode='RetrospectiveCalculation',0.00,\t\t\t\r\n\t-- v_StateType='RatingState',0,\r\n\t-- MonthlyChangeinDirectEarnedPremium)\n\tDECODE(\n\t    TRUE,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9658','9659'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679','9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788','9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878','9900','9901','9902','9903','9904','9905','9906','9907','9908','9909','9910','9911','9912','9913','9914','9915','9916','9917','9918','9919','9920','9924','9925','9926','9927','9928','9929','9930','9931','9932','9933','9934','9935','9936','9937','9938','9939','9940','9941','9942','9943','9944','9945','9946','9947','9948','9949','9950','9951','9952','9953','9954','9955','9956','9957','9958','9959','9960','9961','9962','9963','9964','9965','9966','9967','9968','9969','9970','9971','9972','9973','9974','9975','9976','9978','9979','9980','9982','9983','9986','9987','9988'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0063','0064'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9887','9889','9750','9751','0887'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0931'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9721','9723','9722','9724','9655','9656'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0174'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0277','0278'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9890','9880'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9604'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9757','9776'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9611','9612','9613'), 0.00,\n\t    v_StateType = 'LossCostState' AND DctCoverageTypeCode = 'RetrospectiveCalculation', 0.00,\n\t    v_StateType = 'RatingState', 0,\n\t    MonthlyChangeinDirectEarnedPremium\n\t) AS o_LossCostCompanyLevel,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0900','0090','9114','9120'),0.00,\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9658','9659'),0.00,\t\r\n\t-- v_StateType = 'LossCostState' AND IN(NcciClassCode,\r\n\t-- '9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679',\r\n\t-- '9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788',\r\n\t-- '9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878',\r\n\t-- '9900', '9901','9902','9903', '9904', '9905', '9906','9907','9908','9909',\r\n\t-- '9910','9911','9912','9913','9914','9915', '9916', '9917', '9918', '9919', \r\n\t-- '9920','9924','9925','9926','9927','9928','9929',\r\n\t-- '9930','9931', '9932','9933','9934','9935','9936','9937','9938','9939',\r\n\t-- '9940', '9941', '9942', '9943', '9944', '9945', '9946','9947','9948','9949',\r\n\t-- '9950','9951','9952','9953','9954','9955','9956','9957','9958','9959',\r\n\t-- '9960','9961','9962','9963','9964','9965','9966','9967','9968','9969',\r\n\t-- '9970','9971','9972','9973','9974','9975','9976','9978','9979',\r\n\t-- '9980','9982','9983','9986','9987','9988'\r\n\t-- ), 0.00,\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0063','0064'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9887','9889','9750','9751'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0931'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9721','9723','9722','9724','9655','9656'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='RatingState' AND IN(NcciClassCode,'0174'),0.00,   --included for PMS policies\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0277','0278'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0990','9125','9615','9848','9849'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'0021','0022','0023','0032','0043','9132'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9890','9880'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9604'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9757','9776'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9611','9612','9613'),0.00,\t\t\t\t\t\t\t\r\n\t-- v_StateType='LossCostState' AND IN(NcciClassCode,'9034','9035','9036','9037','9039'),0.00,\t\t\r\n\t-- v_StateType='LossCostState' AND DctCoverageTypeCode='RetrospectiveCalculation',0.00,\t\t\t\t\t\t\r\n\t-- v_StateType='RatingState',0,\r\n\t-- MonthlyChangeinDirectEarnedPremium)\n\tDECODE(\n\t    TRUE,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0900','0090','9114','9120'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9658','9659'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9657','9663','9664','9667','9668','9669','9670','9671','9672','9673','9674','9675','9676','9677','9678','9679','9758','9759','9760','9761','9762','9763','9764','9770','9771','9772','9773','9780','9781','9784','9785','9786','9787','9788','9801','9853','9854','9855','9856','9857','9858','9859','9860','9861','9862','9863','9864','9865','9866','9867','9868','9869','9878','9900','9901','9902','9903','9904','9905','9906','9907','9908','9909','9910','9911','9912','9913','9914','9915','9916','9917','9918','9919','9920','9924','9925','9926','9927','9928','9929','9930','9931','9932','9933','9934','9935','9936','9937','9938','9939','9940','9941','9942','9943','9944','9945','9946','9947','9948','9949','9950','9951','9952','9953','9954','9955','9956','9957','9958','9959','9960','9961','9962','9963','9964','9965','9966','9967','9968','9969','9970','9971','9972','9973','9974','9975','9976','9978','9979','9980','9982','9983','9986','9987','9988'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0063','0064'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9887','9889','9750','9751'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0931'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9721','9723','9722','9724','9655','9656'), 0.00,\n\t    v_StateType = 'RatingState' AND NcciClassCode IN ('0174'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0277','0278'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0990','9125','9615','9848','9849'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('0021','0022','0023','0032','0043','9132'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9890','9880'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9604'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9757','9776'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9611','9612','9613'), 0.00,\n\t    v_StateType = 'LossCostState' AND NcciClassCode IN ('9034','9035','9036','9037','9039'), 0.00,\n\t    v_StateType = 'LossCostState' AND DctCoverageTypeCode = 'RetrospectiveCalculation', 0.00,\n\t    v_StateType = 'RatingState', 0,\n\t    MonthlyChangeinDirectEarnedPremium\n\t) AS o_LossCostDSRLevel,\n\t-- *INF*: IIF(@{pipeline().parameters.RUN_YEAR} = 0, \r\n\t--        TO_DATE('12/31/'  || TO_CHAR(GET_DATE_PART(SYSDATE, 'YYYY') -1), 'MM/DD/YYYY'), \r\n\t--        TO_DATE('12/31/'  || TO_CHAR(@{pipeline().parameters.RUN_YEAR}), 'MM/DD/YYYY')\r\n\t--       )\n\tIFF(\n\t    @{pipeline().parameters.RUN_YEAR} = 0,\n\t    TO_TIMESTAMP('12/31/' || TO_CHAR(DATE_PART(CURRENT_TIMESTAMP, 'YYYY') - 1), 'MM/DD/YYYY'),\n\t    TO_TIMESTAMP('12/31/' || TO_CHAR(@{pipeline().parameters.RUN_YEAR}), 'MM/DD/YYYY')\n\t) AS o_RunDateYear,\n\tsysdate AS o_CreateDate,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_EarnedPremiumTransactionMonthlyFact\n\tLEFT JOIN LKP_SupWorkersCompensationPremiumAdjustmentFactor\n\tON LKP_SupWorkersCompensationPremiumAdjustmentFactor.StateCode = SQ_EarnedPremiumTransactionMonthlyFact.StateProvinceCode AND LKP_SupWorkersCompensationPremiumAdjustmentFactor.EffectiveDate <= SQ_EarnedPremiumTransactionMonthlyFact.pol_eff_date AND LKP_SupWorkersCompensationPremiumAdjustmentFactor.ExpirationDate >= SQ_EarnedPremiumTransactionMonthlyFact.pol_eff_date\n),\nLKP_WorkPremiumWorkersCompensationDataCallExtract AS (\n\tSELECT\n\tWorkPremiumWorkersCompensationDataCallExtractId,\n\tEDWEarnedPremiumMonthlyCalculationPKID,\n\tRunDate\n\tFROM (\n\t\tSELECT \n\t\t\tWorkPremiumWorkersCompensationDataCallExtractId,\n\t\t\tEDWEarnedPremiumMonthlyCalculationPKID,\n\t\t\tRunDate\n\t\tFROM WorkPremiumWorkersCompensationDataCallExtract\n\t\tWHERE RunDate = CASE WHEN @{pipeline().parameters.RUN_YEAR} =0  then convert(datetime,'12/31/' + cast(convert(char(4), getdate(), 120)-1 as char(4)) ,101)\r\n\t\t                                   ELSE convert(datetime,'12/31/' + cast(@{pipeline().parameters.RUN_YEAR} as char(4)),101)\r\n\t\t                        END\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWEarnedPremiumMonthlyCalculationPKID,RunDate ORDER BY WorkPremiumWorkersCompensationDataCallExtractId) = 1\n),\nRTR_INSERT_UPDATE AS (\n\tSELECT\n\tLKP_WorkPremiumWorkersCompensationDataCallExtract.WorkPremiumWorkersCompensationDataCallExtractId,\n\tEXP_STAGE.EarnedPremiumTransactionMonthlyFactID,\n\tEXP_STAGE.MonthlyChangeinDirectEarnedPremium,\n\tEXP_STAGE.EDWEarnedPremiumMonthlyCalculationPKID,\n\tEXP_STAGE.EarnedPremiumTransactionRundate_CalendarEndOfMonthDate,\n\tEXP_STAGE.EarnedPremiumTransactionBookeddate_clndr_date,\n\tEXP_STAGE.CoverageDetailDimId,\n\tEXP_STAGE.edw_pol_ak_id,\n\tEXP_STAGE.pol_key,\n\tEXP_STAGE.pol_eff_date,\n\tEXP_STAGE.pol_exp_date,\n\tEXP_STAGE.NcciClassCode,\n\tEXP_STAGE.StateProvinceCode,\n\tEXP_STAGE.StateProvinceCodeAbbreviation,\n\tEXP_STAGE.InsuranceSegmentDescription,\n\tEXP_STAGE.PolicyOfferingDescription,\n\tEXP_STAGE.PremiumTypeCode,\n\tEXP_STAGE.BaseRate,\n\tEXP_STAGE.o_WorkersCompensationPremiumAdjustmentFactorEffectiveDate AS WorkersCompensationPremiumAdjustmentFactorEffectiveDate,\n\tEXP_STAGE.WorkersCompensationPremiumAdjustmentFactor,\n\tEXP_STAGE.WorkersCompensationPremiumAdjustmentType,\n\tEXP_STAGE.o_ConsentToRateFlag AS ConsentToRateFlag,\n\tEXP_STAGE.RateOverride,\n\tEXP_STAGE.StrategicProfitCenterAbbreviation,\n\tEXP_STAGE.o_StateType AS StateType,\n\tEXP_STAGE.o_RatingCompanyLevel AS CompanyRatingLevel,\n\tEXP_STAGE.o_RatingDSRLevel AS RatingDSRLevel,\n\tEXP_STAGE.o_LossCostCompanyLevel AS LossCostCompanyLevel,\n\tEXP_STAGE.o_LossCostDSRLevel AS LossCostDSRLevel,\n\tEXP_STAGE.o_RunDateYear AS RunDateYear,\n\tEXP_STAGE.o_CreateDate AS CreateDate,\n\tEXP_STAGE.o_AuditId AS AuditId\n\tFROM EXP_STAGE\n\tLEFT JOIN LKP_WorkPremiumWorkersCompensationDataCallExtract\n\tON LKP_WorkPremiumWorkersCompensationDataCallExtract.EDWEarnedPremiumMonthlyCalculationPKID = EXP_STAGE.EDWEarnedPremiumMonthlyCalculationPKID AND LKP_WorkPremiumWorkersCompensationDataCallExtract.RunDate = EXP_STAGE.o_RunDateYear\n),\nRTR_INSERT_UPDATE_INSERT AS (SELECT * FROM RTR_INSERT_UPDATE WHERE ISNULL(WorkPremiumWorkersCompensationDataCallExtractId)),\nRTR_INSERT_UPDATE_UPDATE AS (SELECT * FROM RTR_INSERT_UPDATE WHERE NOT ISNULL(WorkPremiumWorkersCompensationDataCallExtractId)),\nUPD_UPDATE AS (\n\tSELECT\n\tWorkPremiumWorkersCompensationDataCallExtractId AS WorkPremiumWorkersCompensationDataCallExtractId3, \n\tEarnedPremiumTransactionMonthlyFactID AS EarnedPremiumTransactionMonthlyFactID3, \n\tMonthlyChangeinDirectEarnedPremium AS MonthlyChangeinDirectEarnedPremium3, \n\tEDWEarnedPremiumMonthlyCalculationPKID AS EDWEarnedPremiumMonthlyCalculationPKID3, \n\tEarnedPremiumTransactionRundate_CalendarEndOfMonthDate AS EarnedPremiumTransactionRundate_CalendarEndOfMonthDate3, \n\tEarnedPremiumTransactionBookeddate_clndr_date AS EarnedPremiumTransactionBookeddate_clndr_date3, \n\tCoverageDetailDimId AS CoverageDetailDimId3, \n\tedw_pol_ak_id AS edw_pol_ak_id3, \n\tpol_key AS pol_key3, \n\tpol_eff_date AS pol_eff_date3, \n\tpol_exp_date AS pol_exp_date3, \n\tNcciClassCode AS NcciClassCode3, \n\tStateProvinceCode AS StateProvinceCode3, \n\tStateProvinceCodeAbbreviation AS StateProvinceCodeAbbreviation3, \n\tInsuranceSegmentDescription AS InsuranceSegmentDescription3, \n\tPolicyOfferingDescription AS PolicyOfferingDescription3, \n\tPremiumTypeCode AS PremiumTypeCode3, \n\tBaseRate AS BaseRate3, \n\tWorkersCompensationPremiumAdjustmentFactorEffectiveDate AS WorkersCompensationPremiumAdjustmentFactorEffectiveDate3, \n\tWorkersCompensationPremiumAdjustmentFactor AS WorkersCompensationPremiumAdjustmentFactor3, \n\tWorkersCompensationPremiumAdjustmentType AS WorkersCompensationPremiumAdjustmentType3, \n\tConsentToRateFlag AS ConsentToRateFlag3, \n\tRateOverride AS RateOverride3, \n\tStrategicProfitCenterAbbreviation AS StrategicProfitCenterAbbreviation3, \n\tStateType AS StateType3, \n\tCompanyRatingLevel AS CompanyRatingLevel3, \n\tRatingDSRLevel AS RatingDSRLevel3, \n\tLossCostCompanyLevel AS LossCostCompanyLevel3, \n\tLossCostDSRLevel AS LossCostDSRLevel3, \n\tRunDateYear AS RunDateYear3, \n\tCreateDate AS CreateDate3, \n\tAuditId AS AuditId3\n\tFROM RTR_INSERT_UPDATE_UPDATE\n),\nWorkPremiumWorkersCompensationDataCallExtract_UPDATE AS (\n\tMERGE INTO WorkPremiumWorkersCompensationDataCallExtract AS T\n\tUSING UPD_UPDATE AS S\n\tON T.WorkPremiumWorkersCompensationDataCallExtractId = S.WorkPremiumWorkersCompensationDataCallExtractId3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.AuditId = S.AuditId3, T.CreatedDate = S.CreateDate3, T.EDWEarnedPremiumMonthlyCalculationPKID = S.EDWEarnedPremiumMonthlyCalculationPKID3, T.RunDate = S.RunDateYear3, T.EarnedPremiumRunDate = S.EarnedPremiumTransactionRundate_CalendarEndOfMonthDate3, T.PolicyKey = S.pol_key3, T.PolicyEffectiveDate = S.pol_eff_date3, T.StateCode = S.StateProvinceCode3, T.NCCIClassCode = S.NcciClassCode3, T.StrategicProfitCenterAbbreviation = S.StrategicProfitCenterAbbreviation3, T.InsuranceSegmentDescription = S.InsuranceSegmentDescription3, T.PolicyOfferingDescription = S.PolicyOfferingDescription3, T.WorkersCompensationPremiumAdjustmentFactorEffectiveDate = S.WorkersCompensationPremiumAdjustmentFactorEffectiveDate3, T.WorkersCompensationPremiumAdjustmentFactor = S.WorkersCompensationPremiumAdjustmentFactor3, T.WorkersCompensationPremiumAdjustmentType = S.WorkersCompensationPremiumAdjustmentType3, T.ConsentToRateFlag = S.ConsentToRateFlag3, T.RateOverride = S.RateOverride3, T.BaseRate = S.BaseRate3, T.RatingStateType = S.StateType3, T.DirectEarnedPremium = S.MonthlyChangeinDirectEarnedPremium3, T.RatingCompanyLevelEarnedPremium = S.CompanyRatingLevel3, T.RatingDSRLevelEarnedPremium = S.RatingDSRLevel3, T.LossCostCompanyLevelEarnedPremium = S.LossCostCompanyLevel3, T.LossCostDSRLevelEarnedPremium = S.LossCostDSRLevel3\n),\nUPD_INSERT AS (\n\tSELECT\n\tWorkPremiumWorkersCompensationDataCallExtractId AS WorkPremiumWorkersCompensationDataCallExtractId1, \n\tEarnedPremiumTransactionMonthlyFactID AS EarnedPremiumTransactionMonthlyFactID1, \n\tMonthlyChangeinDirectEarnedPremium AS MonthlyChangeinDirectEarnedPremium1, \n\tEDWEarnedPremiumMonthlyCalculationPKID AS EDWEarnedPremiumMonthlyCalculationPKID1, \n\tEarnedPremiumTransactionRundate_CalendarEndOfMonthDate AS EarnedPremiumTransactionRundate_CalendarEndOfMonthDate1, \n\tEarnedPremiumTransactionBookeddate_clndr_date AS EarnedPremiumTransactionBookeddate_clndr_date1, \n\tCoverageDetailDimId AS CoverageDetailDimId1, \n\tedw_pol_ak_id AS edw_pol_ak_id1, \n\tpol_key AS pol_key1, \n\tpol_eff_date AS pol_eff_date1, \n\tpol_exp_date AS pol_exp_date1, \n\tNcciClassCode AS NcciClassCode1, \n\tStateProvinceCode AS StateProvinceCode1, \n\tStateProvinceCodeAbbreviation AS StateProvinceCodeAbbreviation1, \n\tInsuranceSegmentDescription AS InsuranceSegmentDescription1, \n\tPolicyOfferingDescription AS PolicyOfferingDescription1, \n\tPremiumTypeCode AS PremiumTypeCode1, \n\tBaseRate AS BaseRate1, \n\tWorkersCompensationPremiumAdjustmentFactorEffectiveDate AS WorkersCompensationPremiumAdjustmentFactorEffectiveDate1, \n\tWorkersCompensationPremiumAdjustmentFactor AS WorkersCompensationPremiumAdjustmentFactor1, \n\tWorkersCompensationPremiumAdjustmentType AS WorkersCompensationPremiumAdjustmentType1, \n\tConsentToRateFlag AS ConsentToRateFlag1, \n\tRateOverride AS RateOverride1, \n\tStrategicProfitCenterAbbreviation AS StrategicProfitCenterAbbreviation1, \n\tStateType AS StateType1, \n\tCompanyRatingLevel AS CompanyRatingLevel1, \n\tRatingDSRLevel AS RatingDSRLevel1, \n\tLossCostCompanyLevel AS LossCostCompanyLevel1, \n\tLossCostDSRLevel AS LossCostDSRLevel1, \n\tRunDateYear AS RunDateYear1, \n\tCreateDate AS CreateDate1, \n\tAuditId AS AuditId1\n\tFROM RTR_INSERT_UPDATE_INSERT\n),\nWorkPremiumWorkersCompensationDataCallExtract_INSERT AS (\n\tINSERT INTO WorkPremiumWorkersCompensationDataCallExtract\n\t(AuditId, CreatedDate, EDWEarnedPremiumMonthlyCalculationPKID, RunDate, EarnedPremiumRunDate, PolicyKey, PolicyEffectiveDate, StateCode, NCCIClassCode, StrategicProfitCenterAbbreviation, InsuranceSegmentDescription, PolicyOfferingDescription, WorkersCompensationPremiumAdjustmentFactorEffectiveDate, WorkersCompensationPremiumAdjustmentFactor, WorkersCompensationPremiumAdjustmentType, ConsentToRateFlag, RateOverride, BaseRate, RatingStateType, DirectEarnedPremium, RatingCompanyLevelEarnedPremium, RatingDSRLevelEarnedPremium, LossCostCompanyLevelEarnedPremium, LossCostDSRLevelEarnedPremium)\n\tSELECT \n\tAuditId1 AS AUDITID, \n\tCreateDate1 AS CREATEDDATE, \n\tEDWEarnedPremiumMonthlyCalculationPKID1 AS EDWEARNEDPREMIUMMONTHLYCALCULATIONPKID, \n\tRunDateYear1 AS RUNDATE, \n\tEarnedPremiumTransactionRundate_CalendarEndOfMonthDate1 AS EARNEDPREMIUMRUNDATE, \n\tpol_key1 AS POLICYKEY, \n\tpol_eff_date1 AS POLICYEFFECTIVEDATE, \n\tStateProvinceCode1 AS STATECODE, \n\tNcciClassCode1 AS NCCICLASSCODE, \n\tStrategicProfitCenterAbbreviation1 AS STRATEGICPROFITCENTERABBREVIATION, \n\tInsuranceSegmentDescription1 AS INSURANCESEGMENTDESCRIPTION, \n\tPolicyOfferingDescription1 AS POLICYOFFERINGDESCRIPTION, \n\tWorkersCompensationPremiumAdjustmentFactorEffectiveDate1 AS WORKERSCOMPENSATIONPREMIUMADJUSTMENTFACTOREFFECTIVEDATE, \n\tWorkersCompensationPremiumAdjustmentFactor1 AS WORKERSCOMPENSATIONPREMIUMADJUSTMENTFACTOR, \n\tWorkersCompensationPremiumAdjustmentType1 AS WORKERSCOMPENSATIONPREMIUMADJUSTMENTTYPE, \n\tConsentToRateFlag1 AS CONSENTTORATEFLAG, \n\tRateOverride1 AS RATEOVERRIDE, \n\tBaseRate1 AS BASERATE, \n\tStateType1 AS RATINGSTATETYPE, \n\tMonthlyChangeinDirectEarnedPremium1 AS DIRECTEARNEDPREMIUM, \n\tCompanyRatingLevel1 AS RATINGCOMPANYLEVELEARNEDPREMIUM, \n\tRatingDSRLevel1 AS RATINGDSRLEVELEARNEDPREMIUM, \n\tLossCostCompanyLevel1 AS LOSSCOSTCOMPANYLEVELEARNEDPREMIUM, \n\tLossCostDSRLevel1 AS LOSSCOSTDSRLEVELEARNEDPREMIUM\n\tFROM UPD_INSERT\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "RUN_YEAR": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}