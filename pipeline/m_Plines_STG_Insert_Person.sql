WITH
SQ_person AS (
	SELECT
		person_seq,
		policy_num,
		policy_sym,
		policy_mod,
		policy_mco,
		person_num,
		relationship_to_insd_type_code,
		sex,
		marital_status_type_code,
		dob,
		occupation_descript,
		occupation_class_type_code,
		license_date,
		in_college_flag,
		good_student_flag,
		training_flag,
		acc_prev_course_date,
		is_licensed_flag,
		driver_license_num,
		driver_license_state_type_code,
		custody_flag,
		excl_driver_flag,
		non_rel_veh_owner_flag,
		non_rel_has_ins_flag,
		non_rel_has_standard_ins_f,
		non_rel_ins_company,
		military_serv_flag,
		license_susp_or_revoke_flag,
		financial_resp_flag,
		financial_filing_date,
		first_name,
		middle_initial,
		last_name,
		au_driver_flag,
		eno_driver_flag,
		visited_status_type_code,
		wt_driver_flag,
		rv_driver_flag,
		rv_experience_flag,
		boating_experience_flag,
		boating_course_cert_flag,
		employer,
		bus_phone,
		pip_excl,
		sr22_uw_author_type_code,
		sr22_file_type_code,
		sr22_wbm_complete_flag,
		sr22_wbm_to_complete_flag,
		sr22_author_by_wbm_flag,
		parent_support_cov_flag,
		have_cycle_license_flag,
		have_cycle_license_num_year,
		credit_score,
		credit_score_date,
		credit_score_source,
		credit_score_status,
		credit_score_msmq_message,
		mailing_address_flag,
		modified_date,
		modified_user_id,
		pif_person_name,
		endorsement_person_view_code,
		exc_flag,
		exc_date,
		college_full_time_flag,
		college_res_student_flag,
		college_name,
		college_city,
		college_state_type_code,
		acc_convctn_na_flag,
		choicepoint_ref_num,
		pif_driver_discount,
		member_household_flag,
		pif_excl_flag,
		pif_in_college_flag,
		age_at_renl_or_endorse,
		suffix_name,
		num_of_mile_from_home,
		driver_tier,
		pif_relationship_to_insd_type_code,
		graduate_good_student_flag,
		pif_financial_resp_flag,
		pif_good_student_flag,
		pif_graduate_good_student_flag,
		pip_excl_flag,
		pif_pip_excl_flag,
		num_yrs_licd,
		license_exp_date,
		is_licensed_5_or_more_years_flag,
		employer_business_descript,
		per_status_type_code,
		child_under_17_flag
	FROM person
),
EXP_PERSON AS (
	SELECT
	person_seq,
	policy_num,
	policy_sym,
	policy_mod,
	policy_mco,
	person_num,
	relationship_to_insd_type_code,
	sex,
	marital_status_type_code,
	dob,
	occupation_descript,
	occupation_class_type_code,
	license_date,
	in_college_flag,
	good_student_flag,
	training_flag,
	acc_prev_course_date,
	is_licensed_flag,
	driver_license_num,
	driver_license_state_type_code,
	custody_flag,
	excl_driver_flag,
	non_rel_veh_owner_flag,
	non_rel_has_ins_flag,
	non_rel_has_standard_ins_f,
	non_rel_ins_company,
	military_serv_flag,
	license_susp_or_revoke_flag,
	financial_resp_flag,
	financial_filing_date,
	first_name,
	middle_initial,
	last_name,
	au_driver_flag,
	eno_driver_flag,
	visited_status_type_code,
	wt_driver_flag,
	rv_driver_flag,
	rv_experience_flag,
	boating_experience_flag,
	boating_course_cert_flag,
	employer,
	bus_phone,
	pip_excl,
	sr22_uw_author_type_code,
	sr22_file_type_code,
	sr22_wbm_complete_flag,
	sr22_wbm_to_complete_flag,
	sr22_author_by_wbm_flag,
	parent_support_cov_flag,
	have_cycle_license_flag,
	have_cycle_license_num_year,
	credit_score,
	credit_score_date,
	credit_score_source,
	credit_score_status,
	credit_score_msmq_message,
	mailing_address_flag,
	modified_date,
	modified_user_id,
	pif_person_name,
	endorsement_person_view_code,
	exc_flag,
	exc_date,
	college_full_time_flag,
	college_res_student_flag,
	college_name,
	college_city,
	college_state_type_code,
	acc_convctn_na_flag,
	choicepoint_ref_num,
	pif_driver_discount,
	member_household_flag,
	pif_excl_flag,
	pif_in_college_flag,
	age_at_renl_or_endorse,
	suffix_name,
	num_of_mile_from_home,
	driver_tier,
	pif_relationship_to_insd_type_code,
	graduate_good_student_flag,
	pif_financial_resp_flag,
	pif_good_student_flag,
	pif_graduate_good_student_flag,
	pip_excl_flag,
	pif_pip_excl_flag,
	num_yrs_licd,
	license_exp_date,
	is_licensed_5_or_more_years_flag,
	employer_business_descript,
	per_status_type_code,
	child_under_17_flag,
	SYSDATE AS EXTRACT_DATE,
	SYSDATE AS AS_OF_DATE,
	'' AS RECORD_COUNT,
	@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID
	FROM SQ_person
),
person_stage AS (
	TRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.person_stage;
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.person_stage
	(person_seq, policy_num, policy_sym, policy_mod, policy_mco, person_num, relationship_to_insd_type_code, sex, marital_status_type_code, dob, occupation_descript, occupation_class_type_code, license_date, in_college_flag, good_student_flag, training_flag, acc_prev_course_date, is_licensed_flag, driver_license_state_type_code, custody_flag, excl_driver_flag, non_rel_veh_owner_flag, non_rel_has_ins_flag, non_rel_has_standard_ins_f, non_rel_ins_company, military_serv_flag, license_susp_or_revoke_flag, financial_resp_flag, financial_filing_date, first_name, middle_initial, last_name, au_driver_flag, eno_driver_flag, visited_status_type_code, wt_driver_flag, rv_driver_flag, rv_experience_flag, boating_experience_flag, boating_course_cert_flag, employer, bus_phone, pip_excl, sr22_uw_author_type_code, sr22_file_type_code, sr22_wbm_complete_flag, sr22_wbm_to_complete_flag, sr22_author_by_wbm_flag, parent_support_cov_flag, have_cycle_license_flag, have_cycle_license_num_year, credit_score, credit_score_date, credit_score_source, credit_score_status, credit_score_msmq_message, mailing_address_flag, modified_date, modified_user_id, pif_person_name, endorsement_person_view_code, exc_flag, exc_date, college_full_time_flag, college_res_student_flag, college_name, college_city, college_state_type_code, acc_convctn_na_flag, choicepoint_ref_num, pif_driver_discount, member_household_flag, pif_excl_flag, pif_in_college_flag, age_at_renl_or_endorse, suffix_name, num_of_mile_from_home, driver_tier, pif_relationship_to_insd_type_code, graduate_good_student_flag, pif_financial_resp_flag, pif_good_student_flag, pif_graduate_good_student_flag, pip_excl_flag, pif_pip_excl_flag, num_yrs_licd, license_exp_date, is_licensed_5_or_more_years_flag, employer_business_descript, per_status_type_code, child_under_17_flag, extract_date, as_of_date, record_count, source_system_id)
	SELECT 
	PERSON_SEQ, 
	POLICY_NUM, 
	POLICY_SYM, 
	POLICY_MOD, 
	POLICY_MCO, 
	PERSON_NUM, 
	RELATIONSHIP_TO_INSD_TYPE_CODE, 
	SEX, 
	MARITAL_STATUS_TYPE_CODE, 
	DOB, 
	OCCUPATION_DESCRIPT, 
	OCCUPATION_CLASS_TYPE_CODE, 
	LICENSE_DATE, 
	IN_COLLEGE_FLAG, 
	GOOD_STUDENT_FLAG, 
	TRAINING_FLAG, 
	ACC_PREV_COURSE_DATE, 
	IS_LICENSED_FLAG, 
	DRIVER_LICENSE_STATE_TYPE_CODE, 
	CUSTODY_FLAG, 
	EXCL_DRIVER_FLAG, 
	NON_REL_VEH_OWNER_FLAG, 
	NON_REL_HAS_INS_FLAG, 
	NON_REL_HAS_STANDARD_INS_F, 
	NON_REL_INS_COMPANY, 
	MILITARY_SERV_FLAG, 
	LICENSE_SUSP_OR_REVOKE_FLAG, 
	FINANCIAL_RESP_FLAG, 
	FINANCIAL_FILING_DATE, 
	FIRST_NAME, 
	MIDDLE_INITIAL, 
	LAST_NAME, 
	AU_DRIVER_FLAG, 
	ENO_DRIVER_FLAG, 
	VISITED_STATUS_TYPE_CODE, 
	WT_DRIVER_FLAG, 
	RV_DRIVER_FLAG, 
	RV_EXPERIENCE_FLAG, 
	BOATING_EXPERIENCE_FLAG, 
	BOATING_COURSE_CERT_FLAG, 
	EMPLOYER, 
	BUS_PHONE, 
	PIP_EXCL, 
	SR22_UW_AUTHOR_TYPE_CODE, 
	SR22_FILE_TYPE_CODE, 
	SR22_WBM_COMPLETE_FLAG, 
	SR22_WBM_TO_COMPLETE_FLAG, 
	SR22_AUTHOR_BY_WBM_FLAG, 
	PARENT_SUPPORT_COV_FLAG, 
	HAVE_CYCLE_LICENSE_FLAG, 
	HAVE_CYCLE_LICENSE_NUM_YEAR, 
	CREDIT_SCORE, 
	CREDIT_SCORE_DATE, 
	CREDIT_SCORE_SOURCE, 
	CREDIT_SCORE_STATUS, 
	CREDIT_SCORE_MSMQ_MESSAGE, 
	MAILING_ADDRESS_FLAG, 
	MODIFIED_DATE, 
	MODIFIED_USER_ID, 
	PIF_PERSON_NAME, 
	ENDORSEMENT_PERSON_VIEW_CODE, 
	EXC_FLAG, 
	EXC_DATE, 
	COLLEGE_FULL_TIME_FLAG, 
	COLLEGE_RES_STUDENT_FLAG, 
	COLLEGE_NAME, 
	COLLEGE_CITY, 
	COLLEGE_STATE_TYPE_CODE, 
	ACC_CONVCTN_NA_FLAG, 
	CHOICEPOINT_REF_NUM, 
	PIF_DRIVER_DISCOUNT, 
	MEMBER_HOUSEHOLD_FLAG, 
	PIF_EXCL_FLAG, 
	PIF_IN_COLLEGE_FLAG, 
	AGE_AT_RENL_OR_ENDORSE, 
	SUFFIX_NAME, 
	NUM_OF_MILE_FROM_HOME, 
	DRIVER_TIER, 
	PIF_RELATIONSHIP_TO_INSD_TYPE_CODE, 
	GRADUATE_GOOD_STUDENT_FLAG, 
	PIF_FINANCIAL_RESP_FLAG, 
	PIF_GOOD_STUDENT_FLAG, 
	PIF_GRADUATE_GOOD_STUDENT_FLAG, 
	PIP_EXCL_FLAG, 
	PIF_PIP_EXCL_FLAG, 
	NUM_YRS_LICD, 
	LICENSE_EXP_DATE, 
	IS_LICENSED_5_OR_MORE_YEARS_FLAG, 
	EMPLOYER_BUSINESS_DESCRIPT, 
	PER_STATUS_TYPE_CODE, 
	CHILD_UNDER_17_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID
	FROM EXP_PERSON
),