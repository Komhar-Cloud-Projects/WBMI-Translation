{
    "name": "s_m_POL_STG_Insert_archPif350Stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_archPif350Stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif350Stage AS (\n\tSELECT\n\t\tPif350StageId,\n\t\tExtractDate,\n\t\tSourceSystemid,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifModule,\n\t\tVehicleDescriptionSegmentId,\n\t\tUnitNum,\n\t\tVehicleDescriptionSegmentNumber,\n\t\tAmendmentNumber,\n\t\tState,\n\t\tTerritory,\n\t\tYearMake,\n\t\tMakeDescription,\n\t\tSerialNumber,\n\t\tTypeVehicle,\n\t\tPerformance,\n\t\tBody,\n\t\tCostNew,\n\t\tSymbol,\n\t\tDriverAssigned,\n\t\tUseCode,\n\t\tMilesToWork,\n\t\tDaysPerWeek,\n\t\tAnnualMiles,\n\t\tVehicleClassCode,\n\t\tDriverClassCode,\n\t\tMultiCarOverrideIndicator,\n\t\tAntiLockDiscountIndicator,\n\t\tPipRatingBasisIndicator,\n\t\tAntiTheftDeviceIndicator,\n\t\tPassiveRestraintIndicator,\n\t\tSpecialUse,\n\t\tZipPostalCode,\n\t\tTaxLocation,\n\t\tVehicleRatingAge,\n\t\tVehicleActualAge,\n\t\tLastChangeDateCentury,\n\t\tLastChangeDateYear,\n\t\tLastChangeDateMonth,\n\t\tLastchangeDateDay,\n\t\tCreditDateCentury,\n\t\tCreditDateYear,\n\t\tCreditDateMonth,\n\t\tCreditDateDay,\n\t\tVehicleWeight,\n\t\tCubicCentimeters,\n\t\tCommuterDiscount,\n\t\tStatedAmount,\n\t\tVehicleIdentificationNumber,\n\t\tSafeDriverDiscount,\n\t\tHomeAndHighwayModIndicator,\n\t\tCollisionClass,\n\t\tVehicleFarthestZone,\n\t\tVehicleSize,\n\t\tCommercialUse,\n\t\tRadius,\n\t\tSpecialIndustry,\n\t\tSchoolBusPolSubdiv,\n\t\tSchoolChartRegPlate,\n\t\tHADirectExcessSwitch,\n\t\tRideSharing,\n\t\tMunicipalLiabilityVolunteerWorkers,\n\t\tDriveTrainDualControl,\n\t\tSnowmobilePassengerHazard,\n\t\tRateBookIdStore,\n\t\tLeasedAutoIndicator,\n\t\tFleetIndicator,\n\t\tCededIndicator,\n\t\tRegTerrtory,\n\t\tStatTerritory,\n\t\tPackageModificationAssignment,\n\t\tPointDriver,\n\t\tPassOrFail,\n\t\tMinimumRetainedSwitch,\n\t\tSubstitute,\n\t\tDefensiveDriverCreditFactor,\n\t\tDefensiveDriverCreditIndicator,\n\t\tAntiTheftFactor,\n\t\tPassiveRestraintFactor,\n\t\tGoodStudentIndicator,\n\t\tGDDIndicator,\n\t\tDTDIndicator,\n\t\tGDDFactor,\n\t\tDGDFactor,\n\t\tDGDIndicator,\n\t\tTotalOperators,\n\t\tYouthfulOperator,\n\t\tPolicyOperators,\n\t\tTotalVehicles,\n\t\tAntiLockFactor,\n\t\tNhSdipPercent,\n\t\tAPCFactor,\n\t\tAPCIndicator,\n\t\tWLWFactor,\n\t\tWLWIndicator,\n\t\tCDDIndicator,\n\t\tVehicleAddDate,\n\t\tCoverageRateBookId_1,\n\t\tCoverageRateBookId_2,\n\t\tCoverageRateBookId_3,\n\t\tCoverageRateBookId_4,\n\t\tCoverageRateBookId_5,\n\t\tCoverageRateBookId_6,\n\t\tCoverageRateBookId_7,\n\t\tCoverageRateBookId_8,\n\t\tCoverageRateBookId_9,\n\t\tCoverageRateBookId_10,\n\t\tCoverageRateBookId_11,\n\t\tCoverageRateBookId_12,\n\t\tCoverageRateBookId_13,\n\t\tCoverageRateBookId_14,\n\t\tPreInspInd,\n\t\tConvertedTerritory,\n\t\tLocation,\n\t\tVehicleRatingAge2,\n\t\tVehicleActualAge2,\n\t\tTerritoryManualOverride,\n\t\tMultipleTerritories,\n\t\tPmsFutureUse,\n\t\tCustomerFutureUse,\n\t\tWBMVehicleIndicator,\n\t\tMultiCarDiscountIndicator,\n\t\tVehicleDeletedIndicator,\n\t\tPrimarySecondFactor,\n\t\tAntiTheftStatHold,\n\t\tDriverDiscount1,\n\t\tDriverDiscount2,\n\t\tSecondaryFactor,\n\t\tZipIndicator,\n\t\tCreditScoreFactor,\n\t\tOverride,\n\t\tVehicleWeight2,\n\t\tMakeDescription2,\n\t\tCheckDigit,\n\t\tHoldTerritory,\n\t\tInstructorsVehicles,\n\t\tAddVehicleDateYear,\n\t\tAddVehicleDateMonth,\n\t\tAddVehicleDateDay,\n\t\tComprehensiveSymbol,\n\t\tCollisionSymbol,\n\t\tHomeOwnForm,\n\t\tHomeOwnFactor,\n\t\tBillPlanFactor,\n\t\tCostNew7,\n\t\tStatedAmount7,\n\t\tYR2000CustomerUse,\n\t\tDuplicateKeySequenceNumber\n\tFROM Pif350Stage\n),\nEXP_Pif350Stage AS (\n\tSELECT\n\tPif350StageId,\n\tExtractDate,\n\tSourceSystemid,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifModule,\n\tVehicleDescriptionSegmentId,\n\tUnitNum,\n\tVehicleDescriptionSegmentNumber,\n\tAmendmentNumber,\n\tState,\n\tTerritory,\n\tYearMake,\n\tMakeDescription,\n\tSerialNumber,\n\tTypeVehicle,\n\tPerformance,\n\tBody,\n\tCostNew,\n\tSymbol,\n\tDriverAssigned,\n\tUseCode,\n\tMilesToWork,\n\tDaysPerWeek,\n\tAnnualMiles,\n\tVehicleClassCode,\n\tDriverClassCode,\n\tMultiCarOverrideIndicator,\n\tAntiLockDiscountIndicator,\n\tPipRatingBasisIndicator,\n\tAntiTheftDeviceIndicator,\n\tPassiveRestraintIndicator,\n\tSpecialUse,\n\tZipPostalCode,\n\tTaxLocation,\n\tVehicleRatingAge,\n\tVehicleActualAge,\n\tLastChangeDateCentury,\n\tLastChangeDateYear,\n\tLastChangeDateMonth,\n\tLastchangeDateDay,\n\tCreditDateCentury,\n\tCreditDateYear,\n\tCreditDateMonth,\n\tCreditDateDay,\n\tVehicleWeight,\n\tCubicCentimeters,\n\tCommuterDiscount,\n\tStatedAmount,\n\tVehicleIdentificationNumber,\n\tSafeDriverDiscount,\n\tHomeAndHighwayModIndicator,\n\tCollisionClass,\n\tVehicleFarthestZone,\n\tVehicleSize,\n\tCommercialUse,\n\tRadius,\n\tSpecialIndustry,\n\tSchoolBusPolSubdiv,\n\tSchoolChartRegPlate,\n\tHADirectExcessSwitch,\n\tRideSharing,\n\tMunicipalLiabilityVolunteerWorkers,\n\tDriveTrainDualControl,\n\tSnowmobilePassengerHazard,\n\tRateBookIdStore,\n\tLeasedAutoIndicator,\n\tFleetIndicator,\n\tCededIndicator,\n\tRegTerrtory,\n\tStatTerritory,\n\tPackageModificationAssignment,\n\tPointDriver,\n\tPassOrFail,\n\tMinimumRetainedSwitch,\n\tSubstitute,\n\tDefensiveDriverCreditFactor,\n\tDefensiveDriverCreditIndicator,\n\tAntiTheftFactor,\n\tPassiveRestraintFactor,\n\tGoodStudentIndicator,\n\tGDDIndicator,\n\tDTDIndicator,\n\tGDDFactor,\n\tDGDFactor,\n\tDGDIndicator,\n\tTotalOperators,\n\tYouthfulOperator,\n\tPolicyOperators,\n\tTotalVehicles,\n\tAntiLockFactor,\n\tNhSdipPercent,\n\tAPCFactor,\n\tAPCIndicator,\n\tWLWFactor,\n\tWLWIndicator,\n\tCDDIndicator,\n\tVehicleAddDate,\n\tCoverageRateBookId_1,\n\tCoverageRateBookId_2,\n\tCoverageRateBookId_3,\n\tCoverageRateBookId_4,\n\tCoverageRateBookId_5,\n\tCoverageRateBookId_6,\n\tCoverageRateBookId_7,\n\tCoverageRateBookId_8,\n\tCoverageRateBookId_9,\n\tCoverageRateBookId_10,\n\tCoverageRateBookId_11,\n\tCoverageRateBookId_12,\n\tCoverageRateBookId_13,\n\tCoverageRateBookId_14,\n\tPreInspInd,\n\tConvertedTerritory,\n\tLocation,\n\tVehicleRatingAge2,\n\tVehicleActualAge2,\n\tTerritoryManualOverride,\n\tMultipleTerritories,\n\tPmsFutureUse,\n\tCustomerFutureUse,\n\tWBMVehicleIndicator,\n\tMultiCarDiscountIndicator,\n\tVehicleDeletedIndicator,\n\tPrimarySecondFactor,\n\tAntiTheftStatHold,\n\tDriverDiscount1,\n\tDriverDiscount2,\n\tSecondaryFactor,\n\tZipIndicator,\n\tCreditScoreFactor,\n\tOverride,\n\tVehicleWeight2,\n\tMakeDescription2,\n\tCheckDigit,\n\tHoldTerritory,\n\tInstructorsVehicles,\n\tAddVehicleDateYear,\n\tAddVehicleDateMonth,\n\tAddVehicleDateDay,\n\tComprehensiveSymbol,\n\tCollisionSymbol,\n\tHomeOwnForm,\n\tHomeOwnFactor,\n\tBillPlanFactor,\n\tCostNew7,\n\tStatedAmount7,\n\tYR2000CustomerUse,\n\tDuplicateKeySequenceNumber,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id\n\tFROM SQ_Pif350Stage\n),\narchPif350Stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archPif350Stage\n\t(ExtractDate, SourceSystemid, PifSymbol, PifPolicyNumber, PifModule, VehicleDescriptionSegmentId, UnitNum, VehicleDescriptionSegmentNumber, AmendmentNumber, State, Territory, YearMake, MakeDescription, SerialNumber, TypeVehicle, Performance, Body, CostNew, Symbol, DriverAssigned, UseCode, MilesToWork, DaysPerWeek, AnnualMiles, VehicleClassCode, DriverClassCode, MultiCarOverrideIndicator, AntiLockDiscountIndicator, PipRatingBasisIndicator, AntiTheftDeviceIndicator, PassiveRestraintIndicator, SpecialUse, ZipPostalCode, TaxLocation, VehicleRatingAge, VehicleActualAge, LastChangeDateCentury, LastChangeDateYear, LastChangeDateMonth, LastchangeDateDay, CreditDateCentury, CreditDateYear, CreditDateMonth, CreditDateDay, VehicleWeight, CubicCentimeters, CommuterDiscount, StatedAmount, VehicleIdentificationNumber, SafeDriverDiscount, HomeAndHighwayModIndicator, CollisionClass, VehicleFarthestZone, VehicleSize, CommercialUse, Radius, SpecialIndustry, SchoolBusPolSubdiv, SchoolChartRegPlate, HADirectExcessSwitch, RideSharing, MunicipalLiabilityVolunteerWorkers, DriveTrainDualControl, SnowmobilePassengerHazard, RateBookIdStore, LeasedAutoIndicator, FleetIndicator, CededIndicator, RegTerrtory, StatTerritory, PackageModificationAssignment, PointDriver, PassOrFail, MinimumRetainedSwitch, Substitute, DefensiveDriverCreditFactor, DefensiveDriverCreditIndicator, AntiTheftFactor, PassiveRestraintFactor, GoodStudentIndicator, GDDIndicator, DTDIndicator, GDDFactor, DGDFactor, DGDIndicator, TotalOperators, YouthfulOperator, PolicyOperators, TotalVehicles, AntiLockFactor, NhSdipPercent, APCFactor, APCIndicator, WLWFactor, WLWIndicator, CDDIndicator, VehicleAddDate, CoverageRateBookId_1, CoverageRateBookId_2, CoverageRateBookId_3, CoverageRateBookId_4, CoverageRateBookId_5, CoverageRateBookId_6, CoverageRateBookId_7, CoverageRateBookId_8, CoverageRateBookId_9, CoverageRateBookId_10, CoverageRateBookId_11, CoverageRateBookId_12, CoverageRateBookId_13, CoverageRateBookId_14, PreInspInd, ConvertedTerritory, Location, VehicleRatingAge2, VehicleActualAge2, TerritoryManualOverride, MultipleTerritories, PmsFutureUse, CustomerFutureUse, WBMVehicleIndicator, MultiCarDiscountIndicator, VehicleDeletedIndicator, PrimarySecondFactor, AntiTheftStatHold, DriverDiscount1, DriverDiscount2, SecondaryFactor, ZipIndicator, CreditScoreFactor, Override, VehicleWeight2, MakeDescription2, CheckDigit, HoldTerritory, InstructorsVehicles, AddVehicleDateYear, AddVehicleDateMonth, AddVehicleDateDay, ComprehensiveSymbol, CollisionSymbol, HomeOwnForm, HomeOwnFactor, BillPlanFactor, CostNew7, StatedAmount7, YR2000CustomerUse, DuplicateKeySequenceNumber, AuditId)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFMODULE, \n\tVEHICLEDESCRIPTIONSEGMENTID, \n\tUNITNUM, \n\tVEHICLEDESCRIPTIONSEGMENTNUMBER, \n\tAMENDMENTNUMBER, \n\tSTATE, \n\tTERRITORY, \n\tYEARMAKE, \n\tMAKEDESCRIPTION, \n\tSERIALNUMBER, \n\tTYPEVEHICLE, \n\tPERFORMANCE, \n\tBODY, \n\tCOSTNEW, \n\tSYMBOL, \n\tDRIVERASSIGNED, \n\tUSECODE, \n\tMILESTOWORK, \n\tDAYSPERWEEK, \n\tANNUALMILES, \n\tVEHICLECLASSCODE, \n\tDRIVERCLASSCODE, \n\tMULTICAROVERRIDEINDICATOR, \n\tANTILOCKDISCOUNTINDICATOR, \n\tPIPRATINGBASISINDICATOR, \n\tANTITHEFTDEVICEINDICATOR, \n\tPASSIVERESTRAINTINDICATOR, \n\tSPECIALUSE, \n\tZIPPOSTALCODE, \n\tTAXLOCATION, \n\tVEHICLERATINGAGE, \n\tVEHICLEACTUALAGE, \n\tLASTCHANGEDATECENTURY, \n\tLASTCHANGEDATEYEAR, \n\tLASTCHANGEDATEMONTH, \n\tLASTCHANGEDATEDAY, \n\tCREDITDATECENTURY, \n\tCREDITDATEYEAR, \n\tCREDITDATEMONTH, \n\tCREDITDATEDAY, \n\tVEHICLEWEIGHT, \n\tCUBICCENTIMETERS, \n\tCOMMUTERDISCOUNT, \n\tSTATEDAMOUNT, \n\tVEHICLEIDENTIFICATIONNUMBER, \n\tSAFEDRIVERDISCOUNT, \n\tHOMEANDHIGHWAYMODINDICATOR, \n\tCOLLISIONCLASS, \n\tVEHICLEFARTHESTZONE, \n\tVEHICLESIZE, \n\tCOMMERCIALUSE, \n\tRADIUS, \n\tSPECIALINDUSTRY, \n\tSCHOOLBUSPOLSUBDIV, \n\tSCHOOLCHARTREGPLATE, \n\tHADIRECTEXCESSSWITCH, \n\tRIDESHARING, \n\tMUNICIPALLIABILITYVOLUNTEERWORKERS, \n\tDRIVETRAINDUALCONTROL, \n\tSNOWMOBILEPASSENGERHAZARD, \n\tRATEBOOKIDSTORE, \n\tLEASEDAUTOINDICATOR, \n\tFLEETINDICATOR, \n\tCEDEDINDICATOR, \n\tREGTERRTORY, \n\tSTATTERRITORY, \n\tPACKAGEMODIFICATIONASSIGNMENT, \n\tPOINTDRIVER, \n\tPASSORFAIL, \n\tMINIMUMRETAINEDSWITCH, \n\tSUBSTITUTE, \n\tDEFENSIVEDRIVERCREDITFACTOR, \n\tDEFENSIVEDRIVERCREDITINDICATOR, \n\tANTITHEFTFACTOR, \n\tPASSIVERESTRAINTFACTOR, \n\tGOODSTUDENTINDICATOR, \n\tGDDINDICATOR, \n\tDTDINDICATOR, \n\tGDDFACTOR, \n\tDGDFACTOR, \n\tDGDINDICATOR, \n\tTOTALOPERATORS, \n\tYOUTHFULOPERATOR, \n\tPOLICYOPERATORS, \n\tTOTALVEHICLES, \n\tANTILOCKFACTOR, \n\tNHSDIPPERCENT, \n\tAPCFACTOR, \n\tAPCINDICATOR, \n\tWLWFACTOR, \n\tWLWINDICATOR, \n\tCDDINDICATOR, \n\tVEHICLEADDDATE, \n\tCOVERAGERATEBOOKID_1, \n\tCOVERAGERATEBOOKID_2, \n\tCOVERAGERATEBOOKID_3, \n\tCOVERAGERATEBOOKID_4, \n\tCOVERAGERATEBOOKID_5, \n\tCOVERAGERATEBOOKID_6, \n\tCOVERAGERATEBOOKID_7, \n\tCOVERAGERATEBOOKID_8, \n\tCOVERAGERATEBOOKID_9, \n\tCOVERAGERATEBOOKID_10, \n\tCOVERAGERATEBOOKID_11, \n\tCOVERAGERATEBOOKID_12, \n\tCOVERAGERATEBOOKID_13, \n\tCOVERAGERATEBOOKID_14, \n\tPREINSPIND, \n\tCONVERTEDTERRITORY, \n\tLOCATION, \n\tVEHICLERATINGAGE2, \n\tVEHICLEACTUALAGE2, \n\tTERRITORYMANUALOVERRIDE, \n\tMULTIPLETERRITORIES, \n\tPMSFUTUREUSE, \n\tCUSTOMERFUTUREUSE, \n\tWBMVEHICLEINDICATOR, \n\tMULTICARDISCOUNTINDICATOR, \n\tVEHICLEDELETEDINDICATOR, \n\tPRIMARYSECONDFACTOR, \n\tANTITHEFTSTATHOLD, \n\tDRIVERDISCOUNT1, \n\tDRIVERDISCOUNT2, \n\tSECONDARYFACTOR, \n\tZIPINDICATOR, \n\tCREDITSCOREFACTOR, \n\tOVERRIDE, \n\tVEHICLEWEIGHT2, \n\tMAKEDESCRIPTION2, \n\tCHECKDIGIT, \n\tHOLDTERRITORY, \n\tINSTRUCTORSVEHICLES, \n\tADDVEHICLEDATEYEAR, \n\tADDVEHICLEDATEMONTH, \n\tADDVEHICLEDATEDAY, \n\tCOMPREHENSIVESYMBOL, \n\tCOLLISIONSYMBOL, \n\tHOMEOWNFORM, \n\tHOMEOWNFACTOR, \n\tBILLPLANFACTOR, \n\tCOSTNEW7, \n\tSTATEDAMOUNT7, \n\tYR2000CUSTOMERUSE, \n\tDUPLICATEKEYSEQUENCENUMBER, \n\to_audit_id AS AUDITID\n\tFROM EXP_Pif350Stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}