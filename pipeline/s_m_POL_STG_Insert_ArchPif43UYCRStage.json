{
    "name": "s_m_POL_STG_Insert_ArchPif43UYCRStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_ArchPif43UYCRStage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PIF43UYCRStage AS (\n\tSELECT\n\t\tPIF43UYCRstageId,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifPolicyModule,\n\t\tPMDUYC1RecLength,\n\t\tPMDUYC1ActionCode,\n\t\tPMDUYC1FileID,\n\t\tPMDUYC1SegmentID,\n\t\tPMDUYC1SegmentStatus,\n\t\tPMDUYC1YearTransaction,\n\t\tPMDUYC1MonthTransaction,\n\t\tPMDUYC1DayTransaction,\n\t\tPMDUYC1SegmentLevelCode,\n\t\tPMDUYC1SegmentPartCode,\n\t\tPMDUYC1SubPartCode,\n\t\tPMDUYC1InsuranceLine,\n\t\tPMDUYC1LocationNumber,\n\t\tPMDUYC1SubLocationNumber,\n\t\tPMDUYC1RiskUnitGroupKey,\n\t\tPMDUYC1Coverage,\n\t\tPMDUYC1CoverageAmendment,\n\t\tPMDUYC1Messenger,\n\t\tPMDUYC1YearItemEffective,\n\t\tPMDUYC1MonthItemEffective,\n\t\tPMDUYC1DayItemEffective,\n\t\tPMDUYC1VariableKey,\n\t\tPMDUYC1YearProcess,\n\t\tPMDUYC1MonthProcess,\n\t\tPMDUYC1DayProcess,\n\t\tPMDUYC1SegmentMgInd,\n\t\tPMDUYC1Premium,\n\t\tPMDUYC1PremMgInd,\n\t\tPMDUYC1DeductibleMultip,\n\t\tPMDUYC1DedMgInd,\n\t\tPMDUYC1Rdf,\n\t\tPMDUYC1RdfMgInd,\n\t\tPMDUYC1CommissionRate,\n\t\tPMDUYC1CommMgInd,\n\t\tPMDUYC1PackageMod,\n\t\tPMDUYC1PackageMgInd,\n\t\tPMDUYC1CompanyDeviation,\n\t\tPMDUYC1InitPremMessChr,\n\t\tPMDUYC1RateBookIdD,\n\t\tPMDUYC1Rmf,\n\t\tPMDUYC1TotalDiscountRate,\n\t\tPMDUYC1DiscMgInd,\n\t\tPMDUYC1AmendmentRate,\n\t\tPMDUYC1AmendmentMgInd,\n\t\tPMDUYC1CalcPremFctr,\n\t\tPMDUYC1FormCode,\n\t\tPMDUYC1ProtectiveDevice,\n\t\tPMDUYC1TerritoryMultiplier,\n\t\tPMDUYC1TerrMgInd,\n\t\tPMDUYC1DedCredit,\n\t\tPMDUYC1NumMessengers,\n\t\tPMDUYC1StBaseRate,\n\t\tPMDUYC11stRateMgInd,\n\t\tPMDUYC12ndBaseRate,\n\t\tPMDUYC12ndRateMgInd,\n\t\tPMDUYC13rdBaseRate,\n\t\tPMDUYC13rdRateMgInd,\n\t\tPMDUYC14thBaseRate,\n\t\tPMDUYC14thRateMgInd,\n\t\tPMDUYC15thBaseRate,\n\t\tPMDUYC15thRateMgInd,\n\t\tPMDUYC1ClassOfInsured,\n\t\tPMDUYC1Rate1,\n\t\tPMDUYC1Rate2,\n\t\tPMDUYC1NumberOfEmployee1,\n\t\tPMDUYC1NumberOfEmployee2,\n\t\tPMDUYC1TotalEmployees,\n\t\tPMDUYC1NumberEmployeeCode,\n\t\tPMDUYC1DecChangeFlag,\n\t\tPMDUYC11st25LocFctr,\n\t\tPMDUYC12nd25LocFctr,\n\t\tPMDUYC1Ovr50LocFctr,\n\t\tPMDUYC1TotAddLocChg,\n\t\tPMDUYC1TermFactor,\n\t\tPMDUYC1AddlLocChg,\n\t\tPMDUYC1PersAcctsFactor,\n\t\tPMDUYC1CovMinPremInd,\n\t\tPMDUYC1FormFactor,\n\t\tPMDUYC1RmfMgInd,\n\t\tPMDUYC1Rate1MgInd,\n\t\tPMDUYC1Rate2MgInd,\n\t\tPMDUYC1BaseLossCostFactor,\n\t\tPMDUYC1FormCodeThree,\n\t\tPMDUYC1ModBaseLossFact,\n\t\tPMDUYC1NewLossCostMult,\n\t\tPMDUYC1PmsFutureUSE,\n\t\tPMDUYC11st25Units,\n\t\tPMDUYC1Over25Units,\n\t\tPMDUYC1CustomerUse,\n\t\tPMDUYC1SmartFactor,\n\t\tPMDUYC1AssocFactor,\n\t\tPMDUYC1ProgFactor,\n\t\tPMDUYC1SapFactor,\n\t\tPMDUYC1EmplPremOver5,\n\t\tPMDUYC1EmplPrem,\n\t\tPMDUYC1AddlPrem,\n\t\tPMDUYC1CffPremBefAdj,\n\t\tPMDUYC1IntPrem5,\n\t\tPMDUYC1IntPrem6,\n\t\tPMDUYC1RelativityFac,\n\t\tPMDUYC1EmplDedCredit,\n\t\tPMDUYC1YR2000CustUse\n\tFROM PIF43UYCRStage\n),\nEXP_Values AS (\n\tSELECT\n\tPIF43UYCRstageId,\n\tExtractDate,\n\tSourceSystemId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifPolicyModule,\n\tPMDUYC1RecLength,\n\tPMDUYC1ActionCode,\n\tPMDUYC1FileID,\n\tPMDUYC1SegmentID,\n\tPMDUYC1SegmentStatus,\n\tPMDUYC1YearTransaction,\n\tPMDUYC1MonthTransaction,\n\tPMDUYC1DayTransaction,\n\tPMDUYC1SegmentLevelCode,\n\tPMDUYC1SegmentPartCode,\n\tPMDUYC1SubPartCode,\n\tPMDUYC1InsuranceLine,\n\tPMDUYC1LocationNumber,\n\tPMDUYC1SubLocationNumber,\n\tPMDUYC1RiskUnitGroupKey,\n\tPMDUYC1Coverage,\n\tPMDUYC1CoverageAmendment,\n\tPMDUYC1Messenger,\n\tPMDUYC1YearItemEffective,\n\tPMDUYC1MonthItemEffective,\n\tPMDUYC1DayItemEffective,\n\tPMDUYC1VariableKey,\n\tPMDUYC1YearProcess,\n\tPMDUYC1MonthProcess,\n\tPMDUYC1DayProcess,\n\tPMDUYC1SegmentMgInd,\n\tPMDUYC1Premium,\n\tPMDUYC1PremMgInd,\n\tPMDUYC1DeductibleMultip,\n\tPMDUYC1DedMgInd,\n\tPMDUYC1Rdf,\n\tPMDUYC1RdfMgInd,\n\tPMDUYC1CommissionRate,\n\tPMDUYC1CommMgInd,\n\tPMDUYC1PackageMod,\n\tPMDUYC1PackageMgInd,\n\tPMDUYC1CompanyDeviation,\n\tPMDUYC1InitPremMessChr,\n\tPMDUYC1RateBookIdD,\n\tPMDUYC1Rmf,\n\tPMDUYC1TotalDiscountRate,\n\tPMDUYC1DiscMgInd,\n\tPMDUYC1AmendmentRate,\n\tPMDUYC1AmendmentMgInd,\n\tPMDUYC1CalcPremFctr,\n\tPMDUYC1FormCode,\n\tPMDUYC1ProtectiveDevice,\n\tPMDUYC1TerritoryMultiplier,\n\tPMDUYC1TerrMgInd,\n\tPMDUYC1DedCredit,\n\tPMDUYC1NumMessengers,\n\tPMDUYC1StBaseRate,\n\tPMDUYC11stRateMgInd,\n\tPMDUYC12ndBaseRate,\n\tPMDUYC12ndRateMgInd,\n\tPMDUYC13rdBaseRate,\n\tPMDUYC13rdRateMgInd,\n\tPMDUYC14thBaseRate,\n\tPMDUYC14thRateMgInd,\n\tPMDUYC15thBaseRate,\n\tPMDUYC15thRateMgInd,\n\tPMDUYC1ClassOfInsured,\n\tPMDUYC1Rate1,\n\tPMDUYC1Rate2,\n\tPMDUYC1NumberOfEmployee1,\n\tPMDUYC1NumberOfEmployee2,\n\tPMDUYC1TotalEmployees,\n\tPMDUYC1NumberEmployeeCode,\n\tPMDUYC1DecChangeFlag,\n\tPMDUYC11st25LocFctr,\n\tPMDUYC12nd25LocFctr,\n\tPMDUYC1Ovr50LocFctr,\n\tPMDUYC1TotAddLocChg,\n\tPMDUYC1TermFactor,\n\tPMDUYC1AddlLocChg,\n\tPMDUYC1PersAcctsFactor,\n\tPMDUYC1CovMinPremInd,\n\tPMDUYC1FormFactor,\n\tPMDUYC1RmfMgInd,\n\tPMDUYC1Rate1MgInd,\n\tPMDUYC1Rate2MgInd,\n\tPMDUYC1BaseLossCostFactor,\n\tPMDUYC1FormCodeThree,\n\tPMDUYC1ModBaseLossFact,\n\tPMDUYC1NewLossCostMult,\n\tPMDUYC1PmsFutureUSE,\n\tPMDUYC11st25Units,\n\tPMDUYC1Over25Units,\n\tPMDUYC1CustomerUse,\n\tPMDUYC1SmartFactor,\n\tPMDUYC1AssocFactor,\n\tPMDUYC1ProgFactor,\n\tPMDUYC1SapFactor,\n\tPMDUYC1EmplPremOver5,\n\tPMDUYC1EmplPrem,\n\tPMDUYC1AddlPrem,\n\tPMDUYC1CffPremBefAdj,\n\tPMDUYC1IntPrem5,\n\tPMDUYC1IntPrem6,\n\tPMDUYC1RelativityFac,\n\tPMDUYC1EmplDedCredit,\n\tPMDUYC1YR2000CustUse,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_PIF43UYCRStage\n),\nArchPIF43UYCRStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPIF43UYCRStage\n\t(PIF43UYCRStageId, ExtractDate, SourceSystemId, AuditId, PifSymbol, PifPolicyNumber, PifPolicyModule, PMDUYC1RecLength, PMDUYC1ActionCode, PMDUYC1FileID, PMDUYC1SegmentID, PMDUYC1SegmentStatus, PMDUYC1YearTransaction, PMDUYC1MonthTransaction, PMDUYC1DayTransaction, PMDUYC1SegmentLevelCode, PMDUYC1SegmentPartCode, PMDUYC1SubPartCode, PMDUYC1InsuranceLine, PMDUYC1LocationNumber, PMDUYC1SubLocationNumber, PMDUYC1RiskUnitGroupKey, PMDUYC1Coverage, PMDUYC1CoverageAmendment, PMDUYC1Messenger, PMDUYC1YearItemEffective, PMDUYC1MonthItemEffective, PMDUYC1DayItemEffective, PMDUYC1VariableKey, PMDUYC1YearProcess, PMDUYC1MonthProcess, PMDUYC1DayProcess, PMDUYC1SegmentMgInd, PMDUYC1Premium, PMDUYC1PremMgInd, PMDUYC1DeductibleMultip, PMDUYC1DedMgInd, PMDUYC1Rdf, PMDUYC1RdfMgInd, PMDUYC1CommissionRate, PMDUYC1CommMgInd, PMDUYC1PackageMod, PMDUYC1PackageMgInd, PMDUYC1CompanyDeviation, PMDUYC1InitPremMessChr, PMDUYC1RateBookIdD, PMDUYC1Rmf, PMDUYC1TotalDiscountRate, PMDUYC1DiscMgInd, PMDUYC1AmendmentRate, PMDUYC1AmendmentMgInd, PMDUYC1CalcPremFctr, PMDUYC1FormCode, PMDUYC1ProtectiveDevice, PMDUYC1TerritoryMultiplier, PMDUYC1TerrMgInd, PMDUYC1DedCredit, PMDUYC1NumMessengers, PMDUYC1StBaseRate, PMDUYC11stRateMgInd, PMDUYC12ndBaseRate, PMDUYC12ndRateMgInd, PMDUYC13rdBaseRate, PMDUYC13rdRateMgInd, PMDUYC14thBaseRate, PMDUYC14thRateMgInd, PMDUYC15thBaseRate, PMDUYC15thRateMgInd, PMDUYC1ClassOfInsured, PMDUYC1Rate1, PMDUYC1Rate2, PMDUYC1NumberOfEmployee1, PMDUYC1NumberOfEmployee2, PMDUYC1TotalEmployees, PMDUYC1NumberEmployeeCode, PMDUYC1DecChangeFlag, PMDUYC11st25LocFctr, PMDUYC12nd25LocFctr, PMDUYC1Ovr50LocFctr, PMDUYC1TotAddLocChg, PMDUYC1TermFactor, PMDUYC1AddlLocChg, PMDUYC1PersAcctsFactor, PMDUYC1CovMinPremInd, PMDUYC1FormFactor, PMDUYC1RmfMgInd, PMDUYC1Rate1MgInd, PMDUYC1Rate2MgInd, PMDUYC1BaseLossCostFactor, PMDUYC1FormCodeThree, PMDUYC1ModBaseLossFact, PMDUYC1NewLossCostMult, PMDUYC1PmsFutureUSE, PMDUYC11st25Units, PMDUYC1Over25Units, PMDUYC1CustomerUse, PMDUYC1SmartFactor, PMDUYC1AssocFactor, PMDUYC1ProgFactor, PMDUYC1SapFactor, PMDUYC1EmplPremOver5, PMDUYC1EmplPrem, PMDUYC1AddlPrem, PMDUYC1CffPremBefAdj, PMDUYC1IntPrem5, PMDUYC1IntPrem6, PMDUYC1RelativityFac, PMDUYC1EmplDedCredit, PMDUYC1YR2000CustUse)\n\tSELECT \n\tPIF43UYCRstageId AS PIF43UYCRSTAGEID, \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFPOLICYMODULE, \n\tPMDUYC1RECLENGTH, \n\tPMDUYC1ACTIONCODE, \n\tPMDUYC1FILEID, \n\tPMDUYC1SEGMENTID, \n\tPMDUYC1SEGMENTSTATUS, \n\tPMDUYC1YEARTRANSACTION, \n\tPMDUYC1MONTHTRANSACTION, \n\tPMDUYC1DAYTRANSACTION, \n\tPMDUYC1SEGMENTLEVELCODE, \n\tPMDUYC1SEGMENTPARTCODE, \n\tPMDUYC1SUBPARTCODE, \n\tPMDUYC1INSURANCELINE, \n\tPMDUYC1LOCATIONNUMBER, \n\tPMDUYC1SUBLOCATIONNUMBER, \n\tPMDUYC1RISKUNITGROUPKEY, \n\tPMDUYC1COVERAGE, \n\tPMDUYC1COVERAGEAMENDMENT, \n\tPMDUYC1MESSENGER, \n\tPMDUYC1YEARITEMEFFECTIVE, \n\tPMDUYC1MONTHITEMEFFECTIVE, \n\tPMDUYC1DAYITEMEFFECTIVE, \n\tPMDUYC1VARIABLEKEY, \n\tPMDUYC1YEARPROCESS, \n\tPMDUYC1MONTHPROCESS, \n\tPMDUYC1DAYPROCESS, \n\tPMDUYC1SEGMENTMGIND, \n\tPMDUYC1PREMIUM, \n\tPMDUYC1PREMMGIND, \n\tPMDUYC1DEDUCTIBLEMULTIP, \n\tPMDUYC1DEDMGIND, \n\tPMDUYC1RDF, \n\tPMDUYC1RDFMGIND, \n\tPMDUYC1COMMISSIONRATE, \n\tPMDUYC1COMMMGIND, \n\tPMDUYC1PACKAGEMOD, \n\tPMDUYC1PACKAGEMGIND, \n\tPMDUYC1COMPANYDEVIATION, \n\tPMDUYC1INITPREMMESSCHR, \n\tPMDUYC1RATEBOOKIDD, \n\tPMDUYC1RMF, \n\tPMDUYC1TOTALDISCOUNTRATE, \n\tPMDUYC1DISCMGIND, \n\tPMDUYC1AMENDMENTRATE, \n\tPMDUYC1AMENDMENTMGIND, \n\tPMDUYC1CALCPREMFCTR, \n\tPMDUYC1FORMCODE, \n\tPMDUYC1PROTECTIVEDEVICE, \n\tPMDUYC1TERRITORYMULTIPLIER, \n\tPMDUYC1TERRMGIND, \n\tPMDUYC1DEDCREDIT, \n\tPMDUYC1NUMMESSENGERS, \n\tPMDUYC1STBASERATE, \n\tPMDUYC11STRATEMGIND, \n\tPMDUYC12NDBASERATE, \n\tPMDUYC12NDRATEMGIND, \n\tPMDUYC13RDBASERATE, \n\tPMDUYC13RDRATEMGIND, \n\tPMDUYC14THBASERATE, \n\tPMDUYC14THRATEMGIND, \n\tPMDUYC15THBASERATE, \n\tPMDUYC15THRATEMGIND, \n\tPMDUYC1CLASSOFINSURED, \n\tPMDUYC1RATE1, \n\tPMDUYC1RATE2, \n\tPMDUYC1NUMBEROFEMPLOYEE1, \n\tPMDUYC1NUMBEROFEMPLOYEE2, \n\tPMDUYC1TOTALEMPLOYEES, \n\tPMDUYC1NUMBEREMPLOYEECODE, \n\tPMDUYC1DECCHANGEFLAG, \n\tPMDUYC11ST25LOCFCTR, \n\tPMDUYC12ND25LOCFCTR, \n\tPMDUYC1OVR50LOCFCTR, \n\tPMDUYC1TOTADDLOCCHG, \n\tPMDUYC1TERMFACTOR, \n\tPMDUYC1ADDLLOCCHG, \n\tPMDUYC1PERSACCTSFACTOR, \n\tPMDUYC1COVMINPREMIND, \n\tPMDUYC1FORMFACTOR, \n\tPMDUYC1RMFMGIND, \n\tPMDUYC1RATE1MGIND, \n\tPMDUYC1RATE2MGIND, \n\tPMDUYC1BASELOSSCOSTFACTOR, \n\tPMDUYC1FORMCODETHREE, \n\tPMDUYC1MODBASELOSSFACT, \n\tPMDUYC1NEWLOSSCOSTMULT, \n\tPMDUYC1PMSFUTUREUSE, \n\tPMDUYC11ST25UNITS, \n\tPMDUYC1OVER25UNITS, \n\tPMDUYC1CUSTOMERUSE, \n\tPMDUYC1SMARTFACTOR, \n\tPMDUYC1ASSOCFACTOR, \n\tPMDUYC1PROGFACTOR, \n\tPMDUYC1SAPFACTOR, \n\tPMDUYC1EMPLPREMOVER5, \n\tPMDUYC1EMPLPREM, \n\tPMDUYC1ADDLPREM, \n\tPMDUYC1CFFPREMBEFADJ, \n\tPMDUYC1INTPREM5, \n\tPMDUYC1INTPREM6, \n\tPMDUYC1RELATIVITYFAC, \n\tPMDUYC1EMPLDEDCREDIT, \n\tPMDUYC1YR2000CUSTUSE\n\tFROM EXP_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}