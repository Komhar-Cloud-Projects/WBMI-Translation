WITH
SQ_Pif351Stage AS (
	SELECT
		Pif351StageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		VehicleCoverageSegmentId,
		UnitNum,
		VehicleCoverageSegmentNumber,
		AmendmentNumber,
		ChangeEffectiveDateCentury,
		ChangeEffectiveDateYear,
		ChangeEffectiveDateMonth,
		ChangeEffectiveDateDay,
		VehicleReasonAmendedCode,
		VehicleTotalPremium,
		VehicleOldPremium,
		VehicleCoverageCode1,
		VehicleCoverageCode2,
		VehicleCoverageCode3,
		VehicleCoverageCode4,
		VehicleCoverageCode5,
		VehicleCoverageCode6,
		VehicleCoverageCode7,
		VehicleCoverageCode8,
		VehicleCoverageCode9,
		VehicleCoverageCode10,
		VehicleCoverageCode11,
		VehicleCoverageCode12,
		VehicleCoverageCode13,
		VehicleCoverageCode14,
		VehicleCoverageLimit1,
		VehicleCoverageLimit2,
		VehicleCoverageLimit3,
		VehicleCoverageLimit4,
		VehicleCoverageLimit5,
		VehicleCoverageLimit6,
		VehicleCoverageLimit7,
		VehicleCoverageLimit8,
		VehicleCoverageLimit9,
		VehicleCoverageLimit10,
		VehicleCoverageLimit11,
		VehicleCoverageLimit12,
		VehicleCoverageLimit13,
		VehicleCoverageLimit14,
		VehicleCoveragePremium1,
		VehicleCoveragePremium2,
		VehicleCoveragePremium3,
		VehicleCoveragePremium4,
		VehicleCoveragePremium5,
		VehicleCoveragePremium6,
		VehicleCoveragePremium7,
		VehicleCoveragePremium8,
		VehicleCoveragePremium9,
		VehicleCoveragePremium10,
		VehicleCoveragePremium11,
		VehicleCoveragePremium12,
		VehicleCoveragePremium13,
		VehicleCoveragePremium14,
		VehicleCoverageRateBookId1,
		VehicleCoverageRateBookId2,
		VehicleCoverageRateBookId3,
		VehicleCoverageRateBookId4,
		VehicleCoverageRateBookId5,
		VehicleCoverageRateBookId6,
		VehicleCoverageRateBookId7,
		VehicleCoverageRateBookId8,
		VehicleCoverageRateBookId9,
		VehicleCoverageRateBookId10,
		VehicleCoverageRateBookId11,
		VehicleCoverageRateBookId12,
		VehicleCoverageRateBookId13,
		VehicleCoverageRateBookId14,
		HomeAndHighwayModIndicator,
		VehicleFactorHoldArea,
		VehicleUmsUmpSwitch,
		VehicleDeletedIndicator,
		NonSmokerDiscount,
		AccidentFreeDiscountPercent,
		SafeDriverDiscount,
		HiredNonownedMinimum,
		HiredNonownedFactor,
		InexperiencedOperatorSurcharge,
		PmsFutureUse,
		CustomerFutureUse,
		Yr2000CustomerUse,
		DuplicateKeySequenceNumber
	FROM Pif351Stage
),
EXP_Pif351Stage AS (
	SELECT
	Pif351StageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	VehicleCoverageSegmentId,
	UnitNum,
	VehicleCoverageSegmentNumber,
	AmendmentNumber,
	ChangeEffectiveDateCentury,
	ChangeEffectiveDateYear,
	ChangeEffectiveDateMonth,
	ChangeEffectiveDateDay,
	VehicleReasonAmendedCode,
	VehicleTotalPremium,
	VehicleOldPremium,
	VehicleCoverageCode1,
	VehicleCoverageCode2,
	VehicleCoverageCode3,
	VehicleCoverageCode4,
	VehicleCoverageCode5,
	VehicleCoverageCode6,
	VehicleCoverageCode7,
	VehicleCoverageCode8,
	VehicleCoverageCode9,
	VehicleCoverageCode10,
	VehicleCoverageCode11,
	VehicleCoverageCode12,
	VehicleCoverageCode13,
	VehicleCoverageCode14,
	VehicleCoverageLimit1,
	VehicleCoverageLimit2,
	VehicleCoverageLimit3,
	VehicleCoverageLimit4,
	VehicleCoverageLimit5,
	VehicleCoverageLimit6,
	VehicleCoverageLimit7,
	VehicleCoverageLimit8,
	VehicleCoverageLimit9,
	VehicleCoverageLimit10,
	VehicleCoverageLimit11,
	VehicleCoverageLimit12,
	VehicleCoverageLimit13,
	VehicleCoverageLimit14,
	VehicleCoveragePremium1,
	VehicleCoveragePremium2,
	VehicleCoveragePremium3,
	VehicleCoveragePremium4,
	VehicleCoveragePremium5,
	VehicleCoveragePremium6,
	VehicleCoveragePremium7,
	VehicleCoveragePremium8,
	VehicleCoveragePremium9,
	VehicleCoveragePremium10,
	VehicleCoveragePremium11,
	VehicleCoveragePremium12,
	VehicleCoveragePremium13,
	VehicleCoveragePremium14,
	VehicleCoverageRateBookId1,
	VehicleCoverageRateBookId2,
	VehicleCoverageRateBookId3,
	VehicleCoverageRateBookId4,
	VehicleCoverageRateBookId5,
	VehicleCoverageRateBookId6,
	VehicleCoverageRateBookId7,
	VehicleCoverageRateBookId8,
	VehicleCoverageRateBookId9,
	VehicleCoverageRateBookId10,
	VehicleCoverageRateBookId11,
	VehicleCoverageRateBookId12,
	VehicleCoverageRateBookId13,
	VehicleCoverageRateBookId14,
	HomeAndHighwayModIndicator,
	VehicleFactorHoldArea,
	VehicleUmsUmpSwitch,
	VehicleDeletedIndicator,
	NonSmokerDiscount,
	AccidentFreeDiscountPercent,
	SafeDriverDiscount,
	HiredNonownedMinimum,
	HiredNonownedFactor,
	InexperiencedOperatorSurcharge,
	PmsFutureUse,
	CustomerFutureUse,
	Yr2000CustomerUse,
	DuplicateKeySequenceNumber,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif351Stage
),
archPif351Stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archPif351Stage
	(ExtractDate, SourceSystemid, PifSymbol, PifPolicyNumber, PifModule, VehicleCoverageSegmentId, UnitNum, VehicleCoverageSegmentNumber, AmendmentNumber, ChangeEffectiveDateCentury, ChangeEffectiveDateYear, ChangeEffectiveDateMonth, ChangeEffectiveDateDay, VehicleReasonAmendedCode, VehicleTotalPremium, VehicleOldPremium, VehicleCoverageCode1, VehicleCoverageCode2, VehicleCoverageCode3, VehicleCoverageCode4, VehicleCoverageCode5, VehicleCoverageCode6, VehicleCoverageCode7, VehicleCoverageCode8, VehicleCoverageCode9, VehicleCoverageCode10, VehicleCoverageCode11, VehicleCoverageCode12, VehicleCoverageCode13, VehicleCoverageCode14, VehicleCoverageLimit1, VehicleCoverageLimit2, VehicleCoverageLimit3, VehicleCoverageLimit4, VehicleCoverageLimit5, VehicleCoverageLimit6, VehicleCoverageLimit7, VehicleCoverageLimit8, VehicleCoverageLimit9, VehicleCoverageLimit10, VehicleCoverageLimit11, VehicleCoverageLimit12, VehicleCoverageLimit13, VehicleCoverageLimit14, VehicleCoveragePremium1, VehicleCoveragePremium2, VehicleCoveragePremium3, VehicleCoveragePremium4, VehicleCoveragePremium5, VehicleCoveragePremium6, VehicleCoveragePremium7, VehicleCoveragePremium8, VehicleCoveragePremium9, VehicleCoveragePremium10, VehicleCoveragePremium11, VehicleCoveragePremium12, VehicleCoveragePremium13, VehicleCoveragePremium14, VehicleCoverageRateBookId1, VehicleCoverageRateBookId2, VehicleCoverageRateBookId3, VehicleCoverageRateBookId4, VehicleCoverageRateBookId5, VehicleCoverageRateBookId6, VehicleCoverageRateBookId7, VehicleCoverageRateBookId8, VehicleCoverageRateBookId9, VehicleCoverageRateBookId10, VehicleCoverageRateBookId11, VehicleCoverageRateBookId12, VehicleCoverageRateBookId13, VehicleCoverageRateBookId14, HomeAndHighwayModIndicator, VehicleFactorHoldArea, VehicleUmsUmpSwitch, VehicleDeletedIndicator, NonSmokerDiscount, AccidentFreeDiscountPercent, SafeDriverDiscount, HiredNonownedMinimum, HiredNonownedFactor, InexperiencedOperatorSurcharge, PmsFutureUse, CustomerFutureUse, Yr2000CustomerUse, DuplicateKeySequenceNumber, AuditId)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	VEHICLECOVERAGESEGMENTID, 
	UNITNUM, 
	VEHICLECOVERAGESEGMENTNUMBER, 
	AMENDMENTNUMBER, 
	CHANGEEFFECTIVEDATECENTURY, 
	CHANGEEFFECTIVEDATEYEAR, 
	CHANGEEFFECTIVEDATEMONTH, 
	CHANGEEFFECTIVEDATEDAY, 
	VEHICLEREASONAMENDEDCODE, 
	VEHICLETOTALPREMIUM, 
	VEHICLEOLDPREMIUM, 
	VEHICLECOVERAGECODE1, 
	VEHICLECOVERAGECODE2, 
	VEHICLECOVERAGECODE3, 
	VEHICLECOVERAGECODE4, 
	VEHICLECOVERAGECODE5, 
	VEHICLECOVERAGECODE6, 
	VEHICLECOVERAGECODE7, 
	VEHICLECOVERAGECODE8, 
	VEHICLECOVERAGECODE9, 
	VEHICLECOVERAGECODE10, 
	VEHICLECOVERAGECODE11, 
	VEHICLECOVERAGECODE12, 
	VEHICLECOVERAGECODE13, 
	VEHICLECOVERAGECODE14, 
	VEHICLECOVERAGELIMIT1, 
	VEHICLECOVERAGELIMIT2, 
	VEHICLECOVERAGELIMIT3, 
	VEHICLECOVERAGELIMIT4, 
	VEHICLECOVERAGELIMIT5, 
	VEHICLECOVERAGELIMIT6, 
	VEHICLECOVERAGELIMIT7, 
	VEHICLECOVERAGELIMIT8, 
	VEHICLECOVERAGELIMIT9, 
	VEHICLECOVERAGELIMIT10, 
	VEHICLECOVERAGELIMIT11, 
	VEHICLECOVERAGELIMIT12, 
	VEHICLECOVERAGELIMIT13, 
	VEHICLECOVERAGELIMIT14, 
	VEHICLECOVERAGEPREMIUM1, 
	VEHICLECOVERAGEPREMIUM2, 
	VEHICLECOVERAGEPREMIUM3, 
	VEHICLECOVERAGEPREMIUM4, 
	VEHICLECOVERAGEPREMIUM5, 
	VEHICLECOVERAGEPREMIUM6, 
	VEHICLECOVERAGEPREMIUM7, 
	VEHICLECOVERAGEPREMIUM8, 
	VEHICLECOVERAGEPREMIUM9, 
	VEHICLECOVERAGEPREMIUM10, 
	VEHICLECOVERAGEPREMIUM11, 
	VEHICLECOVERAGEPREMIUM12, 
	VEHICLECOVERAGEPREMIUM13, 
	VEHICLECOVERAGEPREMIUM14, 
	VEHICLECOVERAGERATEBOOKID1, 
	VEHICLECOVERAGERATEBOOKID2, 
	VEHICLECOVERAGERATEBOOKID3, 
	VEHICLECOVERAGERATEBOOKID4, 
	VEHICLECOVERAGERATEBOOKID5, 
	VEHICLECOVERAGERATEBOOKID6, 
	VEHICLECOVERAGERATEBOOKID7, 
	VEHICLECOVERAGERATEBOOKID8, 
	VEHICLECOVERAGERATEBOOKID9, 
	VEHICLECOVERAGERATEBOOKID10, 
	VEHICLECOVERAGERATEBOOKID11, 
	VEHICLECOVERAGERATEBOOKID12, 
	VEHICLECOVERAGERATEBOOKID13, 
	VEHICLECOVERAGERATEBOOKID14, 
	HOMEANDHIGHWAYMODINDICATOR, 
	VEHICLEFACTORHOLDAREA, 
	VEHICLEUMSUMPSWITCH, 
	VEHICLEDELETEDINDICATOR, 
	NONSMOKERDISCOUNT, 
	ACCIDENTFREEDISCOUNTPERCENT, 
	SAFEDRIVERDISCOUNT, 
	HIREDNONOWNEDMINIMUM, 
	HIREDNONOWNEDFACTOR, 
	INEXPERIENCEDOPERATORSURCHARGE, 
	PMSFUTUREUSE, 
	CUSTOMERFUTUREUSE, 
	YR2000CUSTOMERUSE, 
	DUPLICATEKEYSEQUENCENUMBER, 
	o_audit_id AS AUDITID
	FROM EXP_Pif351Stage
),