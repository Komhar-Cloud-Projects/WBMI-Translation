{
    "name": "s_m_POL_STG_Insert_arch_pif_43gj_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43gj_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_pif_43gj_stage AS (\n\tSELECT\n\t\tpif_43gj_stage_id,\n\t\tpif_symbol AS PIF_SYMBOL,\n\t\tpif_policy_number AS PIF_POLICY_NUMBER,\n\t\tpif_module AS PIF_MODULE,\n\t\tpmd4j_rec_length AS PMD4J_REC_LENGTH,\n\t\tpmd4j_action_code AS PMD4J_ACTION_CODE,\n\t\tpmd4j_file_id AS PMD4J_FILE_ID,\n\t\tpmd4j_segment_id AS PMD4J_SEGMENT_ID,\n\t\tpmd4j_segment_status AS PMD4J_SEGMENT_STATUS,\n\t\tpmd4j_year_transaction AS PMD4J_YEAR_TRANSACTION,\n\t\tpmd4j_month_transaction AS PMD4J_MONTH_TRANSACTION,\n\t\tpmd4j_day_transaction AS PMD4J_DAY_TRANSACTION,\n\t\tpmd4j_segment_level_code AS PMD4J_SEGMENT_LEVEL_CODE,\n\t\tpmd4j_segment_part_code AS PMD4J_SEGMENT_PART_CODE,\n\t\tpmd4j_sub_part_code AS PMD4J_SUB_PART_CODE,\n\t\tpmd4j_insurance_line AS PMD4J_INSURANCE_LINE,\n\t\tpmd4j_location_number AS PMD4J_LOCATION_NUMBER,\n\t\tpmd4j_sub_location_number AS PMD4J_SUB_LOCATION_NUMBER,\n\t\tpmd4j_risk_unit_group AS PMD4J_RISK_UNIT_GROUP,\n\t\tpmd4j_seq_rsk_unt_grp AS PMD4J_SEQ_RSK_UNT_GRP,\n\t\tpmd4j_risk_unit AS PMD4J_RISK_UNIT,\n\t\tpmd4j_risk_sequence AS PMD4J_RISK_SEQUENCE,\n\t\tpmd4j_risk_type_ind AS PMD4J_RISK_TYPE_IND,\n\t\tpmd4j_year_item_effective AS PMD4J_YEAR_ITEM_EFFECTIVE,\n\t\tpmd4j_month_item_effective AS PMD4J_MONTH_ITEM_EFFECTIVE,\n\t\tpmd4j_day_item_effective AS PMD4J_DAY_ITEM_EFFECTIVE,\n\t\tpmd4j_use_code AS PMD4J_USE_CODE,\n\t\tpmd4j_sequence_use_code AS PMD4J_SEQUENCE_USE_CODE,\n\t\tpmd4j_year_process AS PMD4J_YEAR_PROCESS,\n\t\tpmd4j_month_process AS PMD4J_MONTH_PROCESS,\n\t\tpmd4j_day_process AS PMD4J_DAY_PROCESS,\n\t\tpmd4j_use_code_data AS PMD4J_USE_CODE_DATA,\n\t\tpmd4j_sort_name AS PMD4J_SORT_NAME,\n\t\tpmd4j_tax_loc AS PMD4J_TAX_LOC,\n\t\tpmd4j_name_type_ind AS PMD4J_NAME_TYPE_IND,\n\t\tpmd4j_address_line_1 AS PMD4J_ADDRESS_LINE_1,\n\t\tpmd4j_addr_lin_2_pos_1 AS PMD4J_ADDR_LIN_2_POS_1,\n\t\tpmd4j_addr_lin_2_pos_2_30 AS PMD4J_ADDR_LIN_2_POS_2_30,\n\t\tpmd4j_address_line_3 AS PMD4J_ADDRESS_LINE_3,\n\t\tpmd4j_address_line_4 AS PMD4J_ADDRESS_LINE_4,\n\t\tpmd4j_id_number_9 AS PMD4J_ID_NUMBER_9,\n\t\tpmd4j_postal_code_1 AS PMD4J_POSTAL_CODE_1,\n\t\tpmd4j_phone_area AS PMD4J_PHONE_AREA,\n\t\tpmd4j_phone_exchange AS PMD4J_PHONE_EXCHANGE,\n\t\tpmd4j_phone_number AS PMD4J_PHONE_NUMBER,\n\t\tpmd4j_phone_extension AS PMD4J_PHONE_EXTENSION,\n\t\tpmd4j_interest_item AS PMD4J_INTEREST_ITEM,\n\t\tpmd4j_loc_line_exclusion AS PMD4J_LOC_LINE_EXCLUSION,\n\t\tpmd4j_surcharge AS PMD4J_SURCHARGE,\n\t\tpmd4j_municipal_tax AS PMD4J_MUNICIPAL_TAX,\n\t\tpmd4j_02_audit_code AS PMD4J_02_AUDIT_CODE,\n\t\tpmd4j_02_legal_entity AS PMD4J_02_LEGAL_ENTITY,\n\t\tpmd4j_dec_change_flag AS PMD4J_DEC_CHANGE_FLAG,\n\t\tpmd4j_blkt_misc_loc_exclusion AS PMD4J_BLKT_MISC_LOC_EXCLUSION,\n\t\tpmd4j_location_state AS PMD4J_LOCATION_STATE,\n\t\tpmd4j_matching_loc_sw AS PMD4J_MATCHING_LOC_SW,\n\t\tpmd4j_item_expire_year_cc AS PMD4J_ITEM_EXPIRE_YEAR_CC,\n\t\tpmd4j_item_expire_year_yy AS PMD4J_ITEM_EXPIRE_YEAR_YY,\n\t\tpmd4j_item_expire_month AS PMD4J_ITEM_EXPIRE_MONTH,\n\t\tpmd4j_item_expire_day AS PMD4J_ITEM_EXPIRE_DAY,\n\t\tpmd4j_class AS PMD4J_CLASS,\n\t\tpmd4j_name_ext_ind AS PMD4J_NAME_EXT_IND,\n\t\tpmd4j_pms_future_use AS PMD4J_PMS_FUTURE_USE,\n\t\tpmd4j_wbm_action_ind AS PMD4J_WBM_ACTION_IND,\n\t\tpmd4j_wbm_form AS PMD4J_WBM_FORM,\n\t\tpmd4j_wbm_cdays AS PMD4J_WBM_CDAYS,\n\t\tpmd4j_wbm_cprnt AS PMD4J_WBM_CPRNT,\n\t\tpmd4j_dist_area AS PMD4J_DIST_AREA,\n\t\tpmd4j_risk_city AS PMD4J_RISK_CITY,\n\t\tpmd4j_survey_status AS PMD4J_SURVEY_STATUS,\n\t\tpmd4j_survey_date AS PMD4J_SURVEY_DATE,\n\t\tpmd4j_pc_indicator AS PMD4J_PC_INDICATOR,\n\t\tpmd4j_yr2000_cust_use AS PMD4J_YR2000_CUST_USE,\n\t\tlogical_flag,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID,\n\t\tinf_action,\n\t\tinf_timestamp\n\tFROM pif_43gj_stage\n),\nEXP_PIF_43GJ_STAGE AS (\n\tSELECT\n\tpif_43gj_stage_id,\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE,\n\tPMD4J_REC_LENGTH,\n\tPMD4J_ACTION_CODE,\n\tPMD4J_FILE_ID,\n\tPMD4J_SEGMENT_ID,\n\tPMD4J_SEGMENT_STATUS,\n\tPMD4J_YEAR_TRANSACTION,\n\tPMD4J_MONTH_TRANSACTION,\n\tPMD4J_DAY_TRANSACTION,\n\tPMD4J_SEGMENT_LEVEL_CODE,\n\tPMD4J_SEGMENT_PART_CODE,\n\tPMD4J_SUB_PART_CODE,\n\tPMD4J_INSURANCE_LINE,\n\tPMD4J_LOCATION_NUMBER,\n\tPMD4J_SUB_LOCATION_NUMBER,\n\tPMD4J_RISK_UNIT_GROUP,\n\tPMD4J_SEQ_RSK_UNT_GRP,\n\tPMD4J_RISK_UNIT,\n\tPMD4J_RISK_SEQUENCE,\n\tPMD4J_RISK_TYPE_IND,\n\tPMD4J_YEAR_ITEM_EFFECTIVE,\n\tPMD4J_MONTH_ITEM_EFFECTIVE,\n\tPMD4J_DAY_ITEM_EFFECTIVE,\n\tPMD4J_USE_CODE,\n\tPMD4J_SEQUENCE_USE_CODE,\n\tPMD4J_YEAR_PROCESS,\n\tPMD4J_MONTH_PROCESS,\n\tPMD4J_DAY_PROCESS,\n\tPMD4J_USE_CODE_DATA,\n\tPMD4J_SORT_NAME,\n\tPMD4J_TAX_LOC,\n\tPMD4J_NAME_TYPE_IND,\n\tPMD4J_ADDRESS_LINE_1,\n\tPMD4J_ADDR_LIN_2_POS_1,\n\tPMD4J_ADDR_LIN_2_POS_2_30,\n\tPMD4J_ADDRESS_LINE_3,\n\tPMD4J_ADDRESS_LINE_4,\n\tPMD4J_ID_NUMBER_9,\n\tPMD4J_POSTAL_CODE_1,\n\tPMD4J_PHONE_AREA,\n\tPMD4J_PHONE_EXCHANGE,\n\tPMD4J_PHONE_NUMBER,\n\tPMD4J_PHONE_EXTENSION,\n\tPMD4J_INTEREST_ITEM,\n\tPMD4J_LOC_LINE_EXCLUSION,\n\tPMD4J_SURCHARGE,\n\tPMD4J_MUNICIPAL_TAX,\n\tPMD4J_02_AUDIT_CODE,\n\tPMD4J_02_LEGAL_ENTITY,\n\tPMD4J_DEC_CHANGE_FLAG,\n\tPMD4J_BLKT_MISC_LOC_EXCLUSION,\n\tPMD4J_LOCATION_STATE,\n\tPMD4J_MATCHING_LOC_SW,\n\tPMD4J_ITEM_EXPIRE_YEAR_CC,\n\tPMD4J_ITEM_EXPIRE_YEAR_YY,\n\tPMD4J_ITEM_EXPIRE_MONTH,\n\tPMD4J_ITEM_EXPIRE_DAY,\n\tPMD4J_CLASS,\n\tPMD4J_NAME_EXT_IND,\n\tPMD4J_PMS_FUTURE_USE,\n\tPMD4J_WBM_ACTION_IND,\n\tPMD4J_WBM_FORM,\n\tPMD4J_WBM_CDAYS,\n\tPMD4J_WBM_CPRNT,\n\tPMD4J_DIST_AREA,\n\tPMD4J_RISK_CITY,\n\tPMD4J_SURVEY_STATUS,\n\tPMD4J_SURVEY_DATE,\n\tPMD4J_PC_INDICATOR,\n\tPMD4J_YR2000_CUST_USE,\n\tlogical_flag,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\tinf_action,\n\tinf_timestamp,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id\n\tFROM SQ_pif_43gj_stage\n),\narch_pif_43gj_stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_pif_43gj_stage\n\t(pif_43gj_stage_id, pif_symbol, pif_policy_number, pif_module, pmd4j_rec_length, pmd4j_action_code, pmd4j_file_id, pmd4j_segment_id, pmd4j_segment_status, pmd4j_year_transaction, pmd4j_month_transaction, pmd4j_day_transaction, pmd4j_segment_level_code, pmd4j_segment_part_code, pmd4j_sub_part_code, pmd4j_insurance_line, pmd4j_location_number, pmd4j_sub_location_number, pmd4j_risk_unit_group, pmd4j_seq_rsk_unt_grp, pmd4j_risk_unit, pmd4j_risk_sequence, pmd4j_risk_type_ind, pmd4j_year_item_effective, pmd4j_month_item_effective, pmd4j_day_item_effective, pmd4j_use_code, pmd4j_sequence_use_code, pmd4j_year_process, pmd4j_month_process, pmd4j_day_process, pmd4j_use_code_data, pmd4j_sort_name, pmd4j_tax_loc, pmd4j_name_type_ind, pmd4j_address_line_1, pmd4j_addr_lin_2_pos_1, pmd4j_addr_lin_2_pos_2_30, pmd4j_address_line_3, pmd4j_address_line_4, pmd4j_id_number_9, pmd4j_postal_code_1, pmd4j_phone_area, pmd4j_phone_exchange, pmd4j_phone_number, pmd4j_phone_extension, pmd4j_interest_item, pmd4j_loc_line_exclusion, pmd4j_surcharge, pmd4j_municipal_tax, pmd4j_02_audit_code, pmd4j_02_legal_entity, pmd4j_dec_change_flag, pmd4j_blkt_misc_loc_exclusion, pmd4j_location_state, pmd4j_matching_loc_sw, pmd4j_item_expire_year_cc, pmd4j_item_expire_year_yy, pmd4j_item_expire_month, pmd4j_item_expire_day, pmd4j_class, pmd4j_name_ext_ind, pmd4j_pms_future_use, pmd4j_wbm_action_ind, pmd4j_wbm_form, pmd4j_wbm_cdays, pmd4j_wbm_cprnt, pmd4j_dist_area, pmd4j_risk_city, pmd4j_survey_status, pmd4j_survey_date, pmd4j_pc_indicator, pmd4j_yr2000_cust_use, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id, inf_action, inf_timestamp)\n\tSELECT \n\tPIF_43GJ_STAGE_ID, \n\tPIF_SYMBOL AS PIF_SYMBOL, \n\tPIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, \n\tPIF_MODULE AS PIF_MODULE, \n\tPMD4J_REC_LENGTH AS PMD4J_REC_LENGTH, \n\tPMD4J_ACTION_CODE AS PMD4J_ACTION_CODE, \n\tPMD4J_FILE_ID AS PMD4J_FILE_ID, \n\tPMD4J_SEGMENT_ID AS PMD4J_SEGMENT_ID, \n\tPMD4J_SEGMENT_STATUS AS PMD4J_SEGMENT_STATUS, \n\tPMD4J_YEAR_TRANSACTION AS PMD4J_YEAR_TRANSACTION, \n\tPMD4J_MONTH_TRANSACTION AS PMD4J_MONTH_TRANSACTION, \n\tPMD4J_DAY_TRANSACTION AS PMD4J_DAY_TRANSACTION, \n\tPMD4J_SEGMENT_LEVEL_CODE AS PMD4J_SEGMENT_LEVEL_CODE, \n\tPMD4J_SEGMENT_PART_CODE AS PMD4J_SEGMENT_PART_CODE, \n\tPMD4J_SUB_PART_CODE AS PMD4J_SUB_PART_CODE, \n\tPMD4J_INSURANCE_LINE AS PMD4J_INSURANCE_LINE, \n\tPMD4J_LOCATION_NUMBER AS PMD4J_LOCATION_NUMBER, \n\tPMD4J_SUB_LOCATION_NUMBER AS PMD4J_SUB_LOCATION_NUMBER, \n\tPMD4J_RISK_UNIT_GROUP AS PMD4J_RISK_UNIT_GROUP, \n\tPMD4J_SEQ_RSK_UNT_GRP AS PMD4J_SEQ_RSK_UNT_GRP, \n\tPMD4J_RISK_UNIT AS PMD4J_RISK_UNIT, \n\tPMD4J_RISK_SEQUENCE AS PMD4J_RISK_SEQUENCE, \n\tPMD4J_RISK_TYPE_IND AS PMD4J_RISK_TYPE_IND, \n\tPMD4J_YEAR_ITEM_EFFECTIVE AS PMD4J_YEAR_ITEM_EFFECTIVE, \n\tPMD4J_MONTH_ITEM_EFFECTIVE AS PMD4J_MONTH_ITEM_EFFECTIVE, \n\tPMD4J_DAY_ITEM_EFFECTIVE AS PMD4J_DAY_ITEM_EFFECTIVE, \n\tPMD4J_USE_CODE AS PMD4J_USE_CODE, \n\tPMD4J_SEQUENCE_USE_CODE AS PMD4J_SEQUENCE_USE_CODE, \n\tPMD4J_YEAR_PROCESS AS PMD4J_YEAR_PROCESS, \n\tPMD4J_MONTH_PROCESS AS PMD4J_MONTH_PROCESS, \n\tPMD4J_DAY_PROCESS AS PMD4J_DAY_PROCESS, \n\tPMD4J_USE_CODE_DATA AS PMD4J_USE_CODE_DATA, \n\tPMD4J_SORT_NAME AS PMD4J_SORT_NAME, \n\tPMD4J_TAX_LOC AS PMD4J_TAX_LOC, \n\tPMD4J_NAME_TYPE_IND AS PMD4J_NAME_TYPE_IND, \n\tPMD4J_ADDRESS_LINE_1 AS PMD4J_ADDRESS_LINE_1, \n\tPMD4J_ADDR_LIN_2_POS_1 AS PMD4J_ADDR_LIN_2_POS_1, \n\tPMD4J_ADDR_LIN_2_POS_2_30 AS PMD4J_ADDR_LIN_2_POS_2_30, \n\tPMD4J_ADDRESS_LINE_3 AS PMD4J_ADDRESS_LINE_3, \n\tPMD4J_ADDRESS_LINE_4 AS PMD4J_ADDRESS_LINE_4, \n\tPMD4J_ID_NUMBER_9 AS PMD4J_ID_NUMBER_9, \n\tPMD4J_POSTAL_CODE_1 AS PMD4J_POSTAL_CODE_1, \n\tPMD4J_PHONE_AREA AS PMD4J_PHONE_AREA, \n\tPMD4J_PHONE_EXCHANGE AS PMD4J_PHONE_EXCHANGE, \n\tPMD4J_PHONE_NUMBER AS PMD4J_PHONE_NUMBER, \n\tPMD4J_PHONE_EXTENSION AS PMD4J_PHONE_EXTENSION, \n\tPMD4J_INTEREST_ITEM AS PMD4J_INTEREST_ITEM, \n\tPMD4J_LOC_LINE_EXCLUSION AS PMD4J_LOC_LINE_EXCLUSION, \n\tPMD4J_SURCHARGE AS PMD4J_SURCHARGE, \n\tPMD4J_MUNICIPAL_TAX AS PMD4J_MUNICIPAL_TAX, \n\tPMD4J_02_AUDIT_CODE AS PMD4J_02_AUDIT_CODE, \n\tPMD4J_02_LEGAL_ENTITY AS PMD4J_02_LEGAL_ENTITY, \n\tPMD4J_DEC_CHANGE_FLAG AS PMD4J_DEC_CHANGE_FLAG, \n\tPMD4J_BLKT_MISC_LOC_EXCLUSION AS PMD4J_BLKT_MISC_LOC_EXCLUSION, \n\tPMD4J_LOCATION_STATE AS PMD4J_LOCATION_STATE, \n\tPMD4J_MATCHING_LOC_SW AS PMD4J_MATCHING_LOC_SW, \n\tPMD4J_ITEM_EXPIRE_YEAR_CC AS PMD4J_ITEM_EXPIRE_YEAR_CC, \n\tPMD4J_ITEM_EXPIRE_YEAR_YY AS PMD4J_ITEM_EXPIRE_YEAR_YY, \n\tPMD4J_ITEM_EXPIRE_MONTH AS PMD4J_ITEM_EXPIRE_MONTH, \n\tPMD4J_ITEM_EXPIRE_DAY AS PMD4J_ITEM_EXPIRE_DAY, \n\tPMD4J_CLASS AS PMD4J_CLASS, \n\tPMD4J_NAME_EXT_IND AS PMD4J_NAME_EXT_IND, \n\tPMD4J_PMS_FUTURE_USE AS PMD4J_PMS_FUTURE_USE, \n\tPMD4J_WBM_ACTION_IND AS PMD4J_WBM_ACTION_IND, \n\tPMD4J_WBM_FORM AS PMD4J_WBM_FORM, \n\tPMD4J_WBM_CDAYS AS PMD4J_WBM_CDAYS, \n\tPMD4J_WBM_CPRNT AS PMD4J_WBM_CPRNT, \n\tPMD4J_DIST_AREA AS PMD4J_DIST_AREA, \n\tPMD4J_RISK_CITY AS PMD4J_RISK_CITY, \n\tPMD4J_SURVEY_STATUS AS PMD4J_SURVEY_STATUS, \n\tPMD4J_SURVEY_DATE AS PMD4J_SURVEY_DATE, \n\tPMD4J_PC_INDICATOR AS PMD4J_PC_INDICATOR, \n\tPMD4J_YR2000_CUST_USE AS PMD4J_YR2000_CUST_USE, \n\tLOGICAL_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\to_audit_id AS AUDIT_ID, \n\tINF_ACTION, \n\tINF_TIMESTAMP\n\tFROM EXP_PIF_43GJ_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}