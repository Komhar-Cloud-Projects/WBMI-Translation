{
    "name": "s_m_FEED_PMS_FIS_CustomerDataFile",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_PMS_FIS_CustomerDataFile",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PMS_FIS_PL_CustomerDataFile_Source_FlatFile AS (\n\n-- TODO Manual --\n\n),\nEXPTRANS AS (\n\tSELECT\n\tFIELD1 AS i_Batch_Id,\n\t-- *INF*: rtrim(ltrim(i_Batch_Id))\n\trtrim(ltrim(i_Batch_Id)) AS o_Batch_id,\n\tFIELD2 AS i_Record_Indicator,\n\t-- *INF*: ltrim(rtrim(i_Record_Indicator))\n\tltrim(rtrim(i_Record_Indicator)) AS o_Record_Indicator,\n\tFIELD3 AS i_Service_Ext_Code,\n\t-- *INF*: ltrim(rtrim(i_Service_Ext_Code))\n\tltrim(rtrim(i_Service_Ext_Code)) AS o_Service_Ext_Code,\n\tFIELD4 AS i_Primary_Account_Id,\n\t-- *INF*: ltrim(rtrim(i_Primary_Account_Id))\n\tltrim(rtrim(i_Primary_Account_Id)) AS o_Primary_Account_Id,\n\tFIELD5 AS i_Secondary_Id,\n\t-- *INF*: ltrim(rtrim(i_Secondary_Id))\n\tltrim(rtrim(i_Secondary_Id)) AS o_Secondary_Id,\n\tFIELD6 AS i_Additional_Authentication_Id,\n\t-- *INF*: rtrim(ltrim(i_Additional_Authentication_Id))\n\trtrim(ltrim(i_Additional_Authentication_Id)) AS o_Additional_Authentication_Id,\n\tFIELD7 AS i_Display_Info_1,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_1))\n\trtrim(ltrim(i_Display_Info_1)) AS o_Display_Info_1,\n\tFIELD8 AS i_Display_Info_2,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_2))\n\trtrim(ltrim(i_Display_Info_2)) AS o_Display_Info_2,\n\tFIELD9 AS i_Display_Info_3,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_3))\n\trtrim(ltrim(i_Display_Info_3)) AS o_Display_Info_3,\n\tFIELD10 AS i_Display_Info_4,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_4))\n\trtrim(ltrim(i_Display_Info_4)) AS o_Display_Info_4,\n\tFIELD11 AS i_Display_Info_5,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_5))\n\trtrim(ltrim(i_Display_Info_5)) AS o_Display_Info_5,\n\tFIELD12 AS i_Display_Info_6,\n\t-- *INF*: rtrim(ltrim(i_Display_Info_6))\n\trtrim(ltrim(i_Display_Info_6)) AS o_Display_Info_6,\n\tFIELD13 AS i_Total_Amount_Due,\n\t-- *INF*: TO_DECIMAL(i_Total_Amount_Due,2)\n\tCAST(i_Total_Amount_Due AS FLOAT) AS o_Total_Amount_Due,\n\tFIELD14 AS i_Date_Due,\n\t-- *INF*: rtrim(ltrim(i_Date_Due))\n\trtrim(ltrim(i_Date_Due)) AS o_Date_Due,\n\tFIELD15 AS i_Pre_fill_1,\n\t-- *INF*: rtrim(ltrim(i_Pre_fill_1))\n\trtrim(ltrim(i_Pre_fill_1)) AS o_Pre_fill_1,\n\tFIELD16 AS i_Pre_fill_2,\n\t-- *INF*: rtrim(ltrim(i_Pre_fill_2))\n\trtrim(ltrim(i_Pre_fill_2)) AS o_Pre_fill_2,\n\tFIELD17 AS i_Pre_fill_3,\n\t-- *INF*: rtrim(ltrim(i_Pre_fill_3))\n\trtrim(ltrim(i_Pre_fill_3)) AS o_Pre_fill_3,\n\tFIELD18 AS i_Payment_Future_Placeholder,\n\t-- *INF*: rtrim(ltrim(i_Payment_Future_Placeholder))\n\trtrim(ltrim(i_Payment_Future_Placeholder)) AS o_Payment_Future_Placeholder,\n\tFIELD19 AS i_Credit_Card_Allowed,\n\t-- *INF*: ltrim(rtrim(i_Credit_Card_Allowed))\n\tltrim(rtrim(i_Credit_Card_Allowed)) AS o_Credit_Card_Allowed,\n\tFIELD20 AS i_ACH_Allowed,\n\t-- *INF*: rtrim(ltrim(i_ACH_Allowed))\n\trtrim(ltrim(i_ACH_Allowed)) AS o_ACH_Allowed,\n\tFIELD21 AS i_Customer_Type,\n\t-- *INF*: rtrim(ltrim(i_Customer_Type))\n\trtrim(ltrim(i_Customer_Type)) AS o_Customer_Type,\n\tFIELD22 AS i_Last_Name,\n\t-- *INF*: rtrim(ltrim(i_Last_Name))\n\trtrim(ltrim(i_Last_Name)) AS o_Last_Name,\n\tFIELD23 AS i_First_Name,\n\t-- *INF*: rtrim(ltrim(i_First_Name))\n\trtrim(ltrim(i_First_Name)) AS o_First_Name,\n\tFIELD24 AS i_Business_Name___Full_Name,\n\t-- *INF*: rtrim(ltrim(i_Business_Name___Full_Name))\n\trtrim(ltrim(i_Business_Name___Full_Name)) AS o_Business_Name___Full_Name,\n\tFIELD25 AS i_Secondary_Name___Joint_holder_Name,\n\t-- *INF*: rtrim(ltrim(i_Secondary_Name___Joint_holder_Name))\n\trtrim(ltrim(i_Secondary_Name___Joint_holder_Name)) AS o_Secondary_Name___Joint_holder_Name,\n\tFIELD26 AS i_Address_Line_1,\n\t-- *INF*: rtrim(ltrim(i_Address_Line_1))\n\trtrim(ltrim(i_Address_Line_1)) AS o_Address_Line_1,\n\tFIELD27 AS i_Address_Line_2,\n\t-- *INF*: rtrim(ltrim(i_Address_Line_2))\n\trtrim(ltrim(i_Address_Line_2)) AS o_Address_Line_2,\n\tFIELD28 AS i_City,\n\t-- *INF*: rtrim(ltrim(i_City))\n\trtrim(ltrim(i_City)) AS o_City,\n\tFIELD29 AS i_State,\n\t-- *INF*: rtrim(ltrim(i_State))\n\trtrim(ltrim(i_State)) AS o_State,\n\tFIELD30 AS i_ZIP_Postal_Code,\n\t-- *INF*: rtrim(ltrim(i_ZIP_Postal_Code))\n\trtrim(ltrim(i_ZIP_Postal_Code)) AS o_ZIP_Postal_Code,\n\tFIELD31 AS i_Day_time_telephone,\n\t-- *INF*: rtrim(ltrim(i_Day_time_telephone))\n\trtrim(ltrim(i_Day_time_telephone)) AS o_Day_time_telephone,\n\tFIELD32 AS i_E_mail,\n\t-- *INF*: rtrim(ltrim(i_E_mail))\n\trtrim(ltrim(i_E_mail)) AS o_E_mail,\n\tFIELD33 AS i_Marketing_URL,\n\t-- *INF*: rtrim(ltrim(i_Marketing_URL))\n\trtrim(ltrim(i_Marketing_URL)) AS o_Marketing_URL,\n\tFIELD34 AS i_Detailed_Bill_URL,\n\t-- *INF*: rtrim(ltrim(i_Detailed_Bill_URL))\n\trtrim(ltrim(i_Detailed_Bill_URL)) AS o_Detailed_Bill_URL,\n\tFIELD35 AS i_Sales_Tax_Amount,\n\t-- *INF*: rtrim(ltrim(i_Sales_Tax_Amount))\n\trtrim(ltrim(i_Sales_Tax_Amount)) AS o_Sales_Tax_Amount,\n\tFIELD36 AS i_Pre_Fill_Field,\n\t-- *INF*: rtrim(ltrim(i_Pre_Fill_Field))\n\trtrim(ltrim(i_Pre_Fill_Field)) AS o_Pre_Fill_Field,\n\tFIELD37 AS i_Invoice___PO_Number,\n\t-- *INF*: rtrim(ltrim(i_Invoice___PO_Number))\n\trtrim(ltrim(i_Invoice___PO_Number)) AS o_Invoice___PO_Number,\n\tFIELD38 AS i_Insert_Code,\n\t-- *INF*: rtrim(ltrim(i_Insert_Code))\n\trtrim(ltrim(i_Insert_Code)) AS o_Insert_Code,\n\tFIELD39 AS i_Custom_Account_Category,\n\t-- *INF*: rtrim(ltrim(i_Custom_Account_Category))\n\trtrim(ltrim(i_Custom_Account_Category)) AS o_Custom_Account_Category,\n\tFIELD40 AS i_New_Bill_Drop,\n\t-- *INF*: rtrim(ltrim(i_New_Bill_Drop))\n\trtrim(ltrim(i_New_Bill_Drop)) AS o_New_Bill_Drop,\n\tFIELD41 AS i_New_Bill_Drop_Date,\n\t-- *INF*: rtrim(ltrim(i_New_Bill_Drop_Date))\n\trtrim(ltrim(i_New_Bill_Drop_Date)) AS o_New_Bill_Drop_Date,\n\tFIELD42 AS i_Bill_Amount_1,\n\t-- *INF*: rtrim(ltrim(i_Bill_Amount_1))\n\trtrim(ltrim(i_Bill_Amount_1)) AS o_Bill_Amount_1,\n\tFIELD43 AS i_Bill_Amount_2,\n\t-- *INF*: rtrim(ltrim(i_Bill_Amount_2))\n\trtrim(ltrim(i_Bill_Amount_2)) AS o_Bill_Amount_2,\n\tFIELD44 AS i_Bill_Amount_3,\n\t-- *INF*: rtrim(ltrim(i_Bill_Amount_3))\n\trtrim(ltrim(i_Bill_Amount_3)) AS o_Bill_Amount_3,\n\tFIELD45 AS i_Bill_Amount_4,\n\t-- *INF*: rtrim(ltrim(i_Bill_Amount_4))\n\trtrim(ltrim(i_Bill_Amount_4)) AS o_Bill_Amount_4,\n\tFIELD46 AS i_Signature_Debit__Allowed,\n\t-- *INF*: rtrim(ltrim(i_Signature_Debit__Allowed))\n\trtrim(ltrim(i_Signature_Debit__Allowed)) AS o_Signature_Debit__Allowed,\n\tFIELD47 AS i_Payment_Amount__Future_Use,\n\t-- *INF*: rtrim(ltrim(i_Payment_Amount__Future_Use))\n\trtrim(ltrim(i_Payment_Amount__Future_Use)) AS o_Payment_Amount__Future_Use,\n\tFIELD48 AS i_Payment_Flag_Future_Use,\n\t-- *INF*: rtrim(ltrim(i_Payment_Flag_Future_Use))\n\trtrim(ltrim(i_Payment_Flag_Future_Use)) AS o_Payment_Flag_Future_Use\n\tFROM SQ_PMS_FIS_PL_CustomerDataFile_Source_FlatFile\n),\nFIS_CDF_Detail_PMS AS (\n\tINSERT INTO FIS_CDF_Detail\n\t(Batch_Id, Record_Indicator, Service_Ext_Code, Primary_Account_Id, Secondary_Id, Additional_Authentication_Id, Display_Info_1, Display_Info_2, Display_Info_3, Display_Info_4, Display_Info_5, Display_Info_6, Total_Amount_Due, Date_Due, Pre_fill_1, Pre_fill_2, Pre_fill_3, Payment_Future_Placeholder, Credit_Card_Allowed, ACH_Allowed, Customer_Type, Last_Name, First_Name, Business_Name_/_Full_Name, Secondary_Name_/_Joint_holder_Name, Address_Line_1, Address_Line_2, City, State, ZIP/Postal_Code, Day_time_telephone, E_mail, Marketing_URL, Detailed_Bill_URL, Sales_Tax_Amount, Pre_Fill_Field, Invoice_/_PO_Number, Insert_Code, Custom_Account_Category, New_Bill_Drop, New_Bill_Drop_Date, Bill_Amount_1, Bill_Amount_2, Bill_Amount_3, Bill_Amount_4, Signature_Debit__Allowed, Payment_Amount__Future_Use, Payment_Flag_Future_Use)\n\tSELECT \n\to_Batch_id AS BATCH_ID, \n\to_Record_Indicator AS RECORD_INDICATOR, \n\to_Service_Ext_Code AS SERVICE_EXT_CODE, \n\to_Primary_Account_Id AS PRIMARY_ACCOUNT_ID, \n\to_Secondary_Id AS SECONDARY_ID, \n\to_Additional_Authentication_Id AS ADDITIONAL_AUTHENTICATION_ID, \n\to_Display_Info_1 AS DISPLAY_INFO_1, \n\to_Display_Info_2 AS DISPLAY_INFO_2, \n\to_Display_Info_3 AS DISPLAY_INFO_3, \n\to_Display_Info_4 AS DISPLAY_INFO_4, \n\to_Display_Info_5 AS DISPLAY_INFO_5, \n\to_Display_Info_6 AS DISPLAY_INFO_6, \n\to_Total_Amount_Due AS TOTAL_AMOUNT_DUE, \n\to_Date_Due AS DATE_DUE, \n\to_Pre_fill_1 AS PRE_FILL_1, \n\to_Pre_fill_2 AS PRE_FILL_2, \n\to_Pre_fill_3 AS PRE_FILL_3, \n\to_Payment_Future_Placeholder AS PAYMENT_FUTURE_PLACEHOLDER, \n\to_Credit_Card_Allowed AS CREDIT_CARD_ALLOWED, \n\to_ACH_Allowed AS ACH_ALLOWED, \n\to_Customer_Type AS CUSTOMER_TYPE, \n\to_Last_Name AS LAST_NAME, \n\to_First_Name AS FIRST_NAME, \n\to_Business_Name___Full_Name AS BUSINESS_NAME_/_FULL_NAME, \n\to_Secondary_Name___Joint_holder_Name AS SECONDARY_NAME_/_JOINT_HOLDER_NAME, \n\to_Address_Line_1 AS ADDRESS_LINE_1, \n\to_Address_Line_2 AS ADDRESS_LINE_2, \n\to_City AS CITY, \n\to_State AS STATE, \n\to_ZIP_Postal_Code AS ZIP/POSTAL_CODE, \n\to_Day_time_telephone AS DAY_TIME_TELEPHONE, \n\to_E_mail AS E_MAIL, \n\to_Marketing_URL AS MARKETING_URL, \n\to_Detailed_Bill_URL AS DETAILED_BILL_URL, \n\to_Sales_Tax_Amount AS SALES_TAX_AMOUNT, \n\to_Pre_Fill_Field AS PRE_FILL_FIELD, \n\to_Invoice___PO_Number AS INVOICE_/_PO_NUMBER, \n\to_Insert_Code AS INSERT_CODE, \n\to_Custom_Account_Category AS CUSTOM_ACCOUNT_CATEGORY, \n\to_New_Bill_Drop AS NEW_BILL_DROP, \n\to_New_Bill_Drop_Date AS NEW_BILL_DROP_DATE, \n\to_Bill_Amount_1 AS BILL_AMOUNT_1, \n\to_Bill_Amount_2 AS BILL_AMOUNT_2, \n\to_Bill_Amount_3 AS BILL_AMOUNT_3, \n\to_Bill_Amount_4 AS BILL_AMOUNT_4, \n\to_Signature_Debit__Allowed AS SIGNATURE_DEBIT__ALLOWED, \n\to_Payment_Amount__Future_Use AS PAYMENT_AMOUNT__FUTURE_USE, \n\to_Payment_Flag_Future_Use AS PAYMENT_FLAG_FUTURE_USE\n\tFROM EXPTRANS\n),\nAGG_Count_Records AS (\n\tSELECT\n\to_Batch_id AS Batch_Id,\n\to_Record_Indicator AS Record_Indicator,\n\t-- *INF*: TO_CHAR(COUNT(Record_Indicator))\n\tTO_CHAR(COUNT(Record_Indicator)) AS Number_Of_Records\n\tFROM EXPTRANS\n\tGROUP BY Batch_Id\n),\nEXP_Output_Header_Trailer AS (\n\tSELECT\n\tBatch_Id,\n\t'H' AS Record_Indicator_Header,\n\t'T' AS Record_Indicator_Trailer,\n\t'723021300' AS Biller_Id,\n\tNumber_Of_Records,\n\t'' AS DefaultEmptyString\n\tFROM AGG_Count_Records\n),\nFIS_CDF_Detail_Trailer_PMS AS (\n\tINSERT INTO FIS_CDF_Detail_Trailer\n\t(Batch_Id, Record_Indicator, Number_Of_Records)\n\tSELECT \n\tBATCH_ID, \n\tRecord_Indicator_Trailer AS RECORD_INDICATOR, \n\tNUMBER_OF_RECORDS\n\tFROM EXP_Output_Header_Trailer\n),\nFIS_CDF_Detail_Header_PMS AS (\n\tINSERT INTO FIS_CDF_Detail_Header\n\t(Batch_Id, Record_Indicator, Date_Generated, Biller_Id)\n\tSELECT \n\tBATCH_ID, \n\tRecord_Indicator_Header AS RECORD_INDICATOR, \n\tDefaultEmptyString AS DATE_GENERATED, \n\tBILLER_ID\n\tFROM EXP_Output_Header_Trailer\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {},
        "folder": {
            "name": "DataFeed -Informatica/BillingDataServices/"
        },
        "annotations": []
    }
}