WITH
SQ_med_bill_service_stage AS (
	SELECT
		med_bill_service_stage_id,
		med_bill_serv_id,
		med_bill_id,
		serv_seq_num,
		serv_from_date,
		serv_to_date,
		serv_place_code,
		serv_type_code,
		adjusted_code1,
		adjusted_code2,
		mod_proc_code1,
		mod_proc_descript1,
		mod_proc_code2,
		mod_proc_descript2,
		serv_minutes,
		serv_units,
		drug_qty_dispensed,
		drug_qty_allowed,
		drug_awp,
		proc_drug_rev_ind,
		proc_drug_rev_code,
		proc_drug_rev_des,
		serv_charge,
		serv_red,
		serv_network_red,
		serv_recom_pay,
		serv_review_cmnt,
		diagnose_cross_ref,
		extract_date,
		as_of_date,
		record_count,
		source_system_id
	FROM med_bill_service_stage
),
EXP_arch_med_bill_service_stage AS (
	SELECT
	med_bill_service_stage_id,
	med_bill_serv_id,
	med_bill_id,
	serv_seq_num,
	serv_from_date,
	serv_to_date,
	serv_place_code,
	serv_type_code,
	adjusted_code1,
	adjusted_code2,
	mod_proc_code1,
	mod_proc_descript1,
	mod_proc_code2,
	mod_proc_descript2,
	serv_minutes,
	serv_units,
	drug_qty_dispensed,
	drug_qty_allowed,
	drug_awp,
	proc_drug_rev_ind,
	proc_drug_rev_code,
	proc_drug_rev_des,
	serv_charge,
	serv_red,
	serv_network_red,
	serv_recom_pay,
	serv_review_cmnt,
	diagnose_cross_ref,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_med_bill_service_stage
),
arch_med_bill_service_stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_med_bill_service_stage
	(med_bill_service_stage_id, med_bill_serv_id, med_bill_id, serv_seq_num, serv_from_date, serv_to_date, serv_place_code, serv_type_code, adjusted_code1, adjusted_code2, mod_proc_code1, mod_proc_descript1, mod_proc_code2, mod_proc_descript2, serv_minutes, serv_units, drug_qty_dispensed, drug_qty_allowed, drug_awp, proc_drug_rev_ind, proc_drug_rev_code, proc_drug_rev_des, serv_charge, serv_red, serv_network_red, serv_recom_pay, serv_review_cmnt, diagnose_cross_ref, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	MED_BILL_SERVICE_STAGE_ID, 
	MED_BILL_SERV_ID, 
	MED_BILL_ID, 
	SERV_SEQ_NUM, 
	SERV_FROM_DATE, 
	SERV_TO_DATE, 
	SERV_PLACE_CODE, 
	SERV_TYPE_CODE, 
	ADJUSTED_CODE1, 
	ADJUSTED_CODE2, 
	MOD_PROC_CODE1, 
	MOD_PROC_DESCRIPT1, 
	MOD_PROC_CODE2, 
	MOD_PROC_DESCRIPT2, 
	SERV_MINUTES, 
	SERV_UNITS, 
	DRUG_QTY_DISPENSED, 
	DRUG_QTY_ALLOWED, 
	DRUG_AWP, 
	PROC_DRUG_REV_IND, 
	PROC_DRUG_REV_CODE, 
	PROC_DRUG_REV_DES, 
	SERV_CHARGE, 
	SERV_RED, 
	SERV_NETWORK_RED, 
	SERV_RECOM_PAY, 
	SERV_REVIEW_CMNT, 
	DIAGNOSE_CROSS_REF, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_arch_med_bill_service_stage
),