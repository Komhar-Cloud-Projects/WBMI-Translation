{
    "name": "s_m_POL_ExampleIDO_STG_Insert_WBCUUmbrellaCommercialAutoStaging",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_STG_Insert_WBCUUmbrellaCommercialAu_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WB_CU_UmbrellaCommercialAuto AS (\n\tWITH cte_WBCUUmbrellaCommercialAuto(Sessionid) as\r\n\t(select sessionid from @{pipeline().parameters.SOURCE_DATABASE_WB}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.WB_EDWIncrementalDataQualitySessions where ModifiedDate between '@{pipeline().parameters.SELECTION_START_TS}' and '@{pipeline().parameters.SELECTION_END_TS}' \r\n\tAND Autoshred<> '1' \r\n\t UNION \r\n\t select distinct A.sessionid from @{pipeline().parameters.SOURCE_TABLE_OWNER}.DC_Session A Inner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.DC_Transaction B on A.SessionID=B.SessionID where B.State<> 'committed' and A.CreateDateTime>='@{pipeline().parameters.SELECTION_START_TS}')\r\n\tSELECT \r\n\tX.CU_UmbrellaCommercialAutoId, \r\n\tX.WB_CU_UmbrellaCommercialAutoId, \r\n\tX.SessionId, \r\n\tX.Deleted, \r\n\tX.AggregateLimit, \r\n\tX.LiabilityLimitEachAccidentGarageOperationsAutoOnly, \r\n\tX.LiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, \r\n\tX.PersonalInjury, \r\n\tX.OtherDescription, \r\n\tX.HiredNonOwnedOnlyPremium, \r\n\tX.HiredNonOwnedOnlyPremiumAudited, \r\n\tX.LocalOwnerOperatorPremium, \r\n\tX.LocalOwnerOperatorPremiumAudited, \r\n\tX.IntermediateOwnerOperatorPremium, \r\n\tX.IntermediateOwnerOperatorPremiumAudited, \r\n\tX.LongHaulOwnerOperatorPremium, \r\n\tX.LongHaulOwnerOperatorPremiumAudited, \r\n\tX.GarageLiabilityPremium, \r\n\tX.GarageLiabilityPremiumAudited, \r\n\tX.FirstMillionBasePremium, \r\n\tX.ExtraHeavyTruckTractorPremiumAudited, \r\n\tX.ExtraHeavyTruckTractorPremium, \r\n\tX.ReinsurancePremium, \r\n\tX.FirstMillionBasePremiumForGarage, \r\n\tX.FirstMillionBasePremiumForRatingWorksheetModifiedPremium, \r\n\tX.BusCount, \r\n\tX.BusCountAudited, \r\n\tX.LocalOwnerOperatorCount, \r\n\tX.LocalOwnerOperatorCountAudited, \r\n\tX.IntermediateOwnerOperatorCount, \r\n\tX.IntermediateOwnerOperatorCountAudited, \r\n\tX.LongHaulOwnerOperatorCount, \r\n\tX.LongHaulOwnerOperatorCountAudited, \r\n\tX.ExtraHeavyTruckTractorCountAudited, \r\n\tX.ExtraHeavyTruckTractorCount, \r\n\tX.PrivatePassengerPremiumOverride, \r\n\tX.LightVehiclePremiumOverride, \r\n\tX.MediumVehiclePremiumOverride, \r\n\tX.HeavyVehiclePremiumOverride, \r\n\tX.ExtraHeavyVehiclePremiumOverride, \r\n\tX.BusPremiumOverride, \r\n\tX.HiredNonOwnedOnlyPremiumOverride, \r\n\tX.GarageLiabilityPremiumOverride, \r\n\tX.AllOtherPremiumOverride, \r\n\tX.ExtraHeavyTruckTractorPremiumOverride, \r\n\tX.PrivatePassengerRevisedPremium, \r\n\tX.LightVehicleRevisedPremium, \r\n\tX.MediumVehicleRevisedPremium, \r\n\tX.HeavyVehicleRevisedPremium, \r\n\tX.ExtraHeavyVehicleRevisedPremium, \r\n\tX.BusRevisedPremium, \r\n\tX.HiredNonOwnedOnlyRevisedPremium, \r\n\tX.AllOtherRevisedPremium, \r\n\tX.GarageLiabilityRevisedPremium, \r\n\tX.ExtraHeavyTruckTractorRevisedPremium, \r\n\tX.ScheduledModification, \r\n\tX.FirstMillionModifiedPremium, \r\n\tX.ReinsuranceFactor, \r\n\tX.OriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, \r\n\tX.OriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly, \r\n\tX.GarageLiabilityLimitsHeader, \r\n\tX.IDField, \r\n\tX.AutoLocationScheduleModDispersionComment, \r\n\tX.AutoLocationScheduleModDispersionModification, \r\n\tX.AutoLocationScheduleModEmployeesComment, \r\n\tX.AutoLocationScheduleModEmployeesModification, \r\n\tX.AutoLocationScheduleModEquipmentComment, \r\n\tX.AutoLocationScheduleModEquipmentModification, \r\n\tX.AutoLocationScheduleModManagementComment, \r\n\tX.AutoLocationScheduleModManagementModification, \r\n\tX.AutoLocationScheduleModProtectionComment, \r\n\tX.AutoLocationScheduleModProtectionModification, \r\n\tX.AutoLocationScheduleModSafetyComment, \r\n\tX.AutoLocationScheduleModSafetyModification, \r\n\tX.ModificationTotal, \r\n\tX.ModificationTotalForAutoDetailPage \r\n\tFROM\r\n\tWB_CU_UmbrellaCommercialAuto X\r\n\tinner join\r\n\tcte_WBCUUmbrellaCommercialAuto Y on X.Sessionid = Y.Sessionid\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Metadata AS (\n\tSELECT\n\tsysdate AS o_ExtractDate,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS o_SourceSystemId,\n\tCU_UmbrellaCommercialAutoId,\n\tWB_CU_UmbrellaCommercialAutoId,\n\tSessionId,\n\tDeleted,\n\t-- *INF*: DECODE(Deleted,'T',1,'F',0,NULL)\n\tDECODE(\n\t    Deleted,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS Deleted_out,\n\tAggregateLimit,\n\tLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\tLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\tPersonalInjury,\n\tOtherDescription,\n\tHiredNonOwnedOnlyPremium,\n\tHiredNonOwnedOnlyPremiumAudited,\n\tLocalOwnerOperatorPremium,\n\tLocalOwnerOperatorPremiumAudited,\n\tIntermediateOwnerOperatorPremium,\n\tIntermediateOwnerOperatorPremiumAudited,\n\tLongHaulOwnerOperatorPremium,\n\tLongHaulOwnerOperatorPremiumAudited,\n\tGarageLiabilityPremium,\n\tGarageLiabilityPremiumAudited,\n\tFirstMillionBasePremium,\n\tExtraHeavyTruckTractorPremiumAudited,\n\tExtraHeavyTruckTractorPremium,\n\tReinsurancePremium,\n\tFirstMillionBasePremiumForGarage,\n\tFirstMillionBasePremiumForRatingWorksheetModifiedPremium,\n\tBusCount,\n\tBusCountAudited,\n\tLocalOwnerOperatorCount,\n\tLocalOwnerOperatorCountAudited,\n\tIntermediateOwnerOperatorCount,\n\tIntermediateOwnerOperatorCountAudited,\n\tLongHaulOwnerOperatorCount,\n\tLongHaulOwnerOperatorCountAudited,\n\tExtraHeavyTruckTractorCountAudited,\n\tExtraHeavyTruckTractorCount,\n\tPrivatePassengerPremiumOverride,\n\t-- *INF*: DECODE(PrivatePassengerPremiumOverride,'T','1','F','0',NULL)\n\tDECODE(\n\t    PrivatePassengerPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS PrivatePassengerPremiumOverride_out,\n\tLightVehiclePremiumOverride,\n\t-- *INF*: DECODE(LightVehiclePremiumOverride,'T','1','F','0',NULL)\n\tDECODE(\n\t    LightVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS LightVehiclePremiumOverride_out,\n\tMediumVehiclePremiumOverride,\n\t-- *INF*: decode(MediumVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    MediumVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS MediumVehiclePremiumOverride_out,\n\tHeavyVehiclePremiumOverride,\n\t-- *INF*: decode(HeavyVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    HeavyVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS HeavyVehiclePremiumOverride_out,\n\tExtraHeavyVehiclePremiumOverride,\n\t-- *INF*: decode(ExtraHeavyVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    ExtraHeavyVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS ExtraHeavyVehiclePremiumOverride_out,\n\tBusPremiumOverride,\n\t-- *INF*: decode(BusPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    BusPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS BusPremiumOverride_out,\n\tHiredNonOwnedOnlyPremiumOverride,\n\t-- *INF*: decode(HiredNonOwnedOnlyPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    HiredNonOwnedOnlyPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS HiredNonOwnedOnlyPremiumOverride_out,\n\tGarageLiabilityPremiumOverride,\n\t-- *INF*: decode(GarageLiabilityPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    GarageLiabilityPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS GarageLiabilityPremiumOverride_out,\n\tAllOtherPremiumOverride,\n\t-- *INF*: decode(AllOtherPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    AllOtherPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS AllOtherPremiumOverride_out,\n\tExtraHeavyTruckTractorPremiumOverride,\n\t-- *INF*: decode(ExtraHeavyTruckTractorPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    ExtraHeavyTruckTractorPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS ExtraHeavyTruckTractorPremiumOverride_out,\n\tPrivatePassengerRevisedPremium,\n\tLightVehicleRevisedPremium,\n\tMediumVehicleRevisedPremium,\n\tHeavyVehicleRevisedPremium,\n\tExtraHeavyVehicleRevisedPremium,\n\tBusRevisedPremium,\n\tHiredNonOwnedOnlyRevisedPremium,\n\tAllOtherRevisedPremium,\n\tGarageLiabilityRevisedPremium,\n\tExtraHeavyTruckTractorRevisedPremium,\n\tScheduledModification,\n\tFirstMillionModifiedPremium,\n\tReinsuranceFactor,\n\tOriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\tOriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\tGarageLiabilityLimitsHeader,\n\tIDField,\n\tAutoLocationScheduleModDispersionComment,\n\tAutoLocationScheduleModDispersionModification,\n\tAutoLocationScheduleModEmployeesComment,\n\tAutoLocationScheduleModEmployeesModification,\n\tAutoLocationScheduleModEquipmentComment,\n\tAutoLocationScheduleModEquipmentModification,\n\tAutoLocationScheduleModManagementComment,\n\tAutoLocationScheduleModManagementModification,\n\tAutoLocationScheduleModProtectionComment,\n\tAutoLocationScheduleModProtectionModification,\n\tAutoLocationScheduleModSafetyComment,\n\tAutoLocationScheduleModSafetyModification,\n\tModificationTotal,\n\tModificationTotalForAutoDetailPage\n\tFROM SQ_WB_CU_UmbrellaCommercialAuto\n),\nWBCUUmbrellaCommercialAutoStaging AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WBCUUmbrellaCommercialAutoStaging;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WBCUUmbrellaCommercialAutoStaging\n\t(ExtractDate, SourceSystemId, CU_UmbrellaCommercialAutoId, WB_CU_UmbrellaCommercialAutoId, SessionId, Deleted, AggregateLimit, LiabilityLimitEachAccidentGarageOperationsAutoOnly, LiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, PersonalInjury, OtherDescription, HiredNonOwnedOnlyPremium, HiredNonOwnedOnlyPremiumAudited, LocalOwnerOperatorPremium, LocalOwnerOperatorPremiumAudited, IntermediateOwnerOperatorPremium, IntermediateOwnerOperatorPremiumAudited, LongHaulOwnerOperatorPremium, LongHaulOwnerOperatorPremiumAudited, GarageLiabilityPremium, GarageLiabilityPremiumAudited, FirstMillionBasePremium, ExtraHeavyTruckTractorPremiumAudited, ExtraHeavyTruckTractorPremium, ReinsurancePremium, FirstMillionBasePremiumForGarage, FirstMillionBasePremiumForRatingWorksheetModifiedPremium, BusCount, BusCountAudited, LocalOwnerOperatorCount, LocalOwnerOperatorCountAudited, IntermediateOwnerOperatorCount, IntermediateOwnerOperatorCountAudited, LongHaulOwnerOperatorCount, LongHaulOwnerOperatorCountAudited, ExtraHeavyTruckTractorCountAudited, ExtraHeavyTruckTractorCount, PrivatePassengerPremiumOverride, LightVehiclePremiumOverride, MediumVehiclePremiumOverride, HeavyVehiclePremiumOverride, ExtraHeavyVehiclePremiumOverride, BusPremiumOverride, HiredNonOwnedOnlyPremiumOverride, GarageLiabilityPremiumOverride, AllOtherPremiumOverride, ExtraHeavyTruckTractorPremiumOverride, PrivatePassengerRevisedPremium, LightVehicleRevisedPremium, MediumVehicleRevisedPremium, HeavyVehicleRevisedPremium, ExtraHeavyVehicleRevisedPremium, BusRevisedPremium, HiredNonOwnedOnlyRevisedPremium, AllOtherRevisedPremium, GarageLiabilityRevisedPremium, ExtraHeavyTruckTractorRevisedPremium, ScheduledModification, FirstMillionModifiedPremium, ReinsuranceFactor, OriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, OriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly, GarageLiabilityLimitsHeader, IDField, AutoLocationScheduleModDispersionComment, AutoLocationScheduleModDispersionModification, AutoLocationScheduleModEmployeesComment, AutoLocationScheduleModEmployeesModification, AutoLocationScheduleModEquipmentComment, AutoLocationScheduleModEquipmentModification, AutoLocationScheduleModManagementComment, AutoLocationScheduleModManagementModification, AutoLocationScheduleModProtectionComment, AutoLocationScheduleModProtectionModification, AutoLocationScheduleModSafetyComment, AutoLocationScheduleModSafetyModification, ModificationTotal, ModificationTotalForAutoDetailPage)\n\tSELECT \n\to_ExtractDate AS EXTRACTDATE, \n\to_SourceSystemId AS SOURCESYSTEMID, \n\tCU_UMBRELLACOMMERCIALAUTOID, \n\tWB_CU_UMBRELLACOMMERCIALAUTOID, \n\tSESSIONID, \n\tDeleted_out AS DELETED, \n\tAGGREGATELIMIT, \n\tLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSAUTOONLY, \n\tLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSOTHERTHANAUTOONLY, \n\tPERSONALINJURY, \n\tOTHERDESCRIPTION, \n\tHIREDNONOWNEDONLYPREMIUM, \n\tHIREDNONOWNEDONLYPREMIUMAUDITED, \n\tLOCALOWNEROPERATORPREMIUM, \n\tLOCALOWNEROPERATORPREMIUMAUDITED, \n\tINTERMEDIATEOWNEROPERATORPREMIUM, \n\tINTERMEDIATEOWNEROPERATORPREMIUMAUDITED, \n\tLONGHAULOWNEROPERATORPREMIUM, \n\tLONGHAULOWNEROPERATORPREMIUMAUDITED, \n\tGARAGELIABILITYPREMIUM, \n\tGARAGELIABILITYPREMIUMAUDITED, \n\tFIRSTMILLIONBASEPREMIUM, \n\tEXTRAHEAVYTRUCKTRACTORPREMIUMAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORPREMIUM, \n\tREINSURANCEPREMIUM, \n\tFIRSTMILLIONBASEPREMIUMFORGARAGE, \n\tFIRSTMILLIONBASEPREMIUMFORRATINGWORKSHEETMODIFIEDPREMIUM, \n\tBUSCOUNT, \n\tBUSCOUNTAUDITED, \n\tLOCALOWNEROPERATORCOUNT, \n\tLOCALOWNEROPERATORCOUNTAUDITED, \n\tINTERMEDIATEOWNEROPERATORCOUNT, \n\tINTERMEDIATEOWNEROPERATORCOUNTAUDITED, \n\tLONGHAULOWNEROPERATORCOUNT, \n\tLONGHAULOWNEROPERATORCOUNTAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORCOUNTAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORCOUNT, \n\tPrivatePassengerPremiumOverride_out AS PRIVATEPASSENGERPREMIUMOVERRIDE, \n\tLightVehiclePremiumOverride_out AS LIGHTVEHICLEPREMIUMOVERRIDE, \n\tMediumVehiclePremiumOverride_out AS MEDIUMVEHICLEPREMIUMOVERRIDE, \n\tHeavyVehiclePremiumOverride_out AS HEAVYVEHICLEPREMIUMOVERRIDE, \n\tExtraHeavyVehiclePremiumOverride_out AS EXTRAHEAVYVEHICLEPREMIUMOVERRIDE, \n\tBusPremiumOverride_out AS BUSPREMIUMOVERRIDE, \n\tHiredNonOwnedOnlyPremiumOverride_out AS HIREDNONOWNEDONLYPREMIUMOVERRIDE, \n\tGarageLiabilityPremiumOverride_out AS GARAGELIABILITYPREMIUMOVERRIDE, \n\tAllOtherPremiumOverride_out AS ALLOTHERPREMIUMOVERRIDE, \n\tExtraHeavyTruckTractorPremiumOverride_out AS EXTRAHEAVYTRUCKTRACTORPREMIUMOVERRIDE, \n\tPRIVATEPASSENGERREVISEDPREMIUM, \n\tLIGHTVEHICLEREVISEDPREMIUM, \n\tMEDIUMVEHICLEREVISEDPREMIUM, \n\tHEAVYVEHICLEREVISEDPREMIUM, \n\tEXTRAHEAVYVEHICLEREVISEDPREMIUM, \n\tBUSREVISEDPREMIUM, \n\tHIREDNONOWNEDONLYREVISEDPREMIUM, \n\tALLOTHERREVISEDPREMIUM, \n\tGARAGELIABILITYREVISEDPREMIUM, \n\tEXTRAHEAVYTRUCKTRACTORREVISEDPREMIUM, \n\tSCHEDULEDMODIFICATION, \n\tFIRSTMILLIONMODIFIEDPREMIUM, \n\tREINSURANCEFACTOR, \n\tORIGINALLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSOTHERTHANAUTOONLY, \n\tORIGINALLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSAUTOONLY, \n\tGARAGELIABILITYLIMITSHEADER, \n\tIDFIELD, \n\tAUTOLOCATIONSCHEDULEMODDISPERSIONCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODDISPERSIONMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODEMPLOYEESCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODEMPLOYEESMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODEQUIPMENTCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODEQUIPMENTMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODMANAGEMENTCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODMANAGEMENTMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODPROTECTIONCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODPROTECTIONMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODSAFETYCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODSAFETYMODIFICATION, \n\tMODIFICATIONTOTAL, \n\tMODIFICATIONTOTALFORAUTODETAILPAGE\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_DATABASE_WB": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}