WITH
SQ_Pif43LXGLStage AS (
	SELECT
		Pif43LXGLStageId,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		Pmdlxg1RecLength,
		Pmdlxg1ActionCode,
		Pmdlxg1FileId,
		Pmdlxg1SegmentId,
		Pmdlxg1SegmentStatus,
		Pmdlxg1YearTransaction,
		Pmdlxg1MonthTransaction,
		Pmdlxg1DayTransaction,
		Pmdlxg1SegmentLevelCode AS PmdlxgiSegmentLevelCode,
		Pmdlxg1SegmentPartCode,
		Pmdlxg1SubPartCode,
		Pmdlxg1InsuranceLine,
		Pmdlxg1LocationNumber,
		Pmdlxg1YearItemEffective,
		Pmdlxg1MonthItemEffective,
		Pmdlxg1DayItemEffective,
		Pmdlxg1YearProcess,
		Pmdlxg1MonthProcess,
		Pmdlxg1DayProcess,
		Pmdlxg1CompanyNumber,
		Pmdlxg1YearOrigProcess,
		Pmdlxg1MonthOrigProcess,
		Pmdlxg1DayOrigProcess,
		Pmdlxg1OccurClaimsMadeInd,
		Pmdlxg1ClmsMadeYr,
		Pmdlxg1ClmsMadeMo,
		Pmdlxg1ClmsMadeDay,
		Pmdlxg1YearRetro,
		Pmdlxg1MonthRetro,
		Pmdlxg1DayRetro,
		Pmdlxg1SplitLimInd,
		Pmdlxg1FringeCode1,
		Pmdlxg1FringeRate1,
		Pmdlxg1FringeRateMgInd1,
		Pmdlxg1FringeCode2,
		Pmdlxg1FringeRate2,
		Pmdlxg1FringeRateMgInd2,
		Pmdlxg1FringeCode3,
		Pmdlxg1FringeRate3,
		Pmdlxg1FringeRateMgInd3,
		Pmdlxg1FringeCode4,
		Pmdlxg1FringeRate4,
		Pmdlxg1FringeRateMgInd4,
		Pmdlxg1FringeCode5,
		Pmdlxg1FringeRate5,
		Pmdlxg1FringeRateMgInd5,
		Pmdlxg1FringeCode6,
		Pmdlxg1FringeRate6,
		Pmdlxg1FringeRateMgInd6,
		Pmdlxg1FringeCode7,
		Pmdlxg1FringeRate7,
		Pmdlxg1FringeRateMgInd7,
		Pmdlxg1FringeCode8,
		Pmdlxg1FringeRate8,
		Pmdlxg1FringeRateMgInd8,
		Pmdlxg1FringeCode9,
		Pmdlxg1FringeRate9,
		Pmdlxg1FringeRateMgInd9,
		Pmdlxg1FringeCode10,
		Pmdlxg1FringeRate10,
		Pmdlxg1FringeRateMgInd10,
		Pmdlxg1AuditFrequencyCode,
		Pmdlxg1AuditType,
		Pmdlxg1TexasDiscInd,
		Pmdlxg1TexasDiscMgInd,
		Pmdlxg1TexasDiscPercent,
		Pmdlxg1DecChangeFlag,
		Pmdlxg1PmaCode,
		Pmdlxg1IrpmExperPercent,
		Pmdlxg1ScheduledPercent,
		Pmdlxg1ExpensePercent,
		Pmdlxg1OtherPercent,
		Pmdlxg1CommReduction,
		Pmdlxg1CommRate,
		Pmdlxg1RateLevelDate,
		Pmdlxg1WorkSheetInd,
		Pmdlxg1ProdwIndicator,
		Pmdlxg1CutOffYr,
		Pmdlxg1CutOffMo,
		Pmdlxg1CutOffDay,
		Pmdlxg1PmsFutureUse,
		Pmdlxg1CustSplUse,
		Pmdlxg1Yr2000CustUse,
		Pmdlxg1WbcKey,
		ExtractDate,
		AsOfDate,
		RecordCount,
		SourceSystemId
	FROM Pif43LXGLStage
),
EXP_Values AS (
	SELECT
	Pif43LXGLStageId AS Pif43LXStageId,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	Pmdlxg1RecLength,
	Pmdlxg1ActionCode,
	Pmdlxg1FileId,
	Pmdlxg1SegmentId,
	Pmdlxg1SegmentStatus,
	Pmdlxg1YearTransaction,
	Pmdlxg1MonthTransaction,
	Pmdlxg1DayTransaction,
	PmdlxgiSegmentLevelCode,
	Pmdlxg1SegmentPartCode,
	Pmdlxg1SubPartCode,
	Pmdlxg1InsuranceLine,
	Pmdlxg1LocationNumber,
	Pmdlxg1YearItemEffective,
	Pmdlxg1MonthItemEffective,
	Pmdlxg1DayItemEffective,
	Pmdlxg1YearProcess,
	Pmdlxg1MonthProcess,
	Pmdlxg1DayProcess,
	Pmdlxg1CompanyNumber,
	Pmdlxg1YearOrigProcess,
	Pmdlxg1MonthOrigProcess,
	Pmdlxg1DayOrigProcess,
	Pmdlxg1OccurClaimsMadeInd,
	Pmdlxg1ClmsMadeYr,
	Pmdlxg1ClmsMadeMo,
	Pmdlxg1ClmsMadeDay,
	Pmdlxg1YearRetro,
	Pmdlxg1MonthRetro,
	Pmdlxg1DayRetro,
	Pmdlxg1SplitLimInd,
	Pmdlxg1FringeCode1,
	Pmdlxg1FringeRate1,
	Pmdlxg1FringeRateMgInd1,
	Pmdlxg1FringeCode2,
	Pmdlxg1FringeRate2,
	Pmdlxg1FringeRateMgInd2,
	Pmdlxg1FringeCode3,
	Pmdlxg1FringeRate3,
	Pmdlxg1FringeRateMgInd3,
	Pmdlxg1FringeCode4,
	Pmdlxg1FringeRate4,
	Pmdlxg1FringeRateMgInd4,
	Pmdlxg1FringeCode5,
	Pmdlxg1FringeRate5,
	Pmdlxg1FringeRateMgInd5,
	Pmdlxg1FringeCode6,
	Pmdlxg1FringeRate6,
	Pmdlxg1FringeRateMgInd6,
	Pmdlxg1FringeCode7,
	Pmdlxg1FringeRate7,
	Pmdlxg1FringeRateMgInd7,
	Pmdlxg1FringeCode8,
	Pmdlxg1FringeRate8,
	Pmdlxg1FringeRateMgInd8,
	Pmdlxg1FringeCode9,
	Pmdlxg1FringeRate9,
	Pmdlxg1FringeRateMgInd9,
	Pmdlxg1FringeCode10,
	Pmdlxg1FringeRate10,
	Pmdlxg1FringeRateMgInd10,
	Pmdlxg1AuditFrequencyCode,
	Pmdlxg1AuditType,
	Pmdlxg1TexasDiscInd,
	Pmdlxg1TexasDiscMgInd,
	Pmdlxg1TexasDiscPercent,
	Pmdlxg1DecChangeFlag,
	Pmdlxg1PmaCode,
	Pmdlxg1IrpmExperPercent AS Pmdlxg1IrpmExperPerce,
	Pmdlxg1ScheduledPercent AS Pmdlxg1ScheduledPercen,
	Pmdlxg1ExpensePercent,
	Pmdlxg1OtherPercent,
	Pmdlxg1CommReduction,
	Pmdlxg1CommRate,
	Pmdlxg1RateLevelDate,
	Pmdlxg1WorkSheetInd,
	Pmdlxg1ProdwIndicator,
	Pmdlxg1CutOffYr,
	Pmdlxg1CutOffMo,
	Pmdlxg1CutOffDay,
	Pmdlxg1PmsFutureUse,
	Pmdlxg1CustSplUse,
	Pmdlxg1Yr2000CustUse,
	Pmdlxg1WbcKey,
	ExtractDate,
	AsOfDate,
	RecordCount,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_Pif43LXGLStage
),
ArchPif43LXGLStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43LXGLStage
	(Pif43LXGLStageId, PifSymbol, PifPolicyNumber, PifModule, Pmdlxg1RecLength, Pmdlxg1ActionCode, Pmdlxg1FileId, Pmdlxg1SegmentId, Pmdlxg1SegmentStatus, Pmdlxg1YearTransaction, Pmdlxg1MonthTransaction, Pmdlxg1DayTransaction, Pmdlxg1SegmentLevelCode, Pmdlxg1SegmentPartCode, Pmdlxg1SubPartCode, Pmdlxg1InsuranceLine, Pmdlxg1LocationNumber, Pmdlxg1YearItemEffective, Pmdlxg1MonthItemEffective, Pmdlxg1DayItemEffective, Pmdlxg1YearProcess, Pmdlxg1MonthProcess, Pmdlxg1DayProcess, Pmdlxg1CompanyNumber, Pmdlxg1YearOrigProcess, Pmdlxg1MonthOrigProcess, Pmdlxg1DayOrigProcess, Pmdlxg1OccurClaimsMadeInd, Pmdlxg1ClmsMadeYr, Pmdlxg1ClmsMadeMo, Pmdlxg1ClmsMadeDay, Pmdlxg1YearRetro, Pmdlxg1MonthRetro, Pmdlxg1DayRetro, Pmdlxg1SplitLimInd, Pmdlxg1FringeCode1, Pmdlxg1FringeRate1, Pmdlxg1FringeRateMgInd1, Pmdlxg1FringeCode2, Pmdlxg1FringeRate2, Pmdlxg1FringeRateMgInd2, Pmdlxg1FringeCode3, Pmdlxg1FringeRate3, Pmdlxg1FringeRateMgInd3, Pmdlxg1FringeCode4, Pmdlxg1FringeRate4, Pmdlxg1FringeRateMgInd4, Pmdlxg1FringeCode5, Pmdlxg1FringeRate5, Pmdlxg1FringeRateMgInd5, Pmdlxg1FringeCode6, Pmdlxg1FringeRate6, Pmdlxg1FringeRateMgInd6, Pmdlxg1FringeCode7, Pmdlxg1FringeRate7, Pmdlxg1FringeRateMgInd7, Pmdlxg1FringeCode8, Pmdlxg1FringeRate8, Pmdlxg1FringeRateMgInd8, Pmdlxg1FringeCode9, Pmdlxg1FringeRate9, Pmdlxg1FringeRateMgInd9, Pmdlxg1FringeCode10, Pmdlxg1FringeRate10, Pmdlxg1FringeRateMgInd10, Pmdlxg1AuditFrequencyCode, Pmdlxg1AuditType, Pmdlxg1TexasDiscInd, Pmdlxg1TexasDiscMgInd, Pmdlxg1TexasDiscPercent, Pmdlxg1DecChangeFlag, Pmdlxg1PmaCode, Pmdlxg1IrpmExperPercent, Pmdlxg1ScheduledPercent, Pmdlxg1ExpensePercent, Pmdlxg1OtherPercent, Pmdlxg1CommReduction, Pmdlxg1CommRate, Pmdlxg1RateLevelDate, Pmdlxg1WorkSheetInd, Pmdlxg1ProdwIndicator, Pmdlxg1CutOffYr, Pmdlxg1CutOffMo, Pmdlxg1CutOffDay, Pmdlxg1PmsFutureUse, Pmdlxg1CustSplUse, Pmdlxg1Yr2000CustUse, Pmdlxg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)
	SELECT 
	Pif43LXStageId AS PIF43LXGLSTAGEID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDLXG1RECLENGTH, 
	PMDLXG1ACTIONCODE, 
	PMDLXG1FILEID, 
	PMDLXG1SEGMENTID, 
	PMDLXG1SEGMENTSTATUS, 
	PMDLXG1YEARTRANSACTION, 
	PMDLXG1MONTHTRANSACTION, 
	PMDLXG1DAYTRANSACTION, 
	PmdlxgiSegmentLevelCode AS PMDLXG1SEGMENTLEVELCODE, 
	PMDLXG1SEGMENTPARTCODE, 
	PMDLXG1SUBPARTCODE, 
	PMDLXG1INSURANCELINE, 
	PMDLXG1LOCATIONNUMBER, 
	PMDLXG1YEARITEMEFFECTIVE, 
	PMDLXG1MONTHITEMEFFECTIVE, 
	PMDLXG1DAYITEMEFFECTIVE, 
	PMDLXG1YEARPROCESS, 
	PMDLXG1MONTHPROCESS, 
	PMDLXG1DAYPROCESS, 
	PMDLXG1COMPANYNUMBER, 
	PMDLXG1YEARORIGPROCESS, 
	PMDLXG1MONTHORIGPROCESS, 
	PMDLXG1DAYORIGPROCESS, 
	PMDLXG1OCCURCLAIMSMADEIND, 
	PMDLXG1CLMSMADEYR, 
	PMDLXG1CLMSMADEMO, 
	PMDLXG1CLMSMADEDAY, 
	PMDLXG1YEARRETRO, 
	PMDLXG1MONTHRETRO, 
	PMDLXG1DAYRETRO, 
	PMDLXG1SPLITLIMIND, 
	PMDLXG1FRINGECODE1, 
	PMDLXG1FRINGERATE1, 
	PMDLXG1FRINGERATEMGIND1, 
	PMDLXG1FRINGECODE2, 
	PMDLXG1FRINGERATE2, 
	PMDLXG1FRINGERATEMGIND2, 
	PMDLXG1FRINGECODE3, 
	PMDLXG1FRINGERATE3, 
	PMDLXG1FRINGERATEMGIND3, 
	PMDLXG1FRINGECODE4, 
	PMDLXG1FRINGERATE4, 
	PMDLXG1FRINGERATEMGIND4, 
	PMDLXG1FRINGECODE5, 
	PMDLXG1FRINGERATE5, 
	PMDLXG1FRINGERATEMGIND5, 
	PMDLXG1FRINGECODE6, 
	PMDLXG1FRINGERATE6, 
	PMDLXG1FRINGERATEMGIND6, 
	PMDLXG1FRINGECODE7, 
	PMDLXG1FRINGERATE7, 
	PMDLXG1FRINGERATEMGIND7, 
	PMDLXG1FRINGECODE8, 
	PMDLXG1FRINGERATE8, 
	PMDLXG1FRINGERATEMGIND8, 
	PMDLXG1FRINGECODE9, 
	PMDLXG1FRINGERATE9, 
	PMDLXG1FRINGERATEMGIND9, 
	PMDLXG1FRINGECODE10, 
	PMDLXG1FRINGERATE10, 
	PMDLXG1FRINGERATEMGIND10, 
	PMDLXG1AUDITFREQUENCYCODE, 
	PMDLXG1AUDITTYPE, 
	PMDLXG1TEXASDISCIND, 
	PMDLXG1TEXASDISCMGIND, 
	PMDLXG1TEXASDISCPERCENT, 
	PMDLXG1DECCHANGEFLAG, 
	PMDLXG1PMACODE, 
	Pmdlxg1IrpmExperPerce AS PMDLXG1IRPMEXPERPERCENT, 
	Pmdlxg1ScheduledPercen AS PMDLXG1SCHEDULEDPERCENT, 
	PMDLXG1EXPENSEPERCENT, 
	PMDLXG1OTHERPERCENT, 
	PMDLXG1COMMREDUCTION, 
	PMDLXG1COMMRATE, 
	PMDLXG1RATELEVELDATE, 
	PMDLXG1WORKSHEETIND, 
	PMDLXG1PRODWINDICATOR, 
	PMDLXG1CUTOFFYR, 
	PMDLXG1CUTOFFMO, 
	PMDLXG1CUTOFFDAY, 
	PMDLXG1PMSFUTUREUSE, 
	PMDLXG1CUSTSPLUSE, 
	PMDLXG1YR2000CUSTUSE, 
	PMDLXG1WBCKEY, 
	EXTRACTDATE, 
	ASOFDATE, 
	RECORDCOUNT, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_Values
),