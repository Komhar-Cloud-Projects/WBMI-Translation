{
    "name": "s_m_POL_FEED_Load_WCPOLS_07_Record",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_07_Record",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_SUPWCPOLS_State AS (\n\tSELECT\n\tWCPOLSCode,\n\tNCCIRequiredFlag,\n\tWIRequiredFlag,\n\tMIRequiredFlag,\n\tMNRequiredFlag,\n\tSourcesystemID,\n\tTableName,\n\tProcessName,\n\tSourceCode\n\tFROM (\n\t\tSELECT \n\t\t\tWCPOLSCode,\n\t\t\tNCCIRequiredFlag,\n\t\t\tWIRequiredFlag,\n\t\t\tMIRequiredFlag,\n\t\t\tMNRequiredFlag,\n\t\t\tSourcesystemID,\n\t\t\tTableName,\n\t\t\tProcessName,\n\t\t\tSourceCode\n\t\tFROM SupWCPOLS\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SourcesystemID,TableName,ProcessName,SourceCode ORDER BY WCPOLSCode) = 1\n),\nSQ_WorkWCForms AS (\n\tSELECT\r\n\t     C.WCTrackHistoryID\r\n\t\t,C.FormName\r\n\t\t,B.TransactionEffectiveDate\r\n\t\t,B.TransactionExpirationDate\r\n\t\r\n\t\r\n\tFROM dbo.WorkWCPolicy B\r\n\t\r\n\tINNER JOIN dbo.WorkWCForms C\r\n\t\tON B.WCTrackHistoryID = C.WCTrackHistoryID\r\n\t\tAND (C.OnPolicy = '1'OR C.[Add] = '1')\r\n\t\tAND (C.[Remove] is NULL or C.[Remove] = '0')\r\n\t\tAND C.FormName is NOT NULL\r\n\t\r\n\tWHERE 1=1\r\n\tAND C.FormName like 'WC%'\r\n\tAND B.AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\t@{pipeline().parameters.WHERE_CLAUSE_07}\r\n\tORDER BY C.WCTrackHistoryID\n),\nEXP_StateCode AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tFormName,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\t-- *INF*: SUBSTR(FormName, Length(FormName)-4, 1)\n\tSUBSTR(FormName, Length(FormName) - 4, 1) AS v_BureauID,\n\t-- *INF*: IIF(v_BureauID >= 'A' and v_BureauID <= 'Z', SUBSTR(FormName,1, Length(FormName)-5),SUBSTR(FormName,1, Length(FormName)-4))\n\tIFF(\n\t    v_BureauID >= 'A' and v_BureauID <= 'Z', SUBSTR(FormName, 1, Length(FormName) - 5),\n\t    SUBSTR(FormName, 1, Length(FormName) - 4)\n\t) AS v_FormName,\n\t-- *INF*: :LKP.LKP_SUPWCPOLS_STATE('DCT','WCPOLS07Record','StateCodeRecord07',SUBSTR(FormName,3,2))\n\tLKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2.WCPOLSCode AS v_LKP_StateCode,\n\t-- *INF*: Decode(TRUE,\r\n\t-- v_FormName='WC400','Y',\r\n\t-- ISNULL(v_LKP_StateCode) and substr(FormName,3,2)='00','N',\r\n\t-- ISNULL(v_LKP_StateCode),'Y','N')\n\tDecode(\n\t    TRUE,\n\t    v_FormName = 'WC400', 'Y',\n\t    v_LKP_StateCode IS NULL and substr(FormName, 3, 2) = '00', 'N',\n\t    v_LKP_StateCode IS NULL, 'Y',\n\t    'N'\n\t) AS Form_FilterFlag\n\tFROM SQ_WorkWCForms\n\tLEFT JOIN LKP_SUPWCPOLS_STATE LKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2\n\tON LKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2.TableName = 'WCPOLS07Record'\n\tAND LKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2.ProcessName = 'StateCodeRecord07'\n\tAND LKP_SUPWCPOLS_STATE__DCT_WCPOLS07Record_StateCodeRecord07_SUBSTR_FormName_3_2.SourceCode = SUBSTR(FormName, 3, 2)\n\n),\nFIL_Forms AS (\n\tSELECT\n\tWCTrackHistoryID, \n\tFormName, \n\tTransactionEffectiveDate, \n\tTransactionExpirationDate, \n\tForm_FilterFlag\n\tFROM EXP_StateCode\n\tWHERE Form_FilterFlag='N'\n),\nSQ_WCPols00Record AS (\n\tSELECT\r\n\t\tWCTrackHistoryID,\r\n\t\tLinkData,\r\n\t     AuditId\r\n\tFROM dbo.WCPols00Record\r\n\tWHERE 1=1\r\n\tAND AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tORDER BY WCTrackHistoryID\n),\nJNR_00_Record AS (SELECT\n\tSQ_WCPols00Record.WCTrackHistoryID, \n\tSQ_WCPols00Record.LinkData, \n\tSQ_WCPols00Record.AuditId, \n\tFIL_Forms.WCTrackHistoryID AS WCTrackHistoryID1, \n\tFIL_Forms.FormName, \n\tFIL_Forms.TransactionEffectiveDate, \n\tFIL_Forms.TransactionExpirationDate\n\tFROM FIL_Forms\n\tINNER JOIN SQ_WCPols00Record\n\tON SQ_WCPols00Record.WCTrackHistoryID = FIL_Forms.WCTrackHistoryID\n),\nSRT_Control_Break AS (\n\tSELECT\n\tWCTrackHistoryID, \n\tLinkData, \n\tAuditId, \n\tFormName, \n\tTransactionEffectiveDate, \n\tTransactionExpirationDate\n\tFROM JNR_00_Record\n\tORDER BY WCTrackHistoryID ASC, FormName ASC\n),\nEXP_Aggr_Format AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tLinkData,\n\tAuditId,\n\tFormName,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\t-- *INF*: TO_CHAR(WCTrackHistoryID) || SUBSTR(FormName,1,4)\n\tTO_CHAR(WCTrackHistoryID) || SUBSTR(FormName, 1, 4) AS Grouping_Key,\n\tGrouping_Key AS o_Grouping_Key,\n\t-- *INF*: IIF(SUBSTR(FormName,3,2)='00','  ',SUBSTR(FormName,3,2))\n\tIFF(SUBSTR(FormName, 3, 2) = '00', '  ', SUBSTR(FormName, 3, 2)) AS o_StateCode,\n\t-- *INF*: IIF (IsNull(old_Grouping_Key) or old_Grouping_Key <> Grouping_Key, 1, Grouping_Cnt + 1)\n\tIFF(old_Grouping_Key IS NULL or old_Grouping_Key <> Grouping_Key, 1, Grouping_Cnt + 1) AS Grouping_Cnt,\n\t-- *INF*: TRUNC((Grouping_Cnt - 1) / 11)\n\tTRUNC((Grouping_Cnt - 1) / 11) AS o_Record_Cnt,\n\t-- *INF*: IIF(MOD(Grouping_Cnt, 11) = 0, 11, MOD(Grouping_Cnt, 11))\n\tIFF(MOD(Grouping_Cnt, 11) = 0, 11, MOD(Grouping_Cnt, 11)) AS o_Field_Cnt,\n\tGrouping_Key AS old_Grouping_Key\n\tFROM SRT_Control_Break\n),\nEXPTRANS AS (\n\tSELECT\n\to_Grouping_Key AS Grouping_Key,\n\to_StateCode AS StateCode,\n\to_Record_Cnt AS Record_Cnt,\n\tWCTrackHistoryID,\n\tLinkData,\n\tAuditId,\n\tFormName,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\to_Field_Cnt AS Field_Cnt,\n\t-- *INF*: IIF (Field_Cnt = 1, FormName, '')\n\tIFF(Field_Cnt = 1, FormName, '') AS o_FormName_01,\n\t-- *INF*: IIF (Field_Cnt = 2, FormName, '')\n\tIFF(Field_Cnt = 2, FormName, '') AS o_FormName_02,\n\t-- *INF*: IIF (Field_Cnt = 3, FormName, '')\n\tIFF(Field_Cnt = 3, FormName, '') AS o_FormName_03,\n\t-- *INF*: IIF (Field_Cnt = 4, FormName, '')\n\tIFF(Field_Cnt = 4, FormName, '') AS o_FormName_04,\n\t-- *INF*: IIF (Field_Cnt = 5, FormName, '')\n\tIFF(Field_Cnt = 5, FormName, '') AS o_FormName_05,\n\t-- *INF*: IIF (Field_Cnt = 6, FormName, '')\n\tIFF(Field_Cnt = 6, FormName, '') AS o_FormName_06,\n\t-- *INF*: IIF (Field_Cnt = 7, FormName, '')\n\tIFF(Field_Cnt = 7, FormName, '') AS o_FormName_07,\n\t-- *INF*: IIF (Field_Cnt = 8, FormName, '')\n\tIFF(Field_Cnt = 8, FormName, '') AS o_FormName_08,\n\t-- *INF*: IIF (Field_Cnt = 9, FormName, '')\n\tIFF(Field_Cnt = 9, FormName, '') AS o_FormName_09,\n\t-- *INF*: IIF (Field_Cnt = 10, FormName, '')\n\tIFF(Field_Cnt = 10, FormName, '') AS o_FormName_10,\n\t-- *INF*: IIF (Field_Cnt = 11, FormName, '')\n\tIFF(Field_Cnt = 11, FormName, '') AS o_FormName_11\n\tFROM EXP_Aggr_Format\n),\nSRT_Aggr_Records AS (\n\tSELECT\n\tGrouping_Key, \n\tRecord_Cnt, \n\tStateCode, \n\tWCTrackHistoryID, \n\tLinkData, \n\tAuditId, \n\tTransactionEffectiveDate, \n\tTransactionExpirationDate, \n\to_FormName_01 AS FormName_01, \n\to_FormName_02 AS FormName_02, \n\to_FormName_03 AS FormName_03, \n\to_FormName_04 AS FormName_04, \n\to_FormName_05 AS FormName_05, \n\to_FormName_06 AS FormName_06, \n\to_FormName_07 AS FormName_07, \n\to_FormName_08 AS FormName_08, \n\to_FormName_09 AS FormName_09, \n\to_FormName_10 AS FormName_10, \n\to_FormName_11 AS FormName_11\n\tFROM EXPTRANS\n\tORDER BY Grouping_Key ASC, Record_Cnt ASC\n),\nAGG_07_Records AS (\n\tSELECT\n\tGrouping_Key,\n\tRecord_Cnt,\n\tStateCode,\n\tWCTrackHistoryID,\n\tLinkData,\n\tAuditId,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\tFormName_01,\n\tFormName_02,\n\tFormName_03,\n\tFormName_04,\n\tFormName_05,\n\tFormName_06,\n\tFormName_07,\n\tFormName_08,\n\tFormName_09,\n\tFormName_10,\n\tFormName_11,\n\t-- *INF*: MAX(FormName_01)\n\tMAX(FormName_01) AS o_FormName_01,\n\t-- *INF*: MAX(FormName_02)\n\tMAX(FormName_02) AS o_FormName_02,\n\t-- *INF*: MAX(FormName_03)\n\tMAX(FormName_03) AS o_FormName_03,\n\t-- *INF*: MAX(FormName_04)\n\tMAX(FormName_04) AS o_FormName_04,\n\t-- *INF*: MAX(FormName_05)\n\tMAX(FormName_05) AS o_FormName_05,\n\t-- *INF*: MAX(FormName_06)\n\tMAX(FormName_06) AS o_FormName_06,\n\t-- *INF*: MAX(FormName_07)\n\tMAX(FormName_07) AS o_FormName_07,\n\t-- *INF*: MAX(FormName_08)\n\tMAX(FormName_08) AS o_FormName_08,\n\t-- *INF*: MAX(FormName_09)\n\tMAX(FormName_09) AS o_FormName_09,\n\t-- *INF*: MAX(FormName_10)\n\tMAX(FormName_10) AS o_FormName_10,\n\t-- *INF*: MAX(FormName_11)\n\tMAX(FormName_11) AS o_FormName_11\n\tFROM SRT_Aggr_Records\n\tGROUP BY Grouping_Key, Record_Cnt\n),\nEXP_Format_Output AS (\n\tSELECT\n\tCURRENT_TIMESTAMP AS o_ExtractDate,\n\tStateCode,\n\tWCTrackHistoryID,\n\tLinkData,\n\tAuditId,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\t'07' AS o_RecordTypeCode,\n\to_FormName_01 AS FormName_01,\n\to_FormName_02 AS FormName_02,\n\to_FormName_03 AS FormName_03,\n\to_FormName_04 AS FormName_04,\n\to_FormName_05 AS FormName_05,\n\to_FormName_06 AS FormName_06,\n\to_FormName_07 AS FormName_07,\n\to_FormName_08 AS FormName_08,\n\to_FormName_09 AS FormName_09,\n\to_FormName_10 AS FormName_10,\n\to_FormName_11 AS FormName_11,\n\t-- *INF*: IIF(v_BureauID_01 >= 'A' and v_BureauID_01 <= 'Z', SUBSTR(FormName_01,1, Length(FormName_01)-5),SUBSTR(FormName_01,1, Length(FormName_01)-4))\r\n\t-- \n\tIFF(\n\t    v_BureauID_01 >= 'A' and v_BureauID_01 <= 'Z',\n\t    SUBSTR(FormName_01, 1, Length(FormName_01) - 5),\n\t    SUBSTR(FormName_01, 1, Length(FormName_01) - 4)\n\t) AS o_EndorsementNumber01,\n\t-- *INF*: SUBSTR(FormName_01, Length(FormName_01)-4, 1)\n\tSUBSTR(FormName_01, Length(FormName_01) - 4, 1) AS v_BureauID_01,\n\t-- *INF*: IIF(v_BureauID_01 >= 'A' and v_BureauID_01 <= 'Z', v_BureauID_01,' ')\n\tIFF(v_BureauID_01 >= 'A' and v_BureauID_01 <= 'Z', v_BureauID_01, ' ') AS o_BureauVersionIdentifierEditionIdentifier01,\n\t-- *INF*: SUBSTR(FormName_01, Length(FormName_01)-3, 4)\n\tSUBSTR(FormName_01, Length(FormName_01) - 3, 4) AS o_CarrierVersionIdentifier01,\n\t-- *INF*: IIF(v_BureauID_02 >= 'A' and v_BureauID_02 <= 'Z', SUBSTR(FormName_02,1, Length(FormName_02)-5),SUBSTR(FormName_02,1, Length(FormName_02)-4))\n\tIFF(\n\t    v_BureauID_02 >= 'A' and v_BureauID_02 <= 'Z',\n\t    SUBSTR(FormName_02, 1, Length(FormName_02) - 5),\n\t    SUBSTR(FormName_02, 1, Length(FormName_02) - 4)\n\t) AS o_EndorsementNumber02,\n\t-- *INF*: SUBSTR(FormName_02, Length(FormName_02)-4, 1)\n\tSUBSTR(FormName_02, Length(FormName_02) - 4, 1) AS v_BureauID_02,\n\t-- *INF*: IIF(v_BureauID_02 >= 'A' and v_BureauID_02 <= 'Z', v_BureauID_02,' ')\n\tIFF(v_BureauID_02 >= 'A' and v_BureauID_02 <= 'Z', v_BureauID_02, ' ') AS o_BureauVersionIdentifierEditionIdentifier02,\n\t-- *INF*: SUBSTR(FormName_02, Length(FormName_02)-3, 4)\n\tSUBSTR(FormName_02, Length(FormName_02) - 3, 4) AS o_CarrierVersionIdentifier02,\n\t-- *INF*: IIF(v_BureauID_03 >= 'A' and v_BureauID_03 <= 'Z', SUBSTR(FormName_03,1, Length(FormName_03)-5),SUBSTR(FormName_03,1, Length(FormName_03)-4))\n\tIFF(\n\t    v_BureauID_03 >= 'A' and v_BureauID_03 <= 'Z',\n\t    SUBSTR(FormName_03, 1, Length(FormName_03) - 5),\n\t    SUBSTR(FormName_03, 1, Length(FormName_03) - 4)\n\t) AS o_EndorsementNumber03,\n\t-- *INF*: SUBSTR(FormName_03, Length(FormName_03)-4, 1)\n\tSUBSTR(FormName_03, Length(FormName_03) - 4, 1) AS v_BureauID_03,\n\t-- *INF*: IIF(v_BureauID_03 >= 'A' and v_BureauID_03 <= 'Z', v_BureauID_03,' ')\n\tIFF(v_BureauID_03 >= 'A' and v_BureauID_03 <= 'Z', v_BureauID_03, ' ') AS o_BureauVersionIdentifierEditionIdentifier03,\n\t-- *INF*: SUBSTR(FormName_03, Length(FormName_03)-3, 4)\n\tSUBSTR(FormName_03, Length(FormName_03) - 3, 4) AS o_CarrierVersionIdentifier03,\n\t-- *INF*: IIF(v_BureauID_04 >= 'A' and v_BureauID_04 <= 'Z', SUBSTR(FormName_04,1, Length(FormName_04)-5),SUBSTR(FormName_04,1, Length(FormName_04)-4))\n\tIFF(\n\t    v_BureauID_04 >= 'A' and v_BureauID_04 <= 'Z',\n\t    SUBSTR(FormName_04, 1, Length(FormName_04) - 5),\n\t    SUBSTR(FormName_04, 1, Length(FormName_04) - 4)\n\t) AS o_EndorsementNumber04,\n\t-- *INF*: SUBSTR(FormName_04, Length(FormName_04)-4, 1)\n\tSUBSTR(FormName_04, Length(FormName_04) - 4, 1) AS v_BureauID_04,\n\t-- *INF*: IIF(v_BureauID_04 >= 'A' and v_BureauID_04 <= 'Z', v_BureauID_04,' ')\n\tIFF(v_BureauID_04 >= 'A' and v_BureauID_04 <= 'Z', v_BureauID_04, ' ') AS o_BureauVersionIdentifierEditionIdentifier04,\n\t-- *INF*: SUBSTR(FormName_04, Length(FormName_04)-3, 4)\n\tSUBSTR(FormName_04, Length(FormName_04) - 3, 4) AS o_CarrierVersionIdentifier04,\n\t-- *INF*: IIF(v_BureauID_05 >= 'A' and v_BureauID_05 <= 'Z', SUBSTR(FormName_05,1, Length(FormName_05)-5),SUBSTR(FormName_05,1, Length(FormName_05)-4))\n\tIFF(\n\t    v_BureauID_05 >= 'A' and v_BureauID_05 <= 'Z',\n\t    SUBSTR(FormName_05, 1, Length(FormName_05) - 5),\n\t    SUBSTR(FormName_05, 1, Length(FormName_05) - 4)\n\t) AS o_EndorsementNumber05,\n\t-- *INF*: SUBSTR(FormName_05, Length(FormName_05)-4, 1)\n\tSUBSTR(FormName_05, Length(FormName_05) - 4, 1) AS v_BureauID_05,\n\t-- *INF*: IIF(v_BureauID_05 >= 'A' and v_BureauID_05 <= 'Z', v_BureauID_05,' ')\n\tIFF(v_BureauID_05 >= 'A' and v_BureauID_05 <= 'Z', v_BureauID_05, ' ') AS o_BureauVersionIdentifierEditionIdentifier05,\n\t-- *INF*: SUBSTR(FormName_05, Length(FormName_05)-3, 4)\n\tSUBSTR(FormName_05, Length(FormName_05) - 3, 4) AS o_CarrierVersionIdentifier05,\n\t-- *INF*: IIF(v_BureauID_06 >= 'A' and v_BureauID_06 <= 'Z', SUBSTR(FormName_06,1, Length(FormName_06)-5),SUBSTR(FormName_06,1, Length(FormName_06)-4))\n\tIFF(\n\t    v_BureauID_06 >= 'A' and v_BureauID_06 <= 'Z',\n\t    SUBSTR(FormName_06, 1, Length(FormName_06) - 5),\n\t    SUBSTR(FormName_06, 1, Length(FormName_06) - 4)\n\t) AS o_EndorsementNumber06,\n\t-- *INF*: SUBSTR(FormName_06, Length(FormName_06)-4, 1)\n\tSUBSTR(FormName_06, Length(FormName_06) - 4, 1) AS v_BureauID_06,\n\t-- *INF*: IIF(v_BureauID_06 >= 'A' and v_BureauID_06 <= 'Z', v_BureauID_06,' ')\n\tIFF(v_BureauID_06 >= 'A' and v_BureauID_06 <= 'Z', v_BureauID_06, ' ') AS o_BureauVersionIdentifierEditionIdentifier06,\n\t-- *INF*: SUBSTR(FormName_06, Length(FormName_06)-3, 4)\n\tSUBSTR(FormName_06, Length(FormName_06) - 3, 4) AS o_CarrierVersionIdentifier06,\n\t-- *INF*: IIF(v_BureauID_07 >= 'A' and v_BureauID_07 <= 'Z', SUBSTR(FormName_07,1, Length(FormName_07)-5),SUBSTR(FormName_07,1, Length(FormName_07)-4))\n\tIFF(\n\t    v_BureauID_07 >= 'A' and v_BureauID_07 <= 'Z',\n\t    SUBSTR(FormName_07, 1, Length(FormName_07) - 5),\n\t    SUBSTR(FormName_07, 1, Length(FormName_07) - 4)\n\t) AS o_EndorsementNumber07,\n\t-- *INF*: SUBSTR(FormName_07, Length(FormName_07)-4, 1)\n\tSUBSTR(FormName_07, Length(FormName_07) - 4, 1) AS v_BureauID_07,\n\t-- *INF*: IIF(v_BureauID_07 >= 'A' and v_BureauID_07 <= 'Z', v_BureauID_07,' ')\n\tIFF(v_BureauID_07 >= 'A' and v_BureauID_07 <= 'Z', v_BureauID_07, ' ') AS o_BureauVersionIdentifierEditionIdentifier07,\n\t-- *INF*: SUBSTR(FormName_07, Length(FormName_07)-3, 4)\n\tSUBSTR(FormName_07, Length(FormName_07) - 3, 4) AS o_CarrierVersionIdentifier07,\n\t-- *INF*: IIF(v_BureauID_08 >= 'A' and v_BureauID_08 <= 'Z', SUBSTR(FormName_08,1, Length(FormName_08)-5),SUBSTR(FormName_08,1, Length(FormName_08)-4))\n\tIFF(\n\t    v_BureauID_08 >= 'A' and v_BureauID_08 <= 'Z',\n\t    SUBSTR(FormName_08, 1, Length(FormName_08) - 5),\n\t    SUBSTR(FormName_08, 1, Length(FormName_08) - 4)\n\t) AS o_EndorsementNumber08,\n\t-- *INF*: SUBSTR(FormName_08, Length(FormName_08)-4, 1)\n\tSUBSTR(FormName_08, Length(FormName_08) - 4, 1) AS v_BureauID_08,\n\t-- *INF*: IIF(v_BureauID_08 >= 'A' and v_BureauID_08 <= 'Z', v_BureauID_08,' ')\n\tIFF(v_BureauID_08 >= 'A' and v_BureauID_08 <= 'Z', v_BureauID_08, ' ') AS o_BureauVersionIdentifierEditionIdentifier08,\n\t-- *INF*: SUBSTR(FormName_08, Length(FormName_08)-3, 4)\n\tSUBSTR(FormName_08, Length(FormName_08) - 3, 4) AS o_CarrierVersionIdentifier08,\n\t-- *INF*: IIF(v_BureauID_09 >= 'A' and v_BureauID_09 <= 'Z', SUBSTR(FormName_09,1, Length(FormName_09)-5),SUBSTR(FormName_09,1, Length(FormName_09)-4))\n\tIFF(\n\t    v_BureauID_09 >= 'A' and v_BureauID_09 <= 'Z',\n\t    SUBSTR(FormName_09, 1, Length(FormName_09) - 5),\n\t    SUBSTR(FormName_09, 1, Length(FormName_09) - 4)\n\t) AS o_EndorsementNumber09,\n\t-- *INF*: SUBSTR(FormName_09, Length(FormName_09)-4, 1)\n\tSUBSTR(FormName_09, Length(FormName_09) - 4, 1) AS v_BureauID_09,\n\t-- *INF*: IIF(v_BureauID_09 >= 'A' and v_BureauID_09 <= 'Z', v_BureauID_09,' ')\n\tIFF(v_BureauID_09 >= 'A' and v_BureauID_09 <= 'Z', v_BureauID_09, ' ') AS o_BureauVersionIdentifierEditionIdentifier09,\n\t-- *INF*: SUBSTR(FormName_09, Length(FormName_09)-3, 4)\n\tSUBSTR(FormName_09, Length(FormName_09) - 3, 4) AS o_CarrierVersionIdentifier09,\n\t-- *INF*: IIF(v_BureauID_10 >= 'A' and v_BureauID_10 <= 'Z', SUBSTR(FormName_10,1, Length(FormName_10)-5),SUBSTR(FormName_10,1, Length(FormName_10)-4))\n\tIFF(\n\t    v_BureauID_10 >= 'A' and v_BureauID_10 <= 'Z',\n\t    SUBSTR(FormName_10, 1, Length(FormName_10) - 5),\n\t    SUBSTR(FormName_10, 1, Length(FormName_10) - 4)\n\t) AS o_EndorsementNumber10,\n\t-- *INF*: SUBSTR(FormName_10, Length(FormName_10)-4, 1)\n\tSUBSTR(FormName_10, Length(FormName_10) - 4, 1) AS v_BureauID_10,\n\t-- *INF*: IIF(v_BureauID_10 >= 'A' and v_BureauID_10 <= 'Z', v_BureauID_10,' ')\n\tIFF(v_BureauID_10 >= 'A' and v_BureauID_10 <= 'Z', v_BureauID_10, ' ') AS o_BureauVersionIdentifierEditionIdentifier10,\n\t-- *INF*: SUBSTR(FormName_10, Length(FormName_10)-3, 4)\n\tSUBSTR(FormName_10, Length(FormName_10) - 3, 4) AS o_CarrierVersionIdentifier10,\n\t-- *INF*: IIF(v_BureauID_11 >= 'A' and v_BureauID_11 <= 'Z', SUBSTR(FormName_11,1, Length(FormName_11)-5),SUBSTR(FormName_11,1, Length(FormName_11)-4))\n\tIFF(\n\t    v_BureauID_11 >= 'A' and v_BureauID_11 <= 'Z',\n\t    SUBSTR(FormName_11, 1, Length(FormName_11) - 5),\n\t    SUBSTR(FormName_11, 1, Length(FormName_11) - 4)\n\t) AS o_EndorsementNumber11,\n\t-- *INF*: SUBSTR(FormName_11, Length(FormName_11)-4, 1)\n\tSUBSTR(FormName_11, Length(FormName_11) - 4, 1) AS v_BureauID_11,\n\t-- *INF*: IIF(v_BureauID_11 >= 'A' and v_BureauID_11 <= 'Z', v_BureauID_11,' ')\n\tIFF(v_BureauID_11 >= 'A' and v_BureauID_11 <= 'Z', v_BureauID_11, ' ') AS o_BureauVersionIdentifierEditionIdentifier11,\n\t-- *INF*: SUBSTR(FormName_11, Length(FormName_11)-3, 4)\n\tSUBSTR(FormName_11, Length(FormName_11) - 3, 4) AS o_CarrierVersionIdentifier11,\n\t-- *INF*: TO_CHAR(TransactionEffectiveDate,'YYMMDD')\n\tTO_CHAR(TransactionEffectiveDate, 'YYMMDD') AS o_PolicyChangeEffectiveDate,\n\t-- *INF*: TO_CHAR(TransactionExpirationDate,'YYMMDD')\n\tTO_CHAR(TransactionExpirationDate, 'YYMMDD') AS o_PolicyChangeExpirationDate\n\tFROM AGG_07_Records\n),\nWCPols07Record AS (\n\n\t------------ PRE SQL ----------\n\tDELETE\r\n\t  FROM dbo.WCPols07Record\r\n\t  WHERE 1=1\r\n\t  AND AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n\t-------------------------------\n\n\n\tINSERT INTO WCPols07Record\n\t(ExtractDate, AuditId, WCTrackHistoryID, LinkData, StateCode, RecordTypeCode, EndorsementNumber01, BureauVersionIdentifierEditionIdentifier01, CarrierVersionIdentifier01, EndorsementNumber02, BureauVersionIdentifierEditionIdentifier02, CarrierVersionIdentifier02, EndorsementNumber03, BureauVersionIdentifierEditionIdentifier03, CarrierVersionIdentifier03, EndorsementNumber04, BureauVersionIdentifierEditionIdentifier04, CarrierVersionIdentifier04, EndorsementNumber05, BureauVersionIdentifierEditionIdentifier05, CarrierVersionIdentifier05, EndorsementNumber06, BureauVersionIdentifierEditionIdentifier06, CarrierVersionIdentifier06, EndorsementNumber07, BureauVersionIdentifierEditionIdentifier07, CarrierVersionIdentifier07, EndorsementNumber08, BureauVersionIdentifierEditionIdentifier08, CarrierVersionIdentifier08, EndorsementNumber09, BureauVersionIdentifierEditionIdentifier09, CarrierVersionIdentifier09, EndorsementNumber10, BureauVersionIdentifierEditionIdentifier10, CarrierVersionIdentifier10, EndorsementNumber11, BureauVersionIdentifierEditionIdentifier11, CarrierVersionIdentifier11, PolicyChangeEffectiveDate, PolicyChangeExpirationDate)\n\tSELECT \n\to_ExtractDate AS EXTRACTDATE, \n\tAUDITID, \n\tWCTRACKHISTORYID, \n\tLINKDATA, \n\tSTATECODE, \n\to_RecordTypeCode AS RECORDTYPECODE, \n\to_EndorsementNumber01 AS ENDORSEMENTNUMBER01, \n\to_BureauVersionIdentifierEditionIdentifier01 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER01, \n\to_CarrierVersionIdentifier01 AS CARRIERVERSIONIDENTIFIER01, \n\to_EndorsementNumber02 AS ENDORSEMENTNUMBER02, \n\to_BureauVersionIdentifierEditionIdentifier02 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER02, \n\to_CarrierVersionIdentifier02 AS CARRIERVERSIONIDENTIFIER02, \n\to_EndorsementNumber03 AS ENDORSEMENTNUMBER03, \n\to_BureauVersionIdentifierEditionIdentifier03 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER03, \n\to_CarrierVersionIdentifier03 AS CARRIERVERSIONIDENTIFIER03, \n\to_EndorsementNumber04 AS ENDORSEMENTNUMBER04, \n\to_BureauVersionIdentifierEditionIdentifier04 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER04, \n\to_CarrierVersionIdentifier04 AS CARRIERVERSIONIDENTIFIER04, \n\to_EndorsementNumber05 AS ENDORSEMENTNUMBER05, \n\to_BureauVersionIdentifierEditionIdentifier05 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER05, \n\to_CarrierVersionIdentifier05 AS CARRIERVERSIONIDENTIFIER05, \n\to_EndorsementNumber06 AS ENDORSEMENTNUMBER06, \n\to_BureauVersionIdentifierEditionIdentifier06 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER06, \n\to_CarrierVersionIdentifier06 AS CARRIERVERSIONIDENTIFIER06, \n\to_EndorsementNumber07 AS ENDORSEMENTNUMBER07, \n\to_BureauVersionIdentifierEditionIdentifier07 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER07, \n\to_CarrierVersionIdentifier07 AS CARRIERVERSIONIDENTIFIER07, \n\to_EndorsementNumber08 AS ENDORSEMENTNUMBER08, \n\to_BureauVersionIdentifierEditionIdentifier08 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER08, \n\to_CarrierVersionIdentifier08 AS CARRIERVERSIONIDENTIFIER08, \n\to_EndorsementNumber09 AS ENDORSEMENTNUMBER09, \n\to_BureauVersionIdentifierEditionIdentifier09 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER09, \n\to_CarrierVersionIdentifier09 AS CARRIERVERSIONIDENTIFIER09, \n\to_EndorsementNumber10 AS ENDORSEMENTNUMBER10, \n\to_BureauVersionIdentifierEditionIdentifier10 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER10, \n\to_CarrierVersionIdentifier10 AS CARRIERVERSIONIDENTIFIER10, \n\to_EndorsementNumber11 AS ENDORSEMENTNUMBER11, \n\to_BureauVersionIdentifierEditionIdentifier11 AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER11, \n\to_CarrierVersionIdentifier11 AS CARRIERVERSIONIDENTIFIER11, \n\to_PolicyChangeEffectiveDate AS POLICYCHANGEEFFECTIVEDATE, \n\to_PolicyChangeExpirationDate AS POLICYCHANGEEXPIRATIONDATE\n\tFROM EXP_Format_Output\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_07": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}