WITH
SQ_ADJUSTER_TAB_STAGE1 AS (
	SELECT ADJUSTER_TAB_STAGE.ADJUSTER_TAB_ID, ADJUSTER_TAB_STAGE.CAJ_EMP_CLIENT_ID, ADJUSTER_TAB_STAGE.CAJ_EMPLOYEE_NBR, ADJUSTER_TAB_STAGE.CAJ_SPV_NBR, ADJUSTER_TAB_STAGE.CAJ_USER_ID, ADJUSTER_TAB_STAGE.CAJ_COORDINATOR_ID, ADJUSTER_TAB_STAGE.CAJ_DIR_ATO_LIMIT, ADJUSTER_TAB_STAGE.CAJ_MED_ATO_LIMIT, ADJUSTER_TAB_STAGE.CAJ_XPN_ATO_LIMIT, ADJUSTER_TAB_STAGE.CAJ_XPN_AUT_RES, ADJUSTER_TAB_STAGE.CAJ_XPN_AUT_PMT, ADJUSTER_TAB_STAGE.CAJ_MED_AUT_RES, ADJUSTER_TAB_STAGE.CAJ_MED_AUT_PMT, ADJUSTER_TAB_STAGE.CAJ_DIR_AUT_RES, ADJUSTER_TAB_STAGE.CAJ_DIR_AUT_PMT, ADJUSTER_TAB_STAGE.CAJ_ADJ_INITIALS, ADJUSTER_TAB_STAGE.CAJ_ADJUSTER_TYPE, ADJUSTER_TAB_STAGE.CAJ_ADJUSTER_NBR, ADJUSTER_TAB_STAGE.CAJ_OFFICE_TYPE, ADJUSTER_TAB_STAGE.CAJ_ADJUSTER_CLASS, ADJUSTER_TAB_STAGE.CAJ_OFFICE_ID, ADJUSTER_TAB_STAGE.CAJ_LOCATION_ID, ADJUSTER_TAB_STAGE.CAJ_ATM_GEN_DIARY, ADJUSTER_TAB_STAGE.CAJ_AUTONOMY_IND, ADJUSTER_TAB_STAGE.CAJ_HOW_FIND_IND, ADJUSTER_TAB_STAGE.CAJ_AUT_FIN_IND, ADJUSTER_TAB_STAGE.CAJ_ADJUSTER_STA, ADJUSTER_TAB_STAGE.CAJ_ENTRY_OPR_ID, ADJUSTER_TAB_STAGE.CAJ_CREATE_TS, ADJUSTER_TAB_STAGE.CAJ_UPDATE_OPR_ID, ADJUSTER_TAB_STAGE.CAJ_PMSD_TS, ADJUSTER_TAB_STAGE.CAJ_UPD_TS, ADJUSTER_TAB_STAGE.CAJ_POSITION_ID, ADJUSTER_TAB_STAGE.CAJ_DESIGNATIONS, ADJUSTER_TAB_STAGE.CAJ_ADJUSTER_TITLE, ADJUSTER_TAB_STAGE.CAJ_PRFRD_FRM_HDR, ADJUSTER_TAB_STAGE.EXTRACT_DATE, ADJUSTER_TAB_STAGE.AS_OF_DATE, ADJUSTER_TAB_STAGE.RECORD_COUNT, ADJUSTER_TAB_STAGE.SOURCE_SYSTEM_ID 
	FROM
	 ADJUSTER_TAB_STAGE
	WHERE
	ADJUSTER_TAB_STAGE.CAJ_CREATE_TS >= '@{pipeline().parameters.SELECTION_START_TS}'
	OR
	ADJUSTER_TAB_STAGE.CAJ_UPD_TS >= '@{pipeline().parameters.SELECTION_START_TS}'
),
EXP_ADJUSTER_TAB AS (
	SELECT
	ADJUSTER_TAB_ID,
	CAJ_EMP_CLIENT_ID,
	CAJ_EMPLOYEE_NBR,
	CAJ_SPV_NBR,
	CAJ_USER_ID,
	CAJ_COORDINATOR_ID,
	CAJ_DIR_ATO_LIMIT,
	CAJ_MED_ATO_LIMIT,
	CAJ_XPN_ATO_LIMIT,
	CAJ_XPN_AUT_RES,
	CAJ_XPN_AUT_PMT,
	CAJ_MED_AUT_RES,
	CAJ_MED_AUT_PMT,
	CAJ_DIR_AUT_RES,
	CAJ_DIR_AUT_PMT,
	CAJ_ADJ_INITIALS,
	CAJ_ADJUSTER_TYPE,
	CAJ_ADJUSTER_NBR,
	CAJ_OFFICE_TYPE,
	CAJ_ADJUSTER_CLASS,
	CAJ_OFFICE_ID,
	CAJ_LOCATION_ID,
	CAJ_ATM_GEN_DIARY,
	CAJ_AUTONOMY_IND,
	CAJ_HOW_FIND_IND,
	CAJ_AUT_FIN_IND,
	CAJ_ADJUSTER_STA,
	CAJ_ENTRY_OPR_ID,
	CAJ_CREATE_TS,
	CAJ_UPDATE_OPR_ID,
	CAJ_PMSD_TS,
	CAJ_UPD_TS,
	CAJ_POSITION_ID,
	CAJ_DESIGNATIONS,
	CAJ_ADJUSTER_TITLE,
	CAJ_PRFRD_FRM_HDR,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID AS SOURCE_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_ADJUSTER_TAB_STAGE1
),
ARCH_ADJUSTER_TAB_STAGE AS (
	INSERT INTO ARCH_ADJUSTER_TAB_STAGE
	(ADJUSTER_TAB_ID, CAJ_EMP_CLIENT_ID, CAJ_EMPLOYEE_NBR, CAJ_SPV_NBR, CAJ_USER_ID, CAJ_COORDINATOR_ID, CAJ_DIR_ATO_LIMIT, CAJ_MED_ATO_LIMIT, CAJ_XPN_ATO_LIMIT, CAJ_XPN_AUT_RES, CAJ_XPN_AUT_PMT, CAJ_MED_AUT_RES, CAJ_MED_AUT_PMT, CAJ_DIR_AUT_RES, CAJ_DIR_AUT_PMT, CAJ_ADJ_INITIALS, CAJ_ADJUSTER_TYPE, CAJ_ADJUSTER_NBR, CAJ_OFFICE_TYPE, CAJ_ADJUSTER_CLASS, CAJ_OFFICE_ID, CAJ_LOCATION_ID, CAJ_ATM_GEN_DIARY, CAJ_AUTONOMY_IND, CAJ_HOW_FIND_IND, CAJ_AUT_FIN_IND, CAJ_ADJUSTER_STA, CAJ_ENTRY_OPR_ID, CAJ_CREATE_TS, CAJ_UPDATE_OPR_ID, CAJ_PMSD_TS, CAJ_UPD_TS, CAJ_POSITION_ID, CAJ_DESIGNATIONS, CAJ_ADJUSTER_TITLE, CAJ_PRFRD_FRM_HDR, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)
	SELECT 
	ADJUSTER_TAB_ID, 
	CAJ_EMP_CLIENT_ID, 
	CAJ_EMPLOYEE_NBR, 
	CAJ_SPV_NBR, 
	CAJ_USER_ID, 
	CAJ_COORDINATOR_ID, 
	CAJ_DIR_ATO_LIMIT, 
	CAJ_MED_ATO_LIMIT, 
	CAJ_XPN_ATO_LIMIT, 
	CAJ_XPN_AUT_RES, 
	CAJ_XPN_AUT_PMT, 
	CAJ_MED_AUT_RES, 
	CAJ_MED_AUT_PMT, 
	CAJ_DIR_AUT_RES, 
	CAJ_DIR_AUT_PMT, 
	CAJ_ADJ_INITIALS, 
	CAJ_ADJUSTER_TYPE, 
	CAJ_ADJUSTER_NBR, 
	CAJ_OFFICE_TYPE, 
	CAJ_ADJUSTER_CLASS, 
	CAJ_OFFICE_ID, 
	CAJ_LOCATION_ID, 
	CAJ_ATM_GEN_DIARY, 
	CAJ_AUTONOMY_IND, 
	CAJ_HOW_FIND_IND, 
	CAJ_AUT_FIN_IND, 
	CAJ_ADJUSTER_STA, 
	CAJ_ENTRY_OPR_ID, 
	CAJ_CREATE_TS, 
	CAJ_UPDATE_OPR_ID, 
	CAJ_PMSD_TS, 
	CAJ_UPD_TS, 
	CAJ_POSITION_ID, 
	CAJ_DESIGNATIONS, 
	CAJ_ADJUSTER_TITLE, 
	CAJ_PRFRD_FRM_HDR, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_ID AS SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_ADJUSTER_TAB
),