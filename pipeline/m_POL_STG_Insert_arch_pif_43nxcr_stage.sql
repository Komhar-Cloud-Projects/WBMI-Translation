WITH
SQ_PIF43NXCRStage AS (
	SELECT
		PIF43NXCRStageId,
		ExtractDate,
		SourceSystemId,
		PifSymbol,
		PifPolicyNumber,
		PifPolicyModule,
		PMDNXC1RecLength,
		PMDNXC1ActionCode,
		PMDNXC1FileID,
		PMDNXC1SegmentID,
		PMDNXC1SegmentStatus,
		PMDNXC1YearTransaction,
		PMDNXC1MonthTransaction,
		PMDNXC1DayTransaction,
		PMDNXC1SegmentLevelCode,
		PMDNXC1SegmentPartCode,
		PMDNXC1SubPartCode,
		PMDNXC1InsuranceLine,
		PMDNXC1LocationNumber,
		PMDNXC1SubLocationNumber,
		PMDNXC1YearItemEffective,
		PMDNXC1MonthItemEffective,
		PMDNXC1DayItemEffective,
		PMDNXC1VariableKey,
		PMDNXC1YearProcess,
		PMDNXC1MonthProcess,
		PMDNXC1DayProcess,
		PMDNXC1StateCode,
		PMDNXC1RatePlan,
		PMDNXC1InitialPremises,
		PMDNXC1TerritoryCode,
		PMDNXC1CspClassCode,
		PMDNXC1ClassDescCode,
		PMDNXC1ClassDescSource,
		PMDNXC1PmaCode,
		PMDNXC1BlanketInd,
		PMDNXC1PropertyCovered,
		PMDNXC1ClassLimit,
		PMDNXC1SafeClass,
		PMDNXC1PersonsOnDuty,
		PMDNXC1NumberOfRooms,
		PMDNXC1NumberRentedBoxes,
		PMDNXC1PaExtentProtect,
		PMDNXC1PaConnectWith,
		PMDNXC1PaGradeOfAlarm,
		PMDNXC1PaKeys,
		PMDNXC1SvExtentProtect,
		PMDNXC1SvConnectWith,
		PMDNXC1SvGradeOfAlarm,
		PMDNXC1SvKeys,
		PMDNXC1ScheduleMod,
		PMDNXC1ExperienceMod,
		PMDNXC1ComRedMod,
		PMDNXC1OtherMod,
		PMDNXC1GrossRevenue,
		PMDNXC1RateGroupC,
		PMDNXC1RateGroupDR,
		PMDNXC1RateGroupDS,
		PMDNXC1RateGroupE,
		PMDNXC1RateGroupH,
		PMDNXC1RateGroupSBF,
		PMDNXC1RateGroupSBR,
		PMDNXC1CompanyNumber,
		PMDNXC1PaFloor,
		PMDNXC1ClassDescription,
		PMDNXC1ExpenseMod,
		PMDNXC1DecChangeFlag,
		PMDNXC1NumAddlLocs,
		PMDNXC1NumPerAccts,
		PMDNXC1PersonalAcctLimit,
		PMDNXC1PcoNum,
		PMDNXC1StatCode,
		PMDNXC1CoverageCode,
		PMDNXC1BusinessClass,
		PMDNXC1ErisaInd,
		PMDNXC1PmsFutureUse,
		PMDNXC1CustomerUser,
		PMDNXC1Yr2000CustUse
	FROM PIF43NXCRStage
),
EXP_VALUES AS (
	SELECT
	PIF43NXCRStageId,
	ExtractDate,
	SourceSystemId,
	PifSymbol,
	PifPolicyNumber,
	PifPolicyModule,
	PMDNXC1RecLength,
	PMDNXC1ActionCode,
	PMDNXC1FileID,
	PMDNXC1SegmentID,
	PMDNXC1SegmentStatus,
	PMDNXC1YearTransaction,
	PMDNXC1MonthTransaction,
	PMDNXC1DayTransaction,
	PMDNXC1SegmentLevelCode,
	PMDNXC1SegmentPartCode,
	PMDNXC1SubPartCode,
	PMDNXC1InsuranceLine,
	PMDNXC1LocationNumber,
	PMDNXC1SubLocationNumber,
	PMDNXC1YearItemEffective,
	PMDNXC1MonthItemEffective,
	PMDNXC1DayItemEffective,
	PMDNXC1VariableKey,
	PMDNXC1YearProcess,
	PMDNXC1MonthProcess,
	PMDNXC1DayProcess,
	PMDNXC1StateCode,
	PMDNXC1RatePlan,
	PMDNXC1InitialPremises,
	PMDNXC1TerritoryCode,
	PMDNXC1CspClassCode,
	PMDNXC1ClassDescCode,
	PMDNXC1ClassDescSource,
	PMDNXC1PmaCode,
	PMDNXC1BlanketInd,
	PMDNXC1PropertyCovered,
	PMDNXC1ClassLimit,
	PMDNXC1SafeClass,
	PMDNXC1PersonsOnDuty,
	PMDNXC1NumberOfRooms,
	PMDNXC1NumberRentedBoxes,
	PMDNXC1PaExtentProtect,
	PMDNXC1PaConnectWith,
	PMDNXC1PaGradeOfAlarm,
	PMDNXC1PaKeys,
	PMDNXC1SvExtentProtect,
	PMDNXC1SvConnectWith,
	PMDNXC1SvGradeOfAlarm,
	PMDNXC1SvKeys,
	PMDNXC1ScheduleMod,
	PMDNXC1ExperienceMod,
	PMDNXC1ComRedMod,
	PMDNXC1OtherMod,
	PMDNXC1GrossRevenue,
	PMDNXC1RateGroupC,
	PMDNXC1RateGroupDR,
	PMDNXC1RateGroupDS,
	PMDNXC1RateGroupE,
	PMDNXC1RateGroupH,
	PMDNXC1RateGroupSBF,
	PMDNXC1RateGroupSBR,
	PMDNXC1CompanyNumber,
	PMDNXC1PaFloor,
	PMDNXC1ClassDescription,
	PMDNXC1ExpenseMod,
	PMDNXC1DecChangeFlag,
	PMDNXC1NumAddlLocs,
	PMDNXC1NumPerAccts,
	PMDNXC1PersonalAcctLimit,
	PMDNXC1PcoNum,
	PMDNXC1StatCode,
	PMDNXC1CoverageCode,
	PMDNXC1BusinessClass,
	PMDNXC1ErisaInd,
	PMDNXC1PmsFutureUse,
	PMDNXC1CustomerUser,
	PMDNXC1Yr2000CustUse,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_PIF43NXCRStage
),
ArchPIF43NXCRStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPIF43NXCRStage
	(PIF43NXCRStageId, ExtractDate, SourceSystemId, AuditId, PifSymbol, PifPolicyNumber, PifPolicyModule, PMDNXC1RecLength, PMDNXC1ActionCode, PMDNXC1FileID, PMDNXC1SegmentID, PMDNXC1SegmentStatus, PMDNXC1YearTransaction, PMDNXC1MonthTransaction, PMDNXC1DayTransaction, PMDNXC1SegmentLevelCode, PMDNXC1SegmentPartCode, PMDNXC1SubPartCode, PMDNXC1InsuranceLine, PMDNXC1LocationNumber, PMDNXC1SubLocationNumber, PMDNXC1YearItemEffective, PMDNXC1MonthItemEffective, PMDNXC1DayItemEffective, PMDNXC1VariableKey, PMDNXC1YearProcess, PMDNXC1MonthProcess, PMDNXC1DayProcess, PMDNXC1StateCode, PMDNXC1RatePlan, PMDNXC1InitialPremises, PMDNXC1TerritoryCode, PMDNXC1CspClassCode, PMDNXC1ClassDescCode, PMDNXC1ClassDescSource, PMDNXC1PmaCode, PMDNXC1BlanketInd, PMDNXC1PropertyCovered, PMDNXC1ClassLimit, PMDNXC1SafeClass, PMDNXC1PersonsOnDuty, PMDNXC1NumberOfRooms, PMDNXC1NumberRentedBoxes, PMDNXC1PaExtentProtect, PMDNXC1PaConnectWith, PMDNXC1PaGradeOfAlarm, PMDNXC1PaKeys, PMDNXC1SvExtentProtect, PMDNXC1SvConnectWith, PMDNXC1SvGradeOfAlarm, PMDNXC1SvKeys, PMDNXC1ScheduleMod, PMDNXC1ExperienceMod, PMDNXC1ComRedMod, PMDNXC1OtherMod, PMDNXC1GrossRevenue, PMDNXC1RateGroupC, PMDNXC1RateGroupDR, PMDNXC1RateGroupDS, PMDNXC1RateGroupE, PMDNXC1RateGroupH, PMDNXC1RateGroupSBF, PMDNXC1RateGroupSBR, PMDNXC1CompanyNumber, PMDNXC1PaFloor, PMDNXC1ClassDescription, PMDNXC1ExpenseMod, PMDNXC1DecChangeFlag, PMDNXC1NumAddlLocs, PMDNXC1NumPerAccts, PMDNXC1PersonalAcctLimit, PMDNXC1PcoNum, PMDNXC1StatCode, PMDNXC1CoverageCode, PMDNXC1BusinessClass, PMDNXC1ErisaInd, PMDNXC1PmsFutureUse, PMDNXC1CustomerUser, PMDNXC1Yr2000CustUse)
	SELECT 
	PIF43NXCRSTAGEID, 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFPOLICYMODULE, 
	PMDNXC1RECLENGTH, 
	PMDNXC1ACTIONCODE, 
	PMDNXC1FILEID, 
	PMDNXC1SEGMENTID, 
	PMDNXC1SEGMENTSTATUS, 
	PMDNXC1YEARTRANSACTION, 
	PMDNXC1MONTHTRANSACTION, 
	PMDNXC1DAYTRANSACTION, 
	PMDNXC1SEGMENTLEVELCODE, 
	PMDNXC1SEGMENTPARTCODE, 
	PMDNXC1SUBPARTCODE, 
	PMDNXC1INSURANCELINE, 
	PMDNXC1LOCATIONNUMBER, 
	PMDNXC1SUBLOCATIONNUMBER, 
	PMDNXC1YEARITEMEFFECTIVE, 
	PMDNXC1MONTHITEMEFFECTIVE, 
	PMDNXC1DAYITEMEFFECTIVE, 
	PMDNXC1VARIABLEKEY, 
	PMDNXC1YEARPROCESS, 
	PMDNXC1MONTHPROCESS, 
	PMDNXC1DAYPROCESS, 
	PMDNXC1STATECODE, 
	PMDNXC1RATEPLAN, 
	PMDNXC1INITIALPREMISES, 
	PMDNXC1TERRITORYCODE, 
	PMDNXC1CSPCLASSCODE, 
	PMDNXC1CLASSDESCCODE, 
	PMDNXC1CLASSDESCSOURCE, 
	PMDNXC1PMACODE, 
	PMDNXC1BLANKETIND, 
	PMDNXC1PROPERTYCOVERED, 
	PMDNXC1CLASSLIMIT, 
	PMDNXC1SAFECLASS, 
	PMDNXC1PERSONSONDUTY, 
	PMDNXC1NUMBEROFROOMS, 
	PMDNXC1NUMBERRENTEDBOXES, 
	PMDNXC1PAEXTENTPROTECT, 
	PMDNXC1PACONNECTWITH, 
	PMDNXC1PAGRADEOFALARM, 
	PMDNXC1PAKEYS, 
	PMDNXC1SVEXTENTPROTECT, 
	PMDNXC1SVCONNECTWITH, 
	PMDNXC1SVGRADEOFALARM, 
	PMDNXC1SVKEYS, 
	PMDNXC1SCHEDULEMOD, 
	PMDNXC1EXPERIENCEMOD, 
	PMDNXC1COMREDMOD, 
	PMDNXC1OTHERMOD, 
	PMDNXC1GROSSREVENUE, 
	PMDNXC1RATEGROUPC, 
	PMDNXC1RATEGROUPDR, 
	PMDNXC1RATEGROUPDS, 
	PMDNXC1RATEGROUPE, 
	PMDNXC1RATEGROUPH, 
	PMDNXC1RATEGROUPSBF, 
	PMDNXC1RATEGROUPSBR, 
	PMDNXC1COMPANYNUMBER, 
	PMDNXC1PAFLOOR, 
	PMDNXC1CLASSDESCRIPTION, 
	PMDNXC1EXPENSEMOD, 
	PMDNXC1DECCHANGEFLAG, 
	PMDNXC1NUMADDLLOCS, 
	PMDNXC1NUMPERACCTS, 
	PMDNXC1PERSONALACCTLIMIT, 
	PMDNXC1PCONUM, 
	PMDNXC1STATCODE, 
	PMDNXC1COVERAGECODE, 
	PMDNXC1BUSINESSCLASS, 
	PMDNXC1ERISAIND, 
	PMDNXC1PMSFUTUREUSE, 
	PMDNXC1CUSTOMERUSER, 
	PMDNXC1YR2000CUSTUSE
	FROM EXP_VALUES
),