{
    "name": "s_m_FEED_Load_WCRB_PreExtract_Tables",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_WCRB_PreExtract_Tables",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_cause_of_injury_sup AS (\n\tSELECT\n\tcause_of_inj_code,\n\tcause_of_inj_support_id\n\tFROM (\n\t\tSELECT \n\t\t\tcause_of_inj_code,\n\t\t\tcause_of_inj_support_id\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.cause_of_injury_sup\n\t\tWHERE crrnt_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY cause_of_inj_support_id ORDER BY cause_of_inj_code) = 1\n),\nSQ_WcrbWorkTable_Type3 AS (\n\tSELECT \r\n\t       PolKey\r\n\t      ,PolicyEffectiveDae\r\n\t      ,NameOfInsured\r\n\t      ,StateCode\r\n\t      ,AccidentYear\r\n\t      ,ClaimNum\r\n\t      ,ClaimClosedDate\r\n\t      ,ClaimOccurrenceStatusCode\r\n\t      ,PaidLossAmt\r\n\t      ,TypeLossCode\r\n\t \t,Premiummasterrundate\r\n\t      ,sum(IndemnityPaymentAmount) as IndemnityPaymentAmount\r\n\t      ,sum(MedicalPaymentAmount) as MedicalPaymentAmount\r\n\t      ,RecoveryAmount\r\n\t     ,IndemnityReserveAmount\r\n\t\t ,MedicalReserveAmount\r\n\t      ,TotalMedicalAmount\r\n\t      ,TotalIndemnityAmount\r\n\t      ,CauseOfInjSupportId\r\n\t      ,InjrDescPartOfBody\r\n\t      ,InjrDescNatureOfInjr\r\n\t      ,ClassCode\r\n\t      ,OutstandingAmount\r\n\t      ,ExtractDate\r\n\t      ,SourceSystemId\r\n\t      ,AuditID\r\n\t  FROM WcrbWorkTable\r\n\tWhere PremiumMasterCalculationID = -1 AND @{pipeline().parameters.EXTRACTDATE}\r\n\t--AND ClaimNum like  ('%AF83770%')\r\n\t  group by \r\n\t   PolKey\r\n\t      ,PolicyEffectiveDae\r\n\t      ,NameOfInsured\r\n\t      ,StateCode\r\n\t      ,AccidentYear\r\n\t      ,ClaimNum\r\n\t      ,ClaimClosedDate\r\n\t      ,ClaimOccurrenceStatusCode\r\n\t      ,PaidLossAmt\r\n\t      ,TypeLossCode\r\n\t\t ,Premiummasterrundate\r\n\t    --  ,IndemnityPaymentAmount\r\n\t      ,MedicalPaymentAmount\r\n\t      ,RecoveryAmount\r\n\t      ,IndemnityReserveAmount\r\n\t      ,MedicalReserveAmount\r\n\t      ,TotalMedicalAmount\r\n\t      ,TotalIndemnityAmount\r\n\t      ,CauseOfInjSupportId\r\n\t      ,InjrDescPartOfBody\r\n\t      ,InjrDescNatureOfInjr\r\n\t      ,ClassCode\r\n\t      ,OutstandingAmount\r\n\t      ,ExtractDate\r\n\t      ,SourceSystemId\r\n\t      ,AuditID\n),\nAGG_RecordType3 AS (\n\tSELECT\n\tPolKey,\n\tPolicyEffectiveDae,\n\tNameOfInsured,\n\tStateCode,\n\tAccidentYear,\n\tClaimNum,\n\tClaimClosedDate,\n\tClaimOccurrenceStatusCode,\n\tPaidLossAmt AS i_PaidLossAmt,\n\tTypeLossCode AS i_TypeLossCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tIndemnityPaymentAmount AS i_IndemnityPaymentAmount,\n\tMedicalPaymentAmount AS i_MedicalPaymentAmount,\n\tRecoveryAmount AS i_RecoveryAmount,\n\tIndemnityReserveAmount AS i_IndemnityReserveAmount,\n\tMedicalReserveAmount AS i_MedicalReserveAmount,\n\tTotalMedicalAmount AS i_TotalMedicalAmount,\n\tTotalIndemnityAmount AS i_TotalIndemnityAmount,\n\tCauseOfInjSupportId AS i_CauseOfInjSupportId,\n\tInjrDescPartOfBody AS i_InjrDescPartOfBody,\n\tInjrDescNatureOfInjr AS i_InjrDescNatureOfInjr,\n\tClassCode AS i_ClassCode,\n\tOutstandingAmt AS i_OutstandingAmt,\n\tExtractDate AS i_ExtractDate,\n\tSourceSystemId AS i_SourceSystemId,\n\tAuditID AS i_AuditID,\n\ti_TypeLossCode AS o_TypeLossCode,\n\t-- *INF*: SUM(i_IndemnityPaymentAmount)\n\tSUM(i_IndemnityPaymentAmount) AS o_IndemnityPaymentAmount,\n\t-- *INF*: SUM(i_MedicalPaymentAmount)\n\tSUM(i_MedicalPaymentAmount) AS o_MedicalPaymentAmount,\n\t-- *INF*: SUM(i_RecoveryAmount)\n\tSUM(i_RecoveryAmount) AS o_RecoveryAmount,\n\ti_IndemnityReserveAmount AS o_IndemnityReserveAmount,\n\ti_MedicalReserveAmount AS o_MedicalReserveAmount,\n\ti_TotalMedicalAmount AS o_TotalMedicalAmount,\n\ti_TotalIndemnityAmount AS o_TotalIndemnityAmount,\n\ti_CauseOfInjSupportId AS o_CauseOfInjSupportId,\n\ti_InjrDescPartOfBody AS o_InjrDescPartOfBody,\n\ti_InjrDescNatureOfInjr AS o_InjrDescNatureOfInjr,\n\ti_ClassCode AS o_ClassCode,\n\ti_ExtractDate AS o_ExtractDate,\n\ti_SourceSystemId AS o_SourceSystemId,\n\ti_AuditID AS o_AuditID,\n\t-- *INF*: IIF(SUM(i_PaidLossAmt)+SUM(i_OutstandingAmt)>1000000,1,0)\n\tIFF(SUM(i_PaidLossAmt) + SUM(i_OutstandingAmt) > 1000000, 1, 0) AS o_Flag\n\tFROM SQ_WcrbWorkTable_Type3\n\tGROUP BY PolKey, PolicyEffectiveDae, NameOfInsured, StateCode, AccidentYear, ClaimNum, ClaimClosedDate, ClaimOccurrenceStatusCode, i_TypeLossCode, i_CauseOfInjSupportId, i_InjrDescPartOfBody, i_InjrDescNatureOfInjr, i_ClassCode\n),\nEXP_Value_Type3 AS (\n\tSELECT\n\tPolKey AS i_PolKey,\n\tPolicyEffectiveDae AS i_PolicyEffectiveDae,\n\tNameOfInsured AS i_NameOfInsured,\n\tStateCode AS i_StateCode,\n\tAccidentYear AS i_AccidentYear,\n\tClaimNum AS i_ClaimNum,\n\tClaimClosedDate AS i_ClaimClosedDate,\n\tClaimOccurrenceStatusCode AS i_ClaimOccurrenceStatusCode,\n\to_TypeLossCode AS i_TypeLossCode,\n\to_IndemnityPaymentAmount AS i_IndemnityPaymentAmount,\n\to_MedicalPaymentAmount AS i_MedicalPaymentAmount,\n\to_RecoveryAmount AS i_RecoveryAmount,\n\to_IndemnityReserveAmount AS i_IndemnityReserveAmount,\n\to_MedicalReserveAmount AS i_MedicalReserveAmount,\n\to_TotalMedicalAmount AS i_TotalMedicalAmount,\n\to_TotalIndemnityAmount AS i_TotalIndemnityAmount,\n\to_CauseOfInjSupportId AS i_CauseOfInjSupportId,\n\to_InjrDescPartOfBody AS i_InjrDescPartOfBody,\n\to_InjrDescNatureOfInjr AS i_InjrDescNatureOfInjr,\n\to_ClassCode AS i_ClassCode,\n\to_ExtractDate AS i_ExtractDate,\n\to_SourceSystemId AS i_SourceSystemId,\n\to_AuditID AS i_AuditID,\n\to_Flag AS i_Flag,\n\t'03' AS o_RecordType,\n\ti_PolKey AS o_PolicyNumber,\n\ti_PolicyEffectiveDae AS o_PolicyEffectiveDate,\n\ti_NameOfInsured AS o_NameOfInsured,\n\ti_StateCode AS o_StateCode,\n\ti_AccidentYear AS o_AccidentYear,\n\t-- *INF*: SUBSTR(i_ClaimNum,1,18)\n\tSUBSTR(i_ClaimNum, 1, 18) AS o_ClaimNumber,\n\ti_ClaimClosedDate AS o_ClaimClosedDate,\n\ti_ClaimOccurrenceStatusCode AS o_ClaimStatus,\n\ti_ClassCode AS o_ClassCode,\n\ti_IndemnityPaymentAmount AS o_IndemnityPaymentAmount,\n\ti_MedicalPaymentAmount AS o_MedicalPaymentAmount,\n\ti_RecoveryAmount AS o_RecoveryAmount,\n\ti_IndemnityReserveAmount AS o_IndemnityReserveAmount,\n\ti_MedicalReserveAmount AS o_MedicalReserveAmount,\n\ti_MedicalPaymentAmount + i_MedicalReserveAmount AS o_TotalMedicalAmount,\n\ti_IndemnityPaymentAmount + i_IndemnityReserveAmount AS o_TotalIndemnityAmount,\n\t-- *INF*: IIF(i_Flag=1,IIF(LTRIM(i_TypeLossCode)='','00',i_TypeLossCode),'00')\n\tIFF(i_Flag = 1, IFF(\n\t        LTRIM(i_TypeLossCode) = '', '00', i_TypeLossCode\n\t    ), '00') AS o_InjuryDescriptionCodeForLossesIncurredGt1m,\n\t-- *INF*: IIF(i_Flag=1,IIF(LTRIM(i_InjrDescPartOfBody)='','00',i_InjrDescPartOfBody),'00')\n\tIFF(\n\t    i_Flag = 1,\n\t    IFF(\n\t        LTRIM(i_InjrDescPartOfBody) = '', '00', i_InjrDescPartOfBody\n\t    ),\n\t    '00'\n\t) AS o_InjuryDescriptionCodePartOfBodyForLossesIncurredGt1m,\n\t-- *INF*: IIF(i_Flag=1,IIF(LTRIM(i_InjrDescNatureOfInjr)='','00',i_InjrDescNatureOfInjr),'00')\n\tIFF(\n\t    i_Flag = 1,\n\t    IFF(\n\t        LTRIM(i_InjrDescNatureOfInjr) = '', '00', i_InjrDescNatureOfInjr\n\t    ),\n\t    '00'\n\t) AS o_InjuryDescriptionCodeNatureOfInjuryForLossesIncurredGt1m,\n\t-- *INF*: RTRIM(LTRIM(:LKP.LKP_CAUSE_OF_INJURY_SUP(i_CauseOfInjSupportId)))\n\tRTRIM(LTRIM(LKP_CAUSE_OF_INJURY_SUP_i_CauseOfInjSupportId.cause_of_inj_code)) AS v_CauseOfInj,\n\t-- *INF*: IIF(i_Flag=1,IIF(v_CauseOfInj='N/A','00',v_CauseOfInj),'00')\n\tIFF(i_Flag = 1, IFF(\n\t        v_CauseOfInj = 'N/A', '00', v_CauseOfInj\n\t    ), '00') AS o_InjuryDescriptionCodeCauseOfInjuryForLossesIncurredGt1m,\n\ti_ExtractDate AS o_ExtractDate,\n\ti_SourceSystemId AS o_SourceSystemId,\n\ti_AuditID AS o_AuditID\n\tFROM AGG_RecordType3\n\tLEFT JOIN LKP_CAUSE_OF_INJURY_SUP LKP_CAUSE_OF_INJURY_SUP_i_CauseOfInjSupportId\n\tON LKP_CAUSE_OF_INJURY_SUP_i_CauseOfInjSupportId.cause_of_inj_support_id = i_CauseOfInjSupportId\n\n),\nTGT_WcrbCarrierPoolWIRecordType3_Insert AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType3;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType3\n\t(RecordType, PolicyNumber, PolicyEffectiveDate, NameOfInsured, StateCode, AccidentYear, ClaimNumber, ClaimClosedDate, ClaimStatus, ClassCode, IndemnityPaymentAmount, MedicalPaymentAmount, RecoveryAmount, IndemnityReserveAmount, MedicalReserveAmount, TotalMedicalAmount, TotalIndemnityAmount, InjuryDescriptionCodeForLossesIncurredGt1m, InjuryDescriptionCodePartOfBodyForLossesIncurredGt1m, InjuryDescriptionCodeNatureOfInjuryForLossesIncurredGt1m, InjuryDescriptionCodeCauseOfInjuryForLossesIncurredGt1m, ExtractDate, SourceSystemId, AuditID)\n\tSELECT \n\to_RecordType AS RECORDTYPE, \n\to_PolicyNumber AS POLICYNUMBER, \n\to_PolicyEffectiveDate AS POLICYEFFECTIVEDATE, \n\to_NameOfInsured AS NAMEOFINSURED, \n\to_StateCode AS STATECODE, \n\to_AccidentYear AS ACCIDENTYEAR, \n\to_ClaimNumber AS CLAIMNUMBER, \n\to_ClaimClosedDate AS CLAIMCLOSEDDATE, \n\to_ClaimStatus AS CLAIMSTATUS, \n\to_ClassCode AS CLASSCODE, \n\to_IndemnityPaymentAmount AS INDEMNITYPAYMENTAMOUNT, \n\to_MedicalPaymentAmount AS MEDICALPAYMENTAMOUNT, \n\to_RecoveryAmount AS RECOVERYAMOUNT, \n\to_IndemnityReserveAmount AS INDEMNITYRESERVEAMOUNT, \n\to_MedicalReserveAmount AS MEDICALRESERVEAMOUNT, \n\to_TotalMedicalAmount AS TOTALMEDICALAMOUNT, \n\to_TotalIndemnityAmount AS TOTALINDEMNITYAMOUNT, \n\to_InjuryDescriptionCodeForLossesIncurredGt1m AS INJURYDESCRIPTIONCODEFORLOSSESINCURREDGT1M, \n\to_InjuryDescriptionCodePartOfBodyForLossesIncurredGt1m AS INJURYDESCRIPTIONCODEPARTOFBODYFORLOSSESINCURREDGT1M, \n\to_InjuryDescriptionCodeNatureOfInjuryForLossesIncurredGt1m AS INJURYDESCRIPTIONCODENATUREOFINJURYFORLOSSESINCURREDGT1M, \n\to_InjuryDescriptionCodeCauseOfInjuryForLossesIncurredGt1m AS INJURYDESCRIPTIONCODECAUSEOFINJURYFORLOSSESINCURREDGT1M, \n\to_ExtractDate AS EXTRACTDATE, \n\to_SourceSystemId AS SOURCESYSTEMID, \n\to_AuditID AS AUDITID\n\tFROM EXP_Value_Type3\n),\nSQ_WcrbWorkTable_Type2 AS (\n\tSELECT\n\t\tWCClaimantDetId,\n\t\tClaimantId,\n\t\tClaimOccurrenceId,\n\t\tClaimPartyOccurrenceId,\n\t\tClaimantCovDetId,\n\t\tLossMasterCalculationId,\n\t\tPolId,\n\t\tRiskLocationID,\n\t\tPolicyCoverageID,\n\t\tStatisticalCoverageID,\n\t\tPremiumTransactionID,\n\t\tBureauStatisticalCodeID,\n\t\tPremiumMasterCalculationID,\n\t\tPremiumMasterRunDate,\n\t\tPolKey,\n\t\tPolicyEffectiveDae,\n\t\tNameOfInsured,\n\t\tStateCode,\n\t\tWrittenPremium,\n\t\tEarnedPremium,\n\t\tUneranedPremium,\n\t\tDeferredPremium,\n\t\tAccidentYear,\n\t\tClaimNum,\n\t\tClaimClosedDate,\n\t\tClaimOccurrenceStatusCode,\n\t\tPaidLossAmt,\n\t\tTypeLossCode,\n\t\tIndemnityPaymentAmount,\n\t\tMedicalPaymentAmount,\n\t\tRecoveryAmount,\n\t\tIndemnityReserveAmount,\n\t\tMedicalReserveAmount,\n\t\tTotalMedicalAmount,\n\t\tTotalIndemnityAmount,\n\t\tCauseOfInjSupportId,\n\t\tInjrDescLoss,\n\t\tBodyPartSupportId,\n\t\tInjrDescPartOfBody,\n\t\tNatureOfInjSupportId,\n\t\tInjrDescNatureOfInjr,\n\t\tTypeDisabilitySupportId,\n\t\tInjrDescCauseOfLoss,\n\t\tPremiumMasterAgencyCommissionRate,\n\t\tCommissionPaid,\n\t\tClassCode,\n\t\tOutstandingAmount AS OutstandingAmt,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tAuditID,\n\t\tAuditNonComplianceChargePremium\n\tFROM WcrbWorkTable\n\tWHERE @{pipeline().parameters.EXTRACTDATE} and LossMasterCalculationId=-1\n),\nAGG_RecordType2 AS (\n\tSELECT\n\tPolKey,\n\tPolicyEffectiveDae,\n\tNameOfInsured,\n\tStateCode,\n\tWrittenPremium AS i_WrittenPremium,\n\tEarnedPremium AS i_EarnedPremium,\n\tUneranedPremium AS i_UneranedPremium,\n\tDeferredPremium AS i_DeferredPremium,\n\tExtractDate AS i_ExtractDate,\n\tSourceSystemId AS i_SourceSystemId,\n\tAuditID AS i_AuditID,\n\tAuditNonComplianceChargePremium AS i_AuditNonComplianceChargePremium,\n\t-- *INF*: SUM(i_WrittenPremium)\n\tSUM(i_WrittenPremium) AS o_AmountOfPremiumWritten,\n\t-- *INF*: SUM(i_EarnedPremium)\n\tSUM(i_EarnedPremium) AS o_AmountOfEarnedPremium,\n\t-- *INF*: SUM(i_UneranedPremium)\n\tSUM(i_UneranedPremium) AS o_AmountOfUnearnedPremium,\n\ti_DeferredPremium AS o_AmountOfPremiumDeferred,\n\ti_ExtractDate AS o_ExtractDate,\n\ti_SourceSystemId AS o_SourceSystemId,\n\ti_AuditID AS o_AuditID,\n\t-- *INF*: SUM(i_AuditNonComplianceChargePremium)\n\tSUM(i_AuditNonComplianceChargePremium) AS o_AuditNonComplianceChargePremium\n\tFROM SQ_WcrbWorkTable_Type2\n\tGROUP BY PolKey, PolicyEffectiveDae, NameOfInsured, StateCode\n),\nEXP_Value_Type2 AS (\n\tSELECT\n\tPolKey AS i_PolKey,\n\tPolicyEffectiveDae AS i_PolicyEffectiveDae,\n\tNameOfInsured AS i_NameOfInsured,\n\tStateCode AS i_StateCode,\n\to_AmountOfPremiumWritten AS i_AmountOfPremiumWritten,\n\to_AmountOfEarnedPremium AS i_AmountOfEarnedPremium,\n\to_AmountOfUnearnedPremium AS i_AmountOfUnearnedPremium,\n\to_AmountOfPremiumDeferred AS i_AmountOfPremiumDeferred,\n\to_ExtractDate AS i_ExtractDate,\n\to_SourceSystemId AS i_SourceSystemId,\n\to_AuditID AS i_AuditID,\n\to_AuditNonComplianceChargePremium AS i_AuditNonComplianceChargePremium,\n\t'02' AS o_RecordType,\n\ti_PolKey AS o_PolicyNumber,\n\ti_PolicyEffectiveDae AS o_PolicyEffectiveDate,\n\ti_NameOfInsured AS o_NameOfInsured,\n\ti_StateCode AS o_StateCode,\n\t-- *INF*: i_AmountOfPremiumWritten - i_AuditNonComplianceChargePremium\r\n\t-- --deduct ANC amounts computed for quarter from Written premium totals\n\ti_AmountOfPremiumWritten - i_AuditNonComplianceChargePremium AS o_AmountOfPremiumWrittenlessANC,\n\ti_AmountOfEarnedPremium AS o_AmountOfEarnedPremium,\n\ti_AmountOfUnearnedPremium AS o_AmountOfUnearnedPremium,\n\ti_AmountOfPremiumDeferred AS o_AmountOfPremiumDeferred,\n\ti_ExtractDate AS o_ExtractDate,\n\ti_SourceSystemId AS o_SourceSystemId,\n\ti_AuditID AS o_AuditID,\n\ti_AuditNonComplianceChargePremium AS o_AuditNonComplianceChargePremium\n\tFROM AGG_RecordType2\n),\nTGT_WcrbCarrierPoolWIRecordType2_Insert AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType2;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType2\n\t(RecordType, PolicyNumber, PolicyEffectiveDate, NameOfInsured, StateCode, AmountOfPremiumWritten, AmountOfEarnedPremium, AmountOfUnearnedPremium, AmountOfPremiumDeferred, ExtractDate, SourceSystemId, AuditID, AuditNonComplianceChargePremium)\n\tSELECT \n\to_RecordType AS RECORDTYPE, \n\to_PolicyNumber AS POLICYNUMBER, \n\to_PolicyEffectiveDate AS POLICYEFFECTIVEDATE, \n\to_NameOfInsured AS NAMEOFINSURED, \n\to_StateCode AS STATECODE, \n\to_AmountOfPremiumWrittenlessANC AS AMOUNTOFPREMIUMWRITTEN, \n\to_AmountOfEarnedPremium AS AMOUNTOFEARNEDPREMIUM, \n\to_AmountOfUnearnedPremium AS AMOUNTOFUNEARNEDPREMIUM, \n\to_AmountOfPremiumDeferred AS AMOUNTOFPREMIUMDEFERRED, \n\to_ExtractDate AS EXTRACTDATE, \n\to_SourceSystemId AS SOURCESYSTEMID, \n\to_AuditID AS AUDITID, \n\to_AuditNonComplianceChargePremium AS AUDITNONCOMPLIANCECHARGEPREMIUM\n\tFROM EXP_Value_Type2\n),\nSQ_WcrbWorkTable_Type6 AS (\n\tSELECT\n\t\tWCClaimantDetId,\n\t\tClaimantId,\n\t\tClaimOccurrenceId,\n\t\tClaimPartyOccurrenceId,\n\t\tClaimantCovDetId,\n\t\tLossMasterCalculationId,\n\t\tPolId,\n\t\tRiskLocationID,\n\t\tPolicyCoverageID,\n\t\tStatisticalCoverageID,\n\t\tPremiumTransactionID,\n\t\tBureauStatisticalCodeID,\n\t\tPremiumMasterCalculationID,\n\t\tPremiumMasterRunDate,\n\t\tPolKey,\n\t\tPolicyEffectiveDae,\n\t\tNameOfInsured,\n\t\tStateCode,\n\t\tWrittenPremium,\n\t\tEarnedPremium,\n\t\tUneranedPremium,\n\t\tDeferredPremium,\n\t\tAccidentYear,\n\t\tClaimNum,\n\t\tClaimClosedDate,\n\t\tClaimOccurrenceStatusCode,\n\t\tPaidLossAmt,\n\t\tTypeLossCode,\n\t\tIndemnityPaymentAmount,\n\t\tMedicalPaymentAmount,\n\t\tRecoveryAmount,\n\t\tIndemnityReserveAmount,\n\t\tMedicalReserveAmount,\n\t\tTotalMedicalAmount,\n\t\tTotalIndemnityAmount,\n\t\tCauseOfInjSupportId,\n\t\tInjrDescLoss,\n\t\tBodyPartSupportId,\n\t\tInjrDescPartOfBody,\n\t\tNatureOfInjSupportId,\n\t\tInjrDescNatureOfInjr,\n\t\tTypeDisabilitySupportId,\n\t\tInjrDescCauseOfLoss,\n\t\tPremiumMasterAgencyCommissionRate,\n\t\tCommissionPaid,\n\t\tClassCode,\n\t\tOutstandingAmount AS OutstandingAmt,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tAuditID\n\tFROM WcrbWorkTable\n\tWHERE @{pipeline().parameters.EXTRACTDATE} and LossMasterCalculationId=-999 and PremiumMasterCalculationID=-999\n),\nEXP_Value_Type6 AS (\n\tSELECT\n\tPolKey AS i_PolKey,\n\tPolicyEffectiveDae AS i_PolicyEffectiveDae,\n\tNameOfInsured AS i_NameOfInsured,\n\tStateCode AS i_StateCode,\n\tExtractDate AS i_ExtractDate,\n\tSourceSystemId AS i_SourceSystemId,\n\tAuditID AS i_AuditID,\n\t'06' AS o_RecordType,\n\ti_PolKey AS o_PolicyNumber,\n\ti_PolicyEffectiveDae AS o_PolicyEffectiveDate,\n\ti_NameOfInsured AS o_NameOfInsured,\n\ti_StateCode AS o_StateCode,\n\ti_ExtractDate AS o_ExtractDate,\n\ti_SourceSystemId AS o_SourceSystemId,\n\ti_AuditID AS o_AuditID,\n\tCommissionPaid\n\tFROM SQ_WcrbWorkTable_Type6\n),\nEXP_Value_Commission AS (\n\tSELECT\n\tCommissionPaid AS i_CommissionPaid,\n\to_RecordType AS RecordType,\n\to_PolicyNumber AS PolicyNumber,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_NameOfInsured AS NameOfInsured,\n\to_StateCode AS StateCode,\n\t-- *INF*: IIF(ISNULL(i_CommissionPaid),0,i_CommissionPaid)\n\tIFF(i_CommissionPaid IS NULL, 0, i_CommissionPaid) AS o_CommissionPaid,\n\to_ExtractDate AS ExtractDate,\n\to_SourceSystemId AS SourceSystemId,\n\to_AuditID AS AuditID\n\tFROM EXP_Value_Type6\n),\nTGT_WcrbCarrierPoolWIRecordType6_Insert AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType6;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WcrbCarrierPoolWIRecordType6\n\t(RecordType, PolicyNumber, PolicyEffectiveDate, NameOfInsured, StateCode, CommissionPaid, ExtractDate, SourceSystemId, AuditID)\n\tSELECT \n\tRECORDTYPE, \n\tPOLICYNUMBER, \n\tPOLICYEFFECTIVEDATE, \n\tNAMEOFINSURED, \n\tSTATECODE, \n\to_CommissionPaid AS COMMISSIONPAID, \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\tAUDITID\n\tFROM EXP_Value_Commission\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "EXTRACTDATE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}