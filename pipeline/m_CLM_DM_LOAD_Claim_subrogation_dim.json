{
    "name": "m_CLM_DM_LOAD_Claim_subrogation_dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_subrogation_dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_claim_representative_subrogation AS (\n\tSELECT CRS_S.claim_rep_subrogation_id as claim_rep_subrogation_id_subro_rep,\t  \r\n\t       CRS_S.claim_rep_subrogation_ak_id as claim_rep_subrogation_ak_id_subro_rep,\r\n\t       CRS_S.claim_rep_ak_id as claim_rep_ak_id_subro_rep,\r\n\t       CRS_S.claim_rep_role_code  as claim_rep_role_code_subro_rep,\r\n\t\t   \r\n\t\t   CRS_R.claim_rep_subrogation_id as claim_rep_subrogation_id_ref,\t  \r\n\t       CRS_R.claim_rep_subrogation_ak_id as claim_rep_subrogation_ak_id_ref,\r\n\t       CRS_R.claim_rep_ak_id as claim_rep_ak_id_ref,\r\n\t       CRS_R.claim_rep_role_code  as claim_rep_role_code_ref,\r\n\t\t   CS.claim_subrogation_ak_id ,\r\n\t       CS.claim_subrogation_id ,\r\n\t       CS.claimant_cov_det_ak_id ,\r\n\t       CS.insd_ded_amt ,\r\n\t       CS.referred_to_subrogation_date ,\r\n\t       CS.subrogation_comment ,\r\n\t       CS.installment_reached_ind ,\r\n\t       CS.agreement_amt ,\r\n\t       CS.monthly_installment_amt ,\r\n\t       CS.pay_start_date ,\r\n\t       CS.file_status_code ,\r\n\t       CS.ded_status_code ,\r\n\t       CS.closure_date,\r\n\t\tdistinct_eff_From_dates.eff_from_date \r\n\tFROM   \r\n\t(\r\n\tSELECT claim_subrogation_ak_id,eff_from_date FROM dbo.claim_subrogation\r\n\tWHERE created_Date>= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tUNION\r\n\tSELECT claim_subrogation_ak_id,eff_from_date FROM dbo.claim_representative_subrogation\r\n\tWHERE created_Date>= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t) AS distinct_eff_From_Dates\r\n\t\r\n\tleft outer join claim_subrogation CS ON \r\n\tdistinct_eff_From_Dates.claim_subrogation_ak_id = CS.claim_subrogation_ak_id\r\n\tAND distinct_eff_From_Dates.eff_from_date between CS.eff_from_date AND CS.eff_to_date\r\n\t\r\n\tleft outer join claim_representative_subrogation CRS_S ON \r\n\tdistinct_eff_From_Dates.claim_subrogation_ak_id = CRS_S.claim_subrogation_ak_id\r\n\tAND distinct_eff_From_Dates.eff_from_date between CRS_S.eff_from_date AND CRS_S.eff_to_date\r\n\tand CRS_S.claim_rep_role_code = 'S'\r\n\t\r\n\tleft outer join claim_representative_subrogation CRS_R ON \r\n\tdistinct_eff_From_Dates.claim_subrogation_ak_id = CRS_R.claim_subrogation_ak_id\r\n\tAND distinct_eff_From_Dates.eff_from_date between CRS_R.eff_from_date AND CRS_R.eff_to_date\r\n\tand CRS_R.claim_rep_role_code = 'R'\n),\nLKP_claim_representative_ref_rep AS (\n\tSELECT\n\tclaim_rep_key,\n\tclaim_rep_full_name,\n\tclaim_rep_first_name,\n\tclaim_rep_last_name,\n\tclaim_rep_mid_name,\n\tclaim_rep_name_prfx,\n\tclaim_rep_name_sfx,\n\tco_descript,\n\tdvsn_code,\n\tdvsn_descript,\n\tdvsn_mgr,\n\tdept_descript,\n\tdept_name,\n\tdept_mgr,\n\thandling_office_code,\n\thandling_office_descript,\n\thandling_office_mgr,\n\tclaim_rep_wbconnect_user_id,\n\tclaim_rep_ak_id\n\tFROM (\n\t\tSELECT claim_representative.claim_rep_key               AS claim_rep_key,\r\n\t\t       claim_representative.claim_rep_full_name         AS claim_rep_full_name,\r\n\t\t       claim_representative.claim_rep_first_name        AS claim_rep_first_name,\r\n\t\t       claim_representative.claim_rep_last_name         AS claim_rep_last_name,\r\n\t\t       claim_representative.claim_rep_mid_name          AS claim_rep_mid_name,\r\n\t\t       claim_representative.claim_rep_name_prfx         AS claim_rep_name_prfx,\r\n\t\t       claim_representative.claim_rep_name_sfx          AS claim_rep_name_sfx,\r\n\t\t       claim_representative.co_descript                 AS co_descript,\r\n\t\t       claim_representative.dvsn_code                   AS dvsn_code,\r\n\t\t       claim_representative.dvsn_descript               AS dvsn_descript,\r\n\t\t       claim_representative.dvsn_mgr                    AS dvsn_mgr,\r\n\t\t       claim_representative.dept_descript               AS dept_descript,\r\n\t\t       claim_representative.dept_name                   AS dept_name,\r\n\t\t       claim_representative.dept_mgr                    AS dept_mgr,\r\n\t\t       claim_representative.handling_office_code        AS handling_office_code,\r\n\t\t       claim_representative.handling_office_descript    AS handling_office_descript,\r\n\t\t       claim_representative.handling_office_mgr         AS handling_office_mgr,\r\n\t\t       claim_representative.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id,\r\n\t\t       claim_representative.claim_rep_ak_id             AS claim_rep_ak_id\r\n\t\tFROM   claim_representative\r\n\t\tWHERE source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' \r\n\t\tAND crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id ORDER BY claim_rep_key) = 1\n),\nLKP_claim_representative_subro_rep AS (\n\tSELECT\n\tclaim_rep_key,\n\tclaim_rep_full_name,\n\tclaim_rep_first_name,\n\tclaim_rep_last_name,\n\tclaim_rep_mid_name,\n\tclaim_rep_name_prfx,\n\tclaim_rep_name_sfx,\n\tco_descript,\n\tdvsn_code,\n\tdvsn_descript,\n\tdvsn_mgr,\n\tdept_descript,\n\tdept_name,\n\tdept_mgr,\n\thandling_office_code,\n\thandling_office_descript,\n\thandling_office_mgr,\n\tclaim_rep_wbconnect_user_id,\n\tclaim_rep_ak_id\n\tFROM (\n\t\tSELECT claim_representative.claim_rep_key               AS claim_rep_key,\r\n\t\t       claim_representative.claim_rep_full_name         AS claim_rep_full_name,\r\n\t\t       claim_representative.claim_rep_first_name        AS claim_rep_first_name,\r\n\t\t       claim_representative.claim_rep_last_name         AS claim_rep_last_name,\r\n\t\t       claim_representative.claim_rep_mid_name          AS claim_rep_mid_name,\r\n\t\t       claim_representative.claim_rep_name_prfx         AS claim_rep_name_prfx,\r\n\t\t       claim_representative.claim_rep_name_sfx          AS claim_rep_name_sfx,\r\n\t\t       claim_representative.co_descript                 AS co_descript,\r\n\t\t       claim_representative.dvsn_code                   AS dvsn_code,\r\n\t\t       claim_representative.dvsn_descript               AS dvsn_descript,\r\n\t\t       claim_representative.dvsn_mgr                    AS dvsn_mgr,\r\n\t\t       claim_representative.dept_descript               AS dept_descript,\r\n\t\t       claim_representative.dept_name                   AS dept_name,\r\n\t\t       claim_representative.dept_mgr                    AS dept_mgr,\r\n\t\t       claim_representative.handling_office_code        AS handling_office_code,\r\n\t\t       claim_representative.handling_office_descript    AS handling_office_descript,\r\n\t\t       claim_representative.handling_office_mgr         AS handling_office_mgr,\r\n\t\t       claim_representative.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id,\r\n\t\t       claim_representative.claim_rep_ak_id             AS claim_rep_ak_id\r\n\t\tFROM   claim_representative\r\n\t\tWHERE source_sys_id = '@{pipeline().parameters.SOURCE_SYSTEM_ID}' \r\n\t\tAND crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id ORDER BY claim_rep_key) = 1\n),\nLKP_sup_claim_subrogation_deductible_status_code AS (\n\tSELECT\n\tded_status_code_descript,\n\tded_status_code\n\tFROM (\n\t\tSELECT sup_claim_subrogation_deductible_status_code.ded_status_code_descript as ded_status_code_descript, sup_claim_subrogation_deductible_status_code.ded_status_code as ded_status_code \r\n\t\tFROM sup_claim_subrogation_deductible_status_code\r\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ded_status_code ORDER BY ded_status_code_descript) = 1\n),\nLKP_sup_claim_subrogation_file_status_code AS (\n\tSELECT\n\tfile_status_code_descript,\n\tfile_status_code\n\tFROM (\n\t\tSELECT \n\t\t\tfile_status_code_descript,\n\t\t\tfile_status_code\n\t\tFROM sup_claim_subrogation_file_status_code\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY file_status_code ORDER BY file_status_code_descript) = 1\n),\nEXPTRANS AS (\n\tSELECT\n\tSQ_claim_representative_subrogation.claim_rep_subrogation_id_subro_rep,\n\tSQ_claim_representative_subrogation.claim_rep_subrogation_ak_id_subro_rep,\n\tSQ_claim_representative_subrogation.claim_rep_ak_id_subro_rep,\n\tSQ_claim_representative_subrogation.claim_rep_role_code_subro_rep,\n\tSQ_claim_representative_subrogation.claim_rep_subrogation_id_ref,\n\tSQ_claim_representative_subrogation.claim_rep_subrogation_ak_id_ref,\n\tSQ_claim_representative_subrogation.claim_rep_ak_id_ref,\n\tSQ_claim_representative_subrogation.claim_rep_role_code_ref,\n\tSQ_claim_representative_subrogation.claim_subrogation_ak_id,\n\tSQ_claim_representative_subrogation.claim_subrogation_id,\n\tSQ_claim_representative_subrogation.claimant_cov_det_ak_id,\n\tSQ_claim_representative_subrogation.insd_ded_amt,\n\tSQ_claim_representative_subrogation.referred_to_subrogation_date,\n\tSQ_claim_representative_subrogation.subrogation_comment,\n\tSQ_claim_representative_subrogation.installment_reached_ind,\n\tSQ_claim_representative_subrogation.agreement_amt,\n\tSQ_claim_representative_subrogation.monthly_installment_amt,\n\tSQ_claim_representative_subrogation.pay_start_date,\n\tSQ_claim_representative_subrogation.file_status_code,\n\tSQ_claim_representative_subrogation.ded_status_code,\n\tSQ_claim_representative_subrogation.closure_date,\n\tSQ_claim_representative_subrogation.eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tsysdate AS created_modified_Date,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tLKP_sup_claim_subrogation_deductible_status_code.ded_status_code_descript,\n\t-- *INF*: IIF(ISNULL(ded_status_code_descript), 'N/A', ded_status_code_descript)\n\tIFF(ded_status_code_descript IS NULL, 'N/A', ded_status_code_descript) AS ded_status_code_descript_out,\n\tLKP_sup_claim_subrogation_file_status_code.file_status_code_descript,\n\t-- *INF*: IIF(ISNULL(file_status_code_descript), 'N/A', file_status_code_descript)\n\tIFF(file_status_code_descript IS NULL, 'N/A', file_status_code_descript) AS file_status_code_descript_out,\n\tLKP_claim_representative_subro_rep.claim_rep_key AS claim_rep_key_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_full_name AS claim_rep_full_name_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_first_name AS claim_rep_first_name_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_last_name AS claim_rep_last_name_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_mid_name AS claim_rep_mid_name_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_name_prfx AS claim_rep_name_prfx_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_name_sfx AS claim_rep_name_sfx_subro_rep,\n\tLKP_claim_representative_subro_rep.co_descript AS co_descript_subro_rep,\n\tLKP_claim_representative_subro_rep.dvsn_code AS dvsn_code_subro_rep,\n\tLKP_claim_representative_subro_rep.dvsn_descript AS dvsn_descript_subro_rep,\n\tLKP_claim_representative_subro_rep.dvsn_mgr AS dvsn_mgr_subro_rep,\n\tLKP_claim_representative_subro_rep.dept_descript AS dept_descript_subro_rep,\n\tLKP_claim_representative_subro_rep.dept_name AS dept_name_subro_rep,\n\tLKP_claim_representative_subro_rep.dept_mgr AS dept_mgr_subro_rep,\n\tLKP_claim_representative_subro_rep.handling_office_code AS handling_office_code_subro_rep,\n\tLKP_claim_representative_subro_rep.handling_office_descript AS handling_office_descript_subro_rep,\n\tLKP_claim_representative_subro_rep.handling_office_mgr AS handling_office_mgr_subro_rep,\n\tLKP_claim_representative_subro_rep.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id_subro_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_key AS claim_rep_key_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_full_name AS claim_rep_full_name_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_first_name AS claim_rep_first_name_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_last_name AS claim_rep_last_name_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_mid_name AS claim_rep_mid_name_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_name_prfx AS claim_rep_name_prfx_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_name_sfx AS claim_rep_name_sfx_ref_rep,\n\tLKP_claim_representative_ref_rep.co_descript AS co_descript_ref_rep,\n\tLKP_claim_representative_ref_rep.dvsn_code AS dvsn_code_ref_rep,\n\tLKP_claim_representative_ref_rep.dvsn_descript AS dvsn_descript_ref_rep,\n\tLKP_claim_representative_ref_rep.dvsn_mgr AS dvsn_mgr_ref_rep,\n\tLKP_claim_representative_ref_rep.dept_descript AS dept_descript_ref_rep,\n\tLKP_claim_representative_ref_rep.dept_name AS dept_name_ref_rep,\n\tLKP_claim_representative_ref_rep.dept_mgr AS dept_mgr_ref_rep,\n\tLKP_claim_representative_ref_rep.handling_office_code AS handling_office_code_ref_rep,\n\tLKP_claim_representative_ref_rep.handling_office_descript AS handling_office_descript_ref_rep,\n\tLKP_claim_representative_ref_rep.handling_office_mgr AS handling_office_mgr_ref_rep,\n\tLKP_claim_representative_ref_rep.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id_ref_rep\n\tFROM SQ_claim_representative_subrogation\n\tLEFT JOIN LKP_claim_representative_ref_rep\n\tON LKP_claim_representative_ref_rep.claim_rep_ak_id = SQ_claim_representative_subrogation.claim_rep_ak_id_ref\n\tLEFT JOIN LKP_claim_representative_subro_rep\n\tON LKP_claim_representative_subro_rep.claim_rep_ak_id = SQ_claim_representative_subrogation.claim_rep_ak_id_subro_rep\n\tLEFT JOIN LKP_sup_claim_subrogation_deductible_status_code\n\tON LKP_sup_claim_subrogation_deductible_status_code.ded_status_code = SQ_claim_representative_subrogation.ded_status_code\n\tLEFT JOIN LKP_sup_claim_subrogation_file_status_code\n\tON LKP_sup_claim_subrogation_file_status_code.file_status_code = SQ_claim_representative_subrogation.file_status_code\n),\nLKP_claim_subrogation_dim AS (\n\tSELECT\n\tclaim_subrogation_dim_id,\n\tedw_claim_subrogation_pk_id,\n\tedw_claim_rep_subrogation_pk_id_subrogation_rep,\n\tedw_claim_rep_subrogation_pk_id_referring_adjuster\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_subrogation_dim_id,\n\t\t\tedw_claim_subrogation_pk_id,\n\t\t\tedw_claim_rep_subrogation_pk_id_subrogation_rep,\n\t\t\tedw_claim_rep_subrogation_pk_id_referring_adjuster\n\t\tFROM claim_subrogation_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_subrogation_pk_id,edw_claim_rep_subrogation_pk_id_subrogation_rep,edw_claim_rep_subrogation_pk_id_referring_adjuster ORDER BY claim_subrogation_dim_id) = 1\n),\nRTRTRANS AS (\n\tSELECT\n\tLKP_claim_subrogation_dim.claim_subrogation_dim_id,\n\tEXPTRANS.claim_rep_subrogation_id_subro_rep,\n\tEXPTRANS.claim_rep_subrogation_ak_id_subro_rep,\n\tEXPTRANS.claim_rep_ak_id_subro_rep,\n\tEXPTRANS.claim_rep_role_code_subro_rep,\n\tEXPTRANS.claim_rep_subrogation_id_ref,\n\tEXPTRANS.claim_rep_subrogation_ak_id_ref,\n\tEXPTRANS.claim_rep_ak_id_ref,\n\tEXPTRANS.claim_rep_role_code_ref,\n\tEXPTRANS.claim_subrogation_ak_id,\n\tEXPTRANS.claim_subrogation_id,\n\tEXPTRANS.claimant_cov_det_ak_id,\n\tEXPTRANS.insd_ded_amt,\n\tEXPTRANS.referred_to_subrogation_date,\n\tEXPTRANS.subrogation_comment,\n\tEXPTRANS.installment_reached_ind,\n\tEXPTRANS.agreement_amt,\n\tEXPTRANS.monthly_installment_amt,\n\tEXPTRANS.pay_start_date,\n\tEXPTRANS.file_status_code,\n\tEXPTRANS.ded_status_code,\n\tEXPTRANS.closure_date,\n\tEXPTRANS.eff_from_date,\n\tEXPTRANS.eff_to_date,\n\tEXPTRANS.created_modified_Date,\n\tEXPTRANS.crrnt_snpsht_flag,\n\tEXPTRANS.audit_id,\n\tEXPTRANS.ded_status_code_descript_out AS ded_status_code_descript,\n\tEXPTRANS.file_status_code_descript_out AS file_status_code_descript,\n\tEXPTRANS.claim_rep_key_subro_rep,\n\tEXPTRANS.claim_rep_full_name_subro_rep,\n\tEXPTRANS.claim_rep_first_name_subro_rep,\n\tEXPTRANS.claim_rep_last_name_subro_rep,\n\tEXPTRANS.claim_rep_mid_name_subro_rep,\n\tEXPTRANS.claim_rep_name_prfx_subro_rep,\n\tEXPTRANS.claim_rep_name_sfx_subro_rep,\n\tEXPTRANS.co_descript_subro_rep,\n\tEXPTRANS.dvsn_code_subro_rep,\n\tEXPTRANS.dvsn_descript_subro_rep,\n\tEXPTRANS.dvsn_mgr_subro_rep,\n\tEXPTRANS.dept_descript_subro_rep,\n\tEXPTRANS.dept_name_subro_rep,\n\tEXPTRANS.dept_mgr_subro_rep,\n\tEXPTRANS.handling_office_code_subro_rep,\n\tEXPTRANS.handling_office_descript_subro_rep,\n\tEXPTRANS.handling_office_mgr_subro_rep,\n\tEXPTRANS.claim_rep_wbconnect_user_id_subro_rep,\n\tEXPTRANS.claim_rep_key_ref_rep,\n\tEXPTRANS.claim_rep_full_name_ref_rep,\n\tEXPTRANS.claim_rep_first_name_ref_rep,\n\tEXPTRANS.claim_rep_last_name_ref_rep,\n\tEXPTRANS.claim_rep_mid_name_ref_rep,\n\tEXPTRANS.claim_rep_name_prfx_ref_rep,\n\tEXPTRANS.claim_rep_name_sfx_ref_rep,\n\tEXPTRANS.co_descript_ref_rep,\n\tEXPTRANS.dvsn_code_ref_rep,\n\tEXPTRANS.dvsn_descript_ref_rep,\n\tEXPTRANS.dvsn_mgr_ref_rep,\n\tEXPTRANS.dept_descript_ref_rep,\n\tEXPTRANS.dept_name_ref_rep,\n\tEXPTRANS.dept_mgr_ref_rep,\n\tEXPTRANS.handling_office_code_ref_rep,\n\tEXPTRANS.handling_office_descript_ref_rep,\n\tEXPTRANS.handling_office_mgr_ref_rep,\n\tEXPTRANS.claim_rep_wbconnect_user_id_ref_rep\n\tFROM EXPTRANS\n\tLEFT JOIN LKP_claim_subrogation_dim\n\tON LKP_claim_subrogation_dim.edw_claim_subrogation_pk_id = EXPTRANS.claim_subrogation_id AND LKP_claim_subrogation_dim.edw_claim_rep_subrogation_pk_id_subrogation_rep = EXPTRANS.claim_rep_subrogation_id_subro_rep AND LKP_claim_subrogation_dim.edw_claim_rep_subrogation_pk_id_referring_adjuster = EXPTRANS.claim_rep_subrogation_id_ref\n),\nRTRTRANS_Insert AS (SELECT * FROM RTRTRANS WHERE ISNULL(claim_subrogation_dim_id)),\nRTRTRANS_DEFAULT1 AS (SELECT * FROM RTRTRANS WHERE NOT ( (ISNULL(claim_subrogation_dim_id)) )),\nclaim_subrogation_dim AS (\n\tINSERT INTO claim_subrogation_dim\n\t(crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, edw_claim_subrogation_pk_id, edw_claim_rep_subrogation_pk_id_subrogation_rep, edw_claim_rep_subrogation_pk_id_referring_adjuster, edw_claim_subrogation_ak_id, edw_claimant_cov_det_ak_id, edw_claim_rep_subrogation_ak_id_subrogation_rep, edw_claim_rep_subrogation_ak_id_referring_adjuster, insd_ded_amt, referred_to_subrogation_date, subrogation_comment, installment_reached_ind, agreement_amt, monthly_installment_amt, pay_start_date, file_status_code, file_status_code_descript, ded_status_code, ded_status_code_descript, closure_date, subrogation_rep_co_descript, subrogation_rep_dvsn_code, subrogation_rep_dvsn_descript, subrogation_rep_dvsn_mgr, subrogation_rep_dept_descript, subrogation_rep_dept_name, subrogation_rep_dept_mgr, subrogation_rep_handling_office_code, subrogation_rep_handling_office_descript, subrogation_rep_handling_office_mgr, subrogation_rep_key, subrogation_rep_full_name, subrogation_rep_first_name, subrogation_rep_last_name, subrogation_rep_mid_name, subrogation_rep_name_prfx, subrogation_rep_name_sfx, subrogation_rep_wbconnect_user_id, referring_adjuster_co_descript, referring_adjuster_dvsn_code, referring_adjuster_dvsn_descript, referring_adjuster_dvsn_mgr, referring_adjuster_dept_descript, referring_adjuster_dept_name, referring_adjuster_dept_mgr, referring_adjuster_handling_office_code, referring_adjuster_handling_office_descript, referring_adjuster_handling_office_mgr, referring_adjuster_key, referring_adjuster_full_name, referring_adjuster_first_name, referring_adjuster_last_name, referring_adjuster_mid_name, referring_adjuster_name_prfx, referring_adjuster_name_sfx, referring_adjuster_wbconnect_user_id)\n\tSELECT \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tcreated_modified_Date AS CREATED_DATE, \n\tcreated_modified_Date AS MODIFIED_DATE, \n\tclaim_subrogation_id AS EDW_CLAIM_SUBROGATION_PK_ID, \n\tclaim_rep_subrogation_id_subro_rep AS EDW_CLAIM_REP_SUBROGATION_PK_ID_SUBROGATION_REP, \n\tclaim_rep_subrogation_id_ref AS EDW_CLAIM_REP_SUBROGATION_PK_ID_REFERRING_ADJUSTER, \n\tclaim_subrogation_ak_id AS EDW_CLAIM_SUBROGATION_AK_ID, \n\tclaimant_cov_det_ak_id AS EDW_CLAIMANT_COV_DET_AK_ID, \n\tclaim_rep_subrogation_ak_id_subro_rep AS EDW_CLAIM_REP_SUBROGATION_AK_ID_SUBROGATION_REP, \n\tclaim_rep_subrogation_ak_id_ref AS EDW_CLAIM_REP_SUBROGATION_AK_ID_REFERRING_ADJUSTER, \n\tINSD_DED_AMT, \n\tREFERRED_TO_SUBROGATION_DATE, \n\tSUBROGATION_COMMENT, \n\tINSTALLMENT_REACHED_IND, \n\tAGREEMENT_AMT, \n\tMONTHLY_INSTALLMENT_AMT, \n\tPAY_START_DATE, \n\tFILE_STATUS_CODE, \n\tFILE_STATUS_CODE_DESCRIPT, \n\tDED_STATUS_CODE, \n\tDED_STATUS_CODE_DESCRIPT, \n\tCLOSURE_DATE, \n\tco_descript_subro_rep AS SUBROGATION_REP_CO_DESCRIPT, \n\tdvsn_code_subro_rep AS SUBROGATION_REP_DVSN_CODE, \n\tdvsn_descript_subro_rep AS SUBROGATION_REP_DVSN_DESCRIPT, \n\tdvsn_mgr_subro_rep AS SUBROGATION_REP_DVSN_MGR, \n\tdept_descript_subro_rep AS SUBROGATION_REP_DEPT_DESCRIPT, \n\tdept_name_subro_rep AS SUBROGATION_REP_DEPT_NAME, \n\tdept_mgr_subro_rep AS SUBROGATION_REP_DEPT_MGR, \n\thandling_office_code_subro_rep AS SUBROGATION_REP_HANDLING_OFFICE_CODE, \n\thandling_office_descript_subro_rep AS SUBROGATION_REP_HANDLING_OFFICE_DESCRIPT, \n\thandling_office_mgr_subro_rep AS SUBROGATION_REP_HANDLING_OFFICE_MGR, \n\tclaim_rep_key_subro_rep AS SUBROGATION_REP_KEY, \n\tclaim_rep_full_name_subro_rep AS SUBROGATION_REP_FULL_NAME, \n\tclaim_rep_first_name_subro_rep AS SUBROGATION_REP_FIRST_NAME, \n\tclaim_rep_last_name_subro_rep AS SUBROGATION_REP_LAST_NAME, \n\tclaim_rep_mid_name_subro_rep AS SUBROGATION_REP_MID_NAME, \n\tclaim_rep_name_prfx_subro_rep AS SUBROGATION_REP_NAME_PRFX, \n\tclaim_rep_name_sfx_subro_rep AS SUBROGATION_REP_NAME_SFX, \n\tclaim_rep_wbconnect_user_id_subro_rep AS SUBROGATION_REP_WBCONNECT_USER_ID, \n\tco_descript_ref_rep AS REFERRING_ADJUSTER_CO_DESCRIPT, \n\tdvsn_code_ref_rep AS REFERRING_ADJUSTER_DVSN_CODE, \n\tdvsn_descript_ref_rep AS REFERRING_ADJUSTER_DVSN_DESCRIPT, \n\tdvsn_mgr_ref_rep AS REFERRING_ADJUSTER_DVSN_MGR, \n\tdept_descript_ref_rep AS REFERRING_ADJUSTER_DEPT_DESCRIPT, \n\tdept_name_ref_rep AS REFERRING_ADJUSTER_DEPT_NAME, \n\tdept_mgr_ref_rep AS REFERRING_ADJUSTER_DEPT_MGR, \n\thandling_office_code_ref_rep AS REFERRING_ADJUSTER_HANDLING_OFFICE_CODE, \n\thandling_office_descript_ref_rep AS REFERRING_ADJUSTER_HANDLING_OFFICE_DESCRIPT, \n\thandling_office_mgr_ref_rep AS REFERRING_ADJUSTER_HANDLING_OFFICE_MGR, \n\tclaim_rep_key_ref_rep AS REFERRING_ADJUSTER_KEY, \n\tclaim_rep_full_name_ref_rep AS REFERRING_ADJUSTER_FULL_NAME, \n\tclaim_rep_first_name_ref_rep AS REFERRING_ADJUSTER_FIRST_NAME, \n\tclaim_rep_last_name_ref_rep AS REFERRING_ADJUSTER_LAST_NAME, \n\tclaim_rep_mid_name_ref_rep AS REFERRING_ADJUSTER_MID_NAME, \n\tclaim_rep_name_prfx_ref_rep AS REFERRING_ADJUSTER_NAME_PRFX, \n\tclaim_rep_name_sfx_ref_rep AS REFERRING_ADJUSTER_NAME_SFX, \n\tclaim_rep_wbconnect_user_id_ref_rep AS REFERRING_ADJUSTER_WBCONNECT_USER_ID\n\tFROM RTRTRANS_Insert\n),\nUPD_existing_records AS (\n\tSELECT\n\tclaim_subrogation_dim_id AS claim_subrogation_dim_id2, \n\tclaim_rep_subrogation_id_subro_rep AS claim_rep_subrogation_id_subro_rep2, \n\tclaim_rep_subrogation_ak_id_subro_rep AS claim_rep_subrogation_ak_id_subro_rep2, \n\tclaim_rep_ak_id_subro_rep AS claim_rep_ak_id_subro_rep2, \n\tclaim_rep_role_code_subro_rep AS claim_rep_role_code_subro_rep2, \n\tclaim_rep_subrogation_id_ref AS claim_rep_subrogation_id_ref2, \n\tclaim_rep_subrogation_ak_id_ref AS claim_rep_subrogation_ak_id_ref2, \n\tclaim_rep_ak_id_ref AS claim_rep_ak_id_ref2, \n\tclaim_rep_role_code_ref AS claim_rep_role_code_ref2, \n\tclaim_subrogation_ak_id AS claim_subrogation_ak_id2, \n\tclaim_subrogation_id AS claim_subrogation_id2, \n\tclaimant_cov_det_ak_id AS claimant_cov_det_ak_id2, \n\tinsd_ded_amt AS insd_ded_amt2, \n\treferred_to_subrogation_date AS referred_to_subrogation_date2, \n\tsubrogation_comment AS subrogation_comment2, \n\tinstallment_reached_ind AS installment_reached_ind2, \n\tagreement_amt AS agreement_amt2, \n\tmonthly_installment_amt AS monthly_installment_amt2, \n\tpay_start_date AS pay_start_date2, \n\tfile_status_code AS file_status_code2, \n\tded_status_code AS ded_status_code2, \n\tclosure_date AS closure_date2, \n\teff_from_date AS eff_from_date2, \n\teff_to_date AS eff_to_date2, \n\tcreated_modified_Date AS created_modified_Date2, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag2, \n\taudit_id AS audit_id2, \n\tded_status_code_descript AS ded_status_code_descript2, \n\tfile_status_code_descript AS file_status_code_descript2, \n\tclaim_rep_key_subro_rep AS claim_rep_key_subro_rep2, \n\tclaim_rep_full_name_subro_rep AS claim_rep_full_name_subro_rep2, \n\tclaim_rep_first_name_subro_rep AS claim_rep_first_name_subro_rep2, \n\tclaim_rep_last_name_subro_rep AS claim_rep_last_name_subro_rep2, \n\tclaim_rep_mid_name_subro_rep AS claim_rep_mid_name_subro_rep2, \n\tclaim_rep_name_prfx_subro_rep AS claim_rep_name_prfx_subro_rep2, \n\tclaim_rep_name_sfx_subro_rep AS claim_rep_name_sfx_subro_rep2, \n\tco_descript_subro_rep AS co_descript_subro_rep2, \n\tdvsn_code_subro_rep AS dvsn_code_subro_rep2, \n\tdvsn_descript_subro_rep AS dvsn_descript_subro_rep2, \n\tdvsn_mgr_subro_rep AS dvsn_mgr_subro_rep2, \n\tdept_descript_subro_rep AS dept_descript_subro_rep2, \n\tdept_name_subro_rep AS dept_name_subro_rep2, \n\tdept_mgr_subro_rep AS dept_mgr_subro_rep2, \n\thandling_office_code_subro_rep AS handling_office_code_subro_rep2, \n\thandling_office_descript_subro_rep AS handling_office_descript_subro_rep2, \n\thandling_office_mgr_subro_rep AS handling_office_mgr_subro_rep2, \n\tclaim_rep_wbconnect_user_id_subro_rep AS claim_rep_wbconnect_user_id_subro_rep2, \n\tclaim_rep_key_ref_rep AS claim_rep_key_ref_rep2, \n\tclaim_rep_full_name_ref_rep AS claim_rep_full_name_ref_rep2, \n\tclaim_rep_first_name_ref_rep AS claim_rep_first_name_ref_rep2, \n\tclaim_rep_last_name_ref_rep AS claim_rep_last_name_ref_rep2, \n\tclaim_rep_mid_name_ref_rep AS claim_rep_mid_name_ref_rep2, \n\tclaim_rep_name_prfx_ref_rep AS claim_rep_name_prfx_ref_rep2, \n\tclaim_rep_name_sfx_ref_rep AS claim_rep_name_sfx_ref_rep2, \n\tco_descript_ref_rep AS co_descript_ref_rep2, \n\tdvsn_code_ref_rep AS dvsn_code_ref_rep2, \n\tdvsn_descript_ref_rep AS dvsn_descript_ref_rep2, \n\tdvsn_mgr_ref_rep AS dvsn_mgr_ref_rep2, \n\tdept_descript_ref_rep AS dept_descript_ref_rep2, \n\tdept_name_ref_rep AS dept_name_ref_rep2, \n\tdept_mgr_ref_rep AS dept_mgr_ref_rep2, \n\thandling_office_code_ref_rep AS handling_office_code_ref_rep2, \n\thandling_office_descript_ref_rep AS handling_office_descript_ref_rep2, \n\thandling_office_mgr_ref_rep AS handling_office_mgr_ref_rep2, \n\tclaim_rep_wbconnect_user_id_ref_rep AS claim_rep_wbconnect_user_id_ref_rep2\n\tFROM RTRTRANS_DEFAULT1\n),\nclaim_subrogation_dim_update AS (\n\tMERGE INTO claim_subrogation_dim AS T\n\tUSING UPD_existing_records AS S\n\tON T.claim_subrogation_dim_id = S.claim_subrogation_dim_id2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag2, T.audit_id = S.audit_id2, T.eff_from_date = S.eff_from_date2, T.eff_to_date = S.eff_to_date2, T.modified_date = S.created_modified_Date2, T.edw_claim_subrogation_pk_id = S.claim_subrogation_id2, T.edw_claim_rep_subrogation_pk_id_subrogation_rep = S.claim_rep_subrogation_id_subro_rep2, T.edw_claim_rep_subrogation_pk_id_referring_adjuster = S.claim_rep_subrogation_id_ref2, T.edw_claim_subrogation_ak_id = S.claim_subrogation_ak_id2, T.edw_claimant_cov_det_ak_id = S.claimant_cov_det_ak_id2, T.edw_claim_rep_subrogation_ak_id_subrogation_rep = S.claim_rep_subrogation_ak_id_subro_rep2, T.edw_claim_rep_subrogation_ak_id_referring_adjuster = S.claim_rep_subrogation_ak_id_ref2, T.insd_ded_amt = S.insd_ded_amt2, T.referred_to_subrogation_date = S.referred_to_subrogation_date2, T.subrogation_comment = S.subrogation_comment2, T.installment_reached_ind = S.installment_reached_ind2, T.agreement_amt = S.agreement_amt2, T.monthly_installment_amt = S.monthly_installment_amt2, T.pay_start_date = S.pay_start_date2, T.file_status_code = S.file_status_code2, T.file_status_code_descript = S.file_status_code_descript2, T.ded_status_code = S.ded_status_code2, T.ded_status_code_descript = S.ded_status_code_descript2, T.closure_date = S.closure_date2, T.subrogation_rep_co_descript = S.co_descript_subro_rep2, T.subrogation_rep_dvsn_code = S.dvsn_code_subro_rep2, T.subrogation_rep_dvsn_descript = S.dvsn_descript_subro_rep2, T.subrogation_rep_dvsn_mgr = S.dvsn_mgr_subro_rep2, T.subrogation_rep_dept_descript = S.dept_descript_subro_rep2, T.subrogation_rep_dept_name = S.dept_name_subro_rep2, T.subrogation_rep_dept_mgr = S.dept_mgr_subro_rep2, T.subrogation_rep_handling_office_code = S.handling_office_code_subro_rep2, T.subrogation_rep_handling_office_descript = S.handling_office_descript_subro_rep2, T.subrogation_rep_handling_office_mgr = S.handling_office_mgr_subro_rep2, T.subrogation_rep_key = S.claim_rep_key_subro_rep2, T.subrogation_rep_full_name = S.claim_rep_full_name_subro_rep2, T.subrogation_rep_first_name = S.claim_rep_first_name_subro_rep2, T.subrogation_rep_last_name = S.claim_rep_last_name_subro_rep2, T.subrogation_rep_mid_name = S.claim_rep_mid_name_subro_rep2, T.subrogation_rep_name_prfx = S.claim_rep_name_prfx_subro_rep2, T.subrogation_rep_name_sfx = S.claim_rep_name_sfx_subro_rep2, T.subrogation_rep_wbconnect_user_id = S.claim_rep_wbconnect_user_id_subro_rep2, T.referring_adjuster_co_descript = S.co_descript_ref_rep2, T.referring_adjuster_dvsn_code = S.dvsn_code_ref_rep2, T.referring_adjuster_dvsn_descript = S.dvsn_descript_ref_rep2, T.referring_adjuster_dvsn_mgr = S.dvsn_mgr_ref_rep2, T.referring_adjuster_dept_descript = S.dept_descript_ref_rep2, T.referring_adjuster_dept_name = S.dept_name_ref_rep2, T.referring_adjuster_dept_mgr = S.dept_mgr_ref_rep2, T.referring_adjuster_handling_office_code = S.handling_office_code_ref_rep2, T.referring_adjuster_handling_office_descript = S.handling_office_descript_ref_rep2, T.referring_adjuster_handling_office_mgr = S.handling_office_mgr_ref_rep2, T.referring_adjuster_key = S.claim_rep_key_ref_rep2, T.referring_adjuster_full_name = S.claim_rep_full_name_ref_rep2, T.referring_adjuster_first_name = S.claim_rep_first_name_ref_rep2, T.referring_adjuster_last_name = S.claim_rep_last_name_ref_rep2, T.referring_adjuster_mid_name = S.claim_rep_mid_name_ref_rep2, T.referring_adjuster_name_prfx = S.claim_rep_name_prfx_ref_rep2, T.referring_adjuster_name_sfx = S.claim_rep_name_sfx_ref_rep2, T.referring_adjuster_wbconnect_user_id = S.claim_rep_wbconnect_user_id_ref_rep2\n),\nSQ_claim_subrogation_dim AS (\n\tSELECT a.claim_subrogation_dim_id, \r\n\ta.eff_from_date, \r\n\ta.eff_to_date, \r\n\ta.edw_claim_subrogation_ak_id \r\n\tFROM\r\n\t  @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_subrogation_dim a\r\n\tWHERE EXISTS\r\n\t(SELECT 1 FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_subrogation_dim b\r\n\tWHERE b.crrnt_snpsht_flag = 1 AND\r\n\ta.edw_claim_subrogation_ak_id = b.edw_claim_subrogation_ak_id\r\n\tGROUP BY b.edw_claim_subrogation_ak_id HAVING count(*) > 1)\r\n\tORDER BY a.edw_claim_subrogation_ak_id, a.eff_from_date DESC\n),\nEXP_Source AS (\n\tSELECT\n\tclaim_subrogation_dim_id,\n\tedw_claim_subrogation_ak_id,\n\teff_from_date,\n\teff_to_date AS orig_eff_to_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tedw_claim_subrogation_ak_id=v_PREV_ROW_edw_claim_subrogation_ak_id , \tADD_TO_DATE(v_PREV_ROW_eff_from_date,'SS',-1)\r\n\t--        ,orig_eff_to_date)\n\tDECODE(TRUE,\n\tedw_claim_subrogation_ak_id = v_PREV_ROW_edw_claim_subrogation_ak_id, ADD_TO_DATE(v_PREV_ROW_eff_from_date, 'SS', - 1),\n\torig_eff_to_date) AS v_eff_to_date,\n\tv_eff_to_date AS o_eff_to_date,\n\teff_from_date AS v_PREV_ROW_eff_from_date,\n\tedw_claim_subrogation_ak_id AS v_PREV_ROW_edw_claim_subrogation_ak_id,\n\tsysdate AS modified_date,\n\t0 AS crrnt_snpsht_flag\n\tFROM SQ_claim_subrogation_dim\n),\nFLT_Source_Rows AS (\n\tSELECT\n\tclaim_subrogation_dim_id, \n\torig_eff_to_date, \n\to_eff_to_date AS eff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM EXP_Source\n\tWHERE orig_eff_to_date <> eff_to_date\n),\nUpd_Update_Eff_Dates AS (\n\tSELECT\n\tclaim_subrogation_dim_id, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM FLT_Source_Rows\n),\nclaim_subrogation_dim_expire_rows AS (\n\tMERGE INTO claim_subrogation_dim AS T\n\tUSING Upd_Update_Eff_Dates AS S\n\tON T.claim_subrogation_dim_id = S.claim_subrogation_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.eff_to_date = S.eff_to_date, T.modified_date = S.modified_date\n),"
                        }
                    ]
                }
            }
        ],
        "parameters": {
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}