{
    "name": "s_m_FEED_Load_AAIS_Extract_File",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_AAIS_Extract_File",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkAAISExtract AS (\n\tSELECT\n\t\tWorkAAISExtractId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tEDWPremiumMasterCalculationPKId,\n\t\tEDWLossMasterCalculationPKId,\n\t\tTypeBureauCode,\n\t\tBureauLineOfInsurance,\n\t\tPremiumMasterRunDate,\n\t\tLossMasterRunDate,\n\t\tBureauCompanyNumber,\n\t\tPolicyKey,\n\t\tStateProvinceCode,\n\t\tRatingCounty,\n\t\tPremiumMasterDirectWrittenPremiumAmount,\n\t\tPaidLossAmount,\n\t\tOutstandingLossAmount,\n\t\tLossMasterNewClaimCount,\n\t\tPremiumMasterClassCode,\n\t\tLossMasterClassCode,\n\t\tDeductibleAmount,\n\t\tBureauAnnualStatementLineCode,\n\t\tBureauOrganizationCode,\n\t\tTerrorismRiskIndicator,\n\t\tInlandMarinePropertyAmountOfInsurance,\n\t\tConstructionCode,\n\t\tISOFireProtectionCode,\n\t\tInsuranceSegmentDescription,\n\t\tPolicyOfferingDescription,\n\t\tPolicyTerm,\n\t\tCauseOfLossName,\n\t\tClaimLossDate,\n\t\tZipPostalCode,\n\t\tCoverageEffectiveDate,\n\t\tCoverageExpirationDate,\n\t\tInceptionToDatePaidLossAmount,\n\t\tClaimantCoverageDetailId,\n\t\tClaimNumber,\n\t\tAnnualStatementLineNumber\n\tFROM WorkAAISExtract\n\tWHERE @{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Cleansing AS (\n\tSELECT\n\tWorkAAISExtractId AS i_WorkAAISExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tPolicyKey AS i_PolicyKey,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tRatingCounty AS i_RatingCounty,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tLossMasterNewClaimCount AS i_LossMasterNewClaimCount,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tDeductibleAmount AS i_DeductibleAmount,\n\tBureauAnnualStatementLineCode AS i_BureauAnnualStatementLineCode,\n\tBureauOrganizationCode AS i_BureauOrganizationCode,\n\tTerrorismRiskIndicator AS i_TerrorismRiskIndicator,\n\tInlandMarinePropertyAmountOfInsurance AS i_InlandMarinePropertyAmountOfInsurance,\n\tConstructionCode AS i_ConstructionCode,\n\tISOFireProtectionCode AS i_ISOFireProtectionCode,\n\tInsuranceSegmentDescription AS i_InsuranceSegmentDescription,\n\tPolicyOfferingDescription AS i_PolicyOfferingDescription,\n\tPolicyTerm AS i_PolicyTerm,\n\tCauseOfLossName AS i_CauseOfLossName,\n\tClaimLossDate AS i_ClaimLossDate,\n\tZipPostalCode AS i_ZipPostalCode,\n\tCoverageEffectiveDate AS i_CoverageEffectiveDate,\n\tCoverageExpirationDate AS i_CoverageExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tClaimNumber AS i_ClaimNumber,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\ti_WorkAAISExtractId AS o_WorkAAISExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: RTRIM(LTRIM(i_TypeBureauCode))\n\tRTRIM(LTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauLineOfInsurance))\n\tRTRIM(LTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: RTRIM(LTRIM(i_BureauCompanyNumber))\n\tRTRIM(LTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyKey))\n\tRTRIM(LTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: RTRIM(LTRIM(i_StateProvinceCode))\n\tRTRIM(LTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\t-- *INF*: RTRIM(LTRIM(i_RatingCounty))\n\tRTRIM(LTRIM(i_RatingCounty)) AS o_RatingCounty,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_LossMasterNewClaimCount AS o_LossMasterNewClaimCount,\n\t-- *INF*: RTRIM(LTRIM(i_PremiumMasterClassCode))\n\tRTRIM(LTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossMasterClassCode))\n\tRTRIM(LTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_DeductibleAmount))\n\tRTRIM(LTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: RTRIM(LTRIM(i_BureauAnnualStatementLineCode))\n\tRTRIM(LTRIM(i_BureauAnnualStatementLineCode)) AS o_BureauAnnualStatementLineCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauOrganizationCode))\n\tRTRIM(LTRIM(i_BureauOrganizationCode)) AS o_BureauOrganizationCode,\n\t-- *INF*: RTRIM(LTRIM(i_TerrorismRiskIndicator))\n\tRTRIM(LTRIM(i_TerrorismRiskIndicator)) AS o_TerrorismRiskIndicator,\n\t-- *INF*: RTRIM(LTRIM(i_InlandMarinePropertyAmountOfInsurance))\n\tRTRIM(LTRIM(i_InlandMarinePropertyAmountOfInsurance)) AS o_InlandMarinePropertyAmountOfInsurance,\n\t-- *INF*: RTRIM(LTRIM(i_ConstructionCode))\n\tRTRIM(LTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: RTRIM(LTRIM(i_ISOFireProtectionCode))\n\tRTRIM(LTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: RTRIM(LTRIM(i_InsuranceSegmentDescription))\n\tRTRIM(LTRIM(i_InsuranceSegmentDescription)) AS o_InsuranceSegmentDescription,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyOfferingDescription))\n\tRTRIM(LTRIM(i_PolicyOfferingDescription)) AS o_PolicyOfferingDescription,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyTerm))\n\tRTRIM(LTRIM(i_PolicyTerm)) AS o_PolicyTerm,\n\t-- *INF*: RTRIM(LTRIM(i_CauseOfLossName))\n\tRTRIM(LTRIM(i_CauseOfLossName)) AS o_CauseOfLossName,\n\ti_ClaimLossDate AS o_ClaimLossDate,\n\t-- *INF*: RTRIM(LTRIM(i_ZipPostalCode))\n\tRTRIM(LTRIM(i_ZipPostalCode)) AS o_ZipPostalCode,\n\ti_CoverageEffectiveDate AS o_CoverageEffectiveDate,\n\ti_CoverageExpirationDate AS o_CoverageExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailId,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimNumber))\n\tRTRIM(LTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: IIF(ISNULL(i_AnnualStatementLineNumber),'N/A',RTRIM(LTRIM(i_AnnualStatementLineNumber)))\n\tIFF(i_AnnualStatementLineNumber IS NULL, 'N/A', RTRIM(LTRIM(i_AnnualStatementLineNumber))) AS o_AnnualStatementLineNumber\n\tFROM SQ_WorkAAISExtract\n),\nEXP_Append_Filename AS (\n\tSELECT\n\t-- *INF*: TO_CHAR(TRUNC(sysdate,'DD'),'YYYYMMDD')\n\tTO_CHAR(CAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)), 'YYYYMMDD') AS v_RunDate,\n\t'InlandMarine_' || v_RunDate || '.CSV' AS FileName,\n\to_WorkAAISExtractId AS WorkAAISExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_PolicyKey AS PolicyKey,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_RatingCounty AS RatingCounty,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_LossMasterNewClaimCount AS LossMasterNewClaimCount,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_BureauAnnualStatementLineCode AS BureauAnnualStatementLineCode,\n\to_BureauOrganizationCode AS BureauOrganizationCode,\n\to_TerrorismRiskIndicator AS TerrorismRiskIndicator,\n\to_InlandMarinePropertyAmountOfInsurance AS InlandMarinePropertyAmountOfInsurance,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_InsuranceSegmentDescription AS InsuranceSegmentDescription,\n\to_PolicyOfferingDescription AS PolicyOfferingDescription,\n\to_PolicyTerm AS PolicyTerm,\n\to_CauseOfLossName AS CauseOfLossName,\n\to_ClaimLossDate AS ClaimLossDate,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_CoverageEffectiveDate AS CoverageEffectiveDate,\n\to_CoverageExpirationDate AS CoverageExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailId AS ClaimantCoverageDetailId,\n\to_ClaimNumber AS ClaimNumber,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber\n\tFROM EXP_Cleansing\n),\nSRT_AAIS_Flatfile AS (\n\tSELECT\n\tFileName, \n\tWorkAAISExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tBureauCompanyNumber, \n\tPolicyKey, \n\tStateProvinceCode, \n\tRatingCounty, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tLossMasterNewClaimCount, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tDeductibleAmount, \n\tBureauAnnualStatementLineCode, \n\tBureauOrganizationCode, \n\tTerrorismRiskIndicator, \n\tInlandMarinePropertyAmountOfInsurance, \n\tConstructionCode, \n\tISOFireProtectionCode, \n\tInsuranceSegmentDescription, \n\tPolicyOfferingDescription, \n\tPolicyTerm, \n\tCauseOfLossName, \n\tClaimLossDate, \n\tCoverageEffectiveDate, \n\tCoverageExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailId, \n\tClaimNumber, \n\tAnnualStatementLineNumber, \n\tZipPostalCode\n\tFROM EXP_Append_Filename\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nAAISFlatFile AS (\n\tINSERT INTO AAISFlatFile\n\t(FileName, WorkAAISExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyNumber, PolicyKey, StateProvinceCode, RatingCounty, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, LossMasterNewClaimCount, PremiumMasterClassCode, LossMasterClassCode, DeductibleAmount, BureauAnnualStatementLineCode, BureauOrganizationCode, TerrorismRiskIndicator, InlandMarinePropertyAmountOfInsurance, ConstructionCode, ISOFireProtectionCode, InsuranceSegmentDescription, PolicyOfferingDescription, PolicyTerm, CauseOfLossName, ClaimLossDate, ZipPostalCode, CoverageEffectiveDate, CoverageExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, ClaimNumber, AnnualStatementLineNumber)\n\tSELECT \n\tFILENAME, \n\tWORKAAISEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tBUREAUCOMPANYNUMBER, \n\tPOLICYKEY, \n\tSTATEPROVINCECODE, \n\tRATINGCOUNTY, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tLOSSMASTERNEWCLAIMCOUNT, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tDEDUCTIBLEAMOUNT, \n\tBUREAUANNUALSTATEMENTLINECODE, \n\tBUREAUORGANIZATIONCODE, \n\tTERRORISMRISKINDICATOR, \n\tINLANDMARINEPROPERTYAMOUNTOFINSURANCE, \n\tCONSTRUCTIONCODE, \n\tISOFIREPROTECTIONCODE, \n\tINSURANCESEGMENTDESCRIPTION, \n\tPOLICYOFFERINGDESCRIPTION, \n\tPOLICYTERM, \n\tCAUSEOFLOSSNAME, \n\tCLAIMLOSSDATE, \n\tZIPPOSTALCODE, \n\tCOVERAGEEFFECTIVEDATE, \n\tCOVERAGEEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tCLAIMNUMBER, \n\tANNUALSTATEMENTLINENUMBER\n\tFROM SRT_AAIS_Flatfile\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}