{
    "name": "s_m_CLM_STG_Update_PIF_42X6",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_STG_Update_PIF_42X6",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_42X6_STAGE AS (\n\tSELECT\n\tpif_42x6_stage_id,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tipfcx6_year_of_loss,\n\tipfcx6_month_of_loss,\n\tipfcx6_day_of_loss,\n\tipfcx6_loss_occ_fdigit,\n\tipfcx6_usr_loss_occurence,\n\tipfcx6_loss_claimant,\n\tipfcx6_insurance_line,\n\tipfcx6_location_number,\n\tipfcx6_sub_location_number,\n\tipfcx6_risk_unit_group,\n\tipfcx6_class_code_group,\n\tipfcx6_class_code_member,\n\tipfcx6_loss_unit,\n\tipfcx6_risk_sequence,\n\tipfcx6_major_peril,\n\tipfcx6_sequence_type_exposure,\n\tipfcx6_loss_disability,\n\tipfcx6_member,\n\tipfcx6_reserve_category,\n\tipfcx6_loss_cause\n\tFROM (\n\t\tSELECT pif_42x6_stage.pif_42x6_stage_id as pif_42x6_stage_id, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(pif_symbol,' ')))) WHEN 0 THEN 'N/A' ELSE LTRIM(RTRIM(pif_symbol)) END AS pif_symbol, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(pif_policy_number,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(pif_policy_number)) END AS pif_policy_number, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(pif_module, ' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(pif_module)) END AS pif_module, \r\n\t\tCASE LEN(COALESCE(ipfcx6_year_of_loss, '1800')) WHEN 0 THEN '1800' ELSE COALESCE(ipfcx6_year_of_loss, '1800') END AS ipfcx6_year_of_loss,\r\n\t\tCASE LEN(COALESCE(ipfcx6_month_of_loss,'1')) WHEN 0 THEN '1' ELSE COALESCE(ipfcx6_month_of_loss,'1') END AS ipfcx6_month_of_loss,\r\n\t\tCASE LEN(COALESCE(ipfcx6_day_of_loss, '1')) WHEN 0 THEN '1' ELSE COALESCE(ipfcx6_day_of_loss,'1') END AS ipfcx6_day_of_loss,\r\n\t\tCASE LEN(COALESCE(ipfcx6_loss_occ_fdigit,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_loss_occ_fdigit,'0') END AS ipfcx6_loss_occ_fdigit,\r\n\t\tCASE LEN(COALESCE(ipfcx6_usr_loss_occurence,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_usr_loss_occurence,'0') END AS ipfcx6_usr_loss_occurence,\r\n\t\tCASE LEN(COALESCE(ipfcx6_loss_claimant,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_loss_claimant,'0') END AS ipfcx6_loss_claimant,\r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_insurance_line,' ')))) WHEN 0 THEN 'N/A' ELSE LTRIM(RTRIM(ipfcx6_insurance_line)) END AS ipfcx6_insurance_line, \r\n\t\tCASE LEN(COALESCE(ipfcx6_location_number,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_location_number,'0') END AS ipfcx6_location_number,\r\n\t\tCASE LEN(COALESCE(ipfcx6_sub_location_number,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_sub_location_number,'0') END AS ipfcx6_sub_location_number,\r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_risk_unit_group,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_risk_unit_group)) END AS ipfcx6_risk_unit_group, \r\n\t\tCASE LEN(COALESCE(ipfcx6_class_code_group,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_class_code_group,'0') END AS ipfcx6_class_code_group,\r\n\t\tCASE LEN(COALESCE(ipfcx6_class_code_member,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_class_code_member,'0') END AS ipfcx6_class_code_member, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_unit,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_loss_unit)) END AS ipfcx6_loss_unit, \r\n\t\tCASE LEN(COALESCE(ipfcx6_risk_sequence,'0')) WHEN 0 THEN '0' ELSE COALESCE(ipfcx6_risk_sequence,'0') END AS ipfcx6_risk_sequence, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_major_peril,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_major_peril)) END AS ipfcx6_major_peril, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_sequence_type_exposure, ' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_sequence_type_exposure)) END AS ipfcx6_sequence_type_exposure, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_disability,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_loss_disability)) END AS ipfcx6_loss_disability, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_member,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_member)) END AS ipfcx6_member, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_reserve_category,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM( ipfcx6_reserve_category)) END AS ipfcx6_reserve_category, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_cause,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM( ipfcx6_loss_cause)) END AS ipfcx6_loss_cause, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_offset_onset_ind,' ')))) WHEN 0 THEN '0' ELSE LTRIM(RTRIM(ipfcx6_offset_onset_ind)) END AS ipfcx6_offset_onset_ind\r\n\t\tFROM pif_42x6_stage\r\n\t\tWHERE     (ipfcx6_year_process >= 1998)\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module,ipfcx6_year_of_loss,ipfcx6_month_of_loss,ipfcx6_day_of_loss,ipfcx6_loss_occ_fdigit,ipfcx6_usr_loss_occurence,ipfcx6_loss_claimant,ipfcx6_insurance_line,ipfcx6_location_number,ipfcx6_sub_location_number,ipfcx6_risk_unit_group,ipfcx6_class_code_group,ipfcx6_class_code_member,ipfcx6_loss_unit,ipfcx6_risk_sequence,ipfcx6_major_peril,ipfcx6_sequence_type_exposure,ipfcx6_loss_disability,ipfcx6_member,ipfcx6_reserve_category,ipfcx6_loss_cause ORDER BY pif_42x6_stage_id) = 1\n),\nSQ_CLM_STG_Update_42GP AS (\n\tSELECT pif_4578_stage.pif_symbol, pif_4578_stage.pif_policy_number, pif_4578_stage.pif_module, pif_4578_stage.loss_insurance_line, pif_4578_stage.loss_location_number, pif_4578_stage.loss_sub_location_number, pif_4578_stage.loss_risk_unit_group, pif_4578_stage.loss_class_code_group, pif_4578_stage.loss_class_code_member, pif_4578_stage.loss_unit, pif_4578_stage.loss_sequence_risk_unit, pif_4578_stage.loss_major_peril, pif_4578_stage.loss_major_peril_seq, pif_4578_stage.loss_year, pif_4578_stage.loss_month, pif_4578_stage.loss_day, pif_4578_stage.loss_occurence, pif_4578_stage.loss_claimant, pif_4578_stage.loss_member, pif_4578_stage.loss_disability, pif_4578_stage.loss_reserve_category, pif_4578_stage.loss_cause, pif_4578_stage.loss_offset_onset_ind, MAX(pif_4578_stage.logical_flag) , pif_4578_stage.source_system_id \r\n\tFROM\r\n\t pif_4578_stage\r\n\tgroup by\r\n\tpif_4578_stage.pif_symbol, pif_4578_stage.pif_policy_number, pif_4578_stage.pif_module, pif_4578_stage.loss_insurance_line, pif_4578_stage.loss_location_number, pif_4578_stage.loss_sub_location_number, pif_4578_stage.loss_risk_unit_group, pif_4578_stage.loss_class_code_group, pif_4578_stage.loss_class_code_member, pif_4578_stage.loss_unit, pif_4578_stage.loss_sequence_risk_unit, pif_4578_stage.loss_major_peril, pif_4578_stage.loss_major_peril_seq, pif_4578_stage.loss_year, pif_4578_stage.loss_month, pif_4578_stage.loss_day, pif_4578_stage.loss_occurence, pif_4578_stage.loss_claimant, pif_4578_stage.loss_member, pif_4578_stage.loss_disability, pif_4578_stage.loss_reserve_category, pif_4578_stage.loss_cause, pif_4578_stage.loss_offset_onset_ind, pif_4578_stage.source_system_id\n),\nEXP_CLM_STG_Update_42GP AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tloss_insurance_line,\n\t-- *INF*: IIF(ISNULL(loss_insurance_line) OR IS_SPACES(loss_insurance_line),'N/A',LTRIM(RTRIM(loss_insurance_line)))\n\tIFF(\n\t    loss_insurance_line IS NULL OR LENGTH(loss_insurance_line)>0 AND TRIM(loss_insurance_line)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(loss_insurance_line))\n\t) AS V_loss_insurance_line,\n\tV_loss_insurance_line AS out_loss_insurance_line,\n\tloss_location_number,\n\t-- *INF*: IIF(ISNULL(loss_location_number),0,loss_location_number)\n\tIFF(loss_location_number IS NULL, 0, loss_location_number) AS V_loss_location_number,\n\tV_loss_location_number AS out_loss_location_number,\n\tloss_sub_location_number,\n\t-- *INF*: IIF(ISNULL(loss_sub_location_number),0,loss_sub_location_number)\n\tIFF(loss_sub_location_number IS NULL, 0, loss_sub_location_number) AS V_loss_sub_location_number,\n\tV_loss_sub_location_number AS out_loss_sub_location_number,\n\tloss_risk_unit_group,\n\t-- *INF*: IIF(ISNULL(loss_risk_unit_group) OR IS_SPACES(loss_risk_unit_group),'0',LTRIM(RTRIM(loss_risk_unit_group)))\n\tIFF(\n\t    loss_risk_unit_group IS NULL\n\t    or LENGTH(loss_risk_unit_group)>0\n\t    and TRIM(loss_risk_unit_group)='',\n\t    '0',\n\t    LTRIM(RTRIM(loss_risk_unit_group))\n\t) AS V_loss_risk_unit_group,\n\tV_loss_risk_unit_group AS out_loss_risk_unit_group,\n\tloss_class_code_group,\n\t-- *INF*: IIF(ISNULL(loss_class_code_group),0,loss_class_code_group)\n\tIFF(loss_class_code_group IS NULL, 0, loss_class_code_group) AS V_loss_class_code_group,\n\tV_loss_class_code_group AS out_loss_class_code_group,\n\tloss_class_code_member,\n\t-- *INF*: IIF(ISNULL(loss_class_code_member),0,loss_class_code_member)\n\tIFF(loss_class_code_member IS NULL, 0, loss_class_code_member) AS V_loss_class_code_member,\n\tV_loss_class_code_member AS out_loss_class_code_member,\n\tloss_unit,\n\t-- *INF*: IIF(ISNULL(loss_unit) OR IS_SPACES(loss_unit),'0',LTRIM(RTRIM(loss_unit)))\n\tIFF(\n\t    loss_unit IS NULL OR LENGTH(loss_unit)>0 AND TRIM(loss_unit)='', '0',\n\t    LTRIM(RTRIM(loss_unit))\n\t) AS V_loss_unit,\n\tV_loss_unit AS out_loss_unit,\n\tloss_sequence_risk_unit,\n\t-- *INF*: IIF(ISNULL(loss_sequence_risk_unit) OR IS_SPACES(loss_sequence_risk_unit),'0',LTRIM(RTRIM(loss_sequence_risk_unit)))\n\tIFF(\n\t    loss_sequence_risk_unit IS NULL\n\t    or LENGTH(loss_sequence_risk_unit)>0\n\t    and TRIM(loss_sequence_risk_unit)='',\n\t    '0',\n\t    LTRIM(RTRIM(loss_sequence_risk_unit))\n\t) AS V_loss_sequence_risk_unit,\n\tV_loss_sequence_risk_unit AS out_loss_sequence_risk_unit,\n\tloss_major_peril,\n\t-- *INF*: IIF(ISNULL(loss_major_peril) OR IS_SPACES(loss_major_peril),'0',LTRIM(RTRIM(loss_major_peril)))\n\tIFF(\n\t    loss_major_peril IS NULL OR LENGTH(loss_major_peril)>0 AND TRIM(loss_major_peril)='', '0',\n\t    LTRIM(RTRIM(loss_major_peril))\n\t) AS V_loss_major_peril,\n\tV_loss_major_peril AS out_loss_major_peril,\n\tloss_major_peril_seq,\n\t-- *INF*: IIF(ISNULL(loss_major_peril_seq) OR IS_SPACES(loss_major_peril_seq),'0',LTRIM(RTRIM(loss_major_peril_seq)))\n\tIFF(\n\t    loss_major_peril_seq IS NULL\n\t    or LENGTH(loss_major_peril_seq)>0\n\t    and TRIM(loss_major_peril_seq)='',\n\t    '0',\n\t    LTRIM(RTRIM(loss_major_peril_seq))\n\t) AS V_loss_major_peril_seq,\n\tV_loss_major_peril_seq AS out_loss_major_peril_seq,\n\tloss_year,\n\t-- *INF*: IIF(ISNULL(loss_year),1800,loss_year)\n\tIFF(loss_year IS NULL, 1800, loss_year) AS V_loss_year,\n\tV_loss_year AS out_loss_year,\n\tloss_month,\n\t-- *INF*: IIF(ISNULL(loss_month),1,loss_month)\n\tIFF(loss_month IS NULL, 1, loss_month) AS V_loss_month,\n\tV_loss_month AS out_loss_month,\n\tloss_day,\n\t-- *INF*: IIF(ISNULL(loss_day),1,loss_day)\n\tIFF(loss_day IS NULL, 1, loss_day) AS V_loss_day,\n\tV_loss_day AS out_loss_day,\n\tloss_occurence,\n\t-- *INF*: IIF(LENGTH(loss_occurence)<=2,'0',SUBSTR(loss_occurence,1,1))\n\tIFF(LENGTH(loss_occurence) <= 2, '0', SUBSTR(loss_occurence, 1, 1)) AS ipfcx6_loss_occ_fdigit,\n\tipfcx6_loss_occ_fdigit AS out_ipfcx6_loss_occ_fdigit,\n\t-- *INF*: IIF(LENGTH(loss_occurence)>2,SUBSTR(loss_occurence,2,2),TO_CHAR(loss_occurence))\n\tIFF(LENGTH(loss_occurence) > 2, SUBSTR(loss_occurence, 2, 2), TO_CHAR(loss_occurence)) AS ipfcx6_usr_loss_occurence,\n\tipfcx6_usr_loss_occurence AS out_ipfcx6_usr_loss_occurence,\n\tloss_claimant,\n\t-- *INF*: IIF(ISNULL(loss_claimant),'0',loss_claimant)\n\tIFF(loss_claimant IS NULL, '0', loss_claimant) AS V_loss_claimant,\n\tV_loss_claimant AS out_loss_claimant,\n\tloss_member,\n\t-- *INF*: IIF(ISNULL(loss_member) OR IS_SPACES(loss_member),'0',LTRIM(RTRIM(loss_member)))\n\tIFF(\n\t    loss_member IS NULL OR LENGTH(loss_member)>0 AND TRIM(loss_member)='', '0',\n\t    LTRIM(RTRIM(loss_member))\n\t) AS V_loss_member,\n\tV_loss_member AS out_loss_member,\n\tloss_disability,\n\t-- *INF*: IIF(ISNULL(loss_disability) OR IS_SPACES(loss_disability),'0',LTRIM(RTRIM(loss_disability)))\n\tIFF(\n\t    loss_disability IS NULL OR LENGTH(loss_disability)>0 AND TRIM(loss_disability)='', '0',\n\t    LTRIM(RTRIM(loss_disability))\n\t) AS V_loss_disability,\n\tV_loss_disability AS out_loss_disability,\n\tloss_reserve_category,\n\t-- *INF*: IIF(ISNULL(loss_reserve_category) OR IS_SPACES(loss_reserve_category),'0',LTRIM(RTRIM(loss_reserve_category)))\n\tIFF(\n\t    loss_reserve_category IS NULL\n\t    or LENGTH(loss_reserve_category)>0\n\t    and TRIM(loss_reserve_category)='',\n\t    '0',\n\t    LTRIM(RTRIM(loss_reserve_category))\n\t) AS V_loss_reserve_category,\n\tV_loss_reserve_category AS out_loss_reserve_category,\n\tloss_cause,\n\t-- *INF*: IIF(ISNULL(loss_cause) OR IS_SPACES(loss_cause),'0',LTRIM(RTRIM(loss_cause)))\n\tIFF(\n\t    loss_cause IS NULL OR LENGTH(loss_cause)>0 AND TRIM(loss_cause)='', '0',\n\t    LTRIM(RTRIM(loss_cause))\n\t) AS V_loss_cause,\n\tV_loss_cause AS out_loss_cause,\n\tloss_offset_onset_ind,\n\t-- *INF*: IIF(ISNULL(loss_offset_onset_ind) OR IS_SPACES(loss_offset_onset_ind),'0',LTRIM(RTRIM(loss_offset_onset_ind)))\n\tIFF(\n\t    loss_offset_onset_ind IS NULL\n\t    or LENGTH(loss_offset_onset_ind)>0\n\t    and TRIM(loss_offset_onset_ind)='',\n\t    '0',\n\t    LTRIM(RTRIM(loss_offset_onset_ind))\n\t) AS V_loss_offset_onset_ind,\n\t-- *INF*: :LKP.LKP_42X6_STAGE(pif_symbol, pif_policy_number, pif_module, V_loss_year, V_loss_month, V_loss_day, ipfcx6_loss_occ_fdigit, ipfcx6_usr_loss_occurence, V_loss_claimant, V_loss_insurance_line, V_loss_location_number, V_loss_sub_location_number, V_loss_risk_unit_group, V_loss_class_code_group, V_loss_class_code_member, V_loss_unit,  V_loss_sequence_risk_unit, V_loss_major_peril, V_loss_major_peril_seq, V_loss_disability, V_loss_member, V_loss_reserve_category, V_loss_cause)\n\tLKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.pif_42x6_stage_id AS v_pif_42x6_stage_id,\n\tv_pif_42x6_stage_id AS pif_42x6_stage_id,\n\tlogical_flag,\n\t-- *INF*: DECODE(logical_flag,\r\n\t-- '0','1',\r\n\t-- '-1','2',\r\n\t-- '-2','3',\r\n\t-- '-3','4')\n\tDECODE(\n\t    logical_flag,\n\t    '0', '1',\n\t    '-1', '2',\n\t    '-2', '3',\n\t    '-3', '4'\n\t) AS logical_flag_insert,\n\tsource_system_id\n\tFROM SQ_CLM_STG_Update_42GP\n\tLEFT JOIN LKP_42X6_STAGE LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause\n\tON LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.pif_symbol = pif_symbol\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.pif_policy_number = pif_policy_number\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.pif_module = pif_module\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_year_of_loss = V_loss_year\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_month_of_loss = V_loss_month\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_day_of_loss = V_loss_day\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_loss_occ_fdigit = ipfcx6_loss_occ_fdigit\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_usr_loss_occurence = ipfcx6_usr_loss_occurence\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_loss_claimant = V_loss_claimant\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_insurance_line = V_loss_insurance_line\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_location_number = V_loss_location_number\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_sub_location_number = V_loss_sub_location_number\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_risk_unit_group = V_loss_risk_unit_group\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_class_code_group = V_loss_class_code_group\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_class_code_member = V_loss_class_code_member\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_loss_unit = V_loss_unit\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_risk_sequence = V_loss_sequence_risk_unit\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_major_peril = V_loss_major_peril\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_sequence_type_exposure = V_loss_major_peril_seq\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_loss_disability = V_loss_disability\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_member = V_loss_member\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_reserve_category = V_loss_reserve_category\n\tAND LKP_42X6_STAGE_pif_symbol_pif_policy_number_pif_module_V_loss_year_V_loss_month_V_loss_day_ipfcx6_loss_occ_fdigit_ipfcx6_usr_loss_occurence_V_loss_claimant_V_loss_insurance_line_V_loss_location_number_V_loss_sub_location_number_V_loss_risk_unit_group_V_loss_class_code_group_V_loss_class_code_member_V_loss_unit_V_loss_sequence_risk_unit_V_loss_major_peril_V_loss_major_peril_seq_V_loss_disability_V_loss_member_V_loss_reserve_category_V_loss_cause.ipfcx6_loss_cause = V_loss_cause\n\n),\nLKP_arch_pif_42x6 AS (\n\tSELECT\n\tarch_pif_42x6_stage_id,\n\tpif_42x6_stage_id,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tipfcx6_rec_length,\n\tipfcx6_action_code,\n\tipfcx6_file_id,\n\tipfcx6_segment_id,\n\tipfcx6_segment_level_code,\n\tipfcx6_segment_part_code,\n\tipfcx6_sub_part_code,\n\tipfcx6_insurance_line,\n\tipfcx6_location_number,\n\tipfcx6_sub_location_number,\n\tipfcx6_risk_unit_group,\n\tipfcx6_class_code_group,\n\tipfcx6_class_code_member,\n\tipfcx6_loss_unit,\n\tipfcx6_risk_sequence,\n\tipfcx6_risk_type_ind,\n\tipfcx6_type_exposure,\n\tipfcx6_major_peril,\n\tipfcx6_sequence_type_exposure,\n\tipfcx6_year_item_effective,\n\tipfcx6_month_item_effective,\n\tipfcx6_day_item_effective,\n\tipfcx6_year_of_loss,\n\tipfcx6_month_of_loss,\n\tipfcx6_day_of_loss,\n\tipfcx6_loss_occ_fdigit,\n\tipfcx6_usr_loss_occurence,\n\tipfcx6_loss_claimant,\n\tipfcx6_member,\n\tipfcx6_loss_disability,\n\tipfcx6_reserve_category,\n\tipfcx6_layer,\n\tipfcx6_reins_key_id,\n\tipfcx6_reins_co_no,\n\tipfcx6_reins_broker,\n\tipfcx6_year_process,\n\tipfcx6_month_process,\n\tipfcx6_day_process,\n\tipfcx6_year_change_entry,\n\tipfcx6_month_change_entry,\n\tipfcx6_day_change_entry,\n\tipfcx6_sequence_change_entry,\n\tipfcx6_segment_status,\n\tipfcx6_entry_operator,\n\tipfcx6_claim_type,\n\tipfcx6_loss_reported_year,\n\tipfcx6_loss_reported_month,\n\tipfcx6_loss_reported_day,\n\tipfcx6_loss_cause,\n\tipfcx6_loss_adjustor_no,\n\tipfcx6_loss_adjustor_branch,\n\tipfcx6_loss_examiner,\n\tipfcx6_other_assignment,\n\tipfcx6_account_entered_date,\n\tipfcx6_average_reserve_code,\n\tipfcx6_loss_handling_office,\n\tipfcx6_loss_settling_office,\n\tipfcx6_reserve_change_ind,\n\tipfcx6_iws_claim_indicator,\n\tipfcx6_loss_handling_branch,\n\tipfcx6_loss_plant_location,\n\tipfcx6_loss_accident_state,\n\tipfcx6_loss_aia_codes_1_2,\n\tipfcx6_loss_aia_codes_3_4,\n\tipfcx6_loss_aia_codes_5_6,\n\tipfcx6_aia_sub_code,\n\tipfcx6_loss_next_review_date,\n\tipfcx6_claim_number_9digit,\n\tipfcx6_loss_claim_payee,\n\tipfcx6_excess_loss_ind,\n\tipfcx6_loss_deductible,\n\tipfcx6_loss_start_yr,\n\tipfcx6_loss_start_mo,\n\tipfcx6_loss_start_da,\n\tipfcx6_loss_weekly_wage,\n\tipfcx6_loss_payment_rate,\n\tipfcx6_loss_frequency,\n\tipfcx6_loss_period_pay,\n\tipfcx6_sub_line,\n\tipfcx6_form_number,\n\tipfcx6_prior_direct_loss_stat,\n\tipfcx6_chs_scheduled_payment,\n\tsub_contractor_indicator,\n\tipfcx6_loss_payment_made,\n\tipfcx6_denial_year,\n\tipfcx6_denial_month,\n\tipfcx6_denial_day,\n\tipfcx6_direct_loss_status,\n\tipfcx6_expense_status,\n\tipfcx6_loss_recovery_status,\n\tipfcx6_salvage_status,\n\tipfcx6_subrogation_status,\n\tipfcx6_loss_status_year,\n\tipfcx6_loss_status_month,\n\tipfcx6_loss_status_day,\n\tipfcx6_loss_original_reserve,\n\tipfcx6_os_loss_reserve,\n\tipfcx6_os_expense_reserve,\n\tipfcx6_total_loss,\n\tipfcx6_total_expense,\n\tipfcx6_total_recoveries,\n\tipfcx6_beg_os_loss_reserve,\n\tipfcx6_seg_id_from_x1,\n\tipfcx6_type_claim_payee,\n\tipfcx6_claims_made_ind,\n\tipfcx6_type_disability,\n\tipfcx6_number_of_part78,\n\tipfcx6_bank_number,\n\tipfcx6_prev_reserve_status,\n\tipfcx6_offset_onset_ind,\n\tipfcx6_pms_future_use_sub1,\n\tipfcx6_cust_spl_use_sub1,\n\tinf_action,\n\tinf_timestamp,\n\tlogical_flag,\n\tIN_pif_symbol,\n\tIN_pif_policy_number,\n\tIN_pif_module,\n\tIN_loss_year,\n\tIN_loss_month,\n\tIN_loss_day,\n\tIN_ipfcx6_loss_occ_fdigit,\n\tIN_ipfcx6_usr_loss_occurence,\n\tIN_loss_claimant,\n\tIN_loss_insurance_line,\n\tIN_loss_location_number,\n\tIN_loss_sub_location_number,\n\tIN_loss_risk_unit_group,\n\tIN_loss_class_code_group,\n\tIN_loss_class_code_member,\n\tIN_loss_unit,\n\tIN_loss_sequence_risk_unit,\n\tIN_loss_major_peril,\n\tIN_loss_major_peril_seq,\n\tIN_loss_disability,\n\tIN_loss_member,\n\tIN_loss_reserve_category,\n\tIN_loss_cause\n\tFROM (\n\t\tSELECT \r\n\t\tB.arch_pif_42x6_stage_id as arch_pif_42x6_stage_id, \r\n\t\tB.pif_42x6_stage_id as pif_42x6_stage_id, \r\n\t\tB.ipfcx6_rec_length as ipfcx6_rec_length, \r\n\t\tB.ipfcx6_action_code as ipfcx6_action_code, \r\n\t\tB.ipfcx6_file_id as ipfcx6_file_id, \r\n\t\tB.ipfcx6_segment_id as ipfcx6_segment_id, \r\n\t\tB.ipfcx6_segment_level_code as ipfcx6_segment_level_code, \r\n\t\tB.ipfcx6_segment_part_code as ipfcx6_segment_part_code, \r\n\t\tB.ipfcx6_sub_part_code as ipfcx6_sub_part_code, \r\n\t\tB.ipfcx6_risk_type_ind as ipfcx6_risk_type_ind, \r\n\t\tB.ipfcx6_type_exposure as ipfcx6_type_exposure, \r\n\t\tB.ipfcx6_year_item_effective as ipfcx6_year_item_effective, \r\n\t\tB.ipfcx6_month_item_effective as ipfcx6_month_item_effective,\r\n\t\tB.ipfcx6_day_item_effective as ipfcx6_day_item_effective, \r\n\t\tB.ipfcx6_layer as ipfcx6_layer, \r\n\t\tB.ipfcx6_reins_key_id as ipfcx6_reins_key_id, \r\n\t\tB.ipfcx6_reins_co_no as ipfcx6_reins_co_no, \r\n\t\tB.ipfcx6_reins_broker as ipfcx6_reins_broker, \r\n\t\tB.ipfcx6_year_process as ipfcx6_year_process, \r\n\t\tB.ipfcx6_month_process as ipfcx6_month_process, \r\n\t\tB.ipfcx6_day_process as ipfcx6_day_process, \r\n\t\tB.ipfcx6_year_change_entry as ipfcx6_year_change_entry, \r\n\t\tB.ipfcx6_month_change_entry as ipfcx6_month_change_entry, \r\n\t\tB.ipfcx6_day_change_entry as ipfcx6_day_change_entry, \r\n\t\tB.ipfcx6_sequence_change_entry as ipfcx6_sequence_change_entry, \r\n\t\tB.ipfcx6_segment_status as ipfcx6_segment_status, \r\n\t\tB.ipfcx6_entry_operator as ipfcx6_entry_operator, \r\n\t\tB.ipfcx6_claim_type as ipfcx6_claim_type, \r\n\t\tB.ipfcx6_loss_reported_year as ipfcx6_loss_reported_year, \r\n\t\tB.ipfcx6_loss_reported_month as ipfcx6_loss_reported_month, \r\n\t\tB.ipfcx6_loss_reported_day as ipfcx6_loss_reported_day, \r\n\t\tB.ipfcx6_loss_adjustor_no as ipfcx6_loss_adjustor_no, \r\n\t\tB.ipfcx6_loss_adjustor_branch as ipfcx6_loss_adjustor_branch, \r\n\t\tB.ipfcx6_loss_examiner as ipfcx6_loss_examiner, \r\n\t\tB.ipfcx6_other_assignment as ipfcx6_other_assignment, \r\n\t\tB.ipfcx6_account_entered_date as ipfcx6_account_entered_date, \r\n\t\tB.ipfcx6_average_reserve_code as ipfcx6_average_reserve_code, \r\n\t\tB.ipfcx6_loss_handling_office as ipfcx6_loss_handling_office, \r\n\t\tB.ipfcx6_loss_settling_office as ipfcx6_loss_settling_office, \r\n\t\tB.ipfcx6_reserve_change_ind as ipfcx6_reserve_change_ind, \r\n\t\tB.ipfcx6_iws_claim_indicator as ipfcx6_iws_claim_indicator, \r\n\t\tB.ipfcx6_loss_handling_branch as ipfcx6_loss_handling_branch, \r\n\t\tB.ipfcx6_loss_plant_location as ipfcx6_loss_plant_location, \r\n\t\tB.ipfcx6_loss_accident_state as ipfcx6_loss_accident_state, \r\n\t\tB.ipfcx6_loss_aia_codes_1_2 as ipfcx6_loss_aia_codes_1_2, \r\n\t\tB.ipfcx6_loss_aia_codes_3_4 as ipfcx6_loss_aia_codes_3_4, \r\n\t\tB.ipfcx6_loss_aia_codes_5_6 as ipfcx6_loss_aia_codes_5_6, \r\n\t\tB.ipfcx6_aia_sub_code as ipfcx6_aia_sub_code, \r\n\t\tB.ipfcx6_loss_next_review_date as ipfcx6_loss_next_review_date, \r\n\t\tB.ipfcx6_claim_number_9digit as ipfcx6_claim_number_9digit, \r\n\t\tB.ipfcx6_loss_claim_payee as ipfcx6_loss_claim_payee, \r\n\t\tB.ipfcx6_excess_loss_ind as ipfcx6_excess_loss_ind, \r\n\t\tB.ipfcx6_loss_deductible as ipfcx6_loss_deductible, \r\n\t\tB.ipfcx6_loss_start_yr as ipfcx6_loss_start_yr, \r\n\t\tB.ipfcx6_loss_start_mo as ipfcx6_loss_start_mo, \r\n\t\tB.ipfcx6_loss_start_da as ipfcx6_loss_start_da, \r\n\t\tB.ipfcx6_loss_weekly_wage as ipfcx6_loss_weekly_wage, \r\n\t\tB.ipfcx6_loss_payment_rate as ipfcx6_loss_payment_rate, \r\n\t\tB.ipfcx6_loss_frequency as ipfcx6_loss_frequency, \r\n\t\tB.ipfcx6_loss_period_pay as ipfcx6_loss_period_pay, \r\n\t\tB.ipfcx6_sub_line as ipfcx6_sub_line, \r\n\t\tB.ipfcx6_form_number as ipfcx6_form_number, \r\n\t\tB.ipfcx6_prior_direct_loss_stat as ipfcx6_prior_direct_loss_stat, \r\n\t\tB.ipfcx6_chs_scheduled_payment as ipfcx6_chs_scheduled_payment, \r\n\t\tB.sub_contractor_indicator as sub_contractor_indicator, \r\n\t\tB.ipfcx6_loss_payment_made as ipfcx6_loss_payment_made, \r\n\t\tB.ipfcx6_denial_year as ipfcx6_denial_year, \r\n\t\tB.ipfcx6_denial_month as ipfcx6_denial_month, \r\n\t\tB.ipfcx6_denial_day as ipfcx6_denial_day, \r\n\t\tB.ipfcx6_direct_loss_status as ipfcx6_direct_loss_status, \r\n\t\tB.ipfcx6_expense_status as ipfcx6_expense_status, \r\n\t\tB.ipfcx6_loss_recovery_status as ipfcx6_loss_recovery_status, \r\n\t\tB.ipfcx6_salvage_status as ipfcx6_salvage_status, \r\n\t\tB.ipfcx6_subrogation_status as ipfcx6_subrogation_status, \r\n\t\tB.ipfcx6_loss_status_year as ipfcx6_loss_status_year, \r\n\t\tB.ipfcx6_loss_status_month as ipfcx6_loss_status_month, \r\n\t\tB.ipfcx6_loss_status_day as ipfcx6_loss_status_day, \r\n\t\tB.ipfcx6_loss_original_reserve as ipfcx6_loss_original_reserve, \r\n\t\tB.ipfcx6_os_loss_reserve as ipfcx6_os_loss_reserve, \r\n\t\tB.ipfcx6_os_expense_reserve as ipfcx6_os_expense_reserve, \r\n\t\tB.ipfcx6_total_loss as ipfcx6_total_loss, \r\n\t\tB.ipfcx6_total_expense as ipfcx6_total_expense, \r\n\t\tB.ipfcx6_total_recoveries as ipfcx6_total_recoveries, \r\n\t\tB.ipfcx6_beg_os_loss_reserve as ipfcx6_beg_os_loss_reserve, \r\n\t\tB.ipfcx6_seg_id_from_x1 as ipfcx6_seg_id_from_x1, \r\n\t\tB.ipfcx6_type_claim_payee as ipfcx6_type_claim_payee, \r\n\t\tB.ipfcx6_claims_made_ind as ipfcx6_claims_made_ind, \r\n\t\tB.ipfcx6_type_disability as ipfcx6_type_disability, \r\n\t\tB.ipfcx6_number_of_part78 as ipfcx6_number_of_part78, \r\n\t\tB.ipfcx6_bank_number as ipfcx6_bank_number, \r\n\t\tB.ipfcx6_prev_reserve_status as ipfcx6_prev_reserve_status, \r\n\t\tB.ipfcx6_offset_onset_ind as ipfcx6_offset_onset_ind, \r\n\t\tB.ipfcx6_pms_future_use_sub1 as ipfcx6_pms_future_use_sub1, \r\n\t\tB.ipfcx6_cust_spl_use_sub1 as ipfcx6_cust_spl_use_sub1, \r\n\t\tB.inf_action as inf_action, B.inf_timestamp as inf_timestamp, \r\n\t\tB.logical_flag as logical_flag, \r\n\t\tCASE LEN(LTRIM(RTRIM(COALESCE(pif_symbol,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN 'N/A'\r\n\t\t                ELSE LTRIM(RTRIM(pif_symbol))\r\n\t\t        END AS pif_symbol,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(pif_policy_number,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(pif_policy_number))\r\n\t\t        END AS pif_policy_number,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(pif_module, ' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(pif_module))\r\n\t\t        END AS pif_module,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_year_of_loss, '1800'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '1800'\r\n\t\t                ELSE COALESCE(ipfcx6_year_of_loss, '1800')\r\n\t\t        END AS ipfcx6_year_of_loss,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_month_of_loss,'1'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '1'\r\n\t\t                ELSE COALESCE(ipfcx6_month_of_loss,'1')\r\n\t\t        END AS ipfcx6_month_of_loss,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_day_of_loss, '1'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '1'\r\n\t\t                ELSE COALESCE(ipfcx6_day_of_loss,'1')\r\n\t\t        END AS ipfcx6_day_of_loss,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_loss_occ_fdigit,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_loss_occ_fdigit,'0')\r\n\t\t        END AS ipfcx6_loss_occ_fdigit,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_usr_loss_occurence,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_usr_loss_occurence,'0')\r\n\t\t        END AS ipfcx6_usr_loss_occurence,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_loss_claimant,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_loss_claimant,'0')\r\n\t\t        END AS ipfcx6_loss_claimant,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_insurance_line,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN 'N/A'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_insurance_line))\r\n\t\t        END AS ipfcx6_insurance_line,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_location_number,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_location_number,'0')\r\n\t\t        END AS ipfcx6_location_number,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_sub_location_number,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_sub_location_number,'0')\r\n\t\t        END AS ipfcx6_sub_location_number,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_risk_unit_group,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_risk_unit_group))\r\n\t\t        END AS ipfcx6_risk_unit_group,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_class_code_group,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_class_code_group,'0')\r\n\t\t        END AS ipfcx6_class_code_group,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_class_code_member,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_class_code_member,'0')\r\n\t\t        END AS ipfcx6_class_code_member,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_unit,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_loss_unit))\r\n\t\t        END AS ipfcx6_loss_unit,\r\n\t\t        CASE LEN(COALESCE(ipfcx6_risk_sequence,'0'))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE COALESCE(ipfcx6_risk_sequence,'0')\r\n\t\t        END AS ipfcx6_risk_sequence,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_major_peril,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_major_peril))\r\n\t\t        END AS ipfcx6_major_peril,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_sequence_type_exposure, ' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_sequence_type_exposure))\r\n\t\t        END AS ipfcx6_sequence_type_exposure,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_disability,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_loss_disability))\r\n\t\t        END AS ipfcx6_loss_disability,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_member,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM(ipfcx6_member))\r\n\t\t        END AS ipfcx6_member,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_reserve_category,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM( ipfcx6_reserve_category))\r\n\t\t        END AS ipfcx6_reserve_category,\r\n\t\t        CASE LEN(LTRIM(RTRIM(COALESCE(ipfcx6_loss_cause,' '))))\r\n\t\t                WHEN 0\r\n\t\t                THEN '0'\r\n\t\t                ELSE LTRIM(RTRIM( ipfcx6_loss_cause))\r\n\t\t        END AS ipfcx6_loss_cause FROM arch_pif_42x6_stage B\r\n\t\tWHERE \r\n\t\tB.pif_symbol+B.pif_policy_number+B.pif_module IN \r\n\t\t(SELECT DISTINCT A.pif_symbol+A.pif_policy_number+A.pif_module FROM pif_4578_stage A)\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module,ipfcx6_year_of_loss,ipfcx6_month_of_loss,ipfcx6_day_of_loss,ipfcx6_loss_occ_fdigit,ipfcx6_usr_loss_occurence,ipfcx6_loss_claimant,ipfcx6_insurance_line,ipfcx6_location_number,ipfcx6_sub_location_number,ipfcx6_risk_unit_group,ipfcx6_class_code_group,ipfcx6_class_code_member,ipfcx6_loss_unit,ipfcx6_risk_sequence,ipfcx6_major_peril,ipfcx6_sequence_type_exposure,ipfcx6_loss_disability,ipfcx6_member,ipfcx6_reserve_category,ipfcx6_loss_cause ORDER BY arch_pif_42x6_stage_id) = 1\n),\nRTR_CLM_STG_Update AS (\n\tSELECT\n\tEXP_CLM_STG_Update_42GP.pif_42x6_stage_id,\n\tLKP_arch_pif_42x6.pif_42x6_stage_id AS lkp_pif_42x6_stage_id,\n\tLKP_arch_pif_42x6.logical_flag AS lkp_logical_flag,\n\tEXP_CLM_STG_Update_42GP.pif_symbol,\n\tEXP_CLM_STG_Update_42GP.pif_policy_number,\n\tEXP_CLM_STG_Update_42GP.pif_module,\n\tEXP_CLM_STG_Update_42GP.loss_insurance_line,\n\tEXP_CLM_STG_Update_42GP.loss_location_number,\n\tEXP_CLM_STG_Update_42GP.loss_sub_location_number,\n\tEXP_CLM_STG_Update_42GP.loss_risk_unit_group,\n\tEXP_CLM_STG_Update_42GP.loss_class_code_group,\n\tEXP_CLM_STG_Update_42GP.loss_class_code_member,\n\tEXP_CLM_STG_Update_42GP.loss_unit,\n\tEXP_CLM_STG_Update_42GP.loss_sequence_risk_unit,\n\tEXP_CLM_STG_Update_42GP.loss_major_peril,\n\tEXP_CLM_STG_Update_42GP.loss_major_peril_seq,\n\tEXP_CLM_STG_Update_42GP.loss_year,\n\tEXP_CLM_STG_Update_42GP.loss_month,\n\tEXP_CLM_STG_Update_42GP.loss_day,\n\tEXP_CLM_STG_Update_42GP.loss_occurence,\n\tEXP_CLM_STG_Update_42GP.loss_claimant,\n\tEXP_CLM_STG_Update_42GP.loss_member,\n\tEXP_CLM_STG_Update_42GP.loss_disability,\n\tEXP_CLM_STG_Update_42GP.loss_reserve_category,\n\tEXP_CLM_STG_Update_42GP.loss_cause,\n\tEXP_CLM_STG_Update_42GP.loss_offset_onset_ind,\n\tEXP_CLM_STG_Update_42GP.logical_flag,\n\tEXP_CLM_STG_Update_42GP.logical_flag_insert,\n\tEXP_CLM_STG_Update_42GP.source_system_id,\n\tLKP_arch_pif_42x6.pif_symbol AS lkp_pif_symbol,\n\tLKP_arch_pif_42x6.pif_policy_number AS lkp_pif_policy_number,\n\tLKP_arch_pif_42x6.pif_module AS lkp_pif_module,\n\tLKP_arch_pif_42x6.ipfcx6_rec_length AS lkp_ipfcx6_rec_length,\n\tLKP_arch_pif_42x6.ipfcx6_action_code AS lkp_ipfcx6_action_code,\n\tLKP_arch_pif_42x6.ipfcx6_file_id AS lkp_ipfcx6_file_id,\n\tLKP_arch_pif_42x6.ipfcx6_segment_id AS lkp_ipfcx6_segment_id,\n\tLKP_arch_pif_42x6.ipfcx6_segment_level_code AS lkp_ipfcx6_segment_level_code,\n\tLKP_arch_pif_42x6.ipfcx6_segment_part_code AS lkp_ipfcx6_segment_part_code,\n\tLKP_arch_pif_42x6.ipfcx6_sub_part_code AS lkp_ipfcx6_sub_part_code,\n\tLKP_arch_pif_42x6.ipfcx6_insurance_line AS lkp_ipfcx6_insurance_line,\n\tLKP_arch_pif_42x6.ipfcx6_location_number AS lkp_ipfcx6_location_number,\n\tLKP_arch_pif_42x6.ipfcx6_sub_location_number AS lkp_ipfcx6_sub_location_number,\n\tLKP_arch_pif_42x6.ipfcx6_risk_unit_group AS lkp_ipfcx6_risk_unit_group,\n\tLKP_arch_pif_42x6.ipfcx6_class_code_group AS lkp_ipfcx6_class_code_group,\n\tLKP_arch_pif_42x6.ipfcx6_class_code_member AS lkp_ipfcx6_class_code_member,\n\tLKP_arch_pif_42x6.ipfcx6_loss_unit AS lkp_ipfcx6_loss_unit,\n\tLKP_arch_pif_42x6.ipfcx6_risk_sequence AS lkp_ipfcx6_risk_sequence,\n\tLKP_arch_pif_42x6.ipfcx6_risk_type_ind AS lkp_ipfcx6_risk_type_ind,\n\tLKP_arch_pif_42x6.ipfcx6_type_exposure AS lkp_ipfcx6_type_exposure,\n\tLKP_arch_pif_42x6.ipfcx6_major_peril AS lkp_ipfcx6_major_peril,\n\tLKP_arch_pif_42x6.ipfcx6_sequence_type_exposure AS lkp_ipfcx6_sequence_type_exposure,\n\tLKP_arch_pif_42x6.ipfcx6_year_item_effective AS lkp_ipfcx6_year_item_effective,\n\tLKP_arch_pif_42x6.ipfcx6_month_item_effective AS lkp_ipfcx6_month_item_effective,\n\tLKP_arch_pif_42x6.ipfcx6_day_item_effective AS lkp_ipfcx6_day_item_effective,\n\tLKP_arch_pif_42x6.ipfcx6_year_of_loss AS lkp_ipfcx6_year_of_loss,\n\tLKP_arch_pif_42x6.ipfcx6_month_of_loss AS lkp_ipfcx6_month_of_loss,\n\tLKP_arch_pif_42x6.ipfcx6_day_of_loss AS lkp_ipfcx6_day_of_loss,\n\tLKP_arch_pif_42x6.ipfcx6_loss_occ_fdigit AS lkp_ipfcx6_loss_occ_fdigit,\n\tLKP_arch_pif_42x6.ipfcx6_usr_loss_occurence AS lkp_ipfcx6_usr_loss_occurence,\n\tLKP_arch_pif_42x6.ipfcx6_loss_claimant AS lkp_ipfcx6_loss_claimant,\n\tLKP_arch_pif_42x6.ipfcx6_member AS lkp_ipfcx6_member,\n\tLKP_arch_pif_42x6.ipfcx6_loss_disability AS lkp_ipfcx6_loss_disability,\n\tLKP_arch_pif_42x6.ipfcx6_reserve_category AS lkp_ipfcx6_reserve_category,\n\tLKP_arch_pif_42x6.ipfcx6_layer AS lkp_ipfcx6_layer,\n\tLKP_arch_pif_42x6.ipfcx6_reins_key_id AS lkp_ipfcx6_reins_key_id,\n\tLKP_arch_pif_42x6.ipfcx6_reins_co_no AS lkp_ipfcx6_reins_co_no,\n\tLKP_arch_pif_42x6.ipfcx6_reins_broker AS lkp_ipfcx6_reins_broker,\n\tLKP_arch_pif_42x6.ipfcx6_year_process AS lkp_ipfcx6_year_process,\n\tLKP_arch_pif_42x6.ipfcx6_month_process AS lkp_ipfcx6_month_process,\n\tLKP_arch_pif_42x6.ipfcx6_day_process AS lkp_ipfcx6_day_process,\n\tLKP_arch_pif_42x6.ipfcx6_year_change_entry AS lkp_ipfcx6_year_change_entry,\n\tLKP_arch_pif_42x6.ipfcx6_month_change_entry AS lkp_ipfcx6_month_change_entry,\n\tLKP_arch_pif_42x6.ipfcx6_day_change_entry AS lkp_ipfcx6_day_change_entry,\n\tLKP_arch_pif_42x6.ipfcx6_sequence_change_entry AS lkp_ipfcx6_sequence_change_entry,\n\tLKP_arch_pif_42x6.ipfcx6_segment_status AS lkp_ipfcx6_segment_status,\n\tLKP_arch_pif_42x6.ipfcx6_entry_operator AS lkp_ipfcx6_entry_operator,\n\tLKP_arch_pif_42x6.ipfcx6_claim_type AS lkp_ipfcx6_claim_type,\n\tLKP_arch_pif_42x6.ipfcx6_loss_reported_year AS lkp_ipfcx6_loss_reported_year,\n\tLKP_arch_pif_42x6.ipfcx6_loss_reported_month AS lkp_ipfcx6_loss_reported_month,\n\tLKP_arch_pif_42x6.ipfcx6_loss_reported_day AS lkp_ipfcx6_loss_reported_day,\n\tLKP_arch_pif_42x6.ipfcx6_loss_cause AS lkp_ipfcx6_loss_cause,\n\tLKP_arch_pif_42x6.ipfcx6_loss_adjustor_no AS lkp_ipfcx6_loss_adjustor_no,\n\tLKP_arch_pif_42x6.ipfcx6_loss_adjustor_branch AS lkp_ipfcx6_loss_adjustor_branch,\n\tLKP_arch_pif_42x6.ipfcx6_loss_examiner AS lkp_ipfcx6_loss_examiner,\n\tLKP_arch_pif_42x6.ipfcx6_other_assignment AS lkp_ipfcx6_other_assignment,\n\tLKP_arch_pif_42x6.ipfcx6_account_entered_date AS lkp_ipfcx6_account_entered_date,\n\tLKP_arch_pif_42x6.ipfcx6_average_reserve_code AS lkp_ipfcx6_average_reserve_code,\n\tLKP_arch_pif_42x6.ipfcx6_loss_handling_office AS lkp_ipfcx6_loss_handling_office,\n\tLKP_arch_pif_42x6.ipfcx6_loss_settling_office AS lkp_ipfcx6_loss_settling_office,\n\tLKP_arch_pif_42x6.ipfcx6_reserve_change_ind AS lkp_ipfcx6_reserve_change_ind,\n\tLKP_arch_pif_42x6.ipfcx6_iws_claim_indicator AS lkp_ipfcx6_iws_claim_indicator,\n\tLKP_arch_pif_42x6.ipfcx6_loss_handling_branch AS lkp_ipfcx6_loss_handling_branch,\n\tLKP_arch_pif_42x6.ipfcx6_loss_plant_location AS lkp_ipfcx6_loss_plant_location,\n\tLKP_arch_pif_42x6.ipfcx6_loss_accident_state AS lkp_ipfcx6_loss_accident_state,\n\tLKP_arch_pif_42x6.ipfcx6_loss_aia_codes_1_2 AS lkp_ipfcx6_loss_aia_codes_1_2,\n\tLKP_arch_pif_42x6.ipfcx6_loss_aia_codes_3_4 AS lkp_ipfcx6_loss_aia_codes_3_4,\n\tLKP_arch_pif_42x6.ipfcx6_loss_aia_codes_5_6 AS lkp_ipfcx6_loss_aia_codes_5_6,\n\tLKP_arch_pif_42x6.ipfcx6_aia_sub_code AS lkp_ipfcx6_aia_sub_code,\n\tLKP_arch_pif_42x6.ipfcx6_loss_next_review_date AS lkp_ipfcx6_loss_next_review_date,\n\tLKP_arch_pif_42x6.ipfcx6_claim_number_9digit AS lkp_ipfcx6_claim_number_9digit,\n\tLKP_arch_pif_42x6.ipfcx6_loss_claim_payee AS lkp_ipfcx6_loss_claim_payee,\n\tLKP_arch_pif_42x6.ipfcx6_excess_loss_ind AS lkp_ipfcx6_excess_loss_ind,\n\tLKP_arch_pif_42x6.ipfcx6_loss_deductible AS lkp_ipfcx6_loss_deductible,\n\tLKP_arch_pif_42x6.ipfcx6_loss_start_yr AS lkp_ipfcx6_loss_start_yr,\n\tLKP_arch_pif_42x6.ipfcx6_loss_start_mo AS lkp_ipfcx6_loss_start_mo,\n\tLKP_arch_pif_42x6.ipfcx6_loss_start_da AS lkp_ipfcx6_loss_start_da,\n\tLKP_arch_pif_42x6.ipfcx6_loss_weekly_wage AS lkp_ipfcx6_loss_weekly_wage,\n\tLKP_arch_pif_42x6.ipfcx6_loss_payment_rate AS lkp_ipfcx6_loss_payment_rate,\n\tLKP_arch_pif_42x6.ipfcx6_loss_frequency AS lkp_ipfcx6_loss_frequency,\n\tLKP_arch_pif_42x6.ipfcx6_loss_period_pay AS lkp_ipfcx6_loss_period_pay,\n\tLKP_arch_pif_42x6.ipfcx6_sub_line AS lkp_ipfcx6_sub_line,\n\tLKP_arch_pif_42x6.ipfcx6_form_number AS lkp_ipfcx6_form_number,\n\tLKP_arch_pif_42x6.ipfcx6_prior_direct_loss_stat AS lkp_ipfcx6_prior_direct_loss_stat,\n\tLKP_arch_pif_42x6.ipfcx6_chs_scheduled_payment AS lkp_ipfcx6_chs_scheduled_payment,\n\tLKP_arch_pif_42x6.sub_contractor_indicator AS lkp_sub_contractor_indicator,\n\tLKP_arch_pif_42x6.ipfcx6_loss_payment_made AS lkp_ipfcx6_loss_payment_made,\n\tLKP_arch_pif_42x6.ipfcx6_denial_year AS lkp_ipfcx6_denial_year,\n\tLKP_arch_pif_42x6.ipfcx6_denial_month AS lkp_ipfcx6_denial_month,\n\tLKP_arch_pif_42x6.ipfcx6_denial_day AS lkp_ipfcx6_denial_day,\n\tLKP_arch_pif_42x6.ipfcx6_direct_loss_status AS lkp_ipfcx6_direct_loss_status,\n\tLKP_arch_pif_42x6.ipfcx6_expense_status AS lkp_ipfcx6_expense_status,\n\tLKP_arch_pif_42x6.ipfcx6_loss_recovery_status AS lkp_ipfcx6_loss_recovery_status,\n\tLKP_arch_pif_42x6.ipfcx6_salvage_status AS lkp_ipfcx6_salvage_status,\n\tLKP_arch_pif_42x6.ipfcx6_subrogation_status AS lkp_ipfcx6_subrogation_status,\n\tLKP_arch_pif_42x6.ipfcx6_loss_status_year AS lkp_ipfcx6_loss_status_year,\n\tLKP_arch_pif_42x6.ipfcx6_loss_status_month AS lkp_ipfcx6_loss_status_month,\n\tLKP_arch_pif_42x6.ipfcx6_loss_status_day AS lkp_ipfcx6_loss_status_day,\n\tLKP_arch_pif_42x6.ipfcx6_loss_original_reserve AS lkp_ipfcx6_loss_original_reserve,\n\tLKP_arch_pif_42x6.ipfcx6_os_loss_reserve AS lkp_ipfcx6_os_loss_reserve,\n\tLKP_arch_pif_42x6.ipfcx6_os_expense_reserve AS lkp_ipfcx6_os_expense_reserve,\n\tLKP_arch_pif_42x6.ipfcx6_total_loss AS lkp_ipfcx6_total_loss,\n\tLKP_arch_pif_42x6.ipfcx6_total_expense AS lkp_ipfcx6_total_expense,\n\tLKP_arch_pif_42x6.ipfcx6_total_recoveries AS lkp_ipfcx6_total_recoveries,\n\tLKP_arch_pif_42x6.ipfcx6_beg_os_loss_reserve AS lkp_ipfcx6_beg_os_loss_reserve,\n\tLKP_arch_pif_42x6.ipfcx6_seg_id_from_x1 AS lkp_ipfcx6_seg_id_from_x1,\n\tLKP_arch_pif_42x6.ipfcx6_type_claim_payee AS lkp_ipfcx6_type_claim_payee,\n\tLKP_arch_pif_42x6.ipfcx6_claims_made_ind AS lkp_ipfcx6_claims_made_ind,\n\tLKP_arch_pif_42x6.ipfcx6_type_disability AS lkp_ipfcx6_type_disability,\n\tLKP_arch_pif_42x6.ipfcx6_number_of_part78 AS lkp_ipfcx6_number_of_part78,\n\tLKP_arch_pif_42x6.ipfcx6_bank_number AS lkp_ipfcx6_bank_number,\n\tLKP_arch_pif_42x6.ipfcx6_prev_reserve_status AS lkp_ipfcx6_prev_reserve_status,\n\tLKP_arch_pif_42x6.ipfcx6_offset_onset_ind AS lkp_ipfcx6_offset_onset_ind,\n\tLKP_arch_pif_42x6.ipfcx6_pms_future_use_sub1 AS lkp_ipfcx6_pms_future_use_sub1,\n\tLKP_arch_pif_42x6.ipfcx6_cust_spl_use_sub1 AS lkp_ipfcx6_cust_spl_use_sub1,\n\tLKP_arch_pif_42x6.inf_action AS lkp_inf_action,\n\tLKP_arch_pif_42x6.inf_timestamp AS lkp_inf_timestamp\n\tFROM EXP_CLM_STG_Update_42GP\n\tLEFT JOIN LKP_arch_pif_42x6\n\tON LKP_arch_pif_42x6.pif_symbol = EXP_CLM_STG_Update_42GP.pif_symbol AND LKP_arch_pif_42x6.pif_policy_number = EXP_CLM_STG_Update_42GP.pif_policy_number AND LKP_arch_pif_42x6.pif_module = EXP_CLM_STG_Update_42GP.pif_module AND LKP_arch_pif_42x6.ipfcx6_year_of_loss = EXP_CLM_STG_Update_42GP.out_loss_year AND LKP_arch_pif_42x6.ipfcx6_month_of_loss = EXP_CLM_STG_Update_42GP.out_loss_month AND LKP_arch_pif_42x6.ipfcx6_day_of_loss = EXP_CLM_STG_Update_42GP.out_loss_day AND LKP_arch_pif_42x6.ipfcx6_loss_occ_fdigit = EXP_CLM_STG_Update_42GP.out_ipfcx6_loss_occ_fdigit AND LKP_arch_pif_42x6.ipfcx6_usr_loss_occurence = EXP_CLM_STG_Update_42GP.out_ipfcx6_usr_loss_occurence AND LKP_arch_pif_42x6.ipfcx6_loss_claimant = EXP_CLM_STG_Update_42GP.out_loss_claimant AND LKP_arch_pif_42x6.ipfcx6_insurance_line = EXP_CLM_STG_Update_42GP.out_loss_insurance_line AND LKP_arch_pif_42x6.ipfcx6_location_number = EXP_CLM_STG_Update_42GP.out_loss_location_number AND LKP_arch_pif_42x6.ipfcx6_sub_location_number = EXP_CLM_STG_Update_42GP.out_loss_sub_location_number AND LKP_arch_pif_42x6.ipfcx6_risk_unit_group = EXP_CLM_STG_Update_42GP.out_loss_risk_unit_group AND LKP_arch_pif_42x6.ipfcx6_class_code_group = EXP_CLM_STG_Update_42GP.out_loss_class_code_group AND LKP_arch_pif_42x6.ipfcx6_class_code_member = EXP_CLM_STG_Update_42GP.out_loss_class_code_member AND LKP_arch_pif_42x6.ipfcx6_loss_unit = EXP_CLM_STG_Update_42GP.out_loss_unit AND LKP_arch_pif_42x6.ipfcx6_risk_sequence = EXP_CLM_STG_Update_42GP.out_loss_sequence_risk_unit AND LKP_arch_pif_42x6.ipfcx6_major_peril = EXP_CLM_STG_Update_42GP.out_loss_major_peril AND LKP_arch_pif_42x6.ipfcx6_sequence_type_exposure = EXP_CLM_STG_Update_42GP.out_loss_major_peril_seq AND LKP_arch_pif_42x6.ipfcx6_loss_disability = EXP_CLM_STG_Update_42GP.out_loss_disability AND LKP_arch_pif_42x6.ipfcx6_member = EXP_CLM_STG_Update_42GP.out_loss_member AND LKP_arch_pif_42x6.ipfcx6_reserve_category = EXP_CLM_STG_Update_42GP.out_loss_reserve_category AND LKP_arch_pif_42x6.ipfcx6_loss_cause = EXP_CLM_STG_Update_42GP.out_loss_cause\n),\nRTR_CLM_STG_Update_INSERT_DUMMY AS (SELECT * FROM RTR_CLM_STG_Update WHERE ISNULL(pif_42x6_stage_id) AND (ISNULL(lkp_pif_42x6_stage_id) OR NOT IN(lkp_logical_flag, '0', '1'))),\nRTR_CLM_STG_Update_UPDATE AS (SELECT * FROM RTR_CLM_STG_Update WHERE NOT ISNULL(pif_42x6_stage_id)),\nRTR_CLM_STG_Update_INSERT AS (SELECT * FROM RTR_CLM_STG_Update WHERE FALSE\r\n--ISNULL(pif_42x6_stage_id) AND NOT ISNULL(lkp_pif_42x6_stage_id) AND NOT IN(lkp_logical_flag, '0', '1' )),\nEXP_CLM_STG_insert AS (\n\tSELECT\n\tlogical_flag AS logical_flag_4578,\n\tlkp_pif_symbol,\n\tlkp_pif_policy_number,\n\tlkp_pif_module,\n\tlkp_ipfcx6_rec_length,\n\tlkp_ipfcx6_action_code,\n\tlkp_ipfcx6_file_id,\n\tlkp_ipfcx6_segment_id,\n\tlkp_ipfcx6_segment_level_code,\n\tlkp_ipfcx6_segment_part_code,\n\tlkp_ipfcx6_sub_part_code,\n\tlkp_ipfcx6_insurance_line,\n\tlkp_ipfcx6_location_number,\n\tlkp_ipfcx6_sub_location_number,\n\tlkp_ipfcx6_risk_unit_group,\n\tlkp_ipfcx6_class_code_group,\n\tlkp_ipfcx6_class_code_member,\n\tlkp_ipfcx6_loss_unit,\n\tlkp_ipfcx6_risk_sequence,\n\tlkp_ipfcx6_risk_type_ind,\n\tlkp_ipfcx6_type_exposure,\n\tlkp_ipfcx6_major_peril,\n\tlkp_ipfcx6_sequence_type_exposure,\n\tlkp_ipfcx6_year_item_effective,\n\tlkp_ipfcx6_month_item_effective,\n\tlkp_ipfcx6_day_item_effective,\n\tlkp_ipfcx6_year_of_loss,\n\tlkp_ipfcx6_month_of_loss,\n\tlkp_ipfcx6_day_of_loss,\n\tlkp_ipfcx6_loss_occ_fdigit,\n\tlkp_ipfcx6_usr_loss_occurence,\n\tlkp_ipfcx6_loss_claimant,\n\tlkp_ipfcx6_member,\n\tlkp_ipfcx6_loss_disability,\n\tlkp_ipfcx6_reserve_category,\n\tlkp_ipfcx6_layer,\n\tlkp_ipfcx6_reins_key_id,\n\tlkp_ipfcx6_reins_co_no,\n\tlkp_ipfcx6_reins_broker,\n\tlkp_ipfcx6_year_process,\n\tlkp_ipfcx6_month_process,\n\tlkp_ipfcx6_day_process,\n\tlkp_ipfcx6_year_change_entry,\n\tlkp_ipfcx6_month_change_entry,\n\tlkp_ipfcx6_day_change_entry,\n\tlkp_ipfcx6_sequence_change_entry,\n\tlkp_ipfcx6_segment_status,\n\tlkp_ipfcx6_entry_operator,\n\tlkp_ipfcx6_claim_type,\n\tlkp_ipfcx6_loss_reported_year,\n\tlkp_ipfcx6_loss_reported_month,\n\tlkp_ipfcx6_loss_reported_day,\n\tlkp_ipfcx6_loss_cause,\n\tlkp_ipfcx6_loss_adjustor_no,\n\tlkp_ipfcx6_loss_adjustor_branch,\n\tlkp_ipfcx6_loss_examiner,\n\tlkp_ipfcx6_other_assignment,\n\tlkp_ipfcx6_account_entered_date,\n\tlkp_ipfcx6_average_reserve_code,\n\tlkp_ipfcx6_loss_handling_office,\n\tlkp_ipfcx6_loss_settling_office,\n\tlkp_ipfcx6_reserve_change_ind,\n\tlkp_ipfcx6_iws_claim_indicator,\n\tlkp_ipfcx6_loss_handling_branch,\n\tlkp_ipfcx6_loss_plant_location,\n\tlkp_ipfcx6_loss_accident_state,\n\tlkp_ipfcx6_loss_aia_codes_1_2,\n\tlkp_ipfcx6_loss_aia_codes_3_ AS lkp_ipfcx6_loss_aia_codes_3_4,\n\tlkp_ipfcx6_loss_aia_codes_5_6,\n\tlkp_ipfcx6_aia_sub_code,\n\tlkp_ipfcx6_loss_next_review_date,\n\tlkp_ipfcx6_claim_number_9digit,\n\tlkp_ipfcx6_loss_claim_payee,\n\tlkp_ipfcx6_excess_loss_ind,\n\tlkp_ipfcx6_loss_deductible,\n\tlkp_ipfcx6_loss_start_yr,\n\tlkp_ipfcx6_loss_start_mo,\n\tlkp_ipfcx6_loss_start_da,\n\tlkp_ipfcx6_loss_weekly_wage,\n\tlkp_ipfcx6_loss_payment_rate,\n\tlkp_ipfcx6_loss_frequency,\n\tlkp_ipfcx6_loss_period_pay,\n\tlkp_ipfcx6_sub_line,\n\tlkp_ipfcx6_form_number,\n\tlkp_ipfcx6_prior_direct_loss_stat,\n\tlkp_ipfcx6_chs_scheduled_payment,\n\tlkp_sub_contractor_indicator,\n\tlkp_ipfcx6_loss_payment_made,\n\tlkp_ipfcx6_denial_year,\n\tlkp_ipfcx6_denial_month,\n\tlkp_ipfcx6_denial_day,\n\tlkp_ipfcx6_direct_loss_status,\n\tlkp_ipfcx6_expense_status,\n\tlkp_ipfcx6_loss_recovery_status,\n\tlkp_ipfcx6_salvage_status,\n\tlkp_ipfcx6_subrogation_status,\n\tlkp_ipfcx6_loss_status_year,\n\tlkp_ipfcx6_loss_status_month,\n\tlkp_ipfcx6_loss_status_day,\n\tlkp_ipfcx6_loss_original_reserve,\n\tlkp_ipfcx6_os_loss_reserve,\n\tlkp_ipfcx6_os_expense_reserve,\n\tlkp_ipfcx6_total_loss,\n\tlkp_ipfcx6_total_expense,\n\tlkp_ipfcx6_total_recoveries,\n\tlkp_ipfcx6_beg_os_loss_reserve,\n\tlkp_ipfcx6_seg_id_from_x1,\n\tlkp_ipfcx6_type_claim_payee,\n\tlkp_ipfcx6_claims_made_ind,\n\tlkp_ipfcx6_type_disability,\n\tlkp_ipfcx6_number_of_part78,\n\tlkp_ipfcx6_bank_number,\n\tlkp_ipfcx6_prev_reserve_status,\n\tlkp_ipfcx6_offset_onset_ind,\n\tlkp_ipfcx6_pms_future_use_sub1,\n\tlkp_ipfcx6_cust_spl_use_sub1,\n\tlkp_inf_action,\n\tlkp_inf_timestamp,\n\tSYSDATE AS extract_date,\n\tSYSDATE AS as_of_date,\n\tsource_system_id AS source_system_id4\n\tFROM RTR_CLM_STG_Update_INSERT\n),\nUPD_42x6_insert AS (\n\tSELECT\n\tlogical_flag_4578, \n\tlkp_pif_symbol, \n\tlkp_pif_policy_number, \n\tlkp_pif_module, \n\tlkp_ipfcx6_rec_length, \n\tlkp_ipfcx6_action_code, \n\tlkp_ipfcx6_file_id, \n\tlkp_ipfcx6_segment_id, \n\tlkp_ipfcx6_segment_level_code, \n\tlkp_ipfcx6_segment_part_code, \n\tlkp_ipfcx6_sub_part_code, \n\tlkp_ipfcx6_insurance_line, \n\tlkp_ipfcx6_location_number, \n\tlkp_ipfcx6_sub_location_number, \n\tlkp_ipfcx6_risk_unit_group, \n\tlkp_ipfcx6_class_code_group, \n\tlkp_ipfcx6_class_code_member, \n\tlkp_ipfcx6_loss_unit, \n\tlkp_ipfcx6_risk_sequence, \n\tlkp_ipfcx6_risk_type_ind, \n\tlkp_ipfcx6_type_exposure, \n\tlkp_ipfcx6_major_peril, \n\tlkp_ipfcx6_sequence_type_exposure, \n\tlkp_ipfcx6_year_item_effective, \n\tlkp_ipfcx6_month_item_effective, \n\tlkp_ipfcx6_day_item_effective, \n\tlkp_ipfcx6_year_of_loss, \n\tlkp_ipfcx6_month_of_loss, \n\tlkp_ipfcx6_day_of_loss, \n\tlkp_ipfcx6_loss_occ_fdigit, \n\tlkp_ipfcx6_usr_loss_occurence, \n\tlkp_ipfcx6_loss_claimant, \n\tlkp_ipfcx6_member, \n\tlkp_ipfcx6_loss_disability, \n\tlkp_ipfcx6_reserve_category, \n\tlkp_ipfcx6_layer, \n\tlkp_ipfcx6_reins_key_id, \n\tlkp_ipfcx6_reins_co_no, \n\tlkp_ipfcx6_reins_broker, \n\tlkp_ipfcx6_year_process, \n\tlkp_ipfcx6_month_process, \n\tlkp_ipfcx6_day_process, \n\tlkp_ipfcx6_year_change_entry, \n\tlkp_ipfcx6_month_change_entry, \n\tlkp_ipfcx6_day_change_entry, \n\tlkp_ipfcx6_sequence_change_entry, \n\tlkp_ipfcx6_segment_status, \n\tlkp_ipfcx6_entry_operator, \n\tlkp_ipfcx6_claim_type, \n\tlkp_ipfcx6_loss_reported_year, \n\tlkp_ipfcx6_loss_reported_month, \n\tlkp_ipfcx6_loss_reported_day, \n\tlkp_ipfcx6_loss_cause, \n\tlkp_ipfcx6_loss_adjustor_no, \n\tlkp_ipfcx6_loss_adjustor_branch, \n\tlkp_ipfcx6_loss_examiner, \n\tlkp_ipfcx6_other_assignment, \n\tlkp_ipfcx6_account_entered_date, \n\tlkp_ipfcx6_average_reserve_code, \n\tlkp_ipfcx6_loss_handling_office, \n\tlkp_ipfcx6_loss_settling_office, \n\tlkp_ipfcx6_reserve_change_ind, \n\tlkp_ipfcx6_iws_claim_indicator, \n\tlkp_ipfcx6_loss_handling_branch, \n\tlkp_ipfcx6_loss_plant_location, \n\tlkp_ipfcx6_loss_accident_state, \n\tlkp_ipfcx6_loss_aia_codes_1_2, \n\tlkp_ipfcx6_loss_aia_codes_3_4, \n\tlkp_ipfcx6_loss_aia_codes_5_6, \n\tlkp_ipfcx6_aia_sub_code, \n\tlkp_ipfcx6_loss_next_review_date, \n\tlkp_ipfcx6_claim_number_9digit, \n\tlkp_ipfcx6_loss_claim_payee, \n\tlkp_ipfcx6_excess_loss_ind, \n\tlkp_ipfcx6_loss_deductible, \n\tlkp_ipfcx6_loss_start_yr, \n\tlkp_ipfcx6_loss_start_mo, \n\tlkp_ipfcx6_loss_start_da, \n\tlkp_ipfcx6_loss_weekly_wage, \n\tlkp_ipfcx6_loss_payment_rate, \n\tlkp_ipfcx6_loss_frequency, \n\tlkp_ipfcx6_loss_period_pay, \n\tlkp_ipfcx6_sub_line, \n\tlkp_ipfcx6_form_number, \n\tlkp_ipfcx6_prior_direct_loss_stat, \n\tlkp_ipfcx6_chs_scheduled_payment, \n\tlkp_sub_contractor_indicator, \n\tlkp_ipfcx6_loss_payment_made, \n\tlkp_ipfcx6_denial_year, \n\tlkp_ipfcx6_denial_month, \n\tlkp_ipfcx6_denial_day, \n\tlkp_ipfcx6_direct_loss_status, \n\tlkp_ipfcx6_expense_status, \n\tlkp_ipfcx6_loss_recovery_status, \n\tlkp_ipfcx6_salvage_status, \n\tlkp_ipfcx6_subrogation_status, \n\tlkp_ipfcx6_loss_status_year, \n\tlkp_ipfcx6_loss_status_month, \n\tlkp_ipfcx6_loss_status_day, \n\tlkp_ipfcx6_loss_original_reserve, \n\tlkp_ipfcx6_os_loss_reserve, \n\tlkp_ipfcx6_os_expense_reserve, \n\tlkp_ipfcx6_total_loss, \n\tlkp_ipfcx6_total_expense, \n\tlkp_ipfcx6_total_recoveries, \n\tlkp_ipfcx6_beg_os_loss_reserve, \n\tlkp_ipfcx6_seg_id_from_x1, \n\tlkp_ipfcx6_type_claim_payee, \n\tlkp_ipfcx6_claims_made_ind, \n\tlkp_ipfcx6_type_disability, \n\tlkp_ipfcx6_number_of_part78, \n\tlkp_ipfcx6_bank_number, \n\tlkp_ipfcx6_prev_reserve_status, \n\tlkp_ipfcx6_offset_onset_ind, \n\tlkp_ipfcx6_pms_future_use_sub1, \n\tlkp_ipfcx6_cust_spl_use_sub1, \n\tlkp_inf_action, \n\tlkp_inf_timestamp, \n\textract_date, \n\tas_of_date, \n\tsource_system_id4\n\tFROM EXP_CLM_STG_insert\n),\nPIF_42X6_stage_Insert AS (\n\tINSERT INTO PIF_42X6_stage\n\t(pif_symbol, pif_policy_number, pif_module, ipfcx6_rec_length, ipfcx6_action_code, ipfcx6_file_id, ipfcx6_segment_id, ipfcx6_segment_level_code, ipfcx6_segment_part_code, ipfcx6_sub_part_code, ipfcx6_insurance_line, ipfcx6_location_number, ipfcx6_sub_location_number, ipfcx6_risk_unit_group, ipfcx6_class_code_group, ipfcx6_class_code_member, ipfcx6_loss_unit, ipfcx6_risk_sequence, ipfcx6_risk_type_ind, ipfcx6_type_exposure, ipfcx6_major_peril, ipfcx6_sequence_type_exposure, ipfcx6_year_item_effective, ipfcx6_month_item_effective, ipfcx6_day_item_effective, ipfcx6_year_of_loss, ipfcx6_month_of_loss, ipfcx6_day_of_loss, ipfcx6_loss_occ_fdigit, ipfcx6_usr_loss_occurence, ipfcx6_loss_claimant, ipfcx6_member, ipfcx6_loss_disability, ipfcx6_reserve_category, ipfcx6_layer, ipfcx6_reins_key_id, ipfcx6_reins_co_no, ipfcx6_reins_broker, ipfcx6_year_process, ipfcx6_month_process, ipfcx6_day_process, ipfcx6_year_change_entry, ipfcx6_month_change_entry, ipfcx6_day_change_entry, ipfcx6_sequence_change_entry, ipfcx6_segment_status, ipfcx6_entry_operator, ipfcx6_claim_type, ipfcx6_loss_reported_year, ipfcx6_loss_reported_month, ipfcx6_loss_reported_day, ipfcx6_loss_cause, ipfcx6_loss_adjustor_no, ipfcx6_loss_adjustor_branch, ipfcx6_loss_examiner, ipfcx6_other_assignment, ipfcx6_account_entered_date, ipfcx6_average_reserve_code, ipfcx6_loss_handling_office, ipfcx6_loss_settling_office, ipfcx6_reserve_change_ind, ipfcx6_iws_claim_indicator, ipfcx6_loss_handling_branch, ipfcx6_loss_plant_location, ipfcx6_loss_accident_state, ipfcx6_loss_aia_codes_1_2, ipfcx6_loss_aia_codes_3_4, ipfcx6_loss_aia_codes_5_6, ipfcx6_aia_sub_code, ipfcx6_loss_next_review_date, ipfcx6_claim_number_9digit, ipfcx6_loss_claim_payee, ipfcx6_excess_loss_ind, ipfcx6_loss_deductible, ipfcx6_loss_start_yr, ipfcx6_loss_start_mo, ipfcx6_loss_start_da, ipfcx6_loss_weekly_wage, ipfcx6_loss_payment_rate, ipfcx6_loss_frequency, ipfcx6_loss_period_pay, ipfcx6_sub_line, ipfcx6_form_number, ipfcx6_prior_direct_loss_stat, ipfcx6_chs_scheduled_payment, sub_contractor_indicator, ipfcx6_loss_payment_made, ipfcx6_denial_year, ipfcx6_denial_month, ipfcx6_denial_day, ipfcx6_direct_loss_status, ipfcx6_expense_status, ipfcx6_loss_recovery_status, ipfcx6_salvage_status, ipfcx6_subrogation_status, ipfcx6_loss_status_year, ipfcx6_loss_status_month, ipfcx6_loss_status_day, ipfcx6_loss_original_reserve, ipfcx6_os_loss_reserve, ipfcx6_os_expense_reserve, ipfcx6_total_loss, ipfcx6_total_expense, ipfcx6_total_recoveries, ipfcx6_beg_os_loss_reserve, ipfcx6_seg_id_from_x1, ipfcx6_type_claim_payee, ipfcx6_claims_made_ind, ipfcx6_type_disability, ipfcx6_number_of_part78, ipfcx6_bank_number, ipfcx6_prev_reserve_status, ipfcx6_offset_onset_ind, ipfcx6_pms_future_use_sub1, ipfcx6_cust_spl_use_sub1, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, source_system_id)\n\tSELECT \n\tlkp_pif_symbol AS PIF_SYMBOL, \n\tlkp_pif_policy_number AS PIF_POLICY_NUMBER, \n\tlkp_pif_module AS PIF_MODULE, \n\tlkp_ipfcx6_rec_length AS IPFCX6_REC_LENGTH, \n\tlkp_ipfcx6_action_code AS IPFCX6_ACTION_CODE, \n\tlkp_ipfcx6_file_id AS IPFCX6_FILE_ID, \n\tlkp_ipfcx6_segment_id AS IPFCX6_SEGMENT_ID, \n\tlkp_ipfcx6_segment_level_code AS IPFCX6_SEGMENT_LEVEL_CODE, \n\tlkp_ipfcx6_segment_part_code AS IPFCX6_SEGMENT_PART_CODE, \n\tlkp_ipfcx6_sub_part_code AS IPFCX6_SUB_PART_CODE, \n\tlkp_ipfcx6_insurance_line AS IPFCX6_INSURANCE_LINE, \n\tlkp_ipfcx6_location_number AS IPFCX6_LOCATION_NUMBER, \n\tlkp_ipfcx6_sub_location_number AS IPFCX6_SUB_LOCATION_NUMBER, \n\tlkp_ipfcx6_risk_unit_group AS IPFCX6_RISK_UNIT_GROUP, \n\tlkp_ipfcx6_class_code_group AS IPFCX6_CLASS_CODE_GROUP, \n\tlkp_ipfcx6_class_code_member AS IPFCX6_CLASS_CODE_MEMBER, \n\tlkp_ipfcx6_loss_unit AS IPFCX6_LOSS_UNIT, \n\tlkp_ipfcx6_risk_sequence AS IPFCX6_RISK_SEQUENCE, \n\tlkp_ipfcx6_risk_type_ind AS IPFCX6_RISK_TYPE_IND, \n\tlkp_ipfcx6_type_exposure AS IPFCX6_TYPE_EXPOSURE, \n\tlkp_ipfcx6_major_peril AS IPFCX6_MAJOR_PERIL, \n\tlkp_ipfcx6_sequence_type_exposure AS IPFCX6_SEQUENCE_TYPE_EXPOSURE, \n\tlkp_ipfcx6_year_item_effective AS IPFCX6_YEAR_ITEM_EFFECTIVE, \n\tlkp_ipfcx6_month_item_effective AS IPFCX6_MONTH_ITEM_EFFECTIVE, \n\tlkp_ipfcx6_day_item_effective AS IPFCX6_DAY_ITEM_EFFECTIVE, \n\tlkp_ipfcx6_year_of_loss AS IPFCX6_YEAR_OF_LOSS, \n\tlkp_ipfcx6_month_of_loss AS IPFCX6_MONTH_OF_LOSS, \n\tlkp_ipfcx6_day_of_loss AS IPFCX6_DAY_OF_LOSS, \n\tlkp_ipfcx6_loss_occ_fdigit AS IPFCX6_LOSS_OCC_FDIGIT, \n\tlkp_ipfcx6_usr_loss_occurence AS IPFCX6_USR_LOSS_OCCURENCE, \n\tlkp_ipfcx6_loss_claimant AS IPFCX6_LOSS_CLAIMANT, \n\tlkp_ipfcx6_member AS IPFCX6_MEMBER, \n\tlkp_ipfcx6_loss_disability AS IPFCX6_LOSS_DISABILITY, \n\tlkp_ipfcx6_reserve_category AS IPFCX6_RESERVE_CATEGORY, \n\tlkp_ipfcx6_layer AS IPFCX6_LAYER, \n\tlkp_ipfcx6_reins_key_id AS IPFCX6_REINS_KEY_ID, \n\tlkp_ipfcx6_reins_co_no AS IPFCX6_REINS_CO_NO, \n\tlkp_ipfcx6_reins_broker AS IPFCX6_REINS_BROKER, \n\tlkp_ipfcx6_year_process AS IPFCX6_YEAR_PROCESS, \n\tlkp_ipfcx6_month_process AS IPFCX6_MONTH_PROCESS, \n\tlkp_ipfcx6_day_process AS IPFCX6_DAY_PROCESS, \n\tlkp_ipfcx6_year_change_entry AS IPFCX6_YEAR_CHANGE_ENTRY, \n\tlkp_ipfcx6_month_change_entry AS IPFCX6_MONTH_CHANGE_ENTRY, \n\tlkp_ipfcx6_day_change_entry AS IPFCX6_DAY_CHANGE_ENTRY, \n\tlkp_ipfcx6_sequence_change_entry AS IPFCX6_SEQUENCE_CHANGE_ENTRY, \n\tlkp_ipfcx6_segment_status AS IPFCX6_SEGMENT_STATUS, \n\tlkp_ipfcx6_entry_operator AS IPFCX6_ENTRY_OPERATOR, \n\tlkp_ipfcx6_claim_type AS IPFCX6_CLAIM_TYPE, \n\tlkp_ipfcx6_loss_reported_year AS IPFCX6_LOSS_REPORTED_YEAR, \n\tlkp_ipfcx6_loss_reported_month AS IPFCX6_LOSS_REPORTED_MONTH, \n\tlkp_ipfcx6_loss_reported_day AS IPFCX6_LOSS_REPORTED_DAY, \n\tlkp_ipfcx6_loss_cause AS IPFCX6_LOSS_CAUSE, \n\tlkp_ipfcx6_loss_adjustor_no AS IPFCX6_LOSS_ADJUSTOR_NO, \n\tlkp_ipfcx6_loss_adjustor_branch AS IPFCX6_LOSS_ADJUSTOR_BRANCH, \n\tlkp_ipfcx6_loss_examiner AS IPFCX6_LOSS_EXAMINER, \n\tlkp_ipfcx6_other_assignment AS IPFCX6_OTHER_ASSIGNMENT, \n\tlkp_ipfcx6_account_entered_date AS IPFCX6_ACCOUNT_ENTERED_DATE, \n\tlkp_ipfcx6_average_reserve_code AS IPFCX6_AVERAGE_RESERVE_CODE, \n\tlkp_ipfcx6_loss_handling_office AS IPFCX6_LOSS_HANDLING_OFFICE, \n\tlkp_ipfcx6_loss_settling_office AS IPFCX6_LOSS_SETTLING_OFFICE, \n\tlkp_ipfcx6_reserve_change_ind AS IPFCX6_RESERVE_CHANGE_IND, \n\tlkp_ipfcx6_iws_claim_indicator AS IPFCX6_IWS_CLAIM_INDICATOR, \n\tlkp_ipfcx6_loss_handling_branch AS IPFCX6_LOSS_HANDLING_BRANCH, \n\tlkp_ipfcx6_loss_plant_location AS IPFCX6_LOSS_PLANT_LOCATION, \n\tlkp_ipfcx6_loss_accident_state AS IPFCX6_LOSS_ACCIDENT_STATE, \n\tlkp_ipfcx6_loss_aia_codes_1_2 AS IPFCX6_LOSS_AIA_CODES_1_2, \n\tlkp_ipfcx6_loss_aia_codes_3_4 AS IPFCX6_LOSS_AIA_CODES_3_4, \n\tlkp_ipfcx6_loss_aia_codes_5_6 AS IPFCX6_LOSS_AIA_CODES_5_6, \n\tlkp_ipfcx6_aia_sub_code AS IPFCX6_AIA_SUB_CODE, \n\tlkp_ipfcx6_loss_next_review_date AS IPFCX6_LOSS_NEXT_REVIEW_DATE, \n\tlkp_ipfcx6_claim_number_9digit AS IPFCX6_CLAIM_NUMBER_9DIGIT, \n\tlkp_ipfcx6_loss_claim_payee AS IPFCX6_LOSS_CLAIM_PAYEE, \n\tlkp_ipfcx6_excess_loss_ind AS IPFCX6_EXCESS_LOSS_IND, \n\tlkp_ipfcx6_loss_deductible AS IPFCX6_LOSS_DEDUCTIBLE, \n\tlkp_ipfcx6_loss_start_yr AS IPFCX6_LOSS_START_YR, \n\tlkp_ipfcx6_loss_start_mo AS IPFCX6_LOSS_START_MO, \n\tlkp_ipfcx6_loss_start_da AS IPFCX6_LOSS_START_DA, \n\tlkp_ipfcx6_loss_weekly_wage AS IPFCX6_LOSS_WEEKLY_WAGE, \n\tlkp_ipfcx6_loss_payment_rate AS IPFCX6_LOSS_PAYMENT_RATE, \n\tlkp_ipfcx6_loss_frequency AS IPFCX6_LOSS_FREQUENCY, \n\tlkp_ipfcx6_loss_period_pay AS IPFCX6_LOSS_PERIOD_PAY, \n\tlkp_ipfcx6_sub_line AS IPFCX6_SUB_LINE, \n\tlkp_ipfcx6_form_number AS IPFCX6_FORM_NUMBER, \n\tlkp_ipfcx6_prior_direct_loss_stat AS IPFCX6_PRIOR_DIRECT_LOSS_STAT, \n\tlkp_ipfcx6_chs_scheduled_payment AS IPFCX6_CHS_SCHEDULED_PAYMENT, \n\tlkp_sub_contractor_indicator AS SUB_CONTRACTOR_INDICATOR, \n\tlkp_ipfcx6_loss_payment_made AS IPFCX6_LOSS_PAYMENT_MADE, \n\tlkp_ipfcx6_denial_year AS IPFCX6_DENIAL_YEAR, \n\tlkp_ipfcx6_denial_month AS IPFCX6_DENIAL_MONTH, \n\tlkp_ipfcx6_denial_day AS IPFCX6_DENIAL_DAY, \n\tlkp_ipfcx6_direct_loss_status AS IPFCX6_DIRECT_LOSS_STATUS, \n\tlkp_ipfcx6_expense_status AS IPFCX6_EXPENSE_STATUS, \n\tlkp_ipfcx6_loss_recovery_status AS IPFCX6_LOSS_RECOVERY_STATUS, \n\tlkp_ipfcx6_salvage_status AS IPFCX6_SALVAGE_STATUS, \n\tlkp_ipfcx6_subrogation_status AS IPFCX6_SUBROGATION_STATUS, \n\tlkp_ipfcx6_loss_status_year AS IPFCX6_LOSS_STATUS_YEAR, \n\tlkp_ipfcx6_loss_status_month AS IPFCX6_LOSS_STATUS_MONTH, \n\tlkp_ipfcx6_loss_status_day AS IPFCX6_LOSS_STATUS_DAY, \n\tlkp_ipfcx6_loss_original_reserve AS IPFCX6_LOSS_ORIGINAL_RESERVE, \n\tlkp_ipfcx6_os_loss_reserve AS IPFCX6_OS_LOSS_RESERVE, \n\tlkp_ipfcx6_os_expense_reserve AS IPFCX6_OS_EXPENSE_RESERVE, \n\tlkp_ipfcx6_total_loss AS IPFCX6_TOTAL_LOSS, \n\tlkp_ipfcx6_total_expense AS IPFCX6_TOTAL_EXPENSE, \n\tlkp_ipfcx6_total_recoveries AS IPFCX6_TOTAL_RECOVERIES, \n\tlkp_ipfcx6_beg_os_loss_reserve AS IPFCX6_BEG_OS_LOSS_RESERVE, \n\tlkp_ipfcx6_seg_id_from_x1 AS IPFCX6_SEG_ID_FROM_X1, \n\tlkp_ipfcx6_type_claim_payee AS IPFCX6_TYPE_CLAIM_PAYEE, \n\tlkp_ipfcx6_claims_made_ind AS IPFCX6_CLAIMS_MADE_IND, \n\tlkp_ipfcx6_type_disability AS IPFCX6_TYPE_DISABILITY, \n\tlkp_ipfcx6_number_of_part78 AS IPFCX6_NUMBER_OF_PART78, \n\tlkp_ipfcx6_bank_number AS IPFCX6_BANK_NUMBER, \n\tlkp_ipfcx6_prev_reserve_status AS IPFCX6_PREV_RESERVE_STATUS, \n\tlkp_ipfcx6_offset_onset_ind AS IPFCX6_OFFSET_ONSET_IND, \n\tlkp_ipfcx6_pms_future_use_sub1 AS IPFCX6_PMS_FUTURE_USE_SUB1, \n\tlkp_ipfcx6_cust_spl_use_sub1 AS IPFCX6_CUST_SPL_USE_SUB1, \n\tlkp_inf_action AS INF_ACTION, \n\tlkp_inf_timestamp AS INF_TIMESTAMP, \n\tlogical_flag_4578 AS LOGICAL_FLAG, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tsource_system_id4 AS SOURCE_SYSTEM_ID\n\tFROM UPD_42x6_insert\n),\nEXP_CLM_Stg_Update AS (\n\tSELECT\n\tpif_42x6_stage_id AS pif_42x6_stage_id3,\n\tlogical_flag AS logical_flag3\n\tFROM RTR_CLM_STG_Update_UPDATE\n),\nUPD_42x6_update AS (\n\tSELECT\n\tpif_42x6_stage_id3, \n\tlogical_flag3\n\tFROM EXP_CLM_Stg_Update\n),\nPIF_42X6_stage_Update AS (\n\tMERGE INTO PIF_42X6_stage AS T\n\tUSING UPD_42x6_update AS S\n\tON T.pif_42x6_stage_id = S.pif_42x6_stage_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.logical_flag = S.logical_flag3\n),\nEXP_CLM_STG_Insert_dummy AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tloss_insurance_line,\n\tloss_location_number,\n\tloss_sub_location_number,\n\tloss_risk_unit_group,\n\tloss_class_code_group,\n\tloss_class_code_member,\n\tloss_unit,\n\tloss_sequence_risk_unit,\n\tloss_major_peril,\n\tloss_major_peril_seq,\n\tloss_year,\n\tloss_month,\n\tloss_day,\n\tloss_occurence,\n\t-- *INF*: IIF(LENGTH(loss_occurence)<=2,'0',SUBSTR(loss_occurence,1,1))\n\tIFF(LENGTH(loss_occurence) <= 2, '0', SUBSTR(loss_occurence, 1, 1)) AS ipfcx6_loss_occ_fdigit,\n\t-- *INF*: IIF(LENGTH(loss_occurence)>2,SUBSTR(loss_occurence,2,2),TO_CHAR(loss_occurence))\n\tIFF(LENGTH(loss_occurence) > 2, SUBSTR(loss_occurence, 2, 2), TO_CHAR(loss_occurence)) AS ipfcx6_usr_loss_occurence,\n\tloss_claimant,\n\tloss_member,\n\tloss_disability,\n\tloss_reserve_category,\n\tloss_cause,\n\tloss_offset_onset_ind,\n\tlogical_flag_insert AS logical_flag_op_insert,\n\tsysdate AS extract_date,\n\tsysdate AS as_of_date,\n\tsource_system_id,\n\t1800 AS Date_year_default,\n\t1 AS Date_month_default,\n\t1 AS Date_day_default,\n\t'N/A' AS char_default,\n\t0 AS number_default\n\tFROM RTR_CLM_STG_Update_INSERT_DUMMY\n),\nUPD_42X6_stage_Insert_dummy AS (\n\tSELECT\n\tpif_symbol, \n\tpif_policy_number, \n\tpif_module, \n\tloss_insurance_line, \n\tloss_location_number, \n\tloss_sub_location_number, \n\tloss_risk_unit_group, \n\tloss_class_code_group, \n\tloss_class_code_member, \n\tloss_unit, \n\tloss_sequence_risk_unit, \n\tloss_major_peril, \n\tloss_major_peril_seq, \n\tloss_year, \n\tloss_month, \n\tloss_day, \n\tipfcx6_loss_occ_fdigit, \n\tipfcx6_usr_loss_occurence, \n\tloss_claimant, \n\tloss_member, \n\tloss_disability, \n\tloss_reserve_category, \n\tloss_cause, \n\tloss_offset_onset_ind, \n\tlogical_flag_op_insert, \n\textract_date, \n\tas_of_date, \n\tsource_system_id, \n\tDate_year_default, \n\tDate_month_default, \n\tDate_day_default, \n\tchar_default, \n\tnumber_default\n\tFROM EXP_CLM_STG_Insert_dummy\n),\nPIF_42X6_stage_Insert_dummy AS (\n\tINSERT INTO PIF_42X6_stage\n\t(pif_symbol, pif_policy_number, pif_module, ipfcx6_insurance_line, ipfcx6_location_number, ipfcx6_sub_location_number, ipfcx6_risk_unit_group, ipfcx6_class_code_group, ipfcx6_class_code_member, ipfcx6_loss_unit, ipfcx6_risk_sequence, ipfcx6_risk_type_ind, ipfcx6_type_exposure, ipfcx6_major_peril, ipfcx6_sequence_type_exposure, ipfcx6_year_item_effective, ipfcx6_month_item_effective, ipfcx6_day_item_effective, ipfcx6_year_of_loss, ipfcx6_month_of_loss, ipfcx6_day_of_loss, ipfcx6_loss_occ_fdigit, ipfcx6_usr_loss_occurence, ipfcx6_loss_claimant, ipfcx6_member, ipfcx6_loss_disability, ipfcx6_reserve_category, ipfcx6_loss_cause, ipfcx6_offset_onset_ind, logical_flag, extract_date, as_of_date, source_system_id)\n\tSELECT \n\tPIF_SYMBOL, \n\tPIF_POLICY_NUMBER, \n\tPIF_MODULE, \n\tloss_insurance_line AS IPFCX6_INSURANCE_LINE, \n\tloss_location_number AS IPFCX6_LOCATION_NUMBER, \n\tloss_sub_location_number AS IPFCX6_SUB_LOCATION_NUMBER, \n\tloss_risk_unit_group AS IPFCX6_RISK_UNIT_GROUP, \n\tloss_class_code_group AS IPFCX6_CLASS_CODE_GROUP, \n\tloss_class_code_member AS IPFCX6_CLASS_CODE_MEMBER, \n\tloss_unit AS IPFCX6_LOSS_UNIT, \n\tloss_sequence_risk_unit AS IPFCX6_RISK_SEQUENCE, \n\tnumber_default AS IPFCX6_RISK_TYPE_IND, \n\tchar_default AS IPFCX6_TYPE_EXPOSURE, \n\tloss_major_peril AS IPFCX6_MAJOR_PERIL, \n\tloss_major_peril_seq AS IPFCX6_SEQUENCE_TYPE_EXPOSURE, \n\tDate_year_default AS IPFCX6_YEAR_ITEM_EFFECTIVE, \n\tDate_month_default AS IPFCX6_MONTH_ITEM_EFFECTIVE, \n\tDate_day_default AS IPFCX6_DAY_ITEM_EFFECTIVE, \n\tloss_year AS IPFCX6_YEAR_OF_LOSS, \n\tloss_month AS IPFCX6_MONTH_OF_LOSS, \n\tloss_day AS IPFCX6_DAY_OF_LOSS, \n\tIPFCX6_LOSS_OCC_FDIGIT, \n\tIPFCX6_USR_LOSS_OCCURENCE, \n\tloss_claimant AS IPFCX6_LOSS_CLAIMANT, \n\tloss_member AS IPFCX6_MEMBER, \n\tloss_disability AS IPFCX6_LOSS_DISABILITY, \n\tloss_reserve_category AS IPFCX6_RESERVE_CATEGORY, \n\tloss_cause AS IPFCX6_LOSS_CAUSE, \n\tloss_offset_onset_ind AS IPFCX6_OFFSET_ONSET_IND, \n\tlogical_flag_op_insert AS LOGICAL_FLAG, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tSOURCE_SYSTEM_ID\n\tFROM UPD_42X6_stage_Insert_dummy\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {},
        "folder": {
            "name": "ClaimsStaging/"
        },
        "annotations": []
    }
}