WITH
SQ_pif_4578_stage AS (
	SELECT
		pif_4578_stage_id,
		pif_symbol,
		pif_policy_number,
		pif_module,
		loss_rec_length,
		loss_action_code,
		loss_file_id,
		loss_id,
		loss_insurance_line,
		loss_location_number,
		loss_sub_location_number,
		loss_risk_unit_group,
		loss_class_code_group,
		loss_class_code_member,
		loss_unit,
		loss_sequence_risk_unit,
		loss_type_exposure,
		loss_major_peril,
		loss_major_peril_seq,
		loss_year_item_effective,
		loss_month_item_effective,
		loss_day_item_effective,
		loss_part,
		loss_year,
		loss_month,
		loss_day,
		loss_occurence,
		loss_claimant,
		loss_member,
		loss_disability,
		loss_reserve_category,
		loss_layer,
		loss_reins_key_id,
		loss_reins_co_no,
		loss_reins_broker,
		loss_base_transaction,
		loss_transaction,
		loss_draft_control_seq,
		loss_sub_part_code,
		loss_segment_status,
		loss_entry_operator,
		loss_transaction_category,
		loss_year_reported,
		loss_month_reported,
		loss_day_reported,
		loss_cause,
		loss_adjustor_no,
		loss_examiner,
		loss_cost_containment,
		loss_paid_or_resv_amt,
		loss_bank_number,
		loss_draft_amount,
		loss_draft_no,
		loss_draft_check_ind,
		loss_transaction_date,
		loss_draft_pay_to_1,
		loss_draft_pay_to_2,
		loss_draft_pay_to_3,
		loss_draft_mail_to,
		loss_net_change_dollars,
		loss_account_entered_date,
		loss_average_reserve_code,
		loss_handling_office,
		loss_start_yr,
		loss_start_mo,
		loss_start_da,
		loss_fault_code,
		tc,
		ia,
		loss_payment_rate,
		loss_frequency,
		loss_period_pay,
		loss_sub_line,
		loss_payee_phrase,
		loss_memo_phrase,
		iws_origin_indicator,
		loss_aia_codes_1_2,
		loss_aia_codes_3_4,
		loss_aia_codes_5_6,
		loss_aia_sub_code,
		loss_accident_state,
		loss_handling_branch,
		loss_1099_number,
		loss_claim_payee,
		loss_claim_payee_name,
		loss_notes_draft_payee,
		loss_claim_number,
		loss_type_claim_payee,
		loss_zpcd_inj_loc,
		loss_special_use_1,
		loss_special_use_2,
		loss_time,
		loss_type_disability,
		loss_claims_made_ind,
		loss_misc_adjustor_ind,
		loss_pms_future_use,
		loss_offset_onset_ind,
		loss_sub_cont_id,
		loss_rpt_year,
		loss_rpt_mon,
		loss_rpt_day,
		loss_s3_transaction_date,
		loss_rr_reported_date,
		loss_yr2000_cust_use,
		loss_duplicate_key_sequence,
		inf_action,
		inf_timestamp,
		logical_flag,
		extract_date,
		as_of_date,
		record_count,
		source_system_id
	FROM pif_4578_stage
),
EXP_arch_PIF_4578_stage AS (
	SELECT
	pif_4578_stage_id,
	pif_symbol,
	pif_policy_number,
	pif_module,
	loss_rec_length,
	loss_action_code,
	loss_file_id,
	loss_id,
	loss_insurance_line,
	loss_location_number,
	loss_sub_location_number,
	loss_risk_unit_group,
	loss_class_code_group,
	loss_class_code_member,
	loss_unit,
	loss_sequence_risk_unit,
	loss_type_exposure,
	loss_major_peril,
	loss_major_peril_seq,
	loss_year_item_effective,
	loss_month_item_effective,
	loss_day_item_effective,
	loss_part,
	loss_year,
	loss_month,
	loss_day,
	loss_occurence,
	loss_claimant,
	loss_member,
	loss_disability,
	loss_reserve_category,
	loss_layer,
	loss_reins_key_id,
	loss_reins_co_no,
	loss_reins_broker,
	loss_base_transaction,
	loss_transaction,
	loss_draft_control_seq,
	loss_sub_part_code,
	loss_segment_status,
	loss_entry_operator,
	loss_transaction_category,
	loss_year_reported,
	loss_month_reported,
	loss_day_reported,
	loss_cause,
	loss_adjustor_no,
	loss_examiner,
	loss_cost_containment,
	loss_paid_or_resv_amt,
	loss_bank_number,
	loss_draft_amount,
	loss_draft_no,
	loss_draft_check_ind,
	loss_transaction_date,
	loss_draft_pay_to_1,
	loss_draft_pay_to_2,
	loss_draft_pay_to_3,
	loss_draft_mail_to,
	loss_net_change_dollars,
	loss_account_entered_date,
	loss_average_reserve_code,
	loss_handling_office,
	loss_start_yr,
	loss_start_mo,
	loss_start_da,
	loss_fault_code,
	tc,
	ia,
	loss_payment_rate,
	loss_frequency,
	loss_period_pay,
	loss_sub_line,
	loss_payee_phrase,
	loss_memo_phrase,
	iws_origin_indicator,
	loss_aia_codes_1_2,
	loss_aia_codes_3_4,
	loss_aia_codes_5_6,
	loss_aia_sub_code,
	loss_accident_state,
	loss_handling_branch,
	loss_1099_number,
	loss_claim_payee,
	loss_claim_payee_name,
	loss_notes_draft_payee,
	loss_claim_number,
	loss_type_claim_payee,
	loss_zpcd_inj_loc,
	loss_special_use_1,
	loss_special_use_2,
	loss_time,
	loss_type_disability,
	loss_claims_made_ind,
	loss_misc_adjustor_ind,
	loss_pms_future_use,
	loss_offset_onset_ind,
	loss_sub_cont_id,
	loss_rpt_year,
	loss_rpt_mon,
	loss_rpt_day,
	loss_s3_transaction_date,
	loss_rr_reported_date,
	loss_yr2000_cust_use,
	loss_duplicate_key_sequence,
	inf_action,
	inf_timestamp,
	logical_flag,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_pif_4578_stage
),
arch_PIF_4578_stage AS (
	INSERT INTO arch_PIF_4578_stage
	(pif_4578_stage_id, pif_symbol, pif_policy_number, pif_module, loss_rec_length, loss_action_code, loss_file_id, loss_id, loss_insurance_line, loss_location_number, loss_sub_location_number, loss_risk_unit_group, loss_class_code_group, loss_class_code_member, loss_unit, loss_sequence_risk_unit, loss_type_exposure, loss_major_peril, loss_major_peril_seq, loss_year_item_effective, loss_month_item_effective, loss_day_item_effective, loss_part, loss_year, loss_month, loss_day, loss_occurence, loss_claimant, loss_member, loss_disability, loss_reserve_category, loss_layer, loss_reins_key_id, loss_reins_co_no, loss_reins_broker, loss_base_transaction, loss_transaction, loss_draft_control_seq, loss_sub_part_code, loss_segment_status, loss_entry_operator, loss_transaction_category, loss_year_reported, loss_month_reported, loss_day_reported, loss_cause, loss_adjustor_no, loss_examiner, loss_cost_containment, loss_paid_or_resv_amt, loss_bank_number, loss_draft_amount, loss_draft_no, loss_draft_check_ind, loss_transaction_date, loss_draft_pay_to_1, loss_draft_pay_to_2, loss_draft_pay_to_3, loss_draft_mail_to, loss_net_change_dollars, loss_account_entered_date, loss_average_reserve_code, loss_handling_office, loss_start_yr, loss_start_mo, loss_start_da, loss_fault_code, tc, ia, loss_payment_rate, loss_frequency, loss_period_pay, loss_sub_line, loss_payee_phrase, loss_memo_phrase, iws_origin_indicator, loss_aia_codes_1_2, loss_aia_codes_3_4, loss_aia_codes_5_6, loss_aia_sub_code, loss_accident_state, loss_handling_branch, loss_1099_number, loss_claim_payee, loss_claim_payee_name, loss_notes_draft_payee, loss_claim_number, loss_type_claim_payee, loss_zpcd_inj_loc, loss_special_use_1, loss_special_use_2, loss_time, loss_type_disability, loss_claims_made_ind, loss_misc_adjustor_ind, loss_pms_future_use, loss_offset_onset_ind, loss_sub_cont_id, loss_rpt_year, loss_rpt_mon, loss_rpt_day, loss_s3_transaction_date, loss_rr_reported_date, loss_yr2000_cust_use, loss_duplicate_key_sequence, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	PIF_4578_STAGE_ID, 
	PIF_SYMBOL, 
	PIF_POLICY_NUMBER, 
	PIF_MODULE, 
	LOSS_REC_LENGTH, 
	LOSS_ACTION_CODE, 
	LOSS_FILE_ID, 
	LOSS_ID, 
	LOSS_INSURANCE_LINE, 
	LOSS_LOCATION_NUMBER, 
	LOSS_SUB_LOCATION_NUMBER, 
	LOSS_RISK_UNIT_GROUP, 
	LOSS_CLASS_CODE_GROUP, 
	LOSS_CLASS_CODE_MEMBER, 
	LOSS_UNIT, 
	LOSS_SEQUENCE_RISK_UNIT, 
	LOSS_TYPE_EXPOSURE, 
	LOSS_MAJOR_PERIL, 
	LOSS_MAJOR_PERIL_SEQ, 
	LOSS_YEAR_ITEM_EFFECTIVE, 
	LOSS_MONTH_ITEM_EFFECTIVE, 
	LOSS_DAY_ITEM_EFFECTIVE, 
	LOSS_PART, 
	LOSS_YEAR, 
	LOSS_MONTH, 
	LOSS_DAY, 
	LOSS_OCCURENCE, 
	LOSS_CLAIMANT, 
	LOSS_MEMBER, 
	LOSS_DISABILITY, 
	LOSS_RESERVE_CATEGORY, 
	LOSS_LAYER, 
	LOSS_REINS_KEY_ID, 
	LOSS_REINS_CO_NO, 
	LOSS_REINS_BROKER, 
	LOSS_BASE_TRANSACTION, 
	LOSS_TRANSACTION, 
	LOSS_DRAFT_CONTROL_SEQ, 
	LOSS_SUB_PART_CODE, 
	LOSS_SEGMENT_STATUS, 
	LOSS_ENTRY_OPERATOR, 
	LOSS_TRANSACTION_CATEGORY, 
	LOSS_YEAR_REPORTED, 
	LOSS_MONTH_REPORTED, 
	LOSS_DAY_REPORTED, 
	LOSS_CAUSE, 
	LOSS_ADJUSTOR_NO, 
	LOSS_EXAMINER, 
	LOSS_COST_CONTAINMENT, 
	LOSS_PAID_OR_RESV_AMT, 
	LOSS_BANK_NUMBER, 
	LOSS_DRAFT_AMOUNT, 
	LOSS_DRAFT_NO, 
	LOSS_DRAFT_CHECK_IND, 
	LOSS_TRANSACTION_DATE, 
	LOSS_DRAFT_PAY_TO_1, 
	LOSS_DRAFT_PAY_TO_2, 
	LOSS_DRAFT_PAY_TO_3, 
	LOSS_DRAFT_MAIL_TO, 
	LOSS_NET_CHANGE_DOLLARS, 
	LOSS_ACCOUNT_ENTERED_DATE, 
	LOSS_AVERAGE_RESERVE_CODE, 
	LOSS_HANDLING_OFFICE, 
	LOSS_START_YR, 
	LOSS_START_MO, 
	LOSS_START_DA, 
	LOSS_FAULT_CODE, 
	TC, 
	IA, 
	LOSS_PAYMENT_RATE, 
	LOSS_FREQUENCY, 
	LOSS_PERIOD_PAY, 
	LOSS_SUB_LINE, 
	LOSS_PAYEE_PHRASE, 
	LOSS_MEMO_PHRASE, 
	IWS_ORIGIN_INDICATOR, 
	LOSS_AIA_CODES_1_2, 
	LOSS_AIA_CODES_3_4, 
	LOSS_AIA_CODES_5_6, 
	LOSS_AIA_SUB_CODE, 
	LOSS_ACCIDENT_STATE, 
	LOSS_HANDLING_BRANCH, 
	LOSS_1099_NUMBER, 
	LOSS_CLAIM_PAYEE, 
	LOSS_CLAIM_PAYEE_NAME, 
	LOSS_NOTES_DRAFT_PAYEE, 
	LOSS_CLAIM_NUMBER, 
	LOSS_TYPE_CLAIM_PAYEE, 
	LOSS_ZPCD_INJ_LOC, 
	LOSS_SPECIAL_USE_1, 
	LOSS_SPECIAL_USE_2, 
	LOSS_TIME, 
	LOSS_TYPE_DISABILITY, 
	LOSS_CLAIMS_MADE_IND, 
	LOSS_MISC_ADJUSTOR_IND, 
	LOSS_PMS_FUTURE_USE, 
	LOSS_OFFSET_ONSET_IND, 
	LOSS_SUB_CONT_ID, 
	LOSS_RPT_YEAR, 
	LOSS_RPT_MON, 
	LOSS_RPT_DAY, 
	LOSS_S3_TRANSACTION_DATE, 
	LOSS_RR_REPORTED_DATE, 
	LOSS_YR2000_CUST_USE, 
	LOSS_DUPLICATE_KEY_SEQUENCE, 
	INF_ACTION, 
	INF_TIMESTAMP, 
	LOGICAL_FLAG, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_arch_PIF_4578_stage
),