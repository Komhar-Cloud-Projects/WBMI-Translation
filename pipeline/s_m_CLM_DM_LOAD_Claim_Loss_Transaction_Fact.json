{
    "name": "s_m_CLM_DM_LOAD_Claim_Loss_Transaction_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Loss_Transaction_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Claim_Transaction AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tcause_of_loss,\n\treserve_ctgry,\n\ttype_disability,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaimant_cov_det_ak_id,\n\t\t\tcause_of_loss,\n\t\t\treserve_ctgry,\n\t\t\ttype_disability,\n\t\t\tfinancial_type_code,\n\t\t\ttrans_code,\n\t\t\ttrans_date\n\t\tFROM claim_transaction\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,cause_of_loss,reserve_ctgry,type_disability,financial_type_code,trans_code,trans_date ORDER BY claimant_cov_det_ak_id) = 1\n),\nLKP_calender_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nLKP_Claim_payment_dim AS (\n\tSELECT\n\tclaim_pay_dim_id,\n\tedw_claim_pay_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_dim_id,\n\t\t\tedw_claim_pay_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_payment_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_pay_ak_id,eff_from_date,eff_to_date ORDER BY claim_pay_dim_id DESC) = 1\n),\nLKP_claim_master_1099_list_dim AS (\n\tSELECT\n\tclaim_master_1099_list_dim_id,\n\tedw_claim_master_1099_list_ak_id\n\tFROM (\n\t\tSELECT \r\n\t\tclaim_master_1099_list_dim.claim_master_1099_list_dim_id as claim_master_1099_list_dim_id, \r\n\t\tclaim_master_1099_list_dim.edw_claim_master_1099_list_ak_id as edw_claim_master_1099_list_ak_id \r\n\t\tFROM \r\n\t\tclaim_master_1099_list_dim\r\n\t\twhere\r\n\t\tclaim_master_1099_list_dim.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_master_1099_list_ak_id ORDER BY claim_master_1099_list_dim_id) = 1\n),\nLKP_claim_rep_dim_alt AS (\n\tSELECT\n\tclaim_rep_dim_id,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT \r\n\t\tcrd.claim_rep_dim_id as claim_rep_dim_id,\r\n\t\tcrd.eff_from_date as eff_from_date,\r\n\t\tcrd.eff_to_date as eff_to_date,\r\n\t\tccd.claimant_cov_det_ak_id as claimant_cov_det_ak_id\r\n\t\tFROM   RPT_EDM..claim_transaction CT\r\n\t\tjoin RPT_EDM..claimant_coverage_detail ccd on ct.claimant_cov_det_ak_id = ccd.claimant_cov_det_ak_id and ccd.crrnt_snpsht_flag = 1 \r\n\t\tand ccd.eff_from_date <= '12/31/2100 23:59:59' and ccd.eff_to_date >= '12/31/2100 23:59:59'\r\n\t\tjoin RPT_EDM..claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = ccd.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1\r\n\t\tand cpo.eff_from_date <= '12/31/2100 23:59:59' and cpo.eff_to_date >= '12/31/2100 23:59:59'\r\n\t\tjoin RPT_EDM..claim_occurrence co on co.claim_occurrence_ak_id = cpo.claim_occurrence_ak_id and co.crrnt_snpsht_flag = 1\r\n\t\tand co.eff_from_date <= '12/31/2100 23:59:59' and co.eff_to_date >= '12/31/2100 23:59:59'\r\n\t\tjoin RPT_EDM..claim_representative_occurrence cro on cro.claim_occurrence_ak_id = co.claim_occurrence_ak_id and cro.crrnt_snpsht_flag =1\r\n\t\tand cro.eff_from_date <= '12/31/2100 23:59:59' and cro.eff_to_date >= '12/31/2100 23:59:59' and LTRIM(RTRIM(cro.claim_rep_role_code))  = 'H'\r\n\t\tjoin WC_Data_Mart..claim_representative_dim crd on cro.claim_rep_ak_id = crd.edw_claim_rep_ak_id\r\n\t\tand crd.eff_from_date <= '12/31/2100 23:59:59' and crd.eff_to_date >= '12/31/2100 23:59:59'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY claim_rep_dim_id DESC) = 1\n),\nSQ_claim_transaction AS (\n\tSELECT CT.claim_trans_id,\r\n\t       CT.claimant_cov_det_ak_id,\r\n\t       CT.claim_pay_ak_id,\r\n\t       CT.cause_of_loss,\r\n\t       CT.reserve_ctgry,\r\n\t       CT.type_disability,\r\n\t       CT.offset_onset_ind,\r\n\t       CT.financial_type_code,\r\n\t       CT.s3p_trans_code, \r\n\t       CT.pms_trans_code,\r\n\t       CT.trans_code,\r\n\t       CT.trans_date,\r\n\t       CT.pms_acct_entered_date,\r\n\t       CT.trans_base_type_code,\r\n\t       CT.trans_ctgry_code,\r\n\t       CT.trans_amt,\r\n\t       CT.trans_hist_amt,\r\n\t       CT.trans_rsn,\r\n\t       CT.reprocess_date,\r\n\t       CT.trans_entry_oper_id,\r\n\t       CT.source_sys_id,\r\n\t       CT.tax_id,\r\n\t       CT.claim_master_1099_list_ak_id\r\n\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_transaction CT\r\n\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\r\n\tAND CT.claim_trans_id % @{pipeline().parameters.NUM_OF_PARTITIONS} = 1\r\n\t\r\n\t--- We need to pull only Onset Transactions into Claim_Loss_Transaction_Fact\n\t\n\tUNION ALL\n\tSELECT CT.claim_trans_id,\r\n\t       CT.claimant_cov_det_ak_id,\r\n\t       CT.claim_pay_ak_id,\r\n\t       CT.cause_of_loss,\r\n\t       CT.reserve_ctgry,\r\n\t       CT.type_disability,\r\n\t       CT.offset_onset_ind,\r\n\t       CT.financial_type_code,\r\n\t       CT.s3p_trans_code, \r\n\t       CT.pms_trans_code,\r\n\t       CT.trans_code,\r\n\t       CT.trans_date,\r\n\t       CT.pms_acct_entered_date,\r\n\t       CT.trans_base_type_code,\r\n\t       CT.trans_ctgry_code,\r\n\t       CT.trans_amt,\r\n\t       CT.trans_hist_amt,\r\n\t       CT.trans_rsn,\r\n\t       CT.reprocess_date,\r\n\t       CT.trans_entry_oper_id,\r\n\t       CT.source_sys_id,\r\n\t       CT.tax_id,\r\n\t       CT.claim_master_1099_list_ak_id\r\n\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_transaction CT\r\n\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\r\n\tAND CT.claim_trans_id % @{pipeline().parameters.NUM_OF_PARTITIONS} = 2\r\n\t\r\n\t--- We need to pull only Onset Transactions into Claim_Loss_Transaction_Fact\n\t\n\tUNION ALL\n\tSELECT CT.claim_trans_id,\r\n\t       CT.claimant_cov_det_ak_id,\r\n\t       CT.claim_pay_ak_id,\r\n\t       CT.cause_of_loss,\r\n\t       CT.reserve_ctgry,\r\n\t       CT.type_disability,\r\n\t       CT.offset_onset_ind,\r\n\t       CT.financial_type_code,\r\n\t       CT.s3p_trans_code, \r\n\t       CT.pms_trans_code,\r\n\t       CT.trans_code,\r\n\t       CT.trans_date,\r\n\t       CT.pms_acct_entered_date,\r\n\t       CT.trans_base_type_code,\r\n\t       CT.trans_ctgry_code,\r\n\t       CT.trans_amt,\r\n\t       CT.trans_hist_amt,\r\n\t       CT.trans_rsn,\r\n\t       CT.reprocess_date,\r\n\t       CT.trans_entry_oper_id,\r\n\t       CT.source_sys_id,\r\n\t       CT.tax_id,\r\n\t       CT.claim_master_1099_list_ak_id\r\n\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_transaction CT\r\n\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\r\n\tAND CT.claim_trans_id % @{pipeline().parameters.NUM_OF_PARTITIONS} = 3\r\n\t\r\n\t--- We need to pull only Onset Transactions into Claim_Loss_Transaction_Fact\n\t\n\tUNION ALL\n\tSELECT CT.claim_trans_id,\r\n\t       CT.claimant_cov_det_ak_id,\r\n\t       CT.claim_pay_ak_id,\r\n\t       CT.cause_of_loss,\r\n\t       CT.reserve_ctgry,\r\n\t       CT.type_disability,\r\n\t       CT.offset_onset_ind,\r\n\t       CT.financial_type_code,\r\n\t       CT.s3p_trans_code, \r\n\t       CT.pms_trans_code,\r\n\t       CT.trans_code,\r\n\t       CT.trans_date,\r\n\t       CT.pms_acct_entered_date,\r\n\t       CT.trans_base_type_code,\r\n\t       CT.trans_ctgry_code,\r\n\t       CT.trans_amt,\r\n\t       CT.trans_hist_amt,\r\n\t       CT.trans_rsn,\r\n\t       CT.reprocess_date,\r\n\t       CT.trans_entry_oper_id,\r\n\t       CT.source_sys_id,\r\n\t       CT.tax_id,\r\n\t       CT.claim_master_1099_list_ak_id\r\n\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_transaction CT\r\n\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\r\n\tAND CT.claim_trans_id % @{pipeline().parameters.NUM_OF_PARTITIONS} = 4\r\n\t\r\n\t--- We need to pull only Onset Transactions into Claim_Loss_Transaction_Fact\n),\nEXP_Default AS (\n\tSELECT\n\tclaim_trans_id,\n\tclaimant_cov_det_ak_id,\n\tclaim_pay_ak_id,\n\tcause_of_loss,\n\treserve_ctgry,\n\ttype_disability,\n\toffset_onset_ind,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date,\n\tpms_acct_entered_date,\n\ttrans_base_type_code,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\ttrans_rsn,\n\treprocess_date,\n\ttrans_entry_oper_id,\n\tsource_sys_id,\n\ttax_id,\n\tclaim_master_1099_list_ak_id,\n\ts3p_trans_code,\n\tpms_trans_code\n\tFROM SQ_claim_transaction\n),\nEXP_get_values AS (\n\tSELECT\n\tclaim_trans_id,\n\tclaimant_cov_det_ak_id,\n\tclaim_pay_ak_id,\n\tcause_of_loss,\n\treserve_ctgry,\n\ttype_disability,\n\toffset_onset_ind,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_date,\n\t-- *INF*: to_date('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date,\n\t-- *INF*: SET_DATE_PART(\r\n\t--   SET_DATE_PART(\r\n\t--     SET_DATE_PART(LAST_DAY(trans_date),'HH',23),\r\n\t--   'MI',59),\r\n\t-- 'SS',59)\n\tDATEADD(SECOND,59-DATE_PART(SECOND,DATEADD(MINUTE,59-DATE_PART(MINUTE,DATEADD(HOUR,23-DATE_PART(HOUR,LAST_DAY(trans_date)),LAST_DAY(trans_date))),DATEADD(HOUR,23-DATE_PART(HOUR,LAST_DAY(trans_date)),LAST_DAY(trans_date)))),DATEADD(MINUTE,59-DATE_PART(MINUTE,DATEADD(HOUR,23-DATE_PART(HOUR,LAST_DAY(trans_date)),LAST_DAY(trans_date))),DATEADD(HOUR,23-DATE_PART(HOUR,LAST_DAY(trans_date)),LAST_DAY(trans_date)))) AS OUT_trans_date_month_end,\n\tv_trans_date AS trans_date_out,\n\tpms_acct_entered_date,\n\ttrans_base_type_code,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\ttrans_rsn,\n\treprocess_date,\n\ttrans_entry_oper_id,\n\tsource_sys_id,\n\t-- *INF*: :LKP.LKP_CLAIM_PAYMENT_DIM(claim_pay_ak_id, v_trans_date)\n\tLKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_v_trans_date.claim_pay_dim_id AS v_claim_payment_dim_id,\n\tv_claim_payment_dim_id AS claim_payment_dim_id,\n\t-- *INF*: :LKP.LKP_CLAIM_PAYMENT_DIM(claim_pay_ak_id, trans_date)\n\tLKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_trans_date.claim_pay_dim_id AS v_claim_payment_dim_hist_id,\n\tv_claim_payment_dim_hist_id AS claim_payment_dim_hist_id,\n\ttax_id AS IN_tax_id,\n\tclaim_master_1099_list_ak_id AS IN_claim_master_1099_list_ak_id,\n\t-- *INF*: LTRIM(RTRIM(IN_tax_id))\n\tLTRIM(RTRIM(IN_tax_id)) AS v_tax_id,\n\t-- *INF*: :LKP.LKP_CLAIM_MASTER_1099_LIST_DIM(IN_claim_master_1099_list_ak_id)\n\tLKP_CLAIM_MASTER_1099_LIST_DIM_IN_claim_master_1099_list_ak_id.claim_master_1099_list_dim_id AS v_claim_master_1099_list_dim_id,\n\tv_tax_id AS tax_id,\n\tv_claim_master_1099_list_dim_id AS claim_master_1099_list_dim_id,\n\t'D' AS trans_kind_code,\n\ts3p_trans_code,\n\tpms_trans_code\n\tFROM EXP_Default\n\tLEFT JOIN LKP_CLAIM_PAYMENT_DIM LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_v_trans_date\n\tON LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_v_trans_date.edw_claim_pay_ak_id = claim_pay_ak_id\n\tAND LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_v_trans_date.eff_from_date = v_trans_date\n\n\tLEFT JOIN LKP_CLAIM_PAYMENT_DIM LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_trans_date\n\tON LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_trans_date.edw_claim_pay_ak_id = claim_pay_ak_id\n\tAND LKP_CLAIM_PAYMENT_DIM_claim_pay_ak_id_trans_date.eff_from_date = trans_date\n\n\tLEFT JOIN LKP_CLAIM_MASTER_1099_LIST_DIM LKP_CLAIM_MASTER_1099_LIST_DIM_IN_claim_master_1099_list_ak_id\n\tON LKP_CLAIM_MASTER_1099_LIST_DIM_IN_claim_master_1099_list_ak_id.edw_claim_master_1099_list_ak_id = IN_claim_master_1099_list_ak_id\n\n),\nLKP_ClaimFeature AS (\n\tSELECT\n\tClaimRepresentativeAkId,\n\tFeatureRepresentativeAssignedDate,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT CF.ClaimRepresentativeAkId as ClaimRepresentativeAkId, \r\n\t\tCF.FeatureRepresentativeAssignedDate as FeatureRepresentativeAssignedDate, \r\n\t\tCCD.claimant_cov_det_ak_id as claimant_cov_det_ak_id \r\n\t\tFROM ClaimFeature CF\r\n\t\tINNER JOIN dbo.claimant_coverage_detail CCD\r\n\t\tON CF.ClaimPartyOccurrenceAKId = CCD.claim_party_occurrence_ak_id\r\n\t\t\tand CF.MajorPerilCode = CCD.major_peril_code\r\n\t\t\tand CF.CauseOfLoss = CCD.cause_of_loss\r\n\t\t\tand CF.ReserveCategory = CCD.reserve_ctgry\r\n\t\t\tand CF.CurrentSnapshotFlag = 1\r\n\t\t\tand CCD.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY ClaimRepresentativeAkId DESC) = 1\n),\nLKP_claim_financial_type_dim AS (\n\tSELECT\n\tclaim_financial_type_dim_id,\n\tfinancial_type_code\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_financial_type_dim_id,\n\t\t\tfinancial_type_code\n\t\tFROM claim_financial_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY financial_type_code ORDER BY claim_financial_type_dim_id) = 1\n),\nLKP_claim_rep_dim_id AS (\n\tSELECT\n\tclaim_rep_dim_id,\n\tedw_claim_rep_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_rep_dim_id,\n\t\t\tedw_claim_rep_ak_id\n\t\tFROM claim_representative_dim\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_rep_ak_id ORDER BY claim_rep_dim_id) = 1\n),\nLKP_claim_subrogation_dim AS (\n\tSELECT\n\tclaim_subrogation_dim_id,\n\treferred_to_subrogation_date,\n\tpay_start_date,\n\tclosure_date,\n\tedw_claimant_cov_det_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_subrogation_dim_id,\n\t\t\treferred_to_subrogation_date,\n\t\t\tpay_start_date,\n\t\t\tclosure_date,\n\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM claim_subrogation_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_subrogation_dim_id) = 1\n),\nLKP_claim_transaction_type_dim AS (\n\tSELECT\n\tclaim_trans_type_dim_id,\n\ttrans_ctgry_code,\n\ttrans_code,\n\ts3p_trans_code,\n\tpms_trans_code,\n\ttrans_base_type_code,\n\ttrans_rsn,\n\ttrans_kind_code,\n\toffset_onset_ind,\n\ttype_disability\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_trans_type_dim_id,\n\t\t\ttrans_ctgry_code,\n\t\t\ttrans_code,\n\t\t\ts3p_trans_code,\n\t\t\tpms_trans_code,\n\t\t\ttrans_base_type_code,\n\t\t\ttrans_rsn,\n\t\t\ttrans_kind_code,\n\t\t\toffset_onset_ind,\n\t\t\ttype_disability\n\t\tFROM claim_transaction_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY trans_ctgry_code,trans_code,s3p_trans_code,pms_trans_code,trans_base_type_code,trans_rsn,trans_kind_code,offset_onset_ind,type_disability ORDER BY claim_trans_type_dim_id DESC) = 1\n),\nmplt_ClaimReserveDim AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_Get_Values AS (\n\t\tSELECT\n\t\tclaimant_coverage_detail_ak_id AS ClaimantCoverageDetailAkId,\n\t\tfinancial_type_code AS in_FinancialTypeCode,\n\t\t-- *INF*: RTRIM(in_FinancialTypeCode)\n\t\tRTRIM(in_FinancialTypeCode) AS out_FinancialTypeCode\n\t\tFROM INPUT\n\t),\n\tLKP_Existing_Reserve AS (\n\t\tSELECT\n\t\tClaimReserveDimId,\n\t\tReserveOpenDate,\n\t\tReserveCloseDate,\n\t\tReserveReopenDate,\n\t\tReserveCloseAfterReopenDate,\n\t\tFirstPaymentDate,\n\t\tEDWClaimantCoverageDetailAKId,\n\t\tFinancialTypeCode\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tClaimReserveDimId,\n\t\t\t\tReserveOpenDate,\n\t\t\t\tReserveCloseDate,\n\t\t\t\tReserveReopenDate,\n\t\t\t\tReserveCloseAfterReopenDate,\n\t\t\t\tFirstPaymentDate,\n\t\t\t\tEDWClaimantCoverageDetailAKId,\n\t\t\t\tFinancialTypeCode\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.ClaimReserveDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWClaimantCoverageDetailAKId,FinancialTypeCode ORDER BY ClaimReserveDimId DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tClaimReserveDimId, \n\t\tReserveOpenDate, \n\t\tReserveCloseDate, \n\t\tReserveReopenDate, \n\t\tReserveCloseAfterReopenDate, \n\t\tFirstPaymentDate\n\t\tFROM LKP_Existing_Reserve\n\t),\n),\nmplt_claimant_coverage_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_CLAIMANT_COV_DIM AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaimant_cov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claimant_cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id\n\t\tFROM LKP_CLAIMANT_COV_DIM\n\t),\n),\nmplt_claimant_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_CLAIMANT_COV_DIM AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaimant_cov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claimant_cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id\n\t\tFROM LKP_CLAIMANT_COV_DIM\n\t),\n),\nmplt_coverage_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nmplt_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nEXP_Cov_Level_dim_ids AS (\n\tSELECT\n\tmplt_claimant_coverage_dim_id.claimant_cov_dim_id,\n\tmplt_claimant_coverage_dim_hist_id.claimant_cov_dim_id AS claimant_cov_dim_hist_id,\n\tmplt_coverage_dim_id.cov_dim_id,\n\tmplt_coverage_dim_hist_id.cov_dim_id AS cov_dim_hist_id,\n\tLKP_claim_transaction_type_dim.claim_trans_type_dim_id,\n\tLKP_claim_financial_type_dim.claim_financial_type_dim_id,\n\tEXP_get_values.claim_payment_dim_id,\n\tEXP_get_values.claim_payment_dim_hist_id,\n\tEXP_get_values.tax_id,\n\tEXP_get_values.claim_master_1099_list_dim_id,\n\tLKP_claim_subrogation_dim.claim_subrogation_dim_id,\n\tEXP_get_values.trans_date,\n\tEXP_get_values.OUT_trans_date_month_end AS trans_date_month_end,\n\tEXP_get_values.claim_trans_id,\n\tEXP_get_values.claimant_cov_det_ak_id AS IN_claimant_cov_det_ak_id,\n\tEXP_get_values.cause_of_loss AS IN_cause_of_loss,\n\tEXP_get_values.reserve_ctgry AS IN_reserve_ctgry,\n\tEXP_get_values.type_disability AS IN_type_disability,\n\tEXP_get_values.financial_type_code,\n\tEXP_get_values.trans_code,\n\tEXP_get_values.trans_ctgry_code,\n\tEXP_get_values.trans_amt,\n\tEXP_get_values.trans_hist_amt,\n\tEXP_get_values.source_sys_id,\n\tLKP_claim_subrogation_dim.referred_to_subrogation_date,\n\tLKP_claim_subrogation_dim.pay_start_date,\n\tLKP_claim_subrogation_dim.closure_date,\n\tEXP_get_values.claim_pay_ak_id,\n\tEXP_get_values.reprocess_date,\n\tEXP_get_values.trans_date_out,\n\tEXP_get_values.pms_acct_entered_date,\n\tmplt_ClaimReserveDim.ClaimReserveDimId,\n\tLKP_claim_rep_dim_id.claim_rep_dim_id AS FeatureRepresentativeDimId,\n\tLKP_ClaimFeature.FeatureRepresentativeAssignedDate\n\tFROM EXP_get_values\n\t -- Manually join with mplt_ClaimReserveDim\n\t -- Manually join with mplt_claimant_coverage_dim_hist_id\n\t -- Manually join with mplt_claimant_coverage_dim_id\n\t -- Manually join with mplt_coverage_dim_hist_id\n\t -- Manually join with mplt_coverage_dim_id\n\tLEFT JOIN LKP_ClaimFeature\n\tON LKP_ClaimFeature.claimant_cov_det_ak_id = EXP_get_values.claimant_cov_det_ak_id\n\tLEFT JOIN LKP_claim_financial_type_dim\n\tON LKP_claim_financial_type_dim.financial_type_code = EXP_get_values.financial_type_code\n\tLEFT JOIN LKP_claim_rep_dim_id\n\tON LKP_claim_rep_dim_id.edw_claim_rep_ak_id = LKP_ClaimFeature.ClaimRepresentativeAkId\n\tLEFT JOIN LKP_claim_subrogation_dim\n\tON LKP_claim_subrogation_dim.edw_claimant_cov_det_ak_id = EXP_get_values.claimant_cov_det_ak_id AND LKP_claim_subrogation_dim.eff_from_date <= EXP_get_values.trans_date_out AND LKP_claim_subrogation_dim.eff_to_date >= EXP_get_values.trans_date_out\n\tLEFT JOIN LKP_claim_transaction_type_dim\n\tON LKP_claim_transaction_type_dim.trans_ctgry_code = EXP_get_values.trans_ctgry_code AND LKP_claim_transaction_type_dim.trans_code = EXP_get_values.trans_code AND LKP_claim_transaction_type_dim.s3p_trans_code = EXP_get_values.s3p_trans_code AND LKP_claim_transaction_type_dim.pms_trans_code = EXP_get_values.pms_trans_code AND LKP_claim_transaction_type_dim.trans_base_type_code = EXP_get_values.trans_base_type_code AND LKP_claim_transaction_type_dim.trans_rsn = EXP_get_values.trans_rsn AND LKP_claim_transaction_type_dim.trans_kind_code = EXP_get_values.trans_kind_code AND LKP_claim_transaction_type_dim.offset_onset_ind = EXP_get_values.offset_onset_ind AND LKP_claim_transaction_type_dim.type_disability = EXP_get_values.type_disability\n),\nmplt_Claim_Payment_Category_type_Dim_hist_id AS (WITH\n\tInput AS (\n\t\t\n\t),\n\tEXP_Get_Values AS (\n\t\tSELECT\n\t\tIN_Claim_Pay_AK_ID,\n\t\tIN_trans_date\n\t\tFROM Input\n\t),\n\tLKP_Claim_Payment_Category AS (\n\t\tSELECT\n\t\tclaim_pay_ctgry_ak_id,\n\t\tclaim_pay_ak_id,\n\t\tclaim_pay_ctgry_type,\n\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_payment_category.claim_pay_ctgry_ak_id as claim_pay_ctgry_ak_id, claim_payment_category.claim_pay_ctgry_type as claim_pay_ctgry_type, claim_payment_category.claim_pay_ctgry_lump_sum_ind as claim_pay_ctgry_lump_sum_ind, claim_payment_category.claim_pay_ak_id as claim_pay_ak_id, claim_payment_category.eff_from_date as eff_from_date, claim_payment_category.eff_to_date as eff_to_date FROM claim_payment_category\r\n\t\t\tWHERE crrnt_snpsht_flag = 1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,eff_from_date,eff_to_date ORDER BY claim_pay_ctgry_ak_id) = 1\n\t),\n\tLKP_Claim_Pay_Ctgry_Dim_id AS (\n\t\tSELECT\n\t\tclaim_pay_ctgry_type_dim_id,\n\t\tclaim_pay_ctgry_type,\n\t\tclaim_pay_ctgry_type_descript,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\tIN_claim_pay_ctgry_type,\n\t\tIN_claim_pay_ctgry_lump_sum_id,\n\t\tIN_trans_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\t\tclaim_pay_ctgry_type,\n\t\t\t\tclaim_pay_ctgry_type_descript,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\t\t\tIN_claim_pay_ctgry_type,\n\t\t\t\tIN_claim_pay_ctgry_lump_sum_id,\n\t\t\t\tIN_trans_date\n\t\t\tFROM claim_payment_category_type_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ctgry_type,claim_pay_ctgry_lump_sum_ind,eff_from_date,eff_to_date ORDER BY claim_pay_ctgry_type_dim_id) = 1\n\t),\n\tOutput AS (\n\t\tSELECT\n\t\tLKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_type_dim_id, \n\t\tLKP_Claim_Payment_Category.claim_pay_ctgry_ak_id, \n\t\tLKP_Claim_Payment_Category.claim_pay_ak_id\n\t\tFROM \n\t\tLEFT JOIN LKP_Claim_Pay_Ctgry_Dim_id\n\t\tON LKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_type = LKP_Claim_Payment_Category.claim_pay_ctgry_type AND LKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_lump_sum_ind = LKP_Claim_Payment_Category.claim_pay_ctgry_lump_sum_ind AND LKP_Claim_Pay_Ctgry_Dim_id.eff_from_date <= EXP_Get_Values.IN_trans_date AND LKP_Claim_Pay_Ctgry_Dim_id.eff_to_date >= EXP_Get_Values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Payment_Category\n\t\tON LKP_Claim_Payment_Category.claim_pay_ak_id = EXP_Get_Values.IN_Claim_Pay_AK_ID AND LKP_Claim_Payment_Category.eff_from_date <= EXP_Get_Values.IN_trans_date AND LKP_Claim_Payment_Category.eff_to_date >= EXP_Get_Values.IN_trans_date\n\t),\n),\nmplt_Claim_Payment_Category_type_Dim_id AS (WITH\n\tInput AS (\n\t\t\n\t),\n\tEXP_Get_Values AS (\n\t\tSELECT\n\t\tIN_Claim_Pay_AK_ID,\n\t\tIN_trans_date\n\t\tFROM Input\n\t),\n\tLKP_Claim_Payment_Category AS (\n\t\tSELECT\n\t\tclaim_pay_ctgry_ak_id,\n\t\tclaim_pay_ak_id,\n\t\tclaim_pay_ctgry_type,\n\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_payment_category.claim_pay_ctgry_ak_id as claim_pay_ctgry_ak_id, claim_payment_category.claim_pay_ctgry_type as claim_pay_ctgry_type, claim_payment_category.claim_pay_ctgry_lump_sum_ind as claim_pay_ctgry_lump_sum_ind, claim_payment_category.claim_pay_ak_id as claim_pay_ak_id, claim_payment_category.eff_from_date as eff_from_date, claim_payment_category.eff_to_date as eff_to_date FROM claim_payment_category\r\n\t\t\tWHERE crrnt_snpsht_flag = 1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id,eff_from_date,eff_to_date ORDER BY claim_pay_ctgry_ak_id) = 1\n\t),\n\tLKP_Claim_Pay_Ctgry_Dim_id AS (\n\t\tSELECT\n\t\tclaim_pay_ctgry_type_dim_id,\n\t\tclaim_pay_ctgry_type,\n\t\tclaim_pay_ctgry_type_descript,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\tIN_claim_pay_ctgry_type,\n\t\tIN_claim_pay_ctgry_lump_sum_id,\n\t\tIN_trans_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\t\tclaim_pay_ctgry_type,\n\t\t\t\tclaim_pay_ctgry_type_descript,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\t\t\tIN_claim_pay_ctgry_type,\n\t\t\t\tIN_claim_pay_ctgry_lump_sum_id,\n\t\t\t\tIN_trans_date\n\t\t\tFROM claim_payment_category_type_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ctgry_type,claim_pay_ctgry_lump_sum_ind,eff_from_date,eff_to_date ORDER BY claim_pay_ctgry_type_dim_id) = 1\n\t),\n\tOutput AS (\n\t\tSELECT\n\t\tLKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_type_dim_id, \n\t\tLKP_Claim_Payment_Category.claim_pay_ctgry_ak_id, \n\t\tLKP_Claim_Payment_Category.claim_pay_ak_id\n\t\tFROM \n\t\tLEFT JOIN LKP_Claim_Pay_Ctgry_Dim_id\n\t\tON LKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_type = LKP_Claim_Payment_Category.claim_pay_ctgry_type AND LKP_Claim_Pay_Ctgry_Dim_id.claim_pay_ctgry_lump_sum_ind = LKP_Claim_Payment_Category.claim_pay_ctgry_lump_sum_ind AND LKP_Claim_Pay_Ctgry_Dim_id.eff_from_date <= EXP_Get_Values.IN_trans_date AND LKP_Claim_Pay_Ctgry_Dim_id.eff_to_date >= EXP_Get_Values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Payment_Category\n\t\tON LKP_Claim_Payment_Category.claim_pay_ak_id = EXP_Get_Values.IN_Claim_Pay_AK_ID AND LKP_Claim_Payment_Category.eff_from_date <= EXP_Get_Values.IN_trans_date AND LKP_Claim_Payment_Category.eff_to_date >= EXP_Get_Values.IN_trans_date\n\t),\n),\nmplt_Claimant_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nmplt_Claimant_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nEXP_set_claimant_dim_ids AS (\n\tSELECT\n\tmplt_Claimant_dim_id.claimant_dim_id,\n\tmplt_Claimant_dim_hist_id.claimant_dim_id AS claimant_dim_hist_id,\n\tEXP_Cov_Level_dim_ids.claimant_cov_dim_id,\n\tEXP_Cov_Level_dim_ids.claimant_cov_dim_hist_id,\n\tEXP_Cov_Level_dim_ids.cov_dim_id,\n\tEXP_Cov_Level_dim_ids.cov_dim_hist_id,\n\tEXP_Cov_Level_dim_ids.claim_trans_type_dim_id,\n\tEXP_Cov_Level_dim_ids.claim_financial_type_dim_id,\n\tEXP_Cov_Level_dim_ids.claim_payment_dim_id,\n\tEXP_Cov_Level_dim_ids.claim_payment_dim_hist_id,\n\tEXP_Cov_Level_dim_ids.tax_id,\n\tEXP_Cov_Level_dim_ids.claim_master_1099_list_dim_id,\n\tmplt_Claim_Payment_Category_type_Dim_id.claim_pay_ctgry_type_dim_id,\n\tmplt_Claim_Payment_Category_type_Dim_hist_id.claim_pay_ctgry_type_dim_id AS claim_pay_ctgry_type_dim_hist_id,\n\tEXP_Cov_Level_dim_ids.claim_subrogation_dim_id,\n\tEXP_Cov_Level_dim_ids.trans_date,\n\tEXP_Cov_Level_dim_ids.trans_date_month_end,\n\tEXP_Cov_Level_dim_ids.reprocess_date,\n\tEXP_Cov_Level_dim_ids.claim_trans_id,\n\tEXP_Cov_Level_dim_ids.IN_claimant_cov_det_ak_id,\n\tEXP_Cov_Level_dim_ids.IN_cause_of_loss,\n\tEXP_Cov_Level_dim_ids.IN_reserve_ctgry,\n\tEXP_Cov_Level_dim_ids.IN_type_disability,\n\tEXP_Cov_Level_dim_ids.financial_type_code,\n\tEXP_Cov_Level_dim_ids.trans_code,\n\tEXP_Cov_Level_dim_ids.trans_ctgry_code,\n\tEXP_Cov_Level_dim_ids.trans_amt,\n\tEXP_Cov_Level_dim_ids.trans_hist_amt,\n\tEXP_Cov_Level_dim_ids.source_sys_id,\n\tEXP_Cov_Level_dim_ids.referred_to_subrogation_date,\n\tEXP_Cov_Level_dim_ids.pay_start_date,\n\tEXP_Cov_Level_dim_ids.closure_date,\n\tEXP_Cov_Level_dim_ids.trans_date_out,\n\tEXP_Cov_Level_dim_ids.pms_acct_entered_date,\n\tEXP_Cov_Level_dim_ids.ClaimReserveDimId,\n\tEXP_Cov_Level_dim_ids.FeatureRepresentativeDimId,\n\tEXP_Cov_Level_dim_ids.FeatureRepresentativeAssignedDate\n\tFROM EXP_Cov_Level_dim_ids\n\t -- Manually join with mplt_Claim_Payment_Category_type_Dim_hist_id\n\t -- Manually join with mplt_Claim_Payment_Category_type_Dim_id\n\t -- Manually join with mplt_Claimant_dim_hist_id\n\t -- Manually join with mplt_Claimant_dim_id\n),\nmplt_Claim_occurrence_dim_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nLKP_CoverageDetailDim AS (\n\tSELECT\n\tCoverageDetailDimId,\n\tPolicyAkid,\n\tclaim_trans_id\n\tFROM (\n\t\tSELECT CDD.CoverageDetailDimId as CoverageDetailDimId,\r\n\t\tCT.claim_trans_id as claim_trans_id,\r\n\t\tPC.PolicyAKID as PolicyAKID\r\n\t\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_transaction CT\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\ton CCD.claimant_cov_det_ak_id = CT.claimant_cov_det_ak_id and CCD.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton CCD.RatingCoverageAKId=RC.RatingCoverageAKID\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\ton RC.RatingCoverageAKID=PT.RatingCoverageAKId\r\n\t\tand RC.EffectiveDate=PT.EffectiveDate\r\n\t\tand PT.SourceSystemID='DCT'\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RC.PolicyCoverageAKID=PC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\tand PC.SourceSystemID='DCT'\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim CDD\r\n\t\ton PT.PremiumTransactionID=CDD.EDWPremiumTransactionPKId\r\n\t\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\r\n\t\t\r\n\t\tUnion\r\n\t\t\r\n\t\tSELECT CDD.CoverageDetailDimId as CoverageDetailDimId,\r\n\t\tCT.claim_trans_id as claim_trans_id,\r\n\t\tPC.PolicyAKID as PolicyAKID\r\n\t\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_transaction CT\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\ton CCD.claimant_cov_det_ak_id = CT.claimant_cov_det_ak_id and CCD.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton CCD.StatisticalCoverageAKID=SC.StatisticalCoverageAKID\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\ton SC.StatisticalCoverageAKID=PT.StatisticalCoverageAKID\r\n\t\tand PT.SourceSystemID='PMS'\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton SC.PolicyCoverageAKID=PC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\tand PC.SourceSystemID='PMS'\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim CDD\r\n\t\ton PT.PremiumTransactionID=CDD.EDWPremiumTransactionPKId and CDD.ExpirationDate='2100-12-31 23:59:59'\r\n\t\tWHERE CT.trans_offset_onset_ind in ('N','N/A')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_trans_id,PolicyAkid ORDER BY CoverageDetailDimId DESC) = 1\n),\nLKP_InsuranceReferenceCoverageDim AS (\n\tSELECT\n\tInsuranceReferenceCoverageDimId,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT T.claimant_cov_det_ak_id AS claimant_cov_det_ak_id,\r\n\t\t       T.InsuranceReferenceCoverageDimId AS InsuranceReferenceCoverageDimId,\r\n\t\tT.EffectiveDate as EffectiveDate,\r\n\t\tT.ExpirationDate as ExpirationDate\r\n\t\t       FROM\r\n\t\t( SELECT CCD.claimant_cov_det_ak_id,\r\n\t\t       IRC.InsuranceReferenceCoverageDimId,\r\n\t\tRC.RatingCoverageEffectiveDate EffectiveDate,\r\n\t\tRC.RatingCoverageExpirationDate ExpirationDate\r\n\t\tFROM  \t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD,\r\n\t\t\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence  CPO,\r\n\t\t\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO,\r\n\t\t\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC,\r\n\t\t\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC,\r\n\t\t\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_insurance_line SIL,\r\n\t\t\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim IRC\r\n\t\tWHERE  SIL.ins_line_code = PC.InsuranceLine\r\n\t\t\t\tAND CCD.claim_party_occurrence_ak_id=CPO.claim_party_occurrence_ak_id and CPO.crrnt_snpsht_flag=1 \r\n\t\t\t\tAND CPO.claim_occurrence_ak_id=CO.claim_occurrence_ak_id and CO.crrnt_snpsht_flag=1\r\n\t\t       AND CCD.RatingCoverageAKId = rc.RatingCoverageAKID\r\n\t\t\t   AND RC.PolicyCoverageAKID = PC.PolicyCoverageAKID\r\n\t\t       AND co.pol_key_ak_id=pc.policyakid\r\n\t\t       AND IRC.DctCoverageTypeCode= RC.CoverageType \r\n\t\t       AND IRC.DctRiskTypeCode = RC.RiskType \r\n\t\t       AND IRC.InsuranceLineCode = SIL.StandardInsuranceLineCode\r\n\t\t       AND IRC.DctPerilGroup=RC.PerilGroup\r\n\t\t       AND IRC.DctSubCoverageTypeCode=RC.SubCoverageTypeCode\r\n\t\t       AND IRC.DctCoverageVersion=RC.CoverageVersion\r\n\t\t       AND NOT (IRC.DctRiskTypeCode='N/A' AND IRC.DctCoverageTypeCode='N/A' AND IRC.DctPerilGroup='N/A' AND IRC.DctSubCoverageTypeCode='N/A' AND  IRC.DctCoverageVersion='N/A')\r\n\t\t       AND CCD.crrnt_snpsht_flag = 1\r\n\t\t       AND PC.CurrentSnapshotFlag = 1\r\n\t\t       AND SIL.crrnt_snpsht_flag = 1\r\n\t\tUNION ALL\r\n\t\tSELECT T2.claimant_cov_det_ak_id,\r\n\t\t       IRC.InsuranceReferenceCoverageDimId,\r\n\t\t'1800-1-1' EffectiveDate,\r\n\t\t'2100-12-31 23:59:59' ExpirationDate\r\n\t\tFROM (SELECT claimant_cov_det_ak_id,\r\n\t\t\t\t\t COALESCE(StandardInsuranceLineCode,'N/A') AS StandardInsuranceLineCode,\r\n\t\t\t\t\t COALESCE(MajorPerilCode,'N/A') AS MajorPerilCode,\r\n\t\t\t\t\t\t\t CASE WHEN (StandardInsuranceLineCode IN ('GL') AND (MajorPerilCode NOT IN ('540','599','919')\r\n\t\t\t\t        OR ClassCode NOT IN ( '11111','22222','22250','92100','17000','17001','17002','80051','80052','80053','80054','80055','80056','80057','80058')))\r\n\t\t\t\t        OR (StandardInsuranceLineCode IN( 'WC','IM','CG','CA'))\r\n\t\t\t\t\t OR (StandardInsuranceLineCode='N/A' AND TypeBureauCode in ('CF','B2','BB','BE','BF','BM','BT','FT','GL','GS','IM','MS','PF','PH','PI','PL','PQ','WC','WP','NB','RL','RN','RP','BC','N/A'))\r\n\t\t\t\t\t THEN 'N/A' ELSE COALESCE(RiskUnit,'N/A') END AS RiskUnit,\r\n\t\t\t\t\t CASE WHEN StandardInsuranceLineCode='CR' \r\n\t\t\t\t\t OR (StandardInsuranceLineCode='N/A' AND TypeBureauCode in ('CF','B2','BB','BE','BF','BM','BT','FT','GL','GS','IM','MS','PF','PH','PI','PL','PQ','WC','WP','NB','RL','RN','RP','BC','N/A'))\r\n\t\t\t\t\t THEN 'N/A' ELSE COALESCE(RiskUnitGroup,'N/A') END AS RiskUnitGroup,\r\n\t\t \t\t\tCASE WHEN REPLACE(ProductTypeCode ,'0','')=''  OR StandardInsuranceLineCode<>'GL' \r\n\t\t\t\t        THEN 'N/A' ELSE COALESCE(REPLACE(ProductTypeCode ,'0',''),'N/A') END AS ProductTypeCode \r\n\t\t\t FROM (\r\n\t\tSELECT CCD.claimant_cov_det_ak_id,\r\n\t\t\t\t     PC.TypeBureauCode,\r\n\t\t\t\t\t \t\t\t CASE WHEN REPLACE(SC.RiskUnit,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.RiskUnit,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.RiskUnit)) END AS RiskUnit,\r\n\t\t\t\t\t CASE WHEN REPLACE(SC.RiskUnitGroup,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.RiskUnitGroup,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.RiskUnitGroup)) END AS RiskUnitGroup,\r\n\t\t\t\t\t CASE WHEN REPLACE(SC.MajorPerilCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.MajorPerilCode,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.MajorPerilCode)) END MajorPerilCode,\r\n\t\t\t\t\t CASE WHEN (REPLACE(SIL.StandardInsuranceLineCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SIL.StandardInsuranceLineCode,' ',''))<>0 OR SIL.StandardInsuranceLineCode='N/A') \r\n\t\t\t\t\t AND (PC.TypeBureauCode IN ('AL','AN','AP') OR SC.MajorPerilCode IN ('930','931')) THEN 'CA' WHEN REPLACE(SIL.StandardInsuranceLineCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SIL.StandardInsuranceLineCode,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SIL.StandardInsuranceLineCode)) END AS StandardInsuranceLineCode,\r\n\t\t            SC.ClassCode,\r\n\t\t \t SUBSTRING(sc.RiskUnitSequenceNumber,2,1) as ProductTypeCode\r\n\t\t\t\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_insurance_line SIL\r\n\t\t\t\tWHERE  CCD.StatisticalCoverageAKID = SC.StatisticalCoverageAKID\r\n\t\t\t\t\t   AND PC.PolicyCoverageAKID = SC.PolicyCoverageAKID\r\n\t\t\t\t\t   AND SC.SourcesystemID = 'PMS'\r\n\t\t\t\t\t   AND SIL.ins_line_code = PC.InsuranceLine\r\n\t\t\t\t\t   AND CCD.crrnt_snpsht_flag = 1\r\n\t\t\t\t\t   AND SIL.crrnt_snpsht_flag = 1)T1) T2,    \r\n\t\t       @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim IRC\r\n\t\tWHERE  IRC.PmsRiskUnitCode = T2.RiskUnit\r\n\t\t       AND IRC.PmsRiskUnitGroupCode = T2.RiskUnitGroup\r\n\t\t       AND IRC.PmsMajorPerilCode = T2.MajorPerilCode \r\n\t\t       AND IRC.InsuranceLineCode = T2.StandardInsuranceLineCode\r\n\t\t       AND IRC.PmsProductTypeCode = T2.ProductTypeCode\r\n\t\t       AND IRC.DctRiskTypeCode='N/A' \r\n\t\t       AND IRC.DctCoverageTypeCode='N/A'\r\n\t\t       AND IRC.DctPerilGroup='N/A'\r\n\t\t\tAND IRC.DctSubCoverageTypeCode='N/A' \r\n\t\t\tAND  IRC.DctCoverageVersion='N/A') T\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY InsuranceReferenceCoverageDimId) = 1\n),\nLKP_InsuranceReferenceDimId AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT CCD.claimant_cov_det_ak_id AS claimant_cov_det_ak_id,\r\n\t\tIRD.InsuranceReferenceDimId AS InsuranceReferenceDimId\r\n\t\tFROM (\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton CCD.StatisticalCoverageAKID=SC.StatisticalCoverageAKId\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton SC.PolicyCoverageAKId=PC.PolicyCoverageAKID\r\n\t\twhere SC.SourceSystemId='PMS' and CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence  CPO\r\n\t\ton CCD.claim_party_occurrence_ak_id=CPO.claim_party_occurrence_ak_id\r\n\t\tand CPO.crrnt_snpsht_flag=1\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\ton CPO.claim_occurrence_ak_id=CO.claim_occurrence_ak_id\r\n\t\tand CO.crrnt_snpsht_flag=1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton CCD.RatingCoverageAKID=RC.RatingCoverageAKId \r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RC.PolicyCoverageAKId=PC.PolicyCoverageAKID \r\n\t\tand co.pol_key_ak_id=pc.policyakid\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\twhere CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tnull RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\twhere CCD.crrnt_snpsht_flag =1 and CCD.StatisticalCoverageAKID=-1 and CCD.RatingCoverageAKID=-1\r\n\t\t ) CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO\r\n\t\ton CCD.Claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id\r\n\t\tand CPO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\ton CPO.Claim_Occurrence_ak_id = CO.claim_occurrence_ak_id\r\n\t\tand CO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy P\r\n\t\ton CO.pol_key_ak_id = P.pol_ak_id\r\n\t\tand P.crrnt_snpsht_flag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyOffering PO\r\n\t\ton P.PolicyOfferingAKId = PO.PolicyOfferingAKID\r\n\t\tand PO.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment ISe\r\n\t\ton P.InsuranceSegmentAKID = ISe.InsuranceSegmentAKID\r\n\t\tand ISe.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter SPC\r\n\t\ton P.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId\r\n\t\tand SPC.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.EnterpriseGroup EG\r\n\t\ton SPC.EnterPriseGroupId = EG.EnterpriseGroupId\r\n\t\tand EG.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity IRE\r\n\t\ton SPC.InsuranceReferenceLegalEntityId = IRE.InsuranceReferenceLegalEntityId\r\n\t\tand IRE.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.Product Pr\r\n\t\ton CCD.ProductAKId = Pr.ProductAKId\r\n\t\tand Pr.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLineOfBusiness IRLOB\r\n\t\ton CCD.InsuranceReferenceLineOfBusinessAKID = IRLOB.InsuranceReferenceLineOfBusinessAKId\r\n\t\tand IRLOB.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingPlan RPDT\r\n\t\ton CCD.RatingPlanAKId=RPDT.RatingPlanAKId and RPDT.CurrentSnapshotFlag=1\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceDim IRD\r\n\t\ton isnull(Pr.ProductCode, '000') = IRD.ProductCode \r\n\t\tand isnull(PO.PolicyOfferingCode, '000') = IRD.PolicyOfferingCode \r\n\t\tand isnull(ISe.InsuranceSegmentCode, 'N/A') = IRD.InsuranceSegmentCode \r\n\t\tand isnull(SPC.StrategicProfitCenterCode, '6') = IRD.StrategicProfitCenterCode \r\n\t\tand isnull(IRLOB.InsuranceReferenceLineOfBusinessCode, '000') = IRD.InsuranceReferenceLineOfBusinessCode \r\n\t\tand isnull(EG.EnterpriseGroupCode, '1')=IRD.EnterpriseGroupCode \r\n\t\tand isnull(IRE.InsuranceReferenceLegalEntityCode, '1')=IRD.InsuranceReferenceLegalEntityCode\r\n\t\tand isnull(RPDT.RatingPlanCode, '1')=IRD.RatingPlanCode\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY InsuranceReferenceDimId) = 1\n),\nLKP_SalesDivisionDim AS (\n\tSELECT\n\tSalesDivisionDimID,\n\tAgencyAKID\n\tFROM (\n\t\tSelect A.AgencyAKID AS AgencyAKID, \r\n\t\tSDD.SalesDivisionDimID AS SalesDivisionDimID\r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency A,\r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager RSM,\r\n\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SalesDivisionDim SDD\r\n\t\tWHERE A.CurrentSnapshotFlag =1\r\n\t\tAND RSM.RegionalSalesManagerAKID = A.RegionalSalesManagerAKID\r\n\t\tAND RSM.CurrentSnapshotFlag = 1\r\n\t\tAND RSM.SalesDirectorAKID = SDD.EDWSalesDirectorAKID\r\n\t\tAND A.SalesTerritoryAKID = SDD.EDWSalesTerritoryAKID\r\n\t\tAND RSM.RegionalSalesManagerAKID = SDD.EDWRegionalSalesManagerAKID\r\n\t\tAND SDD.CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID ORDER BY SalesDivisionDimID) = 1\n),\nmplt_Claim_Rep_Dim_Hist_Id_Payment_Entry_Operator AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEvaluate_Inputs AS (\n\t\tSELECT\n\t\tpayment_dim_id,\n\t\ttransaction_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claim_Payment_Dim AS (\n\t\tSELECT\n\t\tpay_entry_oper_id,\n\t\ttransaction_date,\n\t\tclaim_pay_dim_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tpay_entry_oper_id,\n\t\t\t\ttransaction_date,\n\t\t\t\tclaim_pay_dim_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_payment_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_dim_id,eff_from_date,eff_to_date ORDER BY pay_entry_oper_id DESC) = 1\n\t),\n\tEXP_Prepare_Results AS (\n\t\tSELECT\n\t\tpay_entry_oper_id,\n\t\t-- *INF*: IIF(isnull(pay_entry_oper_id),pay_entry_oper_id,ltrim(rtrim(pay_entry_oper_id)))\r\n\t\t-- \r\n\t\t-- -- if nothing do nothing, else trim \n\t\tIFF(pay_entry_oper_id IS NULL, pay_entry_oper_id, ltrim(rtrim(pay_entry_oper_id))) AS pay_entry_oper_id_out,\n\t\ttransaction_date\n\t\tFROM LKP_Claim_Payment_Dim\n\t),\n\tClaim_Rep_Dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT targetRow.claim_rep_dim_id AS claim_rep_dim_id,\r\n\t\t\t\tanymatch.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id,\r\n\t\t\t\ttargetRow.eff_from_date AS eff_from_date,\r\n\t\t\t\ttargetRow.eff_to_date AS eff_to_date\r\n\t\t\tFROM claim_representative_dim anymatch\r\n\t\t\tJOIN claim_representative_dim targetRow on anymatch.edw_claim_rep_ak_id = targetRow.edw_claim_rep_ak_id \r\n\t\t\torder by anymatch.eff_from_date desc--\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id) = 1\n\t),\n\tPrepare_Output AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\t-- *INF*: IIF(isnull(claim_rep_dim_id),-1,claim_rep_dim_id)\n\t\tIFF(claim_rep_dim_id IS NULL, - 1, claim_rep_dim_id) AS claim_rep_dim_id_OUT\n\t\tFROM Claim_Rep_Dim\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id_OUT AS Claim_Rep_Dim_Id\n\t\tFROM Prepare_Output\n\t),\n),\nmplt_Claim_Rep_Dim_Id_Payment_Entry_Operator AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEvaluate_Inputs AS (\n\t\tSELECT\n\t\tpayment_dim_id,\n\t\ttransaction_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claim_Payment_Dim AS (\n\t\tSELECT\n\t\tpay_entry_oper_id,\n\t\ttransaction_date,\n\t\tclaim_pay_dim_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tpay_entry_oper_id,\n\t\t\t\ttransaction_date,\n\t\t\t\tclaim_pay_dim_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_payment_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_dim_id,eff_from_date,eff_to_date ORDER BY pay_entry_oper_id DESC) = 1\n\t),\n\tEXP_Prepare_Results AS (\n\t\tSELECT\n\t\tpay_entry_oper_id,\n\t\t-- *INF*: IIF(isnull(pay_entry_oper_id),pay_entry_oper_id,ltrim(rtrim(pay_entry_oper_id)))\r\n\t\t-- \r\n\t\t-- -- if nothing do nothing, else trim \n\t\tIFF(pay_entry_oper_id IS NULL, pay_entry_oper_id, ltrim(rtrim(pay_entry_oper_id))) AS pay_entry_oper_id_out,\n\t\ttransaction_date\n\t\tFROM LKP_Claim_Payment_Dim\n\t),\n\tClaim_Rep_Dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT targetRow.claim_rep_dim_id AS claim_rep_dim_id,\r\n\t\t\t\tanymatch.claim_rep_wbconnect_user_id AS claim_rep_wbconnect_user_id,\r\n\t\t\t\ttargetRow.eff_from_date AS eff_from_date,\r\n\t\t\t\ttargetRow.eff_to_date AS eff_to_date\r\n\t\t\tFROM claim_representative_dim anymatch\r\n\t\t\tJOIN claim_representative_dim targetRow on anymatch.edw_claim_rep_ak_id = targetRow.edw_claim_rep_ak_id \r\n\t\t\torder by anymatch.eff_from_date desc--\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id) = 1\n\t),\n\tPrepare_Output AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\t-- *INF*: IIF(isnull(claim_rep_dim_id),-1,claim_rep_dim_id)\n\t\tIFF(claim_rep_dim_id IS NULL, - 1, claim_rep_dim_id) AS claim_rep_dim_id_OUT\n\t\tFROM Claim_Rep_Dim\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id_OUT AS Claim_Rep_Dim_Id\n\t\tFROM Prepare_Output\n\t),\n),\nmplt_Claim_occurrence_dim_hist_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Strategic_Business_Division_Dim AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)\n\t\t) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)\n\t\t) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, CURRENT_TIMESTAMP, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_set_default_dim_ids AS (\n\tSELECT\n\tmplt_Claim_occurrence_dim_id.claim_occurrence_dim_id,\n\t-- *INF*: iif(isnull(claim_occurrence_dim_id),-1,claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.claim_occurrence_dim_id AS claim_occurrence_dim_hist_id,\n\t-- *INF*: iif(isnull(claim_occurrence_dim_hist_id),-1,claim_occurrence_dim_hist_id)\n\tIFF(claim_occurrence_dim_hist_id IS NULL, - 1, claim_occurrence_dim_hist_id) AS claim_occurrence_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.claimant_dim_id,\n\t-- *INF*: iif(isnull(claimant_dim_id),-1,claimant_dim_id)\n\tIFF(claimant_dim_id IS NULL, - 1, claimant_dim_id) AS claimant_dim_id_out,\n\tEXP_set_claimant_dim_ids.claimant_dim_hist_id,\n\t-- *INF*: iif(isnull(claimant_dim_hist_id),-1,claimant_dim_hist_id)\n\tIFF(claimant_dim_hist_id IS NULL, - 1, claimant_dim_hist_id) AS claimant_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.claimant_cov_dim_id,\n\t-- *INF*: iif(isnull(claimant_cov_dim_id),-1,claimant_cov_dim_id)\n\tIFF(claimant_cov_dim_id IS NULL, - 1, claimant_cov_dim_id) AS claimant_cov_dim_id_out,\n\tEXP_set_claimant_dim_ids.claimant_cov_dim_hist_id,\n\t-- *INF*: iif(isnull(claimant_cov_dim_hist_id),-1,claimant_cov_dim_hist_id)\n\tIFF(claimant_cov_dim_hist_id IS NULL, - 1, claimant_cov_dim_hist_id) AS claimant_cov_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.cov_dim_id,\n\t-- *INF*: iif(isnull(cov_dim_id),-1,cov_dim_id)\n\tIFF(cov_dim_id IS NULL, - 1, cov_dim_id) AS cov_dim_id_out,\n\tEXP_set_claimant_dim_ids.cov_dim_hist_id,\n\t-- *INF*: iif(isnull(cov_dim_hist_id),-1,cov_dim_hist_id)\n\tIFF(cov_dim_hist_id IS NULL, - 1, cov_dim_hist_id) AS cov_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.claim_trans_type_dim_id,\n\t-- *INF*: iif(isnull(claim_trans_type_dim_id),-1,claim_trans_type_dim_id)\n\tIFF(claim_trans_type_dim_id IS NULL, - 1, claim_trans_type_dim_id) AS claim_trans_type_dim_id_out,\n\tEXP_set_claimant_dim_ids.claim_financial_type_dim_id,\n\t-- *INF*: iif(isnull(claim_financial_type_dim_id),-1,claim_financial_type_dim_id)\n\tIFF(claim_financial_type_dim_id IS NULL, - 1, claim_financial_type_dim_id) AS claim_financial_type_dim_id_out,\n\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM_ALT(trans_date,IN_claimant_cov_det_ak_id)\n\tLKP_CLAIM_REP_DIM_ALT_trans_date_IN_claimant_cov_det_ak_id.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id_alt,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id_alt),-1,claim_rep_dim_prim_claim_rep_id_alt)\n\tIFF(claim_rep_dim_prim_claim_rep_id_alt IS NULL, - 1, claim_rep_dim_prim_claim_rep_id_alt) AS claim_rep_dim_prim_claim_rep_id_alt_out,\n\tmplt_Claim_occurrence_dim_id.claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id), IIF(source_sys_id = 'DCT',claim_rep_dim_prim_claim_rep_id_alt_out,-1), claim_rep_dim_prim_claim_rep_id)\n\tIFF(\n\t    claim_rep_dim_prim_claim_rep_id IS NULL,\n\t    IFF(\n\t        source_sys_id = 'DCT', claim_rep_dim_prim_claim_rep_id_alt_out, - 1\n\t    ),\n\t    claim_rep_dim_prim_claim_rep_id\n\t) AS claim_rep_prim_claim_rep_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_prim_claim_rep_id AS claim_rep_prim_claim_rep_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_prim_claim_rep_dim_hist_id), -1, claim_rep_prim_claim_rep_dim_hist_id)\n\tIFF(claim_rep_prim_claim_rep_dim_hist_id IS NULL, - 1, claim_rep_prim_claim_rep_dim_hist_id) AS claim_rep_prim_claim_rep_dim_hist_id_out,\n\tmplt_Claim_occurrence_dim_id.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id), -1, claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_examiner_id AS claim_rep_dim_examiner_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_hist_id), -1, claim_rep_dim_examiner_hist_id)\n\tIFF(claim_rep_dim_examiner_hist_id IS NULL, - 1, claim_rep_dim_examiner_hist_id) AS claim_rep_dim_examiner_hist_id_out,\n\tmplt_Claim_occurrence_dim_id.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id), -1, claim_rep_dim_prim_litigation_handler_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_id\n\t) AS claim_rep_dim_prim_litigation_handler_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_prim_litigation_handler_id AS claim_rep_dim_prim_litigation_handler_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_hist_id), -1, claim_rep_dim_prim_litigation_handler_hist_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_hist_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_hist_id\n\t) AS claim_rep_dim_prim_litigation_handler_hist_id_out,\n\tmplt_Claim_occurrence_dim_id.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id), -1, pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.pol_key_dim_id AS pol_key_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_hist_id), -1, pol_key_dim_hist_id)\n\tIFF(pol_key_dim_hist_id IS NULL, - 1, pol_key_dim_hist_id) AS pol_key_dim_hist_id_out,\n\tmplt_Claim_occurrence_dim_id.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id), -1, agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.agency_dim_id AS agency_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_hist_id), -1, agency_dim_hist_id)\n\tIFF(agency_dim_hist_id IS NULL, - 1, agency_dim_hist_id) AS agency_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.claim_payment_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_payment_dim_id), -1, claim_payment_dim_id)\n\tIFF(claim_payment_dim_id IS NULL, - 1, claim_payment_dim_id) AS claim_payment_dim_id_out,\n\tEXP_set_claimant_dim_ids.claim_payment_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_payment_dim_hist_id), -1, claim_payment_dim_hist_id)\n\tIFF(claim_payment_dim_hist_id IS NULL, - 1, claim_payment_dim_hist_id) AS claim_payment_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.tax_id,\n\tEXP_set_claimant_dim_ids.claim_master_1099_list_dim_id AS in_claim_master_1099_list_dim_id,\n\t-- *INF*: iif(isnull(in_claim_master_1099_list_dim_id),-1,in_claim_master_1099_list_dim_id)\n\tIFF(in_claim_master_1099_list_dim_id IS NULL, - 1, in_claim_master_1099_list_dim_id) AS claim_master_1099_list_dim_id,\n\tEXP_set_claimant_dim_ids.claim_pay_ctgry_type_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_pay_ctgry_type_dim_id),-1,claim_pay_ctgry_type_dim_id)\n\tIFF(claim_pay_ctgry_type_dim_id IS NULL, - 1, claim_pay_ctgry_type_dim_id) AS claim_pay_ctgry_type_dim_id_out,\n\tEXP_set_claimant_dim_ids.claim_pay_ctgry_type_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_pay_ctgry_type_dim_hist_id),-1,claim_pay_ctgry_type_dim_hist_id)\n\tIFF(claim_pay_ctgry_type_dim_hist_id IS NULL, - 1, claim_pay_ctgry_type_dim_hist_id) AS claim_pay_ctgry_type_dim_hist_id_out,\n\tmplt_Claim_occurrence_dim_id.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_dim_id,\n\tmplt_Claim_occurrence_dim_id.claim_case_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_id),-1,claim_case_dim_id)\n\tIFF(claim_case_dim_id IS NULL, - 1, claim_case_dim_id) AS claim_case_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.claim_case_dim_id AS claim_case_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_hist_id),-1,claim_case_dim_hist_id)\n\tIFF(claim_case_dim_hist_id IS NULL, - 1, claim_case_dim_hist_id) AS claim_case_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.claim_subrogation_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_subrogation_dim_id), -1, claim_subrogation_dim_id)\n\tIFF(claim_subrogation_dim_id IS NULL, - 1, claim_subrogation_dim_id) AS claim_subrogation_dim_id_out,\n\t-1 AS claim_trans_oper_dim_id,\n\tEXP_set_claimant_dim_ids.trans_date,\n\tEXP_set_claimant_dim_ids.reprocess_date,\n\tmplt_Claim_occurrence_dim_id.claim_loss_date,\n\tmplt_Claim_occurrence_dim_id.claim_discovery_date,\n\tmplt_Claim_occurrence_dim_id.source_claim_rpted_date,\n\tmplt_Claim_occurrence_dim_id.claim_scripted_date,\n\tmplt_Claim_occurrence_dim_id.claim_occurrence_rpted_date,\n\tmplt_Claim_occurrence_dim_id.claim_open_date,\n\tmplt_Claim_occurrence_dim_id.claim_close_date,\n\tmplt_Claim_occurrence_dim_id.claim_reopen_date,\n\tmplt_Claim_occurrence_dim_id.claim_closed_after_reopen_date,\n\tmplt_Claim_occurrence_dim_id.claim_notice_only_date,\n\tmplt_Claim_occurrence_dim_id.claim_cat_start_date,\n\tmplt_Claim_occurrence_dim_id.claim_cat_end_date,\n\tmplt_Claim_occurrence_dim_id.claim_rep_assigned_date,\n\tmplt_Claim_occurrence_dim_id.claim_rep_unassigned_date,\n\tEXP_set_claimant_dim_ids.claim_trans_id,\n\tmplt_Claim_occurrence_dim_id.pol_eff_date,\n\tmplt_Claim_occurrence_dim_id.pol_exp_date,\n\tEXP_set_claimant_dim_ids.IN_claimant_cov_det_ak_id,\n\tEXP_set_claimant_dim_ids.IN_cause_of_loss,\n\tEXP_set_claimant_dim_ids.IN_reserve_ctgry,\n\tEXP_set_claimant_dim_ids.IN_type_disability,\n\tEXP_set_claimant_dim_ids.financial_type_code,\n\tEXP_set_claimant_dim_ids.trans_code,\n\tEXP_set_claimant_dim_ids.trans_ctgry_code,\n\tEXP_set_claimant_dim_ids.trans_amt,\n\tEXP_set_claimant_dim_ids.trans_hist_amt,\n\tEXP_set_claimant_dim_ids.source_sys_id,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t'000000000000000' AS err_flag,\n\t-1 AS default_dim_id,\n\tEXP_set_claimant_dim_ids.referred_to_subrogation_date,\n\tEXP_set_claimant_dim_ids.pay_start_date,\n\tEXP_set_claimant_dim_ids.closure_date,\n\tmplt_Claim_occurrence_dim_id.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tmplt_Claim_occurrence_dim_hist_id.contract_cust_dim_id AS contract_cust_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_hist_id),-1,contract_cust_dim_hist_id)\n\tIFF(contract_cust_dim_hist_id IS NULL, - 1, contract_cust_dim_hist_id) AS contract_cust_dim_hist_id_out,\n\tEXP_set_claimant_dim_ids.pms_acct_entered_date,\n\tmplt_Strategic_Business_Division_Dim.strtgc_bus_dvsn_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_loss_date AS claim_loss_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_discovery_date AS claim_discovery_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_scripted_date AS claim_scripted_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.source_claim_rpted_date AS source_claim_rpted_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_occurrence_rpted_date AS claim_occurrence_rpted_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_open_date AS claim_open_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_close_date AS claim_close_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_reopen_date AS claim_reopen_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_closed_after_reopen_date AS claim_closed_after_reopen_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_notice_only_date AS claim_notice_only_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_cat_start_date AS claim_cat_start_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_cat_end_date AS claim_cat_end_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_assigned_date AS claim_rep_assigned_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_unassigned_date AS claim_rep_unassigned_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.pol_eff_date AS pol_eff_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.pol_exp_date AS pol_exp_date_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_created_by_id AS claim_created_by_id_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.pol_sym AS pol_sym_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.pol_num AS pol_num_hist_id,\n\tmplt_Claim_Rep_Dim_Id_Payment_Entry_Operator.Claim_Rep_Dim_Id AS payment_entry_operator_id,\n\t-- *INF*: IIF(isnull(payment_entry_operator_id),-1,payment_entry_operator_id)\n\tIFF(payment_entry_operator_id IS NULL, - 1, payment_entry_operator_id) AS payment_entry_operator_id_out,\n\tmplt_Claim_Rep_Dim_Hist_Id_Payment_Entry_Operator.Claim_Rep_Dim_Id AS payment_entry_operator_hist_id,\n\t-- *INF*: IIF(isnull(payment_entry_operator_hist_id),-1,payment_entry_operator_hist_id)\n\tIFF(payment_entry_operator_hist_id IS NULL, - 1, payment_entry_operator_hist_id) AS payment_entry_operator_hist_id_out,\n\tLKP_InsuranceReferenceDimId.InsuranceReferenceDimId AS I_InsuranceReferenceDimId,\n\t-- *INF*: IIF(ISNULL(I_InsuranceReferenceDimId), -1 , I_InsuranceReferenceDimId )\n\tIFF(I_InsuranceReferenceDimId IS NULL, - 1, I_InsuranceReferenceDimId) AS O_InsuranceReferenceDimId,\n\tmplt_Claim_occurrence_dim_id.AgencyDimID AS I_AgencyDimID,\n\t-- *INF*: IIF( ISNULL(I_AgencyDimID), -1, I_AgencyDimID)\n\tIFF(I_AgencyDimID IS NULL, - 1, I_AgencyDimID) AS O_AgencyDimID,\n\tLKP_SalesDivisionDim.SalesDivisionDimID AS I_SalesDivisionDimID,\n\t-- *INF*: IIF(ISNULL(I_SalesDivisionDimID), -1, I_SalesDivisionDimID)\n\tIFF(I_SalesDivisionDimID IS NULL, - 1, I_SalesDivisionDimID) AS O_SalesDivisionDimID,\n\tLKP_InsuranceReferenceCoverageDim.InsuranceReferenceCoverageDimId AS I_InsuranceReferenceCoverageDimId,\n\t-- *INF*: IIF(ISNULL(I_InsuranceReferenceCoverageDimId), -1, I_InsuranceReferenceCoverageDimId)\n\tIFF(I_InsuranceReferenceCoverageDimId IS NULL, - 1, I_InsuranceReferenceCoverageDimId) AS O_InsuranceReferenceCoverageDetailDimID,\n\tLKP_CoverageDetailDim.CoverageDetailDimId AS I_CoverageDetailDimId,\n\t-- *INF*: IIF( ISNULL( I_CoverageDetailDimId), -1, I_CoverageDetailDimId)\n\tIFF(I_CoverageDetailDimId IS NULL, - 1, I_CoverageDetailDimId) AS O_CoverageDetailDimId,\n\tmplt_Claim_occurrence_dim_id.AgencyAKID,\n\tmplt_Claim_occurrence_dim_id.SalesTerritoryAKID,\n\tmplt_Claim_occurrence_dim_id.RegionalSalesManagerAKID,\n\tmplt_Claim_occurrence_dim_id.SalesDirectorAKID,\n\tmplt_Claim_occurrence_dim_id.StrategicProfitCenterAKId,\n\tmplt_Claim_occurrence_dim_id.InsuranceSegmentAKId,\n\tmplt_Claim_occurrence_dim_id.PolicyOfferingAKId,\n\tmplt_Claim_occurrence_dim_hist_id.AgencyDimID,\n\t-- *INF*: IIF(ISNULL(AgencyDimID), -1, AgencyDimID)\n\tIFF(AgencyDimID IS NULL, - 1, AgencyDimID) AS o_agency_dim_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.AgencyAKID AS AgencyAKID1,\n\tmplt_Claim_occurrence_dim_hist_id.SalesTerritoryAKID AS SalesTerritoryAKID1,\n\tmplt_Claim_occurrence_dim_hist_id.RegionalSalesManagerAKID AS RegionalSalesManagerAKID1,\n\tmplt_Claim_occurrence_dim_hist_id.SalesDirectorAKID AS SalesDirectorAKID1,\n\tmplt_Claim_occurrence_dim_hist_id.StrategicProfitCenterAKId AS StrategicProfitCenterAKId1,\n\tmplt_Claim_occurrence_dim_hist_id.InsuranceSegmentAKId AS InsuranceSegmentAKId1,\n\tmplt_Claim_occurrence_dim_hist_id.PolicyOfferingAKId AS PolicyOfferingAKId1,\n\tEXP_set_claimant_dim_ids.ClaimReserveDimId AS in_ClaimReserveDimId,\n\t-- *INF*: IIF(ISNULL(in_ClaimReserveDimId),-1,in_ClaimReserveDimId)\n\tIFF(in_ClaimReserveDimId IS NULL, - 1, in_ClaimReserveDimId) AS out_ClaimReserveDimId,\n\tEXP_set_claimant_dim_ids.FeatureRepresentativeDimId AS in_FeatureRepresentativeDimId,\n\t-- *INF*: IIF(ISNULL(in_FeatureRepresentativeDimId),-1,in_FeatureRepresentativeDimId)\n\tIFF(in_FeatureRepresentativeDimId IS NULL, - 1, in_FeatureRepresentativeDimId) AS out_FeatureRepresentativeDimId,\n\tEXP_set_claimant_dim_ids.FeatureRepresentativeAssignedDate\n\tFROM EXP_set_claimant_dim_ids\n\t -- Manually join with mplt_Claim_Rep_Dim_Hist_Id_Payment_Entry_Operator\n\t -- Manually join with mplt_Claim_Rep_Dim_Id_Payment_Entry_Operator\n\t -- Manually join with mplt_Claim_occurrence_dim_hist_id\n\t -- Manually join with mplt_Claim_occurrence_dim_id\n\t -- Manually join with mplt_Strategic_Business_Division_Dim\n\tLEFT JOIN LKP_CoverageDetailDim\n\tON LKP_CoverageDetailDim.claim_trans_id = EXP_set_claimant_dim_ids.claim_trans_id AND LKP_CoverageDetailDim.PolicyAkid = mplt_Claim_occurrence_dim_id.PolicyAkid\n\tLEFT JOIN LKP_InsuranceReferenceCoverageDim\n\tON LKP_InsuranceReferenceCoverageDim.claimant_cov_det_ak_id = EXP_set_claimant_dim_ids.IN_claimant_cov_det_ak_id\n\tLEFT JOIN LKP_InsuranceReferenceDimId\n\tON LKP_InsuranceReferenceDimId.claimant_cov_det_ak_id = EXP_set_claimant_dim_ids.IN_claimant_cov_det_ak_id\n\tLEFT JOIN LKP_SalesDivisionDim\n\tON LKP_SalesDivisionDim.AgencyAKID = mplt_Claim_occurrence_dim_id.AgencyAKID\n\tLEFT JOIN LKP_CLAIM_REP_DIM_ALT LKP_CLAIM_REP_DIM_ALT_trans_date_IN_claimant_cov_det_ak_id\n\tON LKP_CLAIM_REP_DIM_ALT_trans_date_IN_claimant_cov_det_ak_id.claimant_cov_det_ak_id = trans_date\n\tAND LKP_CLAIM_REP_DIM_ALT_trans_date_IN_claimant_cov_det_ak_id. = IN_claimant_cov_det_ak_id\n\n),\nEXP_set_default_date_ids AS (\n\tSELECT\n\tclaim_occurrence_dim_id_out,\n\tclaim_occurrence_dim_hist_id_out,\n\tclaimant_dim_id_out,\n\tclaimant_dim_hist_id_out,\n\tclaimant_cov_dim_id_out,\n\tclaimant_cov_dim_hist_id_out,\n\tcov_dim_id_out,\n\tcov_dim_hist_id_out,\n\tclaim_trans_type_dim_id_out,\n\tclaim_financial_type_dim_id_out,\n\tclaim_rep_prim_claim_rep_dim_id_out,\n\tclaim_rep_prim_claim_rep_dim_hist_id_out,\n\tclaim_rep_dim_examiner_id_out,\n\tclaim_rep_dim_examiner_hist_id_out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tclaim_rep_dim_prim_litigation_handler_hist_id_out,\n\tpol_key_dim_id_out,\n\tpol_key_dim_hist_id_out,\n\tagency_dim_id_out,\n\to_agency_dim_hist_id AS agency_dim_hist_id_out,\n\tclaim_payment_dim_id_out,\n\tclaim_payment_dim_hist_id_out,\n\ttax_id,\n\tclaim_master_1099_list_dim_id AS claim_master_1099_list_dim_id_out,\n\tclaim_pay_ctgry_type_dim_id_out,\n\tclaim_pay_ctgry_type_dim_hist_id_out,\n\tclaim_created_by_dim_id,\n\tclaim_case_dim_id_out,\n\tclaim_case_dim_hist_id_out,\n\tclaim_subrogation_dim_id_out,\n\tclaim_trans_oper_dim_id,\n\ttrans_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(trans_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_trans_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_trans_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_trans_date_id), v_claim_trans_date_id, -1)\n\tIFF(v_claim_trans_date_id IS NOT NULL, v_claim_trans_date_id, - 1) AS claim_trans_date_id,\n\treprocess_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(reprocess_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_reprocess_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_reprocess_date_id), v_reprocess_date_id, -1)\n\tIFF(v_reprocess_date_id IS NOT NULL, v_reprocess_date_id, - 1) AS reprocess_date_id,\n\tclaim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(v_claim_loss_date_id IS NOT NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tclaim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(v_claim_discovery_date_id IS NOT NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tsource_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(ISNULL(v_source_claim_rpted_date_id),-1,v_source_claim_rpted_date_id)\n\tIFF(v_source_claim_rpted_date_id IS NULL, - 1, v_source_claim_rpted_date_id) AS source_claim_rpted_date_id,\n\tclaim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_scripted_date_id),-1,v_claim_scripted_date_id)\n\tIFF(v_claim_scripted_date_id IS NULL, - 1, v_claim_scripted_date_id) AS claim_scripted_date_id,\n\tclaim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(v_claim_occurrence_rpted_date_id IS NOT NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tclaim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_open_date_id), -1, v_claim_open_date_id)\n\tIFF(v_claim_open_date_id IS NULL, - 1, v_claim_open_date_id) AS claim_open_date_id,\n\tclaim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_close_date_id), -1, v_claim_close_date_id)\n\tIFF(v_claim_close_date_id IS NULL, - 1, v_claim_close_date_id) AS claim_close_date_id,\n\tclaim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_reopen_date_id), -1, v_claim_reopen_date_id)\n\tIFF(v_claim_reopen_date_id IS NULL, - 1, v_claim_reopen_date_id) AS claim_reopen_date_id,\n\tclaim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_closed_after_reopen_date_id), -1, v_claim_closed_after_reopen_date_id)\n\tIFF(v_claim_closed_after_reopen_date_id IS NULL, - 1, v_claim_closed_after_reopen_date_id) AS claim_closed_after_reopen_date_id,\n\tclaim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_notice_only_date_id), -1, v_claim_notice_only_date_id)\n\tIFF(v_claim_notice_only_date_id IS NULL, - 1, v_claim_notice_only_date_id) AS claim_notice_only_date_id,\n\tclaim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(v_claim_cat_start_date_id IS NOT NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tclaim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(v_claim_cat_end_date_id IS NOT NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tclaim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, -1)\n\tIFF(v_claim_rep_assigned_date_id IS NOT NULL, v_claim_rep_assigned_date_id, - 1) AS claim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, -1)\n\tIFF(v_claim_rep_unassigned_date_id IS NOT NULL, v_claim_rep_unassigned_date_id, - 1) AS claim_rep_unassigned_date_id,\n\tclaim_trans_id,\n\tpol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_eff_date_id), v_pol_eff_date_id, -1)\n\tIFF(v_pol_eff_date_id IS NOT NULL, v_pol_eff_date_id, - 1) AS pol_eff_date_id,\n\tpol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_exp_date_id), v_pol_exp_date_id, -1 )\n\tIFF(v_pol_exp_date_id IS NOT NULL, v_pol_exp_date_id, - 1) AS pol_exp_date_id,\n\tIN_claimant_cov_det_ak_id,\n\tIN_cause_of_loss,\n\tIN_reserve_ctgry,\n\tIN_type_disability,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tsource_sys_id,\n\taudit_id,\n\terr_flag,\n\tdefault_dim_id,\n\treferred_to_subrogation_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(referred_to_subrogation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_referred_to_subrogation_date_id,\n\t-- *INF*: IIF(ISNULL(v_referred_to_subrogation_date_id), -1, v_referred_to_subrogation_date_id)\n\tIFF(v_referred_to_subrogation_date_id IS NULL, - 1, v_referred_to_subrogation_date_id) AS referred_to_subrogation_date_id,\n\tpay_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pay_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_start_date_id,\n\t-- *INF*: IIF(ISNULL(v_pay_start_date_id), -1, v_pay_start_date_id)\n\tIFF(v_pay_start_date_id IS NULL, - 1, v_pay_start_date_id) AS pay_start_date_id,\n\tclosure_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(closure_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_closure_date_id,\n\t-- *INF*: IIF(ISNULL(v_closure_date_id), -1, v_closure_date_id)\n\tIFF(v_closure_date_id IS NULL, - 1, v_closure_date_id) AS closure_date_id,\n\tcontract_cust_dim_id_out,\n\tcontract_cust_dim_hist_id_out,\n\tpms_acct_entered_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pms_acct_entered_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pms_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS V_acct_entered_date,\n\tV_acct_entered_date AS acct_entered_date_id,\n\tstrtgc_bus_dvsn_dim_id,\n\tpayment_entry_operator_id_out,\n\tpayment_entry_operator_hist_id_out,\n\tO_InsuranceReferenceDimId AS InsuranceReferenceDimId,\n\tO_AgencyDimID AS AgencyDimID,\n\tO_SalesDivisionDimID AS SalesDivisionDimID,\n\tO_InsuranceReferenceCoverageDetailDimID AS InsuranceReferenceCoverageDetailDimID,\n\tO_CoverageDetailDimId AS CoverageDetailDimId,\n\tout_ClaimReserveDimId AS ClaimReserveDimId,\n\tout_FeatureRepresentativeDimId AS FeatureRepresentativeDimId,\n\tFeatureRepresentativeAssignedDate AS in_FeatureRepresentativeAssignedDate,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(in_FeatureRepresentativeAssignedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_in_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS var_FeatureRepresentativeAssignedDate_id,\n\t-- *INF*: IIF(ISNULL(var_FeatureRepresentativeAssignedDate_id),\r\n\t-- -1,\r\n\t-- var_FeatureRepresentativeAssignedDate_id)\n\tIFF(\n\t    var_FeatureRepresentativeAssignedDate_id IS NULL, - 1,\n\t    var_FeatureRepresentativeAssignedDate_id\n\t) AS out_FeatureRepresentativeAssignedDate_id\n\tFROM EXP_set_default_dim_ids\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_trans_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_trans_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(trans_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(reprocess_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_referred_to_subrogation_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(referred_to_subrogation_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pay_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_closure_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(closure_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pms_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pms_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pms_acct_entered_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_in_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_in_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(in_FeatureRepresentativeAssignedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n),\nEXP_set_financial_values AS (\n\tSELECT\n\tclaim_occurrence_dim_id_out,\n\tclaim_occurrence_dim_hist_id_out,\n\tclaimant_dim_id_out,\n\tclaimant_dim_hist_id_out,\n\tclaimant_cov_dim_id_out,\n\tclaimant_cov_dim_hist_id_out,\n\tcov_dim_id_out,\n\tcov_dim_hist_id_out,\n\tclaim_trans_type_dim_id_out,\n\tclaim_financial_type_dim_id_out,\n\tclaim_rep_prim_claim_rep_dim_id_out,\n\tclaim_rep_prim_claim_rep_dim_hist_id_out,\n\tclaim_rep_dim_examiner_id_out,\n\tclaim_rep_dim_examiner_hist_id_out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tclaim_rep_dim_prim_litigation_handler_hist_id_out,\n\tpol_key_dim_id_out,\n\tpol_key_dim_hist_id_out,\n\tagency_dim_id_out,\n\tagency_dim_hist_id_out,\n\tclaim_payment_dim_id_out,\n\tclaim_payment_dim_hist_id_out,\n\ttax_id,\n\tclaim_master_1099_list_dim_id_out,\n\tclaim_pay_ctgry_type_dim_id_out,\n\tclaim_pay_ctgry_type_dim_hist_id_out,\n\tclaim_created_by_dim_id,\n\tclaim_case_dim_id_out,\n\tclaim_case_dim_hist_id_out,\n\tclaim_subrogation_dim_id_out,\n\tclaim_trans_oper_dim_id,\n\ttrans_date,\n\tclaim_trans_date_id,\n\treprocess_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_scripted_date_id,\n\tclaim_occurrence_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tclaim_trans_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tIN_claimant_cov_det_ak_id,\n\tIN_cause_of_loss,\n\tIN_reserve_ctgry,\n\tIN_type_disability,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_ctgry_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tsource_sys_id,\n\taudit_id,\n\terr_flag,\n\tdefault_dim_id,\n\treferred_to_subrogation_date_id,\n\tpay_start_date_id,\n\tclosure_date_id,\n\tcontract_cust_dim_id_out,\n\tcontract_cust_dim_hist_id_out,\n\t-- *INF*: IIF(financial_type_code = 'D', \r\n\t-- DECODE(trans_code,  '20', trans_amt, \r\n\t-- '21',trans_amt, \r\n\t-- '22', trans_amt, \r\n\t-- '23',trans_amt, \r\n\t-- '24', trans_amt, \r\n\t-- '28', trans_amt, \r\n\t-- '29', trans_amt, \r\n\t-- '41', 0, \r\n\t-- '42', 0, \r\n\t-- '43', 0, \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'D',\n\t    DECODE(\n\t        trans_code,\n\t        '20', trans_amt,\n\t        '21', trans_amt,\n\t        '22', trans_amt,\n\t        '23', trans_amt,\n\t        '24', trans_amt,\n\t        '28', trans_amt,\n\t        '29', trans_amt,\n\t        '41', 0,\n\t        '42', 0,\n\t        '43', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_loss_paid_excluding_recoveries,\n\t-- *INF*: IIF(financial_type_code = 'D', \r\n\t-- DECODE(trans_code, '20', 0,\r\n\t-- '21', trans_amt * -1, \r\n\t-- '22', (trans_amt  -  trans_hist_amt ) * -1, \r\n\t-- '23', 0, \r\n\t-- '24', 0, \r\n\t-- '28', trans_amt * -1, \r\n\t-- '29', 0, \r\n\t-- '41', trans_hist_amt, \r\n\t-- '42', trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', trans_hist_amt, \r\n\t-- '66', trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), 0))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(\n\t    financial_type_code = 'D',\n\t    DECODE(\n\t        trans_code,\n\t        '20', 0,\n\t        '21', trans_amt * - 1,\n\t        '22', (trans_amt - trans_hist_amt) * - 1,\n\t        '23', 0,\n\t        '24', 0,\n\t        '28', trans_amt * - 1,\n\t        '29', 0,\n\t        '41', trans_hist_amt,\n\t        '42', trans_hist_amt,\n\t        '43', 0,\n\t        '65', trans_hist_amt,\n\t        '66', trans_hist_amt,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        0\n\t    )\n\t) AS var_direct_loss_outstanding_excluding_recoveries,\n\t-- *INF*: IIF(financial_type_code = 'D', \r\n\t-- DECODE(trans_code, '20', trans_amt,\r\n\t-- '21', 0, \r\n\t-- '22', trans_hist_amt, \r\n\t-- '23', trans_amt, \r\n\t-- '24', trans_amt, \r\n\t-- '28',0, \r\n\t-- '29', trans_amt, \r\n\t-- '41', trans_hist_amt, \r\n\t-- '42', trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', trans_hist_amt, \r\n\t-- '66', trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'D', '23', trans_date)), 0, trans_hist_amt), 0))\n\tIFF(\n\t    financial_type_code = 'D',\n\t    DECODE(\n\t        trans_code,\n\t        '20', trans_amt,\n\t        '21', 0,\n\t        '22', trans_hist_amt,\n\t        '23', trans_amt,\n\t        '24', trans_amt,\n\t        '28', 0,\n\t        '29', trans_amt,\n\t        '41', trans_hist_amt,\n\t        '42', trans_hist_amt,\n\t        '43', 0,\n\t        '65', trans_hist_amt,\n\t        '66', trans_hist_amt,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        0\n\t    )\n\t) AS var_direct_loss_incurred_excluding_recoveries,\n\t-- *INF*: IIF(financial_type_code = 'E', \r\n\t-- DECODE(trans_code,  '20', trans_amt, \r\n\t-- '21',trans_amt, \r\n\t-- '22', trans_amt, \r\n\t-- '23',trans_amt, \r\n\t-- '24', trans_amt, \r\n\t-- '28', trans_amt, \r\n\t-- '29', trans_amt,\r\n\t-- '40',0, \r\n\t-- '41', 0, \r\n\t-- '42', 0, \r\n\t-- '43', 0, \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'E',\n\t    DECODE(\n\t        trans_code,\n\t        '20', trans_amt,\n\t        '21', trans_amt,\n\t        '22', trans_amt,\n\t        '23', trans_amt,\n\t        '24', trans_amt,\n\t        '28', trans_amt,\n\t        '29', trans_amt,\n\t        '40', 0,\n\t        '41', 0,\n\t        '42', 0,\n\t        '43', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_alae_paid_excluding_recoveries,\n\t-- *INF*: IIF(financial_type_code = 'E'  and IN (source_sys_id , 'EXCEED', 'DCT'),\r\n\t-- DECODE(trans_code, '20', 0,\r\n\t-- '21', trans_amt * -1, \r\n\t-- '22', (trans_amt -  trans_hist_amt ) * -1, \r\n\t-- '23', 0, \r\n\t-- '24', 0, \r\n\t-- '28', trans_amt * -1, \r\n\t-- '29', 0,\r\n\t-- '40',trans_hist_amt, \r\n\t-- '41', trans_hist_amt, \r\n\t-- '42', trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', trans_hist_amt, \r\n\t-- '66', trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'E', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'E', '23', trans_date)), 0, trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'E', '23', trans_date)), 0, trans_hist_amt), 0),\r\n\t-- 0)\r\n\t-- \n\tIFF(\n\t    financial_type_code = 'E' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '20', 0,\n\t        '21', trans_amt * - 1,\n\t        '22', (trans_amt - trans_hist_amt) * - 1,\n\t        '23', 0,\n\t        '24', 0,\n\t        '28', trans_amt * - 1,\n\t        '29', 0,\n\t        '40', trans_hist_amt,\n\t        '41', trans_hist_amt,\n\t        '42', trans_hist_amt,\n\t        '43', 0,\n\t        '65', trans_hist_amt,\n\t        '66', trans_hist_amt,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_alae_outstanding_excluding_recoveries,\n\t-- *INF*: var_direct_alae_paid_excluding_recoveries + var_direct_alae_outstanding_excluding_recoveries\r\n\t-- --JIRA-PROD-4418 Use variables to calculate var_direct_alae_incurred_excluding_recoveries instead of calculating it again based on financial_type_code, source_sys_id and trans_code.\n\tvar_direct_alae_paid_excluding_recoveries + var_direct_alae_outstanding_excluding_recoveries AS var_direct_alae_incurred_excluding_recoveries,\n\t-- *INF*: IIF(financial_type_code = 'B', \r\n\t-- DECODE(trans_code,  '25',IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '30',IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- '41', 0, \r\n\t-- '42', 0,  \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'B',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '41', 0,\n\t        '42', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_subrogation_paid,\n\t-- *INF*: IIF(financial_type_code = 'B' and IN (source_sys_id , 'EXCEED', 'DCT'),\r\n\t-- DECODE(trans_code, '25', 0,\r\n\t-- '30',0,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '33', 0, \r\n\t-- '34', 0, \r\n\t-- '38', trans_amt, \r\n\t-- '39', 0, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\r\n\t-- \n\tIFF(\n\t    financial_type_code = 'B' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', 0,\n\t        '30', 0,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '33', 0,\n\t        '34', 0,\n\t        '38', trans_amt,\n\t        '39', 0,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_subrogation_outstanding,\n\t-- *INF*: IIF(financial_type_code = 'B' and IN (source_sys_id , 'EXCEED', 'DCT'),\r\n\t-- DECODE(trans_code, '25', trans_amt * -1,\r\n\t-- '30',trans_amt * -1,\r\n\t-- '31', 0 , \r\n\t-- '32', trans_hist_amt * -1, \r\n\t-- '33', trans_amt * -1,\r\n\t-- '34', trans_amt * -1,\r\n\t-- '38', 0,\r\n\t-- '39', trans_amt * -1,\r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt  * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'B', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'B' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', trans_amt * - 1,\n\t        '30', trans_amt * - 1,\n\t        '31', 0,\n\t        '32', trans_hist_amt * - 1,\n\t        '33', trans_amt * - 1,\n\t        '34', trans_amt * - 1,\n\t        '38', 0,\n\t        '39', trans_amt * - 1,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_subrogation_incurred,\n\t-- *INF*: IIF(financial_type_code = 'S', \r\n\t-- DECODE(trans_code,  '25', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '30',IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),  \r\n\t-- '41', 0, \r\n\t-- '42', 0,  \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'S',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '41', 0,\n\t        '42', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_salvage_paid,\n\t-- *INF*: IIF(financial_type_code = 'S' and IN (source_sys_id , 'EXCEED', 'DCT'), \r\n\t-- DECODE(trans_code, '25', 0,\r\n\t-- '30',0,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '33', 0, \r\n\t-- '34', 0, \r\n\t-- '38', trans_amt, \r\n\t-- '39', 0, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'S' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', 0,\n\t        '30', 0,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '33', 0,\n\t        '34', 0,\n\t        '38', trans_amt,\n\t        '39', 0,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_salvage_outstanding,\n\t-- *INF*: IIF(financial_type_code = 'S'and IN (source_sys_id , 'EXCEED', 'DCT'),\r\n\t-- DECODE(trans_code, '25', trans_amt * -1,\r\n\t--  '25', trans_amt * -1,\r\n\t-- '31', 0, \r\n\t-- '32', trans_hist_amt * -1, \r\n\t-- '33', trans_amt * -1,\r\n\t-- '34',trans_amt * -1,\r\n\t-- '38',0,\r\n\t-- '39', trans_amt * -1,\r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'S', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'S' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', trans_amt * - 1,\n\t        '25', trans_amt * - 1,\n\t        '31', 0,\n\t        '32', trans_hist_amt * - 1,\n\t        '33', trans_amt * - 1,\n\t        '34', trans_amt * - 1,\n\t        '38', 0,\n\t        '39', trans_amt * - 1,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_salvage_incurred,\n\t-- *INF*: IIF(financial_type_code = 'R', \r\n\t-- DECODE(trans_code,  '25', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '30', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),  \r\n\t-- '41', 0, \r\n\t-- '42', 0,  \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'R',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '41', 0,\n\t        '42', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_paid,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT'), \r\n\t-- DECODE(trans_code, '25', 0,\r\n\t-- '30',0,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '33', 0, \r\n\t-- '34', 0, \r\n\t-- '38', trans_amt, \r\n\t-- '39', 0, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', 0,\n\t        '30', 0,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '33', 0,\n\t        '34', 0,\n\t        '38', trans_amt,\n\t        '39', 0,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_outstanding,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT'), \r\n\t-- DECODE(trans_code, '25', trans_amt * -1,\r\n\t-- '30',trans_amt * -1,\r\n\t-- '31', 0, \r\n\t-- '32', trans_hist_amt * -1, \r\n\t-- '33', trans_amt * -1,\r\n\t-- '34',trans_amt * -1,\r\n\t-- '38',0,\r\n\t-- '39', trans_amt * -1,\r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT'),\n\t    DECODE(\n\t        trans_code,\n\t        '25', trans_amt * - 1,\n\t        '30', trans_amt * - 1,\n\t        '31', 0,\n\t        '32', trans_hist_amt * - 1,\n\t        '33', trans_amt * - 1,\n\t        '34', trans_amt * - 1,\n\t        '38', 0,\n\t        '39', trans_amt * - 1,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_incurred,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT') and trans_ctgry_code<>'EX', \r\n\t-- DECODE(trans_code,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '38', trans_amt, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT') and trans_ctgry_code <> 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '38', trans_amt,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_loss_outstanding,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT') and trans_ctgry_code='EX', \r\n\t-- DECODE(trans_code,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '38', trans_amt, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT') and trans_ctgry_code = 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '38', trans_amt,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_alae_outstanding,\n\t-- *INF*: IIF(financial_type_code = 'R' and trans_ctgry_code <> 'EX', \r\n\t-- \tDECODE(trans_code, \r\n\t-- \t'25', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'30', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t0),\r\n\t-- 0)\r\n\t-- \r\n\t-- ----08/15/2011  Removed the filter of EXCEED data (and IN (source_sys_id , 'EXCEED', 'DCT')) \r\n\t-- ----JIRA-PROD-4418 Added condition for trans_code '30' and return trans_amt for PMS claims\n\tIFF(\n\t    financial_type_code = 'R' and trans_ctgry_code <> 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_loss_paid,\n\t-- *INF*: IIF(financial_type_code = 'R' and trans_ctgry_code = 'EX', \r\n\t-- \tDECODE(trans_code,  \r\n\t-- \t'25', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'30', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),\r\n\t-- \t'39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- \t 0)\r\n\t-- ,0)\r\n\t-- \r\n\t-- --- 08/15/2011 - Removed the filter of EXCEED data  (and source_sys_id='EXCEED')\r\n\t-- ----JIRA-PROD-4418 Added condition for trans_code '30' and return trans_amt for PMS claims\n\tIFF(\n\t    financial_type_code = 'R' and trans_ctgry_code = 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS var_direct_other_recovery_alae_paid,\n\t-- *INF*: IIF(financial_type_code = 'R' and trans_ctgry_code <> 'EX', \r\n\t-- DECODE(trans_code,  '25', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '30', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '31', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '32', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '33', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '34', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '38', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt), \r\n\t-- '39', IIF(IN (source_sys_id , 'EXCEED', 'DCT'), trans_amt * -1, trans_amt),  \r\n\t-- '41', 0, \r\n\t-- '42', 0,  \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(\n\t    financial_type_code = 'R' and trans_ctgry_code <> 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '25', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '30', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '31', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '32', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '33', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '34', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '38', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '39', IFF(\n\t            source_sys_id IN ('EXCEED','DCT'), trans_amt * - 1, trans_amt\n\t        ),\n\t        '41', 0,\n\t        '42', 0,\n\t        '65', 0,\n\t        '66', 0,\n\t        '90', 0,\n\t        '91', 0,\n\t        '92', 0,\n\t        0\n\t    ),\n\t    0\n\t) AS v_net_other_recovery_recvrd_chg_amt,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT') and trans_ctgry_code <> 'EX', \r\n\t-- DECODE(trans_code, '25', 0,\r\n\t-- '30',0,\r\n\t-- '31', trans_amt , \r\n\t-- '32', (trans_amt -  trans_hist_amt ), \r\n\t-- '33', 0, \r\n\t-- '34', 0, \r\n\t-- '38', trans_amt, \r\n\t-- '39', 0, \r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT') and trans_ctgry_code <> 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '25', 0,\n\t        '30', 0,\n\t        '31', trans_amt,\n\t        '32', (trans_amt - trans_hist_amt),\n\t        '33', 0,\n\t        '34', 0,\n\t        '38', trans_amt,\n\t        '39', 0,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS v_net_other_recovery_outstanding_reserve_chg_amt_OLD,\n\t-- *INF*: IIF(financial_type_code = 'R' and IN (source_sys_id , 'EXCEED', 'DCT') and trans_ctgry_code <> 'EX', \r\n\t-- DECODE(trans_code, '25', trans_amt * -1,\r\n\t-- '30',trans_amt * -1,\r\n\t-- '31', 0, \r\n\t-- '32', trans_hist_amt * -1, \r\n\t-- '33', trans_amt * -1,\r\n\t-- '34',trans_amt * -1,\r\n\t-- '38',0,\r\n\t-- '39', trans_amt * -1,\r\n\t-- '41', trans_hist_amt * -1, \r\n\t-- '42', trans_hist_amt * -1, \r\n\t-- '65', trans_hist_amt * -1, \r\n\t-- '66', trans_hist_amt * -1, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_TRANSACTION(IN_claimant_cov_det_ak_id,IN_cause_of_loss,IN_reserve_ctgry,IN_type_disability,'R', '33', trans_date)), 0, trans_hist_amt * -1), 0),\r\n\t-- 0)\n\tIFF(\n\t    financial_type_code = 'R' and source_sys_id IN ('EXCEED','DCT') and trans_ctgry_code <> 'EX',\n\t    DECODE(\n\t        trans_code,\n\t        '25', trans_amt * - 1,\n\t        '30', trans_amt * - 1,\n\t        '31', 0,\n\t        '32', trans_hist_amt * - 1,\n\t        '33', trans_amt * - 1,\n\t        '34', trans_amt * - 1,\n\t        '38', 0,\n\t        '39', trans_amt * - 1,\n\t        '41', trans_hist_amt * - 1,\n\t        '42', trans_hist_amt * - 1,\n\t        '65', trans_hist_amt * - 1,\n\t        '66', trans_hist_amt * - 1,\n\t        '90', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '91', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        '92', IFF(\n\t            LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id IS NOT NULL,\n\t            0,\n\t            trans_hist_amt * - 1\n\t        ),\n\t        0\n\t    ),\n\t    0\n\t) AS v_net_other_recovery_incurred_chg_amt,\n\tvar_direct_loss_paid_excluding_recoveries AS direct_loss_paid_excluding_recoveries,\n\tvar_direct_loss_outstanding_excluding_recoveries AS direct_loss_outstanding_excluding_recoveries,\n\tvar_direct_loss_incurred_excluding_recoveries AS direct_loss_incurred_excluding_recoveries,\n\tvar_direct_alae_paid_excluding_recoveries AS direct_alae_paid_excluding_recoveries,\n\tvar_direct_alae_outstanding_excluding_recoveries AS direct_alae_outstanding_excluding_recoveries,\n\t-- *INF*: var_direct_alae_paid_excluding_recoveries + var_direct_alae_outstanding_excluding_recoveries\r\n\t-- \r\n\t-- \r\n\t-- --- Changed to above logic on 8/15/2011 \r\n\t-- ---var_direct_alae_incurred_excluding_recoveries\n\tvar_direct_alae_paid_excluding_recoveries + var_direct_alae_outstanding_excluding_recoveries AS direct_alae_incurred_excluding_recoveries,\n\tvar_direct_subrogation_paid AS direct_subrogation_paid,\n\tvar_direct_subrogation_outstanding AS direct_subrogation_outstanding,\n\t-- *INF*: var_direct_subrogation_paid  +  var_direct_subrogation_outstanding\r\n\t-- \r\n\t-- \r\n\t-- ---var_direct_subrogation_incurred\n\tvar_direct_subrogation_paid + var_direct_subrogation_outstanding AS direct_subrogation_incurred,\n\tvar_direct_salvage_paid AS direct_salvage_paid,\n\tvar_direct_salvage_outstanding AS direct_salvage_outstanding,\n\t-- *INF*: var_direct_salvage_paid  + var_direct_salvage_outstanding\r\n\t-- ---var_direct_salvage_incurred\n\tvar_direct_salvage_paid + var_direct_salvage_outstanding AS direct_salvage_incurred,\n\tvar_direct_other_recovery_paid AS direct_other_recovery_paid,\n\tvar_direct_other_recovery_outstanding AS direct_other_recovery_outstanding,\n\t-- *INF*: var_direct_other_recovery_paid + var_direct_other_recovery_outstanding\r\n\t-- \r\n\t-- ---var_direct_other_recovery_incurred\n\tvar_direct_other_recovery_paid + var_direct_other_recovery_outstanding AS direct_other_recovery_incurred,\n\tvar_direct_other_recovery_loss_outstanding AS direct_other_recovery_loss_outstanding,\n\tvar_direct_other_recovery_loss_paid AS direct_other_recovery_loss_paid,\n\t-- *INF*: round(var_direct_other_recovery_loss_outstanding+var_direct_other_recovery_loss_paid,2)\n\tround(var_direct_other_recovery_loss_outstanding + var_direct_other_recovery_loss_paid, 2) AS direct_other_recovery_loss_incurred,\n\tvar_direct_other_recovery_alae_outstanding AS direct_other_recovery_alae_outstanding,\n\tvar_direct_other_recovery_alae_paid AS direct_other_recovery_alae_paid,\n\t-- *INF*: round(var_direct_other_recovery_alae_paid + var_direct_other_recovery_alae_outstanding,2)\n\tround(var_direct_other_recovery_alae_paid + var_direct_other_recovery_alae_outstanding, 2) AS direct_other_recovery_alae_incurred,\n\t-- *INF*: round(var_direct_loss_outstanding_excluding_recoveries + var_direct_subrogation_outstanding + var_direct_salvage_outstanding + var_direct_other_recovery_loss_outstanding,2)\n\tround(var_direct_loss_outstanding_excluding_recoveries + var_direct_subrogation_outstanding + var_direct_salvage_outstanding + var_direct_other_recovery_loss_outstanding, 2) AS direct_loss_outstanding_including_recoveries,\n\t-- *INF*: round(var_direct_loss_paid_excluding_recoveries + var_direct_subrogation_paid + var_direct_salvage_paid + var_direct_other_recovery_loss_paid,2)\n\tround(var_direct_loss_paid_excluding_recoveries + var_direct_subrogation_paid + var_direct_salvage_paid + var_direct_other_recovery_loss_paid, 2) AS direct_loss_paid_including_recoveries,\n\t-- *INF*: round(var_direct_loss_incurred_excluding_recoveries + var_direct_salvage_paid+var_direct_subrogation_paid +\r\n\t-- var_direct_other_recovery_loss_paid\r\n\t-- ,2)\n\tround(var_direct_loss_incurred_excluding_recoveries + var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid, 2) AS direct_loss_incurred_including_recoveries,\n\t-- *INF*: round(var_direct_loss_outstanding_excluding_recoveries +  var_direct_salvage_outstanding + var_direct_subrogation_outstanding +\r\n\t-- var_direct_other_recovery_loss_outstanding,2)\n\tround(var_direct_loss_outstanding_excluding_recoveries + var_direct_salvage_outstanding + var_direct_subrogation_outstanding + var_direct_other_recovery_loss_outstanding, 2) AS direct_loss_outstanding_out_BAD,\n\t-- *INF*: round(var_direct_loss_paid_excluding_recoveries + var_direct_salvage_paid+var_direct_subrogation_paid + var_direct_other_recovery_loss_paid,2)\n\tround(var_direct_loss_paid_excluding_recoveries + var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid, 2) AS direct_loss_paid_out_BAD,\n\t-- *INF*: round(var_direct_loss_outstanding_excluding_recoveries + var_direct_salvage_outstanding + var_direct_subrogation_incurred + var_direct_loss_incurred_excluding_recoveries,2)\n\tround(var_direct_loss_outstanding_excluding_recoveries + var_direct_salvage_outstanding + var_direct_subrogation_incurred + var_direct_loss_incurred_excluding_recoveries, 2) AS direct_loss_incurred_out_BAD,\n\t-- *INF*: round(var_direct_alae_paid_excluding_recoveries+var_direct_other_recovery_alae_paid,2)\n\tround(var_direct_alae_paid_excluding_recoveries + var_direct_other_recovery_alae_paid, 2) AS direct_alae_paid_including_recoveries,\n\t-- *INF*: round(var_direct_alae_outstanding_excluding_recoveries + var_direct_other_recovery_alae_outstanding,2)\n\tround(var_direct_alae_outstanding_excluding_recoveries + var_direct_other_recovery_alae_outstanding, 2) AS direct_alae_outstanding_including_recoveries,\n\t-- *INF*: round(var_direct_alae_incurred_excluding_recoveries + var_direct_other_recovery_alae_paid,2)\n\tround(var_direct_alae_incurred_excluding_recoveries + var_direct_other_recovery_alae_paid, 2) AS direct_alae_incurred_including_recoveries,\n\t-- *INF*: round(var_direct_salvage_paid+var_direct_subrogation_paid + var_direct_other_recovery_loss_paid,2)\n\tround(var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid, 2) AS total_direct_loss_recovery_paid,\n\t-- *INF*: round(var_direct_salvage_outstanding + var_direct_subrogation_outstanding + var_direct_other_recovery_loss_outstanding ,2)\n\tround(var_direct_salvage_outstanding + var_direct_subrogation_outstanding + var_direct_other_recovery_loss_outstanding, 2) AS total_direct_loss_recovery_outstanding,\n\t-- *INF*: round(var_direct_salvage_paid + \r\n\t-- var_direct_subrogation_paid + \r\n\t-- var_direct_other_recovery_loss_paid + \r\n\t-- var_direct_salvage_outstanding +\r\n\t-- var_direct_subrogation_outstanding + \r\n\t-- var_direct_other_recovery_loss_outstanding\r\n\t--  ,2)\r\n\t-- \n\tround(var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid + var_direct_salvage_outstanding + var_direct_subrogation_outstanding + var_direct_other_recovery_loss_outstanding, 2) AS total_direct_loss_recovery_incurred,\n\t-- *INF*: round(var_direct_loss_paid_excluding_recoveries + var_direct_salvage_paid+var_direct_subrogation_paid + var_direct_other_recovery_loss_paid,2)\n\tround(var_direct_loss_paid_excluding_recoveries + var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid, 2) AS net_loss_paid,\n\t-- *INF*: round(var_direct_loss_outstanding_excluding_recoveries,2)\n\tround(var_direct_loss_outstanding_excluding_recoveries, 2) AS net_loss_outstanding,\n\t-- *INF*: round(var_direct_loss_incurred_excluding_recoveries + var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid,2)\r\n\t-- \n\tround(var_direct_loss_incurred_excluding_recoveries + var_direct_salvage_paid + var_direct_subrogation_paid + var_direct_other_recovery_loss_paid, 2) AS net_loss_incurred,\n\t-- *INF*: round(var_direct_alae_paid_excluding_recoveries+var_direct_other_recovery_alae_paid,2)\n\tround(var_direct_alae_paid_excluding_recoveries + var_direct_other_recovery_alae_paid, 2) AS net_alae_paid,\n\t-- *INF*: round(var_direct_alae_outstanding_excluding_recoveries + var_direct_other_recovery_alae_outstanding,2)\n\tround(var_direct_alae_outstanding_excluding_recoveries + var_direct_other_recovery_alae_outstanding, 2) AS net_alae_outstanding,\n\t-- *INF*: round(var_direct_alae_incurred_excluding_recoveries + var_direct_other_recovery_alae_paid + var_direct_other_recovery_alae_outstanding,2)\r\n\t-- \n\tround(var_direct_alae_incurred_excluding_recoveries + var_direct_other_recovery_alae_paid + var_direct_other_recovery_alae_outstanding, 2) AS net_alae_incurred,\n\tacct_entered_date_id,\n\tstrtgc_bus_dvsn_dim_id\n\tFROM EXP_set_default_date_ids\n\tLEFT JOIN LKP_CLAIM_TRANSACTION LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date\n\tON LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.claimant_cov_det_ak_id = IN_claimant_cov_det_ak_id\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.cause_of_loss = IN_cause_of_loss\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.reserve_ctgry = IN_reserve_ctgry\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.type_disability = IN_type_disability\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.financial_type_code = 'D'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.trans_code = '23'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_D_23_trans_date.trans_date = trans_date\n\n\tLEFT JOIN LKP_CLAIM_TRANSACTION LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date\n\tON LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.claimant_cov_det_ak_id = IN_claimant_cov_det_ak_id\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.cause_of_loss = IN_cause_of_loss\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.reserve_ctgry = IN_reserve_ctgry\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.type_disability = IN_type_disability\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.financial_type_code = 'E'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.trans_code = '23'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_E_23_trans_date.trans_date = trans_date\n\n\tLEFT JOIN LKP_CLAIM_TRANSACTION LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date\n\tON LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.claimant_cov_det_ak_id = IN_claimant_cov_det_ak_id\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.cause_of_loss = IN_cause_of_loss\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.reserve_ctgry = IN_reserve_ctgry\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.type_disability = IN_type_disability\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.financial_type_code = 'B'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.trans_code = '33'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_B_33_trans_date.trans_date = trans_date\n\n\tLEFT JOIN LKP_CLAIM_TRANSACTION LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date\n\tON LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.claimant_cov_det_ak_id = IN_claimant_cov_det_ak_id\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.cause_of_loss = IN_cause_of_loss\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.reserve_ctgry = IN_reserve_ctgry\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.type_disability = IN_type_disability\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.financial_type_code = 'S'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.trans_code = '33'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_S_33_trans_date.trans_date = trans_date\n\n\tLEFT JOIN LKP_CLAIM_TRANSACTION LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date\n\tON LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.claimant_cov_det_ak_id = IN_claimant_cov_det_ak_id\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.cause_of_loss = IN_cause_of_loss\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.reserve_ctgry = IN_reserve_ctgry\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.type_disability = IN_type_disability\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.financial_type_code = 'R'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.trans_code = '33'\n\tAND LKP_CLAIM_TRANSACTION_IN_claimant_cov_det_ak_id_IN_cause_of_loss_IN_reserve_ctgry_IN_type_disability_R_33_trans_date.trans_date = trans_date\n\n),\nLKP_Claim_Loss_Transaction_Fact AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\tedw_claim_trans_pk_id,\n\tclaim_occurrence_dim_id,\n\tclaim_occurrence_dim_hist_id,\n\tclaimant_dim_id,\n\tclaimant_dim_hist_id,\n\tclaimant_cov_dim_id,\n\tclaimant_cov_dim_hist_id,\n\tcov_dim_id,\n\tcov_dim_hist_id,\n\tclaim_trans_type_dim_id,\n\tclaim_financial_type_dim_id,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_dim_prim_claim_rep_hist_id,\n\tclaim_rep_dim_examiner_id,\n\tclaim_rep_dim_examiner_hist_id,\n\tclaim_rep_dim_prim_litigation_handler_id,\n\tclaim_rep_dim_prim_litigation_handler_hist_id,\n\tclaim_rep_dim_trans_entry_oper_id,\n\tclaim_rep_dim_trans_entry_oper_hist_id,\n\tclaim_rep_dim_claim_created_by_id,\n\tpol_dim_id,\n\tpol_dim_hist_id,\n\tagency_dim_id,\n\tagency_dim_hist_id,\n\tclaim_pay_dim_id,\n\tclaim_pay_dim_hist_id,\n\tclaim_pay_ctgry_type_dim_id,\n\tclaim_pay_ctgry_type_dim_hist_id,\n\tclaim_case_dim_id,\n\tclaim_case_dim_hist_id,\n\tcontract_cust_dim_id,\n\tcontract_cust_dim_hist_id,\n\tclaim_master_1099_list_dim_id,\n\tclaim_subrogation_dim_id,\n\tclaim_trans_date_id,\n\tclaim_trans_reprocess_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tclaim_subrogation_referred_to_subrogation_date_id,\n\tclaim_subrogation_pay_start_date_id,\n\tclaim_subrogation_closure_date_id,\n\tacct_entered_date_id,\n\ttrans_amt,\n\ttrans_hist_amt,\n\ttax_id,\n\tdirect_loss_paid_excluding_recoveries,\n\tdirect_loss_outstanding_excluding_recoveries,\n\tdirect_loss_incurred_excluding_recoveries,\n\tdirect_alae_paid_excluding_recoveries,\n\tdirect_alae_outstanding_excluding_recoveries,\n\tdirect_alae_incurred_excluding_recoveries,\n\tdirect_loss_paid_including_recoveries,\n\tdirect_loss_outstanding_including_recoveries,\n\tdirect_loss_incurred_including_recoveries,\n\tdirect_alae_paid_including_recoveries,\n\tdirect_alae_outstanding_including_recoveries,\n\tdirect_alae_incurred_including_recoveries,\n\tdirect_subrogation_paid,\n\tdirect_subrogation_outstanding,\n\tdirect_subrogation_incurred,\n\tdirect_salvage_paid,\n\tdirect_salvage_outstanding,\n\tdirect_salvage_incurred,\n\tdirect_other_recovery_loss_paid,\n\tdirect_other_recovery_loss_outstanding,\n\tdirect_other_recovery_loss_incurred,\n\tdirect_other_recovery_alae_paid,\n\tdirect_other_recovery_alae_outstanding,\n\tdirect_other_recovery_alae_incurred,\n\ttotal_direct_loss_recovery_paid,\n\ttotal_direct_loss_recovery_outstanding,\n\ttotal_direct_loss_recovery_incurred,\n\tdirect_other_recovery_paid,\n\tdirect_other_recovery_outstanding,\n\tdirect_other_recovery_incurred,\n\tceded_loss_paid,\n\tceded_loss_outstanding,\n\tceded_loss_incurred,\n\tceded_alae_paid,\n\tceded_alae_outstanding,\n\tceded_alae_incurred,\n\tceded_salvage_paid,\n\tceded_subrogation_paid,\n\tceded_other_recovery_loss_paid,\n\tceded_other_recovery_alae_paid,\n\ttotal_ceded_loss_recovery_paid,\n\tnet_loss_paid,\n\tnet_loss_outstanding,\n\tnet_loss_incurred,\n\tnet_alae_paid,\n\tnet_alae_outstanding,\n\tnet_alae_incurred,\n\tstrtgc_bus_dvsn_dim_id,\n\tClaimReserveDimId,\n\tClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tFeatureRepresentativeAssignedDateId,\n\tInsuranceReferenceDimId,\n\tAgencyDimId,\n\tSalesDivisionDimId,\n\tInsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_loss_trans_fact_id,\n\t\t\tedw_claim_trans_pk_id,\n\t\t\tclaim_occurrence_dim_id,\n\t\t\tclaim_occurrence_dim_hist_id,\n\t\t\tclaimant_dim_id,\n\t\t\tclaimant_dim_hist_id,\n\t\t\tclaimant_cov_dim_id,\n\t\t\tclaimant_cov_dim_hist_id,\n\t\t\tcov_dim_id,\n\t\t\tcov_dim_hist_id,\n\t\t\tclaim_trans_type_dim_id,\n\t\t\tclaim_financial_type_dim_id,\n\t\t\tclaim_rep_dim_prim_claim_rep_id,\n\t\t\tclaim_rep_dim_prim_claim_rep_hist_id,\n\t\t\tclaim_rep_dim_examiner_id,\n\t\t\tclaim_rep_dim_examiner_hist_id,\n\t\t\tclaim_rep_dim_prim_litigation_handler_id,\n\t\t\tclaim_rep_dim_prim_litigation_handler_hist_id,\n\t\t\tclaim_rep_dim_trans_entry_oper_id,\n\t\t\tclaim_rep_dim_trans_entry_oper_hist_id,\n\t\t\tclaim_rep_dim_claim_created_by_id,\n\t\t\tpol_dim_id,\n\t\t\tpol_dim_hist_id,\n\t\t\tagency_dim_id,\n\t\t\tagency_dim_hist_id,\n\t\t\tclaim_pay_dim_id,\n\t\t\tclaim_pay_dim_hist_id,\n\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\tclaim_pay_ctgry_type_dim_hist_id,\n\t\t\tclaim_case_dim_id,\n\t\t\tclaim_case_dim_hist_id,\n\t\t\tcontract_cust_dim_id,\n\t\t\tcontract_cust_dim_hist_id,\n\t\t\tclaim_master_1099_list_dim_id,\n\t\t\tclaim_subrogation_dim_id,\n\t\t\tclaim_trans_date_id,\n\t\t\tclaim_trans_reprocess_date_id,\n\t\t\tclaim_loss_date_id,\n\t\t\tclaim_discovery_date_id,\n\t\t\tclaim_scripted_date_id,\n\t\t\tsource_claim_rpted_date_id,\n\t\t\tclaim_rpted_date_id,\n\t\t\tclaim_open_date_id,\n\t\t\tclaim_close_date_id,\n\t\t\tclaim_reopen_date_id,\n\t\t\tclaim_closed_after_reopen_date_id,\n\t\t\tclaim_notice_only_date_id,\n\t\t\tclaim_cat_start_date_id,\n\t\t\tclaim_cat_end_date_id,\n\t\t\tclaim_rep_assigned_date_id,\n\t\t\tclaim_rep_unassigned_date_id,\n\t\t\tpol_eff_date_id,\n\t\t\tpol_exp_date_id,\n\t\t\tclaim_subrogation_referred_to_subrogation_date_id,\n\t\t\tclaim_subrogation_pay_start_date_id,\n\t\t\tclaim_subrogation_closure_date_id,\n\t\t\tacct_entered_date_id,\n\t\t\ttrans_amt,\n\t\t\ttrans_hist_amt,\n\t\t\ttax_id,\n\t\t\tdirect_loss_paid_excluding_recoveries,\n\t\t\tdirect_loss_outstanding_excluding_recoveries,\n\t\t\tdirect_loss_incurred_excluding_recoveries,\n\t\t\tdirect_alae_paid_excluding_recoveries,\n\t\t\tdirect_alae_outstanding_excluding_recoveries,\n\t\t\tdirect_alae_incurred_excluding_recoveries,\n\t\t\tdirect_loss_paid_including_recoveries,\n\t\t\tdirect_loss_outstanding_including_recoveries,\n\t\t\tdirect_loss_incurred_including_recoveries,\n\t\t\tdirect_alae_paid_including_recoveries,\n\t\t\tdirect_alae_outstanding_including_recoveries,\n\t\t\tdirect_alae_incurred_including_recoveries,\n\t\t\tdirect_subrogation_paid,\n\t\t\tdirect_subrogation_outstanding,\n\t\t\tdirect_subrogation_incurred,\n\t\t\tdirect_salvage_paid,\n\t\t\tdirect_salvage_outstanding,\n\t\t\tdirect_salvage_incurred,\n\t\t\tdirect_other_recovery_loss_paid,\n\t\t\tdirect_other_recovery_loss_outstanding,\n\t\t\tdirect_other_recovery_loss_incurred,\n\t\t\tdirect_other_recovery_alae_paid,\n\t\t\tdirect_other_recovery_alae_outstanding,\n\t\t\tdirect_other_recovery_alae_incurred,\n\t\t\ttotal_direct_loss_recovery_paid,\n\t\t\ttotal_direct_loss_recovery_outstanding,\n\t\t\ttotal_direct_loss_recovery_incurred,\n\t\t\tdirect_other_recovery_paid,\n\t\t\tdirect_other_recovery_outstanding,\n\t\t\tdirect_other_recovery_incurred,\n\t\t\tceded_loss_paid,\n\t\t\tceded_loss_outstanding,\n\t\t\tceded_loss_incurred,\n\t\t\tceded_alae_paid,\n\t\t\tceded_alae_outstanding,\n\t\t\tceded_alae_incurred,\n\t\t\tceded_salvage_paid,\n\t\t\tceded_subrogation_paid,\n\t\t\tceded_other_recovery_loss_paid,\n\t\t\tceded_other_recovery_alae_paid,\n\t\t\ttotal_ceded_loss_recovery_paid,\n\t\t\tnet_loss_paid,\n\t\t\tnet_loss_outstanding,\n\t\t\tnet_loss_incurred,\n\t\t\tnet_alae_paid,\n\t\t\tnet_alae_outstanding,\n\t\t\tnet_alae_incurred,\n\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\tClaimReserveDimId,\n\t\t\tClaimRepresentativeDimFeatureClaimRepresentativeId,\n\t\t\tFeatureRepresentativeAssignedDateId,\n\t\t\tInsuranceReferenceDimId,\n\t\t\tAgencyDimId,\n\t\t\tSalesDivisionDimId,\n\t\t\tInsuranceReferenceCoverageDimId,\n\t\t\tCoverageDetailDimId\n\t\tFROM claim_loss_transaction_fact\n\t\tWHERE audit_id > 0\r\n\t\t\r\n\t\t\r\n\t\t--- If we do not put this filter, we will insert additional transaction when trans code chnages from 90-91-92. We need to lookup only for Direct Transaction. --This way it exludes audit_id = -50 as these will have same edw_trans_pk_Id\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_trans_pk_id ORDER BY claim_loss_trans_fact_id DESC) = 1\n),\nEXP_DETECT_CHANGES AS (\n\tSELECT\n\tLKP_Claim_Loss_Transaction_Fact.claim_loss_trans_fact_id AS lkp_claim_loss_trans_fact_id,\n\tLKP_Claim_Loss_Transaction_Fact.edw_claim_trans_pk_id AS lkp_edw_claim_trans_pk_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_occurrence_dim_id AS lkp_claim_occurrence_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_occurrence_dim_hist_id AS lkp_claim_occurrence_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claimant_dim_id AS lkp_claimant_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claimant_dim_hist_id AS lkp_claimant_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claimant_cov_dim_id AS lkp_claimant_cov_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claimant_cov_dim_hist_id AS lkp_claimant_cov_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.cov_dim_id AS lkp_cov_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.cov_dim_hist_id AS lkp_cov_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_trans_type_dim_id AS lkp_claim_trans_type_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_financial_type_dim_id AS lkp_claim_financial_type_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_prim_claim_rep_id AS lkp_claim_rep_dim_prim_claim_rep_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_prim_claim_rep_hist_id AS lkp_claim_rep_dim_prim_claim_rep_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_examiner_id AS lkp_claim_rep_dim_examiner_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_examiner_hist_id AS lkp_claim_rep_dim_examiner_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_prim_litigation_handler_id AS lkp_claim_rep_dim_prim_litigation_handler_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_prim_litigation_handler_hist_id AS lkp_claim_rep_dim_prim_litigation_handler_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_trans_entry_oper_id AS lkp_claim_rep_dim_trans_entry_oper_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_trans_entry_oper_hist_id AS lkp_claim_rep_dim_trans_entry_oper_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_dim_claim_created_by_id AS lkp_claim_rep_dim_claim_created_by_id,\n\tLKP_Claim_Loss_Transaction_Fact.pol_dim_id AS lkp_pol_key_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.pol_dim_hist_id AS lkp_pol_key_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.agency_dim_id AS lkp_agency_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.agency_dim_hist_id AS lkp_agency_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_pay_dim_id AS lkp_claim_pay_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_pay_dim_hist_id AS lkp_claim_pay_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_pay_ctgry_type_dim_id AS lkp_claim_pay_ctgry_type_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_pay_ctgry_type_dim_hist_id AS lkp_claim_pay_ctgry_type_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_case_dim_id AS lkp_claim_case_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_case_dim_hist_id AS lkp_claim_case_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.contract_cust_dim_id AS lkp_contract_cust_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.contract_cust_dim_hist_id AS lkp_contract_cust_dim_hist_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_master_1099_list_dim_id AS lkp_claim_master_1099_list_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_subrogation_dim_id AS lkp_claim_subrogation_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_trans_date_id AS lkp_claim_trans_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_trans_reprocess_date_id AS lkp_claim_trans_reprocess_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_loss_date_id AS lkp_claim_loss_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_discovery_date_id AS lkp_claim_discovery_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_scripted_date_id AS lkp_claim_scripted_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.source_claim_rpted_date_id AS lkp_source_claim_rpted_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rpted_date_id AS lkp_claim_rpted_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_open_date_id AS lkp_claim_open_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_close_date_id AS lkp_claim_close_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_reopen_date_id AS lkp_claim_reopen_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_closed_after_reopen_date_id AS lkp_claim_closed_after_reopen_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_notice_only_date_id AS lkp_claim_notice_only_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_cat_start_date_id AS lkp_claim_cat_start_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_cat_end_date_id AS lkp_claim_cat_end_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_assigned_date_id AS lkp_claim_rep_assigned_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_rep_unassigned_date_id AS lkp_claim_rep_unassigned_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.pol_eff_date_id AS lkp_pol_eff_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.pol_exp_date_id AS lkp_pol_exp_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_subrogation_referred_to_subrogation_date_id AS lkp_claim_subrogation_referred_to_subrogation_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_subrogation_pay_start_date_id AS lkp_claim_subrogation_pay_start_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.claim_subrogation_closure_date_id AS lkp_claim_subrogation_closure_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.acct_entered_date_id AS lkp_acct_entered_date_id,\n\tLKP_Claim_Loss_Transaction_Fact.trans_amt AS lkp_trans_amt,\n\tLKP_Claim_Loss_Transaction_Fact.trans_hist_amt AS lkp_trans_hist_amt,\n\tLKP_Claim_Loss_Transaction_Fact.tax_id AS lkp_tax_id,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_paid_excluding_recoveries AS lkp_direct_loss_paid_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_outstanding_excluding_recoveries AS lkp_direct_loss_outstanding_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_incurred_excluding_recoveries AS lkp_direct_loss_incurred_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_paid_excluding_recoveries AS lkp_direct_alae_paid_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_outstanding_excluding_recoveries AS lkp_direct_alae_outstanding_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_incurred_excluding_recoveries AS lkp_direct_alae_incurred_excluding_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_paid_including_recoveries AS lkp_direct_loss_paid_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_outstanding_including_recoveries AS lkp_direct_loss_outstanding_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_loss_incurred_including_recoveries AS lkp_direct_loss_incurred_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_paid_including_recoveries AS lkp_direct_alae_paid_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_outstanding_including_recoveries AS lkp_direct_alae_outstanding_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_alae_incurred_including_recoveries AS lkp_direct_alae_incurred_including_recoveries,\n\tLKP_Claim_Loss_Transaction_Fact.direct_subrogation_paid AS lkp_direct_subrogation_paid,\n\tLKP_Claim_Loss_Transaction_Fact.direct_subrogation_outstanding AS lkp_direct_subrogation_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.direct_subrogation_incurred AS lkp_direct_subrogation_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.direct_salvage_paid AS lkp_direct_salvage_paid,\n\tLKP_Claim_Loss_Transaction_Fact.direct_salvage_outstanding AS lkp_direct_salvage_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.direct_salvage_incurred AS lkp_direct_salvage_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_loss_paid AS lkp_direct_other_recovery_loss_paid,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_loss_outstanding AS lkp_direct_other_recovery_loss_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_loss_incurred AS lkp_direct_other_recovery_loss_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_alae_paid AS lkp_direct_other_recovery_alae_paid,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_alae_outstanding AS lkp_direct_other_recovery_alae_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_alae_incurred AS lkp_direct_other_recovery_alae_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.total_direct_loss_recovery_paid AS lkp_total_direct_loss_recovery_paid,\n\tLKP_Claim_Loss_Transaction_Fact.total_direct_loss_recovery_outstanding AS lkp_total_direct_loss_recovery_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.total_direct_loss_recovery_incurred AS lkp_total_direct_loss_recovery_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_paid AS lkp_direct_other_recovery_paid,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_outstanding AS lkp_direct_other_recovery_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.direct_other_recovery_incurred AS lkp_direct_other_recovery_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_loss_paid AS lkp_ceded_loss_paid,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_loss_outstanding AS lkp_ceded_loss_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_loss_incurred AS lkp_ceded_loss_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_alae_paid AS lkp_ceded_alae_paid,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_alae_outstanding AS lkp_ceded_alae_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_alae_incurred AS lkp_ceded_alae_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_salvage_paid AS lkp_ceded_salvage_paid,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_subrogation_paid AS lkp_ceded_subrogation_paid,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_other_recovery_loss_paid AS lkp_ceded_other_recovery_loss_paid,\n\tLKP_Claim_Loss_Transaction_Fact.ceded_other_recovery_alae_paid AS lkp_ceded_other_recovery_alae_paid,\n\tLKP_Claim_Loss_Transaction_Fact.total_ceded_loss_recovery_paid AS lkp_total_ceded_loss_recovery_paid,\n\tLKP_Claim_Loss_Transaction_Fact.net_loss_paid AS lkp_net_loss_paid,\n\tLKP_Claim_Loss_Transaction_Fact.net_loss_outstanding AS lkp_net_loss_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.net_loss_incurred AS lkp_net_loss_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.net_alae_paid AS lkp_net_alae_paid,\n\tLKP_Claim_Loss_Transaction_Fact.net_alae_outstanding AS lkp_net_alae_outstanding,\n\tLKP_Claim_Loss_Transaction_Fact.net_alae_incurred AS lkp_net_alae_incurred,\n\tLKP_Claim_Loss_Transaction_Fact.strtgc_bus_dvsn_dim_id AS lkp_strtgc_bus_dvsn_dim_id,\n\tLKP_Claim_Loss_Transaction_Fact.ClaimReserveDimId AS lkp_ClaimReserveDimId,\n\tLKP_Claim_Loss_Transaction_Fact.ClaimRepresentativeDimFeatureClaimRepresentativeId AS lkp_ClaimRepresentativeDimFeatureClaimRepresentativeId,\n\tLKP_Claim_Loss_Transaction_Fact.FeatureRepresentativeAssignedDateId AS lkp_FeatureRepresentativeAssignedDateId,\n\tLKP_Claim_Loss_Transaction_Fact.InsuranceReferenceDimId AS lkp_InsuranceReferenceDimId,\n\tLKP_Claim_Loss_Transaction_Fact.AgencyDimId AS lkp_AgencyDimId,\n\tLKP_Claim_Loss_Transaction_Fact.SalesDivisionDimId AS lkp_SalesDivisionDimId,\n\tLKP_Claim_Loss_Transaction_Fact.InsuranceReferenceCoverageDimId AS lkp_InsuranceReferenceCoverageDimId,\n\tLKP_Claim_Loss_Transaction_Fact.CoverageDetailDimId AS lkp_CoverageDetailDimId,\n\tEXP_set_financial_values.claim_occurrence_dim_id_out,\n\tEXP_set_financial_values.claim_occurrence_dim_hist_id_out,\n\tEXP_set_financial_values.claimant_dim_id_out,\n\tEXP_set_financial_values.claimant_dim_hist_id_out,\n\tEXP_set_financial_values.claimant_cov_dim_id_out,\n\tEXP_set_financial_values.claimant_cov_dim_hist_id_out,\n\tEXP_set_financial_values.cov_dim_id_out,\n\tEXP_set_financial_values.cov_dim_hist_id_out,\n\tEXP_set_financial_values.claim_trans_type_dim_id_out,\n\tEXP_set_financial_values.claim_financial_type_dim_id_out,\n\tEXP_set_financial_values.claim_rep_prim_claim_rep_dim_id_out,\n\tEXP_set_financial_values.claim_rep_prim_claim_rep_dim_hist_id_out,\n\tEXP_set_financial_values.claim_rep_dim_examiner_id_out,\n\tEXP_set_financial_values.claim_rep_dim_examiner_hist_id_out,\n\tEXP_set_financial_values.claim_rep_dim_prim_litigation_handler_id_out,\n\tEXP_set_financial_values.claim_rep_dim_prim_litigation_handler_hist_id_out,\n\tEXP_set_financial_values.pol_key_dim_id_out,\n\tEXP_set_financial_values.pol_key_dim_hist_id_out,\n\tEXP_set_financial_values.agency_dim_id_out,\n\tEXP_set_financial_values.agency_dim_hist_id_out,\n\tEXP_set_financial_values.claim_payment_dim_id_out,\n\tEXP_set_financial_values.claim_payment_dim_hist_id_out,\n\tEXP_set_financial_values.tax_id,\n\tEXP_set_financial_values.claim_master_1099_list_dim_id_out AS claim_master_1099_list_dim_id,\n\tEXP_set_financial_values.claim_pay_ctgry_type_dim_id_out,\n\tEXP_set_financial_values.claim_pay_ctgry_type_dim_hist_id_out,\n\tEXP_set_financial_values.claim_created_by_dim_id,\n\tEXP_set_financial_values.claim_case_dim_id_out,\n\tEXP_set_financial_values.claim_case_dim_hist_id_out,\n\tEXP_set_financial_values.claim_subrogation_dim_id_out,\n\tEXP_set_financial_values.claim_trans_oper_dim_id,\n\tEXP_set_financial_values.claim_trans_date_id,\n\tEXP_set_financial_values.reprocess_date_id,\n\tEXP_set_financial_values.claim_loss_date_id,\n\tEXP_set_financial_values.claim_discovery_date_id,\n\tEXP_set_financial_values.source_claim_rpted_date_id,\n\tEXP_set_financial_values.claim_scripted_date_id,\n\tEXP_set_financial_values.claim_occurrence_rpted_date_id,\n\tEXP_set_financial_values.claim_open_date_id,\n\tEXP_set_financial_values.claim_close_date_id,\n\tEXP_set_financial_values.claim_reopen_date_id,\n\tEXP_set_financial_values.claim_closed_after_reopen_date_id,\n\tEXP_set_financial_values.claim_notice_only_date_id,\n\tEXP_set_financial_values.claim_cat_start_date_id,\n\tEXP_set_financial_values.claim_cat_end_date_id,\n\tEXP_set_financial_values.claim_rep_assigned_date_id,\n\tEXP_set_financial_values.claim_rep_unassigned_date_id,\n\tEXP_set_financial_values.claim_trans_id,\n\tEXP_set_financial_values.pol_eff_date_id,\n\tEXP_set_financial_values.pol_exp_date_id,\n\tEXP_set_financial_values.financial_type_code,\n\tEXP_set_financial_values.trans_code,\n\tEXP_set_financial_values.trans_amt,\n\tEXP_set_financial_values.trans_hist_amt,\n\tEXP_set_financial_values.direct_loss_paid_excluding_recoveries,\n\tEXP_set_financial_values.direct_loss_outstanding_excluding_recoveries,\n\tEXP_set_financial_values.direct_loss_incurred_excluding_recoveries,\n\tEXP_set_financial_values.direct_alae_paid_excluding_recoveries,\n\tEXP_set_financial_values.direct_alae_outstanding_excluding_recoveries,\n\tEXP_set_financial_values.direct_alae_incurred_excluding_recoveries,\n\tEXP_set_financial_values.direct_subrogation_paid,\n\tEXP_set_financial_values.direct_subrogation_outstanding,\n\tEXP_set_financial_values.direct_subrogation_incurred,\n\tEXP_set_financial_values.direct_salvage_paid,\n\tEXP_set_financial_values.direct_salvage_outstanding,\n\tEXP_set_financial_values.direct_salvage_incurred,\n\tEXP_set_financial_values.direct_other_recovery_paid,\n\tEXP_set_financial_values.direct_other_recovery_outstanding,\n\tEXP_set_financial_values.direct_other_recovery_incurred,\n\tEXP_set_financial_values.direct_loss_paid_including_recoveries,\n\tEXP_set_financial_values.direct_loss_outstanding_including_recoveries,\n\tEXP_set_financial_values.direct_loss_incurred_including_recoveries,\n\tEXP_set_financial_values.audit_id,\n\tEXP_set_financial_values.referred_to_subrogation_date_id,\n\tEXP_set_financial_values.pay_start_date_id,\n\tEXP_set_financial_values.closure_date_id,\n\tEXP_set_financial_values.contract_cust_dim_id_out,\n\tEXP_set_financial_values.contract_cust_dim_hist_id_out,\n\tSYSDATE AS modified_date,\n\tEXP_set_financial_values.err_flag,\n\terr_flag AS err_flag_out,\n\tEXP_set_financial_values.default_dim_id,\n\tEXP_set_financial_values.direct_other_recovery_loss_outstanding,\n\tEXP_set_financial_values.direct_other_recovery_alae_outstanding,\n\tEXP_set_financial_values.direct_other_recovery_loss_paid,\n\tEXP_set_financial_values.direct_other_recovery_alae_paid,\n\tEXP_set_financial_values.direct_other_recovery_loss_incurred,\n\tEXP_set_financial_values.direct_loss_outstanding_out_BAD AS direct_loss_outstanding_out,\n\tEXP_set_financial_values.direct_loss_incurred_out_BAD AS direct_loss_incurred_out,\n\tEXP_set_financial_values.direct_alae_paid_including_recoveries,\n\tEXP_set_financial_values.direct_loss_paid_out_BAD AS direct_loss_paid_out,\n\tEXP_set_financial_values.direct_alae_outstanding_including_recoveries,\n\tEXP_set_financial_values.direct_other_recovery_alae_incurred,\n\tEXP_set_financial_values.direct_alae_incurred_including_recoveries,\n\tEXP_set_financial_values.total_direct_loss_recovery_paid,\n\tEXP_set_financial_values.total_direct_loss_recovery_outstanding,\n\tEXP_set_financial_values.total_direct_loss_recovery_incurred,\n\tEXP_set_financial_values.net_loss_paid,\n\tEXP_set_financial_values.net_loss_outstanding,\n\tEXP_set_financial_values.net_loss_incurred,\n\tEXP_set_financial_values.net_alae_paid,\n\tEXP_set_financial_values.net_alae_outstanding,\n\tEXP_set_financial_values.net_alae_incurred,\n\t-1 AS DEFAULT_ID,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'))\n\tLKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_id AS DEFAULT_DATE_ID,\n\t'N/A' AS DEFAULT_STRING,\n\t0 AS DEFAULT_AMOUNT,\n\tSYSDATE AS SYSTEM_DATE,\n\t-- *INF*: IIF(ISNULL(lkp_claim_loss_trans_fact_id),'NEW',\r\n\t-- IIF(\r\n\t-- lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id_out  OR\r\n\t-- lkp_claim_occurrence_dim_hist_id <> claim_occurrence_dim_hist_id_out  OR\r\n\t-- lkp_claimant_dim_id  <> claimant_dim_id_out  OR\r\n\t-- lkp_claimant_dim_hist_id  <> claimant_dim_hist_id_out  OR\r\n\t-- lkp_claimant_cov_dim_id  <> claimant_cov_dim_id_out  OR\r\n\t-- lkp_claimant_cov_dim_hist_id  <> claimant_cov_dim_hist_id_out  OR\r\n\t-- lkp_cov_dim_id  <> cov_dim_id_out  OR\r\n\t-- lkp_cov_dim_hist_id  <> cov_dim_hist_id_out  OR\r\n\t-- lkp_claim_trans_type_dim_id  <> claim_trans_type_dim_id_out  OR\r\n\t-- lkp_claim_financial_type_dim_id  <> claim_financial_type_dim_id_out  OR\r\n\t-- lkp_claim_rep_dim_prim_claim_rep_id <> claim_rep_prim_claim_rep_dim_id_out  OR\r\n\t-- lkp_claim_rep_dim_prim_claim_rep_hist_id  <> claim_rep_prim_claim_rep_dim_hist_id_out  OR\r\n\t-- lkp_claim_rep_dim_examiner_id  <> claim_rep_dim_examiner_id_out  OR\r\n\t-- lkp_claim_rep_dim_examiner_hist_id  <> claim_rep_dim_examiner_hist_id_out  OR\r\n\t-- lkp_claim_rep_dim_prim_litigation_handler_id  <> claim_rep_dim_prim_litigation_handler_id_out  OR\r\n\t-- lkp_claim_rep_dim_prim_litigation_handler_hist_id  <> claim_rep_dim_prim_litigation_handler_hist_id_out  OR\r\n\t-- lkp_claim_rep_dim_trans_entry_oper_id  <> payment_entry_operator_id_out OR\r\n\t-- lkp_claim_rep_dim_trans_entry_oper_hist_id  <> payment_entry_operator_hist_id_out  OR\r\n\t-- lkp_claim_rep_dim_claim_created_by_id  <> claim_created_by_dim_id OR\r\n\t-- lkp_pol_key_dim_id  <> pol_key_dim_id_out  OR\r\n\t-- lkp_pol_key_dim_hist_id  <> pol_key_dim_hist_id_out  OR\r\n\t-- lkp_agency_dim_id  <> agency_dim_id_out  OR\r\n\t-- lkp_agency_dim_hist_id  <> agency_dim_hist_id_out  OR\r\n\t-- lkp_claim_pay_dim_id  <> claim_payment_dim_id_out  OR\r\n\t-- lkp_claim_pay_dim_hist_id  <> claim_payment_dim_hist_id_out  OR\r\n\t-- lkp_claim_pay_ctgry_type_dim_id  <> claim_pay_ctgry_type_dim_id_out  OR\r\n\t-- lkp_claim_pay_ctgry_type_dim_hist_id  <> claim_pay_ctgry_type_dim_hist_id_out  OR\r\n\t-- lkp_claim_master_1099_list_dim_id  <> claim_master_1099_list_dim_id  OR\r\n\t-- lkp_claim_trans_date_id  <> claim_trans_date_id  OR\r\n\t-- lkp_claim_trans_reprocess_date_id  <> reprocess_date_id  OR\r\n\t-- lkp_claim_loss_date_id  <> claim_loss_date_id  OR\r\n\t-- lkp_claim_discovery_date_id  <> claim_discovery_date_id  OR\r\n\t-- lkp_claim_scripted_date_id  <> claim_scripted_date_id  OR\r\n\t-- lkp_source_claim_rpted_date_id  <> source_claim_rpted_date_id  OR\r\n\t-- lkp_claim_rpted_date_id  <> claim_occurrence_rpted_date_id  OR\r\n\t-- lkp_claim_open_date_id  <> claim_open_date_id  OR\r\n\t-- lkp_claim_close_date_id  <> claim_close_date_id  OR\r\n\t-- lkp_claim_reopen_date_id  <> claim_reopen_date_id  OR\r\n\t-- lkp_claim_closed_after_reopen_date_id  <> claim_closed_after_reopen_date_id  OR\r\n\t-- lkp_claim_notice_only_date_id  <> claim_notice_only_date_id  OR\r\n\t-- lkp_claim_cat_start_date_id  <> claim_cat_start_date_id  OR\r\n\t-- lkp_claim_cat_end_date_id  <> claim_cat_end_date_id  OR\r\n\t-- lkp_claim_rep_assigned_date_id  <> claim_rep_assigned_date_id  OR\r\n\t-- lkp_claim_rep_unassigned_date_id  <> claim_rep_unassigned_date_id  OR\r\n\t-- lkp_pol_eff_date_id  <> pol_eff_date_id  OR\r\n\t-- lkp_pol_exp_date_id  <> pol_exp_date_id  OR\r\n\t-- ROUND(abs(lkp_trans_amt  -  trans_amt ),2) > .001 OR\r\n\t-- ROUND(abs(lkp_trans_hist_amt - trans_hist_amt),2) >.001  OR\r\n\t-- lkp_claim_case_dim_id <> claim_case_dim_id_out OR\r\n\t-- lkp_claim_case_dim_hist_id <> claim_case_dim_hist_id_out OR\r\n\t-- lkp_claim_subrogation_dim_id <> claim_subrogation_dim_id_out OR\r\n\t-- lkp_claim_subrogation_pay_start_date_id <> pay_start_date_id OR\r\n\t-- lkp_claim_subrogation_closure_date_id <> closure_date_id OR\r\n\t-- lkp_claim_subrogation_referred_to_subrogation_date_id <> referred_to_subrogation_date_id OR\r\n\t-- LTRIM(RTRIM(lkp_tax_id))  <>LTRIM(RTRIM(tax_id))  OR\r\n\t-- ROUND(ABS(lkp_direct_loss_paid_excluding_recoveries - direct_loss_paid_excluding_recoveries),2) >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_loss_outstanding_excluding_recoveries - direct_loss_outstanding_excluding_recoveries),2) >0.01   OR\r\n\t-- ROUND(ABS(lkp_direct_loss_incurred_excluding_recoveries - direct_loss_incurred_excluding_recoveries),2) >0.01   OR\r\n\t-- ROUND(ABS(lkp_direct_alae_paid_excluding_recoveries  - direct_alae_paid_excluding_recoveries),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_alae_outstanding_excluding_recoveries - direct_alae_outstanding_excluding_recoveries),2) >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_alae_incurred_excluding_recoveries - direct_alae_incurred_excluding_recoveries),2) >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_subrogation_paid - direct_subrogation_paid),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_subrogation_outstanding - direct_subrogation_outstanding),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_subrogation_incurred - direct_subrogation_incurred),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_salvage_paid - direct_salvage_paid),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_salvage_outstanding - direct_salvage_outstanding),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_salvage_incurred - direct_salvage_incurred),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_paid - direct_other_recovery_paid),2) >0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_outstanding - direct_other_recovery_outstanding),2) >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_incurred - direct_other_recovery_incurred),2) >0.01   OR\r\n\t-- ROUND(ABS(lkp_direct_loss_paid_including_recoveries - direct_loss_paid_including_recoveries),2)  >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_loss_outstanding_including_recoveries - direct_loss_outstanding_including_recoveries),2) >0.01  OR\r\n\t-- ROUND(ABS(lkp_direct_loss_incurred_including_recoveries - direct_loss_incurred_including_recoveries),2) >0.01 OR\r\n\t-- lkp_contract_cust_dim_id <> contract_cust_dim_id_out OR\r\n\t-- lkp_contract_cust_dim_hist_id <> contract_cust_dim_hist_id_out  OR\r\n\t-- ROUND(ABS(lkp_direct_alae_paid_including_recoveries - direct_alae_paid_including_recoveries),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_alae_outstanding_including_recoveries -  direct_alae_outstanding_including_recoveries),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_alae_incurred_including_recoveries - direct_alae_incurred_including_recoveries),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_loss_paid - direct_other_recovery_loss_paid),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_loss_outstanding - direct_other_recovery_loss_outstanding),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_loss_incurred -direct_other_recovery_loss_incurred),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_alae_paid - direct_other_recovery_alae_paid),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_alae_outstanding - direct_other_recovery_alae_outstanding),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_direct_other_recovery_alae_incurred - direct_other_recovery_alae_incurred),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_total_direct_loss_recovery_paid - total_direct_loss_recovery_paid),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_total_direct_loss_recovery_outstanding - total_direct_loss_recovery_outstanding),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_total_direct_loss_recovery_incurred - total_direct_loss_recovery_incurred),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_loss_paid -  net_loss_paid),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_loss_outstanding -  net_loss_outstanding),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_loss_incurred -  net_loss_incurred),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_alae_paid -  net_alae_paid),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_alae_outstanding -  net_alae_outstanding),2) > 0.01 OR\r\n\t-- ROUND(ABS(lkp_net_alae_incurred -  net_alae_incurred),2) > 0.01 OR\r\n\t-- lkp_strtgc_bus_dvsn_dim_id <> strtgc_bus_dvsn_dim_id OR\r\n\t-- lkp_ClaimReserveDimId <> ClaimReserveDimId OR\r\n\t-- lkp_ClaimRepresentativeDimFeatureClaimRepresentativeId <> FeatureRepresentativeDimId OR\r\n\t-- lkp_FeatureRepresentativeAssignedDateId <> FeatureRepresentativeAssignedDate_id OR\r\n\t-- lkp_InsuranceReferenceDimId <>InsuranceReferenceDimId OR lkp_AgencyDimId <>AgencyDimID OR \r\n\t-- lkp_SalesDivisionDimId<>SalesDivisionDimID OR lkp_InsuranceReferenceCoverageDimId<>InsuranceReferenceCoverageDetailDimID OR \r\n\t-- lkp_CoverageDetailDimId<>CoverageDetailDimId\r\n\t-- ,\r\n\t-- 'UPDATE','NOCHANGE')) \n\tIFF(\n\t    lkp_claim_loss_trans_fact_id IS NULL, 'NEW',\n\t    IFF(\n\t        lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id_out\n\t        or lkp_claim_occurrence_dim_hist_id <> claim_occurrence_dim_hist_id_out\n\t        or lkp_claimant_dim_id <> claimant_dim_id_out\n\t        or lkp_claimant_dim_hist_id <> claimant_dim_hist_id_out\n\t        or lkp_claimant_cov_dim_id <> claimant_cov_dim_id_out\n\t        or lkp_claimant_cov_dim_hist_id <> claimant_cov_dim_hist_id_out\n\t        or lkp_cov_dim_id <> cov_dim_id_out\n\t        or lkp_cov_dim_hist_id <> cov_dim_hist_id_out\n\t        or lkp_claim_trans_type_dim_id <> claim_trans_type_dim_id_out\n\t        or lkp_claim_financial_type_dim_id <> claim_financial_type_dim_id_out\n\t        or lkp_claim_rep_dim_prim_claim_rep_id <> claim_rep_prim_claim_rep_dim_id_out\n\t        or lkp_claim_rep_dim_prim_claim_rep_hist_id <> claim_rep_prim_claim_rep_dim_hist_id_out\n\t        or lkp_claim_rep_dim_examiner_id <> claim_rep_dim_examiner_id_out\n\t        or lkp_claim_rep_dim_examiner_hist_id <> claim_rep_dim_examiner_hist_id_out\n\t        or lkp_claim_rep_dim_prim_litigation_handler_id <> claim_rep_dim_prim_litigation_handler_id_out\n\t        or lkp_claim_rep_dim_prim_litigation_handler_hist_id <> claim_rep_dim_prim_litigation_handler_hist_id_out\n\t        or lkp_claim_rep_dim_trans_entry_oper_id <> payment_entry_operator_id_out\n\t        or lkp_claim_rep_dim_trans_entry_oper_hist_id <> payment_entry_operator_hist_id_out\n\t        or lkp_claim_rep_dim_claim_created_by_id <> claim_created_by_dim_id\n\t        or lkp_pol_key_dim_id <> pol_key_dim_id_out\n\t        or lkp_pol_key_dim_hist_id <> pol_key_dim_hist_id_out\n\t        or lkp_agency_dim_id <> agency_dim_id_out\n\t        or lkp_agency_dim_hist_id <> agency_dim_hist_id_out\n\t        or lkp_claim_pay_dim_id <> claim_payment_dim_id_out\n\t        or lkp_claim_pay_dim_hist_id <> claim_payment_dim_hist_id_out\n\t        or lkp_claim_pay_ctgry_type_dim_id <> claim_pay_ctgry_type_dim_id_out\n\t        or lkp_claim_pay_ctgry_type_dim_hist_id <> claim_pay_ctgry_type_dim_hist_id_out\n\t        or lkp_claim_master_1099_list_dim_id <> claim_master_1099_list_dim_id\n\t        or lkp_claim_trans_date_id <> claim_trans_date_id\n\t        or lkp_claim_trans_reprocess_date_id <> reprocess_date_id\n\t        or lkp_claim_loss_date_id <> claim_loss_date_id\n\t        or lkp_claim_discovery_date_id <> claim_discovery_date_id\n\t        or lkp_claim_scripted_date_id <> claim_scripted_date_id\n\t        or lkp_source_claim_rpted_date_id <> source_claim_rpted_date_id\n\t        or lkp_claim_rpted_date_id <> claim_occurrence_rpted_date_id\n\t        or lkp_claim_open_date_id <> claim_open_date_id\n\t        or lkp_claim_close_date_id <> claim_close_date_id\n\t        or lkp_claim_reopen_date_id <> claim_reopen_date_id\n\t        or lkp_claim_closed_after_reopen_date_id <> claim_closed_after_reopen_date_id\n\t        or lkp_claim_notice_only_date_id <> claim_notice_only_date_id\n\t        or lkp_claim_cat_start_date_id <> claim_cat_start_date_id\n\t        or lkp_claim_cat_end_date_id <> claim_cat_end_date_id\n\t        or lkp_claim_rep_assigned_date_id <> claim_rep_assigned_date_id\n\t        or lkp_claim_rep_unassigned_date_id <> claim_rep_unassigned_date_id\n\t        or lkp_pol_eff_date_id <> pol_eff_date_id\n\t        or lkp_pol_exp_date_id <> pol_exp_date_id\n\t        or ROUND(abs(lkp_trans_amt - trans_amt), 2) > .001\n\t        or ROUND(abs(lkp_trans_hist_amt - trans_hist_amt), 2) > .001\n\t        or lkp_claim_case_dim_id <> claim_case_dim_id_out\n\t        or lkp_claim_case_dim_hist_id <> claim_case_dim_hist_id_out\n\t        or lkp_claim_subrogation_dim_id <> claim_subrogation_dim_id_out\n\t        or lkp_claim_subrogation_pay_start_date_id <> pay_start_date_id\n\t        or lkp_claim_subrogation_closure_date_id <> closure_date_id\n\t        or lkp_claim_subrogation_referred_to_subrogation_date_id <> referred_to_subrogation_date_id\n\t        or LTRIM(RTRIM(lkp_tax_id)) <> LTRIM(RTRIM(tax_id))\n\t        or ROUND(ABS(lkp_direct_loss_paid_excluding_recoveries - direct_loss_paid_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_loss_outstanding_excluding_recoveries - direct_loss_outstanding_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_loss_incurred_excluding_recoveries - direct_loss_incurred_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_alae_paid_excluding_recoveries - direct_alae_paid_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_alae_outstanding_excluding_recoveries - direct_alae_outstanding_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_alae_incurred_excluding_recoveries - direct_alae_incurred_excluding_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_subrogation_paid - direct_subrogation_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_subrogation_outstanding - direct_subrogation_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_subrogation_incurred - direct_subrogation_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_salvage_paid - direct_salvage_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_salvage_outstanding - direct_salvage_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_salvage_incurred - direct_salvage_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_paid - direct_other_recovery_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_outstanding - direct_other_recovery_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_incurred - direct_other_recovery_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_loss_paid_including_recoveries - direct_loss_paid_including_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_loss_outstanding_including_recoveries - direct_loss_outstanding_including_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_loss_incurred_including_recoveries - direct_loss_incurred_including_recoveries), 2) > 0.01\n\t        or lkp_contract_cust_dim_id <> contract_cust_dim_id_out\n\t        or lkp_contract_cust_dim_hist_id <> contract_cust_dim_hist_id_out\n\t        or ROUND(ABS(lkp_direct_alae_paid_including_recoveries - direct_alae_paid_including_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_alae_outstanding_including_recoveries - direct_alae_outstanding_including_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_alae_incurred_including_recoveries - direct_alae_incurred_including_recoveries), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_loss_paid - direct_other_recovery_loss_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_loss_outstanding - direct_other_recovery_loss_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_loss_incurred - direct_other_recovery_loss_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_alae_paid - direct_other_recovery_alae_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_alae_outstanding - direct_other_recovery_alae_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_direct_other_recovery_alae_incurred - direct_other_recovery_alae_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_total_direct_loss_recovery_paid - total_direct_loss_recovery_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_total_direct_loss_recovery_outstanding - total_direct_loss_recovery_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_total_direct_loss_recovery_incurred - total_direct_loss_recovery_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_loss_paid - net_loss_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_loss_outstanding - net_loss_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_loss_incurred - net_loss_incurred), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_alae_paid - net_alae_paid), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_alae_outstanding - net_alae_outstanding), 2) > 0.01\n\t        or ROUND(ABS(lkp_net_alae_incurred - net_alae_incurred), 2) > 0.01\n\t        or lkp_strtgc_bus_dvsn_dim_id <> strtgc_bus_dvsn_dim_id\n\t        or lkp_ClaimReserveDimId <> ClaimReserveDimId\n\t        or lkp_ClaimRepresentativeDimFeatureClaimRepresentativeId <> FeatureRepresentativeDimId\n\t        or lkp_FeatureRepresentativeAssignedDateId <> FeatureRepresentativeAssignedDate_id\n\t        or lkp_InsuranceReferenceDimId <> InsuranceReferenceDimId\n\t        or lkp_AgencyDimId <> AgencyDimID\n\t        or lkp_SalesDivisionDimId <> SalesDivisionDimID\n\t        or lkp_InsuranceReferenceCoverageDimId <> InsuranceReferenceCoverageDetailDimID\n\t        or lkp_CoverageDetailDimId <> CoverageDetailDimId,\n\t        'UPDATE',\n\t        'NOCHANGE'\n\t    )\n\t) AS v_changed_flag,\n\tv_changed_flag AS changed_flag,\n\tEXP_set_financial_values.acct_entered_date_id,\n\tEXP_set_financial_values.strtgc_bus_dvsn_dim_id,\n\tEXP_set_financial_values.claim_created_by_dim_id AS claim_created_by_dim_id1,\n\tEXP_set_default_date_ids.payment_entry_operator_id_out,\n\tEXP_set_default_date_ids.payment_entry_operator_hist_id_out,\n\tEXP_set_default_date_ids.InsuranceReferenceDimId,\n\tEXP_set_default_date_ids.AgencyDimID,\n\tEXP_set_default_date_ids.SalesDivisionDimID,\n\tEXP_set_default_date_ids.InsuranceReferenceCoverageDetailDimID,\n\tEXP_set_default_date_ids.CoverageDetailDimId,\n\tEXP_set_default_date_ids.ClaimReserveDimId,\n\tEXP_set_default_date_ids.FeatureRepresentativeDimId,\n\tEXP_set_default_date_ids.out_FeatureRepresentativeAssignedDate_id AS FeatureRepresentativeAssignedDate_id,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_set_default_date_ids\n\t -- Manually join with EXP_set_financial_values\n\tLEFT JOIN LKP_Claim_Loss_Transaction_Fact\n\tON LKP_Claim_Loss_Transaction_Fact.edw_claim_trans_pk_id = EXP_set_financial_values.claim_trans_id\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS\n\tON LKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_date = TO_TIMESTAMP('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\n),\nRTR_claim_loss_transaction_fact AS (\n\tSELECT\n\tlkp_claim_loss_trans_fact_id AS claim_loss_trans_fact_id,\n\tclaim_occurrence_dim_id_out AS claim_occurrence_dim_id,\n\tclaim_occurrence_dim_hist_id_out AS claim_occurrence_dim_hist_id,\n\tclaimant_dim_id_out AS claimant_dim_id,\n\tclaimant_dim_hist_id_out AS claimant_dim_hist_id,\n\tclaimant_cov_dim_id_out AS claimant_cov_dim_id,\n\tclaimant_cov_dim_hist_id_out AS claimant_cov_dim_hist_id,\n\tcov_dim_id_out AS cov_dim_id,\n\tcov_dim_hist_id_out AS cov_dim_hist_id,\n\tclaim_trans_type_dim_id_out AS claim_trans_type_dim_id,\n\tclaim_financial_type_dim_id_out AS claim_financial_type_dim_id,\n\tclaim_rep_prim_claim_rep_dim_id_out AS claim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_prim_claim_rep_dim_hist_id_out AS claim_rep_dim_prim_claim_rep_hist_id,\n\tclaim_rep_dim_examiner_id_out,\n\tclaim_rep_dim_examiner_hist_id_out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tclaim_rep_dim_prim_litigation_handler_hist_id_out,\n\tclaim_created_by_dim_id1 AS claim_created_by_dim_id,\n\tclaim_trans_oper_dim_id,\n\tpol_key_dim_id_out AS pol_key_dim_id,\n\tpol_key_dim_hist_id_out AS pol_key_dim_hist_id,\n\tagency_dim_id_out AS agency_dim_id,\n\tagency_dim_hist_id_out AS agency_dim_hist_id,\n\tclaim_payment_dim_id_out,\n\tclaim_payment_dim_hist_id_out,\n\tclaim_pay_ctgry_type_dim_id_out,\n\tclaim_pay_ctgry_type_dim_hist_id_out,\n\tclaim_master_1099_list_dim_id,\n\tclaim_case_dim_id_out,\n\tclaim_case_dim_hist_id_out,\n\tclaim_trans_date_id,\n\treprocess_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_scripted_date_id,\n\tclaim_occurrence_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tclaim_trans_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tfinancial_type_code,\n\ttrans_code,\n\ttrans_amt,\n\ttrans_hist_amt,\n\tdirect_loss_paid_excluding_recoveries,\n\tdirect_loss_outstanding_excluding_recoveries,\n\tdirect_loss_incurred_excluding_recoveries,\n\tdirect_alae_paid_excluding_recoveries,\n\tdirect_alae_outstanding_excluding_recoveries,\n\tdirect_alae_incurred_excluding_recoveries,\n\tdirect_subrogation_paid,\n\tdirect_subrogation_outstanding,\n\tdirect_subrogation_incurred,\n\tdirect_salvage_paid,\n\tdirect_salvage_outstanding,\n\tdirect_salvage_incurred,\n\tdirect_other_recovery_paid,\n\tdirect_other_recovery_outstanding,\n\tdirect_other_recovery_incurred,\n\tdirect_loss_paid_including_recoveries,\n\tdirect_loss_outstanding_including_recoveries,\n\tdirect_loss_incurred_including_recoveries,\n\taudit_id,\n\terr_flag_out AS err_flag,\n\tdefault_dim_id,\n\ttax_id,\n\tchanged_flag,\n\tmodified_date,\n\tclaim_created_by_dim_id AS claim_created_by_dim_id4,\n\tclaim_subrogation_dim_id_out,\n\treferred_to_subrogation_date_id,\n\tpay_start_date_id,\n\tclosure_date_id,\n\tcontract_cust_dim_id_out,\n\tcontract_cust_dim_hist_id_out,\n\tdirect_other_recovery_loss_outstanding,\n\tdirect_other_recovery_alae_outstanding,\n\tdirect_other_recovery_loss_paid,\n\tdirect_other_recovery_alae_paid,\n\tdirect_other_recovery_loss_incurred,\n\tdirect_loss_outstanding_out,\n\tdirect_loss_incurred_out,\n\tdirect_alae_paid_including_recoveries,\n\tdirect_loss_paid_out,\n\tdirect_alae_outstanding_including_recoveries,\n\tdirect_other_recovery_alae_incurred,\n\tdirect_alae_incurred_including_recoveries,\n\ttotal_direct_loss_recovery_paid,\n\ttotal_direct_loss_recovery_outstanding,\n\ttotal_direct_loss_recovery_incurred,\n\tnet_loss_paid,\n\tnet_loss_outstanding,\n\tnet_loss_incurred,\n\tnet_alae_paid,\n\tnet_alae_outstanding,\n\tnet_alae_incurred,\n\tDEFAULT_ID,\n\tDEFAULT_DATE_ID,\n\tDEFAULT_STRING,\n\tDEFAULT_AMOUNT,\n\tSYSTEM_DATE,\n\tacct_entered_date_id,\n\tstrtgc_bus_dvsn_dim_id,\n\tpayment_entry_operator_id_out,\n\tpayment_entry_operator_hist_id_out,\n\tInsuranceReferenceDimId,\n\tAgencyDimID,\n\tSalesDivisionDimID,\n\tInsuranceReferenceCoverageDetailDimID,\n\tCoverageDetailDimId,\n\tClaimReserveDimId,\n\tFeatureRepresentativeDimId,\n\tFeatureRepresentativeAssignedDate_id,\n\tModifiedDate\n\tFROM EXP_DETECT_CHANGES\n),\nRTR_claim_loss_transaction_fact_INSERT AS (SELECT * FROM RTR_claim_loss_transaction_fact WHERE changed_flag = 'NEW'\r\n\r\n--ISNULL(claim_loss_trans_fact_id)),\nRTR_claim_loss_transaction_fact_UPDATE AS (SELECT * FROM RTR_claim_loss_transaction_fact WHERE changed_flag ='UPDATE'),\nUPD_claim_loss_transaction_fact_insert AS (\n\tSELECT\n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id1, \n\tclaim_occurrence_dim_hist_id AS claim_occurrence_dim_hist_id1, \n\tclaimant_dim_id AS claimant_dim_id1, \n\tclaimant_dim_hist_id AS claimant_dim_hist_id1, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id1, \n\tclaimant_cov_dim_hist_id AS claimant_cov_dim_hist_id1, \n\tcov_dim_id AS cov_dim_id1, \n\tcov_dim_hist_id AS cov_dim_hist_id1, \n\tclaim_trans_type_dim_id AS claim_trans_type_dim_id1, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id1, \n\tclaim_rep_dim_prim_claim_rep_id, \n\tclaim_rep_dim_prim_claim_rep_hist_id, \n\tclaim_rep_dim_examiner_id_out AS claim_rep_dim_examiner_id_out1, \n\tclaim_rep_dim_examiner_hist_id_out AS claim_rep_dim_examiner_hist_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out AS claim_rep_dim_prim_litigation_handler_hist_id_out1, \n\tpol_key_dim_id AS pol_key_dim_id1, \n\tpol_key_dim_hist_id AS pol_key_dim_hist_id1, \n\tclaim_created_by_dim_id AS claim_created_by_dim_id1, \n\tclaim_trans_oper_dim_id AS claim_trans_oper_dim_id1, \n\tclaim_trans_date_id AS claim_trans_date_id1, \n\treprocess_date_id AS reprocess_date_id1, \n\tclaim_loss_date_id AS claim_loss_date_id1, \n\tclaim_discovery_date_id AS claim_discovery_date_id1, \n\tsource_claim_rpted_date_id, \n\tclaim_scripted_date_id, \n\tclaim_occurrence_rpted_date_id AS claim_occurrence_rpted_date_id1, \n\tclaim_open_date_id AS claim_open_date_id1, \n\tclaim_close_date_id AS claim_close_date_id1, \n\tclaim_reopen_date_id AS claim_reopen_date_id1, \n\tclaim_closed_after_reopen_date_id AS claim_closed_after_reopen_date_id1, \n\tclaim_notice_only_date_id AS claim_notice_only_date_id1, \n\tclaim_cat_start_date_id AS claim_cat_start_date_id1, \n\tclaim_cat_end_date_id AS claim_cat_end_date_id1, \n\tclaim_rep_assigned_date_id AS claim_rep_assigned_date_id1, \n\tclaim_rep_unassigned_date_id AS claim_rep_unassigned_date_id1, \n\tclaim_trans_id AS claim_trans_id1, \n\tpol_eff_date_id AS pol_eff_date_id1, \n\tpol_exp_date_id AS pol_exp_date_id1, \n\tfinancial_type_code AS financial_type_code1, \n\ttrans_code AS trans_code1, \n\ttrans_amt AS trans_amt1, \n\ttrans_hist_amt AS trans_hist_amt1, \n\tdirect_loss_paid_excluding_recoveries, \n\tdirect_loss_outstanding_excluding_recoveries, \n\tdirect_loss_incurred_excluding_recoveries, \n\tdirect_alae_paid_excluding_recoveries, \n\tdirect_alae_outstanding_excluding_recoveries, \n\tdirect_alae_incurred_excluding_recoveries, \n\tdirect_subrogation_paid, \n\tdirect_subrogation_outstanding, \n\tdirect_subrogation_incurred, \n\tdirect_salvage_paid, \n\tdirect_salvage_outstanding, \n\tdirect_salvage_incurred, \n\tdirect_other_recovery_paid, \n\tdirect_other_recovery_outstanding, \n\tdirect_other_recovery_incurred, \n\tdirect_loss_paid_including_recoveries, \n\tdirect_loss_outstanding_including_recoveries, \n\tdirect_loss_incurred_including_recoveries, \n\taudit_id AS audit_id1, \n\tagency_dim_id AS agency_dim_id1, \n\tagency_dim_hist_id AS agency_dim_hist_id1, \n\terr_flag AS err_flag1, \n\tdefault_dim_id AS default_dim_id1, \n\tclaim_payment_dim_id_out AS claim_payment_dim_id_out1, \n\tclaim_payment_dim_hist_id_out AS claim_payment_dim_hist_id_out1, \n\ttax_id AS tax_id1, \n\tclaim_master_1099_list_dim_id AS claim_master_1099_list_dim_id1, \n\tclaim_pay_ctgry_type_dim_id_out AS claim_pay_ctgry_type_dim_id_out1, \n\tclaim_pay_ctgry_type_dim_hist_id_out AS claim_pay_ctgry_type_dim_hist_id_out1, \n\tclaim_created_by_dim_id4 AS claim_created_by_dim_id, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out1, \n\tclaim_case_dim_hist_id_out AS claim_case_dim_hist_id_out1, \n\tclaim_subrogation_dim_id_out AS claim_subrogation_dim_id_out1, \n\treferred_to_subrogation_date_id AS referred_to_subrogation_date_id1, \n\tpay_start_date_id AS pay_start_date_id1, \n\tclosure_date_id AS closure_date_id1, \n\tcontract_cust_dim_id_out, \n\tcontract_cust_dim_hist_id_out, \n\tdirect_other_recovery_loss_outstanding, \n\tdirect_other_recovery_alae_outstanding, \n\tdirect_other_recovery_loss_paid, \n\tdirect_other_recovery_alae_paid, \n\tdirect_other_recovery_loss_incurred, \n\tdirect_loss_outstanding_out AS direct_loss_outstanding_out1, \n\tdirect_loss_incurred_out AS direct_loss_incurred_out1, \n\tdirect_alae_paid_including_recoveries, \n\tdirect_loss_paid_out AS direct_loss_paid_out1, \n\tdirect_alae_outstanding_including_recoveries, \n\tdirect_other_recovery_alae_incurred, \n\tdirect_alae_incurred_including_recoveries, \n\ttotal_direct_loss_recovery_paid, \n\ttotal_direct_loss_recovery_outstanding, \n\ttotal_direct_loss_recovery_incurred, \n\tnet_loss_paid AS net_loss_paid1, \n\tnet_loss_outstanding AS net_loss_outstanding1, \n\tnet_loss_incurred AS net_loss_incurred1, \n\tnet_alae_paid AS net_alae_paid1, \n\tnet_alae_outstanding AS net_alae_outstanding1, \n\tnet_alae_incurred AS net_alae_incurred1, \n\tDEFAULT_ID AS DEFAULT_ID1, \n\tDEFAULT_DATE_ID AS DEFAULT_DATE_ID1, \n\tDEFAULT_STRING AS DEFAULT_STRING1, \n\tDEFAULT_AMOUNT AS DEFAULT_AMOUNT1, \n\tSYSTEM_DATE AS CREATE_DATE, \n\tacct_entered_date_id AS acct_entered_date_id1, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id1, \n\tpayment_entry_operator_id_out AS payment_entry_operator_id_out1, \n\tpayment_entry_operator_hist_id_out AS payment_entry_operator_hist_id_out1, \n\tInsuranceReferenceDimId AS InsuranceReferenceDimId1, \n\tAgencyDimID AS AgencyDimID1, \n\tSalesDivisionDimID AS SalesDivisionDimID1, \n\tInsuranceReferenceCoverageDetailDimID AS InsuranceReferenceCoverageDetailDimID1, \n\tCoverageDetailDimId AS CoverageDetailDimId1, \n\tClaimReserveDimId AS ClaimReserveDimId1, \n\tFeatureRepresentativeDimId AS FeatureRepresentativeDimId1, \n\tFeatureRepresentativeAssignedDate_id AS FeatureRepresentativeAssignedDate_id1, \n\tModifiedDate AS ModifiedDate1\n\tFROM RTR_claim_loss_transaction_fact_INSERT\n),\nclaim_loss_transaction_fact_insert AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\terr_flag1 AS ERR_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\tclaim_trans_id1 AS EDW_CLAIM_TRANS_PK_ID, \n\tDEFAULT_ID1 AS EDW_CLAIM_REINS_TRANS_PK_ID, \n\tclaim_occurrence_dim_id1 AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaim_occurrence_dim_hist_id1 AS CLAIM_OCCURRENCE_DIM_HIST_ID, \n\tclaimant_dim_id1 AS CLAIMANT_DIM_ID, \n\tclaimant_dim_hist_id1 AS CLAIMANT_DIM_HIST_ID, \n\tclaimant_cov_dim_id1 AS CLAIMANT_COV_DIM_ID, \n\tclaimant_cov_dim_hist_id1 AS CLAIMANT_COV_DIM_HIST_ID, \n\tcov_dim_id1 AS COV_DIM_ID, \n\tcov_dim_hist_id1 AS COV_DIM_HIST_ID, \n\tclaim_trans_type_dim_id1 AS CLAIM_TRANS_TYPE_DIM_ID, \n\tclaim_financial_type_dim_id1 AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\tDEFAULT_ID1 AS REINS_COV_DIM_ID, \n\tDEFAULT_ID1 AS REINS_COV_DIM_HIST_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tclaim_rep_dim_examiner_id_out1 AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_examiner_hist_id_out1 AS CLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_out1 AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out1 AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tpayment_entry_operator_id_out1 AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tpayment_entry_operator_hist_id_out1 AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tclaim_created_by_dim_id AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id1 AS POL_DIM_ID, \n\tpol_key_dim_hist_id1 AS POL_DIM_HIST_ID, \n\tagency_dim_id1 AS AGENCY_DIM_ID, \n\tagency_dim_hist_id1 AS AGENCY_DIM_HIST_ID, \n\tclaim_payment_dim_id_out1 AS CLAIM_PAY_DIM_ID, \n\tclaim_payment_dim_hist_id_out1 AS CLAIM_PAY_DIM_HIST_ID, \n\tclaim_pay_ctgry_type_dim_id_out1 AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tclaim_pay_ctgry_type_dim_hist_id_out1 AS CLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tclaim_case_dim_id_out1 AS CLAIM_CASE_DIM_ID, \n\tclaim_case_dim_hist_id_out1 AS CLAIM_CASE_DIM_HIST_ID, \n\tcontract_cust_dim_id_out AS CONTRACT_CUST_DIM_ID, \n\tcontract_cust_dim_hist_id_out AS CONTRACT_CUST_DIM_HIST_ID, \n\tclaim_master_1099_list_dim_id1 AS CLAIM_MASTER_1099_LIST_DIM_ID, \n\tclaim_subrogation_dim_id_out1 AS CLAIM_SUBROGATION_DIM_ID, \n\tclaim_trans_date_id1 AS CLAIM_TRANS_DATE_ID, \n\treprocess_date_id1 AS CLAIM_TRANS_REPROCESS_DATE_ID, \n\tclaim_loss_date_id1 AS CLAIM_LOSS_DATE_ID, \n\tclaim_discovery_date_id1 AS CLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tclaim_occurrence_rpted_date_id1 AS CLAIM_RPTED_DATE_ID, \n\tclaim_open_date_id1 AS CLAIM_OPEN_DATE_ID, \n\tclaim_close_date_id1 AS CLAIM_CLOSE_DATE_ID, \n\tclaim_reopen_date_id1 AS CLAIM_REOPEN_DATE_ID, \n\tclaim_closed_after_reopen_date_id1 AS CLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tclaim_notice_only_date_id1 AS CLAIM_NOTICE_ONLY_DATE_ID, \n\tclaim_cat_start_date_id1 AS CLAIM_CAT_START_DATE_ID, \n\tclaim_cat_end_date_id1 AS CLAIM_CAT_END_DATE_ID, \n\tclaim_rep_assigned_date_id1 AS CLAIM_REP_ASSIGNED_DATE_ID, \n\tclaim_rep_unassigned_date_id1 AS CLAIM_REP_UNASSIGNED_DATE_ID, \n\tpol_eff_date_id1 AS POL_EFF_DATE_ID, \n\tpol_exp_date_id1 AS POL_EXP_DATE_ID, \n\treferred_to_subrogation_date_id1 AS CLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tpay_start_date_id1 AS CLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tclosure_date_id1 AS CLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tacct_entered_date_id1 AS ACCT_ENTERED_DATE_ID, \n\ttrans_amt1 AS TRANS_AMT, \n\ttrans_hist_amt1 AS TRANS_HIST_AMT, \n\ttax_id1 AS TAX_ID, \n\tDIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tDIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tDIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tDIRECT_SUBROGATION_PAID, \n\tDIRECT_SUBROGATION_OUTSTANDING, \n\tDIRECT_SUBROGATION_INCURRED, \n\tDIRECT_SALVAGE_PAID, \n\tDIRECT_SALVAGE_OUTSTANDING, \n\tDIRECT_SALVAGE_INCURRED, \n\tDIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tDIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tDIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tDIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tTOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tTOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tTOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tDIRECT_OTHER_RECOVERY_PAID, \n\tDIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tDIRECT_OTHER_RECOVERY_INCURRED, \n\tDEFAULT_AMOUNT1 AS CEDED_LOSS_PAID, \n\tDEFAULT_AMOUNT1 AS CEDED_LOSS_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS CEDED_LOSS_INCURRED, \n\tDEFAULT_AMOUNT1 AS CEDED_ALAE_PAID, \n\tDEFAULT_AMOUNT1 AS CEDED_ALAE_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS CEDED_ALAE_INCURRED, \n\tDEFAULT_AMOUNT1 AS CEDED_SALVAGE_PAID, \n\tDEFAULT_AMOUNT1 AS CEDED_SUBROGATION_PAID, \n\tDEFAULT_AMOUNT1 AS CEDED_OTHER_RECOVERY_LOSS_PAID, \n\tDEFAULT_AMOUNT1 AS CEDED_OTHER_RECOVERY_ALAE_PAID, \n\tDEFAULT_AMOUNT1 AS TOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tnet_loss_paid1 AS NET_LOSS_PAID, \n\tnet_loss_outstanding1 AS NET_LOSS_OUTSTANDING, \n\tnet_loss_incurred1 AS NET_LOSS_INCURRED, \n\tnet_alae_paid1 AS NET_ALAE_PAID, \n\tnet_alae_outstanding1 AS NET_ALAE_OUTSTANDING, \n\tnet_alae_incurred1 AS NET_ALAE_INCURRED, \n\tDEFAULT_ID1 AS ASL_DIM_ID, \n\tDEFAULT_ID1 AS ASL_PRDCT_CODE_DIM_ID, \n\tDEFAULT_ID1 AS LOSS_MASTER_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id1 AS STRTGC_BUS_DVSN_DIM_ID, \n\tDEFAULT_ID1 AS PRDCT_CODE_DIM_ID, \n\tClaimReserveDimId1 AS CLAIMRESERVEDIMID, \n\tFeatureRepresentativeDimId1 AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tFeatureRepresentativeAssignedDate_id1 AS FEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tInsuranceReferenceDimId1 AS INSURANCEREFERENCEDIMID, \n\tAgencyDimID1 AS AGENCYDIMID, \n\tSalesDivisionDimID1 AS SALESDIVISIONDIMID, \n\tInsuranceReferenceCoverageDetailDimID1 AS INSURANCEREFERENCECOVERAGEDIMID, \n\tCoverageDetailDimId1 AS COVERAGEDETAILDIMID, \n\tModifiedDate1 AS MODIFIEDDATE\n\tFROM UPD_claim_loss_transaction_fact_insert\n),\nUPD_claim_loss_transaction_fact_update AS (\n\tSELECT\n\tclaim_loss_trans_fact_id AS claim_loss_trans_fact_id2, \n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id2, \n\tclaim_occurrence_dim_hist_id AS claim_occurrence_dim_hist_id2, \n\tclaimant_dim_id AS claimant_dim_id2, \n\tclaimant_dim_hist_id AS claimant_dim_hist_id2, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id2, \n\tclaimant_cov_dim_hist_id AS claimant_cov_dim_hist_id2, \n\tcov_dim_id AS cov_dim_id2, \n\tcov_dim_hist_id AS cov_dim_hist_id2, \n\tclaim_trans_type_dim_id AS claim_trans_type_dim_id2, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id2, \n\tclaim_rep_dim_prim_claim_rep_id, \n\tclaim_rep_dim_prim_claim_rep_hist_id, \n\tclaim_rep_dim_examiner_id_out AS claim_rep_dim_examiner_id_out2, \n\tclaim_rep_dim_examiner_hist_id_out AS claim_rep_dim_examiner_hist_id_out2, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out2, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out AS claim_rep_dim_prim_litigation_handler_hist_id_out2, \n\tclaim_payment_dim_id_out AS claim_payment_dim_id_out2, \n\tclaim_payment_dim_hist_id_out AS claim_payment_dim_hist_id_out2, \n\tpol_key_dim_id AS pol_key_dim_id2, \n\tpol_key_dim_hist_id AS pol_key_dim_hist_id2, \n\tagency_dim_id AS agency_dim_id2, \n\tagency_dim_hist_id AS agency_dim_hist_id2, \n\tclaim_pay_ctgry_type_dim_id_out AS claim_pay_ctgry_type_dim_id_out2, \n\tclaim_pay_ctgry_type_dim_hist_id_out AS claim_pay_ctgry_type_dim_hist_id_out2, \n\tclaim_master_1099_list_dim_id AS claim_master_1099_list_dim_id2, \n\tclaim_created_by_dim_id AS claim_created_by_dim_id2, \n\tclaim_trans_oper_dim_id AS claim_trans_oper_dim_id2, \n\tclaim_trans_date_id AS claim_trans_date_id2, \n\treprocess_date_id AS reprocess_date_id2, \n\tclaim_loss_date_id AS claim_loss_date_id2, \n\tclaim_discovery_date_id AS claim_discovery_date_id2, \n\tsource_claim_rpted_date_id, \n\tclaim_scripted_date_id, \n\tclaim_occurrence_rpted_date_id AS claim_occurrence_rpted_date_id2, \n\tclaim_open_date_id AS claim_open_date_id2, \n\tclaim_close_date_id AS claim_close_date_id2, \n\tclaim_reopen_date_id AS claim_reopen_date_id2, \n\tclaim_closed_after_reopen_date_id AS claim_closed_after_reopen_date_id2, \n\tclaim_notice_only_date_id, \n\tclaim_cat_start_date_id AS claim_cat_start_date_id2, \n\tclaim_cat_end_date_id AS claim_cat_end_date_id2, \n\tclaim_rep_assigned_date_id AS claim_rep_assigned_date_id2, \n\tclaim_rep_unassigned_date_id AS claim_rep_unassigned_date_id2, \n\tclaim_trans_id AS claim_trans_id2, \n\tpol_eff_date_id AS pol_eff_date_id2, \n\tpol_exp_date_id AS pol_exp_date_id2, \n\tfinancial_type_code AS financial_type_code2, \n\ttrans_code AS trans_code2, \n\ttrans_amt AS trans_amt2, \n\ttrans_hist_amt AS trans_hist_amt2, \n\tdirect_loss_paid_excluding_recoveries, \n\tdirect_loss_outstanding_excluding_recoveries, \n\tdirect_loss_incurred_excluding_recoveries, \n\tdirect_alae_paid_excluding_recoveries, \n\tdirect_alae_outstanding_excluding_recoveries, \n\tdirect_alae_incurred_excluding_recoveries, \n\tdirect_subrogation_paid, \n\tdirect_subrogation_outstanding, \n\tdirect_subrogation_incurred, \n\tdirect_salvage_paid, \n\tdirect_salvage_outstanding, \n\tdirect_salvage_incurred, \n\tdirect_other_recovery_paid, \n\tdirect_other_recovery_outstanding, \n\tdirect_other_recovery_incurred, \n\tdirect_loss_paid_including_recoveries, \n\tdirect_loss_outstanding_including_recoveries, \n\tdirect_loss_incurred_including_recoveries, \n\taudit_id AS audit_id3, \n\terr_flag AS err_flag2, \n\ttax_id AS tax_id2, \n\tdefault_dim_id AS default_dim_id2, \n\tmodified_date AS modified_date3, \n\tclaim_created_by_dim_id4 AS claim_created_by_dim_id43, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out1, \n\tclaim_case_dim_hist_id_out AS claim_case_dim_hist_id_out1, \n\tclaim_subrogation_dim_id_out AS claim_subrogation_dim_id_out3, \n\treferred_to_subrogation_date_id AS referred_to_subrogation_date_id3, \n\tpay_start_date_id AS pay_start_date_id3, \n\tclosure_date_id AS closure_date_id3, \n\tcontract_cust_dim_id_out, \n\tcontract_cust_dim_hist_id_out, \n\tdirect_other_recovery_loss_outstanding, \n\tdirect_other_recovery_alae_outstanding, \n\tdirect_other_recovery_loss_paid, \n\tdirect_other_recovery_alae_paid, \n\tdirect_other_recovery_loss_incurred, \n\tdirect_loss_outstanding_out AS direct_loss_outstanding_out3, \n\tdirect_loss_incurred_out AS direct_loss_incurred_out3, \n\tdirect_alae_paid_including_recoveries, \n\tdirect_loss_paid_out AS direct_loss_paid_out3, \n\tdirect_alae_outstanding_including_recoveries, \n\tdirect_other_recovery_alae_incurred, \n\tdirect_alae_incurred_including_recoveries, \n\ttotal_direct_loss_recovery_paid, \n\ttotal_direct_loss_recovery_outstanding, \n\ttotal_direct_loss_recovery_incurred, \n\tnet_loss_paid AS net_loss_paid2, \n\tnet_loss_outstanding AS net_loss_outstanding2, \n\tnet_loss_incurred AS net_loss_incurred2, \n\tnet_alae_paid AS net_alae_paid2, \n\tnet_alae_outstanding AS net_alae_outstanding2, \n\tnet_alae_incurred AS net_alae_incurred2, \n\tDEFAULT_ID AS DEFAULT_ID2, \n\tDEFAULT_DATE_ID AS DEFAULT_DATE_ID2, \n\tDEFAULT_STRING AS DEFAULT_STRING2, \n\tDEFAULT_AMOUNT AS DEFAULT_AMOUNT2, \n\tSYSTEM_DATE AS SYSTEM_DATE3, \n\tacct_entered_date_id AS acct_entered_date_id3, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id3, \n\tpayment_entry_operator_id_out AS payment_entry_operator_id_out3, \n\tpayment_entry_operator_hist_id_out AS payment_entry_operator_hist_id_out3, \n\tInsuranceReferenceDimId AS InsuranceReferenceDimId3, \n\tAgencyDimID AS AgencyDimID3, \n\tSalesDivisionDimID AS SalesDivisionDimID3, \n\tInsuranceReferenceCoverageDetailDimID AS InsuranceReferenceCoverageDetailDimID3, \n\tCoverageDetailDimId AS CoverageDetailDimId3, \n\tClaimReserveDimId AS ClaimReserveDimId3, \n\tFeatureRepresentativeDimId AS FeatureRepresentativeDimId3, \n\tFeatureRepresentativeAssignedDate_id AS FeatureRepresentativeAssignedDate_id3, \n\tModifiedDate AS ModifiedDate3\n\tFROM RTR_claim_loss_transaction_fact_UPDATE\n),\nclaim_loss_transaction_fact_update AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact AS T\n\tUSING UPD_claim_loss_transaction_fact_update AS S\n\tON T.claim_loss_trans_fact_id = S.claim_loss_trans_fact_id2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.err_flag = S.err_flag2, T.edw_claim_trans_pk_id = S.claim_trans_id2, T.claim_occurrence_dim_id = S.claim_occurrence_dim_id2, T.claim_occurrence_dim_hist_id = S.claim_occurrence_dim_hist_id2, T.claimant_dim_id = S.claimant_dim_id2, T.claimant_dim_hist_id = S.claimant_dim_hist_id2, T.claimant_cov_dim_id = S.claimant_cov_dim_id2, T.claimant_cov_dim_hist_id = S.claimant_cov_dim_hist_id2, T.cov_dim_id = S.cov_dim_id2, T.cov_dim_hist_id = S.cov_dim_hist_id2, T.claim_trans_type_dim_id = S.claim_trans_type_dim_id2, T.claim_financial_type_dim_id = S.claim_financial_type_dim_id2, T.claim_rep_dim_prim_claim_rep_id = S.claim_rep_dim_prim_claim_rep_id, T.claim_rep_dim_prim_claim_rep_hist_id = S.claim_rep_dim_prim_claim_rep_hist_id, T.claim_rep_dim_examiner_id = S.claim_rep_dim_examiner_id_out2, T.claim_rep_dim_examiner_hist_id = S.claim_rep_dim_examiner_hist_id_out2, T.claim_rep_dim_prim_litigation_handler_id = S.claim_rep_dim_prim_litigation_handler_id_out2, T.claim_rep_dim_prim_litigation_handler_hist_id = S.claim_rep_dim_prim_litigation_handler_hist_id_out2, T.claim_rep_dim_trans_entry_oper_id = S.payment_entry_operator_id_out3, T.claim_rep_dim_trans_entry_oper_hist_id = S.payment_entry_operator_hist_id_out3, T.claim_rep_dim_claim_created_by_id = S.claim_created_by_dim_id43, T.pol_dim_id = S.pol_key_dim_id2, T.pol_dim_hist_id = S.pol_key_dim_hist_id2, T.agency_dim_id = S.agency_dim_id2, T.agency_dim_hist_id = S.agency_dim_hist_id2, T.claim_pay_dim_id = S.claim_payment_dim_id_out2, T.claim_pay_dim_hist_id = S.claim_payment_dim_hist_id_out2, T.claim_pay_ctgry_type_dim_id = S.claim_pay_ctgry_type_dim_id_out2, T.claim_pay_ctgry_type_dim_hist_id = S.claim_pay_ctgry_type_dim_hist_id_out2, T.claim_case_dim_id = S.claim_case_dim_id_out1, T.claim_case_dim_hist_id = S.claim_case_dim_hist_id_out1, T.contract_cust_dim_id = S.contract_cust_dim_id_out, T.contract_cust_dim_hist_id = S.contract_cust_dim_hist_id_out, T.claim_master_1099_list_dim_id = S.claim_master_1099_list_dim_id2, T.claim_subrogation_dim_id = S.claim_subrogation_dim_id_out3, T.claim_trans_date_id = S.claim_trans_date_id2, T.claim_trans_reprocess_date_id = S.reprocess_date_id2, T.claim_loss_date_id = S.claim_loss_date_id2, T.claim_discovery_date_id = S.claim_discovery_date_id2, T.claim_scripted_date_id = S.claim_scripted_date_id, T.source_claim_rpted_date_id = S.source_claim_rpted_date_id, T.claim_rpted_date_id = S.claim_occurrence_rpted_date_id2, T.claim_open_date_id = S.claim_open_date_id2, T.claim_close_date_id = S.claim_close_date_id2, T.claim_reopen_date_id = S.claim_reopen_date_id2, T.claim_closed_after_reopen_date_id = S.claim_closed_after_reopen_date_id2, T.claim_notice_only_date_id = S.claim_notice_only_date_id, T.claim_cat_start_date_id = S.claim_cat_start_date_id2, T.claim_cat_end_date_id = S.claim_cat_end_date_id2, T.claim_rep_assigned_date_id = S.claim_rep_assigned_date_id2, T.claim_rep_unassigned_date_id = S.claim_rep_unassigned_date_id2, T.pol_eff_date_id = S.pol_eff_date_id2, T.pol_exp_date_id = S.pol_exp_date_id2, T.claim_subrogation_referred_to_subrogation_date_id = S.referred_to_subrogation_date_id3, T.claim_subrogation_pay_start_date_id = S.pay_start_date_id3, T.claim_subrogation_closure_date_id = S.closure_date_id3, T.acct_entered_date_id = S.acct_entered_date_id3, T.trans_amt = S.trans_amt2, T.trans_hist_amt = S.trans_hist_amt2, T.tax_id = S.tax_id2, T.direct_loss_paid_excluding_recoveries = S.direct_loss_paid_excluding_recoveries, T.direct_loss_outstanding_excluding_recoveries = S.direct_loss_outstanding_excluding_recoveries, T.direct_loss_incurred_excluding_recoveries = S.direct_loss_incurred_excluding_recoveries, T.direct_alae_paid_excluding_recoveries = S.direct_alae_paid_excluding_recoveries, T.direct_alae_outstanding_excluding_recoveries = S.direct_alae_outstanding_excluding_recoveries, T.direct_alae_incurred_excluding_recoveries = S.direct_alae_incurred_excluding_recoveries, T.direct_loss_paid_including_recoveries = S.direct_loss_paid_including_recoveries, T.direct_loss_outstanding_including_recoveries = S.direct_loss_outstanding_including_recoveries, T.direct_loss_incurred_including_recoveries = S.direct_loss_incurred_including_recoveries, T.direct_alae_paid_including_recoveries = S.direct_alae_paid_including_recoveries, T.direct_alae_outstanding_including_recoveries = S.direct_alae_outstanding_including_recoveries, T.direct_alae_incurred_including_recoveries = S.direct_alae_incurred_including_recoveries, T.direct_subrogation_paid = S.direct_subrogation_paid, T.direct_subrogation_outstanding = S.direct_subrogation_outstanding, T.direct_subrogation_incurred = S.direct_subrogation_incurred, T.direct_salvage_paid = S.direct_salvage_paid, T.direct_salvage_outstanding = S.direct_salvage_outstanding, T.direct_salvage_incurred = S.direct_salvage_incurred, T.direct_other_recovery_loss_paid = S.direct_other_recovery_loss_paid, T.direct_other_recovery_loss_outstanding = S.direct_other_recovery_loss_outstanding, T.direct_other_recovery_loss_incurred = S.direct_other_recovery_loss_incurred, T.direct_other_recovery_alae_paid = S.direct_other_recovery_alae_paid, T.direct_other_recovery_alae_outstanding = S.direct_other_recovery_alae_outstanding, T.direct_other_recovery_alae_incurred = S.direct_other_recovery_alae_incurred, T.total_direct_loss_recovery_paid = S.total_direct_loss_recovery_paid, T.total_direct_loss_recovery_outstanding = S.total_direct_loss_recovery_outstanding, T.total_direct_loss_recovery_incurred = S.total_direct_loss_recovery_incurred, T.direct_other_recovery_paid = S.direct_other_recovery_paid, T.direct_other_recovery_outstanding = S.direct_other_recovery_outstanding, T.direct_other_recovery_incurred = S.direct_other_recovery_incurred, T.net_loss_paid = S.net_loss_paid2, T.net_loss_outstanding = S.net_loss_outstanding2, T.net_loss_incurred = S.net_loss_incurred2, T.net_alae_paid = S.net_alae_paid2, T.net_alae_outstanding = S.net_alae_outstanding2, T.net_alae_incurred = S.net_alae_incurred2, T.ClaimReserveDimId = S.ClaimReserveDimId3, T.ClaimRepresentativeDimFeatureClaimRepresentativeId = S.FeatureRepresentativeDimId3, T.FeatureRepresentativeAssignedDateId = S.FeatureRepresentativeAssignedDate_id3, T.InsuranceReferenceDimId = S.InsuranceReferenceDimId3, T.AgencyDimId = S.AgencyDimID3, T.SalesDivisionDimId = S.SalesDivisionDimID3, T.InsuranceReferenceCoverageDimId = S.InsuranceReferenceCoverageDetailDimID3, T.CoverageDetailDimId = S.CoverageDetailDimId3, T.ModifiedDate = S.ModifiedDate3\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "NUM_OF_PARTITIONS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "DB_NAME_DATAMART": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsDataMart/"
        },
        "annotations": []
    }
}