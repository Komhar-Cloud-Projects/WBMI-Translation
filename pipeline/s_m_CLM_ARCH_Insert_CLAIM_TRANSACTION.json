{
    "name": "s_m_CLM_ARCH_Insert_CLAIM_TRANSACTION",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_CLAIM_TRANSACTION",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CLAIM_TRANSACTION_STAGE AS (\n\tSELECT\n\t\tclaim_transaction_id AS CLAIM_TRANSACTION_ID,\n\t\tctx_claim_nbr AS CTX_CLAIM_NBR,\n\t\tctx_client_id AS CTX_CLIENT_ID,\n\t\tctx_object_type_cd AS CTX_OBJECT_TYPE_CD,\n\t\tctx_object_seq_nbr AS CTX_OBJECT_SEQ_NBR,\n\t\tctx_cov_type_cd AS CTX_COV_TYPE_CD,\n\t\tctx_cov_seq_nbr AS CTX_COV_SEQ_NBR,\n\t\tctx_bur_cause_loss AS CTX_BUR_CAUSE_LOSS,\n\t\tctx_fin_type_cd AS CTX_FIN_TYPE_CD,\n\t\tctx_sort_ts AS CTX_SORT_TS,\n\t\tctx_trs_type_cd AS CTX_TRS_TYPE_CD,\n\t\tctx_adjuster_nbr AS CTX_ADJUSTER_NBR,\n\t\tctx_draft_nbr AS CTX_DRAFT_NBR,\n\t\tctx_upd_ts AS CTX_UPD_TS,\n\t\tctx_trs_cat_cd AS CTX_TRS_CAT_CD,\n\t\tctx_trs_amt AS CTX_TRS_AMT,\n\t\tctx_trs_dt AS CTX_TRS_DT,\n\t\tctx_update_opr_id AS CTX_UPDATE_OPR_ID,\n\t\tctx_pmsd_ts AS CTX_PMSD_TS,\n\t\tctx_entry_opr_id AS CTX_ENTRY_OPR_ID,\n\t\tctx_trs_hst_amt AS CTX_TRS_HST_AMT,\n\t\tctx_ofs_trs_cat AS CTX_OFS_TRS_CAT,\n\t\tctx_base_trs_type AS CTX_BASE_TRS_TYPE,\n\t\tctx_mem_cd AS CTX_MEM_CD,\n\t\tctx_type_dis_cd AS CTX_TYPE_DIS_CD,\n\t\tctx_dis_cd AS CTX_DIS_CD,\n\t\tctx_reissue_of_nbr AS CTX_REISSUE_OF_NBR,\n\t\tctx_ofs_rei_ind AS CTX_OFS_REI_IND,\n\t\tctx_avg_res_ind AS CTX_AVG_RES_IND,\n\t\tctx_single_chk_ind AS CTX_SINGLE_CHK_IND,\n\t\tctx_balance_dt AS CTX_BALANCE_DT,\n\t\tctx_dsb_req_cd AS CTX_DSB_REQ_CD,\n\t\tctx_bus_cls_cd AS CTX_BUS_CLS_CD,\n\t\tctx_create_ts AS CTX_CREATE_TS,\n\t\tctx_reserve_id AS CTX_RESERVE_ID,\n\t\tctx_from_dt AS CTX_FROM_DT,\n\t\tctx_thru_dt AS CTX_THRU_DT,\n\t\tctx_memo_act_id AS CTX_MEMO_ACT_ID,\n\t\tctx_inj_emp_id AS CTX_INJ_EMP_ID,\n\t\tctx_weeks_nbr AS CTX_WEEKS_NBR,\n\t\tctx_days_nbr AS CTX_DAYS_NBR,\n\t\tctx_dup_pmt_ind AS CTX_DUP_PMT_IND,\n\t\tctx_pool_ind AS CTX_POOL_IND,\n\t\tctx_loan_nbr AS CTX_LOAN_NBR,\n\t\tctx_prc_sta_ind AS CTX_PRC_STA_IND,\n\t\tctx_trans_reason AS CTX_TRANS_REASON,\n\t\tctx_paid_holiday AS CTX_PAID_HOLIDAY,\n\t\tctx_hours_worked AS CTX_HOURS_WORKED,\n\t\tctx_hourly_rate AS CTX_HOURLY_RATE,\n\t\tctx_tpd_wkly_wage AS CTX_TPD_WKLY_WAGE,\n\t\tctx_tpd_rate_fctr AS CTX_TPD_RATE_FCTR,\n\t\tctx_invoice_nbr AS CTX_INVOICE_NBR,\n\t\tctx_cost_cont_sav AS CTX_COST_CONT_SAV,\n\t\tctx_billed_amt AS CTX_BILLED_AMT,\n\t\tctx_cost_cont_ppo AS CTX_COST_CONT_PPO,\n\t\tctx_cost_cont_red AS CTX_COST_CONT_RED,\n\t\tctx_aty_file_num AS CTX_ATY_FILE_NUM,\n\t\tctx_event_date AS CTX_EVENT_DATE,\n\t\textract_date AS EXTRACT_DATE,\n\t\tas_of_date AS AS_OF_DATE,\n\t\trecord_count AS RECORD_COUNT,\n\t\tsource_system_id AS SOURCE_SYSTEM_ID,\n\t\tctx_admin_override\n\tFROM CLAIM_TRANSACTION_STAGE\n),\nEXP_CLAIM_TRANSACTION_STAGE AS (\n\tSELECT\n\tCLAIM_TRANSACTION_ID,\n\tCTX_CLAIM_NBR,\n\tCTX_CLIENT_ID,\n\tCTX_OBJECT_TYPE_CD,\n\tCTX_OBJECT_SEQ_NBR,\n\tCTX_COV_TYPE_CD,\n\tCTX_COV_SEQ_NBR,\n\tCTX_BUR_CAUSE_LOSS,\n\tCTX_FIN_TYPE_CD,\n\tCTX_SORT_TS,\n\tCTX_TRS_TYPE_CD,\n\tCTX_ADJUSTER_NBR,\n\tCTX_DRAFT_NBR,\n\tCTX_UPD_TS,\n\tCTX_TRS_CAT_CD,\n\tCTX_TRS_AMT,\n\tCTX_TRS_DT,\n\tCTX_UPDATE_OPR_ID,\n\tCTX_PMSD_TS,\n\tCTX_ENTRY_OPR_ID,\n\tCTX_TRS_HST_AMT,\n\tCTX_OFS_TRS_CAT,\n\tCTX_BASE_TRS_TYPE,\n\tCTX_MEM_CD,\n\tCTX_TYPE_DIS_CD,\n\tCTX_DIS_CD,\n\tCTX_REISSUE_OF_NBR,\n\tCTX_OFS_REI_IND,\n\tCTX_AVG_RES_IND,\n\tCTX_SINGLE_CHK_IND,\n\tCTX_BALANCE_DT,\n\tCTX_DSB_REQ_CD,\n\tCTX_BUS_CLS_CD,\n\tCTX_CREATE_TS,\n\tCTX_RESERVE_ID,\n\tCTX_FROM_DT,\n\tCTX_THRU_DT,\n\tCTX_MEMO_ACT_ID,\n\tCTX_INJ_EMP_ID,\n\tCTX_WEEKS_NBR,\n\tCTX_DAYS_NBR,\n\tCTX_DUP_PMT_IND,\n\tCTX_POOL_IND,\n\tCTX_LOAN_NBR,\n\tCTX_PRC_STA_IND,\n\tCTX_TRANS_REASON,\n\tCTX_PAID_HOLIDAY,\n\tCTX_HOURS_WORKED,\n\tCTX_HOURLY_RATE,\n\tCTX_TPD_WKLY_WAGE,\n\tCTX_TPD_RATE_FCTR,\n\tCTX_INVOICE_NBR,\n\tCTX_COST_CONT_SAV,\n\tCTX_BILLED_AMT,\n\tCTX_COST_CONT_PPO,\n\tCTX_COST_CONT_RED,\n\tCTX_ATY_FILE_NUM,\n\tCTX_EVENT_DATE,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\tctx_admin_override,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_CLAIM_TRANSACTION_STAGE\n),\nARCH_CLAIM_TRANSACTION_STAGE AS (\n\tINSERT INTO ARCH_CLAIM_TRANSACTION_STAGE\n\t(claim_transaction_id, ctx_claim_nbr, ctx_client_id, ctx_object_type_cd, ctx_object_seq_nbr, ctx_cov_type_cd, ctx_cov_seq_nbr, ctx_bur_cause_loss, ctx_fin_type_cd, ctx_sort_ts, ctx_trs_type_cd, ctx_adjuster_nbr, ctx_draft_nbr, ctx_upd_ts, ctx_trs_cat_cd, ctx_trs_amt, ctx_trs_dt, ctx_update_opr_id, ctx_pmsd_ts, ctx_entry_opr_id, ctx_trs_hst_amt, ctx_ofs_trs_cat, ctx_base_trs_type, ctx_mem_cd, ctx_type_dis_cd, ctx_dis_cd, ctx_reissue_of_nbr, ctx_ofs_rei_ind, ctx_avg_res_ind, ctx_single_chk_ind, ctx_balance_dt, ctx_dsb_req_cd, ctx_bus_cls_cd, ctx_create_ts, ctx_reserve_id, ctx_from_dt, ctx_thru_dt, ctx_memo_act_id, ctx_inj_emp_id, ctx_weeks_nbr, ctx_days_nbr, ctx_dup_pmt_ind, ctx_pool_ind, ctx_loan_nbr, ctx_prc_sta_ind, ctx_trans_reason, ctx_paid_holiday, ctx_hours_worked, ctx_hourly_rate, ctx_tpd_wkly_wage, ctx_tpd_rate_fctr, ctx_invoice_nbr, ctx_cost_cont_sav, ctx_billed_amt, ctx_cost_cont_ppo, ctx_cost_cont_red, ctx_aty_file_num, ctx_event_date, extract_date, as_of_date, record_count, source_system_id, audit_id, ctx_admin_override)\n\tSELECT \n\tCLAIM_TRANSACTION_ID AS CLAIM_TRANSACTION_ID, \n\tCTX_CLAIM_NBR AS CTX_CLAIM_NBR, \n\tCTX_CLIENT_ID AS CTX_CLIENT_ID, \n\tCTX_OBJECT_TYPE_CD AS CTX_OBJECT_TYPE_CD, \n\tCTX_OBJECT_SEQ_NBR AS CTX_OBJECT_SEQ_NBR, \n\tCTX_COV_TYPE_CD AS CTX_COV_TYPE_CD, \n\tCTX_COV_SEQ_NBR AS CTX_COV_SEQ_NBR, \n\tCTX_BUR_CAUSE_LOSS AS CTX_BUR_CAUSE_LOSS, \n\tCTX_FIN_TYPE_CD AS CTX_FIN_TYPE_CD, \n\tCTX_SORT_TS AS CTX_SORT_TS, \n\tCTX_TRS_TYPE_CD AS CTX_TRS_TYPE_CD, \n\tCTX_ADJUSTER_NBR AS CTX_ADJUSTER_NBR, \n\tCTX_DRAFT_NBR AS CTX_DRAFT_NBR, \n\tCTX_UPD_TS AS CTX_UPD_TS, \n\tCTX_TRS_CAT_CD AS CTX_TRS_CAT_CD, \n\tCTX_TRS_AMT AS CTX_TRS_AMT, \n\tCTX_TRS_DT AS CTX_TRS_DT, \n\tCTX_UPDATE_OPR_ID AS CTX_UPDATE_OPR_ID, \n\tCTX_PMSD_TS AS CTX_PMSD_TS, \n\tCTX_ENTRY_OPR_ID AS CTX_ENTRY_OPR_ID, \n\tCTX_TRS_HST_AMT AS CTX_TRS_HST_AMT, \n\tCTX_OFS_TRS_CAT AS CTX_OFS_TRS_CAT, \n\tCTX_BASE_TRS_TYPE AS CTX_BASE_TRS_TYPE, \n\tCTX_MEM_CD AS CTX_MEM_CD, \n\tCTX_TYPE_DIS_CD AS CTX_TYPE_DIS_CD, \n\tCTX_DIS_CD AS CTX_DIS_CD, \n\tCTX_REISSUE_OF_NBR AS CTX_REISSUE_OF_NBR, \n\tCTX_OFS_REI_IND AS CTX_OFS_REI_IND, \n\tCTX_AVG_RES_IND AS CTX_AVG_RES_IND, \n\tCTX_SINGLE_CHK_IND AS CTX_SINGLE_CHK_IND, \n\tCTX_BALANCE_DT AS CTX_BALANCE_DT, \n\tCTX_DSB_REQ_CD AS CTX_DSB_REQ_CD, \n\tCTX_BUS_CLS_CD AS CTX_BUS_CLS_CD, \n\tCTX_CREATE_TS AS CTX_CREATE_TS, \n\tCTX_RESERVE_ID AS CTX_RESERVE_ID, \n\tCTX_FROM_DT AS CTX_FROM_DT, \n\tCTX_THRU_DT AS CTX_THRU_DT, \n\tCTX_MEMO_ACT_ID AS CTX_MEMO_ACT_ID, \n\tCTX_INJ_EMP_ID AS CTX_INJ_EMP_ID, \n\tCTX_WEEKS_NBR AS CTX_WEEKS_NBR, \n\tCTX_DAYS_NBR AS CTX_DAYS_NBR, \n\tCTX_DUP_PMT_IND AS CTX_DUP_PMT_IND, \n\tCTX_POOL_IND AS CTX_POOL_IND, \n\tCTX_LOAN_NBR AS CTX_LOAN_NBR, \n\tCTX_PRC_STA_IND AS CTX_PRC_STA_IND, \n\tCTX_TRANS_REASON AS CTX_TRANS_REASON, \n\tCTX_PAID_HOLIDAY AS CTX_PAID_HOLIDAY, \n\tCTX_HOURS_WORKED AS CTX_HOURS_WORKED, \n\tCTX_HOURLY_RATE AS CTX_HOURLY_RATE, \n\tCTX_TPD_WKLY_WAGE AS CTX_TPD_WKLY_WAGE, \n\tCTX_TPD_RATE_FCTR AS CTX_TPD_RATE_FCTR, \n\tCTX_INVOICE_NBR AS CTX_INVOICE_NBR, \n\tCTX_COST_CONT_SAV AS CTX_COST_CONT_SAV, \n\tCTX_BILLED_AMT AS CTX_BILLED_AMT, \n\tCTX_COST_CONT_PPO AS CTX_COST_CONT_PPO, \n\tCTX_COST_CONT_RED AS CTX_COST_CONT_RED, \n\tCTX_ATY_FILE_NUM AS CTX_ATY_FILE_NUM, \n\tCTX_EVENT_DATE AS CTX_EVENT_DATE, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID, \n\tCTX_ADMIN_OVERRIDE\n\tFROM EXP_CLAIM_TRANSACTION_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "ClaimsStaging/"
        },
        "annotations": []
    }
}