WITH
SQ_Pif43RXIMStage AS (
	SELECT
		Pif43RXIMStageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		PMDRXI1SegmentId,
		PMDRXI1SegmentStatus,
		PMDRXI1YearTransaction,
		PMDRXI1MonthTransaction,
		PMDRXI1DayTransaction,
		PMDRXI1SegmentLevelCode,
		PMDRXI1SegmentPartCode,
		PMDRXI1SubPartCode,
		PMDRXI1InsuranceLine,
		PMDRXI1LocationNumber,
		PMDRXI1SubLocationNumber,
		PMDRXI1RiskUnitGroup,
		PMDRXI1SequenceNumber,
		PMDRXI1YearItemEffective,
		PMDRXI1MonthItemEffective,
		PMDRXI1DayItemEffective,
		PMDRXI1VariableKey,
		PMDRXI1YearProcess,
		PMDRXI1MonthProcess,
		PMDRXI1DayProcess,
		PMDRXI1RatingState,
		PMDRXI1CompanyNumber,
		PMDRXI1BasisOfCoverage,
		PMDRXI1BasisLoc0Ind,
		PMDRXI1FormType,
		PMDRXI1FormLoc0Ind,
		PMDRXI1LimitOfInsurance,
		PMDRXI1PmaCode,
		PMDRXI1FilingStatus,
		PMDRXI1ArVpReceptacleCr,
		PMDRXI1ArVpAfpLimit,
		PMDRXI1ArAverageLimit,
		PMDRXI1ArDupRecordsPct,
		PMDRXI1ArClassOfRisk,
		PMDRXI1DeductibleX,
		PMDRXI1DeductibleLoc0Ind,
		PMDRXI1Irpm,
		PMDRXI1IrpmLoc0Ind,
		PMDRXI1ScheduleMod,
		PMDRXI1SchedLoc0Ind,
		PMDRXI1ExpenseMod,
		PMDRXI1ExpenseLoc0Ind,
		PMDRXI1OtherMod,
		PMDRXI1OtherLoc0Ind,
		PMDRXI1CommRedMod,
		PMDRXI1CommRedLoc0Ind,
		PMDRXI1AgentsCommRate,
		PMDRXI1AgentsCommInd,
		PMDRXI1SignsPosition,
		PMDRXI1DecChangeFlag,
		PMDRXI1LossCostMult1,
		PMDRXI1LossCostMult2,
		PMDRXI1LossCostMult3,
		PMDRXI1RcAcv,
		PMDRXI1Coinsurance,
		PMDRXI1AutoIncrease,
		PMDRXI1BlanketInsuranceInd,
		PMDRXI1PlusPakInd,
		PMDRXI1ArInTransit,
		PMDRXI1Pma2Code,
		PMDRXI1PmscFutureUse,
		PMDRXI1CustomerFutureUse,
		PMDRXI1Yr2000CustUse
	FROM Pif43RXIMStage
),
EXP_Pif43RXIMStage AS (
	SELECT
	Pif43RXIMStageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	PMDRXI1SegmentId,
	PMDRXI1SegmentStatus,
	PMDRXI1YearTransaction,
	PMDRXI1MonthTransaction,
	PMDRXI1DayTransaction,
	PMDRXI1SegmentLevelCode,
	PMDRXI1SegmentPartCode,
	PMDRXI1SubPartCode,
	PMDRXI1InsuranceLine,
	PMDRXI1LocationNumber,
	PMDRXI1SubLocationNumber,
	PMDRXI1RiskUnitGroup,
	PMDRXI1SequenceNumber,
	PMDRXI1YearItemEffective,
	PMDRXI1MonthItemEffective,
	PMDRXI1DayItemEffective,
	PMDRXI1VariableKey,
	PMDRXI1YearProcess,
	PMDRXI1MonthProcess,
	PMDRXI1DayProcess,
	PMDRXI1RatingState,
	PMDRXI1CompanyNumber,
	PMDRXI1BasisOfCoverage,
	PMDRXI1BasisLoc0Ind,
	PMDRXI1FormType,
	PMDRXI1FormLoc0Ind,
	PMDRXI1LimitOfInsurance,
	PMDRXI1PmaCode,
	PMDRXI1FilingStatus,
	PMDRXI1ArVpReceptacleCr,
	PMDRXI1ArVpAfpLimit,
	PMDRXI1ArAverageLimit,
	PMDRXI1ArDupRecordsPct,
	PMDRXI1ArClassOfRisk,
	PMDRXI1DeductibleX,
	PMDRXI1DeductibleLoc0Ind,
	PMDRXI1Irpm,
	PMDRXI1IrpmLoc0Ind,
	PMDRXI1ScheduleMod,
	PMDRXI1SchedLoc0Ind,
	PMDRXI1ExpenseMod,
	PMDRXI1ExpenseLoc0Ind,
	PMDRXI1OtherMod,
	PMDRXI1OtherLoc0Ind,
	PMDRXI1CommRedMod,
	PMDRXI1CommRedLoc0Ind,
	PMDRXI1AgentsCommRate,
	PMDRXI1AgentsCommInd,
	PMDRXI1SignsPosition,
	PMDRXI1DecChangeFlag,
	PMDRXI1LossCostMult1,
	PMDRXI1LossCostMult2,
	PMDRXI1LossCostMult3,
	PMDRXI1RcAcv,
	PMDRXI1Coinsurance,
	PMDRXI1AutoIncrease,
	PMDRXI1BlanketInsuranceInd,
	PMDRXI1PlusPakInd,
	PMDRXI1ArInTransit,
	PMDRXI1Pma2Code,
	PMDRXI1PmscFutureUse,
	PMDRXI1CustomerFutureUse,
	PMDRXI1Yr2000CustUse,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif43RXIMStage
),
ArchPif43RXIMStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43RXIMStage
	(ExtractDate, SourceSystemid, AuditId, PifSymbol, PifPolicyNumber, PifModule, PMDRXI1SegmentId, PMDRXI1SegmentStatus, PMDRXI1YearTransaction, PMDRXI1MonthTransaction, PMDRXI1DayTransaction, PMDRXI1SegmentLevelCode, PMDRXI1SegmentPartCode, PMDRXI1SubPartCode, PMDRXI1InsuranceLine, PMDRXI1LocationNumber, PMDRXI1SubLocationNumber, PMDRXI1RiskUnitGroup, PMDRXI1SequenceNumber, PMDRXI1YearItemEffective, PMDRXI1MonthItemEffective, PMDRXI1DayItemEffective, PMDRXI1VariableKey, PMDRXI1YearProcess, PMDRXI1MonthProcess, PMDRXI1DayProcess, PMDRXI1RatingState, PMDRXI1CompanyNumber, PMDRXI1BasisOfCoverage, PMDRXI1BasisLoc0Ind, PMDRXI1FormType, PMDRXI1FormLoc0Ind, PMDRXI1LimitOfInsurance, PMDRXI1PmaCode, PMDRXI1FilingStatus, PMDRXI1ArVpReceptacleCr, PMDRXI1ArVpAfpLimit, PMDRXI1ArAverageLimit, PMDRXI1ArDupRecordsPct, PMDRXI1ArClassOfRisk, PMDRXI1DeductibleX, PMDRXI1DeductibleLoc0Ind, PMDRXI1Irpm, PMDRXI1IrpmLoc0Ind, PMDRXI1ScheduleMod, PMDRXI1SchedLoc0Ind, PMDRXI1ExpenseMod, PMDRXI1ExpenseLoc0Ind, PMDRXI1OtherMod, PMDRXI1OtherLoc0Ind, PMDRXI1CommRedMod, PMDRXI1CommRedLoc0Ind, PMDRXI1AgentsCommRate, PMDRXI1AgentsCommInd, PMDRXI1SignsPosition, PMDRXI1DecChangeFlag, PMDRXI1LossCostMult1, PMDRXI1LossCostMult2, PMDRXI1LossCostMult3, PMDRXI1RcAcv, PMDRXI1Coinsurance, PMDRXI1AutoIncrease, PMDRXI1BlanketInsuranceInd, PMDRXI1PlusPakInd, PMDRXI1ArInTransit, PMDRXI1Pma2Code, PMDRXI1PmscFutureUse, PMDRXI1CustomerFutureUse, PMDRXI1Yr2000CustUse)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_audit_id AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDRXI1SEGMENTID, 
	PMDRXI1SEGMENTSTATUS, 
	PMDRXI1YEARTRANSACTION, 
	PMDRXI1MONTHTRANSACTION, 
	PMDRXI1DAYTRANSACTION, 
	PMDRXI1SEGMENTLEVELCODE, 
	PMDRXI1SEGMENTPARTCODE, 
	PMDRXI1SUBPARTCODE, 
	PMDRXI1INSURANCELINE, 
	PMDRXI1LOCATIONNUMBER, 
	PMDRXI1SUBLOCATIONNUMBER, 
	PMDRXI1RISKUNITGROUP, 
	PMDRXI1SEQUENCENUMBER, 
	PMDRXI1YEARITEMEFFECTIVE, 
	PMDRXI1MONTHITEMEFFECTIVE, 
	PMDRXI1DAYITEMEFFECTIVE, 
	PMDRXI1VARIABLEKEY, 
	PMDRXI1YEARPROCESS, 
	PMDRXI1MONTHPROCESS, 
	PMDRXI1DAYPROCESS, 
	PMDRXI1RATINGSTATE, 
	PMDRXI1COMPANYNUMBER, 
	PMDRXI1BASISOFCOVERAGE, 
	PMDRXI1BASISLOC0IND, 
	PMDRXI1FORMTYPE, 
	PMDRXI1FORMLOC0IND, 
	PMDRXI1LIMITOFINSURANCE, 
	PMDRXI1PMACODE, 
	PMDRXI1FILINGSTATUS, 
	PMDRXI1ARVPRECEPTACLECR, 
	PMDRXI1ARVPAFPLIMIT, 
	PMDRXI1ARAVERAGELIMIT, 
	PMDRXI1ARDUPRECORDSPCT, 
	PMDRXI1ARCLASSOFRISK, 
	PMDRXI1DEDUCTIBLEX, 
	PMDRXI1DEDUCTIBLELOC0IND, 
	PMDRXI1IRPM, 
	PMDRXI1IRPMLOC0IND, 
	PMDRXI1SCHEDULEMOD, 
	PMDRXI1SCHEDLOC0IND, 
	PMDRXI1EXPENSEMOD, 
	PMDRXI1EXPENSELOC0IND, 
	PMDRXI1OTHERMOD, 
	PMDRXI1OTHERLOC0IND, 
	PMDRXI1COMMREDMOD, 
	PMDRXI1COMMREDLOC0IND, 
	PMDRXI1AGENTSCOMMRATE, 
	PMDRXI1AGENTSCOMMIND, 
	PMDRXI1SIGNSPOSITION, 
	PMDRXI1DECCHANGEFLAG, 
	PMDRXI1LOSSCOSTMULT1, 
	PMDRXI1LOSSCOSTMULT2, 
	PMDRXI1LOSSCOSTMULT3, 
	PMDRXI1RCACV, 
	PMDRXI1COINSURANCE, 
	PMDRXI1AUTOINCREASE, 
	PMDRXI1BLANKETINSURANCEIND, 
	PMDRXI1PLUSPAKIND, 
	PMDRXI1ARINTRANSIT, 
	PMDRXI1PMA2CODE, 
	PMDRXI1PMSCFUTUREUSE, 
	PMDRXI1CUSTOMERFUTUREUSE, 
	PMDRXI1YR2000CUSTUSE
	FROM EXP_Pif43RXIMStage
),