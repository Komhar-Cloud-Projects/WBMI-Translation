{
    "name": "s_m_FEED_Load_WCSTAT_Extract_File",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_WCSTAT_Extract_File",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkWCSTATExtract AS (\n\tSELECT\n\t\tWorkWCSTATExtractId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tEDWPremiumMasterCalculationPKId,\n\t\tEDWLossMasterCalculationPKId,\n\t\tTypeBureauCode,\n\t\tPremiumMasterRunDate,\n\t\tLossMasterRunDate,\n\t\tBureauCompanyCode,\n\t\tPolicyKey,\n\t\tStateProvinceCode,\n\t\tPolicyEffectiveDate,\n\t\tPolicyEndDate,\n\t\tInterstateRiskId,\n\t\tEmployeeLeasingCode,\n\t\tStateRatingEffectiveDate,\n\t\tFederalTaxId,\n\t\tThreeYearFixedRatePolicyIndicator,\n\t\tMultistatePolicyIndicator,\n\t\tInterstateRatedPolicyIndicator,\n\t\tEstimatedAuditCode,\n\t\tRetrospectiveratedPolicyIndicator,\n\t\tCancelledMidTermPolicyIndicator,\n\t\tManagedCareOrganizationPolicyIndicator,\n\t\tTypeOfCoverageIdCode,\n\t\tTypeOfPlan,\n\t\tLossSubjectToDeductibleCode,\n\t\tBasisOfDeductibleCalculationCode,\n\t\tDeductibleAmountPerClaimAccident,\n\t\tInsuredName,\n\t\tWCSTATAddress,\n\t\tPremiumMasterClassCode,\n\t\tExperienceModificationFactor,\n\t\tExperienceModificationEffectiveDate,\n\t\tExposure,\n\t\tPremiumMasterDirectWrittenPremiumAmount,\n\t\tManualChargedRate,\n\t\tLossMasterClassCode,\n\t\tClaimLossDate,\n\t\tClaimNumber,\n\t\tClaimOccurrenceStatusCode,\n\t\tInjuryTypeCode,\n\t\tCatastropheCode,\n\t\tIncurredIndemnityAmount,\n\t\tIncurredMedicalAmount,\n\t\tCauseOfLoss,\n\t\tTypeOfRecoveryCode,\n\t\tJurisdictionStateCode,\n\t\tBodyPartCode,\n\t\tNatureOfInjuryCode,\n\t\tCauseOfInjuryCode,\n\t\tPaidIndemnityAmount,\n\t\tPaidMedicalAmount,\n\t\tDeductibleReimbursementAmount,\n\t\tPaidAllocatedLossAdjustmentExpenseAmount,\n\t\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\t\tSubjectPremiumTotal,\n\t\tStandarPremiumTotal,\n\t\tCorrectionSeqNumber,\n\t\tReplacementReportCode,\n\t\tCorrectionTypeCode,\n\t\tTypeOfNonStandardIdCode,\n\t\tPreviousReportLevelCodeReportNumber,\n\t\tUpdateTypeCode,\n\t\tTypeOfLoss,\n\t\tTypeOfClaim,\n\t\tTypeOfSettlement,\n\t\tManagedCareOrganizationType,\n\t\tVocationalRehabIndicator,\n\t\tLumpSumIndicator,\n\t\tFraudulentClaimCode,\n\t\tClaimantNumber,\n\t\tRateEffectiveDate,\n\t\tSplitPeriodCode,\n\t\tOccupationDescription,\n\t\tWeeklyWageAmount,\n\t\tEmployerAttorneyFees AS EmployersAttorneyFees\n\tFROM WorkWCSTATExtract\n\tWHERE ((WorkWCSTATExtract.EDWLossMasterCalculationPKId = -1 and (DATEDIFF(MM,WorkWCSTATExtract.PolicyEffectiveDate, DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) +@{pipeline().parameters.NUM_OF_MONTHS}, 0) ) = 18))\r\n\tOR WorkWCSTATExtract.EDWLossMasterCalculationPKId != -1)\r\n\tAND WorkWCSTATExtract.AuditId= @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Cleansing AS (\n\tSELECT\n\tWorkWCSTATExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeBureauCode))\n\tRTRIM(LTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tBureauCompanyCode AS i_BureauCompanyCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauCompanyCode))\n\tRTRIM(LTRIM(i_BureauCompanyCode)) AS o_BureauCompanyCode,\n\tPolicyKey AS i_PolicyKey,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyKey))\n\tRTRIM(LTRIM(i_PolicyKey)) AS o_PolicyKey,\n\tStateProvinceCode AS i_StateProvinceCode,\n\t-- *INF*: RTRIM(LTRIM(i_StateProvinceCode))\n\tRTRIM(LTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\tPolicyEffectiveDate,\n\tPolicyEndDate,\n\tInterstateRiskId AS i_InterstateRiskId,\n\t-- *INF*: RTRIM(LTRIM(i_InterstateRiskId))\n\tRTRIM(LTRIM(i_InterstateRiskId)) AS o_InterstateRiskId,\n\tEmployeeLeasingCode AS i_EmployeeLeasingCode,\n\t-- *INF*: RTRIM(LTRIM(i_EmployeeLeasingCode))\n\tRTRIM(LTRIM(i_EmployeeLeasingCode)) AS o_EmployeeLeasingCode,\n\tStateRatingEffectiveDate,\n\tFederalTaxId AS i_FederalTaxId,\n\t-- *INF*: RTRIM(LTRIM(i_FederalTaxId))\n\tRTRIM(LTRIM(i_FederalTaxId)) AS o_FederalTaxId,\n\tThreeYearFixedRatePolicyIndicator AS i_ThreeYearFixedRatePolicyIndicator,\n\t-- *INF*: IIF(i_ThreeYearFixedRatePolicyIndicator='T',1,0)\n\tIFF(i_ThreeYearFixedRatePolicyIndicator = 'T', 1, 0) AS o_ThreeYearFixedRatePolicyIndicator,\n\tMultistatePolicyIndicator AS i_MultistatePolicyIndicator,\n\t-- *INF*: IIF(i_MultistatePolicyIndicator='T',1,0)\n\tIFF(i_MultistatePolicyIndicator = 'T', 1, 0) AS o_MultistatePolicyIndicator,\n\tInterstateRatedPolicyIndicator AS i_InterstateRatedPolicyIndicator,\n\t-- *INF*: IIF(i_InterstateRatedPolicyIndicator='T',1,0)\n\tIFF(i_InterstateRatedPolicyIndicator = 'T', 1, 0) AS o_InterstateRatedPolicyIndicator,\n\tEstimatedAuditCode,\n\tRetrospectiveratedPolicyIndicator AS i_RetrospectiveratedPolicyIndicator,\n\t-- *INF*: IIF(i_RetrospectiveratedPolicyIndicator='T',1,0)\n\tIFF(i_RetrospectiveratedPolicyIndicator = 'T', 1, 0) AS o_RetrospectiveratedPolicyIndicator,\n\tCancelledMidTermPolicyIndicator AS i_CancelledMidTermPolicyIndicator,\n\t-- *INF*: IIF(i_CancelledMidTermPolicyIndicator='T',1,0)\n\tIFF(i_CancelledMidTermPolicyIndicator = 'T', 1, 0) AS o_CancelledMidTermPolicyIndicator,\n\tManagedCareOrganizationPolicyIndicator AS i_ManagedCareOrganizationPolicyIndicator,\n\t-- *INF*: IIF(i_ManagedCareOrganizationPolicyIndicator='T',1,0)\n\tIFF(i_ManagedCareOrganizationPolicyIndicator = 'T', 1, 0) AS o_ManagedCareOrganizationPolicyIndicator,\n\tTypeOfCoverageIdCode AS i_TypeOfCoverageIdCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfCoverageIdCode))\n\tRTRIM(LTRIM(i_TypeOfCoverageIdCode)) AS o_TypeOfCoverageIdCode,\n\tTypeOfPlan AS i_TypeOfPlan,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfPlan))\n\tRTRIM(LTRIM(i_TypeOfPlan)) AS o_TypeOfPlan,\n\tLossSubjectToDeductibleCode AS i_LossSubjectToDeductibleCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossSubjectToDeductibleCode))\n\tRTRIM(LTRIM(i_LossSubjectToDeductibleCode)) AS o_LossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode AS i_BasisOfDeductibleCalculationCode,\n\t-- *INF*: RTRIM(LTRIM(i_BasisOfDeductibleCalculationCode))\n\tRTRIM(LTRIM(i_BasisOfDeductibleCalculationCode)) AS o_BasisOfDeductibleCalculationCode,\n\tDeductibleAmountPerClaimAccident AS i_DeductibleAmountPerClaimAccident,\n\t-- *INF*: RTRIM(LTRIM(i_DeductibleAmountPerClaimAccident))\n\tRTRIM(LTRIM(i_DeductibleAmountPerClaimAccident)) AS o_DeductibleAmountPerClaimAccident,\n\tInsuredName AS i_InsuredName,\n\t-- *INF*: RTRIM(LTRIM(i_InsuredName))\n\tRTRIM(LTRIM(i_InsuredName)) AS o_InsuredName,\n\tWCSTATAddress AS i_WCSTATAddress,\n\t-- *INF*: RTRIM(LTRIM(i_WCSTATAddress))\n\tRTRIM(LTRIM(i_WCSTATAddress)) AS o_WCSTATAddress,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_PremiumMasterClassCode))\n\tRTRIM(LTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tExposure,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tManualChargedRate,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossMasterClassCode))\n\tRTRIM(LTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\tClaimLossDate,\n\tClaimNumber AS i_ClaimNumber,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimNumber))\n\tRTRIM(LTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\tClaimOccurrenceStatusCode AS i_ClaimOccurrenceStatusCode,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimOccurrenceStatusCode))\n\tRTRIM(LTRIM(i_ClaimOccurrenceStatusCode)) AS o_ClaimOccurrenceStatusCode,\n\tInjuryTypeCode AS i_InjuryTypeCode,\n\t-- *INF*: RTRIM(LTRIM(i_InjuryTypeCode))\n\tRTRIM(LTRIM(i_InjuryTypeCode)) AS o_InjuryTypeCode,\n\tCatastropheCode AS i_CatastropheCode,\n\t-- *INF*: RTRIM(LTRIM(i_CatastropheCode))\n\tRTRIM(LTRIM(i_CatastropheCode)) AS o_CatastropheCode,\n\tIncurredIndemnityAmount,\n\tIncurredMedicalAmount,\n\tTypeOfRecoveryCode AS i_TypeOfRecoveryCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfRecoveryCode))\n\tRTRIM(LTRIM(i_TypeOfRecoveryCode)) AS o_TypeOfRecoveryCode,\n\tJurisdictionStateCode AS i_JurisdictionStateCode,\n\t-- *INF*: RTRIM(LTRIM(i_JurisdictionStateCode))\n\tRTRIM(LTRIM(i_JurisdictionStateCode)) AS o_JurisdictionStateCode,\n\tBodyPartCode AS i_BodyPartCode,\n\t-- *INF*: RTRIM(LTRIM(i_BodyPartCode))\n\tRTRIM(LTRIM(i_BodyPartCode)) AS o_BodyPartCode,\n\tNatureOfInjuryCode AS i_NatureOfInjuryCode,\n\t-- *INF*: RTRIM(LTRIM(i_NatureOfInjuryCode))\n\tRTRIM(LTRIM(i_NatureOfInjuryCode)) AS o_NatureOfInjuryCode,\n\tCauseOfInjuryCode AS i_CauseOfInjuryCode,\n\t-- *INF*: RTRIM(LTRIM(i_CauseOfInjuryCode))\n\tRTRIM(LTRIM(i_CauseOfInjuryCode)) AS o_CauseOfInjuryCode,\n\tPaidIndemnityAmount,\n\tPaidMedicalAmount,\n\tDeductibleReimbursementAmount,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\tCorrectionSeqNumber,\n\tTypeOfNonStandardIdCode AS i_TypeOfNonStandardIdCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfNonStandardIdCode))\n\tRTRIM(LTRIM(i_TypeOfNonStandardIdCode)) AS o_TypeOfNonStandardIdCode,\n\tPreviousReportLevelCodeReportNumber AS i_PreviousReportLevelCodeReportNumber,\n\t-- *INF*: RTRIM(LTRIM(i_PreviousReportLevelCodeReportNumber))\n\tRTRIM(LTRIM(i_PreviousReportLevelCodeReportNumber)) AS o_PreviousReportLevelCodeReportNumber,\n\tTypeOfLoss AS i_TypeOfLoss,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfLoss))\n\tRTRIM(LTRIM(i_TypeOfLoss)) AS o_TypeOfLoss,\n\tTypeOfClaim AS i_TypeOfClaim,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfClaim))\n\tRTRIM(LTRIM(i_TypeOfClaim)) AS o_TypeOfClaim,\n\tTypeOfSettlement AS i_TypeOfSettlement,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfSettlement))\n\tRTRIM(LTRIM(i_TypeOfSettlement)) AS o_TypeOfSettlement,\n\tManagedCareOrganizationType AS i_ManagedCareOrganizationType,\n\t-- *INF*: RTRIM(LTRIM(i_ManagedCareOrganizationType))\n\tRTRIM(LTRIM(i_ManagedCareOrganizationType)) AS o_ManagedCareOrganizationType,\n\tVocationalRehabIndicator,\n\tLumpSumIndicator AS i_LumpSumIndicator,\n\t-- *INF*: RTRIM(LTRIM(i_LumpSumIndicator))\n\tRTRIM(LTRIM(i_LumpSumIndicator)) AS o_LumpSumIndicator,\n\tFraudulentClaimCode AS i_FraudulentClaimCode,\n\t-- *INF*: RTRIM(LTRIM(i_FraudulentClaimCode))\n\tRTRIM(LTRIM(i_FraudulentClaimCode)) AS o_FraudulentClaimCode,\n\tClaimantNumber AS i_ClaimantNumber,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimantNumber))\n\tRTRIM(LTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\tRateEffectiveDate,\n\tSplitPeriodCode,\n\tOccupationDescription,\n\tWeeklyWageAmount,\n\tEmployersAttorneyFees\n\tFROM SQ_WorkWCSTATExtract\n),\nEXP_Append_FileName AS (\n\tSELECT\n\t-- *INF*: TO_CHAR(SYSDATE,'YYYYMMDD')\n\tTO_CHAR(CURRENT_TIMESTAMP, 'YYYYMMDD') AS v_RunDate,\n\t'WCSTAT_' || v_RunDate || '.CSV' AS FileName,\n\tWorkWCSTATExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\to_BureauCompanyCode AS BureauCompanyCode,\n\to_PolicyKey AS PolicyKey,\n\to_StateProvinceCode AS StateProvinceCode,\n\tPolicyEffectiveDate,\n\tPolicyEndDate,\n\to_InterstateRiskId AS InterstateRiskId,\n\to_EmployeeLeasingCode AS EmployeeLeasingCode,\n\tStateRatingEffectiveDate,\n\to_FederalTaxId AS FederalTaxId,\n\to_ThreeYearFixedRatePolicyIndicator AS ThreeYearFixedRatePolicyIndicator,\n\to_MultistatePolicyIndicator AS MultistatePolicyIndicator,\n\to_InterstateRatedPolicyIndicator AS InterstateRatedPolicyIndicator,\n\tEstimatedAuditCode,\n\to_RetrospectiveratedPolicyIndicator AS RetrospectiveratedPolicyIndicator,\n\to_CancelledMidTermPolicyIndicator AS CancelledMidTermPolicyIndicator,\n\to_ManagedCareOrganizationPolicyIndicator AS ManagedCareOrganizationPolicyIndicator,\n\to_TypeOfCoverageIdCode AS TypeOfCoverageIdCode,\n\to_TypeOfPlan AS TypeOfPlan,\n\to_LossesSubjectToDeductibleCode AS LossesSubjectToDeductibleCode,\n\to_BasisOfDeductibleCalculationCode AS BasisOfDeductibleCalculationCode,\n\to_DeductibleAmountPerClaimAccident AS DeductibleAmountPerClaimAccident,\n\to_InsuredName AS InsuredName,\n\to_WCSTATAddress AS WCSTATAddress,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tExposure,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tManualChargedRate,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\tClaimLossDate,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_ClaimOccurrenceStatusCode AS ClaimOccurrenceStatusCode,\n\to_InjuryTypeCode AS InjuryTypeCode,\n\to_CatastropheCode AS CatastropheCode,\n\tIncurredIndemnityAmount,\n\tIncurredMedicalAmount,\n\to_TypeOfRecoveryCode AS TypeOfRecoveryCode,\n\to_JurisdictionStateCode AS JurisdictionStateCode,\n\to_BodyPartCode AS BodyPartCode,\n\to_NatureOfInjuryCode AS NatureOfInjuryCode,\n\to_CauseOfInjuryCode AS CauseOfInjuryCode,\n\tPaidIndemnityAmount,\n\tPaidMedicalAmount,\n\tDeductibleReimbursementAmount,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\tCorrectionSeqNumber,\n\to_TypeOfNonStandardIdCode AS TypeOfNonStandardIdCode,\n\to_PreviousReportLevelCodeReportNumber AS PreviousReportLevelCodeReportNumber,\n\to_TypeOfLoss AS TypeOfLoss,\n\to_TypeOfClaim AS TypeOfClaim,\n\to_TypeOfSettlement AS TypeOfSettlement,\n\to_ManagedCareOrganizationType AS ManagedCareOrganizationType,\n\tVocationalRehabIndicator,\n\to_LumpSumIndicator AS LumpSumIndicator,\n\to_FraudulentClaimCode AS FraudulentClaimCode,\n\tRateEffectiveDate,\n\tSplitPeriodCode,\n\tOccupationDescription,\n\tWeeklyWageAmount,\n\tEmployersAttorneyFees\n\tFROM EXP_Cleansing\n),\nSRT_MainFile AS (\n\tSELECT\n\tFileName, \n\tWorkWCSTATExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tBureauCompanyCode, \n\tPolicyKey, \n\tStateProvinceCode, \n\tPolicyEffectiveDate, \n\tPolicyEndDate, \n\tInterstateRiskId, \n\tEmployeeLeasingCode, \n\tStateRatingEffectiveDate, \n\tFederalTaxId, \n\tThreeYearFixedRatePolicyIndicator, \n\tMultistatePolicyIndicator, \n\tInterstateRatedPolicyIndicator, \n\tEstimatedAuditCode, \n\tRetrospectiveratedPolicyIndicator, \n\tCancelledMidTermPolicyIndicator, \n\tManagedCareOrganizationPolicyIndicator, \n\tTypeOfCoverageIdCode, \n\tTypeOfPlan, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode, \n\tDeductibleAmountPerClaimAccident, \n\tInsuredName, \n\tWCSTATAddress, \n\tPremiumMasterClassCode, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tExposure, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tManualChargedRate, \n\tLossMasterClassCode, \n\tClaimLossDate, \n\tClaimNumber, \n\tClaimantNumber, \n\tClaimOccurrenceStatusCode, \n\tInjuryTypeCode, \n\tCatastropheCode, \n\tIncurredIndemnityAmount, \n\tIncurredMedicalAmount, \n\tTypeOfRecoveryCode, \n\tJurisdictionStateCode, \n\tBodyPartCode, \n\tNatureOfInjuryCode, \n\tCauseOfInjuryCode, \n\tPaidIndemnityAmount, \n\tPaidMedicalAmount, \n\tDeductibleReimbursementAmount, \n\tPaidAllocatedLossAdjustmentExpenseAmount, \n\tIncurredAllocatedLossAdjustmentExpenseAmount, \n\tCorrectionSeqNumber, \n\tTypeOfNonStandardIdCode, \n\tPreviousReportLevelCodeReportNumber, \n\tTypeOfLoss, \n\tTypeOfClaim, \n\tTypeOfSettlement, \n\tManagedCareOrganizationType, \n\tVocationalRehabIndicator, \n\tLumpSumIndicator, \n\tFraudulentClaimCode, \n\tRateEffectiveDate, \n\tSplitPeriodCode, \n\tOccupationDescription, \n\tWeeklyWageAmount, \n\tEmployersAttorneyFees\n\tFROM EXP_Append_FileName\n\tORDER BY PolicyKey ASC, ClaimLossDate ASC\n),\nWCSTATFlatFile AS (\n\tINSERT INTO WCSTATFlatFile\n\t(FileName, WorkWCSTATExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyCode, PolicyKey, StateProvinceCode, PolicyEffectiveDate, PolicyEndDate, InterstateRiskId, EmployeeLeasingCode, StateRatingEffectiveDate, FederalTaxId, ThreeYearFixedRatePolicyIndicator, MultistatePolicyIndicator, InterstateRatedPolicyIndicator, EstimatedAuditCode, RetrospectiveratedPolicyIndicator, CancelledMidTermPolicyIndicator, ManagedCareOrganizationPolicyIndicator, TypeOfCoverageIdCode, TypeOfPlan, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode, DeductibleAmountPerClaimAccident, InsuredName, WCSTATAddress, PremiumMasterClassCode, ExperienceModificationFactor, ExperienceModificationEffectiveDate, RateEffectiveDate, Exposure, PremiumMasterDirectWrittenPremiumAmount, ManualChargedRate, SplitPeriodCode, LossMasterClassCode, ClaimLossDate, ClaimNumber, ClaimantNumber, ClaimOccurrenceStatusCode, InjuryTypeCode, CatastropheCode, IncurredIndemnityAmount, IncurredMedicalAmount, TypeOfRecoveryCode, JurisdictionStateCode, BodyPartCode, NatureOfInjuryCode, CauseOfInjuryCode, PaidIndemnityAmount, PaidMedicalAmount, DeductibleReimbursementAmount, PaidAllocatedLossAdjustmentExpenseAmount, IncurredAllocatedLossAdjustmentExpenseAmount, CorrectionSeqNumber, TypeOfNonStandardIdCode, PreviousReportLevelCodeReportNumber, TypeOfLoss, TypeOfClaim, TypeOfSettlement, ManagedCareOrganizationType, VocationalRehabIndicator, LumpSumIndicator, FraudulentClaimCode, OccupationDescription, WeeklyWageAmount, EmployersAttorneyFees)\n\tSELECT \n\tFILENAME, \n\tWORKWCSTATEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tBUREAUCOMPANYCODE, \n\tPOLICYKEY, \n\tSTATEPROVINCECODE, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYENDDATE, \n\tINTERSTATERISKID, \n\tEMPLOYEELEASINGCODE, \n\tSTATERATINGEFFECTIVEDATE, \n\tFEDERALTAXID, \n\tTHREEYEARFIXEDRATEPOLICYINDICATOR, \n\tMULTISTATEPOLICYINDICATOR, \n\tINTERSTATERATEDPOLICYINDICATOR, \n\tESTIMATEDAUDITCODE, \n\tRETROSPECTIVERATEDPOLICYINDICATOR, \n\tCANCELLEDMIDTERMPOLICYINDICATOR, \n\tMANAGEDCAREORGANIZATIONPOLICYINDICATOR, \n\tTYPEOFCOVERAGEIDCODE, \n\tTYPEOFPLAN, \n\tLOSSESSUBJECTTODEDUCTIBLECODE, \n\tBASISOFDEDUCTIBLECALCULATIONCODE, \n\tDEDUCTIBLEAMOUNTPERCLAIMACCIDENT, \n\tINSUREDNAME, \n\tWCSTATADDRESS, \n\tPREMIUMMASTERCLASSCODE, \n\tEXPERIENCEMODIFICATIONFACTOR, \n\tEXPERIENCEMODIFICATIONEFFECTIVEDATE, \n\tRATEEFFECTIVEDATE, \n\tEXPOSURE, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tMANUALCHARGEDRATE, \n\tSPLITPERIODCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMLOSSDATE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tCLAIMOCCURRENCESTATUSCODE, \n\tINJURYTYPECODE, \n\tCATASTROPHECODE, \n\tINCURREDINDEMNITYAMOUNT, \n\tINCURREDMEDICALAMOUNT, \n\tTYPEOFRECOVERYCODE, \n\tJURISDICTIONSTATECODE, \n\tBODYPARTCODE, \n\tNATUREOFINJURYCODE, \n\tCAUSEOFINJURYCODE, \n\tPAIDINDEMNITYAMOUNT, \n\tPAIDMEDICALAMOUNT, \n\tDEDUCTIBLEREIMBURSEMENTAMOUNT, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tINCURREDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tCORRECTIONSEQNUMBER, \n\tTYPEOFNONSTANDARDIDCODE, \n\tPREVIOUSREPORTLEVELCODEREPORTNUMBER, \n\tTYPEOFLOSS, \n\tTYPEOFCLAIM, \n\tTYPEOFSETTLEMENT, \n\tMANAGEDCAREORGANIZATIONTYPE, \n\tVOCATIONALREHABINDICATOR, \n\tLUMPSUMINDICATOR, \n\tFRAUDULENTCLAIMCODE, \n\tOCCUPATIONDESCRIPTION, \n\tWEEKLYWAGEAMOUNT, \n\tEMPLOYERSATTORNEYFEES\n\tFROM SRT_MainFile\n),\nSQ_WorkWCSTATExtractCorrectionFile AS (\n\tSELECT\n\t\tWorkWCSTATExtractId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tEDWPremiumMasterCalculationPKId,\n\t\tEDWLossMasterCalculationPKId,\n\t\tTypeBureauCode,\n\t\tPremiumMasterRunDate,\n\t\tLossMasterRunDate,\n\t\tBureauCompanyCode,\n\t\tPolicyKey,\n\t\tStateProvinceCode,\n\t\tPolicyEffectiveDate,\n\t\tPolicyEndDate,\n\t\tInterstateRiskId,\n\t\tEmployeeLeasingCode,\n\t\tStateRatingEffectiveDate,\n\t\tFederalTaxId,\n\t\tThreeYearFixedRatePolicyIndicator,\n\t\tMultistatePolicyIndicator,\n\t\tInterstateRatedPolicyIndicator,\n\t\tEstimatedAuditCode,\n\t\tRetrospectiveratedPolicyIndicator,\n\t\tCancelledMidTermPolicyIndicator,\n\t\tManagedCareOrganizationPolicyIndicator,\n\t\tTypeOfCoverageIdCode,\n\t\tTypeOfPlan,\n\t\tLossSubjectToDeductibleCode,\n\t\tBasisOfDeductibleCalculationCode,\n\t\tDeductibleAmountPerClaimAccident,\n\t\tInsuredName,\n\t\tWCSTATAddress,\n\t\tPremiumMasterClassCode,\n\t\tExperienceModificationFactor,\n\t\tExperienceModificationEffectiveDate,\n\t\tExposure,\n\t\tPremiumMasterDirectWrittenPremiumAmount,\n\t\tManualChargedRate,\n\t\tLossMasterClassCode,\n\t\tClaimLossDate,\n\t\tClaimNumber,\n\t\tClaimOccurrenceStatusCode,\n\t\tInjuryTypeCode,\n\t\tCatastropheCode,\n\t\tIncurredIndemnityAmount,\n\t\tIncurredMedicalAmount,\n\t\tCauseOfLoss,\n\t\tTypeOfRecoveryCode,\n\t\tJurisdictionStateCode,\n\t\tBodyPartCode,\n\t\tNatureOfInjuryCode,\n\t\tCauseOfInjuryCode,\n\t\tPaidIndemnityAmount,\n\t\tPaidMedicalAmount,\n\t\tDeductibleReimbursementAmount,\n\t\tPaidAllocatedLossAdjustmentExpenseAmount,\n\t\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\t\tSubjectPremiumTotal,\n\t\tStandarPremiumTotal,\n\t\tCorrectionSeqNumber,\n\t\tReplacementReportCode,\n\t\tCorrectionTypeCode,\n\t\tTypeOfNonStandardIdCode,\n\t\tPreviousReportLevelCodeReportNumber,\n\t\tUpdateTypeCode,\n\t\tTypeOfLoss,\n\t\tTypeOfClaim,\n\t\tTypeOfSettlement,\n\t\tManagedCareOrganizationType,\n\t\tVocationalRehabIndicator,\n\t\tLumpSumIndicator,\n\t\tFraudulentClaimCode,\n\t\tClaimantNumber,\n\t\tRateEffectiveDate,\n\t\tSplitPeriodCode,\n\t\tOccupationDescription,\n\t\tWeeklyWageAmount,\n\t\tEmployerAttorneyFees AS EmployersAttorneyFees\n\tFROM WorkWCSTATExtract1\n\tWHERE (WorkWCSTATExtract.EDWPremiumMasterCalculationPKId != -1 and  ((DATEDIFF(MM,WorkWCSTATExtract.PolicyEffectiveDate, \r\n\tDATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}, 0) )) > 18\r\n\t))\r\n\tAND WorkWCSTATExtract.AuditId= @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\t@{pipeline().parameters.WHERE_CLAUSE_CORRECTION_FILE}\n),\nEXP_Cleansing1 AS (\n\tSELECT\n\tWorkWCSTATExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeBureauCode))\n\tRTRIM(LTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tBureauCompanyCode AS i_BureauCompanyCode,\n\t-- *INF*: RTRIM(LTRIM(i_BureauCompanyCode))\n\tRTRIM(LTRIM(i_BureauCompanyCode)) AS o_BureauCompanyCode,\n\tPolicyKey AS i_PolicyKey,\n\t-- *INF*: RTRIM(LTRIM(i_PolicyKey))\n\tRTRIM(LTRIM(i_PolicyKey)) AS o_PolicyKey,\n\tStateProvinceCode AS i_StateProvinceCode,\n\t-- *INF*: RTRIM(LTRIM(i_StateProvinceCode))\n\tRTRIM(LTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\tPolicyEffectiveDate,\n\tPolicyEndDate,\n\tInterstateRiskId AS i_InterstateRiskId,\n\t-- *INF*: RTRIM(LTRIM(i_InterstateRiskId))\n\tRTRIM(LTRIM(i_InterstateRiskId)) AS o_InterstateRiskId,\n\tEmployeeLeasingCode AS i_EmployeeLeasingCode,\n\t-- *INF*: RTRIM(LTRIM(i_EmployeeLeasingCode))\n\tRTRIM(LTRIM(i_EmployeeLeasingCode)) AS o_EmployeeLeasingCode,\n\tStateRatingEffectiveDate,\n\tFederalTaxId AS i_FederalTaxId,\n\t-- *INF*: RTRIM(LTRIM(i_FederalTaxId))\n\tRTRIM(LTRIM(i_FederalTaxId)) AS o_FederalTaxId,\n\tThreeYearFixedRatePolicyIndicator AS i_ThreeYearFixedRatePolicyIndicator,\n\t-- *INF*: IIF(i_ThreeYearFixedRatePolicyIndicator='T',1,0)\n\tIFF(i_ThreeYearFixedRatePolicyIndicator = 'T', 1, 0) AS o_ThreeYearFixedRatePolicyIndicator,\n\tMultistatePolicyIndicator AS i_MultistatePolicyIndicator,\n\t-- *INF*: IIF(i_MultistatePolicyIndicator='T',1,0)\n\tIFF(i_MultistatePolicyIndicator = 'T', 1, 0) AS o_MultistatePolicyIndicator,\n\tInterstateRatedPolicyIndicator AS i_InterstateRatedPolicyIndicator,\n\t-- *INF*: IIF(i_InterstateRatedPolicyIndicator='T',1,0)\n\tIFF(i_InterstateRatedPolicyIndicator = 'T', 1, 0) AS o_InterstateRatedPolicyIndicator,\n\tEstimatedAuditCode,\n\tRetrospectiveratedPolicyIndicator AS i_RetrospectiveratedPolicyIndicator,\n\t-- *INF*: IIF(i_RetrospectiveratedPolicyIndicator='T',1,0)\n\tIFF(i_RetrospectiveratedPolicyIndicator = 'T', 1, 0) AS o_RetrospectiveratedPolicyIndicator,\n\tCancelledMidTermPolicyIndicator AS i_CancelledMidTermPolicyIndicator,\n\t-- *INF*: IIF(i_CancelledMidTermPolicyIndicator='T',1,0)\n\tIFF(i_CancelledMidTermPolicyIndicator = 'T', 1, 0) AS o_CancelledMidTermPolicyIndicator,\n\tManagedCareOrganizationPolicyIndicator AS i_ManagedCareOrganizationPolicyIndicator,\n\t-- *INF*: IIF(i_ManagedCareOrganizationPolicyIndicator='T',1,0)\n\tIFF(i_ManagedCareOrganizationPolicyIndicator = 'T', 1, 0) AS o_ManagedCareOrganizationPolicyIndicator,\n\tTypeOfCoverageIdCode AS i_TypeOfCoverageIdCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfCoverageIdCode))\n\tRTRIM(LTRIM(i_TypeOfCoverageIdCode)) AS o_TypeOfCoverageIdCode,\n\tTypeOfPlan AS i_TypeOfPlan,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfPlan))\n\tRTRIM(LTRIM(i_TypeOfPlan)) AS o_TypeOfPlan,\n\tLossSubjectToDeductibleCode AS i_LossSubjectToDeductibleCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossSubjectToDeductibleCode))\n\tRTRIM(LTRIM(i_LossSubjectToDeductibleCode)) AS o_LossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode AS i_BasisOfDeductibleCalculationCode,\n\t-- *INF*: RTRIM(LTRIM(i_BasisOfDeductibleCalculationCode))\n\tRTRIM(LTRIM(i_BasisOfDeductibleCalculationCode)) AS o_BasisOfDeductibleCalculationCode,\n\tDeductibleAmountPerClaimAccident AS i_DeductibleAmountPerClaimAccident,\n\t-- *INF*: RTRIM(LTRIM(i_DeductibleAmountPerClaimAccident))\n\tRTRIM(LTRIM(i_DeductibleAmountPerClaimAccident)) AS o_DeductibleAmountPerClaimAccident,\n\tInsuredName AS i_InsuredName,\n\t-- *INF*: RTRIM(LTRIM(i_InsuredName))\n\tRTRIM(LTRIM(i_InsuredName)) AS o_InsuredName,\n\tWCSTATAddress AS i_WCSTATAddress,\n\t-- *INF*: RTRIM(LTRIM(i_WCSTATAddress))\n\tRTRIM(LTRIM(i_WCSTATAddress)) AS o_WCSTATAddress,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_PremiumMasterClassCode))\n\tRTRIM(LTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tExposure,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tManualChargedRate,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\t-- *INF*: RTRIM(LTRIM(i_LossMasterClassCode))\n\tRTRIM(LTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\tClaimLossDate,\n\tClaimNumber AS i_ClaimNumber,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimNumber))\n\tRTRIM(LTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\tClaimOccurrenceStatusCode AS i_ClaimOccurrenceStatusCode,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimOccurrenceStatusCode))\n\tRTRIM(LTRIM(i_ClaimOccurrenceStatusCode)) AS o_ClaimOccurrenceStatusCode,\n\tInjuryTypeCode AS i_InjuryTypeCode,\n\t-- *INF*: RTRIM(LTRIM(i_InjuryTypeCode))\n\tRTRIM(LTRIM(i_InjuryTypeCode)) AS o_InjuryTypeCode,\n\tCatastropheCode AS i_CatastropheCode,\n\t-- *INF*: RTRIM(LTRIM(i_CatastropheCode))\n\tRTRIM(LTRIM(i_CatastropheCode)) AS o_CatastropheCode,\n\tIncurredIndemnityAmount,\n\tIncurredMedicalAmount,\n\tTypeOfRecoveryCode AS i_TypeOfRecoveryCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfRecoveryCode))\n\tRTRIM(LTRIM(i_TypeOfRecoveryCode)) AS o_TypeOfRecoveryCode,\n\tJurisdictionStateCode AS i_JurisdictionStateCode,\n\t-- *INF*: RTRIM(LTRIM(i_JurisdictionStateCode))\n\tRTRIM(LTRIM(i_JurisdictionStateCode)) AS o_JurisdictionStateCode,\n\tBodyPartCode AS i_BodyPartCode,\n\t-- *INF*: RTRIM(LTRIM(i_BodyPartCode))\n\tRTRIM(LTRIM(i_BodyPartCode)) AS o_BodyPartCode,\n\tNatureOfInjuryCode AS i_NatureOfInjuryCode,\n\t-- *INF*: RTRIM(LTRIM(i_NatureOfInjuryCode))\n\tRTRIM(LTRIM(i_NatureOfInjuryCode)) AS o_NatureOfInjuryCode,\n\tCauseOfInjuryCode AS i_CauseOfInjuryCode,\n\t-- *INF*: RTRIM(LTRIM(i_CauseOfInjuryCode))\n\tRTRIM(LTRIM(i_CauseOfInjuryCode)) AS o_CauseOfInjuryCode,\n\tPaidIndemnityAmount,\n\tPaidMedicalAmount,\n\tDeductibleReimbursementAmount,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\tCorrectionSeqNumber,\n\tTypeOfNonStandardIdCode AS i_TypeOfNonStandardIdCode,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfNonStandardIdCode))\n\tRTRIM(LTRIM(i_TypeOfNonStandardIdCode)) AS o_TypeOfNonStandardIdCode,\n\tPreviousReportLevelCodeReportNumber AS i_PreviousReportLevelCodeReportNumber,\n\t-- *INF*: RTRIM(LTRIM(i_PreviousReportLevelCodeReportNumber))\n\tRTRIM(LTRIM(i_PreviousReportLevelCodeReportNumber)) AS o_PreviousReportLevelCodeReportNumber,\n\tTypeOfLoss AS i_TypeOfLoss,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfLoss))\n\tRTRIM(LTRIM(i_TypeOfLoss)) AS o_TypeOfLoss,\n\tTypeOfClaim AS i_TypeOfClaim,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfClaim))\n\tRTRIM(LTRIM(i_TypeOfClaim)) AS o_TypeOfClaim,\n\tTypeOfSettlement AS i_TypeOfSettlement,\n\t-- *INF*: RTRIM(LTRIM(i_TypeOfSettlement))\n\tRTRIM(LTRIM(i_TypeOfSettlement)) AS o_TypeOfSettlement,\n\tManagedCareOrganizationType AS i_ManagedCareOrganizationType,\n\t-- *INF*: RTRIM(LTRIM(i_ManagedCareOrganizationType))\n\tRTRIM(LTRIM(i_ManagedCareOrganizationType)) AS o_ManagedCareOrganizationType,\n\tVocationalRehabIndicator,\n\tLumpSumIndicator AS i_LumpSumIndicator,\n\t-- *INF*: RTRIM(LTRIM(i_LumpSumIndicator))\n\tRTRIM(LTRIM(i_LumpSumIndicator)) AS o_LumpSumIndicator,\n\tFraudulentClaimCode AS i_FraudulentClaimCode,\n\t-- *INF*: RTRIM(LTRIM(i_FraudulentClaimCode))\n\tRTRIM(LTRIM(i_FraudulentClaimCode)) AS o_FraudulentClaimCode,\n\tClaimantNumber AS i_ClaimantNumber,\n\t-- *INF*: RTRIM(LTRIM(i_ClaimantNumber))\n\tRTRIM(LTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\tRateEffectiveDate,\n\tSplitPeriodCode,\n\tOccupationDescription,\n\tWeeklyWageAmount,\n\tEmployersAttorneyFees\n\tFROM SQ_WorkWCSTATExtractCorrectionFile\n),\nEXP_Append_FileName1 AS (\n\tSELECT\n\t-- *INF*: TO_CHAR(SYSDATE,'YYYYMMDD')\n\tTO_CHAR(CURRENT_TIMESTAMP, 'YYYYMMDD') AS v_RunDate,\n\t'WCSTATCorrectionFile_' || v_RunDate || '.CSV' AS FileName,\n\tWorkWCSTATExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\to_BureauCompanyCode AS BureauCompanyCode,\n\to_PolicyKey AS PolicyKey,\n\to_StateProvinceCode AS StateProvinceCode,\n\tPolicyEffectiveDate,\n\tPolicyEndDate,\n\to_InterstateRiskId AS InterstateRiskId,\n\to_EmployeeLeasingCode AS EmployeeLeasingCode,\n\tStateRatingEffectiveDate,\n\to_FederalTaxId AS FederalTaxId,\n\to_ThreeYearFixedRatePolicyIndicator AS ThreeYearFixedRatePolicyIndicator,\n\to_MultistatePolicyIndicator AS MultistatePolicyIndicator,\n\to_InterstateRatedPolicyIndicator AS InterstateRatedPolicyIndicator,\n\tEstimatedAuditCode,\n\to_RetrospectiveratedPolicyIndicator AS RetrospectiveratedPolicyIndicator,\n\to_CancelledMidTermPolicyIndicator AS CancelledMidTermPolicyIndicator,\n\to_ManagedCareOrganizationPolicyIndicator AS ManagedCareOrganizationPolicyIndicator,\n\to_TypeOfCoverageIdCode AS TypeOfCoverageIdCode,\n\to_TypeOfPlan AS TypeOfPlan,\n\to_LossesSubjectToDeductibleCode AS LossesSubjectToDeductibleCode,\n\to_BasisOfDeductibleCalculationCode AS BasisOfDeductibleCalculationCode,\n\to_DeductibleAmountPerClaimAccident AS DeductibleAmountPerClaimAccident,\n\to_InsuredName AS InsuredName,\n\to_WCSTATAddress AS WCSTATAddress,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tExposure,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tManualChargedRate,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\tClaimLossDate,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_ClaimOccurrenceStatusCode AS ClaimOccurrenceStatusCode,\n\to_InjuryTypeCode AS InjuryTypeCode,\n\to_CatastropheCode AS CatastropheCode,\n\tIncurredIndemnityAmount,\n\tIncurredMedicalAmount,\n\to_TypeOfRecoveryCode AS TypeOfRecoveryCode,\n\to_JurisdictionStateCode AS JurisdictionStateCode,\n\to_BodyPartCode AS BodyPartCode,\n\to_NatureOfInjuryCode AS NatureOfInjuryCode,\n\to_CauseOfInjuryCode AS CauseOfInjuryCode,\n\tPaidIndemnityAmount,\n\tPaidMedicalAmount,\n\tDeductibleReimbursementAmount,\n\tPaidAllocatedLossAdjustmentExpenseAmount,\n\tIncurredAllocatedLossAdjustmentExpenseAmount,\n\tCorrectionSeqNumber,\n\to_TypeOfNonStandardIdCode AS TypeOfNonStandardIdCode,\n\to_PreviousReportLevelCodeReportNumber AS PreviousReportLevelCodeReportNumber,\n\to_TypeOfLoss AS TypeOfLoss,\n\to_TypeOfClaim AS TypeOfClaim,\n\to_TypeOfSettlement AS TypeOfSettlement,\n\to_ManagedCareOrganizationType AS ManagedCareOrganizationType,\n\tVocationalRehabIndicator,\n\to_LumpSumIndicator AS LumpSumIndicator,\n\to_FraudulentClaimCode AS FraudulentClaimCode,\n\tRateEffectiveDate,\n\tSplitPeriodCode,\n\tOccupationDescription,\n\tWeeklyWageAmount,\n\tEmployersAttorneyFees\n\tFROM EXP_Cleansing1\n),\nSRT_CorrectionFile AS (\n\tSELECT\n\tFileName, \n\tWorkWCSTATExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tBureauCompanyCode, \n\tPolicyKey, \n\tStateProvinceCode, \n\tPolicyEffectiveDate, \n\tPolicyEndDate, \n\tInterstateRiskId, \n\tEmployeeLeasingCode, \n\tStateRatingEffectiveDate, \n\tFederalTaxId, \n\tThreeYearFixedRatePolicyIndicator, \n\tMultistatePolicyIndicator, \n\tInterstateRatedPolicyIndicator, \n\tEstimatedAuditCode, \n\tRetrospectiveratedPolicyIndicator, \n\tCancelledMidTermPolicyIndicator, \n\tManagedCareOrganizationPolicyIndicator, \n\tTypeOfCoverageIdCode, \n\tTypeOfPlan, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode, \n\tDeductibleAmountPerClaimAccident, \n\tInsuredName, \n\tWCSTATAddress, \n\tPremiumMasterClassCode, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tExposure, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tManualChargedRate, \n\tLossMasterClassCode, \n\tClaimLossDate, \n\tClaimNumber, \n\tClaimantNumber, \n\tClaimOccurrenceStatusCode, \n\tInjuryTypeCode, \n\tCatastropheCode, \n\tIncurredIndemnityAmount, \n\tIncurredMedicalAmount, \n\tTypeOfRecoveryCode, \n\tJurisdictionStateCode, \n\tBodyPartCode, \n\tNatureOfInjuryCode, \n\tCauseOfInjuryCode, \n\tPaidIndemnityAmount, \n\tPaidMedicalAmount, \n\tDeductibleReimbursementAmount, \n\tPaidAllocatedLossAdjustmentExpenseAmount, \n\tIncurredAllocatedLossAdjustmentExpenseAmount, \n\tCorrectionSeqNumber, \n\tTypeOfNonStandardIdCode, \n\tPreviousReportLevelCodeReportNumber, \n\tTypeOfLoss, \n\tTypeOfClaim, \n\tTypeOfSettlement, \n\tManagedCareOrganizationType, \n\tVocationalRehabIndicator, \n\tLumpSumIndicator, \n\tFraudulentClaimCode, \n\tRateEffectiveDate, \n\tSplitPeriodCode, \n\tOccupationDescription, \n\tWeeklyWageAmount, \n\tEmployersAttorneyFees\n\tFROM EXP_Append_FileName1\n\tORDER BY PolicyKey ASC, ClaimLossDate ASC\n),\nWCSTATCorrectionFlatFile AS (\n\tINSERT INTO WCSTATFlatFile\n\t(FileName, WorkWCSTATExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyCode, PolicyKey, StateProvinceCode, PolicyEffectiveDate, PolicyEndDate, InterstateRiskId, EmployeeLeasingCode, StateRatingEffectiveDate, FederalTaxId, ThreeYearFixedRatePolicyIndicator, MultistatePolicyIndicator, InterstateRatedPolicyIndicator, EstimatedAuditCode, RetrospectiveratedPolicyIndicator, CancelledMidTermPolicyIndicator, ManagedCareOrganizationPolicyIndicator, TypeOfCoverageIdCode, TypeOfPlan, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode, DeductibleAmountPerClaimAccident, InsuredName, WCSTATAddress, PremiumMasterClassCode, ExperienceModificationFactor, ExperienceModificationEffectiveDate, RateEffectiveDate, Exposure, PremiumMasterDirectWrittenPremiumAmount, ManualChargedRate, SplitPeriodCode, LossMasterClassCode, ClaimLossDate, ClaimNumber, ClaimantNumber, ClaimOccurrenceStatusCode, InjuryTypeCode, CatastropheCode, IncurredIndemnityAmount, IncurredMedicalAmount, TypeOfRecoveryCode, JurisdictionStateCode, BodyPartCode, NatureOfInjuryCode, CauseOfInjuryCode, PaidIndemnityAmount, PaidMedicalAmount, DeductibleReimbursementAmount, PaidAllocatedLossAdjustmentExpenseAmount, IncurredAllocatedLossAdjustmentExpenseAmount, CorrectionSeqNumber, TypeOfNonStandardIdCode, PreviousReportLevelCodeReportNumber, TypeOfLoss, TypeOfClaim, TypeOfSettlement, ManagedCareOrganizationType, VocationalRehabIndicator, LumpSumIndicator, FraudulentClaimCode, OccupationDescription, WeeklyWageAmount, EmployersAttorneyFees)\n\tSELECT \n\tFILENAME, \n\tWORKWCSTATEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tBUREAUCOMPANYCODE, \n\tPOLICYKEY, \n\tSTATEPROVINCECODE, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYENDDATE, \n\tINTERSTATERISKID, \n\tEMPLOYEELEASINGCODE, \n\tSTATERATINGEFFECTIVEDATE, \n\tFEDERALTAXID, \n\tTHREEYEARFIXEDRATEPOLICYINDICATOR, \n\tMULTISTATEPOLICYINDICATOR, \n\tINTERSTATERATEDPOLICYINDICATOR, \n\tESTIMATEDAUDITCODE, \n\tRETROSPECTIVERATEDPOLICYINDICATOR, \n\tCANCELLEDMIDTERMPOLICYINDICATOR, \n\tMANAGEDCAREORGANIZATIONPOLICYINDICATOR, \n\tTYPEOFCOVERAGEIDCODE, \n\tTYPEOFPLAN, \n\tLOSSESSUBJECTTODEDUCTIBLECODE, \n\tBASISOFDEDUCTIBLECALCULATIONCODE, \n\tDEDUCTIBLEAMOUNTPERCLAIMACCIDENT, \n\tINSUREDNAME, \n\tWCSTATADDRESS, \n\tPREMIUMMASTERCLASSCODE, \n\tEXPERIENCEMODIFICATIONFACTOR, \n\tEXPERIENCEMODIFICATIONEFFECTIVEDATE, \n\tRATEEFFECTIVEDATE, \n\tEXPOSURE, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tMANUALCHARGEDRATE, \n\tSPLITPERIODCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMLOSSDATE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tCLAIMOCCURRENCESTATUSCODE, \n\tINJURYTYPECODE, \n\tCATASTROPHECODE, \n\tINCURREDINDEMNITYAMOUNT, \n\tINCURREDMEDICALAMOUNT, \n\tTYPEOFRECOVERYCODE, \n\tJURISDICTIONSTATECODE, \n\tBODYPARTCODE, \n\tNATUREOFINJURYCODE, \n\tCAUSEOFINJURYCODE, \n\tPAIDINDEMNITYAMOUNT, \n\tPAIDMEDICALAMOUNT, \n\tDEDUCTIBLEREIMBURSEMENTAMOUNT, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tINCURREDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tCORRECTIONSEQNUMBER, \n\tTYPEOFNONSTANDARDIDCODE, \n\tPREVIOUSREPORTLEVELCODEREPORTNUMBER, \n\tTYPEOFLOSS, \n\tTYPEOFCLAIM, \n\tTYPEOFSETTLEMENT, \n\tMANAGEDCAREORGANIZATIONTYPE, \n\tVOCATIONALREHABINDICATOR, \n\tLUMPSUMINDICATOR, \n\tFRAUDULENTCLAIMCODE, \n\tOCCUPATIONDESCRIPTION, \n\tWEEKLYWAGEAMOUNT, \n\tEMPLOYERSATTORNEYFEES\n\tFROM SRT_CorrectionFile\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "NUM_OF_MONTHS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_CORRECTION_FILE": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}