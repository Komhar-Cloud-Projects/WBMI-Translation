{
    "name": "s_m_CLM_DM_LOAD_Claim_Case_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Case_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Claim_Suit_status_code AS (\n\tSELECT\n\tsuit_status_code_descript,\n\tsuit_status_code\n\tFROM (\n\t\tSELECT \r\n\t\tsup_claim_suit_status_code.suit_status_code_descript as suit_status_code_descript, \r\n\t\tsup_claim_suit_status_code.suit_status_code as suit_status_code \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_suit_status_code\r\n\t\tWHERE crrnt_snpsht_flag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY suit_status_code ORDER BY suit_status_code_descript) = 1\n),\nLKP_prim_litigation_handler_role_code AS (\n\tSELECT\n\tprim_litigation_role_code_descript,\n\tprim_litigation_role_code\n\tFROM (\n\t\tSELECT \r\n\t\tsup_claim_primary_litigation_role_code.prim_litigation_role_code_descript as prim_litigation_role_code_descript, sup_claim_primary_litigation_role_code.prim_litigation_role_code as prim_litigation_role_code \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_claim_primary_litigation_role_code\r\n\t\tWHERE crrnt_snpsht_flag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY prim_litigation_role_code ORDER BY prim_litigation_role_code_descript) = 1\n),\nSQ_claim_case AS (\n\tSELECT DISTINCT cca.claim_case_id,\r\n\t                cca.claim_case_ak_id,\r\n\t                cca.claim_case_key,\r\n\t                cca.claim_case_name,\r\n\t                cca.claim_case_num,\r\n\t                cca.suit_county,\r\n\t                cca.suit_state,\r\n\t                cca.trial_date,\r\n\t                cca.first_notice_law_suit_ind,\r\n\t                cca.declaratory_action_ind,\r\n\t                cca.suit_status_code,\r\n\t                cca.suit_denial_date,\r\n\t                cca.prim_litigation_handler_role_code,\r\n\t                cca.suit_open_date,\r\n\t                cca.suit_close_date,\r\n\t                cca.suit_how_claim_closed,\r\n\t                cca.reins_reported_ind,\r\n\t                cca.commercl_umb_reserve,\r\n\t                cca.suit_pay_amt,\r\n\t                cca.arbitration_open_date,\r\n\t                cca.arbitration_close_date,\r\n\t                distinct_eff_from_dates.eff_from_date AS eff_from_date,\r\n\t                cca.demand_at_initial_litigation,\r\n\t                prim_lit.claim_party_id               AS prim_lit_pk_id,\r\n\t                prim_lit.claim_party_ak_id            AS prim_lit_ak_id,\r\n\t                prim_lit.claim_party_full_name        AS prim_lit_full_name,\r\n\t                prim_lit.claim_party_first_name       AS prim_lit_first_name,\r\n\t                prim_lit.claim_party_last_name        AS prim_lit_last_name,\r\n\t                prim_lit.claim_party_mid_name         AS prim_lit_mid_name,\r\n\t                prim_lit.claim_party_name_prfx        AS prim_lit_name_prfx,\r\n\t                prim_lit.claim_party_name_sfx         AS prim_lit_name_sfx,\r\n\t                prim_lit.claim_party_addr             AS prim_lit_addr,\r\n\t                prim_lit.claim_party_city             AS prim_lit_city,\r\n\t                prim_lit.claim_party_county           AS prim_lit_county,\r\n\t                prim_lit.claim_party_state            AS prim_lit_state,\r\n\t                prim_lit.claim_party_zip              AS prim_lit_zip,\r\n\t                prim_lit.addr_type                    AS prim_adr_type,\r\n\t                defd.claim_party_id                   AS def_claim_party_pk_id,\r\n\t                defd.claim_party_ak_id                AS def_claim_party_ak_id,\r\n\t                defd.claim_party_full_name            AS def_full_name,\r\n\t                defd.claim_party_first_name           AS def_first_name,\r\n\t                defd.claim_party_last_name            AS def_last_name,\r\n\t                defd.claim_party_mid_name             AS def_mid_name,\r\n\t                defd.claim_party_name_prfx            AS def_name_prfx,\r\n\t                defd.claim_party_name_sfx             AS def_name_sfx,\r\n\t                code.claim_party_id                   AS code_claim_party_pk_id,\r\n\t                code.claim_party_ak_id                AS code_claim_party_ak_id,\r\n\t                code.claim_party_full_name            AS code_full_name,\r\n\t                code.claim_party_first_name           AS code_first_name,\r\n\t                code.claim_party_last_name            AS code_last_name,\r\n\t                code.claim_party_mid_name             AS code_mid_name,\r\n\t                code.claim_party_name_prfx            AS code_name_prfx,\r\n\t                code.claim_party_name_sfx             AS code_name_sfx,\r\n\t                wppp.claim_party_id                   AS wppp_claim_party_pk_id,\r\n\t                wppp.claim_party_ak_id                AS wppp_claim_party_ak_id,\r\n\t                wppp.claim_party_full_name            AS wppp_full_name,\r\n\t                wppp.claim_party_first_name           AS wppp_first_name,\r\n\t                wppp.claim_party_last_name            AS wppp_last_name,\r\n\t                wppp.claim_party_mid_name             AS wppp_mid_name,\r\n\t                wppp.claim_party_name_prfx            AS wppp_name_prfx,\r\n\t                wppp.claim_party_name_sfx             AS wppp_name_sfx,\r\n\t                plat.claim_party_id                   AS plat_claim_party_pk_id,\r\n\t                plat.claim_party_ak_id                AS plat_claim_party_ak_id,\r\n\t                plat.claim_party_full_name            AS plat_full_name,\r\n\t                plat.claim_party_first_name           AS plat_first_name,\r\n\t                plat.claim_party_last_name            AS plat_last_name,\r\n\t                plat.claim_party_mid_name             AS plat_mid_name,\r\n\t                plat.claim_party_name_prfx            AS plat_name_prfx,\r\n\t                plat.claim_party_name_sfx             AS plat_name_sfx,\r\n\t                iplt.claim_party_id                   AS iplt_claim_party_pk_id,\r\n\t                iplt.claim_party_ak_id                AS iplt_claim_party_ak_id,\r\n\t                iplt.claim_party_full_name            AS iplt_full_name,\r\n\t                iplt.claim_party_first_name           AS iplt_first_name,\r\n\t                iplt.claim_party_last_name            AS iplt_last_name,\r\n\t                iplt.claim_party_mid_name             AS iplt_mid_name,\r\n\t                iplt.claim_party_name_prfx            AS iplt_name_prfx,\r\n\t                iplt.claim_party_name_sfx             AS iplt_name_sfx\r\n\tFROM   (SELECT 'DEFD'                               AS defd_role_code,\r\n\t               'CODE'                               AS code_role_code,\r\n\t               'WPPP'                               AS wppp_role_code,\r\n\t               'PLAT'                               AS plat_role_code,\r\n\t               'IPLT'                               AS iplt_role_code,\r\n\t               defd.claim_party_relation_from_ak_id AS defd_claim_party_ak_id,\r\n\t               code.claim_party_relation_from_ak_id AS code_claim_party_ak_id,\r\n\t               wppp.claim_party_relation_from_ak_id AS wppp_claim_party_ak_id,\r\n\t               plat.claim_party_relation_from_ak_id AS plat_claim_party_ak_id,\r\n\t               iplt.claim_party_relation_from_ak_id AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               a.eff_from_date                      AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'DEFD'\r\n\t                                       AND source_sys_id = 'EXCEED') defd\r\n\t                 ON a.claim_party_occurrence_ak_id = defd.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'CODE'\r\n\t                                       AND source_sys_id = 'EXCEED') code\r\n\t                 ON a.claim_party_occurrence_ak_id = code.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'WPPP'\r\n\t                                       AND source_sys_id = 'EXCEED') wppp\r\n\t                 ON a.claim_party_occurrence_ak_id = wppp.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'PLAT'\r\n\t                                       AND source_sys_id = 'EXCEED') plat\r\n\t                 ON a.claim_party_occurrence_ak_id = plat.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'IPLT'\r\n\t                                       AND source_sys_id = 'EXCEED') iplt\r\n\t                 ON a.claim_party_occurrence_ak_id = iplt.claim_party_occurrence_ak_id\r\n\t--- Change to created_date 1 start\r\n\t        WHERE  a.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT 'DEFD'                               AS defd_role_code,\r\n\t               'CODE'                               AS code_role_code,\r\n\t               'WPPP'                               AS wppp_role_code,\r\n\t               'PLAT'                               AS plat_role_code,\r\n\t               'IPLT'                               AS iplt_role_code,\r\n\t               defd.claim_party_relation_from_ak_id AS defd_claim_party_ak_id,\r\n\t               code.claim_party_relation_from_ak_id AS code_claim_party_ak_id,\r\n\t               wppp.claim_party_relation_from_ak_id AS wppp_claim_party_ak_id,\r\n\t               plat.claim_party_relation_from_ak_id AS plat_claim_party_ak_id,\r\n\t               iplt.claim_party_relation_from_ak_id AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               c.eff_from_date                      AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t               ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'DEFD'\r\n\t                                       AND source_sys_id = 'EXCEED') defd\r\n\t                 ON a.claim_party_occurrence_ak_id = defd.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'CODE'\r\n\t                                       AND source_sys_id = 'EXCEED') code\r\n\t                 ON a.claim_party_occurrence_ak_id = code.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'WPPP'\r\n\t                                       AND source_sys_id = 'EXCEED') wppp\r\n\t                 ON a.claim_party_occurrence_ak_id = wppp.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'PLAT'\r\n\t                                       AND source_sys_id = 'EXCEED') plat\r\n\t                 ON a.claim_party_occurrence_ak_id = plat.claim_party_occurrence_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'IPLT'\r\n\t                                       AND source_sys_id = 'EXCEED') iplt\r\n\t                 ON a.claim_party_occurrence_ak_id = iplt.claim_party_occurrence_ak_id\r\n\t--- Change to created_date 2 start\r\n\t        WHERE  c.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT 'DEFD'                               AS defd_role_code,\r\n\t               NULL                                 AS code_role_code,\r\n\t               NULL                                 AS wppp_role_code,\r\n\t               NULL                                 AS plat_role_code,\r\n\t               NULL                                 AS iplt_role_code,\r\n\t               defd.claim_party_relation_from_ak_id AS defd_claim_party_ak_id,\r\n\t               -1                                   AS code_claim_party_ak_id,\r\n\t               -1                                   AS wppp_claim_party_ak_id,\r\n\t               -1                                   AS plat_claim_party_ak_id,\r\n\t               -1                                   AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               defd.eff_from_date                   AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'DEFD'\r\n\t                                       AND source_sys_id = 'EXCEED') defd\r\n\t                 ON a.claim_party_occurrence_ak_id = defd.claim_party_occurrence_ak_id\r\n\t--- Change to created_date 3 start\r\n\t         WHERE  defd.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT NULL                                 AS defd_role_code,\r\n\t               'CODE'                               AS code_role_code,\r\n\t               NULL                                 AS wppp_role_code,\r\n\t               NULL                                 AS plat_role_code,\r\n\t               NULL                                 AS iplt_role_code,\r\n\t               -1                                   AS defd_claim_party_ak_id,\r\n\t               code.claim_party_relation_from_ak_id AS code_claim_party_ak_id,\r\n\t               -1                                   AS wppp_claim_party_ak_id,\r\n\t               -1                                   AS plat_claim_party_ak_id,\r\n\t               -1                                   AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               code.eff_from_date                   AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'CODE'\r\n\t                                       AND source_sys_id = 'EXCEED') code\r\n\t                 ON a.claim_party_occurrence_ak_id = code.claim_party_occurrence_ak_id\r\n\t--- Change to created_date 3 start      \r\n\t        WHERE  code.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT NULL                                 AS defd_role_code,\r\n\t               NULL                                 AS code_role_code,\r\n\t               'WPPP'                               AS wppp_role_code,\r\n\t               NULL                                 AS plat_role_code,\r\n\t               NULL                                 AS iplt_role_code,\r\n\t               -1                                   AS defd_claim_party_ak_id,\r\n\t               -1                                   AS code_claim_party_ak_id,\r\n\t               wppp.claim_party_relation_from_ak_id AS wppp_claim_party_ak_id,\r\n\t               -1                                   AS plat_claim_party_ak_id,\r\n\t               -1                                   AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               wppp.eff_from_date                   AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'WPPP'\r\n\t                                       AND source_sys_id = 'EXCEED') wppp\r\n\t                 ON a.claim_party_occurrence_ak_id = wppp.claim_party_occurrence_ak_id\r\n\t        --- Change to created_date 4 start      \r\n\t        WHERE  wppp.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT NULL                                 AS defd_role_code,\r\n\t               NULL                                 AS plat_role_code,\r\n\t               NULL                                 AS wppp_role_code,\r\n\t               'PLAT'                               AS code_role_code,\r\n\t               NULL                                 AS iplt_role_code,\r\n\t               -1                                   AS defd_claim_party_ak_id,\r\n\t               -1                                   AS code_claim_party_ak_id,\r\n\t               -1                                   AS wppp_claim_party_ak_id,\r\n\t               plat.claim_party_relation_from_ak_id AS plat_claim_party_ak_id,\r\n\t               -1                                   AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               plat.eff_from_date                   AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'PLAT'\r\n\t                                       AND source_sys_id = 'EXCEED') plat\r\n\t                 ON a.claim_party_occurrence_ak_id = plat.claim_party_occurrence_ak_id\r\n\t         --- Change to created_date 5 start \r\n\t        WHERE  plat.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT NULL                                 AS defd_role_code,\r\n\t               NULL                                 AS code_role_code,\r\n\t               NULL                                 AS wppp_role_code,\r\n\t               NULL                                 AS plat_role_code,\r\n\t               'IPLT'                               AS iplt_role_code,\r\n\t               -1                                   AS defd_claim_party_ak_id,\r\n\t               -1                                   AS code_claim_party_ak_id,\r\n\t               -1                                   AS wppp_claim_party_ak_id,\r\n\t               -1                                   AS plat_claim_party_ak_id,\r\n\t               iplt.claim_party_relation_from_ak_id AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id                   AS claim_case_ak_id,\r\n\t               iplt.eff_from_date                   AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id      AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join claim_party_occurrence a\r\n\t                 ON a.claim_case_ak_id = c.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_relation\r\n\t                                WHERE  claim_party_relation_role_code = 'IPLT'\r\n\t                                       AND source_sys_id = 'EXCEED') iplt\r\n\t                 ON a.claim_party_occurrence_ak_id = iplt.claim_party_occurrence_ak_id\r\n\t--- Change to created_date 6 start        \r\n\t        WHERE  iplt.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t               AND a.claim_party_role_code = 'CLMT'\r\n\t               AND a.source_sys_id = 'EXCEED'\r\n\t        UNION\r\n\t        SELECT 'DEFD'                          AS defd_role_code,\r\n\t               NULL                            AS code_role_code,\r\n\t               NULL                            AS wppp_role_code,\r\n\t               NULL                            AS plat_role_code,\r\n\t               NULL                            AS iplt_role_code,\r\n\t               defd.claim_party_ak_id          AS defd_claim_party_ak_id,\r\n\t               -1                              AS code_claim_party_ak_id,\r\n\t               -1                              AS wppp_claim_party_ak_id,\r\n\t               -1                              AS plat_claim_party_ak_id,\r\n\t               -1                              AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               defd.eff_from_date              AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'DEFD'\r\n\t                       AND source_sys_id = 'PMS') defd\r\n\t            ON c.claim_case_ak_id = defd.claim_case_ak_id\r\n\t--- Change to created_date 7 start        \r\n\t        WHERE  defd.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t        UNION\r\n\t        SELECT NULL                            AS defd_role_code,\r\n\t               'CODE'                          AS code_role_code,\r\n\t               NULL                            AS wppp_role_code,\r\n\t               NULL                            AS plat_role_code,\r\n\t               NULL                            AS iplt_role_code,\r\n\t               -1                              AS defd_claim_party_ak_id,\r\n\t               code.claim_party_ak_id          AS code_claim_party_ak_id,\r\n\t               -1                              AS wppp_claim_party_ak_id,\r\n\t               -1                              AS plat_claim_party_ak_id,\r\n\t               -1                              AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               code.eff_from_date              AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join  (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'CODE'\r\n\t                       AND source_sys_id = 'PMS') code\r\n\t              ON c.claim_case_ak_id = code.claim_case_ak_id\r\n\t--- Change to created_date 8 start                \r\n\t        WHERE  code.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t        UNION\r\n\t        SELECT NULL                            AS defd_role_code,\r\n\t               NULL                            AS code_role_code,\r\n\t               'WPPP'                          AS wppp_role_code,\r\n\t               NULL                            AS plat_role_code,\r\n\t               NULL                            AS iplt_role_code,\r\n\t               -1                              AS defd_claim_party_ak_id,\r\n\t               -1                              AS code_claim_party_ak_id,\r\n\t               wppp.claim_party_ak_id          AS wppp_claim_party_ak_id,\r\n\t               -1                              AS plat_claim_party_ak_id,\r\n\t               -1                              AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               wppp.eff_from_date              AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join  (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'WPPP'\r\n\t                       AND source_sys_id = 'PMS') wppp\r\n\t           ON c.claim_case_ak_id = wppp.claim_case_ak_id\r\n\t--- Change to created_date 9 start     \r\n\t        WHERE  wppp.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t        UNION\r\n\t        SELECT NULL                            AS defd_role_code,\r\n\t               NULL                            AS code_role_code,\r\n\t               NULL                            AS wppp_role_code,\r\n\t               'PLAT'                          AS plat_role_code,\r\n\t               NULL                            AS iplt_role_code,\r\n\t               -1                              AS defd_claim_party_ak_id,\r\n\t               -1                              AS code_claim_party_ak_id,\r\n\t               -1                              AS wppp_claim_party_ak_id,\r\n\t               plat.claim_party_ak_id          AS plat_claim_party_ak_id,\r\n\t               -1                              AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               plat.eff_from_date              AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM  claim_case c left outer join   (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'PLAT'\r\n\t                       AND source_sys_id = 'PMS') plat\r\n\t         ON c.claim_case_ak_id = plat.claim_case_ak_id\r\n\t--- Change to created_date 10 start          \r\n\t        WHERE  plat.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t        UNION\r\n\t        SELECT NULL                            AS defd_role_code,\r\n\t               NULL                            AS code_role_code,\r\n\t               NULL                            AS wppp_role_code,\r\n\t               NULL                            AS plat_role_code,\r\n\t               'IPLT'                          AS iplt_role_code,\r\n\t               -1                              AS defd_claim_party_ak_id,\r\n\t               -1                              AS code_claim_party_ak_id,\r\n\t               -1                              AS wppp_claim_party_ak_id,\r\n\t               -1                              AS plat_claim_party_ak_id,\r\n\t               iplt.claim_party_ak_id          AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               iplt.eff_from_date              AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM   claim_case c left outer join  (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'IPLT'\r\n\t                       AND source_sys_id = 'PMS') iplt\r\n\t        ON c.claim_case_ak_id = iplt.claim_case_ak_id\r\n\t--- Change to created_date 11 start                 \r\n\t        WHERE  iplt.created_date >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t        UNION\r\n\t        SELECT 'DEFD'                          AS defd_role_code,\r\n\t               'CODE'                          AS code_role_code,\r\n\t               'WPPP'                          AS wppp_role_code,\r\n\t               'PLAT'                          AS plat_role_code,\r\n\t               'IPLT'                          AS iplt_role_code,\r\n\t               defd.claim_party_ak_id          AS defd_claim_party_ak_id,\r\n\t               code.claim_party_ak_id          AS code_claim_party_ak_id,\r\n\t               wppp.claim_party_ak_id          AS wppp_claim_party_ak_id,\r\n\t               plat.claim_party_ak_id          AS plat_claim_party_ak_id,\r\n\t               iplt.claim_party_ak_id          AS iplt_claim_party_ak_id,\r\n\t               c.claim_case_ak_id              AS claim_case_ak_id,\r\n\t               c.eff_from_date                 AS eff_from_date,\r\n\t               c.prim_litigation_handler_ak_id AS prim_litigation_handler_ak_id\r\n\t        FROM  claim_case c left outer join  (SELECT *\r\n\t                FROM   claim_party_occurrence\r\n\t                WHERE  claim_party_role_code = 'DEFD'\r\n\t                       AND source_sys_id = 'PMS') defd\r\n\t              ON c.claim_case_ak_id = defd.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_occurrence\r\n\t                                WHERE  claim_party_role_code = 'CODE'\r\n\t                                       AND source_sys_id = 'PMS') code\r\n\t                 ON c.claim_case_ak_id = code.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_occurrence\r\n\t                                WHERE  claim_party_role_code = 'WPPP'\r\n\t                                       AND source_sys_id = 'PMS') wppp\r\n\t                 ON c.claim_case_ak_id = wppp.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_occurrence\r\n\t                                WHERE  claim_party_role_code = 'PLAT'\r\n\t                                       AND source_sys_id = 'PMS') plat\r\n\t                 ON c.claim_case_ak_id = plat.claim_case_ak_id\r\n\t               LEFT OUTER JOIN (SELECT *\r\n\t                                FROM   claim_party_occurrence\r\n\t                                WHERE  claim_party_role_code = 'IPLT'\r\n\t                                       AND source_sys_id = 'PMS') iplt\r\n\t                 ON c.claim_case_ak_id = iplt.claim_case_ak_id\r\n\t--- Change to created_date - 12 start                \r\n\t        \r\n\t        WHERE  c.created_date >= '@{pipeline().parameters.SELECTION_START_TS}') AS distinct_eff_from_dates\r\n\t       LEFT OUTER JOIN claim_party defd\r\n\t         ON distinct_eff_from_dates.defd_claim_party_ak_id = defd.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN defd.eff_from_date AND defd.eff_to_date\r\n\t       LEFT OUTER JOIN claim_party code\r\n\t         ON distinct_eff_from_dates.code_claim_party_ak_id = code.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN code.eff_from_date AND code.eff_to_date\r\n\t       LEFT OUTER JOIN claim_party wppp\r\n\t         ON distinct_eff_from_dates.wppp_claim_party_ak_id = wppp.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN wppp.eff_from_date AND wppp.eff_to_date\r\n\t       LEFT OUTER JOIN claim_party plat\r\n\t         ON distinct_eff_from_dates.plat_claim_party_ak_id = plat.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN plat.eff_from_date AND plat.eff_to_date\r\n\t       LEFT OUTER JOIN claim_party iplt\r\n\t         ON distinct_eff_from_dates.iplt_claim_party_ak_id = iplt.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN iplt.eff_from_date AND iplt.eff_to_date\r\n\t       LEFT OUTER JOIN claim_case cca\r\n\t         ON distinct_eff_from_dates.claim_case_ak_id = cca.claim_case_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN cca.eff_from_date AND cca.eff_to_date\r\n\t       LEFT OUTER JOIN claim_party prim_lit\r\n\t         ON distinct_eff_from_dates.prim_litigation_handler_ak_id = prim_lit.claim_party_ak_id\r\n\t            AND distinct_eff_from_dates.eff_from_date BETWEEN prim_lit.eff_from_date AND prim_lit.eff_to_date\r\n\t--where cca.claim_case_ak_id  = 1263017\n),\nEXP_Default AS (\n\tSELECT\n\tclaim_case_id,\n\tclaim_case_ak_id,\n\tclaim_case_key,\n\tclaim_case_name,\n\tclaim_case_num,\n\tsuit_county,\n\tsuit_state,\n\ttrial_date,\n\tfirst_notice_law_suit_ind,\n\tdeclaratory_action_ind,\n\tsuit_status_code,\n\t-- *INF*: iif(isnull(suit_status_code)\r\n\t-- ,'N/A'\r\n\t-- ,suit_status_code)\n\tIFF(suit_status_code IS NULL, 'N/A', suit_status_code) AS v_suit_status_code,\n\tv_suit_status_code AS suit_status_code_out,\n\t-- *INF*: iif(isnull(:LKP.LKP_CLAIM_SUIT_STATUS_CODE(v_suit_status_code))\r\n\t-- ,'N/A'\r\n\t-- ,:LKP.LKP_CLAIM_SUIT_STATUS_CODE(v_suit_status_code)\r\n\t-- )\n\tIFF(\n\t    LKP_CLAIM_SUIT_STATUS_CODE_v_suit_status_code.suit_status_code_descript IS NULL, 'N/A',\n\t    LKP_CLAIM_SUIT_STATUS_CODE_v_suit_status_code.suit_status_code_descript\n\t) AS suit_status_code_desc,\n\tsuit_denial_date,\n\tprim_litigation_handler_role_code,\n\t-- *INF*: iif(isnull(prim_litigation_handler_role_code)\r\n\t-- ,'N/A'\r\n\t-- ,prim_litigation_handler_role_code)\n\tIFF(prim_litigation_handler_role_code IS NULL, 'N/A', prim_litigation_handler_role_code) AS v_prim_litigation_handler_role_code,\n\tv_prim_litigation_handler_role_code AS prim_litigation_handler_role_code_out,\n\t-- *INF*: iif(isnull(:LKP.LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE(v_prim_litigation_handler_role_code))\r\n\t-- ,'N/A'\r\n\t-- ,:LKP.LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE(v_prim_litigation_handler_role_code)\r\n\t-- )\n\tIFF(\n\t    LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE_v_prim_litigation_handler_role_code.prim_litigation_role_code_descript IS NULL,\n\t    'N/A',\n\t    LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE_v_prim_litigation_handler_role_code.prim_litigation_role_code_descript\n\t) AS prim_litigation_handler_role_code_desc,\n\tsuit_open_date,\n\tsuit_close_date,\n\tsuit_how_claim_closed,\n\treins_reported_ind,\n\tcommercl_umb_reserve,\n\tsuit_pay_amt,\n\tarbitration_open_date,\n\tarbitration_close_date,\n\teff_from_date AS eff_from_date1,\n\tdemand_at_initial_litigation,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tsysdate AS created_date,\n\tsysdate AS modified_date,\n\tclaim_party_id AS ext_lit_pk_id,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_pk_id,-1)\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_pk_id,\n\t    - 1\n\t) AS o_ext_lit_pk_id,\n\tclaim_party_ak_id AS ext_lit_ak_id,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_ak_id,-1)\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_ak_id,\n\t    - 1\n\t) AS o_ext_lit_ak_id,\n\tclaim_party_full_name AS ext_lit_claim_party_full_name,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_full_name,'N/A')\r\n\t-- \n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_full_name,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_full_name,\n\tclaim_party_first_name AS ext_lit_claim_party_first_name,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_first_name,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_first_name,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_first_name,\n\tclaim_party_last_name AS ext_lit_claim_party_last_name,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- wppp_claim_party_last_name,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    wppp_claim_party_last_name,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_last_name,\n\tclaim_party_mid_name AS ext_lit_claim_party_mid_name,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_mid_name,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_mid_name,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_mid_name,\n\tclaim_party_name_prfx AS ext_lit_claim_party_name_prfx,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_name_prfx,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_name_prfx,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_name_prfx,\n\tclaim_party_name_sfx AS ext_lit_claim_party_name_sfx,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_name_sfx,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_name_sfx,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_name_sfx,\n\tclaim_party_addr AS ext_lit_claim_party_addr,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_addr,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_addr,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_addr,\n\tclaim_party_city AS ext_lit_claim_party_city,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_city,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_city,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_city,\n\tclaim_party_county AS ext_lit_claim_party_county,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_county,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_county,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_county,\n\tclaim_party_state AS ext_lit_claim_party_state,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_state,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_state,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_state,\n\tclaim_party_zip AS ext_lit_claim_party_zip,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_claim_party_zip,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_claim_party_zip,\n\t    'N/A'\n\t) AS o_ext_lit_claim_party_zip,\n\taddr_type AS ext_lit_addr_type,\n\t-- *INF*: iif((v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\r\n\t-- ext_lit_addr_type,'N/A')\n\tIFF(\n\t    (v_prim_litigation_handler_role_code = 'REG' OR v_prim_litigation_handler_role_code = 'ARB'),\n\t    ext_lit_addr_type,\n\t    'N/A'\n\t) AS o_ext_lit_addr_type,\n\tclaim_party_id1 AS def_claim_party_id,\n\tclaim_party_ak_id2 AS def_claim_party_ak_id,\n\tclaim_party_full_name1 AS defd_claim_party_full_name1,\n\tclaim_party_first_name1 AS defd_claim_party_first_name1,\n\tclaim_party_last_name1 AS defd_claim_party_last_name1,\n\tclaim_party_mid_name1 AS defd_claim_party_mid_name1,\n\tclaim_party_name_prfx1 AS defd_claim_party_name_prfx1,\n\tclaim_party_name_sfx1 AS defd_claim_party_name_sfx1,\n\tclaim_party_id2 AS code_claim_party_id,\n\tclaim_party_ak_id3 AS code_claim_party_ak_id,\n\tclaim_party_full_name2 AS code_claim_party_full_name2,\n\tclaim_party_first_name2 AS code_claim_party_first_name2,\n\tclaim_party_last_name2 AS code_claim_party_last_name2,\n\tclaim_party_mid_name2 AS code_claim_party_mid_name2,\n\tclaim_party_name_prfx2 AS code_claim_party_name_prfx2,\n\tclaim_party_name_sfx2 AS code_claim_party_name_sfx2,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_id\r\n\t-- ,def_claim_party_id)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_id, def_claim_party_id) AS o_defd_claim_party_id,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_ak_id\r\n\t-- ,def_claim_party_ak_id)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_ak_id, def_claim_party_ak_id) AS o_defd_claim_party_ak_id,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_full_name2\r\n\t-- ,defd_claim_party_full_name1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_full_name2, defd_claim_party_full_name1) AS o_defd_claim_party_full_Name,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_first_name2\r\n\t-- ,defd_claim_party_first_name1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_first_name2, defd_claim_party_first_name1) AS o_defd_claim_party_first_name,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_last_name2\r\n\t-- ,defd_claim_party_last_name1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_last_name2, defd_claim_party_last_name1) AS o_defd_claim_party_last_name,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_mid_name2\r\n\t-- ,defd_claim_party_mid_name1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_mid_name2, defd_claim_party_mid_name1) AS o_defd_claim_party_mid_name,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_name_prfx2\r\n\t-- ,defd_claim_party_name_prfx1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_name_prfx2, defd_claim_party_name_prfx1) AS o_defd_claim_party_name_prfx,\n\t-- *INF*: iif(isnull(def_claim_party_id)\r\n\t-- ,code_claim_party_name_sfx2\r\n\t-- ,defd_claim_party_name_sfx1)\n\tIFF(def_claim_party_id IS NULL, code_claim_party_name_sfx2, defd_claim_party_name_sfx1) AS o_defd_claim_party_name_sfx,\n\tclaim_party_id5 AS wppp_claim_party_id,\n\tclaim_party_ak_id6 AS wppp_claim_party_ak_id,\n\tclaim_party_full_name5 AS wppp_claim_party_full_name,\n\tclaim_party_first_name5 AS wppp_claim_party_first_name,\n\tclaim_party_last_name5 AS wppp_claim_party_last_name,\n\tclaim_party_mid_name5 AS wppp_claim_party_mid_name,\n\tclaim_party_name_prfx5 AS wppp_claim_party_name_prfx,\n\tclaim_party_name_sfx5 AS wppp_claim_party_name_sfx,\n\tclaim_party_id3 AS plat_claim_party_id,\n\tclaim_party_ak_id4 AS plat_claim_party_ak_id,\n\tclaim_party_full_name3 AS plat_claim_party_full_name3,\n\tclaim_party_first_name3 AS plat_claim_party_first_name3,\n\tclaim_party_last_name3 AS plat_claim_party_last_name3,\n\tclaim_party_mid_name3 AS plat_claim_party_mid_name3,\n\tclaim_party_name_prfx3 AS plat_claim_party_name_prfx3,\n\tclaim_party_name_sfx3 AS plat_claim_party_name_sfx3,\n\tclaim_party_id4 AS iplt_claim_party_id,\n\tclaim_party_ak_id5 AS iplt_claim_party_ak_id,\n\tclaim_party_full_name4 AS iplt_claim_party_full_name4,\n\tclaim_party_first_name4 AS iplt_claim_party_first_name4,\n\tclaim_party_last_name4 AS iplt_claim_party_last_name4,\n\tclaim_party_mid_name4 AS iplt_claim_party_mid_name4,\n\tclaim_party_name_prfx4 AS iplt_claim_party_name_prfx4,\n\tclaim_party_name_sfx4 AS iplt_claim_party_name_sfx4,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- \t,wppp_claim_party_id\r\n\t-- \t,iif(isnull(plat_claim_party_id)\r\n\t-- \t\t\t,iplt_claim_party_id\r\n\t-- \t\t\t,plat_claim_party_id)\r\n\t--    )\r\n\t-- \n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_id,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_id, plat_claim_party_id\n\t    )\n\t) AS o_plat_claim_party_id,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_ak_id\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_ak_id\r\n\t-- ,plat_claim_party_ak_id)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_ak_id,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_ak_id, plat_claim_party_ak_id\n\t    )\n\t) AS o_plat_claim_party_ak_id,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_full_name\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_full_name4\r\n\t-- ,plat_claim_party_full_name3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_full_name,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_full_name4,\n\t        plat_claim_party_full_name3\n\t    )\n\t) AS o_plat_claim_party_full_name,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_first_name\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_first_name4\r\n\t-- ,plat_claim_party_first_name3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_first_name,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_first_name4,\n\t        plat_claim_party_first_name3\n\t    )\n\t) AS o_plat_claim_party_first_name,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_last_name\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_last_name4\r\n\t-- ,plat_claim_party_last_name3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_last_name,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_last_name4,\n\t        plat_claim_party_last_name3\n\t    )\n\t) AS o_plat_claim_party_last_name,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_mid_name\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_mid_name4\r\n\t-- ,plat_claim_party_mid_name3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_mid_name,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_mid_name4, plat_claim_party_mid_name3\n\t    )\n\t) AS o_plat_claim_party_mid_name,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_name_prfx\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_name_prfx4\r\n\t-- ,plat_claim_party_name_prfx3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_name_prfx,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_name_prfx4,\n\t        plat_claim_party_name_prfx3\n\t    )\n\t) AS o_plat_claim_party_name_prfx,\n\t-- *INF*: iif(not isnull(wppp_claim_party_id)\r\n\t-- ,wppp_claim_party_name_sfx\r\n\t-- ,iif(isnull(plat_claim_party_id)\r\n\t-- ,iplt_claim_party_name_sfx4\r\n\t-- ,plat_claim_party_name_sfx3)\r\n\t-- )\n\tIFF(\n\t    wppp_claim_party_id IS NOT NULL, wppp_claim_party_name_sfx,\n\t    IFF(\n\t        plat_claim_party_id IS NULL, iplt_claim_party_name_sfx4, plat_claim_party_name_sfx3\n\t    )\n\t) AS o_plat_claim_party_name_sfx\n\tFROM SQ_claim_case\n\tLEFT JOIN LKP_CLAIM_SUIT_STATUS_CODE LKP_CLAIM_SUIT_STATUS_CODE_v_suit_status_code\n\tON LKP_CLAIM_SUIT_STATUS_CODE_v_suit_status_code.suit_status_code = v_suit_status_code\n\n\tLEFT JOIN LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE_v_prim_litigation_handler_role_code\n\tON LKP_PRIM_LITIGATION_HANDLER_ROLE_CODE_v_prim_litigation_handler_role_code.prim_litigation_role_code = v_prim_litigation_handler_role_code\n\n),\nFLT_Nulls_Claim_Cases AS (\n\tSELECT\n\tclaim_case_id, \n\tclaim_case_ak_id, \n\tclaim_case_key, \n\tclaim_case_name, \n\tclaim_case_num, \n\tsuit_county, \n\tsuit_state, \n\ttrial_date, \n\tfirst_notice_law_suit_ind, \n\tdeclaratory_action_ind, \n\tsuit_status_code_out AS suit_status_code, \n\tsuit_status_code_desc, \n\tsuit_denial_date, \n\tprim_litigation_handler_role_code_out AS prim_litigation_handler_role_code, \n\tprim_litigation_handler_role_code_desc, \n\tsuit_open_date, \n\tsuit_close_date, \n\tsuit_how_claim_closed, \n\treins_reported_ind, \n\tcommercl_umb_reserve, \n\tsuit_pay_amt, \n\tarbitration_open_date, \n\tarbitration_close_date, \n\tdemand_at_initial_litigation, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_from_date1 AS eff_from_date, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\to_ext_lit_pk_id AS ext_lit_pk_id, \n\to_ext_lit_ak_id AS ext_lit_ak_id, \n\to_ext_lit_claim_party_full_name AS ext_lit_claim_party_full_name, \n\to_ext_lit_claim_party_first_name AS ext_lit_claim_party_first_name, \n\to_ext_lit_claim_party_last_name AS ext_lit_claim_party_last_name, \n\to_ext_lit_claim_party_mid_name AS ext_lit_claim_party_mid_name, \n\to_ext_lit_claim_party_name_prfx AS ext_lit_claim_party_name_prfx, \n\to_ext_lit_claim_party_name_sfx AS ext_lit_claim_party_name_sfx, \n\to_ext_lit_claim_party_addr AS ext_lit_claim_party_addr, \n\to_ext_lit_claim_party_city AS ext_lit_claim_party_city, \n\to_ext_lit_claim_party_county AS ext_lit_claim_party_county, \n\to_ext_lit_claim_party_state AS ext_lit_claim_party_state, \n\to_ext_lit_claim_party_zip AS ext_lit_claim_party_zip, \n\to_ext_lit_addr_type AS ext_lit_addr_type, \n\to_defd_claim_party_id, \n\to_defd_claim_party_ak_id, \n\to_defd_claim_party_full_Name, \n\to_defd_claim_party_first_name, \n\to_defd_claim_party_last_name, \n\to_defd_claim_party_mid_name, \n\to_defd_claim_party_name_prfx, \n\to_defd_claim_party_name_sfx, \n\to_plat_claim_party_id, \n\to_plat_claim_party_ak_id, \n\tplat_client_seq_nbr, \n\to_plat_claim_party_full_name, \n\to_plat_claim_party_first_name, \n\to_plat_claim_party_last_name, \n\to_plat_claim_party_mid_name, \n\to_plat_claim_party_name_prfx, \n\to_plat_claim_party_name_sfx\n\tFROM EXP_Default\n\tWHERE not isnull(claim_case_ak_id) --and ext_lit_pk_id <> -1\n),\nSRT_Sort_Plaintiffs AS (\n\tSELECT\n\tclaim_case_ak_id, \n\teff_from_date, \n\to_plat_claim_party_ak_id, \n\tclaim_case_id, \n\tclaim_case_key, \n\tclaim_case_name, \n\tclaim_case_num, \n\tsuit_county, \n\tsuit_state, \n\ttrial_date, \n\tfirst_notice_law_suit_ind, \n\tdeclaratory_action_ind, \n\tsuit_status_code, \n\tsuit_status_code_desc, \n\tsuit_denial_date, \n\tprim_litigation_handler_role_code, \n\tprim_litigation_handler_role_code_desc, \n\tsuit_open_date, \n\tsuit_close_date, \n\tsuit_how_claim_closed, \n\treins_reported_ind, \n\tcommercl_umb_reserve, \n\tsuit_pay_amt, \n\tarbitration_open_date, \n\tarbitration_close_date, \n\tdemand_at_initial_litigation, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\text_lit_pk_id, \n\text_lit_ak_id, \n\text_lit_claim_party_full_name, \n\text_lit_claim_party_first_name, \n\text_lit_claim_party_last_name, \n\text_lit_claim_party_mid_name, \n\text_lit_claim_party_name_prfx, \n\text_lit_claim_party_name_sfx, \n\text_lit_claim_party_addr, \n\text_lit_claim_party_city, \n\text_lit_claim_party_county, \n\text_lit_claim_party_state, \n\text_lit_claim_party_zip, \n\text_lit_addr_type, \n\to_plat_claim_party_id, \n\to_plat_claim_party_full_name, \n\to_plat_claim_party_first_name, \n\to_plat_claim_party_last_name, \n\to_plat_claim_party_mid_name, \n\to_plat_claim_party_name_prfx, \n\to_plat_claim_party_name_sfx\n\tFROM FLT_Nulls_Claim_Cases\n\tORDER BY claim_case_ak_id ASC, eff_from_date ASC, o_plat_claim_party_ak_id ASC\n),\nAgg_Plaintiff_Data AS (\n\tSELECT\n\tclaim_case_id,\n\tclaim_case_ak_id,\n\tclaim_case_key,\n\tclaim_case_name,\n\tclaim_case_num,\n\tsuit_county,\n\tsuit_state,\n\ttrial_date,\n\tfirst_notice_law_suit_ind,\n\tdeclaratory_action_ind,\n\tsuit_status_code,\n\tsuit_status_code_desc,\n\tsuit_denial_date,\n\tprim_litigation_handler_role_code,\n\tprim_litigation_handler_role_code_desc,\n\tsuit_open_date,\n\tsuit_close_date,\n\tsuit_how_claim_closed,\n\treins_reported_ind,\n\tcommercl_umb_reserve,\n\tsuit_pay_amt,\n\tarbitration_open_date,\n\tarbitration_close_date,\n\tdemand_at_initial_litigation,\n\tcrrnt_snpsht_flag,\n\taudit_id,\n\teff_from_date,\n\teff_to_date,\n\tcreated_date,\n\tmodified_date,\n\text_lit_pk_id,\n\text_lit_ak_id,\n\text_lit_claim_party_full_name,\n\text_lit_claim_party_first_name,\n\text_lit_claim_party_last_name,\n\text_lit_claim_party_mid_name,\n\text_lit_claim_party_name_prfx,\n\text_lit_claim_party_name_sfx,\n\text_lit_claim_party_addr,\n\text_lit_claim_party_city,\n\text_lit_claim_party_county,\n\text_lit_claim_party_state,\n\text_lit_claim_party_zip,\n\text_lit_addr_type,\n\to_plat_claim_party_id AS plat_claim_party_id,\n\t-- *INF*: iif(isnull(first(plat_claim_party_id,plat_claim_party_id != -1))\r\n\t-- ,-1\r\n\t-- ,first(plat_claim_party_id,plat_claim_party_id != -1))\n\tIFF(\n\t    first(plat_claim_party_id, plat_claim_party_id != - 1) IS NULL, - 1,\n\t    first(plat_claim_party_id, plat_claim_party_id != - 1)\n\t) AS o_plat_claim_party_id,\n\to_plat_claim_party_ak_id AS plat_claim_party_ak_id,\n\t-- *INF*: iif(isnull(first(plat_claim_party_ak_id,plat_claim_party_ak_id != -1))\r\n\t-- ,-1\r\n\t-- ,first(plat_claim_party_ak_id,plat_claim_party_ak_id != -1))\n\tIFF(\n\t    first(plat_claim_party_ak_id, plat_claim_party_ak_id != - 1) IS NULL, - 1,\n\t    first(plat_claim_party_ak_id, plat_claim_party_ak_id != - 1)\n\t) AS o_plat_claim_party_ak_id,\n\to_plat_claim_party_full_name AS plat_claim_party_full_name,\n\t-- *INF*: iif(isnull(first(plat_claim_party_full_name,plat_claim_party_full_name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_full_name,plat_claim_party_full_name != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_full_name, plat_claim_party_full_name != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_full_name, plat_claim_party_full_name != 'N/A')\n\t) AS o_plat_claim_party_full_name,\n\to_plat_claim_party_first_name AS plat_claim_party_first_name,\n\t-- *INF*: iif(isnull(first(plat_claim_party_first_name,plat_claim_party_first_name  != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_first_name,plat_claim_party_first_name  != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_first_name, plat_claim_party_first_name != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_first_name, plat_claim_party_first_name != 'N/A')\n\t) AS o_plat_claim_party_first_name,\n\to_plat_claim_party_last_name AS plat_claim_party_last_name,\n\t-- *INF*: iif(isnull(first(plat_claim_party_last_name,plat_claim_party_last_name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_last_name,plat_claim_party_last_name != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_last_name, plat_claim_party_last_name != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_last_name, plat_claim_party_last_name != 'N/A')\n\t) AS o_plat_claim_party_last_name,\n\to_plat_claim_party_mid_name AS plat_claim_party_mid_name,\n\t-- *INF*: iif(isnull(first(plat_claim_party_mid_name,plat_claim_party_mid_name  != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_mid_name,plat_claim_party_mid_name  != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_mid_name, plat_claim_party_mid_name != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_mid_name, plat_claim_party_mid_name != 'N/A')\n\t) AS o_plat_claim_party_mid_name,\n\to_plat_claim_party_name_prfx AS plat_claim_party_name_prfx,\n\t-- *INF*: iif(isnull(first(plat_claim_party_name_prfx,plat_claim_party_name_prfx != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_name_prfx,plat_claim_party_name_prfx != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_name_prfx, plat_claim_party_name_prfx != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_name_prfx, plat_claim_party_name_prfx != 'N/A')\n\t) AS o_plat_claim_party_name_prfx,\n\to_plat_claim_party_name_sfx AS plat_claim_party_name_sfx,\n\t-- *INF*: iif(isnull(first(plat_claim_party_name_sfx,plat_claim_party_name_sfx != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(plat_claim_party_name_sfx,plat_claim_party_name_sfx != 'N/A'))\n\tIFF(\n\t    first(plat_claim_party_name_sfx, plat_claim_party_name_sfx != 'N/A') IS NULL, 'N/A',\n\t    first(plat_claim_party_name_sfx, plat_claim_party_name_sfx != 'N/A')\n\t) AS o_plat_claim_party_name_sfx\n\tFROM SRT_Sort_Plaintiffs\n\tGROUP BY claim_case_ak_id, eff_from_date\n),\nSR2 AS (\n\tSELECT\n\tclaim_case_id, \n\tclaim_case_ak_id, \n\tclaim_case_key, \n\tclaim_case_name, \n\tclaim_case_num, \n\tsuit_county, \n\tsuit_state, \n\ttrial_date, \n\tfirst_notice_law_suit_ind, \n\tdeclaratory_action_ind, \n\tsuit_status_code, \n\tsuit_status_code_desc, \n\tsuit_denial_date, \n\tprim_litigation_handler_role_code, \n\tprim_litigation_handler_role_code_desc, \n\tsuit_open_date, \n\tsuit_close_date, \n\tsuit_how_claim_closed, \n\treins_reported_ind, \n\tcommercl_umb_reserve, \n\tsuit_pay_amt, \n\tarbitration_open_date, \n\tarbitration_close_date, \n\tdemand_at_initial_litigation, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_from_date, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\text_lit_pk_id, \n\text_lit_ak_id, \n\text_lit_claim_party_full_name, \n\text_lit_claim_party_first_name, \n\text_lit_claim_party_last_name, \n\text_lit_claim_party_mid_name, \n\text_lit_claim_party_name_prfx, \n\text_lit_claim_party_name_sfx, \n\text_lit_claim_party_addr, \n\text_lit_claim_party_city, \n\text_lit_claim_party_county, \n\text_lit_claim_party_state, \n\text_lit_claim_party_zip, \n\text_lit_addr_type, \n\to_plat_claim_party_id, \n\to_plat_claim_party_ak_id, \n\to_plat_claim_party_full_name, \n\to_plat_claim_party_first_name, \n\to_plat_claim_party_last_name, \n\to_plat_claim_party_mid_name, \n\to_plat_claim_party_name_prfx, \n\to_plat_claim_party_name_sfx\n\tFROM Agg_Plaintiff_Data\n\tORDER BY claim_case_ak_id ASC, eff_from_date ASC\n),\nSRT_Sort_Defendants AS (\n\tSELECT\n\tclaim_case_ak_id, \n\teff_from_date, \n\to_defd_claim_party_ak_id, \n\tclaim_case_id, \n\tclaim_case_key, \n\tclaim_case_name, \n\tclaim_case_num, \n\tsuit_county, \n\tsuit_state, \n\ttrial_date, \n\tfirst_notice_law_suit_ind, \n\tdeclaratory_action_ind, \n\tsuit_status_code, \n\tsuit_status_code_desc, \n\tsuit_denial_date, \n\tprim_litigation_handler_role_code, \n\tprim_litigation_handler_role_code_desc, \n\tsuit_open_date, \n\tsuit_close_date, \n\tsuit_how_claim_closed, \n\treins_reported_ind, \n\tcommercl_umb_reserve, \n\tsuit_pay_amt, \n\tarbitration_open_date, \n\tarbitration_close_date, \n\tdemand_at_initial_litigation, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\text_lit_pk_id, \n\text_lit_ak_id, \n\text_lit_claim_party_full_name, \n\text_lit_claim_party_first_name, \n\text_lit_claim_party_last_name, \n\text_lit_claim_party_mid_name, \n\text_lit_claim_party_name_prfx, \n\text_lit_claim_party_name_sfx, \n\text_lit_claim_party_addr, \n\text_lit_claim_party_city, \n\text_lit_claim_party_county, \n\text_lit_claim_party_state, \n\text_lit_claim_party_zip, \n\text_lit_addr_type, \n\to_defd_claim_party_id, \n\to_defd_claim_party_full_Name, \n\to_defd_claim_party_first_name, \n\to_defd_claim_party_last_name, \n\to_defd_claim_party_mid_name, \n\to_defd_claim_party_name_prfx, \n\to_defd_claim_party_name_sfx\n\tFROM FLT_Nulls_Claim_Cases\n\tORDER BY claim_case_ak_id ASC, eff_from_date ASC, o_defd_claim_party_ak_id ASC\n),\nAgg_Defendant_Data AS (\n\tSELECT\n\tclaim_case_id,\n\tclaim_case_ak_id,\n\tclaim_case_key,\n\tclaim_case_name,\n\tclaim_case_num,\n\tsuit_county,\n\tsuit_state,\n\ttrial_date,\n\tfirst_notice_law_suit_ind,\n\tdeclaratory_action_ind,\n\tsuit_status_code,\n\tsuit_status_code_desc,\n\tsuit_denial_date,\n\tprim_litigation_handler_role_code,\n\tprim_litigation_handler_role_code_desc,\n\tsuit_open_date,\n\tsuit_close_date,\n\tsuit_how_claim_closed,\n\treins_reported_ind,\n\tcommercl_umb_reserve,\n\tsuit_pay_amt,\n\tarbitration_open_date,\n\tarbitration_close_date,\n\tdemand_at_initial_litigation,\n\tcrrnt_snpsht_flag,\n\taudit_id,\n\teff_from_date,\n\teff_to_date,\n\tcreated_date,\n\tmodified_date,\n\text_lit_pk_id,\n\text_lit_ak_id,\n\text_lit_claim_party_full_name,\n\text_lit_claim_party_first_name,\n\text_lit_claim_party_last_name,\n\text_lit_claim_party_mid_name,\n\text_lit_claim_party_name_prfx,\n\text_lit_claim_party_name_sfx,\n\text_lit_claim_party_addr,\n\text_lit_claim_party_city,\n\text_lit_claim_party_county,\n\text_lit_claim_party_state,\n\text_lit_claim_party_zip,\n\text_lit_addr_type,\n\to_defd_claim_party_id AS defd_claim_party_id,\n\t-- *INF*: iif(isnull(first(defd_claim_party_id,defd_claim_party_id != -1))\r\n\t-- ,-1\r\n\t-- ,first(defd_claim_party_id,defd_claim_party_id != -1)\r\n\t-- )\n\tIFF(\n\t    first(defd_claim_party_id, defd_claim_party_id != - 1) IS NULL, - 1,\n\t    first(defd_claim_party_id, defd_claim_party_id != - 1)\n\t) AS o_defd_claim_party_id,\n\to_defd_claim_party_ak_id AS defd_claim_party_ak_id,\n\t-- *INF*: iif(isnull(first(defd_claim_party_ak_id, defd_claim_party_ak_id != -1))\r\n\t-- ,-1\r\n\t-- ,first(defd_claim_party_ak_id, defd_claim_party_ak_id != -1)\r\n\t-- )\n\tIFF(\n\t    first(defd_claim_party_ak_id, defd_claim_party_ak_id != - 1) IS NULL, - 1,\n\t    first(defd_claim_party_ak_id, defd_claim_party_ak_id != - 1)\n\t) AS o_defd_claim_party_ak_id,\n\to_defd_claim_party_full_Name AS defd_claim_party_full_Name,\n\t-- *INF*: iif(isnull(first(defd_claim_party_full_Name, defd_claim_party_full_Name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_full_Name, defd_claim_party_full_Name != 'N/A')\r\n\t-- )\n\tIFF(\n\t    first(defd_claim_party_full_Name, defd_claim_party_full_Name != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_full_Name, defd_claim_party_full_Name != 'N/A')\n\t) AS o_defd_claim_party_full_Name,\n\to_defd_claim_party_first_name AS defd_claim_party_first_name,\n\t-- *INF*: iif(isnull(first(defd_claim_party_first_name,defd_claim_party_first_name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_first_name,defd_claim_party_first_name != 'N/A'))\n\tIFF(\n\t    first(defd_claim_party_first_name, defd_claim_party_first_name != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_first_name, defd_claim_party_first_name != 'N/A')\n\t) AS o_defd_claim_party_first_name,\n\to_defd_claim_party_last_name AS defd_claim_party_last_name,\n\t-- *INF*: iif(isnull(first(defd_claim_party_last_name,defd_claim_party_last_name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_last_name,defd_claim_party_last_name != 'N/A'))\n\tIFF(\n\t    first(defd_claim_party_last_name, defd_claim_party_last_name != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_last_name, defd_claim_party_last_name != 'N/A')\n\t) AS o_defd_claim_party_last_name,\n\to_defd_claim_party_mid_name AS defd_claim_party_mid_name,\n\t-- *INF*: iif(isnull(first(defd_claim_party_mid_name,defd_claim_party_mid_name != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_mid_name,defd_claim_party_mid_name != 'N/A'))\n\tIFF(\n\t    first(defd_claim_party_mid_name, defd_claim_party_mid_name != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_mid_name, defd_claim_party_mid_name != 'N/A')\n\t) AS o_defd_claim_party_mid_name,\n\to_defd_claim_party_name_prfx AS defd_claim_party_name_prfx,\n\t-- *INF*: iif(isnull(first(defd_claim_party_name_prfx,defd_claim_party_name_prfx != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_name_prfx,defd_claim_party_name_prfx != 'N/A'))\n\tIFF(\n\t    first(defd_claim_party_name_prfx, defd_claim_party_name_prfx != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_name_prfx, defd_claim_party_name_prfx != 'N/A')\n\t) AS o_defd_claim_party_name_prfx,\n\to_defd_claim_party_name_sfx AS defd_claim_party_name_sfx,\n\t-- *INF*: iif(isnull(first(defd_claim_party_name_sfx,defd_claim_party_name_sfx != 'N/A'))\r\n\t-- ,'N/A'\r\n\t-- ,first(defd_claim_party_name_sfx,defd_claim_party_name_sfx != 'N/A'))\n\tIFF(\n\t    first(defd_claim_party_name_sfx, defd_claim_party_name_sfx != 'N/A') IS NULL, 'N/A',\n\t    first(defd_claim_party_name_sfx, defd_claim_party_name_sfx != 'N/A')\n\t) AS o_defd_claim_party_name_sfx\n\tFROM SRT_Sort_Defendants\n\tGROUP BY claim_case_ak_id, eff_from_date\n),\nSRT1 AS (\n\tSELECT\n\tclaim_case_id, \n\tclaim_case_ak_id, \n\tclaim_case_key, \n\tclaim_case_name, \n\tclaim_case_num, \n\tsuit_county, \n\tsuit_state, \n\ttrial_date, \n\tfirst_notice_law_suit_ind, \n\tdeclaratory_action_ind, \n\tsuit_status_code, \n\tsuit_status_code_desc, \n\tsuit_denial_date, \n\tprim_litigation_handler_role_code, \n\tprim_litigation_handler_role_code_desc, \n\tsuit_open_date, \n\tsuit_close_date, \n\tsuit_how_claim_closed, \n\treins_reported_ind, \n\tcommercl_umb_reserve, \n\tsuit_pay_amt, \n\tarbitration_open_date, \n\tarbitration_close_date, \n\tdemand_at_initial_litigation, \n\tcrrnt_snpsht_flag, \n\taudit_id, \n\teff_from_date, \n\teff_to_date, \n\tcreated_date, \n\tmodified_date, \n\text_lit_pk_id, \n\text_lit_ak_id, \n\text_lit_claim_party_full_name, \n\text_lit_claim_party_first_name, \n\text_lit_claim_party_last_name, \n\text_lit_claim_party_mid_name, \n\text_lit_claim_party_name_prfx, \n\text_lit_claim_party_name_sfx, \n\text_lit_claim_party_addr, \n\text_lit_claim_party_city, \n\text_lit_claim_party_county, \n\text_lit_claim_party_state, \n\text_lit_claim_party_zip, \n\text_lit_addr_type, \n\to_defd_claim_party_id, \n\to_defd_claim_party_ak_id, \n\to_defd_claim_party_full_Name, \n\to_defd_claim_party_first_name, \n\to_defd_claim_party_last_name, \n\to_defd_claim_party_mid_name, \n\to_defd_claim_party_name_prfx, \n\to_defd_claim_party_name_sfx\n\tFROM Agg_Defendant_Data\n\tORDER BY claim_case_ak_id ASC, eff_from_date ASC\n),\nJNR_Def_Plt AS (SELECT\n\tSRT1.claim_case_id, \n\tSRT1.claim_case_ak_id, \n\tSRT1.claim_case_key, \n\tSRT1.claim_case_name, \n\tSRT1.claim_case_num, \n\tSRT1.suit_county, \n\tSRT1.suit_state, \n\tSRT1.trial_date, \n\tSRT1.first_notice_law_suit_ind, \n\tSRT1.declaratory_action_ind, \n\tSRT1.suit_status_code, \n\tSRT1.suit_status_code_desc, \n\tSRT1.suit_denial_date, \n\tSRT1.prim_litigation_handler_role_code, \n\tSRT1.prim_litigation_handler_role_code_desc, \n\tSRT1.suit_open_date, \n\tSRT1.suit_close_date, \n\tSRT1.suit_how_claim_closed, \n\tSRT1.reins_reported_ind, \n\tSRT1.commercl_umb_reserve, \n\tSRT1.suit_pay_amt, \n\tSRT1.arbitration_open_date, \n\tSRT1.arbitration_close_date, \n\tSRT1.demand_at_initial_litigation, \n\tSRT1.crrnt_snpsht_flag, \n\tSRT1.audit_id, \n\tSRT1.eff_from_date, \n\tSRT1.eff_to_date, \n\tSRT1.created_date, \n\tSRT1.modified_date, \n\tSRT1.ext_lit_pk_id, \n\tSRT1.ext_lit_ak_id, \n\tSRT1.ext_lit_claim_party_full_name, \n\tSRT1.ext_lit_claim_party_first_name, \n\tSRT1.ext_lit_claim_party_last_name, \n\tSRT1.ext_lit_claim_party_mid_name, \n\tSRT1.ext_lit_claim_party_name_prfx, \n\tSRT1.ext_lit_claim_party_name_sfx, \n\tSRT1.ext_lit_claim_party_addr, \n\tSRT1.ext_lit_claim_party_city, \n\tSRT1.ext_lit_claim_party_county, \n\tSRT1.ext_lit_claim_party_state, \n\tSRT1.ext_lit_claim_party_zip, \n\tSRT1.ext_lit_addr_type, \n\tSRT1.o_defd_claim_party_id, \n\tSRT1.o_defd_claim_party_ak_id, \n\tSRT1.o_defd_claim_party_full_Name, \n\tSRT1.o_defd_claim_party_first_name, \n\tSRT1.o_defd_claim_party_last_name, \n\tSRT1.o_defd_claim_party_mid_name, \n\tSRT1.o_defd_claim_party_name_prfx, \n\tSRT1.o_defd_claim_party_name_sfx, \n\tSR2.claim_case_ak_id AS claim_case_ak_id1, \n\tSR2.eff_from_date AS eff_from_date1, \n\tSR2.o_plat_claim_party_id, \n\tSR2.o_plat_claim_party_ak_id, \n\tSR2.o_plat_claim_party_full_name, \n\tSR2.o_plat_claim_party_first_name, \n\tSR2.o_plat_claim_party_last_name, \n\tSR2.o_plat_claim_party_mid_name, \n\tSR2.o_plat_claim_party_name_prfx, \n\tSR2.o_plat_claim_party_name_sfx\n\tFROM SRT1\n\tINNER JOIN SR2\n\tON SR2.claim_case_ak_id = SRT1.claim_case_ak_id AND SR2.eff_from_date = SRT1.eff_from_date\n),\nLKP_Question_Center_IsInjuredPartyRepresented_daily AS (\n\tSELECT\n\tclaim_case_ak_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_occurrence_ak_id,\n\toptn_text,\n\tIN_claim_case_ak_id\n\tFROM (\n\t\tSelect \r\n\t\tCPO.claim_case_ak_id as claim_case_ak_id,\r\n\t\tCO.claim_occurrence_ak_id as claim_occurrence_ak_id ,\r\n\t\tCPO.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id ,\r\n\t\trtrim(ltrim(CA.optn_text)) as optn_text\r\n\t\tFrom\r\n\t\tclaim_party_occurrence CPO\r\n\t\tinner join claim_answer CA\r\n\t\ton CA.claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id\r\n\t\tinner join claim_occurrence CO \r\n\t\ton CA.claim_occurrence_ak_id = CO.claim_occurrence_ak_id\r\n\t\tinner join question Q\r\n\t\ton Q.question_ak_id = CA.question_ak_id\r\n\t\tinner join application_context AC\r\n\t\ton Q.app_context_ak_id = AC.app_context_ak_id\r\n\t\tinner join [application] APP\r\n\t\ton AC.app_ak_id = APP.app_ak_id\r\n\t\tWhere \r\n\t\tAPP.display_name = 'Claims Workers Compensation' AND\r\n\t\tAC.app_context_entity_name = 'Claimant.Litigation.Questions' AND\r\n\t\tQ.logical_name = 'WasInjuredWorkerRepresented' and\r\n\t\tRTRIM(CPO.claim_party_role_code) in ('CLMT', 'CMT') and\r\n\t\tCO.crrnt_snpsht_flag = 1 and\r\n\t\tCPO.crrnt_snpsht_flag = 1 and\r\n\t\tAPP.crrnt_snpsht_flag=1 and\r\n\t\tAC.crrnt_snpsht_flag =1 and\r\n\t\tQ.crrnt_snpsht_flag = 1 and\r\n\t\tCA.crrnt_snpsht_flag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id ORDER BY claim_case_ak_id DESC) = 1\n),\nEXP_validate_lookup_values AS (\n\tSELECT\n\toptn_text,\n\t-- *INF*: IIF(ISNULL(optn_text),'N/A',optn_text)\r\n\t-- \n\tIFF(optn_text IS NULL, 'N/A', optn_text) AS OUT_InjuredWorkerRepresentedFlag\n\tFROM LKP_Question_Center_IsInjuredPartyRepresented_daily\n),\nLKP_Target AS (\n\tSELECT\n\tclaim_case_dim_id,\n\tclaim_case_id,\n\tedw_claim_case_pk_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_case_dim_id,\n\t\t\tclaim_case_id,\n\t\t\tedw_claim_case_pk_id\n\t\tFROM claim_case_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_pk_id ORDER BY claim_case_dim_id) = 1\n),\nRTR_Insert_Update AS (\n\tSELECT\n\tLKP_Target.claim_case_dim_id,\n\tJNR_Def_Plt.claim_case_id,\n\tJNR_Def_Plt.claim_case_ak_id,\n\tJNR_Def_Plt.claim_case_key,\n\tJNR_Def_Plt.claim_case_name,\n\tJNR_Def_Plt.claim_case_num,\n\tJNR_Def_Plt.suit_county,\n\tJNR_Def_Plt.suit_state,\n\tJNR_Def_Plt.trial_date,\n\tJNR_Def_Plt.first_notice_law_suit_ind,\n\tJNR_Def_Plt.declaratory_action_ind,\n\tJNR_Def_Plt.suit_status_code,\n\tJNR_Def_Plt.suit_status_code_desc,\n\tJNR_Def_Plt.suit_denial_date,\n\tJNR_Def_Plt.prim_litigation_handler_role_code,\n\tJNR_Def_Plt.prim_litigation_handler_role_code_desc,\n\tJNR_Def_Plt.suit_open_date,\n\tJNR_Def_Plt.suit_close_date,\n\tJNR_Def_Plt.suit_how_claim_closed,\n\tJNR_Def_Plt.reins_reported_ind,\n\tJNR_Def_Plt.commercl_umb_reserve,\n\tJNR_Def_Plt.suit_pay_amt,\n\tJNR_Def_Plt.arbitration_open_date,\n\tJNR_Def_Plt.arbitration_close_date,\n\tJNR_Def_Plt.demand_at_initial_litigation,\n\tJNR_Def_Plt.crrnt_snpsht_flag,\n\tJNR_Def_Plt.audit_id,\n\tJNR_Def_Plt.eff_from_date,\n\tJNR_Def_Plt.eff_to_date,\n\tJNR_Def_Plt.created_date,\n\tJNR_Def_Plt.modified_date,\n\tJNR_Def_Plt.ext_lit_pk_id,\n\tJNR_Def_Plt.ext_lit_ak_id,\n\tJNR_Def_Plt.ext_lit_claim_party_full_name,\n\tJNR_Def_Plt.ext_lit_claim_party_first_name,\n\tJNR_Def_Plt.ext_lit_claim_party_last_name,\n\tJNR_Def_Plt.ext_lit_claim_party_mid_name,\n\tJNR_Def_Plt.ext_lit_claim_party_name_prfx,\n\tJNR_Def_Plt.ext_lit_claim_party_name_sfx,\n\tJNR_Def_Plt.ext_lit_claim_party_addr,\n\tJNR_Def_Plt.ext_lit_claim_party_city,\n\tJNR_Def_Plt.ext_lit_claim_party_county,\n\tJNR_Def_Plt.ext_lit_claim_party_state,\n\tJNR_Def_Plt.ext_lit_claim_party_zip,\n\tJNR_Def_Plt.ext_lit_addr_type,\n\tJNR_Def_Plt.o_defd_claim_party_id,\n\tJNR_Def_Plt.o_defd_claim_party_ak_id,\n\tJNR_Def_Plt.o_defd_claim_party_full_Name,\n\tJNR_Def_Plt.o_defd_claim_party_first_name,\n\tJNR_Def_Plt.o_defd_claim_party_last_name,\n\tJNR_Def_Plt.o_defd_claim_party_mid_name,\n\tJNR_Def_Plt.o_defd_claim_party_name_prfx,\n\tJNR_Def_Plt.o_defd_claim_party_name_sfx,\n\tJNR_Def_Plt.o_plat_claim_party_id,\n\tJNR_Def_Plt.o_plat_claim_party_ak_id,\n\tJNR_Def_Plt.o_plat_claim_party_full_name,\n\tJNR_Def_Plt.o_plat_claim_party_first_name,\n\tJNR_Def_Plt.o_plat_claim_party_last_name,\n\tJNR_Def_Plt.o_plat_claim_party_mid_name,\n\tJNR_Def_Plt.o_plat_claim_party_name_prfx,\n\tJNR_Def_Plt.o_plat_claim_party_name_sfx,\n\tJNR_Def_Plt.claim_case_ak_id1 AS claim_case_ak_id_22,\n\tJNR_Def_Plt.eff_from_date1 AS eff_from_date_22,\n\tEXP_validate_lookup_values.OUT_InjuredWorkerRepresentedFlag\n\tFROM EXP_validate_lookup_values\n\t -- Manually join with JNR_Def_Plt\n\tLEFT JOIN LKP_Target\n\tON LKP_Target.edw_claim_case_pk_id = JNR_Def_Plt.claim_case_id\n),\nRTR_Insert_Update_Insert AS (SELECT * FROM RTR_Insert_Update WHERE isnull(claim_case_dim_id)),\nRTR_Insert_Update_Update AS (SELECT * FROM RTR_Insert_Update WHERE not isnull(claim_case_dim_id)),\nclaim_case_dim_insert AS (\n\tINSERT INTO claim_case_dim\n\t(crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, edw_claim_case_pk_id, edw_claim_case_ak_id, edw_claim_party_pk_id_ext_litigation_handler, edw_claim_party_pk_id_plaintiff, edw_claim_party_pk_id_defendant, edw_claim_party_ak_id_ext_litigation_handler, edw_claim_party_ak_id_plaintiff, edw_claim_party_ak_id_defendant, claim_case_key, claim_case_name, claim_case_num, suit_county, suit_state, trial_date, first_notice_law_suit_ind, declaratory_action_ind, suit_status_code, suit_status_code_descript, suit_denial_date, prim_litigation_handler_role_code, prim_litigation_role_code_descript, suit_open_date, suit_close_date, suit_how_claim_closed, reins_reported_ind, commercl_umb_reserve, suit_pay_amt, arbitration_open_date, arbitration_close_date, demand_at_initial_litigation, ext_litigation_handler_addr_type, ext_litigation_handler_zip, ext_litigation_handler_state, ext_litigation_handler_county, ext_litigation_handler_city, ext_litigation_handler_addr, ext_litigation_handler_full_name, ext_litigation_handler_first_name, ext_litigation_handler_last_name, ext_litigation_handler_mid_name, ext_litigation_handler_name_prfx, ext_litigation_handler_name_sfx, plaintiff_full_name, plaintiff_first_name, plaintiff_last_name, plaintiff_mid_name, plaintiff_name_prfx, plaintiff_name_sfx, defendant_full_name, defendant_first_name, defendant_last_name, defendant_mid_name, defendant_name_prfx, defendant_name_sfx, InjuredWorkerRepresentedFlag)\n\tSELECT \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tCREATED_DATE, \n\tMODIFIED_DATE, \n\tclaim_case_id AS EDW_CLAIM_CASE_PK_ID, \n\tclaim_case_ak_id AS EDW_CLAIM_CASE_AK_ID, \n\text_lit_pk_id AS EDW_CLAIM_PARTY_PK_ID_EXT_LITIGATION_HANDLER, \n\to_plat_claim_party_id AS EDW_CLAIM_PARTY_PK_ID_PLAINTIFF, \n\to_defd_claim_party_id AS EDW_CLAIM_PARTY_PK_ID_DEFENDANT, \n\text_lit_ak_id AS EDW_CLAIM_PARTY_AK_ID_EXT_LITIGATION_HANDLER, \n\to_plat_claim_party_ak_id AS EDW_CLAIM_PARTY_AK_ID_PLAINTIFF, \n\to_defd_claim_party_ak_id AS EDW_CLAIM_PARTY_AK_ID_DEFENDANT, \n\tCLAIM_CASE_KEY, \n\tCLAIM_CASE_NAME, \n\tCLAIM_CASE_NUM, \n\tSUIT_COUNTY, \n\tSUIT_STATE, \n\tTRIAL_DATE, \n\tFIRST_NOTICE_LAW_SUIT_IND, \n\tDECLARATORY_ACTION_IND, \n\tSUIT_STATUS_CODE, \n\tsuit_status_code_desc AS SUIT_STATUS_CODE_DESCRIPT, \n\tSUIT_DENIAL_DATE, \n\tPRIM_LITIGATION_HANDLER_ROLE_CODE, \n\tprim_litigation_handler_role_code_desc AS PRIM_LITIGATION_ROLE_CODE_DESCRIPT, \n\tSUIT_OPEN_DATE, \n\tSUIT_CLOSE_DATE, \n\tSUIT_HOW_CLAIM_CLOSED, \n\tREINS_REPORTED_IND, \n\tCOMMERCL_UMB_RESERVE, \n\tSUIT_PAY_AMT, \n\tARBITRATION_OPEN_DATE, \n\tARBITRATION_CLOSE_DATE, \n\tDEMAND_AT_INITIAL_LITIGATION, \n\text_lit_addr_type AS EXT_LITIGATION_HANDLER_ADDR_TYPE, \n\text_lit_claim_party_zip AS EXT_LITIGATION_HANDLER_ZIP, \n\text_lit_claim_party_state AS EXT_LITIGATION_HANDLER_STATE, \n\text_lit_claim_party_county AS EXT_LITIGATION_HANDLER_COUNTY, \n\text_lit_claim_party_city AS EXT_LITIGATION_HANDLER_CITY, \n\text_lit_claim_party_addr AS EXT_LITIGATION_HANDLER_ADDR, \n\text_lit_claim_party_full_name AS EXT_LITIGATION_HANDLER_FULL_NAME, \n\text_lit_claim_party_first_name AS EXT_LITIGATION_HANDLER_FIRST_NAME, \n\text_lit_claim_party_last_name AS EXT_LITIGATION_HANDLER_LAST_NAME, \n\text_lit_claim_party_mid_name AS EXT_LITIGATION_HANDLER_MID_NAME, \n\text_lit_claim_party_name_prfx AS EXT_LITIGATION_HANDLER_NAME_PRFX, \n\text_lit_claim_party_name_sfx AS EXT_LITIGATION_HANDLER_NAME_SFX, \n\to_plat_claim_party_full_name AS PLAINTIFF_FULL_NAME, \n\to_plat_claim_party_first_name AS PLAINTIFF_FIRST_NAME, \n\to_plat_claim_party_last_name AS PLAINTIFF_LAST_NAME, \n\to_plat_claim_party_mid_name AS PLAINTIFF_MID_NAME, \n\to_plat_claim_party_name_prfx AS PLAINTIFF_NAME_PRFX, \n\to_plat_claim_party_name_sfx AS PLAINTIFF_NAME_SFX, \n\to_defd_claim_party_full_Name AS DEFENDANT_FULL_NAME, \n\to_defd_claim_party_first_name AS DEFENDANT_FIRST_NAME, \n\to_defd_claim_party_last_name AS DEFENDANT_LAST_NAME, \n\to_defd_claim_party_mid_name AS DEFENDANT_MID_NAME, \n\to_defd_claim_party_name_prfx AS DEFENDANT_NAME_PRFX, \n\to_defd_claim_party_name_sfx AS DEFENDANT_NAME_SFX, \n\tOUT_InjuredWorkerRepresentedFlag AS INJUREDWORKERREPRESENTEDFLAG\n\tFROM RTR_Insert_Update_Insert\n),\nUPD_Update AS (\n\tSELECT\n\tclaim_case_dim_id AS claim_case_dim_id3, \n\tclaim_case_id, \n\tclaim_case_ak_id, \n\tclaim_case_key AS claim_case_key3, \n\tclaim_case_name AS claim_case_name3, \n\tclaim_case_num AS claim_case_num3, \n\tsuit_county AS suit_county3, \n\tsuit_state AS suit_state3, \n\ttrial_date AS trial_date3, \n\tfirst_notice_law_suit_ind AS first_notice_law_suit_ind3, \n\tdeclaratory_action_ind AS declaratory_action_ind3, \n\tsuit_status_code AS suit_status_code3, \n\tsuit_status_code_desc AS suit_status_code_desc3, \n\tsuit_denial_date AS suit_denial_date3, \n\tprim_litigation_handler_role_code AS prim_litigation_handler_role_code3, \n\tprim_litigation_handler_role_code_desc AS prim_litigation_handler_role_code_desc3, \n\tsuit_open_date AS suit_open_date3, \n\tsuit_close_date AS suit_close_date3, \n\tsuit_how_claim_closed AS suit_how_claim_closed3, \n\treins_reported_ind AS reins_reported_ind3, \n\tcommercl_umb_reserve AS commercl_umb_reserve3, \n\tsuit_pay_amt AS suit_pay_amt3, \n\tarbitration_open_date AS arbitration_open_date3, \n\tarbitration_close_date AS arbitration_close_date3, \n\tdemand_at_initial_litigation AS demand_at_initial_litigation3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_date AS eff_from_date3, \n\teff_to_date AS eff_to_date3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3, \n\text_lit_pk_id AS ext_lit_pk_id3, \n\text_lit_ak_id AS ext_lit_ak_id3, \n\text_lit_claim_party_full_name AS ext_lit_claim_party_full_name3, \n\text_lit_claim_party_first_name AS ext_lit_claim_party_first_name3, \n\text_lit_claim_party_last_name AS ext_lit_claim_party_last_name3, \n\text_lit_claim_party_mid_name AS ext_lit_claim_party_mid_name3, \n\text_lit_claim_party_name_prfx AS ext_lit_claim_party_name_prfx3, \n\text_lit_claim_party_name_sfx AS ext_lit_claim_party_name_sfx3, \n\text_lit_claim_party_addr AS ext_lit_claim_party_addr3, \n\text_lit_claim_party_city AS ext_lit_claim_party_city3, \n\text_lit_claim_party_county AS ext_lit_claim_party_county3, \n\text_lit_claim_party_state AS ext_lit_claim_party_state3, \n\text_lit_claim_party_zip AS ext_lit_claim_party_zip3, \n\text_lit_addr_type AS ext_lit_addr_type3, \n\to_defd_claim_party_id AS o_defd_claim_party_id3, \n\to_defd_claim_party_ak_id AS o_defd_claim_party_ak_id3, \n\to_defd_claim_party_full_Name AS o_defd_claim_party_full_Name3, \n\to_defd_claim_party_first_name AS o_defd_claim_party_first_name3, \n\to_defd_claim_party_last_name AS o_defd_claim_party_last_name3, \n\to_defd_claim_party_mid_name AS o_defd_claim_party_mid_name3, \n\to_defd_claim_party_name_prfx AS o_defd_claim_party_name_prfx3, \n\to_defd_claim_party_name_sfx AS o_defd_claim_party_name_sfx3, \n\to_plat_claim_party_id AS o_plat_claim_party_id3, \n\to_plat_claim_party_ak_id AS o_plat_claim_party_ak_id3, \n\to_plat_claim_party_full_name AS o_plat_claim_party_full_name3, \n\to_plat_claim_party_first_name AS o_plat_claim_party_first_name3, \n\to_plat_claim_party_last_name AS o_plat_claim_party_last_name3, \n\to_plat_claim_party_mid_name AS o_plat_claim_party_mid_name3, \n\to_plat_claim_party_name_prfx AS o_plat_claim_party_name_prfx3, \n\to_plat_claim_party_name_sfx AS o_plat_claim_party_name_sfx3, \n\tOUT_InjuredWorkerRepresentedFlag AS OUT_InjuredWorkerRepresentedFlag3\n\tFROM RTR_Insert_Update_Update\n),\nclaim_case_dim_update AS (\n\tMERGE INTO claim_case_dim AS T\n\tUSING UPD_Update AS S\n\tON T.claim_case_dim_id = S.claim_case_dim_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag3, T.audit_id = S.audit_id3, T.eff_from_date = S.eff_from_date3, T.eff_to_date = S.eff_to_date3, T.created_date = S.created_date3, T.modified_date = S.modified_date3, T.edw_claim_case_pk_id = S.claim_case_id, T.edw_claim_case_ak_id = S.claim_case_ak_id, T.edw_claim_party_pk_id_ext_litigation_handler = S.ext_lit_pk_id3, T.edw_claim_party_pk_id_plaintiff = S.o_plat_claim_party_id3, T.edw_claim_party_pk_id_defendant = S.o_defd_claim_party_id3, T.edw_claim_party_ak_id_ext_litigation_handler = S.ext_lit_ak_id3, T.edw_claim_party_ak_id_plaintiff = S.o_plat_claim_party_ak_id3, T.edw_claim_party_ak_id_defendant = S.o_defd_claim_party_ak_id3, T.claim_case_key = S.claim_case_key3, T.claim_case_name = S.claim_case_name3, T.claim_case_num = S.claim_case_num3, T.suit_county = S.suit_county3, T.suit_state = S.suit_state3, T.trial_date = S.trial_date3, T.first_notice_law_suit_ind = S.first_notice_law_suit_ind3, T.declaratory_action_ind = S.declaratory_action_ind3, T.suit_status_code = S.suit_status_code3, T.suit_status_code_descript = S.suit_status_code_desc3, T.suit_denial_date = S.suit_denial_date3, T.prim_litigation_handler_role_code = S.prim_litigation_handler_role_code3, T.prim_litigation_role_code_descript = S.prim_litigation_handler_role_code_desc3, T.suit_open_date = S.suit_open_date3, T.suit_close_date = S.suit_close_date3, T.suit_how_claim_closed = S.suit_how_claim_closed3, T.reins_reported_ind = S.reins_reported_ind3, T.commercl_umb_reserve = S.commercl_umb_reserve3, T.suit_pay_amt = S.suit_pay_amt3, T.arbitration_open_date = S.arbitration_open_date3, T.arbitration_close_date = S.arbitration_close_date3, T.demand_at_initial_litigation = S.demand_at_initial_litigation3, T.ext_litigation_handler_addr_type = S.ext_lit_addr_type3, T.ext_litigation_handler_zip = S.ext_lit_claim_party_zip3, T.ext_litigation_handler_state = S.ext_lit_claim_party_state3, T.ext_litigation_handler_county = S.ext_lit_claim_party_county3, T.ext_litigation_handler_city = S.ext_lit_claim_party_city3, T.ext_litigation_handler_addr = S.ext_lit_claim_party_addr3, T.ext_litigation_handler_full_name = S.ext_lit_claim_party_full_name3, T.ext_litigation_handler_first_name = S.ext_lit_claim_party_first_name3, T.ext_litigation_handler_last_name = S.ext_lit_claim_party_last_name3, T.ext_litigation_handler_mid_name = S.ext_lit_claim_party_mid_name3, T.ext_litigation_handler_name_prfx = S.ext_lit_claim_party_name_prfx3, T.ext_litigation_handler_name_sfx = S.ext_lit_claim_party_name_sfx3, T.plaintiff_full_name = S.o_plat_claim_party_full_name3, T.plaintiff_first_name = S.o_plat_claim_party_first_name3, T.plaintiff_last_name = S.o_plat_claim_party_last_name3, T.plaintiff_mid_name = S.o_plat_claim_party_mid_name3, T.plaintiff_name_prfx = S.o_plat_claim_party_name_prfx3, T.plaintiff_name_sfx = S.o_plat_claim_party_name_sfx3, T.defendant_full_name = S.o_defd_claim_party_full_Name3, T.defendant_first_name = S.o_defd_claim_party_first_name3, T.defendant_last_name = S.o_defd_claim_party_last_name3, T.defendant_mid_name = S.o_defd_claim_party_mid_name3, T.defendant_name_prfx = S.o_defd_claim_party_name_prfx3, T.defendant_name_sfx = S.o_defd_claim_party_name_sfx3, T.InjuredWorkerRepresentedFlag = S.OUT_InjuredWorkerRepresentedFlag3\n),\nSQ_claim_case_dim AS (\n\tSELECT \r\n\t  a.claim_case_dim_id\r\n\t, a.eff_from_date\r\n\t, a.eff_to_date\r\n\t, a.edw_claim_case_ak_id\r\n\tFROM\r\n\t @{pipeline().parameters.TARGET_TABLE_OWNER}.CLAIM_CASE_DIM A\r\n\tWHERE \r\n\tEXISTS\r\n\t(\r\n\tSELECT  1 FROM @{pipeline().parameters.TARGET_TABLE_OWNER}.CLAIM_CASE_DIM B\r\n\tWHERE CRRNT_SNPSHT_FLAG = 1 AND \r\n\tA.EDW_CLAIM_CASE_AK_ID =B.EDW_CLAIM_CASE_AK_ID\r\n\tGROUP BY B.EDW_CLAIM_CASE_AK_ID\r\n\tHAVING COUNT(*) > 1\r\n\t)\r\n\tORDER BY A.EDW_CLAIM_CASE_AK_ID ,A.EFF_FROM_DATE DESC\n),\nEXP_Source AS (\n\tSELECT\n\tclaim_case_dim_id,\n\tedw_claim_case_ak_id,\n\teff_from_date,\n\teff_to_date AS orig_eff_to_date,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \tedw_claim_case_ak_id=v_PREV_ROW_edw_claim_case_ak_id \r\n\t--  \t,ADD_TO_DATE(v_PREV_ROW_eff_from_date,'SS',-1)\r\n\t--        ,orig_eff_to_date)\r\n\t-- \r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    edw_claim_case_ak_id = v_PREV_ROW_edw_claim_case_ak_id, DATEADD(SECOND,- 1,v_PREV_ROW_eff_from_date),\n\t    orig_eff_to_date\n\t) AS v_eff_to_date,\n\tv_eff_to_date AS o_eff_to_date,\n\teff_from_date AS v_PREV_ROW_eff_from_date,\n\tedw_claim_case_ak_id AS v_PREV_ROW_edw_claim_case_ak_id,\n\tsysdate AS modified_date,\n\t0 AS crrnt_snpsht_flag\n\tFROM SQ_claim_case_dim\n),\nFLT_Source_Rows AS (\n\tSELECT\n\tclaim_case_dim_id, \n\torig_eff_to_date, \n\to_eff_to_date AS eff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM EXP_Source\n\tWHERE orig_eff_to_date <> eff_to_date\n),\nUpd_Update_Eff_Dates AS (\n\tSELECT\n\tclaim_case_dim_id, \n\teff_to_date, \n\tmodified_date, \n\tcrrnt_snpsht_flag\n\tFROM FLT_Source_Rows\n),\nclaim_case_dim_update_dates AS (\n\tMERGE INTO claim_case_dim AS T\n\tUSING Upd_Update_Eff_Dates AS S\n\tON T.claim_case_dim_id = S.claim_case_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.crrnt_snpsht_flag = S.crrnt_snpsht_flag, T.eff_to_date = S.eff_to_date, T.modified_date = S.modified_date\n),\nSQ_claim_case_dim_UPDATE_Question_Center_Fields AS (\n\tSELECT\n\t\tclaim_case_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_claim_case_pk_id,\n\t\tedw_claim_case_ak_id,\n\t\tedw_claim_party_pk_id_ext_litigation_handler,\n\t\tedw_claim_party_pk_id_plaintiff,\n\t\tedw_claim_party_pk_id_defendant,\n\t\tedw_claim_party_ak_id_ext_litigation_handler,\n\t\tedw_claim_party_ak_id_plaintiff,\n\t\tedw_claim_party_ak_id_defendant,\n\t\tclaim_case_key,\n\t\tclaim_case_name,\n\t\tclaim_case_num,\n\t\tsuit_county,\n\t\tsuit_state,\n\t\ttrial_date,\n\t\tfirst_notice_law_suit_ind,\n\t\tdeclaratory_action_ind,\n\t\tsuit_status_code,\n\t\tsuit_status_code_descript,\n\t\tsuit_denial_date,\n\t\tprim_litigation_handler_role_code,\n\t\tprim_litigation_role_code_descript,\n\t\tsuit_open_date,\n\t\tsuit_close_date,\n\t\tsuit_how_claim_closed,\n\t\treins_reported_ind,\n\t\tcommercl_umb_reserve,\n\t\tsuit_pay_amt,\n\t\tarbitration_open_date,\n\t\tarbitration_close_date,\n\t\tdemand_at_initial_litigation,\n\t\text_litigation_handler_addr_type,\n\t\text_litigation_handler_zip,\n\t\text_litigation_handler_state,\n\t\text_litigation_handler_county,\n\t\text_litigation_handler_city,\n\t\text_litigation_handler_addr,\n\t\text_litigation_handler_full_name,\n\t\text_litigation_handler_first_name,\n\t\text_litigation_handler_last_name,\n\t\text_litigation_handler_mid_name,\n\t\text_litigation_handler_name_prfx,\n\t\text_litigation_handler_name_sfx,\n\t\tplaintiff_full_name,\n\t\tplaintiff_first_name,\n\t\tplaintiff_last_name,\n\t\tplaintiff_mid_name,\n\t\tplaintiff_name_prfx,\n\t\tplaintiff_name_sfx,\n\t\tdefendant_full_name,\n\t\tdefendant_first_name,\n\t\tdefendant_last_name,\n\t\tdefendant_mid_name,\n\t\tdefendant_name_prfx,\n\t\tdefendant_name_sfx,\n\t\tInjuredWorkerRepresentedFlag\n\tFROM claim_case_dim_UPDATE_Question_Center_Fields\n\tWHERE claim_case_dim.crrnt_snpsht_flag=1\n),\nEXP_Input_for_QuestionCenter_InjuredPartyRep_Updates AS (\n\tSELECT\n\tclaim_case_dim_id,\n\tedw_claim_case_ak_id\n\tFROM SQ_claim_case_dim_UPDATE_Question_Center_Fields\n),\nLKP_Question_Center_IsInjuredPartyRepresented AS (\n\tSELECT\n\tclaim_case_ak_id,\n\tclaim_occurrence_ak_id,\n\tclaim_party_occurrence_ak_id,\n\toptn_text,\n\tIN_claim_case_ak_id,\n\tIN_claim_case_dim_id\n\tFROM (\n\t\tSelect \r\n\t\tCPO.claim_case_ak_id as claim_case_ak_id,\r\n\t\tCO.claim_occurrence_ak_id as claim_occurrence_ak_id ,\r\n\t\tCPO.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id ,\r\n\t\trtrim(ltrim(CA.optn_text)) as optn_text\r\n\t\tFrom\r\n\t\tclaim_party_occurrence CPO\r\n\t\tinner join claim_answer CA\r\n\t\ton CA.claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id\r\n\t\tinner join claim_occurrence CO \r\n\t\ton CA.claim_occurrence_ak_id = CO.claim_occurrence_ak_id\r\n\t\tinner join question Q\r\n\t\ton Q.question_ak_id = CA.question_ak_id\r\n\t\tinner join application_context AC\r\n\t\ton Q.app_context_ak_id = AC.app_context_ak_id\r\n\t\tinner join [application] APP\r\n\t\ton AC.app_ak_id = APP.app_ak_id\r\n\t\tWhere \r\n\t\tAPP.display_name = 'Claims Workers Compensation' AND\r\n\t\tAC.app_context_entity_name = 'Claimant.Litigation.Questions' AND\r\n\t\tQ.logical_name = 'WasInjuredWorkerRepresented' and\r\n\t\tRTRIM(CPO.claim_party_role_code) in ('CLMT', 'CMT') and\r\n\t\tCO.crrnt_snpsht_flag = 1 and\r\n\t\tCPO.crrnt_snpsht_flag = 1 and\r\n\t\tAPP.crrnt_snpsht_flag=1 and\r\n\t\tAC.crrnt_snpsht_flag =1 and\r\n\t\tQ.crrnt_snpsht_flag = 1 and\r\n\t\tCA.crrnt_snpsht_flag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id ORDER BY claim_case_ak_id DESC) = 1\n),\nFILTRANS AS (\n\tSELECT\n\tIN_claim_case_dim_id AS claim_case_dim_id, \n\toptn_text\n\tFROM LKP_Question_Center_IsInjuredPartyRepresented\n\tWHERE NOT ISNULL(optn_text)\n),\nUPD_InjuredWorkerRep_update AS (\n\tSELECT\n\tclaim_case_dim_id, \n\toptn_text\n\tFROM FILTRANS\n),\nclaim_case_dim_UPDATE_Question_Center_InjWorkerRep AS (\n\tMERGE INTO claim_case_dim AS T\n\tUSING UPD_InjuredWorkerRep_update AS S\n\tON T.claim_case_dim_id = S.claim_case_dim_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.InjuredWorkerRepresentedFlag = S.optn_text\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Claims DataMart/"
        },
        "annotations": []
    }
}