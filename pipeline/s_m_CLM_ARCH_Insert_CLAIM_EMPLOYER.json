{
    "name": "s_m_CLM_ARCH_Insert_CLAIM_EMPLOYER",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_CLAIM_EMPLOYER",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CLAIM_EMPLOYER_STAGE1 AS (\n\tSELECT CLAIM_EMPLOYER_STAGE.CLAIM_EMPLOYER_ID, CLAIM_EMPLOYER_STAGE.CEI_CLAIM_NBR, CLAIM_EMPLOYER_STAGE.CEI_EPR_SEQ_NBR, CLAIM_EMPLOYER_STAGE.CEI_EPR_CLT_ID, CLAIM_EMPLOYER_STAGE.CEI_PRI_EPR_CD, CLAIM_EMPLOYER_STAGE.CEI_JOB_TLE_ID, CLAIM_EMPLOYER_STAGE.CEI_TYPE_LABOR_CD, CLAIM_EMPLOYER_STAGE.CEI_WAGE_RT_AMT, CLAIM_EMPLOYER_STAGE.CEI_WAGE_BASIS_CD, CLAIM_EMPLOYER_STAGE.CEI_AVG_WKLY_AMT, CLAIM_EMPLOYER_STAGE.CEI_WKLY_CPS_AMT, CLAIM_EMPLOYER_STAGE.CEI_LOS_TM_JOB_IND, CLAIM_EMPLOYER_STAGE.CEI_WAGE_REQ_DT, CLAIM_EMPLOYER_STAGE.CEI_WAGE_REC_DT, CLAIM_EMPLOYER_STAGE.CEI_ENTRY_OPR_ID, CLAIM_EMPLOYER_STAGE.CEI_UPDATE_OPR_ID, CLAIM_EMPLOYER_STAGE.CEI_CREATE_TS, CLAIM_EMPLOYER_STAGE.CEI_UPD_TS, CLAIM_EMPLOYER_STAGE.CEI_PMSD_TS, CLAIM_EMPLOYER_STAGE.CEI_SPV_CLT_NM_TXT, CLAIM_EMPLOYER_STAGE.CEI_PREINJ_WAGE_CD, CLAIM_EMPLOYER_STAGE.CEI_OCCUPATION_CD, CLAIM_EMPLOYER_STAGE.CEI_EMP_ID_NBR, CLAIM_EMPLOYER_STAGE.CEI_EMP_ID_TYPE_CD, CLAIM_EMPLOYER_STAGE.CEI_FTEMP_SAME_JOB, CLAIM_EMPLOYER_STAGE.CEI_PTEMP_SAME_JOB, CLAIM_EMPLOYER_STAGE.CEI_AVG_FT_HOURS, CLAIM_EMPLOYER_STAGE.CEI_AVG_FT_HOUR_WK, CLAIM_EMPLOYER_STAGE.CEI_AVG_FT_DAY_WK, CLAIM_EMPLOYER_STAGE.CEI_CLIENT_ID, CLAIM_EMPLOYER_STAGE.EXTRACT_DATE, CLAIM_EMPLOYER_STAGE.AS_OF_DATE, CLAIM_EMPLOYER_STAGE.RECORD_COUNT, CLAIM_EMPLOYER_STAGE.SOURCE_SYSTEM_ID \r\n\tFROM\r\n\t CLAIM_EMPLOYER_STAGE\r\n\tWHERE\r\n\tCLAIM_EMPLOYER_STAGE.CEI_CREATE_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tOR\r\n\tCLAIM_EMPLOYER_STAGE.CEI_UPD_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_CLAIM_EMPLOYER_STAGE AS (\n\tSELECT\n\tCLAIM_EMPLOYER_ID,\n\tCEI_CLAIM_NBR,\n\tCEI_EPR_SEQ_NBR,\n\tCEI_EPR_CLT_ID,\n\tCEI_PRI_EPR_CD,\n\tCEI_JOB_TLE_ID,\n\tCEI_TYPE_LABOR_CD,\n\tCEI_WAGE_RT_AMT,\n\tCEI_WAGE_BASIS_CD,\n\tCEI_AVG_WKLY_AMT,\n\tCEI_WKLY_CPS_AMT,\n\tCEI_LOS_TM_JOB_IND,\n\tCEI_WAGE_REQ_DT,\n\tCEI_WAGE_REC_DT,\n\tCEI_ENTRY_OPR_ID,\n\tCEI_UPDATE_OPR_ID,\n\tCEI_CREATE_TS,\n\tCEI_UPD_TS,\n\tCEI_PMSD_TS,\n\tCEI_SPV_CLT_NM_TXT,\n\tCEI_PREINJ_WAGE_CD,\n\tCEI_OCCUPATION_CD,\n\tCEI_EMP_ID_NBR,\n\tCEI_EMP_ID_TYPE_CD,\n\tCEI_FTEMP_SAME_JOB,\n\tCEI_PTEMP_SAME_JOB,\n\tCEI_AVG_FT_HOURS,\n\tCEI_AVG_FT_HOUR_WK,\n\tCEI_AVG_FT_DAY_WK,\n\tCEI_CLIENT_ID,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_CLAIM_EMPLOYER_STAGE1\n),\nARCH_CLAIM_EMPLOYER_STAGE AS (\n\tINSERT INTO ARCH_CLAIM_EMPLOYER_STAGE\n\t(CLAIM_EMPLOYER_ID, CEI_CLAIM_NBR, CEI_EPR_SEQ_NBR, CEI_EPR_CLT_ID, CEI_PRI_EPR_CD, CEI_JOB_TLE_ID, CEI_TYPE_LABOR_CD, CEI_WAGE_RT_AMT, CEI_WAGE_BASIS_CD, CEI_AVG_WKLY_AMT, CEI_WKLY_CPS_AMT, CEI_LOS_TM_JOB_IND, CEI_WAGE_REQ_DT, CEI_WAGE_REC_DT, CEI_ENTRY_OPR_ID, CEI_UPDATE_OPR_ID, CEI_CREATE_TS, CEI_UPD_TS, CEI_PMSD_TS, CEI_SPV_CLT_NM_TXT, CEI_PREINJ_WAGE_CD, CEI_OCCUPATION_CD, CEI_EMP_ID_NBR, CEI_EMP_ID_TYPE_CD, CEI_FTEMP_SAME_JOB, CEI_PTEMP_SAME_JOB, CEI_AVG_FT_HOURS, CEI_AVG_FT_HOUR_WK, CEI_AVG_FT_DAY_WK, CEI_CLIENT_ID, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)\n\tSELECT \n\tCLAIM_EMPLOYER_ID, \n\tCEI_CLAIM_NBR, \n\tCEI_EPR_SEQ_NBR, \n\tCEI_EPR_CLT_ID, \n\tCEI_PRI_EPR_CD, \n\tCEI_JOB_TLE_ID, \n\tCEI_TYPE_LABOR_CD, \n\tCEI_WAGE_RT_AMT, \n\tCEI_WAGE_BASIS_CD, \n\tCEI_AVG_WKLY_AMT, \n\tCEI_WKLY_CPS_AMT, \n\tCEI_LOS_TM_JOB_IND, \n\tCEI_WAGE_REQ_DT, \n\tCEI_WAGE_REC_DT, \n\tCEI_ENTRY_OPR_ID, \n\tCEI_UPDATE_OPR_ID, \n\tCEI_CREATE_TS, \n\tCEI_UPD_TS, \n\tCEI_PMSD_TS, \n\tCEI_SPV_CLT_NM_TXT, \n\tCEI_PREINJ_WAGE_CD, \n\tCEI_OCCUPATION_CD, \n\tCEI_EMP_ID_NBR, \n\tCEI_EMP_ID_TYPE_CD, \n\tCEI_FTEMP_SAME_JOB, \n\tCEI_PTEMP_SAME_JOB, \n\tCEI_AVG_FT_HOURS, \n\tCEI_AVG_FT_HOUR_WK, \n\tCEI_AVG_FT_DAY_WK, \n\tCEI_CLIENT_ID, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_CLAIM_EMPLOYER_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}