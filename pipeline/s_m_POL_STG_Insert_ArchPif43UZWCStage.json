{
    "name": "s_m_POL_STG_Insert_ArchPif43UZWCStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_ArchPif43UZWCStage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif43UZWCStage AS (\n\tSELECT\n\t\tPif43UZWCStageId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifPolicyModule,\n\t\tPMDU4W1RecLength,\n\t\tPMDU4W1ActionCode,\n\t\tPMDU4W1FileID,\n\t\tPMDU4W1SegmentID,\n\t\tPMDU4W1SegmentStatus,\n\t\tPMDU4W1YearTransaction,\n\t\tPMDU4W1MonthTransaction,\n\t\tPMDU4W1DayTransaction,\n\t\tPMDU4W1SegmentLevelCode,\n\t\tPMDU4W1SegmentPartCode,\n\t\tPMDU4W1SubPartCode,\n\t\tPMDU4W1InsuranceLine,\n\t\tPMDU4W1WCRatingState,\n\t\tPMDU4W1LocationNumber,\n\t\tPMDU4W1ClassCode,\n\t\tPMDU4W1ClassCodeSeq,\n\t\tPMDU4W1SplitRateSeq,\n\t\tPMDU4W1YearItemEffective,\n\t\tPMDU4W1MonthItemEffective,\n\t\tPMDU4W1DayItemEffective,\n\t\tPMDU4W1AuditNumber,\n\t\tPMDU4W1AuditNumSeq,\n\t\tPMDU4W1YearProcess,\n\t\tPMDU4W1MonthProcess,\n\t\tPMDU4W1DayProcess,\n\t\tPMDU4W1YearItemExpire,\n\t\tPMDU4W1MonthItemExpire,\n\t\tPMDU4W1DayItemExpire,\n\t\tPMDU4W1ClassTableFlag,\n\t\tPMDU4W1ClassCodeSuffix1,\n\t\tPMDU4W1ClassCodeSuffix2,\n\t\tPMDU4W1PremiumBasisTyp,\n\t\tPMDU4W1PremiumBasisAmt,\n\t\tPMDU4W1GovernClassInd,\n\t\tPMDU4W1Rate,\n\t\tPMDU4W1RateMgInd,\n\t\tPMDU4W1ClassTermPrem,\n\t\tPMDU4W1ClassTermPrmMgInd,\n\t\tPMDU4W1ClassDescInd,\n\t\tPMDU4W1ClassDesc1St8Bytes,\n\t\tPMDU4W1ClassDescRemainder,\n\t\tPMDU4W1SicCode,\n\t\tPMDU4W1ClassDescFlag,\n\t\tPMDU4W1MinimumPremium,\n\t\tPMDU4W1MinPrmMgInd,\n\t\tPMDU4W1SurchargeAmt,\n\t\tPMDU4W1SurchargeType,\n\t\tPMDU4W1WaverPct,\n\t\tPMDU4W1WaverPctMgInd,\n\t\tPMDU4W1WaverType1,\n\t\tPMDU4W1WaiverType2,\n\t\tPMDU4W1WaivTypeMgInd,\n\t\tPMDU4W1ExposureCoverageCode1,\n\t\tPMDU4W1ExposureCoverageCode2,\n\t\tPMDU4W1ExposCodeMgInd,\n\t\tPMDU4W1SeasonalRiskInd,\n\t\tPMDU4W1LossConstant,\n\t\tPMDU4W1HazardGroup,\n\t\tPMDU4W1DepositPremium,\n\t\tPMDU4W1TaxLocation,\n\t\tPMDU4W1WaiverPremium,\n\t\tPMDU4W1SurchargePremium,\n\t\tPMDU4W1AuditSegBuiltInd,\n\t\tPMDU4W1YearRatingExpire,\n\t\tPMDU4W1MonthRatingExpire,\n\t\tPMDU4W1DayRatingExpire,\n\t\tPMDU4W1ManuallyRatedInd,\n\t\tPMDU4W1YearAnnRateDate,\n\t\tPMDU4W1MonthAnnRateDate,\n\t\tPMDU4W1DayAnnRateDate,\n\t\tPMDU4W1BureauRate,\n\t\tPMDU4W1ARatedIndicator,\n\t\tPMDU4W1PmsFutureUse,\n\t\tPMDU4W1PolicyFullMinPrem,\n\t\tPMDU4W1CustomerFutureUse,\n\t\tPMDU4W1Yr2000CustUse,\n\t\textract_date,\n\t\tsource_system_id\n\tFROM Pif43UZWCStage\n),\nEXP_ArchPif43UZWCStage AS (\n\tSELECT\n\tPif43UZWCStageId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifPolicyModule,\n\tPMDU4W1RecLength,\n\tPMDU4W1ActionCode,\n\tPMDU4W1FileID,\n\tPMDU4W1SegmentID,\n\tPMDU4W1SegmentStatus,\n\tPMDU4W1YearTransaction,\n\tPMDU4W1MonthTransaction,\n\tPMDU4W1DayTransaction,\n\tPMDU4W1SegmentLevelCode,\n\tPMDU4W1SegmentPartCode,\n\tPMDU4W1SubPartCode,\n\tPMDU4W1InsuranceLine,\n\tPMDU4W1WCRatingState,\n\tPMDU4W1LocationNumber,\n\tPMDU4W1ClassCode,\n\tPMDU4W1ClassCodeSeq,\n\tPMDU4W1SplitRateSeq,\n\tPMDU4W1YearItemEffective,\n\tPMDU4W1MonthItemEffective,\n\tPMDU4W1DayItemEffective,\n\tPMDU4W1AuditNumber,\n\tPMDU4W1AuditNumSeq,\n\tPMDU4W1YearProcess,\n\tPMDU4W1MonthProcess,\n\tPMDU4W1DayProcess,\n\tPMDU4W1YearItemExpire,\n\tPMDU4W1MonthItemExpire,\n\tPMDU4W1DayItemExpire,\n\tPMDU4W1ClassTableFlag,\n\tPMDU4W1ClassCodeSuffix1,\n\tPMDU4W1ClassCodeSuffix2,\n\tPMDU4W1PremiumBasisTyp,\n\tPMDU4W1PremiumBasisAmt,\n\tPMDU4W1GovernClassInd,\n\tPMDU4W1Rate,\n\tPMDU4W1RateMgInd,\n\tPMDU4W1ClassTermPrem,\n\tPMDU4W1ClassTermPrmMgInd,\n\tPMDU4W1ClassDescInd,\n\tPMDU4W1ClassDesc1St8Bytes,\n\tPMDU4W1ClassDescRemainder,\n\tPMDU4W1SicCode,\n\tPMDU4W1ClassDescFlag,\n\tPMDU4W1MinimumPremium,\n\tPMDU4W1MinPrmMgInd,\n\tPMDU4W1SurchargeAmt,\n\tPMDU4W1SurchargeType,\n\tPMDU4W1WaverPct,\n\tPMDU4W1WaverPctMgInd,\n\tPMDU4W1WaverType1,\n\tPMDU4W1WaiverType2,\n\tPMDU4W1WaivTypeMgInd,\n\tPMDU4W1ExposureCoverageCode1,\n\tPMDU4W1ExposureCoverageCode2,\n\tPMDU4W1ExposCodeMgInd,\n\tPMDU4W1SeasonalRiskInd,\n\tPMDU4W1LossConstant,\n\tPMDU4W1HazardGroup,\n\tPMDU4W1DepositPremium,\n\tPMDU4W1TaxLocation,\n\tPMDU4W1WaiverPremium,\n\tPMDU4W1SurchargePremium,\n\tPMDU4W1AuditSegBuiltInd,\n\tPMDU4W1YearRatingExpire,\n\tPMDU4W1MonthRatingExpire,\n\tPMDU4W1DayRatingExpire,\n\tPMDU4W1ManuallyRatedInd,\n\tPMDU4W1YearAnnRateDate,\n\tPMDU4W1MonthAnnRateDate,\n\tPMDU4W1DayAnnRateDate,\n\tPMDU4W1BureauRate,\n\tPMDU4W1ARatedIndicator,\n\tPMDU4W1PmsFutureUse,\n\tPMDU4W1PolicyFullMinPrem,\n\tPMDU4W1CustomerFutureUse,\n\tPMDU4W1Yr2000CustUse,\n\textract_date,\n\tsource_system_id,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_auditid\n\tFROM SQ_Pif43UZWCStage\n),\nArchPif43UZWCStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UZWCStage\n\t(Pif43UZWCStageId, PifSymbol, PifPolicyNumber, PifPolicyModule, PMDU4W1RecLength, PMDU4W1ActionCode, PMDU4W1FileID, PMDU4W1SegmentID, PMDU4W1SegmentStatus, PMDU4W1YearTransaction, PMDU4W1MonthTransaction, PMDU4W1DayTransaction, PMDU4W1SegmentLevelCode, PMDU4W1SegmentPartCode, PMDU4W1SubPartCode, PMDU4W1InsuranceLine, PMDU4W1WCRatingState, PMDU4W1LocationNumber, PMDU4W1ClassCode, PMDU4W1ClassCodeSeq, PMDU4W1SplitRateSeq, PMDU4W1YearItemEffective, PMDU4W1MonthItemEffective, PMDU4W1DayItemEffective, PMDU4W1AuditNumber, PMDU4W1AuditNumSeq, PMDU4W1YearProcess, PMDU4W1MonthProcess, PMDU4W1DayProcess, PMDU4W1YearItemExpire, PMDU4W1MonthItemExpire, PMDU4W1DayItemExpire, PMDU4W1ClassTableFlag, PMDU4W1ClassCodeSuffix1, PMDU4W1ClassCodeSuffix2, PMDU4W1PremiumBasisTyp, PMDU4W1PremiumBasisAmt, PMDU4W1GovernClassInd, PMDU4W1Rate, PMDU4W1RateMgInd, PMDU4W1ClassTermPrem, PMDU4W1ClassTermPrmMgInd, PMDU4W1ClassDescInd, PMDU4W1ClassDesc1St8Bytes, PMDU4W1ClassDescRemainder, PMDU4W1SicCode, PMDU4W1ClassDescFlag, PMDU4W1MinimumPremium, PMDU4W1MinPrmMgInd, PMDU4W1SurchargeAmt, PMDU4W1SurchargeType, PMDU4W1WaverPct, PMDU4W1WaverPctMgInd, PMDU4W1WaverType1, PMDU4W1WaiverType2, PMDU4W1WaivTypeMgInd, PMDU4W1ExposureCoverageCode1, PMDU4W1ExposureCoverageCode2, PMDU4W1ExposCodeMgInd, PMDU4W1SeasonalRiskInd, PMDU4W1LossConstant, PMDU4W1HazardGroup, PMDU4W1DepositPremium, PMDU4W1TaxLocation, PMDU4W1WaiverPremium, PMDU4W1SurchargePremium, PMDU4W1AuditSegBuiltInd, PMDU4W1YearRatingExpire, PMDU4W1MonthRatingExpire, PMDU4W1DayRatingExpire, PMDU4W1ManuallyRatedInd, PMDU4W1YearAnnRateDate, PMDU4W1MonthAnnRateDate, PMDU4W1DayAnnRateDate, PMDU4W1BureauRate, PMDU4W1ARatedIndicator, PMDU4W1PmsFutureUse, PMDU4W1PolicyFullMinPrem, PMDU4W1CustomerFutureUse, PMDU4W1Yr2000CustUse, extract_date, source_system_id, audit_id)\n\tSELECT \n\tPIF43UZWCSTAGEID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFPOLICYMODULE, \n\tPMDU4W1RECLENGTH, \n\tPMDU4W1ACTIONCODE, \n\tPMDU4W1FILEID, \n\tPMDU4W1SEGMENTID, \n\tPMDU4W1SEGMENTSTATUS, \n\tPMDU4W1YEARTRANSACTION, \n\tPMDU4W1MONTHTRANSACTION, \n\tPMDU4W1DAYTRANSACTION, \n\tPMDU4W1SEGMENTLEVELCODE, \n\tPMDU4W1SEGMENTPARTCODE, \n\tPMDU4W1SUBPARTCODE, \n\tPMDU4W1INSURANCELINE, \n\tPMDU4W1WCRATINGSTATE, \n\tPMDU4W1LOCATIONNUMBER, \n\tPMDU4W1CLASSCODE, \n\tPMDU4W1CLASSCODESEQ, \n\tPMDU4W1SPLITRATESEQ, \n\tPMDU4W1YEARITEMEFFECTIVE, \n\tPMDU4W1MONTHITEMEFFECTIVE, \n\tPMDU4W1DAYITEMEFFECTIVE, \n\tPMDU4W1AUDITNUMBER, \n\tPMDU4W1AUDITNUMSEQ, \n\tPMDU4W1YEARPROCESS, \n\tPMDU4W1MONTHPROCESS, \n\tPMDU4W1DAYPROCESS, \n\tPMDU4W1YEARITEMEXPIRE, \n\tPMDU4W1MONTHITEMEXPIRE, \n\tPMDU4W1DAYITEMEXPIRE, \n\tPMDU4W1CLASSTABLEFLAG, \n\tPMDU4W1CLASSCODESUFFIX1, \n\tPMDU4W1CLASSCODESUFFIX2, \n\tPMDU4W1PREMIUMBASISTYP, \n\tPMDU4W1PREMIUMBASISAMT, \n\tPMDU4W1GOVERNCLASSIND, \n\tPMDU4W1RATE, \n\tPMDU4W1RATEMGIND, \n\tPMDU4W1CLASSTERMPREM, \n\tPMDU4W1CLASSTERMPRMMGIND, \n\tPMDU4W1CLASSDESCIND, \n\tPMDU4W1CLASSDESC1ST8BYTES, \n\tPMDU4W1CLASSDESCREMAINDER, \n\tPMDU4W1SICCODE, \n\tPMDU4W1CLASSDESCFLAG, \n\tPMDU4W1MINIMUMPREMIUM, \n\tPMDU4W1MINPRMMGIND, \n\tPMDU4W1SURCHARGEAMT, \n\tPMDU4W1SURCHARGETYPE, \n\tPMDU4W1WAVERPCT, \n\tPMDU4W1WAVERPCTMGIND, \n\tPMDU4W1WAVERTYPE1, \n\tPMDU4W1WAIVERTYPE2, \n\tPMDU4W1WAIVTYPEMGIND, \n\tPMDU4W1EXPOSURECOVERAGECODE1, \n\tPMDU4W1EXPOSURECOVERAGECODE2, \n\tPMDU4W1EXPOSCODEMGIND, \n\tPMDU4W1SEASONALRISKIND, \n\tPMDU4W1LOSSCONSTANT, \n\tPMDU4W1HAZARDGROUP, \n\tPMDU4W1DEPOSITPREMIUM, \n\tPMDU4W1TAXLOCATION, \n\tPMDU4W1WAIVERPREMIUM, \n\tPMDU4W1SURCHARGEPREMIUM, \n\tPMDU4W1AUDITSEGBUILTIND, \n\tPMDU4W1YEARRATINGEXPIRE, \n\tPMDU4W1MONTHRATINGEXPIRE, \n\tPMDU4W1DAYRATINGEXPIRE, \n\tPMDU4W1MANUALLYRATEDIND, \n\tPMDU4W1YEARANNRATEDATE, \n\tPMDU4W1MONTHANNRATEDATE, \n\tPMDU4W1DAYANNRATEDATE, \n\tPMDU4W1BUREAURATE, \n\tPMDU4W1ARATEDINDICATOR, \n\tPMDU4W1PMSFUTUREUSE, \n\tPMDU4W1POLICYFULLMINPREM, \n\tPMDU4W1CUSTOMERFUTUREUSE, \n\tPMDU4W1YR2000CUSTUSE, \n\tEXTRACT_DATE, \n\tSOURCE_SYSTEM_ID, \n\to_auditid AS AUDIT_ID\n\tFROM EXP_ArchPif43UZWCStage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}