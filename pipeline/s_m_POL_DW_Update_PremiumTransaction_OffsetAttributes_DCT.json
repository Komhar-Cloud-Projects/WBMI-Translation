{
    "name": "s_m_POL_DW_Update_PremiumTransaction_OffsetAttributes_DCT",
    "properties": {
        "activities": [
            {
                "name": "m_POL_DW_Update_PremiumTransaction_OffsetAttributes_DCT",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PremiumTransaction_Offset AS (\n\tSELECT ptToUpdate.PremiumTransactionID,\r\n\t\tptToUpdate.EffectiveDate,\r\n\t\tptToUpdate.ReasonAmendedCode,\r\n\t\tptToUpdate.PremiumTransactionExpirationDate,\r\n\t\tptToUpdate.DeductibleAmount,\r\n\t\tptToUpdate.ExperienceModificationFactor,\r\n\t\tptToUpdate.ExperienceModificationEffectiveDate,\r\n\t\tptToUpdate.PackageModificationAdjustmentFactor,\r\n\t\tptToUpdate.PackageModificationAdjustmentGroupCode,\r\n\t\tptToUpdate.IncreasedLimitFactor,\r\n\t\tptToUpdate.IncreasedLimitGroupCode,\r\n\t\tptToUpdate.YearBuilt,\r\n\t\tptToUpdate.BaseRate,\r\n\t\tptToUpdate.ConstructionCode,\r\n\t\tptToUpdate.IndividualRiskPremiumModification,\r\n\t\tptToUpdate.StateRatingEffectiveDate,\r\n\t\tptToUpdate.WindCoverageFlag,\r\n\t\tptToUpdate.DeductibleBasis,\r\n\t\tptToUpdate.ExposureBasis,\r\n\t\tptToUpdate.ServiceCentreName,\r\n\t\tptToUpdate.NumberOfEmployee,\r\n\t\tptAttrValues.EffectiveDate,\r\n\t\tptAttrValues.ReasonAmendedCode,\r\n\t\tptAttrValues.PremiumTransactionExpirationDate,\r\n\t\tptAttrValues.DeductibleAmount,\r\n\t\tptAttrValues.ExperienceModificationFactor,\r\n\t\tptAttrValues.ExperienceModificationEffectiveDate,\r\n\t\tptAttrValues.PackageModificationAdjustmentFactor,\r\n\t\tptAttrValues.PackageModificationAdjustmentGroupCode,\r\n\t\tptAttrValues.IncreasedLimitFactor,\r\n\t\tptAttrValues.IncreasedLimitGroupCode,\r\n\t\tptAttrValues.YearBuilt,\r\n\t\tptAttrValues.BaseRate,\r\n\t\tptAttrValues.ConstructionCode,\r\n\t\tptAttrValues.IndividualRiskPremiumModification,\r\n\t\tptAttrValues.StateRatingEffectiveDate,\r\n\t\tptAttrValues.WindCoverageFlag,\r\n\t\tptAttrValues.DeductibleBasis,\r\n\t\tptAttrValues.ExposureBasis,\r\n\t\tptAttrValues.ServiceCentreName,\r\n\t\tptAttrValues.NumberOfEmployee\r\n\tFROM WorkPremiumTransactionOffsetLineage wptol \r\n\tINNER JOIN PremiumTransaction ptToUpdate ON wptol.PremiumTransactionID = ptToUpdate.PremiumTransactionID\r\n\tINNER JOIN PremiumTransaction ptAttrValues ON wptol.PreviousPremiumTransactionID = ptAttrValues.PremiumTransactionID\r\n\tWHERE wptol.UpdateAttributeFlag = 1 \r\n\tAND ptToUpdate.OffsetOnsetCode = 'Offset' and ptToUpdate.AuditId=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} \r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_offset_PTUpdate_attributes AS (\n\tSELECT\n\tptToUpdate_PremiumTransactionID AS PremiumTransactionID,\n\tptToUpdate_EffectiveDate,\n\tptToUpdate_ReasonAmendedCode,\n\tptToUpdate_PremiumTransactionExpirationDate,\n\tptToUpdate_DeductibleAmount,\n\tptToUpdate_ExperienceModificationFactor,\n\tptToUpdate_ExperienceModificationEffectiveDate,\n\tptToUpdate_PackageModificationAdjustmentFactor,\n\tptToUpdate_PackageModificationAdjustmentGroupCode,\n\tptToUpdate_IncreasedLimitFactor,\n\tptToUpdate_IncreasedLimitGroupCode,\n\tptToUpdate_YearBuilt,\n\tptToUpdate_BaseRate,\n\tptToUpdate_ConstructionCode,\n\tptToUpdate_IndividualRiskPremiumModification,\n\tptToUpdate_StateRatingEffectiveDate,\n\tptToUpdate_WindCoverageFlag,\n\tptToUpdate_DeductibleBasis,\n\tptToUpdate_ExposureBasis,\n\tptToUpdate_ServiceCentreName,\n\tptToUpdate_NumberOfEmployee,\n\tptAttrValues_EffectiveDate,\n\tptAttrValues_PremiumTransactionExpirationDate,\n\tptAttrValues_ReasonAmendedCode,\n\tptAttrValues_DeductibleAmount,\n\tptAttrValues_ExperienceModificationFactor,\n\tptAttrValues_ExperienceModificationEffectiveDate,\n\tptAttrValues_PackageModificationAdjustmentFactor,\n\tptAttrValues_PackageModificationAdjustmentGroupCode,\n\tptAttrValues_IncreasedLimitFactor,\n\tptAttrValues_IncreasedLimitGroupCode,\n\tptAttrValues_YearBuilt,\n\tptAttrValues_BaseRate,\n\tptAttrValues_ConstructionCode,\n\tptAttrValues_IndividualRiskPremiumModification,\n\tptAttrValues_StateRatingEffectiveDate,\n\tptAttrValues_WindCoverageFlag,\n\tptAttrValues_DeductibleBasis,\n\tptAttrValues_ExposureBasis,\n\tptAttrValues_ServiceCentreName,\n\tptAttrValues_NumberOfEmployee,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \t(ptToUpdate_EffectiveDate != ptAttrValues_EffectiveDate or\r\n\t-- \tptToUpdate_ReasonAmendedCode != ptAttrValues_ReasonAmendedCode or\r\n\t-- \tptToUpdate_PremiumTransactionExpirationDate != ptAttrValues_PremiumTransactionExpirationDate or\r\n\t-- \tptToUpdate_DeductibleAmount != ptAttrValues_DeductibleAmount or\r\n\t-- \tptToUpdate_ExperienceModificationFactor != ptAttrValues_ExperienceModificationFactor or\r\n\t-- \tptToUpdate_ExperienceModificationEffectiveDate != ptAttrValues_ExperienceModificationEffectiveDate or\r\n\t-- \tptToUpdate_PackageModificationAdjustmentFactor != ptAttrValues_PackageModificationAdjustmentFactor or\r\n\t-- \tptToUpdate_PackageModificationAdjustmentGroupCode != ptAttrValues_PackageModificationAdjustmentGroupCode or\r\n\t-- \tptToUpdate_IncreasedLimitFactor != ptAttrValues_IncreasedLimitFactor or\r\n\t-- \tptToUpdate_IncreasedLimitGroupCode != ptAttrValues_IncreasedLimitGroupCode or\r\n\t-- \tptToUpdate_YearBuilt != ptAttrValues_YearBuilt  or\r\n\t-- \tptToUpdate_BaseRate != ptAttrValues_BaseRate or\r\n\t-- \tptToUpdate_ConstructionCode != ptAttrValues_ConstructionCode or\r\n\t-- \tptToUpdate_IndividualRiskPremiumModification != ptAttrValues_IndividualRiskPremiumModification or \r\n\t-- \tptToUpdate_StateRatingEffectiveDate != ptAttrValues_StateRatingEffectiveDate or\r\n\t-- \tptToUpdate_WindCoverageFlag != ptAttrValues_WindCoverageFlag or\r\n\t-- \tptToUpdate_DeductibleBasis != ptAttrValues_DeductibleBasis or\r\n\t-- \tptToUpdate_ExposureBasis != ptAttrValues_ExposureBasis or\r\n\t-- \tptToUpdate_ServiceCentreName != ptAttrValues_ServiceCentreName or\r\n\t-- \tptToUpdate_NumberOfEmployee != ptAttrValues_NumberOfEmployee),\r\n\t-- \t\t'UPD',\r\n\t-- \t'NOCHANGE')\n\tDECODE(TRUE,\n\t\t( ptToUpdate_EffectiveDate != ptAttrValues_EffectiveDate \n\t\t\tOR ptToUpdate_ReasonAmendedCode != ptAttrValues_ReasonAmendedCode \n\t\t\tOR ptToUpdate_PremiumTransactionExpirationDate != ptAttrValues_PremiumTransactionExpirationDate \n\t\t\tOR ptToUpdate_DeductibleAmount != ptAttrValues_DeductibleAmount \n\t\t\tOR ptToUpdate_ExperienceModificationFactor != ptAttrValues_ExperienceModificationFactor \n\t\t\tOR ptToUpdate_ExperienceModificationEffectiveDate != ptAttrValues_ExperienceModificationEffectiveDate \n\t\t\tOR ptToUpdate_PackageModificationAdjustmentFactor != ptAttrValues_PackageModificationAdjustmentFactor \n\t\t\tOR ptToUpdate_PackageModificationAdjustmentGroupCode != ptAttrValues_PackageModificationAdjustmentGroupCode \n\t\t\tOR ptToUpdate_IncreasedLimitFactor != ptAttrValues_IncreasedLimitFactor \n\t\t\tOR ptToUpdate_IncreasedLimitGroupCode != ptAttrValues_IncreasedLimitGroupCode \n\t\t\tOR ptToUpdate_YearBuilt != ptAttrValues_YearBuilt \n\t\t\tOR ptToUpdate_BaseRate != ptAttrValues_BaseRate \n\t\t\tOR ptToUpdate_ConstructionCode != ptAttrValues_ConstructionCode \n\t\t\tOR ptToUpdate_IndividualRiskPremiumModification != ptAttrValues_IndividualRiskPremiumModification \n\t\t\tOR ptToUpdate_StateRatingEffectiveDate != ptAttrValues_StateRatingEffectiveDate \n\t\t\tOR ptToUpdate_WindCoverageFlag != ptAttrValues_WindCoverageFlag \n\t\t\tOR ptToUpdate_DeductibleBasis != ptAttrValues_DeductibleBasis \n\t\t\tOR ptToUpdate_ExposureBasis != ptAttrValues_ExposureBasis \n\t\t\tOR ptToUpdate_ServiceCentreName != ptAttrValues_ServiceCentreName \n\t\t\tOR ptToUpdate_NumberOfEmployee != ptAttrValues_NumberOfEmployee \n\t\t), 'UPD',\n\t\t'NOCHANGE'\n\t) AS v_PTUpdateFlag,\n\tv_PTUpdateFlag AS PTUpdateFlag\n\tFROM SQ_PremiumTransaction_Offset\n),\nFLT_UpdateRecords AS (\n\tSELECT\n\tPremiumTransactionID, \n\tptAttrValues_EffectiveDate AS EffectiveDate, \n\tptAttrValues_PremiumTransactionExpirationDate AS PremiumTransactionExpirationDate, \n\tptAttrValues_ReasonAmendedCode AS ReasonAmendedCode, \n\tptAttrValues_DeductibleAmount AS DeductibleAmount, \n\tptAttrValues_ExperienceModificationFactor AS ExperienceModificationFactor, \n\tptAttrValues_ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate, \n\tptAttrValues_PackageModificationAdjustmentFactor AS PackageModificationAdjustmentFactor, \n\tptAttrValues_PackageModificationAdjustmentGroupCode AS PackageModificationAdjustmentGroupCode, \n\tptAttrValues_IncreasedLimitFactor AS IncreasedLimitFactor, \n\tptAttrValues_IncreasedLimitGroupCode AS IncreasedLimitGroupCode, \n\tptAttrValues_YearBuilt AS YearBuilt, \n\tptAttrValues_BaseRate AS BaseRate, \n\tptAttrValues_ConstructionCode AS ConstructionCode, \n\tptAttrValues_IndividualRiskPremiumModification AS IndividualRiskPremiumModification, \n\tptAttrValues_StateRatingEffectiveDate AS StateRatingEffectiveDate, \n\tptAttrValues_WindCoverageFlag AS WindCoverageFlag, \n\tptAttrValues_DeductibleBasis AS DeductibleBasis, \n\tptAttrValues_ExposureBasis AS ExposureBasis, \n\tptAttrValues_ServiceCentreName AS ServiceCentreName, \n\tptAttrValues_NumberOfEmployee AS NumberOfEmployee, \n\tPTUpdateFlag\n\tFROM EXP_offset_PTUpdate_attributes\n\tWHERE PTUpdateFlag='UPD'\n),\nUPD_PremiumTransaction AS (\n\tSELECT\n\tPremiumTransactionID, \n\tEffectiveDate, \n\tPremiumTransactionExpirationDate, \n\tReasonAmendedCode, \n\tDeductibleAmount, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPackageModificationAdjustmentFactor, \n\tPackageModificationAdjustmentGroupCode, \n\tIncreasedLimitFactor, \n\tIncreasedLimitGroupCode, \n\tYearBuilt, \n\tBaseRate, \n\tConstructionCode, \n\tIndividualRiskPremiumModification, \n\tStateRatingEffectiveDate, \n\tWindCoverageFlag, \n\tDeductibleBasis, \n\tExposureBasis, \n\tServiceCentreName, \n\tNumberOfEmployee\n\tFROM FLT_UpdateRecords\n),\nPremiumTransaction_upd AS (\n\tMERGE INTO PremiumTransaction AS T\n\tUSING UPD_PremiumTransaction AS S\n\tON T.PremiumTransactionID = S.PremiumTransactionID\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.EffectiveDate = S.EffectiveDate, T.PremiumTransactionExpirationDate = S.PremiumTransactionExpirationDate, T.ReasonAmendedCode = S.ReasonAmendedCode, T.DeductibleAmount = S.DeductibleAmount, T.ExperienceModificationFactor = S.ExperienceModificationFactor, T.ExperienceModificationEffectiveDate = S.ExperienceModificationEffectiveDate, T.PackageModificationAdjustmentFactor = S.PackageModificationAdjustmentFactor, T.PackageModificationAdjustmentGroupCode = S.PackageModificationAdjustmentGroupCode, T.IncreasedLimitFactor = S.IncreasedLimitFactor, T.IncreasedLimitGroupCode = S.IncreasedLimitGroupCode, T.YearBuilt = S.YearBuilt, T.BaseRate = S.BaseRate, T.ConstructionCode = S.ConstructionCode, T.StateRatingEffectiveDate = S.StateRatingEffectiveDate, T.IndividualRiskPremiumModification = S.IndividualRiskPremiumModification, T.WindCoverageFlag = S.WindCoverageFlag, T.DeductibleBasis = S.DeductibleBasis, T.ExposureBasis = S.ExposureBasis, T.ServiceCentreName = S.ServiceCentreName, T.NumberOfEmployee = S.NumberOfEmployee\n),\nSQ_PremiumTransaction_Deprecated AS (\n\tSELECT ptToUpdate.PremiumTransactionID,\r\n\t\tptToUpdate.EffectiveDate,\r\n\t\tptToUpdate.ReasonAmendedCode,\r\n\t\tptToUpdate.PremiumTransactionExpirationDate,\r\n\t\tptToUpdate.DeductibleAmount,\r\n\t\tptToUpdate.ExperienceModificationFactor,\r\n\t\tptToUpdate.ExperienceModificationEffectiveDate,\r\n\t\tptToUpdate.PackageModificationAdjustmentFactor,\r\n\t\tptToUpdate.PackageModificationAdjustmentGroupCode,\r\n\t\tptToUpdate.IncreasedLimitFactor,\r\n\t\tptToUpdate.IncreasedLimitGroupCode,\r\n\t\tptToUpdate.YearBuilt,\r\n\t\tptToUpdate.BaseRate,\r\n\t\tptToUpdate.ConstructionCode,\r\n\t\tptToUpdate.IndividualRiskPremiumModification,\r\n\t\tptToUpdate.StateRatingEffectiveDate,\r\n\t\tptToUpdate.WindCoverageFlag,\r\n\t\tptToUpdate.DeductibleBasis,\r\n\t\tptToUpdate.ExposureBasis,\r\n\t\tptToUpdate.ServiceCentreName,\r\n\t\tptToUpdate.NumberOfEmployee,\r\n\t\tptAttrValues.EffectiveDate,\r\n\t\tptAttrValues.ReasonAmendedCode,\r\n\t\tptAttrValues.PremiumTransactionExpirationDate,\r\n\t\tptAttrValues.DeductibleAmount,\r\n\t\tptAttrValues.ExperienceModificationFactor,\r\n\t\tptAttrValues.ExperienceModificationEffectiveDate,\r\n\t\tptAttrValues.PackageModificationAdjustmentFactor,\r\n\t\tptAttrValues.PackageModificationAdjustmentGroupCode,\r\n\t\tptAttrValues.IncreasedLimitFactor,\r\n\t\tptAttrValues.IncreasedLimitGroupCode,\r\n\t\tptAttrValues.YearBuilt,\r\n\t\tptAttrValues.BaseRate,\r\n\t\tptAttrValues.ConstructionCode,\r\n\t\tptAttrValues.IndividualRiskPremiumModification,\r\n\t\tptAttrValues.StateRatingEffectiveDate,\r\n\t\tptAttrValues.WindCoverageFlag,\r\n\t\tptAttrValues.DeductibleBasis,\r\n\t\tptAttrValues.ExposureBasis,\r\n\t\tptAttrValues.ServiceCentreName,\r\n\t\tptAttrValues.NumberOfEmployee\r\n\tFROM WorkPremiumTransactionOffsetLineage wptol \r\n\tINNER JOIN PremiumTransaction ptToUpdate ON wptol.PremiumTransactionID = ptToUpdate.PremiumTransactionID\r\n\tINNER JOIN PremiumTransaction ptAttrValues ON wptol.PreviousPremiumTransactionID = ptAttrValues.PremiumTransactionID\r\n\tWHERE wptol.UpdateAttributeFlag = 1 \r\n\tAND ptToUpdate.OffsetOnsetCode = 'Deprecated' and ptToUpdate.AuditId=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} \r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Deprecated_PTUpdate_attributes AS (\n\tSELECT\n\tptToUpdate_PremiumTransactionID AS PremiumTransactionID,\n\tptToUpdate_EffectiveDate,\n\tptToUpdate_ReasonAmendedCode,\n\tptToUpdate_PremiumTransactionExpirationDate,\n\tptToUpdate_DeductibleAmount,\n\tptToUpdate_ExperienceModificationFactor,\n\tptToUpdate_ExperienceModificationEffectiveDate,\n\tptToUpdate_PackageModificationAdjustmentFactor,\n\tptToUpdate_PackageModificationAdjustmentGroupCode,\n\tptToUpdate_IncreasedLimitFactor,\n\tptToUpdate_IncreasedLimitGroupCode,\n\tptToUpdate_YearBuilt,\n\tptToUpdate_BaseRate,\n\tptToUpdate_ConstructionCode,\n\tptToUpdate_IndividualRiskPremiumModification,\n\tptToUpdate_StateRatingEffectiveDate,\n\tptToUpdate_WindCoverageFlag,\n\tptToUpdate_DeductibleBasis,\n\tptToUpdate_ExposureBasis,\n\tptToUpdate_ServiceCentreName,\n\tptToUpdate_NumberOfEmployee,\n\tptAttrValues_EffectiveDate,\n\tptAttrValues_PremiumTransactionExpirationDate,\n\tptAttrValues_ReasonAmendedCode,\n\tptAttrValues_DeductibleAmount,\n\tptAttrValues_ExperienceModificationFactor,\n\tptAttrValues_ExperienceModificationEffectiveDate,\n\tptAttrValues_PackageModificationAdjustmentFactor,\n\tptAttrValues_PackageModificationAdjustmentGroupCode,\n\tptAttrValues_IncreasedLimitFactor,\n\tptAttrValues_IncreasedLimitGroupCode,\n\tptAttrValues_YearBuilt,\n\tptAttrValues_BaseRate,\n\tptAttrValues_ConstructionCode,\n\tptAttrValues_IndividualRiskPremiumModification,\n\tptAttrValues_StateRatingEffectiveDate,\n\tptAttrValues_WindCoverageFlag,\n\tptAttrValues_DeductibleBasis,\n\tptAttrValues_ExposureBasis,\n\tptAttrValues_ServiceCentreName,\n\tptAttrValues_NumberOfEmployee,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \t(ptToUpdate_EffectiveDate != ptAttrValues_EffectiveDate or\r\n\t-- \tptToUpdate_ReasonAmendedCode != ptAttrValues_ReasonAmendedCode or\r\n\t-- \tptToUpdate_PremiumTransactionExpirationDate != ptAttrValues_PremiumTransactionExpirationDate or\r\n\t-- \tptToUpdate_DeductibleAmount != ptAttrValues_DeductibleAmount or\r\n\t-- \tptToUpdate_ExperienceModificationFactor != ptAttrValues_ExperienceModificationFactor or\r\n\t-- \tptToUpdate_ExperienceModificationEffectiveDate != ptAttrValues_ExperienceModificationEffectiveDate or\r\n\t-- \tptToUpdate_PackageModificationAdjustmentFactor != ptAttrValues_PackageModificationAdjustmentFactor or\r\n\t-- \tptToUpdate_PackageModificationAdjustmentGroupCode != ptAttrValues_PackageModificationAdjustmentGroupCode or\r\n\t-- \tptToUpdate_IncreasedLimitFactor != ptAttrValues_IncreasedLimitFactor or\r\n\t-- \tptToUpdate_IncreasedLimitGroupCode != ptAttrValues_IncreasedLimitGroupCode or\r\n\t-- \tptToUpdate_YearBuilt != ptAttrValues_YearBuilt  or\r\n\t-- \tptToUpdate_BaseRate != ptAttrValues_BaseRate or\r\n\t-- \tptToUpdate_ConstructionCode != ptAttrValues_ConstructionCode or\r\n\t-- \tptToUpdate_IndividualRiskPremiumModification != ptAttrValues_IndividualRiskPremiumModification or \r\n\t-- \tptToUpdate_StateRatingEffectiveDate != ptAttrValues_StateRatingEffectiveDate or\r\n\t-- \tptToUpdate_WindCoverageFlag != ptAttrValues_WindCoverageFlag or\r\n\t-- \tptToUpdate_DeductibleBasis != ptAttrValues_DeductibleBasis or\r\n\t-- \tptToUpdate_ExposureBasis != ptAttrValues_ExposureBasis or\r\n\t-- \tptToUpdate_ServiceCentreName != ptAttrValues_ServiceCentreName or\r\n\t-- \tptToUpdate_NumberOfEmployee != ptAttrValues_NumberOfEmployee),\r\n\t-- \t\t'UPD',\r\n\t-- \t'NOCHANGE')\n\tDECODE(TRUE,\n\t\t( ptToUpdate_EffectiveDate != ptAttrValues_EffectiveDate \n\t\t\tOR ptToUpdate_ReasonAmendedCode != ptAttrValues_ReasonAmendedCode \n\t\t\tOR ptToUpdate_PremiumTransactionExpirationDate != ptAttrValues_PremiumTransactionExpirationDate \n\t\t\tOR ptToUpdate_DeductibleAmount != ptAttrValues_DeductibleAmount \n\t\t\tOR ptToUpdate_ExperienceModificationFactor != ptAttrValues_ExperienceModificationFactor \n\t\t\tOR ptToUpdate_ExperienceModificationEffectiveDate != ptAttrValues_ExperienceModificationEffectiveDate \n\t\t\tOR ptToUpdate_PackageModificationAdjustmentFactor != ptAttrValues_PackageModificationAdjustmentFactor \n\t\t\tOR ptToUpdate_PackageModificationAdjustmentGroupCode != ptAttrValues_PackageModificationAdjustmentGroupCode \n\t\t\tOR ptToUpdate_IncreasedLimitFactor != ptAttrValues_IncreasedLimitFactor \n\t\t\tOR ptToUpdate_IncreasedLimitGroupCode != ptAttrValues_IncreasedLimitGroupCode \n\t\t\tOR ptToUpdate_YearBuilt != ptAttrValues_YearBuilt \n\t\t\tOR ptToUpdate_BaseRate != ptAttrValues_BaseRate \n\t\t\tOR ptToUpdate_ConstructionCode != ptAttrValues_ConstructionCode \n\t\t\tOR ptToUpdate_IndividualRiskPremiumModification != ptAttrValues_IndividualRiskPremiumModification \n\t\t\tOR ptToUpdate_StateRatingEffectiveDate != ptAttrValues_StateRatingEffectiveDate \n\t\t\tOR ptToUpdate_WindCoverageFlag != ptAttrValues_WindCoverageFlag \n\t\t\tOR ptToUpdate_DeductibleBasis != ptAttrValues_DeductibleBasis \n\t\t\tOR ptToUpdate_ExposureBasis != ptAttrValues_ExposureBasis \n\t\t\tOR ptToUpdate_ServiceCentreName != ptAttrValues_ServiceCentreName \n\t\t\tOR ptToUpdate_NumberOfEmployee != ptAttrValues_NumberOfEmployee \n\t\t), 'UPD',\n\t\t'NOCHANGE'\n\t) AS v_PTUpdateFlag,\n\tv_PTUpdateFlag AS PTUpdateFlag\n\tFROM SQ_PremiumTransaction_Deprecated\n),\nFLT_UpdateRecords_Deprecated AS (\n\tSELECT\n\tPremiumTransactionID, \n\tptAttrValues_EffectiveDate AS EffectiveDate, \n\tptAttrValues_PremiumTransactionExpirationDate AS PremiumTransactionExpirationDate, \n\tptAttrValues_ReasonAmendedCode AS ReasonAmendedCode, \n\tptAttrValues_DeductibleAmount AS DeductibleAmount, \n\tptAttrValues_ExperienceModificationFactor AS ExperienceModificationFactor, \n\tptAttrValues_ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate, \n\tptAttrValues_PackageModificationAdjustmentFactor AS PackageModificationAdjustmentFactor, \n\tptAttrValues_PackageModificationAdjustmentGroupCode AS PackageModificationAdjustmentGroupCode, \n\tptAttrValues_IncreasedLimitFactor AS IncreasedLimitFactor, \n\tptAttrValues_IncreasedLimitGroupCode AS IncreasedLimitGroupCode, \n\tptAttrValues_YearBuilt AS YearBuilt, \n\tptAttrValues_BaseRate AS BaseRate, \n\tptAttrValues_ConstructionCode AS ConstructionCode, \n\tptAttrValues_IndividualRiskPremiumModification AS IndividualRiskPremiumModification, \n\tptAttrValues_StateRatingEffectiveDate AS StateRatingEffectiveDate, \n\tptAttrValues_WindCoverageFlag AS WindCoverageFlag, \n\tptAttrValues_DeductibleBasis AS DeductibleBasis, \n\tptAttrValues_ExposureBasis AS ExposureBasis, \n\tptAttrValues_ServiceCentreName AS ServiceCentreName, \n\tptAttrValues_NumberOfEmployee AS NumberOfEmployee, \n\tPTUpdateFlag\n\tFROM EXP_Deprecated_PTUpdate_attributes\n\tWHERE PTUpdateFlag='UPD'\n),\nUPD_PremiumTransaction_Deprecated AS (\n\tSELECT\n\tPremiumTransactionID, \n\tEffectiveDate, \n\tPremiumTransactionExpirationDate, \n\tReasonAmendedCode, \n\tDeductibleAmount, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPackageModificationAdjustmentFactor, \n\tPackageModificationAdjustmentGroupCode, \n\tIncreasedLimitFactor, \n\tIncreasedLimitGroupCode, \n\tYearBuilt, \n\tBaseRate, \n\tConstructionCode, \n\tIndividualRiskPremiumModification, \n\tStateRatingEffectiveDate, \n\tWindCoverageFlag, \n\tDeductibleBasis, \n\tExposureBasis, \n\tServiceCentreName, \n\tNumberOfEmployee\n\tFROM FLT_UpdateRecords_Deprecated\n),\nPremiumTransaction_upd_Deprecated AS (\n\tMERGE INTO PremiumTransaction AS T\n\tUSING UPD_PremiumTransaction_Deprecated AS S\n\tON T.PremiumTransactionID = S.PremiumTransactionID\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.EffectiveDate = S.EffectiveDate, T.PremiumTransactionExpirationDate = S.PremiumTransactionExpirationDate, T.ReasonAmendedCode = S.ReasonAmendedCode, T.DeductibleAmount = S.DeductibleAmount, T.ExperienceModificationFactor = S.ExperienceModificationFactor, T.ExperienceModificationEffectiveDate = S.ExperienceModificationEffectiveDate, T.PackageModificationAdjustmentFactor = S.PackageModificationAdjustmentFactor, T.PackageModificationAdjustmentGroupCode = S.PackageModificationAdjustmentGroupCode, T.IncreasedLimitFactor = S.IncreasedLimitFactor, T.IncreasedLimitGroupCode = S.IncreasedLimitGroupCode, T.YearBuilt = S.YearBuilt, T.BaseRate = S.BaseRate, T.ConstructionCode = S.ConstructionCode, T.StateRatingEffectiveDate = S.StateRatingEffectiveDate, T.IndividualRiskPremiumModification = S.IndividualRiskPremiumModification, T.WindCoverageFlag = S.WindCoverageFlag, T.DeductibleBasis = S.DeductibleBasis, T.ExposureBasis = S.ExposureBasis, T.ServiceCentreName = S.ServiceCentreName, T.NumberOfEmployee = S.NumberOfEmployee\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246483"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905491"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7603252"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/29/2023 22:44:58"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 23:03:38"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "v2"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "DCT"
            },
            "TARGET_POST_SQL": {
                "type": "string",
                "defaultValue": ""
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Policy DataWarehouse/"
        },
        "annotations": []
    }
}