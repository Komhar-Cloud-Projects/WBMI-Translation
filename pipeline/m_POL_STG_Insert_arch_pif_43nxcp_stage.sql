WITH
SQ_Pif43NXCPStage AS (
	SELECT
		Pif43NXCPStageId,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		Pmdnxp1RecLength,
		Pmdnxp1ActionCode,
		Pmdnxp1FileId,
		Pmdnxp1SegmentId,
		Pmdnxp1SegmentStatus,
		Pmdnxp1YearTransaction,
		Pmdnxp1MonthTransaction,
		Pmdnxp1DayTransaction,
		Pmdnxp1SegmentLevelCode,
		Pmdnxp1SegmentPartCode,
		Pmdnxp1SubPartCode,
		Pmdnxp1InsuranceLine,
		Pmdnxp1LocationNumber,
		Pmdnxp1SubLocationNumber,
		Pmdnxp1YearItemEffective,
		Pmdnxp1MonthItemEffective,
		Pmdnxp1DayItemEffective,
		Pmdnxp1PeakSeasonIndicator,
		Pmdnxp1YearProcess,
		Pmdnxp1MonthProcess,
		Pmdnxp1DayProcess,
		Pmdnxp1Zone,
		Pmdnxp1ZoneArea,
		Pmdnxp1CompanyNumber,
		Pmdnxp1AgentsCommRate,
		Pmdnxp1ScheduleMod,
		Pmdnxp1CommRedMod,
		Pmdnxp1OtherMod,
		Pmdnxp1ExpenseMod,
		Pmdnxp1Irpm,
		Pmdnxp1CspConstrCod,
		Pmdnxp1MixedConstrInd,
		Pmdnxp1ProtectionClassPart1,
		Pmdnxp1ProtectionClassPart2,
		Pmdnxp1NumberOfUnits,
		Pmdnxp1SeasonalIndicator,
		Pmdnxp1VacancyInd,
		Pmdnxp1YearVacCvgEff,
		Pmdnxp1MonthVacCvgEff,
		Pmdnxp1DayVacCvgEff,
		Pmdnxp1YearVacCvgExpire,
		Pmdnxp1MonthVacCvgExpi,
		Pmdnxp1DayVacCvgExpir,
		Pmdnxp1ChrgAdditIndInd,
		Pmdnxp1NumberWarehouses,
		Pmdnxp1WtchmnModFact,
		Pmdnxp1PrmBrgAlmModFact,
		Pmdnxp1BldgSpecificRate,
		Pmdnxp1ContSpecificRate,
		Pmdnxp1MESpecificRate,
		Pmdnxp1StockSpecificRate,
		Pmdnxp1GrpiiSpecificRate,
		Pmdnxp1GrpiiEcSymbol,
		Pmdnxp1GrpiiNumPrefix,
		Pmdnxp1BldgPubCoinsPct,
		Pmdnxp1ContPubCoinsPct,
		Pmdnxp1MEPubCoinsPct,
		Pmdnxp1StockPubCoinsPct,
		Pmdnxp1YearSpecificEff,
		Pmdnxp1MonthSpecificEff,
		Pmdnxp1DaySpecificEff,
		Pmdnxp1SplClsRateItem1,
		Pmdnxp1SplClsRateItem2,
		Pmdnxp1SplClsRateItem3,
		Pmdnxp1OpenSidesInd,
		Pmdnxp1SprinklerType,
		Pmdnxp1AlarmTypes,
		Pmdnxp1AlarmInstallation,
		Pmdnxp1AlarmClass,
		Pmdnxp1YearAgreedExpir,
		Pmdnxp1MonthAgreedExpir,
		Pmdnxp1DayAgreedExpir,
		Pmdnxp1MercantileArea,
		Pmdnxp1ManufacturingArea,
		Pmdnxp1VariableAreaByState,
		Pmdnxp1ScohCode,
		Pmdnxp1OccCodeBldg,
		Pmdnxp1OccCodeCont,
		Pmdnxp1WashSprnkLkQual,
		Pmdnxp1WashFireStation,
		Pmdnxp1WashHydrantInd,
		Pmdnxp1MassDistrict,
		Pmdnxp1MassTenReloExp,
		Pmdnxp1ContsGrpiiEcSymbol,
		Pmdnxp1ContsGrpiiNum,
		Pmdnxp1ContsOccCls,
		Pmdnxp1ContsOccSym,
		Pmdnxp1RentalArea,
		Pmdnxp1EqRerateInd,
		Pmdnxp1TxgrpiiNumPrefix,
		Pmdnxp1GrpiiType,
		Pmdnxp1PublicPropertyInd,
		Pmdnxp1StorageInd,
		Pmdnxp1CityCode,
		Pmdnxp1OccCls,
		Pmdnxp1OccSym,
		Pmdnxp1GrpiiCode,
		Pmdnxp1GrpiiContSpecRate,
		Pmdnxp1BroadBldgBlktRate,
		Pmdnxp1BroadContBlktRate,
		Pmdnxp1SpecialBldgBlktRate,
		Pmdnxp1SpecialContBlktRate,
		Pmdnxp1StatementOfValueInd,
		Pmdnxp1SubStdConversionInd,
		Pmdnxp1SubStdExposureInd,
		Pmdnxp1SubStdHeatCookInd,
		Pmdnxp1SubStdPhysCondInd,
		Pmdnxp1SubStdWiringInd,
		Pmdnxp1GenlClsRtGrp,
		Pmdnxp1VariableAreaState,
		Pmdnxp1DecChangeFlag,
		Pmdnxp1RerateImInd,
		Pmdnxp1WaiveContractorInd,
		Pmdnxp1BlktMiscLocExcl,
		Pmdnxp1ExceptionInd,
		Pmdnxp1BuildingGradeCode,
		Pmdnxp1CigradeCode,
		Pmdnxp1Extinguisher,
		Pmdnxp1YearBuilt,
		Pmdnxp1PmscFutureUse,
		Pmdnxp1EdgeFactor,
		Pmdnxp1AssocFactor,
		Pmdnxp1ProgramFactor,
		Pmdnxp1CustomerFutureUse,
		Pmdnxp1Yr2000CustUse,
		Pmdnxp1WbcKey,
		ExtractDate,
		AsOfDate,
		RecordCount,
		SourceSystemId
	FROM Pif43NXCPStage
),
EXP_VALUES AS (
	SELECT
	Pif43NXCPStageId,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	Pmdnxp1RecLength,
	Pmdnxp1ActionCode,
	Pmdnxp1FileId,
	Pmdnxp1SegmentId,
	Pmdnxp1SegmentStatus,
	Pmdnxp1YearTransaction,
	Pmdnxp1MonthTransaction,
	Pmdnxp1DayTransaction,
	Pmdnxp1SegmentLevelCode,
	Pmdnxp1SegmentPartCode,
	Pmdnxp1SubPartCode,
	Pmdnxp1InsuranceLine,
	Pmdnxp1LocationNumber,
	Pmdnxp1SubLocationNumber,
	Pmdnxp1YearItemEffective,
	Pmdnxp1MonthItemEffective,
	Pmdnxp1DayItemEffective,
	Pmdnxp1PeakSeasonIndicator,
	Pmdnxp1YearProcess,
	Pmdnxp1MonthProcess,
	Pmdnxp1DayProcess,
	Pmdnxp1Zone,
	Pmdnxp1ZoneArea,
	Pmdnxp1CompanyNumber,
	Pmdnxp1AgentsCommRate,
	Pmdnxp1ScheduleMod,
	Pmdnxp1CommRedMod,
	Pmdnxp1OtherMod,
	Pmdnxp1ExpenseMod,
	Pmdnxp1Irpm,
	Pmdnxp1CspConstrCod,
	Pmdnxp1MixedConstrInd,
	Pmdnxp1ProtectionClassPart1,
	Pmdnxp1ProtectionClassPart2,
	Pmdnxp1NumberOfUnits,
	Pmdnxp1SeasonalIndicator,
	Pmdnxp1VacancyInd,
	Pmdnxp1YearVacCvgEff,
	Pmdnxp1MonthVacCvgEff,
	Pmdnxp1DayVacCvgEff,
	Pmdnxp1YearVacCvgExpire,
	Pmdnxp1MonthVacCvgExpi,
	Pmdnxp1DayVacCvgExpir,
	Pmdnxp1ChrgAdditIndInd,
	Pmdnxp1NumberWarehouses,
	Pmdnxp1WtchmnModFact,
	Pmdnxp1PrmBrgAlmModFact,
	Pmdnxp1BldgSpecificRate,
	Pmdnxp1ContSpecificRate,
	Pmdnxp1MESpecificRate,
	Pmdnxp1StockSpecificRate,
	Pmdnxp1GrpiiSpecificRate,
	Pmdnxp1GrpiiEcSymbol,
	Pmdnxp1GrpiiNumPrefix,
	Pmdnxp1BldgPubCoinsPct,
	Pmdnxp1ContPubCoinsPct,
	Pmdnxp1MEPubCoinsPct,
	Pmdnxp1StockPubCoinsPct,
	Pmdnxp1YearSpecificEff,
	Pmdnxp1MonthSpecificEff,
	Pmdnxp1DaySpecificEff,
	Pmdnxp1SplClsRateItem1,
	Pmdnxp1SplClsRateItem2,
	Pmdnxp1SplClsRateItem3,
	Pmdnxp1OpenSidesInd,
	Pmdnxp1SprinklerType,
	Pmdnxp1AlarmTypes,
	Pmdnxp1AlarmInstallation,
	Pmdnxp1AlarmClass,
	Pmdnxp1YearAgreedExpir,
	Pmdnxp1MonthAgreedExpir,
	Pmdnxp1DayAgreedExpir,
	Pmdnxp1MercantileArea,
	Pmdnxp1ManufacturingArea,
	Pmdnxp1VariableAreaByState,
	Pmdnxp1ScohCode,
	Pmdnxp1OccCodeBldg,
	Pmdnxp1OccCodeCont,
	Pmdnxp1WashSprnkLkQual,
	Pmdnxp1WashFireStation,
	Pmdnxp1WashHydrantInd,
	Pmdnxp1MassDistrict,
	Pmdnxp1MassTenReloExp,
	Pmdnxp1ContsGrpiiEcSymbol,
	Pmdnxp1ContsGrpiiNum,
	Pmdnxp1ContsOccCls,
	Pmdnxp1ContsOccSym,
	Pmdnxp1RentalArea,
	Pmdnxp1EqRerateInd,
	Pmdnxp1TxgrpiiNumPrefix,
	Pmdnxp1GrpiiType,
	Pmdnxp1PublicPropertyInd,
	Pmdnxp1StorageInd,
	Pmdnxp1CityCode,
	Pmdnxp1OccCls,
	Pmdnxp1OccSym,
	Pmdnxp1GrpiiCode,
	Pmdnxp1GrpiiContSpecRate,
	Pmdnxp1BroadBldgBlktRate,
	Pmdnxp1BroadContBlktRate,
	Pmdnxp1SpecialBldgBlktRate,
	Pmdnxp1SpecialContBlktRate,
	Pmdnxp1StatementOfValueInd,
	Pmdnxp1SubStdConversionInd,
	Pmdnxp1SubStdExposureInd,
	Pmdnxp1SubStdHeatCookInd,
	Pmdnxp1SubStdPhysCondInd,
	Pmdnxp1SubStdWiringInd,
	Pmdnxp1GenlClsRtGrp,
	Pmdnxp1VariableAreaState,
	Pmdnxp1DecChangeFlag,
	Pmdnxp1RerateImInd,
	Pmdnxp1WaiveContractorInd,
	Pmdnxp1BlktMiscLocExcl,
	Pmdnxp1ExceptionInd,
	Pmdnxp1BuildingGradeCode,
	Pmdnxp1CigradeCode,
	Pmdnxp1Extinguisher,
	Pmdnxp1YearBuilt,
	Pmdnxp1PmscFutureUse,
	Pmdnxp1EdgeFactor,
	Pmdnxp1AssocFactor,
	Pmdnxp1ProgramFactor,
	Pmdnxp1CustomerFutureUse,
	Pmdnxp1Yr2000CustUse,
	Pmdnxp1WbcKey,
	ExtractDate,
	AsOfDate,
	RecordCount,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId
	FROM SQ_Pif43NXCPStage
),
ArchPif43NXCPStage_INSERT AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43NXCPStage
	(Pif43NXCPStageId, PifSymbol, PifPolicyNumber, PifModule, Pmdnxp1RecLength, Pmdnxp1ActionCode, Pmdnxp1FileId, Pmdnxp1SegmentId, Pmdnxp1SegmentStatus, Pmdnxp1YearTransaction, Pmdnxp1MonthTransaction, Pmdnxp1DayTransaction, Pmdnxp1SegmentLevelCode, Pmdnxp1SegmentPartCode, Pmdnxp1SubPartCode, Pmdnxp1InsuranceLine, Pmdnxp1LocationNumber, Pmdnxp1SubLocationNumber, Pmdnxp1YearItemEffective, Pmdnxp1MonthItemEffective, Pmdnxp1DayItemEffective, Pmdnxp1PeakSeasonIndicator, Pmdnxp1YearProcess, Pmdnxp1MonthProcess, Pmdnxp1DayProcess, Pmdnxp1Zone, Pmdnxp1ZoneArea, Pmdnxp1CompanyNumber, Pmdnxp1AgentsCommRate, Pmdnxp1ScheduleMod, Pmdnxp1CommRedMod, Pmdnxp1OtherMod, Pmdnxp1ExpenseMod, Pmdnxp1Irpm, Pmdnxp1CspConstrCod, Pmdnxp1MixedConstrInd, Pmdnxp1ProtectionClassPart1, Pmdnxp1ProtectionClassPart2, Pmdnxp1NumberOfUnits, Pmdnxp1SeasonalIndicator, Pmdnxp1VacancyInd, Pmdnxp1YearVacCvgEff, Pmdnxp1MonthVacCvgEff, Pmdnxp1DayVacCvgEff, Pmdnxp1YearVacCvgExpire, Pmdnxp1MonthVacCvgExpi, Pmdnxp1DayVacCvgExpir, Pmdnxp1ChrgAdditIndInd, Pmdnxp1NumberWarehouses, Pmdnxp1WtchmnModFact, Pmdnxp1PrmBrgAlmModFact, Pmdnxp1BldgSpecificRate, Pmdnxp1ContSpecificRate, Pmdnxp1MESpecificRate, Pmdnxp1StockSpecificRate, Pmdnxp1GrpiiSpecificRate, Pmdnxp1GrpiiEcSymbol, Pmdnxp1GrpiiNumPrefix, Pmdnxp1BldgPubCoinsPct, Pmdnxp1ContPubCoinsPct, Pmdnxp1MEPubCoinsPct, Pmdnxp1StockPubCoinsPct, Pmdnxp1YearSpecificEff, Pmdnxp1MonthSpecificEff, Pmdnxp1DaySpecificEff, Pmdnxp1SplClsRateItem1, Pmdnxp1SplClsRateItem2, Pmdnxp1SplClsRateItem3, Pmdnxp1OpenSidesInd, Pmdnxp1SprinklerType, Pmdnxp1AlarmTypes, Pmdnxp1AlarmInstallation, Pmdnxp1AlarmClass, Pmdnxp1YearAgreedExpir, Pmdnxp1MonthAgreedExpir, Pmdnxp1DayAgreedExpir, Pmdnxp1MercantileArea, Pmdnxp1ManufacturingArea, Pmdnxp1VariableAreaByState, Pmdnxp1ScohCode, Pmdnxp1OccCodeBldg, Pmdnxp1OccCodeCont, Pmdnxp1WashSprnkLkQual, Pmdnxp1WashFireStation, Pmdnxp1WashHydrantInd, Pmdnxp1MassDistrict, Pmdnxp1MassTenReloExp, Pmdnxp1ContsGrpiiEcSymbol, Pmdnxp1ContsGrpiiNum, Pmdnxp1ContsOccCls, Pmdnxp1ContsOccSym, Pmdnxp1RentalArea, Pmdnxp1EqRerateInd, Pmdnxp1TxgrpiiNumPrefix, Pmdnxp1GrpiiType, Pmdnxp1PublicPropertyInd, Pmdnxp1StorageInd, Pmdnxp1CityCode, Pmdnxp1OccCls, Pmdnxp1OccSym, Pmdnxp1GrpiiCode, Pmdnxp1GrpiiContSpecRate, Pmdnxp1BroadBldgBlktRate, Pmdnxp1BroadContBlktRate, Pmdnxp1SpecialBldgBlktRate, Pmdnxp1SpecialContBlktRate, Pmdnxp1StatementOfValueInd, Pmdnxp1SubStdConversionInd, Pmdnxp1SubStdExposureInd, Pmdnxp1SubStdHeatCookInd, Pmdnxp1SubStdPhysCondInd, Pmdnxp1SubStdWiringInd, Pmdnxp1GenlClsRtGrp, Pmdnxp1VariableAreaState, Pmdnxp1DecChangeFlag, Pmdnxp1RerateImInd, Pmdnxp1WaiveContractorInd, Pmdnxp1BlktMiscLocExcl, Pmdnxp1ExceptionInd, Pmdnxp1BuildingGradeCode, Pmdnxp1CigradeCode, Pmdnxp1Extinguisher, Pmdnxp1YearBuilt, Pmdnxp1PmscFutureUse, Pmdnxp1EdgeFactor, Pmdnxp1AssocFactor, Pmdnxp1ProgramFactor, Pmdnxp1CustomerFutureUse, Pmdnxp1Yr2000CustUse, Pmdnxp1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)
	SELECT 
	PIF43NXCPSTAGEID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	PMDNXP1RECLENGTH, 
	PMDNXP1ACTIONCODE, 
	PMDNXP1FILEID, 
	PMDNXP1SEGMENTID, 
	PMDNXP1SEGMENTSTATUS, 
	PMDNXP1YEARTRANSACTION, 
	PMDNXP1MONTHTRANSACTION, 
	PMDNXP1DAYTRANSACTION, 
	PMDNXP1SEGMENTLEVELCODE, 
	PMDNXP1SEGMENTPARTCODE, 
	PMDNXP1SUBPARTCODE, 
	PMDNXP1INSURANCELINE, 
	PMDNXP1LOCATIONNUMBER, 
	PMDNXP1SUBLOCATIONNUMBER, 
	PMDNXP1YEARITEMEFFECTIVE, 
	PMDNXP1MONTHITEMEFFECTIVE, 
	PMDNXP1DAYITEMEFFECTIVE, 
	PMDNXP1PEAKSEASONINDICATOR, 
	PMDNXP1YEARPROCESS, 
	PMDNXP1MONTHPROCESS, 
	PMDNXP1DAYPROCESS, 
	PMDNXP1ZONE, 
	PMDNXP1ZONEAREA, 
	PMDNXP1COMPANYNUMBER, 
	PMDNXP1AGENTSCOMMRATE, 
	PMDNXP1SCHEDULEMOD, 
	PMDNXP1COMMREDMOD, 
	PMDNXP1OTHERMOD, 
	PMDNXP1EXPENSEMOD, 
	PMDNXP1IRPM, 
	PMDNXP1CSPCONSTRCOD, 
	PMDNXP1MIXEDCONSTRIND, 
	PMDNXP1PROTECTIONCLASSPART1, 
	PMDNXP1PROTECTIONCLASSPART2, 
	PMDNXP1NUMBEROFUNITS, 
	PMDNXP1SEASONALINDICATOR, 
	PMDNXP1VACANCYIND, 
	PMDNXP1YEARVACCVGEFF, 
	PMDNXP1MONTHVACCVGEFF, 
	PMDNXP1DAYVACCVGEFF, 
	PMDNXP1YEARVACCVGEXPIRE, 
	PMDNXP1MONTHVACCVGEXPI, 
	PMDNXP1DAYVACCVGEXPIR, 
	PMDNXP1CHRGADDITINDIND, 
	PMDNXP1NUMBERWAREHOUSES, 
	PMDNXP1WTCHMNMODFACT, 
	PMDNXP1PRMBRGALMMODFACT, 
	PMDNXP1BLDGSPECIFICRATE, 
	PMDNXP1CONTSPECIFICRATE, 
	PMDNXP1MESPECIFICRATE, 
	PMDNXP1STOCKSPECIFICRATE, 
	PMDNXP1GRPIISPECIFICRATE, 
	PMDNXP1GRPIIECSYMBOL, 
	PMDNXP1GRPIINUMPREFIX, 
	PMDNXP1BLDGPUBCOINSPCT, 
	PMDNXP1CONTPUBCOINSPCT, 
	PMDNXP1MEPUBCOINSPCT, 
	PMDNXP1STOCKPUBCOINSPCT, 
	PMDNXP1YEARSPECIFICEFF, 
	PMDNXP1MONTHSPECIFICEFF, 
	PMDNXP1DAYSPECIFICEFF, 
	PMDNXP1SPLCLSRATEITEM1, 
	PMDNXP1SPLCLSRATEITEM2, 
	PMDNXP1SPLCLSRATEITEM3, 
	PMDNXP1OPENSIDESIND, 
	PMDNXP1SPRINKLERTYPE, 
	PMDNXP1ALARMTYPES, 
	PMDNXP1ALARMINSTALLATION, 
	PMDNXP1ALARMCLASS, 
	PMDNXP1YEARAGREEDEXPIR, 
	PMDNXP1MONTHAGREEDEXPIR, 
	PMDNXP1DAYAGREEDEXPIR, 
	PMDNXP1MERCANTILEAREA, 
	PMDNXP1MANUFACTURINGAREA, 
	PMDNXP1VARIABLEAREABYSTATE, 
	PMDNXP1SCOHCODE, 
	PMDNXP1OCCCODEBLDG, 
	PMDNXP1OCCCODECONT, 
	PMDNXP1WASHSPRNKLKQUAL, 
	PMDNXP1WASHFIRESTATION, 
	PMDNXP1WASHHYDRANTIND, 
	PMDNXP1MASSDISTRICT, 
	PMDNXP1MASSTENRELOEXP, 
	PMDNXP1CONTSGRPIIECSYMBOL, 
	PMDNXP1CONTSGRPIINUM, 
	PMDNXP1CONTSOCCCLS, 
	PMDNXP1CONTSOCCSYM, 
	PMDNXP1RENTALAREA, 
	PMDNXP1EQRERATEIND, 
	PMDNXP1TXGRPIINUMPREFIX, 
	PMDNXP1GRPIITYPE, 
	PMDNXP1PUBLICPROPERTYIND, 
	PMDNXP1STORAGEIND, 
	PMDNXP1CITYCODE, 
	PMDNXP1OCCCLS, 
	PMDNXP1OCCSYM, 
	PMDNXP1GRPIICODE, 
	PMDNXP1GRPIICONTSPECRATE, 
	PMDNXP1BROADBLDGBLKTRATE, 
	PMDNXP1BROADCONTBLKTRATE, 
	PMDNXP1SPECIALBLDGBLKTRATE, 
	PMDNXP1SPECIALCONTBLKTRATE, 
	PMDNXP1STATEMENTOFVALUEIND, 
	PMDNXP1SUBSTDCONVERSIONIND, 
	PMDNXP1SUBSTDEXPOSUREIND, 
	PMDNXP1SUBSTDHEATCOOKIND, 
	PMDNXP1SUBSTDPHYSCONDIND, 
	PMDNXP1SUBSTDWIRINGIND, 
	PMDNXP1GENLCLSRTGRP, 
	PMDNXP1VARIABLEAREASTATE, 
	PMDNXP1DECCHANGEFLAG, 
	PMDNXP1RERATEIMIND, 
	PMDNXP1WAIVECONTRACTORIND, 
	PMDNXP1BLKTMISCLOCEXCL, 
	PMDNXP1EXCEPTIONIND, 
	PMDNXP1BUILDINGGRADECODE, 
	PMDNXP1CIGRADECODE, 
	PMDNXP1EXTINGUISHER, 
	PMDNXP1YEARBUILT, 
	PMDNXP1PMSCFUTUREUSE, 
	PMDNXP1EDGEFACTOR, 
	PMDNXP1ASSOCFACTOR, 
	PMDNXP1PROGRAMFACTOR, 
	PMDNXP1CUSTOMERFUTUREUSE, 
	PMDNXP1YR2000CUSTUSE, 
	PMDNXP1WBCKEY, 
	EXTRACTDATE, 
	ASOFDATE, 
	RECORDCOUNT, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID
	FROM EXP_VALUES
),