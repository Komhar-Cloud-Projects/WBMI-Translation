{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_ArchWBCUUmbrellaCommercialAutoStaging",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_ArchWBCUUmbrellaCommerc_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WBCUUmbrellaCommercialAutoStaging AS (\n\tSELECT\n\t\tWBCUUmbrellaCommercialAutoStagingId,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tCU_UmbrellaCommercialAutoId,\n\t\tWB_CU_UmbrellaCommercialAutoId,\n\t\tSessionId,\n\t\tDeleted,\n\t\tAggregateLimit,\n\t\tLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\t\tLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\t\tPersonalInjury,\n\t\tOtherDescription,\n\t\tHiredNonOwnedOnlyPremium,\n\t\tHiredNonOwnedOnlyPremiumAudited,\n\t\tLocalOwnerOperatorPremium,\n\t\tLocalOwnerOperatorPremiumAudited,\n\t\tIntermediateOwnerOperatorPremium,\n\t\tIntermediateOwnerOperatorPremiumAudited,\n\t\tLongHaulOwnerOperatorPremium,\n\t\tLongHaulOwnerOperatorPremiumAudited,\n\t\tGarageLiabilityPremium,\n\t\tGarageLiabilityPremiumAudited,\n\t\tFirstMillionBasePremium,\n\t\tExtraHeavyTruckTractorPremiumAudited,\n\t\tExtraHeavyTruckTractorPremium,\n\t\tReinsurancePremium,\n\t\tFirstMillionBasePremiumForGarage,\n\t\tFirstMillionBasePremiumForRatingWorksheetModifiedPremium,\n\t\tBusCount,\n\t\tBusCountAudited,\n\t\tLocalOwnerOperatorCount,\n\t\tLocalOwnerOperatorCountAudited,\n\t\tIntermediateOwnerOperatorCount,\n\t\tIntermediateOwnerOperatorCountAudited,\n\t\tLongHaulOwnerOperatorCount,\n\t\tLongHaulOwnerOperatorCountAudited,\n\t\tExtraHeavyTruckTractorCountAudited,\n\t\tExtraHeavyTruckTractorCount,\n\t\tPrivatePassengerPremiumOverride,\n\t\tLightVehiclePremiumOverride,\n\t\tMediumVehiclePremiumOverride,\n\t\tHeavyVehiclePremiumOverride,\n\t\tExtraHeavyVehiclePremiumOverride,\n\t\tBusPremiumOverride,\n\t\tHiredNonOwnedOnlyPremiumOverride,\n\t\tGarageLiabilityPremiumOverride,\n\t\tAllOtherPremiumOverride,\n\t\tExtraHeavyTruckTractorPremiumOverride,\n\t\tPrivatePassengerRevisedPremium,\n\t\tLightVehicleRevisedPremium,\n\t\tMediumVehicleRevisedPremium,\n\t\tHeavyVehicleRevisedPremium,\n\t\tExtraHeavyVehicleRevisedPremium,\n\t\tBusRevisedPremium,\n\t\tHiredNonOwnedOnlyRevisedPremium,\n\t\tAllOtherRevisedPremium,\n\t\tGarageLiabilityRevisedPremium,\n\t\tExtraHeavyTruckTractorRevisedPremium,\n\t\tScheduledModification,\n\t\tFirstMillionModifiedPremium,\n\t\tReinsuranceFactor,\n\t\tOriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\t\tOriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\t\tGarageLiabilityLimitsHeader,\n\t\tIDField,\n\t\tAutoLocationScheduleModDispersionComment,\n\t\tAutoLocationScheduleModDispersionModification,\n\t\tAutoLocationScheduleModEmployeesComment,\n\t\tAutoLocationScheduleModEmployeesModification,\n\t\tAutoLocationScheduleModEquipmentComment,\n\t\tAutoLocationScheduleModEquipmentModification,\n\t\tAutoLocationScheduleModManagementComment,\n\t\tAutoLocationScheduleModManagementModification,\n\t\tAutoLocationScheduleModProtectionComment,\n\t\tAutoLocationScheduleModProtectionModification,\n\t\tAutoLocationScheduleModSafetyComment,\n\t\tAutoLocationScheduleModSafetyModification,\n\t\tModificationTotal,\n\t\tModificationTotalForAutoDetailPage\n\tFROM WBCUUmbrellaCommercialAutoStaging\n),\nEXP_Metadata AS (\n\tSELECT\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,\n\tCU_UmbrellaCommercialAutoId,\n\tWB_CU_UmbrellaCommercialAutoId,\n\tSessionId,\n\tDeleted,\n\t-- *INF*: DECODE(Deleted,'T',1,'F',0,NULL)\n\tDECODE(\n\t    Deleted,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS Deleted_out,\n\tAggregateLimit,\n\tLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\tLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\tPersonalInjury,\n\tOtherDescription,\n\tHiredNonOwnedOnlyPremium,\n\tHiredNonOwnedOnlyPremiumAudited,\n\tLocalOwnerOperatorPremium,\n\tLocalOwnerOperatorPremiumAudited,\n\tIntermediateOwnerOperatorPremium,\n\tIntermediateOwnerOperatorPremiumAudited,\n\tLongHaulOwnerOperatorPremium,\n\tLongHaulOwnerOperatorPremiumAudited,\n\tGarageLiabilityPremium,\n\tGarageLiabilityPremiumAudited,\n\tFirstMillionBasePremium,\n\tExtraHeavyTruckTractorPremiumAudited,\n\tExtraHeavyTruckTractorPremium,\n\tReinsurancePremium,\n\tFirstMillionBasePremiumForGarage,\n\tFirstMillionBasePremiumForRatingWorksheetModifiedPremium,\n\tBusCount,\n\tBusCountAudited,\n\tLocalOwnerOperatorCount,\n\tLocalOwnerOperatorCountAudited,\n\tIntermediateOwnerOperatorCount,\n\tIntermediateOwnerOperatorCountAudited,\n\tLongHaulOwnerOperatorCount,\n\tLongHaulOwnerOperatorCountAudited,\n\tExtraHeavyTruckTractorCountAudited,\n\tExtraHeavyTruckTractorCount,\n\tPrivatePassengerPremiumOverride,\n\t-- *INF*: DECODE(PrivatePassengerPremiumOverride,'T','1','F','0',NULL)\n\tDECODE(\n\t    PrivatePassengerPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS PrivatePassengerPremiumOverride_out,\n\tLightVehiclePremiumOverride,\n\t-- *INF*: DECODE(LightVehiclePremiumOverride,'T','1','F','0',NULL)\n\tDECODE(\n\t    LightVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS LightVehiclePremiumOverride_out,\n\tMediumVehiclePremiumOverride,\n\t-- *INF*: decode(MediumVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    MediumVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS MediumVehiclePremiumOverride_out,\n\tHeavyVehiclePremiumOverride,\n\t-- *INF*: decode(HeavyVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    HeavyVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS HeavyVehiclePremiumOverride_out,\n\tExtraHeavyVehiclePremiumOverride,\n\t-- *INF*: decode(ExtraHeavyVehiclePremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    ExtraHeavyVehiclePremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS ExtraHeavyVehiclePremiumOverride_out,\n\tBusPremiumOverride,\n\t-- *INF*: decode(BusPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    BusPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS BusPremiumOverride_out,\n\tHiredNonOwnedOnlyPremiumOverride,\n\t-- *INF*: decode(HiredNonOwnedOnlyPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    HiredNonOwnedOnlyPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS HiredNonOwnedOnlyPremiumOverride_out,\n\tGarageLiabilityPremiumOverride,\n\t-- *INF*: decode(GarageLiabilityPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    GarageLiabilityPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS GarageLiabilityPremiumOverride_out,\n\tAllOtherPremiumOverride,\n\t-- *INF*: decode(AllOtherPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    AllOtherPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS AllOtherPremiumOverride_out,\n\tExtraHeavyTruckTractorPremiumOverride,\n\t-- *INF*: decode(ExtraHeavyTruckTractorPremiumOverride,'T','1','F','0',NULL)\n\tdecode(\n\t    ExtraHeavyTruckTractorPremiumOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS ExtraHeavyTruckTractorPremiumOverride_out,\n\tPrivatePassengerRevisedPremium,\n\tLightVehicleRevisedPremium,\n\tMediumVehicleRevisedPremium,\n\tHeavyVehicleRevisedPremium,\n\tExtraHeavyVehicleRevisedPremium,\n\tBusRevisedPremium,\n\tHiredNonOwnedOnlyRevisedPremium,\n\tAllOtherRevisedPremium,\n\tGarageLiabilityRevisedPremium,\n\tExtraHeavyTruckTractorRevisedPremium,\n\tScheduledModification,\n\tFirstMillionModifiedPremium,\n\tReinsuranceFactor,\n\tOriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly,\n\tOriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly,\n\tGarageLiabilityLimitsHeader,\n\tIDField,\n\tAutoLocationScheduleModDispersionComment,\n\tAutoLocationScheduleModDispersionModification,\n\tAutoLocationScheduleModEmployeesComment,\n\tAutoLocationScheduleModEmployeesModification,\n\tAutoLocationScheduleModEquipmentComment,\n\tAutoLocationScheduleModEquipmentModification,\n\tAutoLocationScheduleModManagementComment,\n\tAutoLocationScheduleModManagementModification,\n\tAutoLocationScheduleModProtectionComment,\n\tAutoLocationScheduleModProtectionModification,\n\tAutoLocationScheduleModSafetyComment,\n\tAutoLocationScheduleModSafetyModification,\n\tModificationTotal,\n\tModificationTotalForAutoDetailPage\n\tFROM SQ_WBCUUmbrellaCommercialAutoStaging\n),\narchWBCUUmbrellaCommercialAutoStaging AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archWBCUUmbrellaCommercialAutoStaging\n\t(ExtractDate, SourceSystemId, AuditId, CU_UmbrellaCommercialAutoId, WB_CU_UmbrellaCommercialAutoId, SessionId, Deleted, AggregateLimit, LiabilityLimitEachAccidentGarageOperationsAutoOnly, LiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, PersonalInjury, OtherDescription, HiredNonOwnedOnlyPremium, HiredNonOwnedOnlyPremiumAudited, LocalOwnerOperatorPremium, LocalOwnerOperatorPremiumAudited, IntermediateOwnerOperatorPremium, IntermediateOwnerOperatorPremiumAudited, LongHaulOwnerOperatorPremium, LongHaulOwnerOperatorPremiumAudited, GarageLiabilityPremium, GarageLiabilityPremiumAudited, FirstMillionBasePremium, ExtraHeavyTruckTractorPremiumAudited, ExtraHeavyTruckTractorPremium, ReinsurancePremium, FirstMillionBasePremiumForGarage, FirstMillionBasePremiumForRatingWorksheetModifiedPremium, BusCount, BusCountAudited, LocalOwnerOperatorCount, LocalOwnerOperatorCountAudited, IntermediateOwnerOperatorCount, IntermediateOwnerOperatorCountAudited, LongHaulOwnerOperatorCount, LongHaulOwnerOperatorCountAudited, ExtraHeavyTruckTractorCountAudited, ExtraHeavyTruckTractorCount, PrivatePassengerPremiumOverride, LightVehiclePremiumOverride, MediumVehiclePremiumOverride, HeavyVehiclePremiumOverride, ExtraHeavyVehiclePremiumOverride, BusPremiumOverride, HiredNonOwnedOnlyPremiumOverride, GarageLiabilityPremiumOverride, AllOtherPremiumOverride, ExtraHeavyTruckTractorPremiumOverride, PrivatePassengerRevisedPremium, LightVehicleRevisedPremium, MediumVehicleRevisedPremium, HeavyVehicleRevisedPremium, ExtraHeavyVehicleRevisedPremium, BusRevisedPremium, HiredNonOwnedOnlyRevisedPremium, AllOtherRevisedPremium, GarageLiabilityRevisedPremium, ExtraHeavyTruckTractorRevisedPremium, ScheduledModification, FirstMillionModifiedPremium, ReinsuranceFactor, OriginalLiabilityLimitEachAccidentGarageOperationsOtherThanAutoOnly, OriginalLiabilityLimitEachAccidentGarageOperationsAutoOnly, GarageLiabilityLimitsHeader, IDField, AutoLocationScheduleModDispersionComment, AutoLocationScheduleModDispersionModification, AutoLocationScheduleModEmployeesComment, AutoLocationScheduleModEmployeesModification, AutoLocationScheduleModEquipmentComment, AutoLocationScheduleModEquipmentModification, AutoLocationScheduleModManagementComment, AutoLocationScheduleModManagementModification, AutoLocationScheduleModProtectionComment, AutoLocationScheduleModProtectionModification, AutoLocationScheduleModSafetyComment, AutoLocationScheduleModSafetyModification, ModificationTotal, ModificationTotalForAutoDetailPage)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\tAUDITID, \n\tCU_UMBRELLACOMMERCIALAUTOID, \n\tWB_CU_UMBRELLACOMMERCIALAUTOID, \n\tSESSIONID, \n\tDeleted_out AS DELETED, \n\tAGGREGATELIMIT, \n\tLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSAUTOONLY, \n\tLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSOTHERTHANAUTOONLY, \n\tPERSONALINJURY, \n\tOTHERDESCRIPTION, \n\tHIREDNONOWNEDONLYPREMIUM, \n\tHIREDNONOWNEDONLYPREMIUMAUDITED, \n\tLOCALOWNEROPERATORPREMIUM, \n\tLOCALOWNEROPERATORPREMIUMAUDITED, \n\tINTERMEDIATEOWNEROPERATORPREMIUM, \n\tINTERMEDIATEOWNEROPERATORPREMIUMAUDITED, \n\tLONGHAULOWNEROPERATORPREMIUM, \n\tLONGHAULOWNEROPERATORPREMIUMAUDITED, \n\tGARAGELIABILITYPREMIUM, \n\tGARAGELIABILITYPREMIUMAUDITED, \n\tFIRSTMILLIONBASEPREMIUM, \n\tEXTRAHEAVYTRUCKTRACTORPREMIUMAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORPREMIUM, \n\tREINSURANCEPREMIUM, \n\tFIRSTMILLIONBASEPREMIUMFORGARAGE, \n\tFIRSTMILLIONBASEPREMIUMFORRATINGWORKSHEETMODIFIEDPREMIUM, \n\tBUSCOUNT, \n\tBUSCOUNTAUDITED, \n\tLOCALOWNEROPERATORCOUNT, \n\tLOCALOWNEROPERATORCOUNTAUDITED, \n\tINTERMEDIATEOWNEROPERATORCOUNT, \n\tINTERMEDIATEOWNEROPERATORCOUNTAUDITED, \n\tLONGHAULOWNEROPERATORCOUNT, \n\tLONGHAULOWNEROPERATORCOUNTAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORCOUNTAUDITED, \n\tEXTRAHEAVYTRUCKTRACTORCOUNT, \n\tPrivatePassengerPremiumOverride_out AS PRIVATEPASSENGERPREMIUMOVERRIDE, \n\tLightVehiclePremiumOverride_out AS LIGHTVEHICLEPREMIUMOVERRIDE, \n\tMediumVehiclePremiumOverride_out AS MEDIUMVEHICLEPREMIUMOVERRIDE, \n\tHeavyVehiclePremiumOverride_out AS HEAVYVEHICLEPREMIUMOVERRIDE, \n\tExtraHeavyVehiclePremiumOverride_out AS EXTRAHEAVYVEHICLEPREMIUMOVERRIDE, \n\tBusPremiumOverride_out AS BUSPREMIUMOVERRIDE, \n\tHiredNonOwnedOnlyPremiumOverride_out AS HIREDNONOWNEDONLYPREMIUMOVERRIDE, \n\tGarageLiabilityPremiumOverride_out AS GARAGELIABILITYPREMIUMOVERRIDE, \n\tAllOtherPremiumOverride_out AS ALLOTHERPREMIUMOVERRIDE, \n\tExtraHeavyTruckTractorPremiumOverride_out AS EXTRAHEAVYTRUCKTRACTORPREMIUMOVERRIDE, \n\tPRIVATEPASSENGERREVISEDPREMIUM, \n\tLIGHTVEHICLEREVISEDPREMIUM, \n\tMEDIUMVEHICLEREVISEDPREMIUM, \n\tHEAVYVEHICLEREVISEDPREMIUM, \n\tEXTRAHEAVYVEHICLEREVISEDPREMIUM, \n\tBUSREVISEDPREMIUM, \n\tHIREDNONOWNEDONLYREVISEDPREMIUM, \n\tALLOTHERREVISEDPREMIUM, \n\tGARAGELIABILITYREVISEDPREMIUM, \n\tEXTRAHEAVYTRUCKTRACTORREVISEDPREMIUM, \n\tSCHEDULEDMODIFICATION, \n\tFIRSTMILLIONMODIFIEDPREMIUM, \n\tREINSURANCEFACTOR, \n\tORIGINALLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSOTHERTHANAUTOONLY, \n\tORIGINALLIABILITYLIMITEACHACCIDENTGARAGEOPERATIONSAUTOONLY, \n\tGARAGELIABILITYLIMITSHEADER, \n\tIDFIELD, \n\tAUTOLOCATIONSCHEDULEMODDISPERSIONCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODDISPERSIONMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODEMPLOYEESCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODEMPLOYEESMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODEQUIPMENTCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODEQUIPMENTMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODMANAGEMENTCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODMANAGEMENTMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODPROTECTIONCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODPROTECTIONMODIFICATION, \n\tAUTOLOCATIONSCHEDULEMODSAFETYCOMMENT, \n\tAUTOLOCATIONSCHEDULEMODSAFETYMODIFICATION, \n\tMODIFICATIONTOTAL, \n\tMODIFICATIONTOTALFORAUTODETAILPAGE\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}