{
    "name": "s_m_POL_FEED_Load_WCPOLS_08_Record",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_08_Record",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_SupWCPOLS AS (\n\tSELECT\n\tWCPOLSCode,\n\tSourcesystemID,\n\tSourceCode,\n\tTableName,\n\tProcessName,\n\ti_SourcesystemID,\n\ti_SourceCode,\n\ti_TableName,\n\ti_ProcessName\n\tFROM (\n\t\tSELECT\r\n\t\t     WCPOLSCode as WCPOLSCode\r\n\t\t\t,SourcesystemID as SourcesystemID\r\n\t\t\t,SourceCode as SourceCode\r\n\t\t\t,TableName as TableName\r\n\t\t\t,ProcessName as ProcessName\r\n\t\tFROM SupWCPOLS\r\n\t\tWHERE CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SourcesystemID,SourceCode,TableName,ProcessName ORDER BY WCPOLSCode) = 1\n),\nSQ_WCPols00Record AS (\n\tSELECT\r\n\t\tWCTrackHistoryID,\r\n\t\tLinkData,\r\n\t     AuditId,\r\n\t\tTransactionCode\r\n\tFROM dbo.WCPols00Record\r\n\tWHERE 1=1\r\n\tAND AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tORDER BY WCTrackHistoryID\n),\nSQ_WorkWC_08_Record AS (\n\tSELECT DISTINCT\r\n\t\tst.WCTrackHistoryID\r\n\t\t,th.HistoryID\r\n\t\t,th.TransactionType\r\n\t\t,th.ReasonCode\r\n\t\t,pol.PolicyEffectiveDate\r\n\t\t,pol.PolicyExpirationDate\r\n\t\t,pol.TransactionEffectiveDate\r\n\t\t,pol.TransactionExpirationDate\r\n\t\t,pty.Name\r\n\t\t,pty.DoingBusinessAs\r\n\t\t,L.Address1\r\n\t\t,L.Address2\r\n\t\t,L.City\r\n\t\t,L.StateProv\r\n\t\t,L.PostalCode\r\n\t    ,pol.Division\r\n\t    ,pol.TransactionDate\r\n\t\t,pol.PolicyKey\r\n\t     ,th.MIRequiredFlag\r\n\t  ,th.NCRequiredFlag\r\n\t,th.MNRequiredFlag\r\n\t,th.WIRequiredFlag\r\n\tFROM dbo.WorkWCStateTerm st\r\n\t\r\n\tINNER JOIN dbo.WorkWCTrackHistory th\r\n\t\tON th.WCTrackHistoryID = st.WCTrackHistoryID\r\n\t     AND \r\n\t\t\t\tth.TransactionType in ('Cancel','CancelPending','Reinstate','RescindCancelPending','Nonrenew')\r\n\t\r\n\tLEFT JOIN dbo.WorkWCParty pty\r\n\t\tON st.WCTrackHistoryID = pty.WCTrackHistoryID\r\n\t\t\tAND pty.PartyAssociationType = 'Account'\r\n\t\r\n\tLEFT JOIN dbo.WorkWCLocation L\r\n\t\tON st.WCTrackHistoryID = L.WCTrackHistoryID\r\n\t\t\tAND L.LocationType = 'Account'\r\n\t\r\n\tINNER JOIN dbo.WorkWCPolicy pol\r\n\t\tON st.WCTrackHistoryID = pol.WCTrackHistoryID\r\n\t\r\n\tWHERE 1 = 1\r\n\tAND st.AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\t@{pipeline().parameters.WHERE_CLAUSE_08}\r\n\t\r\n\tORDER BY st.WCTrackHistoryID\n),\nJNR_08_Record AS (SELECT\n\tSQ_WCPols00Record.WCTrackHistoryID, \n\tSQ_WCPols00Record.LinkData, \n\tSQ_WCPols00Record.AuditId, \n\tSQ_WCPols00Record.TransactionCode, \n\tSQ_WorkWC_08_Record.WCTrackHistoryID AS WCTrackHistoryID1, \n\tSQ_WorkWC_08_Record.HistoryID, \n\tSQ_WorkWC_08_Record.TransactionType, \n\tSQ_WorkWC_08_Record.ReasonCode, \n\tSQ_WorkWC_08_Record.PolicyEffectiveDate, \n\tSQ_WorkWC_08_Record.PolicyExpirationDate, \n\tSQ_WorkWC_08_Record.TransactionEffectiveDate, \n\tSQ_WorkWC_08_Record.TransactionExpirationDate, \n\tSQ_WorkWC_08_Record.Name, \n\tSQ_WorkWC_08_Record.DoingBusinessAs, \n\tSQ_WorkWC_08_Record.Address1, \n\tSQ_WorkWC_08_Record.Address2, \n\tSQ_WorkWC_08_Record.City, \n\tSQ_WorkWC_08_Record.StateProv, \n\tSQ_WorkWC_08_Record.PostalCode, \n\tSQ_WorkWC_08_Record.Division, \n\tSQ_WorkWC_08_Record.TransactionDate, \n\tSQ_WorkWC_08_Record.PolicyKey, \n\tSQ_WorkWC_08_Record.MIRequiredFlag, \n\tSQ_WorkWC_08_Record.NCRequiredFlag, \n\tSQ_WorkWC_08_Record.MNRequiredFlag, \n\tSQ_WorkWC_08_Record.WIRequiredFlag\n\tFROM SQ_WorkWC_08_Record\n\tINNER JOIN SQ_WCPols00Record\n\tON SQ_WCPols00Record.WCTrackHistoryID = SQ_WorkWC_08_Record.WCTrackHistoryID\n),\nEXP_08_Format AS (\n\tSELECT\n\tCURRENT_TIMESTAMP AS ExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tPolicyKey,\n\tHistoryID,\n\tTransactionType,\n\tReasonCode,\n\tPolicyEffectiveDate,\n\tPolicyExpirationDate,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\tName,\n\tDoingBusinessAs,\n\tAddress1,\n\tAddress2,\n\tCity,\n\tStateProv,\n\tPostalCode,\n\tDivision,\n\tTransactionDate,\n\t'08' AS o_RecordTypeCode,\n\t-- *INF*: IIF (Division = 'WCPool' and TransactionType='NonRenew' and ReasonCode = 'NonPaymentofRenewal','Cancel',TransactionType)\n\tIFF(\n\t    Division = 'WCPool' and TransactionType = 'NonRenew' and ReasonCode = 'NonPaymentofRenewal',\n\t    'Cancel',\n\t    TransactionType\n\t) AS v_Lookup_TransType,\n\t-- *INF*:  :LKP.LKP_SupWCPOLS('DCT',TransactionType,'WCPOLS08Record','CancellationReinstatementIDCode')\n\tLKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode.WCPOLSCode AS v_CancellationReinstatementIDCode,\n\t-- *INF*:  :LKP.LKP_SupWCPOLS('DCT',v_Lookup_TransType,'WCPOLS08Record','CancellationReinstatementIDCode')\n\tLKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode.WCPOLSCode AS v_CancellationReinstatementIDCode_WI,\n\tv_CancellationReinstatementIDCode AS o_CancellationReinstatementIDCode,\n\tv_CancellationReinstatementIDCode_WI AS o_CancellationReinstatementIDCode_WI,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode <> '1','0',\r\n\t-- IIF(PolicyEffectiveDate = TransactionEffectiveDate, :LKP.LKP_SupWCPOLS('DCT','FlatCancel','WCPOLS08Record','CancellationTypeCode'),\r\n\t-- :LKP.LKP_SupWCPOLS('DCT','MidTermCancel','WCPOLS08Record','CancellationTypeCode')))\n\tIFF(\n\t    v_CancellationReinstatementIDCode <> '1', '0',\n\t    IFF(\n\t        PolicyEffectiveDate = TransactionEffectiveDate,\n\t        LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.WCPOLSCode,\n\t        LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.WCPOLSCode\n\t    )\n\t) AS o_CancellationTypeCode,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode_WI<> '1','0',\r\n\t-- IIF(PolicyEffectiveDate = TransactionEffectiveDate, :LKP.LKP_SupWCPOLS('DCT','FlatCancel','WCPOLS08Record','CancellationTypeCode'),\r\n\t-- :LKP.LKP_SupWCPOLS('DCT','MidTermCancel','WCPOLS08Record','CancellationTypeCode')))\n\tIFF(\n\t    v_CancellationReinstatementIDCode_WI <> '1', '0',\n\t    IFF(\n\t        PolicyEffectiveDate = TransactionEffectiveDate,\n\t        LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.WCPOLSCode,\n\t        LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.WCPOLSCode\n\t    )\n\t) AS o_CancellationTypeCode_WI,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode_WI <> '1',NULL, :LKP.LKP_SupWCPOLS('DCT',ReasonCode,'WCPOLS08Record','ReasonForCancellationCode'))\n\tIFF(\n\t    v_CancellationReinstatementIDCode_WI <> '1', NULL,\n\t    LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.WCPOLSCode\n\t) AS o_ReasonForCancellationCode_WI,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode <> '2','0',\r\n\t-- IIF(PolicyEffectiveDate = TransactionEffectiveDate, :LKP.LKP_SupWCPOLS('DCT','ReinstateFlatCancel','WCPOLS08Record','ReinstatementTypeCode'),\r\n\t-- :LKP.LKP_SupWCPOLS('DCT','ReinstateMidTermCancel','WCPOLS08Record','ReinstatementTypeCode')))\n\tIFF(\n\t    v_CancellationReinstatementIDCode <> '2', '0',\n\t    IFF(\n\t        PolicyEffectiveDate = TransactionEffectiveDate,\n\t        LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.WCPOLSCode,\n\t        LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.WCPOLSCode\n\t    )\n\t) AS o_ReinstatementTypeCode,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode_WI <> '2','0', IIF(PolicyEffectiveDate = TransactionEffectiveDate, :LKP.LKP_SupWCPOLS('DCT','ReinstateFlatCancel','WCPOLS08Record','ReinstatementTypeCode'), :LKP.LKP_SupWCPOLS('DCT','ReinstateMidTermCancel','WCPOLS08Record','ReinstatementTypeCode')))\n\tIFF(\n\t    v_CancellationReinstatementIDCode_WI <> '2', '0',\n\t    IFF(\n\t        PolicyEffectiveDate = TransactionEffectiveDate,\n\t        LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.WCPOLSCode,\n\t        LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.WCPOLSCode\n\t    )\n\t) AS o_ReinstatementTypeCode_WI,\n\t-- *INF*: IIF (IsNull(DoingBusinessAs) or RTrim(DoingBusinessAs) = '', RTrim(Name),  RTrim(Name) || ' DBA ' || RTrim(DoingBusinessAs))\n\tIFF(\n\t    DoingBusinessAs IS NULL or RTrim(DoingBusinessAs) = '', RTrim(Name),\n\t    RTrim(Name) || ' DBA ' || RTrim(DoingBusinessAs)\n\t) AS o_NameOfInsured,\n\t-- *INF*: Address1 || RTRIM(' ' || Address2) || ' ' || City || ' ' || StateProv || ' ' || PostalCode\n\tAddress1 || RTRIM(' ' || Address2) || ' ' || City || ' ' || StateProv || ' ' || PostalCode AS o_AddressOfInsured,\n\t-- *INF*: IIF(in(v_CancellationReinstatementIDCode, '1','3'),To_Char(TransactionDate,'YYMMDD'),NULL)\n\tIFF(\n\t    v_CancellationReinstatementIDCode IN ('1','3'), To_Char(TransactionDate, 'YYMMDD'), NULL\n\t) AS o_CancellationMailedtoInsuredDate,\n\t-- *INF*: IIF(IN(v_CancellationReinstatementIDCode_WI, '1','3'),To_Char(TransactionDate,'YYMMDD'),NULL)\n\tIFF(\n\t    v_CancellationReinstatementIDCode_WI IN ('1','3'), To_Char(TransactionDate, 'YYMMDD'), NULL\n\t) AS o_CancellationMailedtoInsuredDate_WI,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode = '2','01','00')\r\n\t-- \n\tIFF(v_CancellationReinstatementIDCode = '2', '01', '00') AS o_ReasonForReinstatementCode,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode_WI = '2','01','00')\n\tIFF(v_CancellationReinstatementIDCode_WI = '2', '01', '00') AS o_ReasonForReinstatementCode_WI,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode = '2',To_Char(TransactionEffectiveDate,'YYMMDD'),NULL)\n\tIFF(\n\t    v_CancellationReinstatementIDCode = '2', To_Char(TransactionEffectiveDate, 'YYMMDD'), NULL\n\t) AS o_CorrespondingCancellationEffectiveDate,\n\t-- *INF*: IIF(v_CancellationReinstatementIDCode_WI = '2',To_Char(TransactionEffectiveDate,'YYMMDD'),NULL)\n\tIFF(\n\t    v_CancellationReinstatementIDCode_WI = '2', To_Char(TransactionEffectiveDate, 'YYMMDD'),\n\t    NULL\n\t) AS o_CorrespondingCancellationEffectiveDate_WI,\n\t-- *INF*: To_Char(TransactionEffectiveDate,'YYMMDD')\n\tTo_Char(TransactionEffectiveDate, 'YYMMDD') AS o_CancellationReinstatementEffectiveDate,\n\t-- *INF*: To_Char(TransactionEffectiveDate,'YYMMDD')\n\tTo_Char(TransactionEffectiveDate, 'YYMMDD') AS o_CancellationReinstatementEffectiveDate_WI,\n\tMIRequiredFlag,\n\tMNRequiredFlag,\n\tNCRequiredFlag,\n\tWIRequiredFlag,\n\t-- *INF*: --IIF(v_CancellationReinstatementIDCode = '2',NULL,:LKP.LKP_SupWCPOLS('DCT',ReasonCode,'WCPOLS08Record','ReasonForCancellationCode'))\r\n\t-- \r\n\t-- decode( true,\r\n\t-- v_CancellationReinstatementIDCode = '2',NULL,\r\n\t-- (v_CancellationReinstatementIDCode = '3' and MNRequiredFlag = 'T') , '00',\r\n\t-- (v_CancellationReinstatementIDCode = '3' and NCRequiredFlag = 'T') , '00',\r\n\t-- (v_CancellationReinstatementIDCode = '3' and WIRequiredFlag = 'T') , '00',\r\n\t-- :LKP.LKP_SupWCPOLS('DCT',ReasonCode,'WCPOLS08Record','ReasonForCancellationCode'))\n\tdecode(\n\t    true,\n\t    v_CancellationReinstatementIDCode = '2', NULL,\n\t    (v_CancellationReinstatementIDCode = '3' and MNRequiredFlag = 'T'), '00',\n\t    (v_CancellationReinstatementIDCode = '3' and NCRequiredFlag = 'T'), '00',\n\t    (v_CancellationReinstatementIDCode = '3' and WIRequiredFlag = 'T'), '00',\n\t    LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.WCPOLSCode\n\t) AS v_ReasonForCancellationCode,\n\t-- *INF*: IIF( (MIRequiredFlag = 'T'  and v_ReasonForCancellationCode ='99' ) , '19' ,v_ReasonForCancellationCode) \r\n\t-- \r\n\t-- --previous logic\r\n\t-- --IIF(v_CancellationReinstatementIDCode <> '1',NULL,:LKP.LKP_SupWCPOLS('DCT',ReasonCode,'WCPOLS08Record','ReasonForCancellationCode'))\n\tIFF(\n\t    (MIRequiredFlag = 'T' and v_ReasonForCancellationCode = '99'), '19',\n\t    v_ReasonForCancellationCode\n\t) AS o_ReasonForCancellationCode\n\tFROM JNR_08_Record\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode\n\tON LKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode.SourceCode = TransactionType\n\tAND LKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_TransactionType_WCPOLS08Record_CancellationReinstatementIDCode.ProcessName = 'CancellationReinstatementIDCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode\n\tON LKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode.SourceCode = v_Lookup_TransType\n\tAND LKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_v_Lookup_TransType_WCPOLS08Record_CancellationReinstatementIDCode.ProcessName = 'CancellationReinstatementIDCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode\n\tON LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.SourceCode = 'FlatCancel'\n\tAND LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_FlatCancel_WCPOLS08Record_CancellationTypeCode.ProcessName = 'CancellationTypeCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode\n\tON LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.SourceCode = 'MidTermCancel'\n\tAND LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_MidTermCancel_WCPOLS08Record_CancellationTypeCode.ProcessName = 'CancellationTypeCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode\n\tON LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.SourceCode = ReasonCode\n\tAND LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_ReasonCode_WCPOLS08Record_ReasonForCancellationCode.ProcessName = 'ReasonForCancellationCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode\n\tON LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.SourceCode = 'ReinstateFlatCancel'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateFlatCancel_WCPOLS08Record_ReinstatementTypeCode.ProcessName = 'ReinstatementTypeCode'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode\n\tON LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.SourceCode = 'ReinstateMidTermCancel'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.TableName = 'WCPOLS08Record'\n\tAND LKP_SUPWCPOLS__DCT_ReinstateMidTermCancel_WCPOLS08Record_ReinstatementTypeCode.ProcessName = 'ReinstatementTypeCode'\n\n),\nSRT_TransSeq_Number AS (\n\tSELECT\n\tExtractDate, \n\tAuditId, \n\tWCTrackHistoryID, \n\tLinkData, \n\tPolicyKey, \n\tHistoryID, \n\to_RecordTypeCode AS RecordTypeCode, \n\to_CancellationReinstatementIDCode, \n\to_CancellationReinstatementIDCode_WI, \n\to_CancellationTypeCode, \n\to_CancellationTypeCode_WI, \n\to_ReasonForCancellationCode, \n\to_ReasonForCancellationCode_WI, \n\to_ReinstatementTypeCode, \n\to_ReinstatementTypeCode_WI, \n\to_NameOfInsured, \n\to_AddressOfInsured, \n\to_CancellationMailedtoInsuredDate, \n\to_CancellationMailedtoInsuredDate_WI, \n\to_ReasonForReinstatementCode, \n\to_ReasonForReinstatementCode_WI, \n\to_CorrespondingCancellationEffectiveDate, \n\to_CorrespondingCancellationEffectiveDate_WI, \n\to_CancellationReinstatementEffectiveDate, \n\to_CancellationReinstatementEffectiveDate_WI, \n\tReasonCode\n\tFROM EXP_08_Format\n\tORDER BY PolicyKey ASC, HistoryID ASC, o_CancellationReinstatementIDCode ASC, o_CancellationReinstatementIDCode_WI ASC\n),\nEXP_Create_TransSeq_Number AS (\n\tSELECT\n\tExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tPolicyKey,\n\tHistoryID,\n\t'99' AS StateCode,\n\tRecordTypeCode,\n\to_CancellationReinstatementIDCode AS CancellationReinstatementIDCode,\n\to_CancellationTypeCode AS CancellationTypeCode,\n\to_ReasonForCancellationCode AS ReasonForCancellationCode,\n\to_ReinstatementTypeCode AS ReinstatementTypeCode,\n\to_NameOfInsured AS NameOfInsured,\n\to_AddressOfInsured AS AddressOfInsured,\n\to_CancellationMailedtoInsuredDate AS CancellationMailedtoInsuredDate,\n\to_ReasonForReinstatementCode AS ReasonForReinstatementCode,\n\to_CorrespondingCancellationEffectiveDate AS CorrespondingCancellationEffectiveDate,\n\to_CancellationReinstatementEffectiveDate AS CancellationReinstatementEffectiveDate,\n\t-- *INF*: PolicyKey\r\n\t-- --PolicyKey|| '~' || CancellationReinstatementIDCode\n\tPolicyKey AS v_Grouping_Key,\n\t-- *INF*: IIF (IsNull(old_Grouping_Key) or old_Grouping_Key <> v_Grouping_Key, 1, v_Grouping_Cnt + 1)\n\tIFF(old_Grouping_Key IS NULL or old_Grouping_Key <> v_Grouping_Key, 1, v_Grouping_Cnt + 1) AS v_Grouping_Cnt,\n\tv_Grouping_Cnt AS o_CancellationReinstatementTransactionSequenceNumber,\n\tv_Grouping_Key AS old_Grouping_Key\n\tFROM SRT_TransSeq_Number\n),\nWCPols08Record AS (\n\n\t------------ PRE SQL ----------\n\tDELETE\r\n\t  FROM dbo.WCPols08Record\r\n\t  WHERE 1=1\r\n\t  AND AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n\t-------------------------------\n\n\n\tINSERT INTO WCPols08Record\n\t(ExtractDate, AuditId, WCTrackHistoryID, LinkData, StateCode, RecordTypeCode, CancellationReinstatementIDCode, CancellationTypeCode, ReasonForCancellationCode, ReinstatementTypeCode, NameOfInsured, AddressOfInsured, CancellationMailedtoInsuredDate, CancellationReinstatementTransactionSequenceNumber, ReasonForReinstatementCode, CorrespondingCancellationEffectiveDate, CancellationReinstatementEffectiveDate)\n\tSELECT \n\tEXTRACTDATE, \n\tAUDITID, \n\tWCTRACKHISTORYID, \n\tLINKDATA, \n\tSTATECODE, \n\tRECORDTYPECODE, \n\tCANCELLATIONREINSTATEMENTIDCODE, \n\tCANCELLATIONTYPECODE, \n\tREASONFORCANCELLATIONCODE, \n\tREINSTATEMENTTYPECODE, \n\tNAMEOFINSURED, \n\tADDRESSOFINSURED, \n\tCANCELLATIONMAILEDTOINSUREDDATE, \n\to_CancellationReinstatementTransactionSequenceNumber AS CANCELLATIONREINSTATEMENTTRANSACTIONSEQUENCENUMBER, \n\tREASONFORREINSTATEMENTCODE, \n\tCORRESPONDINGCANCELLATIONEFFECTIVEDATE, \n\tCANCELLATIONREINSTATEMENTEFFECTIVEDATE\n\tFROM EXP_Create_TransSeq_Number\n),\nEXP_Create_TransSeq_Number_WI AS (\n\tSELECT\n\tExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tPolicyKey,\n\tHistoryID,\n\t'99' AS StateCode,\n\tRecordTypeCode,\n\to_CancellationReinstatementIDCode_WI AS CancellationReinstatementIDCode,\n\to_CancellationTypeCode_WI AS CancellationTypeCode,\n\to_ReasonForCancellationCode_WI AS ReasonForCancellationCode,\n\tReasonCode,\n\t-- *INF*: IIF(ReasonForCancellationCode='20' and LTRIM(RTRIM(ReasonCode))='NPFC','05',ReasonForCancellationCode)\n\tIFF(\n\t    ReasonForCancellationCode = '20' and LTRIM(RTRIM(ReasonCode)) = 'NPFC', '05',\n\t    ReasonForCancellationCode\n\t) AS v_ReasonForCancellationCode,\n\t-- *INF*: IIF(ReasonForCancellationCode='04' and LTRIM(RTRIM(ReasonCode))='RewriteReissue','07',v_ReasonForCancellationCode)\n\tIFF(\n\t    ReasonForCancellationCode = '04' and LTRIM(RTRIM(ReasonCode)) = 'RewriteReissue', '07',\n\t    v_ReasonForCancellationCode\n\t) AS o_ReasonForCancellationCode,\n\to_ReinstatementTypeCode_WI AS ReinstatementTypeCode,\n\to_NameOfInsured AS NameOfInsured,\n\to_AddressOfInsured AS AddressOfInsured,\n\to_CancellationMailedtoInsuredDate_WI AS CancellationMailedtoInsuredDate,\n\to_ReasonForReinstatementCode_WI AS ReasonForReinstatementCode,\n\to_CorrespondingCancellationEffectiveDate_WI AS CorrespondingCancellationEffectiveDate,\n\to_CancellationReinstatementEffectiveDate_WI AS CancellationReinstatementEffectiveDate,\n\t-- *INF*: PolicyKey\r\n\t-- \r\n\t-- --PolicyKey|| '~' || CancellationReinstatementIDCode\n\tPolicyKey AS v_Grouping_Key,\n\t-- *INF*: IIF (IsNull(old_Grouping_Key) or old_Grouping_Key <> v_Grouping_Key, 1, v_Grouping_Cnt + 1)\n\tIFF(old_Grouping_Key IS NULL or old_Grouping_Key <> v_Grouping_Key, 1, v_Grouping_Cnt + 1) AS v_Grouping_Cnt,\n\tv_Grouping_Cnt AS o_CancellationReinstatementTransactionSequenceNumber,\n\tv_Grouping_Key AS old_Grouping_Key\n\tFROM SRT_TransSeq_Number\n),\nWCPols08RecordWI AS (\n\tINSERT INTO WCPols08RecordWI\n\t(ExtractDate, AuditId, WCTrackHistoryID, LinkData, StateCode, RecordTypeCode, CancellationReinstatementIDCode, CancellationTypeCode, ReasonForCancellationCode, ReinstatementTypeCode, NameOfInsured, AddressOfInsured, CancellationMailedtoInsuredDate, CancellationReinstatementTransactionSequenceNumber, ReasonForReinstatementCode, CorrespondingCancellationEffectiveDate, CancellationReinstatementEffectiveDate)\n\tSELECT \n\tEXTRACTDATE, \n\tAUDITID, \n\tWCTRACKHISTORYID, \n\tLINKDATA, \n\tSTATECODE, \n\tRECORDTYPECODE, \n\tCANCELLATIONREINSTATEMENTIDCODE, \n\tCANCELLATIONTYPECODE, \n\to_ReasonForCancellationCode AS REASONFORCANCELLATIONCODE, \n\tREINSTATEMENTTYPECODE, \n\tNAMEOFINSURED, \n\tADDRESSOFINSURED, \n\tCANCELLATIONMAILEDTOINSUREDDATE, \n\to_CancellationReinstatementTransactionSequenceNumber AS CANCELLATIONREINSTATEMENTTRANSACTIONSEQUENCENUMBER, \n\tREASONFORREINSTATEMENTCODE, \n\tCORRESPONDINGCANCELLATIONEFFECTIVEDATE, \n\tCANCELLATIONREINSTATEMENTEFFECTIVEDATE\n\tFROM EXP_Create_TransSeq_Number_WI\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_08": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}