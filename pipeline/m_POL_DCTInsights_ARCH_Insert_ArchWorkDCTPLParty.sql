WITH
SQ_WorkDCTPLParty AS (
	SELECT
		WorkDCTPLPartyId,
		ExtractDate,
		SourceSystemId,
		PolicyId,
		PartyId,
		AddressId,
		RoleId,
		PolicyKey,
		PartyKey,
		AddressKey,
		RoleCode,
		RoleDesc,
		PolicyNumber,
		PolicyVersion,
		PolicySymbol,
		CustomerNumber,
		FullName,
		FEIN,
		BusinessName,
		PrimaryPhone,
		PhoneExtension,
		Email,
		LastName,
		LegalEntityCode,
		FirstName,
		MiddleName,
		AddressType,
		StreetAddressLine1,
		StreetAddressLine2,
		StreetAddressLine3,
		CityName,
		StateName,
		PostalCode,
		PostalCodeExt,
		CountyName,
		CountryName,
		EmailType,
		EmailPriority,
		StartDate
	FROM WorkDCTPLParty
),
EXP_SRC_DataCollect AS (
	SELECT
	WorkDCTPLPartyId,
	ExtractDate,
	SourceSystemId,
	PolicyId,
	PartyId,
	AddressId,
	RoleId,
	PolicyKey,
	PartyKey,
	AddressKey,
	RoleCode,
	RoleDesc,
	PolicyNumber,
	PolicyVersion,
	PolicySymbol,
	CustomerNumber,
	FullName,
	FEIN,
	BusinessName,
	PrimaryPhone,
	PhoneExtension,
	Email,
	LastName,
	LegalEntityCode,
	FirstName,
	MiddleName,
	AddressType,
	StreetAddressLine1,
	StreetAddressLine2,
	StreetAddressLine3,
	CityName,
	StateName,
	PostalCode,
	PostalCodeExt,
	CountyName,
	CountryName,
	EmailType,
	EmailPriority,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_Auditid,
	StartDate
	FROM SQ_WorkDCTPLParty
),
ArchWorkDCTPLParty AS (
	INSERT INTO ArchWorkDCTPLParty
	(Auditid, ExtractDate, SourceSystemId, WorkDCTPLPartyId, PolicyId, PartyId, AddressId, RoleId, PolicyKey, PartyKey, AddressKey, RoleCode, RoleDesc, PolicyNumber, PolicyVersion, PolicySymbol, CustomerNumber, FullName, FEIN, BusinessName, PrimaryPhone, PhoneExtension, Email, LastName, LegalEntityCode, FirstName, MiddleName, AddressType, StreetAddressLine1, StreetAddressLine2, StreetAddressLine3, CityName, StateName, PostalCode, PostalCodeExt, CountyName, CountryName, EmailType, EmailPriority, StartDate)
	SELECT 
	o_Auditid AS AUDITID, 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	WORKDCTPLPARTYID, 
	POLICYID, 
	PARTYID, 
	ADDRESSID, 
	ROLEID, 
	POLICYKEY, 
	PARTYKEY, 
	ADDRESSKEY, 
	ROLECODE, 
	ROLEDESC, 
	POLICYNUMBER, 
	POLICYVERSION, 
	POLICYSYMBOL, 
	CUSTOMERNUMBER, 
	FULLNAME, 
	FEIN, 
	BUSINESSNAME, 
	PRIMARYPHONE, 
	PHONEEXTENSION, 
	EMAIL, 
	LASTNAME, 
	LEGALENTITYCODE, 
	FIRSTNAME, 
	MIDDLENAME, 
	ADDRESSTYPE, 
	STREETADDRESSLINE1, 
	STREETADDRESSLINE2, 
	STREETADDRESSLINE3, 
	CITYNAME, 
	STATENAME, 
	POSTALCODE, 
	POSTALCODEEXT, 
	COUNTYNAME, 
	COUNTRYNAME, 
	EMAILTYPE, 
	EMAILPRIORITY, 
	STARTDATE
	FROM EXP_SRC_DataCollect
),