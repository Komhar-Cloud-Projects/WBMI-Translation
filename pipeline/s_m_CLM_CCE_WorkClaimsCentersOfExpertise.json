{
    "name": "s_m_CLM_CCE_WorkClaimsCentersOfExpertise",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_CCE_WorkClaimsCentersOfExpertise",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_SupClaimsCentersOfExpertiseCoverage AS (\n\tSELECT\n\tSourceColumnAbbreviation,\n\tSupClaimsCentersOfExpertiseCoverageId,\n\tAuditId,\n\tCreatedDate,\n\tModifiedDate,\n\tSourceColumnName,\n\tSourceColumnValue,\n\ti_SourceColumnName,\n\ti_SourceColumnValue\n\tFROM (\n\t\tSELECT \n\t\t\tSourceColumnAbbreviation,\n\t\t\tSupClaimsCentersOfExpertiseCoverageId,\n\t\t\tAuditId,\n\t\t\tCreatedDate,\n\t\t\tModifiedDate,\n\t\t\tSourceColumnName,\n\t\t\tSourceColumnValue,\n\t\t\ti_SourceColumnName,\n\t\t\ti_SourceColumnValue\n\t\tFROM SupClaimsCentersOfExpertiseCoverage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SourceColumnName,SourceColumnValue ORDER BY SourceColumnAbbreviation) = 1\n),\nLKP_SupTypeOfLossRules AS (\n\tSELECT\n\tClaimTypeCategory,\n\tInsuranceSegmentCode,\n\tMajorPerilCode,\n\tCauseOfLoss,\n\ti_InsuranceSegmentCode,\n\ti_MajorPerilCode,\n\ti_CauseOfLoss\n\tFROM (\n\t\tSELECT SupTypeOfLossRules.ClaimTypeCategory as ClaimTypeCategory, SupTypeOfLossRules.InsuranceSegmentCode as InsuranceSegmentCode, SupTypeOfLossRules.MajorPerilCode as MajorPerilCode, SupTypeOfLossRules.CauseOfLoss as CauseOfLoss FROM  @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.SupTypeOfLossRules\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceSegmentCode,MajorPerilCode,CauseOfLoss ORDER BY ClaimTypeCategory) = 1\n),\nSQ_Work_Claims_Centers_of_Expertise AS (\n\t-- Claim, coverage or claimant changed\r\n\tSELECT vw_claim_party1.claim_party_key,\r\n\t\tclaimant_coverage_detail.ins_line,\r\n\t\tclaim_occurrence_dim.claim_num,\r\n\t\tcoverage_dim.major_peril_descript,\r\n\t\tclaimant_coverage_dim.cause_of_loss_long_descript,\r\n\t\tpolicy_dim.pol_num,\r\n\t\tclaim_occurrence_dim.claim_loss_date,\r\n\t\tclaim_occurrence_dim.claim_open_date,\r\n\t\tclaim_occurrence_dim.claim_close_date,\r\n\t\tclaim_occurrence_dim.claim_reopen_date,\r\n\t\tclaim_occurrence_dim.claim_closed_after_reopen_date,\r\n\t\tclaim_representative_dim.claim_rep_full_name,\r\n\t\tclaim_representative_dim.claim_rep_num,\r\n\t\tclaim_representative_dim.handling_office_mgr,\r\n\t\tclaim_representative_dim.handling_office_descript,\r\n\t\tvw_claimant_dim1.claimant_full_name,\r\n\t\tclaim_case_dim.suit_open_date,\r\n\t\tclaim_occurrence_dim.loss_loc_state,\r\n\t\tproduct_code_dim.prdct_code_descript,\r\n\t\tstrategic_business_division_dim.strtgc_bus_dvsn_code_descript,\r\n\t\tvw_claimant_dim1.jurisdiction_state_code,\r\n\t\tclaim_representative_dim.claim_rep_email,\r\n\t\tclaim_representative_dim.handling_office_mgr_email,\r\n\t\tclaim_occurrence_dim.loss_loc_zip,\r\n\t\tclaim_occurrence_dim.claim_cat_code,\r\n\t\tcontract_customer_dim.name,\r\n\t\tcoverage_dim.major_peril_code,\r\n\t\tclaimant_coverage_dim.cause_of_loss,\r\n\t\tclaimant_coverage_dim.reserve_ctgry,\r\n\t\tclaim_payment_category_type_dim.claim_pay_ctgry_type,\r\n\t\tclaimant_coverage_dim.reserve_ctgry_descript,\r\n\t\tclaim_occurrence_dim.source_claim_occurrence_status_code,\r\n\t\tcoverage_dim.type_bureau_code,\r\n\t\tcoverage_dim.risk_unit_grp,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_outstanding,\r\n\t\tclaim_representative_dim.claim_rep_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_loss_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_alae_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.claimant_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.claim_occurrence_dim_id,\r\n\t\tasl_dim.asl_code,\r\n\t\tInsuranceReferenceDim.InsuranceSegmentCode,\r\n\t\tInsuranceReferenceDim.ProductDescription,\r\n\t\tInsuranceReferenceDim.StrategicProfitCenterAbbreviation,\r\n\t\tInsuranceReferenceDim.StrategicProfitCenterDescription,\r\n\t\tv3.AgencyDim.AgencyCode,\r\n\t\tasl_dim.sub_non_asl_code_descript,\r\n\t\tClaimant_coverage_dim.MajorPerilCodeDescription,\r\n\t\tClaimant_coverage_dim.MajorPerilCode,\r\n\t\t-- added as per requirement in PROD-11861\r\n\t\tvw_claim_loss_transaction_fact.ClaimRepresentativeDimFeatureClaimRepresentativeId,\r\n\t\tInsuranceReferenceDim.InsuranceReferenceLineOfBusinessAbbreviation\r\n\t\t, claim_occurrence_dim.claim_loss_descript\r\n\t\t, claim_occurrence_dim.source_claim_rpted_date\r\n\t\t, policy_dim.pol_eff_date\r\n\t\t, policy_dim.pol_exp_date\r\n\tFROM dbo.policy_dim WITH (NOLOCK)\r\n\tINNER JOIN dbo.vw_claim_loss_transaction_fact WITH (NOLOCK) ON (dbo.policy_dim.pol_dim_id = dbo.vw_claim_loss_transaction_fact.pol_dim_id)\r\n\tINNER JOIN dbo.coverage_dim WITH (NOLOCK) ON (dbo.coverage_dim.cov_dim_id = dbo.vw_claim_loss_transaction_fact.cov_dim_id)\r\n\tINNER JOIN dbo.claim_occurrence_dim WITH (NOLOCK) ON (claim_occurrence_dim.claim_occurrence_dim_id = dbo.vw_claim_loss_transaction_fact.claim_occurrence_dim_id)\r\n\tINNER JOIN dbo.vw_claimant_dim1 WITH (NOLOCK) ON (vw_claimant_dim1.claimant_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_dim_id)\r\n\tINNER JOIN dbo.claimant_coverage_dim WITH (NOLOCK) ON (claimant_coverage_dim.claimant_cov_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_cov_dim_id)\r\n\tINNER JOIN dbo.claim_representative_dim WITH (NOLOCK) ON (dbo.claim_representative_dim.claim_rep_dim_id = dbo.vw_claim_loss_transaction_fact.claim_rep_dim_prim_claim_rep_id)\r\n\tINNER JOIN dbo.claim_case_dim WITH (NOLOCK) ON (dbo.claim_case_dim.claim_case_dim_id = dbo.vw_claim_loss_transaction_fact.claim_case_dim_id)\r\n\tINNER JOIN dbo.contract_customer_dim WITH (NOLOCK) ON (dbo.contract_customer_dim.contract_cust_dim_id = dbo.vw_claim_loss_transaction_fact.contract_cust_dim_id)\r\n\tINNER JOIN dbo.strategic_business_division_dim WITH (NOLOCK) ON (dbo.strategic_business_division_dim.strtgc_bus_dvsn_dim_id = dbo.vw_claim_loss_transaction_fact.strtgc_bus_dvsn_dim_id)\r\n\tINNER JOIN dbo.product_code_dim WITH (NOLOCK) ON (dbo.product_code_dim.prdct_code_dim_id = dbo.vw_claim_loss_transaction_fact.prdct_code_dim_id)\r\n\tLEFT OUTER JOIN dbo.claim_payment_category_type_dim WITH (NOLOCK) ON (dbo.claim_payment_category_type_dim.claim_pay_ctgry_type_dim_id = dbo.vw_claim_loss_transaction_fact.claim_pay_ctgry_type_dim_id)\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claimant_coverage_detail WITH (NOLOCK) ON claimant_coverage_detail.claimant_cov_det_ak_id = coverage_dim.edw_claimant_cov_det_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claim_party_occurrence WITH (NOLOCK) ON claim_party_occurrence.claim_party_occurrence_ak_id = claimant_coverage_detail.claim_party_occurrence_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.vw_claim_party1 WITH (NOLOCK) ON vw_claim_party1.claim_party_ak_id = claim_party_occurrence.claim_party_ak_id\r\n\tINNER JOIN dbo.asl_dim WITH (NOLOCK) ON asl_dim.asl_dim_id = vw_claim_loss_transaction_fact.asl_dim_id\r\n\tINNER JOIN v3.AgencyDim WITH (NOLOCK) ON v3.AgencyDim.AgencyDimid = vw_claim_loss_transaction_fact.AgencyDimid\r\n\tINNER JOIN dbo.InsuranceReferenceDim WITH (NOLOCK) ON InsuranceReferenceDim.InsuranceReferenceDimid = vw_claim_loss_transaction_fact.InsuranceReferenceDimid\r\n\tWHERE claim_occurrence_dim.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claimant_dim1.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.crrnt_snpsht_flag = 1\r\n\t\tAND claim_party_occurrence.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claim_party1.crrnt_snpsht_flag = 1\r\n\t\tAND coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claim_representative_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.source_sys_id = 'EXCEED'\r\n\t\tAND (\r\n\t\t\tclaim_occurrence_dim.claim_open_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\tOR claim_occurrence_dim.claim_close_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\t)\r\n\t\tAND (\r\n\t\t\tclaim_occurrence_dim.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR vw_claimant_dim1.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR claimant_coverage_dim.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR claimant_coverage_detail.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR claim_party_occurrence.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR vw_claim_party1.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\tOR coverage_dim.modified_date > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\t\t\t)\r\n\t\r\n\tUNION\r\n\t\r\n\t-- Nurse assignment changed\r\n\tSELECT DISTINCT vw_claim_party1.claim_party_key,\r\n\t\tclaimant_coverage_detail.ins_line,\r\n\t\tclaim_occurrence_dim.claim_num,\r\n\t\tcoverage_dim.major_peril_descript,\r\n\t\tclaimant_coverage_dim.cause_of_loss_long_descript,\r\n\t\tpolicy_dim.pol_num,\r\n\t\tclaim_occurrence_dim.claim_loss_date,\r\n\t\tclaim_occurrence_dim.claim_open_date,\r\n\t\tclaim_occurrence_dim.claim_close_date,\r\n\t\tclaim_occurrence_dim.claim_reopen_date,\r\n\t\tclaim_occurrence_dim.claim_closed_after_reopen_date,\r\n\t\tclaim_representative_dim.claim_rep_full_name,\r\n\t\tclaim_representative_dim.claim_rep_num,\r\n\t\tclaim_representative_dim.handling_office_mgr,\r\n\t\tclaim_representative_dim.handling_office_descript,\r\n\t\tvw_claimant_dim1.claimant_full_name,\r\n\t\tclaim_case_dim.suit_open_date,\r\n\t\tclaim_occurrence_dim.loss_loc_state,\r\n\t\tproduct_code_dim.prdct_code_descript,\r\n\t\tstrategic_business_division_dim.strtgc_bus_dvsn_code_descript,\r\n\t\tvw_claimant_dim1.jurisdiction_state_code,\r\n\t\tclaim_representative_dim.claim_rep_email,\r\n\t\tclaim_representative_dim.handling_office_mgr_email,\r\n\t\tclaim_occurrence_dim.loss_loc_zip,\r\n\t\tclaim_occurrence_dim.claim_cat_code,\r\n\t\tcontract_customer_dim.name,\r\n\t\tcoverage_dim.major_peril_code,\r\n\t\tclaimant_coverage_dim.cause_of_loss,\r\n\t\tclaimant_coverage_dim.reserve_ctgry,\r\n\t\tclaim_payment_category_type_dim.claim_pay_ctgry_type,\r\n\t\tclaimant_coverage_dim.reserve_ctgry_descript,\r\n\t\tclaim_occurrence_dim.source_claim_occurrence_status_code,\r\n\t\tcoverage_dim.type_bureau_code,\r\n\t\tcoverage_dim.risk_unit_grp,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_outstanding,\r\n\t\tclaim_representative_dim.claim_rep_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_loss_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_alae_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.claimant_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.claim_occurrence_dim_id,\r\n\t\tasl_dim.asl_code,\r\n\t\tInsuranceReferenceDim.insurancesegmentcode,\r\n\t\tInsuranceReferenceDim.productdescription,\r\n\t\tInsuranceReferenceDim.StrategicProfitCenterAbbreviation,\r\n\t\tInsuranceReferenceDim.strategicprofitcenterdescription,\r\n\t\tv3.AgencyDim.agencycode,\r\n\t\tasl_dim.sub_non_asl_code_descript,\r\n\t\tClaimant_coverage_dim.MajorPerilCodeDescription,\r\n\t\tClaimant_coverage_dim.MajorPerilCode,\r\n\t\t-- added as per requirement in PROD-11861\r\n\t\tvw_claim_loss_transaction_fact.ClaimRepresentativeDimFeatureClaimRepresentativeId,\r\n\t\tInsuranceReferenceDim.InsuranceReferenceLineOfBusinessAbbreviation\r\n\t\t, claim_occurrence_dim.claim_loss_descript\r\n\t\t, claim_occurrence_dim.source_claim_rpted_date\r\n\t\t, policy_dim.pol_eff_date\r\n\t\t, policy_dim.pol_exp_date\r\n\tFROM dbo.policy_dim\r\n\tINNER JOIN dbo.vw_claim_loss_transaction_fact WITH (NOLOCK) ON (dbo.policy_dim.pol_dim_id = dbo.vw_claim_loss_transaction_fact.pol_dim_id)\r\n\tINNER JOIN dbo.coverage_dim WITH (NOLOCK) ON (dbo.coverage_dim.cov_dim_id = dbo.vw_claim_loss_transaction_fact.cov_dim_id)\r\n\tINNER JOIN dbo.claim_occurrence_dim WITH (NOLOCK) ON (claim_occurrence_dim.claim_occurrence_dim_id = dbo.vw_claim_loss_transaction_fact.claim_occurrence_dim_id)\r\n\tINNER JOIN dbo.vw_claimant_dim1 WITH (NOLOCK) ON (vw_claimant_dim1.claimant_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_dim_id)\r\n\tINNER JOIN dbo.claimant_coverage_dim WITH (NOLOCK) ON (claimant_coverage_dim.claimant_cov_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_cov_dim_id)\r\n\tINNER JOIN dbo.claim_representative_dim WITH (NOLOCK) ON (dbo.claim_representative_dim.claim_rep_dim_id = dbo.vw_claim_loss_transaction_fact.claim_rep_dim_prim_claim_rep_id)\r\n\tINNER JOIN dbo.claim_case_dim WITH (NOLOCK) ON (dbo.claim_case_dim.claim_case_dim_id = dbo.vw_claim_loss_transaction_fact.claim_case_dim_id)\r\n\tINNER JOIN dbo.contract_customer_dim WITH (NOLOCK) ON (dbo.contract_customer_dim.contract_cust_dim_id = dbo.vw_claim_loss_transaction_fact.contract_cust_dim_id)\r\n\tINNER JOIN dbo.strategic_business_division_dim WITH (NOLOCK) ON (dbo.strategic_business_division_dim.strtgc_bus_dvsn_dim_id = dbo.vw_claim_loss_transaction_fact.strtgc_bus_dvsn_dim_id)\r\n\tINNER JOIN dbo.product_code_dim WITH (NOLOCK) ON (dbo.product_code_dim.prdct_code_dim_id = dbo.vw_claim_loss_transaction_fact.prdct_code_dim_id)\r\n\tLEFT OUTER JOIN dbo.claim_payment_category_type_dim WITH (NOLOCK) ON (dbo.claim_payment_category_type_dim.claim_pay_ctgry_type_dim_id = dbo.vw_claim_loss_transaction_fact.claim_pay_ctgry_type_dim_id)\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claimant_coverage_detail WITH (NOLOCK) ON claimant_coverage_detail.claimant_cov_det_ak_id = coverage_dim.edw_claimant_cov_det_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claim_party_occurrence WITH (NOLOCK) ON claim_party_occurrence.claim_party_occurrence_ak_id = claimant_coverage_detail.claim_party_occurrence_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.vw_claim_party1 WITH (NOLOCK) ON vw_claim_party1.claim_party_ak_id = claim_party_occurrence.claim_party_ak_id\r\n\tINNER JOIN nurseassignmentfact naf WITH (NOLOCK) ON naf.claim_occurrence_dim_id = claim_occurrence_dim.claim_occurrence_dim_id\r\n\t\tAND naf.claimant_dim_id = vw_claimant_dim1.claimant_dim_id\r\n\tINNER JOIN nurseassignmentdim nad WITH (NOLOCK) ON nad.nurseassignmentdimid = naf.nurseassignmentdimid\r\n\t\tAND nad.modifieddate > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tINNER JOIN dbo.asl_dim WITH (NOLOCK) ON asl_dim.asl_dim_id = vw_claim_loss_transaction_fact.asl_dim_id\r\n\tINNER JOIN v3.AgencyDim WITH (NOLOCK) ON v3.AgencyDim.AgencyDimid = vw_claim_loss_transaction_fact.AgencyDimid\r\n\tINNER JOIN dbo.InsuranceReferenceDim WITH (NOLOCK) ON InsuranceReferenceDim.InsuranceReferenceDimid = vw_claim_loss_transaction_fact.InsuranceReferenceDimid\r\n\tWHERE claim_occurrence_dim.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claimant_dim1.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.crrnt_snpsht_flag = 1\r\n\t\tAND claim_party_occurrence.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claim_party1.crrnt_snpsht_flag = 1\r\n\t\tAND coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claim_representative_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.source_sys_id = 'EXCEED'\r\n\t\tAND (\r\n\t\t\tclaim_occurrence_dim.claim_open_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\tOR claim_occurrence_dim.claim_close_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\t)\r\n\t\r\n\tUNION\r\n\t\r\n\t-- Nurse referral changed\r\n\tSELECT DISTINCT vw_claim_party1.claim_party_key,\r\n\t\tclaimant_coverage_detail.ins_line,\r\n\t\tclaim_occurrence_dim.claim_num,\r\n\t\tcoverage_dim.major_peril_descript,\r\n\t\tclaimant_coverage_dim.cause_of_loss_long_descript,\r\n\t\tpolicy_dim.pol_num,\r\n\t\tclaim_occurrence_dim.claim_loss_date,\r\n\t\tclaim_occurrence_dim.claim_open_date,\r\n\t\tclaim_occurrence_dim.claim_close_date,\r\n\t\tclaim_occurrence_dim.claim_reopen_date,\r\n\t\tclaim_occurrence_dim.claim_closed_after_reopen_date,\r\n\t\tclaim_representative_dim.claim_rep_full_name,\r\n\t\tclaim_representative_dim.claim_rep_num,\r\n\t\tclaim_representative_dim.handling_office_mgr,\r\n\t\tclaim_representative_dim.handling_office_descript,\r\n\t\tvw_claimant_dim1.claimant_full_name,\r\n\t\tclaim_case_dim.suit_open_date,\r\n\t\tclaim_occurrence_dim.loss_loc_state,\r\n\t\tproduct_code_dim.prdct_code_descript,\r\n\t\tstrategic_business_division_dim.strtgc_bus_dvsn_code_descript,\r\n\t\tvw_claimant_dim1.jurisdiction_state_code,\r\n\t\tclaim_representative_dim.claim_rep_email,\r\n\t\tclaim_representative_dim.handling_office_mgr_email,\r\n\t\tclaim_occurrence_dim.loss_loc_zip,\r\n\t\tclaim_occurrence_dim.claim_cat_code,\r\n\t\tcontract_customer_dim.name,\r\n\t\tcoverage_dim.major_peril_code,\r\n\t\tclaimant_coverage_dim.cause_of_loss,\r\n\t\tclaimant_coverage_dim.reserve_ctgry,\r\n\t\tclaim_payment_category_type_dim.claim_pay_ctgry_type,\r\n\t\tclaimant_coverage_dim.reserve_ctgry_descript,\r\n\t\tclaim_occurrence_dim.source_claim_occurrence_status_code,\r\n\t\tcoverage_dim.type_bureau_code,\r\n\t\tcoverage_dim.risk_unit_grp,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_outstanding_excluding_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_loss_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_alae_paid_including_recoveries,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_subrogation_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_paid,\r\n\t\tvw_claim_loss_transaction_fact.direct_salvage_outstanding,\r\n\t\tclaim_representative_dim.claim_rep_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_loss_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.direct_other_recovery_alae_outstanding,\r\n\t\tvw_claim_loss_transaction_fact.claimant_dim_id,\r\n\t\tvw_claim_loss_transaction_fact.claim_occurrence_dim_id,\r\n\t\tasl_dim.asl_code,\r\n\t\tInsuranceReferenceDim.insurancesegmentcode,\r\n\t\tInsuranceReferenceDim.productdescription,\r\n\t\tInsuranceReferenceDim.StrategicProfitCenterAbbreviation,\r\n\t\tInsuranceReferenceDim.strategicprofitcenterdescription,\r\n\t\tv3.AgencyDim.agencycode,\r\n\t\tasl_dim.sub_non_asl_code_descript,\r\n\t\tClaimant_coverage_dim.MajorPerilCodeDescription,\r\n\t\tClaimant_coverage_dim.MajorPerilCode,\r\n\t\t-- added as per requirement in PROD-11861\r\n\t\tvw_claim_loss_transaction_fact.ClaimRepresentativeDimFeatureClaimRepresentativeId,\r\n\t\tInsuranceReferenceDim.InsuranceReferenceLineOfBusinessAbbreviation\r\n\t\t, claim_occurrence_dim.claim_loss_descript\r\n\t\t, claim_occurrence_dim.source_claim_rpted_date\r\n\t\t, policy_dim.pol_eff_date\r\n\t\t, policy_dim.pol_exp_date\r\n\tFROM dbo.policy_dim\r\n\tINNER JOIN dbo.vw_claim_loss_transaction_fact WITH (NOLOCK) ON (dbo.policy_dim.pol_dim_id = dbo.vw_claim_loss_transaction_fact.pol_dim_id)\r\n\tINNER JOIN dbo.coverage_dim WITH (NOLOCK) ON (dbo.coverage_dim.cov_dim_id = dbo.vw_claim_loss_transaction_fact.cov_dim_id)\r\n\tINNER JOIN dbo.claim_occurrence_dim WITH (NOLOCK) ON (claim_occurrence_dim.claim_occurrence_dim_id = dbo.vw_claim_loss_transaction_fact.claim_occurrence_dim_id)\r\n\tINNER JOIN dbo.vw_claimant_dim1 WITH (NOLOCK) ON (vw_claimant_dim1.claimant_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_dim_id)\r\n\tINNER JOIN dbo.claimant_coverage_dim WITH (NOLOCK) ON (claimant_coverage_dim.claimant_cov_dim_id = dbo.vw_claim_loss_transaction_fact.claimant_cov_dim_id)\r\n\tINNER JOIN dbo.claim_representative_dim ON (dbo.claim_representative_dim.claim_rep_dim_id = dbo.vw_claim_loss_transaction_fact.claim_rep_dim_prim_claim_rep_id)\r\n\tINNER JOIN dbo.claim_case_dim WITH (NOLOCK) ON (dbo.claim_case_dim.claim_case_dim_id = dbo.vw_claim_loss_transaction_fact.claim_case_dim_id)\r\n\tINNER JOIN dbo.contract_customer_dim WITH (NOLOCK) ON (dbo.contract_customer_dim.contract_cust_dim_id = dbo.vw_claim_loss_transaction_fact.contract_cust_dim_id)\r\n\tINNER JOIN dbo.strategic_business_division_dim WITH (NOLOCK) ON (dbo.strategic_business_division_dim.strtgc_bus_dvsn_dim_id = dbo.vw_claim_loss_transaction_fact.strtgc_bus_dvsn_dim_id)\r\n\tINNER JOIN dbo.product_code_dim WITH (NOLOCK) ON (dbo.product_code_dim.prdct_code_dim_id = dbo.vw_claim_loss_transaction_fact.prdct_code_dim_id)\r\n\tLEFT OUTER JOIN dbo.claim_payment_category_type_dim WITH (NOLOCK) ON (dbo.claim_payment_category_type_dim.claim_pay_ctgry_type_dim_id = dbo.vw_claim_loss_transaction_fact.claim_pay_ctgry_type_dim_id)\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claimant_coverage_detail WITH (NOLOCK) ON claimant_coverage_detail.claimant_cov_det_ak_id = coverage_dim.edw_claimant_cov_det_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.claim_party_occurrence WITH (NOLOCK) ON claim_party_occurrence.claim_party_occurrence_ak_id = claimant_coverage_detail.claim_party_occurrence_ak_id\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.dbo.vw_claim_party1 WITH (NOLOCK) ON vw_claim_party1.claim_party_ak_id = claim_party_occurrence.claim_party_ak_id\r\n\tINNER JOIN nursereferralfact nrf WITH (NOLOCK) ON nrf.claim_occurrence_dim_id = claim_occurrence_dim.claim_occurrence_dim_id\r\n\t\tAND nrf.claimant_dim_id = vw_claimant_dim1.claimant_dim_id\r\n\tINNER JOIN nursereferraldim nrd WITH (NOLOCK) ON nrd.nursereferraldimid = nrf.nursereferraldimid\r\n\t\tAND nrd.modifieddate > '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tINNER JOIN dbo.asl_dim WITH (NOLOCK) ON asl_dim.asl_dim_id = vw_claim_loss_transaction_fact.asl_dim_id\r\n\tINNER JOIN v3.AgencyDim WITH (NOLOCK) ON v3.AgencyDim.AgencyDimid = vw_claim_loss_transaction_fact.AgencyDimid\r\n\tINNER JOIN dbo.InsuranceReferenceDim WITH (NOLOCK) ON InsuranceReferenceDim.InsuranceReferenceDimid = vw_claim_loss_transaction_fact.InsuranceReferenceDimid\r\n\tWHERE claim_occurrence_dim.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claimant_dim1.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.crrnt_snpsht_flag = 1\r\n\t\tAND claim_party_occurrence.crrnt_snpsht_flag = 1\r\n\t\tAND vw_claim_party1.crrnt_snpsht_flag = 1\r\n\t\tAND coverage_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claim_representative_dim.crrnt_snpsht_flag = 1\r\n\t\tAND claimant_coverage_detail.source_sys_id = 'EXCEED'\r\n\t\tAND (\r\n\t\t\tclaim_occurrence_dim.claim_open_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\tOR claim_occurrence_dim.claim_close_date > '@{pipeline().parameters.SELECTION_BASE_DATE}'\r\n\t\t\t)\r\n\tORDER BY claim_occurrence_dim.claim_num,\r\n\t\tcoverage_dim.major_peril_code,\r\n\t\tclaimant_coverage_dim.cause_of_loss,\r\n\t\tclaimant_coverage_dim.reserve_ctgry,\r\n\t\tvw_claim_party1.claim_party_key\n),\nLKP_NurseAssignmentFact AS (\n\tSELECT\n\tCaseManagerName,\n\tClosedDate,\n\tModifiedDate,\n\tclaimant_dim_id,\n\tclaim_occurrence_dim_id\n\tFROM (\n\t\tselect  \r\n\t\tNAD.ClosedDate as ClosedDate,\r\n\t\tNAD.ModifiedDate as ModifiedDate,\r\n\t\tNAD.NurseFullName as CaseManagerName,\r\n\t\tNAF.claimant_dim_id as claimant_dim_id,\r\n\t\tNAF.claim_occurrence_dim_id as claim_occurrence_dim_id\r\n\t\tfrom NurseAssignmentFact NAF \r\n\t\tinner join NurseAssignmentDim NAD on NAD.NurseAssignmentDimId = NAF.NurseAssignmentDimId\r\n\t\tand NAD.CurrentSnapshotFlag=1\r\n\t\t--Order by NAD.ClosedDate DESC,NAD.ModifiedDate DESC,NAD.NurseFullName,NAF.claimant_dim_id ,NAF.claim_occurrence_dim_id--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_dim_id,claim_occurrence_dim_id ORDER BY CaseManagerName DESC) = 1\n),\nLKP_NurseReferralFact AS (\n\tSELECT\n\tModifiedDate,\n\tReferralDate,\n\tCaseManagerName,\n\tIN_claimant_dim_id,\n\tIN_claim_occurrence_dim_id,\n\tclaimant_dim_id,\n\tclaim_occurrence_dim_id\n\tFROM (\n\t\tSELECT\r\n\t\tNRD.ModifiedDate as ModifiedDate, \r\n\t\tNRD.ReferralDate as ReferralDate, \r\n\t\tNRD.NurseFullName as CaseManagerName, \r\n\t\tNRF.claimant_dim_id as claimant_dim_id, \r\n\t\tNRF.claim_occurrence_dim_id as claim_occurrence_dim_id \r\n\t\tFROM \r\n\t\tNurseReferralFact NRF\r\n\t\t inner join NurseReferralDim NRD on NRF.NurseReferralDimId = NRD.NurseReferralDimId \r\n\t\tand NRD.CurrentSnapshotFlag=1\r\n\t\t--Order by NRD.ModifiedDate DESC, NRD.ReferralDate DESC, NRD.NurseFullName,NRF.claimant_dim_id,NRF.claim_occurrence_dim_id --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_dim_id,claim_occurrence_dim_id ORDER BY ModifiedDate DESC) = 1\n),\nEXPTRANS_caseManager AS (\n\tSELECT\n\tLKP_NurseAssignmentFact.CaseManagerName AS CaseManagerNameAssignment,\n\tLKP_NurseReferralFact.CaseManagerName AS CaseManagerNameReferral,\n\t-- *INF*: IIF(ISNULL(CaseManagerNameAssignment),CaseManagerNameReferral,CaseManagerNameAssignment)\r\n\t-- \r\n\t-- -- prefer assignment over referral, and if they are both null then it will get caught later.\r\n\t-- \n\tIFF(CaseManagerNameAssignment IS NULL, CaseManagerNameReferral, CaseManagerNameAssignment) AS CaseManager,\n\tLKP_NurseAssignmentFact.ClosedDate,\n\tLKP_NurseReferralFact.ModifiedDate,\n\tLKP_NurseReferralFact.ReferralDate,\n\tLKP_NurseAssignmentFact.ModifiedDate AS ModifiedDate1\n\tFROM \n\tLEFT JOIN LKP_NurseAssignmentFact\n\tON LKP_NurseAssignmentFact.claimant_dim_id = SQ_Work_Claims_Centers_of_Expertise.claimant_dim_id AND LKP_NurseAssignmentFact.claim_occurrence_dim_id = SQ_Work_Claims_Centers_of_Expertise.claim_occurrence_dim_id\n\tLEFT JOIN LKP_NurseReferralFact\n\tON LKP_NurseReferralFact.claimant_dim_id = SQ_Work_Claims_Centers_of_Expertise.claimant_dim_id AND LKP_NurseReferralFact.claim_occurrence_dim_id = SQ_Work_Claims_Centers_of_Expertise.claim_occurrence_dim_id\n),\nLKP_WorkSupCCEInsuranceLineRiskUnitGroup AS (\n\tSELECT\n\tCustomCoverageTypeDescription,\n\tInsuranceLine,\n\tRiskUnitGroup\n\tFROM (\n\t\tSELECT \n\t\t\tCustomCoverageTypeDescription,\n\t\t\tInsuranceLine,\n\t\t\tRiskUnitGroup\n\t\tFROM WorkSupCCEInsuranceLineRiskUnitGroup\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceLine,RiskUnitGroup ORDER BY CustomCoverageTypeDescription DESC) = 1\n),\nLKP_WorkSupDwellingFireDecoder AS (\n\tSELECT\n\tCustomCoverageTypeDescription,\n\tTypeBureauCode,\n\tMajorPerilCode\n\tFROM (\n\t\tSELECT \n\t\t\tCustomCoverageTypeDescription,\n\t\t\tTypeBureauCode,\n\t\t\tMajorPerilCode\n\t\tFROM WorkSupDwellingFireDecoder\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY TypeBureauCode,MajorPerilCode ORDER BY CustomCoverageTypeDescription DESC) = 1\n),\nLKP_WorkSupGLPLDecoder AS (\n\tSELECT\n\tCustomCoverageTypeDescription,\n\tTypeBureauCode,\n\tCauseOfLossCode,\n\tMajorPerilCode\n\tFROM (\n\t\tSELECT \n\t\t\tCustomCoverageTypeDescription,\n\t\t\tTypeBureauCode,\n\t\t\tCauseOfLossCode,\n\t\t\tMajorPerilCode\n\t\tFROM WorkSupGLPLDecoder\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY TypeBureauCode,CauseOfLossCode,MajorPerilCode ORDER BY CustomCoverageTypeDescription DESC) = 1\n),\nEXP_CustomCoverageDescr AS (\n\tSELECT\n\tLKP_WorkSupGLPLDecoder.CustomCoverageTypeDescription,\n\tLKP_WorkSupDwellingFireDecoder.CustomCoverageTypeDescription AS CustomCoverageTypeDescription1,\n\tLKP_WorkSupCCEInsuranceLineRiskUnitGroup.CustomCoverageTypeDescription AS CustomCoverageTypeDescription2,\n\t-- *INF*: IIF(not ISNULL(CustomCoverageTypeDescription),CustomCoverageTypeDescription,\r\n\t--   IIF(not isnull(CustomCoverageTypeDescription1),CustomCoverageTypeDescription1,\r\n\t-- \tIIF(not isnull(CustomCoverageTypeDescription2),CustomCoverageTypeDescription2,\r\n\t-- \t'N/A')\r\n\t--    )\r\n\t-- )\r\n\t-- \n\tIFF(\n\t    CustomCoverageTypeDescription IS NOT NULL, CustomCoverageTypeDescription,\n\t    IFF(\n\t        CustomCoverageTypeDescription1 IS NOT NULL, CustomCoverageTypeDescription1,\n\t        IFF(\n\t            CustomCoverageTypeDescription2 IS NOT NULL, CustomCoverageTypeDescription2,\n\t            'N/A'\n\t        )\n\t    )\n\t) AS description_OUT\n\tFROM \n\tLEFT JOIN LKP_WorkSupCCEInsuranceLineRiskUnitGroup\n\tON LKP_WorkSupCCEInsuranceLineRiskUnitGroup.InsuranceLine = SQ_Work_Claims_Centers_of_Expertise.ins_line AND LKP_WorkSupCCEInsuranceLineRiskUnitGroup.RiskUnitGroup = SQ_Work_Claims_Centers_of_Expertise.risk_unit_grp\n\tLEFT JOIN LKP_WorkSupDwellingFireDecoder\n\tON LKP_WorkSupDwellingFireDecoder.TypeBureauCode = SQ_Work_Claims_Centers_of_Expertise.type_bureau_code AND LKP_WorkSupDwellingFireDecoder.MajorPerilCode = SQ_Work_Claims_Centers_of_Expertise.major_peril_code\n\tLEFT JOIN LKP_WorkSupGLPLDecoder\n\tON LKP_WorkSupGLPLDecoder.TypeBureauCode = SQ_Work_Claims_Centers_of_Expertise.type_bureau_code AND LKP_WorkSupGLPLDecoder.CauseOfLossCode = SQ_Work_Claims_Centers_of_Expertise.cause_of_loss AND LKP_WorkSupGLPLDecoder.MajorPerilCode = SQ_Work_Claims_Centers_of_Expertise.major_peril_code\n),\nLKP_Claim_Representative_Dim AS (\n\tSELECT\n\tdept_mgr,\n\thandling_office_code,\n\tclaim_rep_dim_id\n\tFROM (\n\t\tSELECT \r\n\t\tclaim_representative_dim.dept_mgr as dept_mgr, \r\n\t\tclaim_representative_dim.handling_office_code as handling_office_code, \r\n\t\tclaim_representative_dim.handling_office_mgr as handling_office_mgr, \r\n\t\tclaim_representative_dim.claim_rep_dim_id as claim_rep_dim_id\r\n\t\tFROM claim_representative_dim\r\n\t\twhere claim_representative_dim.crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_dim_id ORDER BY dept_mgr DESC) = 1\n),\nLKP_Feature_Claim_Representative_Dim AS (\n\tSELECT\n\tclaim_rep_dim_id,\n\tclaim_rep_full_name,\n\tclaim_rep_num,\n\ti_ClaimRepresentativeDimFeatureClaimRepresentativeId\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_rep_dim_id,\n\t\t\tclaim_rep_full_name,\n\t\t\tclaim_rep_num,\n\t\t\ti_ClaimRepresentativeDimFeatureClaimRepresentativeId\n\t\tFROM claim_representative_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_dim_id ORDER BY claim_rep_dim_id) = 1\n),\nLKP_Sup_Report_Office_Stage AS (\n\tSELECT\n\tclaim_manager_code,\n\tdirector_code,\n\treport_office_code\n\tFROM (\n\t\tSELECT sup_report_office_stage.claim_manager_code as claim_manager_code, sup_report_office_stage.director_code as director_code, sup_report_office_stage.report_office_code as report_office_code FROM  dbo.sup_report_office_stage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY report_office_code ORDER BY claim_manager_code) = 1\n),\nEXP_DeriveFields AS (\n\tSELECT\n\t-- *INF*: IIF(isnull(CustomCoverageTypeDescription) or \r\n\t-- length(rtrim(ltrim(CustomCoverageTypeDescription)))=0,'N/A', rtrim(ltrim(CustomCoverageTypeDescription)) )\n\tIFF(\n\t    CustomCoverageTypeDescription IS NULL\n\t    or length(rtrim(ltrim(CustomCoverageTypeDescription))) = 0,\n\t    'N/A',\n\t    rtrim(ltrim(CustomCoverageTypeDescription))\n\t) AS vCustomCoverageTypeDescription,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_num,\n\tSYSDATE AS m_d,\n\t-- *INF*: SUBSTR( major_peril_code || reserve_ctgry  ||cause_of_loss || claim_party_key,0,25)\n\tSUBSTR(major_peril_code || reserve_ctgry || cause_of_loss || claim_party_key, 0, 25) AS subclaim,\n\tSQ_Work_Claims_Centers_of_Expertise.sub_non_asl_code_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.InsuranceSegmentCode,\n\tSQ_Work_Claims_Centers_of_Expertise.reserve_ctgory_descript AS reserve_ctgry_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.MajorPerilCodeDescription,\n\tSQ_Work_Claims_Centers_of_Expertise.MajorPerilCode,\n\t-- *INF*: decode(true,\r\n\t-- ltrim(rtrim(InsuranceSegmentCode))='1','PL',\r\n\t-- ltrim(rtrim(InsuranceSegmentCode))='2','CL',\r\n\t-- ltrim(rtrim(InsuranceSegmentCode))='3','POOL',\r\n\t-- 'N/A')\r\n\t-- \r\n\t-- \n\tdecode(\n\t    true,\n\t    ltrim(rtrim(InsuranceSegmentCode)) = '1', 'PL',\n\t    ltrim(rtrim(InsuranceSegmentCode)) = '2', 'CL',\n\t    ltrim(rtrim(InsuranceSegmentCode)) = '3', 'POOL',\n\t    'N/A'\n\t) AS v_insurancesegment,\n\t-- *INF*: IIF (ISNULL(\r\n\t-- :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'INSURANCESEGMENT',upper(v_insurancesegment))),v_insurancesegment, :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'INSURANCESEGMENT',upper(v_insurancesegment)))\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment.SourceColumnAbbreviation IS NULL,\n\t    v_insurancesegment,\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment.SourceColumnAbbreviation\n\t) AS v_cvg_type_insurancesegment,\n\t-- *INF*: IIF (ISNULL(\r\n\t-- :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'INSURANCESEGMENT',upper(v_insurancesegment))),v_insurancesegment, NULL)\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment.SourceColumnAbbreviation IS NULL,\n\t    v_insurancesegment,\n\t    NULL\n\t) AS missing_insurancesegment_cvgtype,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='FIRE','PROPERTY',\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='ALLIED LINES','PROPERTY',\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='CMP - LIABILITY','BOP',\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='CMP - PROPERTY','BOP',\r\n\t-- 'N/A')\n\tDECODE(\n\t    TRUE,\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'FIRE', 'PROPERTY',\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'ALLIED LINES', 'PROPERTY',\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'CMP - LIABILITY', 'BOP',\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'CMP - PROPERTY', 'BOP',\n\t    'N/A'\n\t) AS v_cvg_type_non_asl_code_descript_p1,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'SUBNONASLDESCRIPT',UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))\r\n\t-- )),sub_non_asl_code_descript,\r\n\t-- :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'SUBNONASLDESCRIPT',UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))\r\n\t-- )\r\n\t-- )\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript.SourceColumnAbbreviation IS NULL,\n\t    sub_non_asl_code_descript,\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript.SourceColumnAbbreviation\n\t) AS v_cvg_type_non_asl_code_descript_p2,\n\t-- *INF*: IIF(v_cvg_type_non_asl_code_descript_p1='N/A',v_cvg_type_non_asl_code_descript_p2,v_cvg_type_non_asl_code_descript_p1)\n\tIFF(\n\t    v_cvg_type_non_asl_code_descript_p1 = 'N/A', v_cvg_type_non_asl_code_descript_p2,\n\t    v_cvg_type_non_asl_code_descript_p1\n\t) AS v_cvg_type_non_asl_code_descript,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'SUBNONASLDESCRIPT',UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))\r\n\t-- )),LTRIM(RTRIM(sub_non_asl_code_descript)),\r\n\t-- NULL\r\n\t-- )\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript.SourceColumnAbbreviation IS NULL,\n\t    LTRIM(RTRIM(sub_non_asl_code_descript)),\n\t    NULL\n\t) AS missing_sub_non_asl_code_descript_cvgtype,\n\t-- *INF*: IIF ( \r\n\t-- IN (UPPER(LTRIM(RTRIM(MajorPerilCodeDescription))),\r\n\t-- 'BOP BLDG','BOP B&ROB','BOP CONTS','BOP FIDELT',\r\n\t-- 'BOP MISC','BRD COVG','BROADENED COLL',\r\n\t-- 'BROADENED COVERAGE','CAR DMG REPLACEMENT',\r\n\t-- 'CUSTOMIZATION COV','DLRS BLANKET COLL',\r\n\t-- 'IDENTITY THEFT','LIMITED SPEC. PERIL',\r\n\t-- 'MEDICAL PAYMENTS','PERS INJ PROTECTION',\r\n\t-- 'PERSONAL UMBRELLA','PICKUP & DELIVERY',\r\n\t-- 'PROP DMG BUYBACK','RENTAL REIMBURSMENT',\r\n\t-- 'TOWING','UMBRELLA','UNDERINS MOTRIST BI',\r\n\t-- 'UNDERINS MOTRIST SL','UNINSRD MOTRIST BI',\r\n\t-- 'UNINSRD MOTRIST PD','UNINSRD MOTRIST SL',\r\n\t-- 'WATER BKUP & SUMP-DP','WATER BKUP & SUMP-HO',\r\n\t-- 'GL OCCUR'),\r\n\t-- LTRIM(RTRIM(MajorPerilCodeDescription)),\r\n\t-- null)\n\tIFF(\n\t    UPPER(LTRIM(RTRIM(MajorPerilCodeDescription))) IN ('BOP BLDG','BOP B&ROB','BOP CONTS','BOP FIDELT','BOP MISC','BRD COVG','BROADENED COLL','BROADENED COVERAGE','CAR DMG REPLACEMENT','CUSTOMIZATION COV','DLRS BLANKET COLL','IDENTITY THEFT','LIMITED SPEC. PERIL','MEDICAL PAYMENTS','PERS INJ PROTECTION','PERSONAL UMBRELLA','PICKUP & DELIVERY','PROP DMG BUYBACK','RENTAL REIMBURSMENT','TOWING','UMBRELLA','UNDERINS MOTRIST BI','UNDERINS MOTRIST SL','UNINSRD MOTRIST BI','UNINSRD MOTRIST PD','UNINSRD MOTRIST SL','WATER BKUP & SUMP-DP','WATER BKUP & SUMP-HO','GL OCCUR'),\n\t    LTRIM(RTRIM(MajorPerilCodeDescription)),\n\t    null\n\t) AS v_cvg_type_majorperil_p1,\n\t-- *INF*: IIF( ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'MAJORPERIL',UPPER(LTRIM(RTRIM(v_cvg_type_majorperil_p1)))\r\n\t-- )),\r\n\t-- v_cvg_type_majorperil_p1,\r\n\t-- :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'MAJORPERIL',UPPER(LTRIM(RTRIM(v_cvg_type_majorperil_p1)))\r\n\t-- ))\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1.SourceColumnAbbreviation IS NULL,\n\t    v_cvg_type_majorperil_p1,\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1.SourceColumnAbbreviation\n\t) AS v_cvg_type_majorperil,\n\t-- *INF*: IIF( ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'MAJORPERIL',UPPER(LTRIM(RTRIM(v_cvg_type_majorperil_p1)))\r\n\t-- )),\r\n\t-- LTRIM(RTRIM(v_cvg_type_majorperil_p1)),\r\n\t-- NULL)\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1.SourceColumnAbbreviation IS NULL,\n\t    LTRIM(RTRIM(v_cvg_type_majorperil_p1)),\n\t    NULL\n\t) AS missing_majorperil_cvgtype,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- LTRIM(RTRIM(v_insurancesegment))='PL',reserve_ctgry_descript,\r\n\t-- UPPER(LTRIM(RTRIM(MajorPerilCodeDescription)))='UMBRELLA',reserve_ctgry_descript,\r\n\t-- UPPER(LTRIM(RTRIM(MajorPerilCodeDescription)))='PERSONAL UMBRELLA',reserve_ctgry_descript,\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='FIRE',reserve_ctgry_descript,\r\n\t-- UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))='ALLIED LINES',reserve_ctgry_descript,null)\n\tDECODE(\n\t    TRUE,\n\t    LTRIM(RTRIM(v_insurancesegment)) = 'PL', reserve_ctgry_descript,\n\t    UPPER(LTRIM(RTRIM(MajorPerilCodeDescription))) = 'UMBRELLA', reserve_ctgry_descript,\n\t    UPPER(LTRIM(RTRIM(MajorPerilCodeDescription))) = 'PERSONAL UMBRELLA', reserve_ctgry_descript,\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'FIRE', reserve_ctgry_descript,\n\t    UPPER(LTRIM(RTRIM(sub_non_asl_code_descript))) = 'ALLIED LINES', reserve_ctgry_descript,\n\t    null\n\t) AS v_cvg_type_reserve_ctgry_descript_p1,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'RESERVECATEGORY',UPPER(LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)))\r\n\t-- )),\r\n\t-- v_cvg_type_reserve_ctgry_descript_p1,\r\n\t-- :LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'RESERVECATEGORY',UPPER(LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)))\r\n\t-- ))\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1.SourceColumnAbbreviation IS NULL,\n\t    v_cvg_type_reserve_ctgry_descript_p1,\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1.SourceColumnAbbreviation\n\t) AS v_cvg_type_reserve_ctgry_descript,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_SupClaimsCentersOfExpertiseCoverage(\r\n\t-- 'RESERVECATEGORY',UPPER(LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)))\r\n\t-- )),\r\n\t-- LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)),\r\n\t-- NULL)\n\tIFF(\n\t    LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1.SourceColumnAbbreviation IS NULL,\n\t    LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)),\n\t    NULL\n\t) AS missing_reserve_ctgry_descript_cvgtype,\n\t-- *INF*: --LTRIM(RTRIM(v_cvg_type_insurancesegment))||IIF(ISNULL(LTRIM(RTRIM(v_cvg_type_majorperil))),'',' '||LTRIM(RTRIM(v_cvg_type_majorperil)))||IIF(ISNULL(LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript))),'',' '||LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript)))||IIF(ISNULL(LTRIM(RTRIM(v_cvg_type_non_asl_code_descript))),'',' '||LTRIM(RTRIM(v_cvg_type_non_asl_code_descript)))\r\n\t-- \r\n\t-- MajorPerilCodeDescription\r\n\t-- --As part of prod-11861 'MajorPerilCodeDescription' is populating on CoverageType in target table.\n\tMajorPerilCodeDescription AS o_coveragetype,\n\tEXP_CustomCoverageDescr.description_OUT AS CustomCoverageTypeDescription,\n\tSQ_Work_Claims_Centers_of_Expertise.major_peril_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_party_key,\n\tSQ_Work_Claims_Centers_of_Expertise.cause_of_loss_long_descript,\n\t-- *INF*:  IIF(major_peril_descript= 'HOMEOWNERS' AND \r\n\t-- IN \r\n\t-- (\r\n\t-- cause_of_loss_long_descript ,\r\n\t-- 'HO LIABILITY BODILY INJURY INCLUDING WATERCRAFT', \r\n\t-- 'HO LIABILITY MEDICAL PAY INCLUDING WATERCRAFT', \r\n\t-- 'HO LIABILITY PD INCLUDING WATERCRAFT', \r\n\t-- 'HO LIABILITY PERSONAL INJURY-HO-82/HO2482', \r\n\t-- 'MEDICAL PAYMENTS'\r\n\t-- ) ,'GENERAL LIABILITY',  \r\n\t-- \r\n\t-- IIF (\r\n\t-- IN (\r\n\t-- major_peril_descript,\r\n\t-- 'AUTO BI', 'AUTO BI/PD SNG LIMIT', 'AUTO BODILY INJURY' , 'AUTO LOAN/LEASE' , 'AUTO LOAN/LEASE COV' , 'AUTO-PD COLLISION' , 'BRD COVG' , 'BROADENED COVERAGE' , 'BROADENED COVERAGE' , 'CAR DAMAGE REPLACE' , 'CAR DMG REPLACEMENT' , 'COLLISION' , 'COMB COLLISION-COMP' , 'COMB COMP/COLL' , 'COMB SINGLE LIMIT' , 'COMMERCIAL UMBRELLA' , 'COMPREHENSIVE' , 'DLRS BLANKET COLL' , 'HIGHWAY EMERGENCY' , 'MEDICAL PAYMENTS' , 'PERS INJ PROTECTION' , 'PERSONAL UMBRELLA' , 'PI PROTECTION' , 'PROP.DAM.' , 'PROPERTY DAMAGE' , 'RENTAL REIMBURSEMENT' , 'SOUND REC & TRANS' , 'SPECIAL EQUIPMENT ' , 'TOWING' , 'TOWING & LABOR' , 'TRAVELNET' , 'UMBRELLA' , 'UNDERINS MOTRIST BI' , 'UNDERINS MOTRIST SL' , 'UNDERINS MTRST-BI' , 'UNDERINS MTRST-PD ' , 'UNDERINS MTRST-SL' , 'UNINS MOTORIST-BI' , 'UNINS MOTORIST-SL' , 'UNINSRD MOTRIST BI' , 'UNINSRD MOTRIST SL' , 'UN-PD' , 'VAN/TRUCK CUSTOM COV'\r\n\t-- ) , 'AUTO',\r\n\t-- IIF\r\n\t-- (\r\n\t-- IN (major_peril_descript,'BI & PD CLAIMS-MADE' , 'BI & PD OCCURRENCE', 'BOATOWNERS LIABILITY' , 'C-BOP LIAB', 'GENERAL LIABILITY-PD' , \r\n\t-- 'GL CLM-MDE' , 'GL OCCUR' , 'GL PRODW' , 'SNOWMOBILE LIAB') ,  'GENERAL LIABILITY','PROPERTY' \r\n\t--        )\r\n\t-- )\r\n\t-- )\r\n\t--  \n\tIFF(\n\t    major_peril_descript = 'HOMEOWNERS'\n\t    and cause_of_loss_long_descript IN ('HO LIABILITY BODILY INJURY INCLUDING WATERCRAFT','HO LIABILITY MEDICAL PAY INCLUDING WATERCRAFT','HO LIABILITY PD INCLUDING WATERCRAFT','HO LIABILITY PERSONAL INJURY-HO-82/HO2482','MEDICAL PAYMENTS'),\n\t    'GENERAL LIABILITY',\n\t    IFF(\n\t        major_peril_descript IN ('AUTO BI','AUTO BI/PD SNG LIMIT','AUTO BODILY INJURY','AUTO LOAN/LEASE','AUTO LOAN/LEASE COV','AUTO-PD COLLISION','BRD COVG','BROADENED COVERAGE','BROADENED COVERAGE','CAR DAMAGE REPLACE','CAR DMG REPLACEMENT','COLLISION','COMB COLLISION-COMP','COMB COMP/COLL','COMB SINGLE LIMIT','COMMERCIAL UMBRELLA','COMPREHENSIVE','DLRS BLANKET COLL','HIGHWAY EMERGENCY','MEDICAL PAYMENTS','PERS INJ PROTECTION','PERSONAL UMBRELLA','PI PROTECTION','PROP.DAM.','PROPERTY DAMAGE','RENTAL REIMBURSEMENT','SOUND REC & TRANS','SPECIAL EQUIPMENT ','TOWING','TOWING & LABOR','TRAVELNET','UMBRELLA','UNDERINS MOTRIST BI','UNDERINS MOTRIST SL','UNDERINS MTRST-BI','UNDERINS MTRST-PD ','UNDERINS MTRST-SL','UNINS MOTORIST-BI','UNINS MOTORIST-SL','UNINSRD MOTRIST BI','UNINSRD MOTRIST SL','UN-PD','VAN/TRUCK CUSTOM COV'),\n\t        'AUTO',\n\t        IFF(\n\t            major_peril_descript IN ('BI & PD CLAIMS-MADE','BI & PD OCCURRENCE','BOATOWNERS LIABILITY','C-BOP LIAB','GENERAL LIABILITY-PD','GL CLM-MDE','GL OCCUR','GL PRODW','SNOWMOBILE LIAB'),\n\t            'GENERAL LIABILITY',\n\t            'PROPERTY'\n\t        )\n\t    )\n\t) AS claimtype_1,\n\tSQ_Work_Claims_Centers_of_Expertise.StrategicProfitCenterAbbreviation,\n\tSQ_Work_Claims_Centers_of_Expertise.StrategicProfitCenterDescription,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- \r\n\t-- --removed TypeBereauCode checks per PROD11861\r\n\t-- \r\n\t-- IN(asl_code, '220', '230','240','250','100','200') AND IN(InsuranceSegmentCode,'1'),'PL GENERAL LIABILITY',\r\n\t-- \r\n\t-- IN(asl_code, '220', '230','240','250','100','200') AND IN(InsuranceSegmentCode,'2'),'CL GENERAL LIABILITY',\r\n\t-- \r\n\t-- IN(asl_code, '340','500','260','440') AND IN(InsuranceSegmentCode,'1'),'PL AUTO',\r\n\t-- \r\n\t-- IN(asl_code, '340','500','260','440') AND IN(InsuranceSegmentCode,'2'),'CL AUTO',\r\n\t-- \r\n\t-- IN(asl_code, '40','20','640','660','80','140','60','120') AND IN(InsuranceSegmentCode,'1'),'PL PROPERTY',\r\n\t-- \r\n\t-- IN(asl_code, '40','20','640','660','80','140','60','120') AND IN(InsuranceSegmentCode,'2'),'CL PROPERTY',\r\n\t-- \r\n\t-- IN(asl_code,'160') AND IN(InsuranceSegmentCode,'3'),'POOL SERVICES',\r\n\t-- \r\n\t-- IN(asl_code,'160') AND IN(InsuranceSegmentCode,'2'),'WORK COMP',\r\n\t-- \r\n\t-- IN(asl_code,' ') AND IN(InsuranceSegmentCode,'2'),'CL OTHER',\r\n\t-- \r\n\t-- IN(asl_code,' ') AND IN(InsuranceSegmentCode,'1'),'PL OTHER',\r\n\t-- \r\n\t-- IN(asl_code,' ') AND IN(InsuranceSegmentCode,' '),'N/A',\r\n\t-- \r\n\t-- IN(asl_code, '600','620') AND IN(InsuranceSegmentCode,'2'),'BONDS',\r\n\t-- \r\n\t-- 'OTHER')\n\tDECODE(\n\t    TRUE,\n\t    asl_code IN ('220','230','240','250','100','200') AND InsuranceSegmentCode IN ('1'), 'PL GENERAL LIABILITY',\n\t    asl_code IN ('220','230','240','250','100','200') AND InsuranceSegmentCode IN ('2'), 'CL GENERAL LIABILITY',\n\t    asl_code IN ('340','500','260','440') AND InsuranceSegmentCode IN ('1'), 'PL AUTO',\n\t    asl_code IN ('340','500','260','440') AND InsuranceSegmentCode IN ('2'), 'CL AUTO',\n\t    asl_code IN ('40','20','640','660','80','140','60','120') AND InsuranceSegmentCode IN ('1'), 'PL PROPERTY',\n\t    asl_code IN ('40','20','640','660','80','140','60','120') AND InsuranceSegmentCode IN ('2'), 'CL PROPERTY',\n\t    asl_code IN ('160') AND InsuranceSegmentCode IN ('3'), 'POOL SERVICES',\n\t    asl_code IN ('160') AND InsuranceSegmentCode IN ('2'), 'WORK COMP',\n\t    asl_code IN (' ') AND InsuranceSegmentCode IN ('2'), 'CL OTHER',\n\t    asl_code IN (' ') AND InsuranceSegmentCode IN ('1'), 'PL OTHER',\n\t    asl_code IN (' ') AND InsuranceSegmentCode IN (' '), 'N/A',\n\t    asl_code IN ('600','620') AND InsuranceSegmentCode IN ('2'), 'BONDS',\n\t    'OTHER'\n\t) AS Claimtype,\n\t-- *INF*: LTRIM(RTRIM(StrategicProfitCenterAbbreviation))\n\tLTRIM(RTRIM(StrategicProfitCenterAbbreviation)) AS out_CompanyName,\n\t-- *INF*: IIF(  direct_loss_outstanding_excluding_recoveries=0  AND direct_alae_outstanding_excluding_recoveries =0 AND direct_salvage_outstanding=0 AND direct_subrogation_outstanding=0 AND direct_other_recovery_loss_outstanding=0 AND direct_other_recovery_alae_outstanding=0,'close','open')\n\tIFF(\n\t    direct_loss_outstanding_excluding_recoveries = 0\n\t    and direct_alae_outstanding_excluding_recoveries = 0\n\t    and direct_salvage_outstanding = 0\n\t    and direct_subrogation_outstanding = 0\n\t    and direct_other_recovery_loss_outstanding = 0\n\t    and direct_other_recovery_alae_outstanding = 0,\n\t    'close',\n\t    'open'\n\t) AS status,\n\tSQ_Work_Claims_Centers_of_Expertise.pol_num,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_loss_paid_including_recoveries,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_alae_paid_including_recoveries,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_salvage_paid,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_subrogation_paid,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_loss_date,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_open_date,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_close_date,\n\t-- *INF*: IIF(claim_reopen_date<> TO_DATE('01/01/1800' , 'MM/DD/YYYY'),claim_closed_after_reopen_date,claim_close_date)\n\tIFF(\n\t    claim_reopen_date <> TO_TIMESTAMP('01/01/1800', 'MM/DD/YYYY'),\n\t    claim_closed_after_reopen_date,\n\t    claim_close_date\n\t) AS o_claim_close_date,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_rep_full_name,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_rep_num,\n\tSQ_Work_Claims_Centers_of_Expertise.handling_office_mgr,\n\tSQ_Work_Claims_Centers_of_Expertise.handling_office_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.claimant_full_name,\n\t-- *INF*: REPLACECHR(TRUE,claimant_full_name,'\"',' ') \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tREGEXP_REPLACE(claimant_full_name,'\"',' ') AS o_claimant_full_name,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_rep_email,\n\tSQ_Work_Claims_Centers_of_Expertise.InsuranceReferenceLineOfBusinessAbbreviation,\n\t-- *INF*: IIF (cause_of_loss = '05' AND LTRIM(RTRIM(InsuranceReferenceLineOfBusinessAbbreviation))='WC' ,direct_loss_paid_including_recoveries)  \r\n\t-- \n\tIFF(\n\t    cause_of_loss = '05' AND LTRIM(RTRIM(InsuranceReferenceLineOfBusinessAbbreviation)) = 'WC',\n\t    direct_loss_paid_including_recoveries\n\t) AS LossIndemnity,\n\t-- *INF*: IIF (cause_of_loss = '06'  AND LTRIM(RTRIM(InsuranceReferenceLineOfBusinessAbbreviation))='WC',direct_loss_paid_including_recoveries)  \r\n\t-- \n\tIFF(\n\t    cause_of_loss = '06' AND LTRIM(RTRIM(InsuranceReferenceLineOfBusinessAbbreviation)) = 'WC',\n\t    direct_loss_paid_including_recoveries\n\t) AS LossMedical,\n\t-- *INF*: IIF( suit_open_date = TO_DATE('01-JAN-1800', 'DD-MON-YYYY') , 'N' , 'Y' )\r\n\t-- \n\tIFF(suit_open_date = TO_TIMESTAMP('01-JAN-1800', 'DD-MON-YYYY'), 'N', 'Y') AS LegalIndicator,\n\tSQ_Work_Claims_Centers_of_Expertise.cause_of_loss,\n\tSQ_Work_Claims_Centers_of_Expertise.reserve_ctgry,\n\tSQ_Work_Claims_Centers_of_Expertise.suit_open_date,\n\tSQ_Work_Claims_Centers_of_Expertise.loss_loc_state,\n\tSQ_Work_Claims_Centers_of_Expertise.prdct_code_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.strtgc_bus_dvsn_code AS strtgc_bus_dvsn_code_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.jurisdiction_state_code,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_loss_outstanding_excluding_recoveries,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_alae_outstanding_excluding_recoveries,\n\tSQ_Work_Claims_Centers_of_Expertise.handling_office_mgr_email,\n\tSQ_Work_Claims_Centers_of_Expertise.loss_loc_zip,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_cat_code,\n\t-- *INF*: IIF (claim_cat_code = 'N/A','N','Y')\r\n\t-- \n\tIFF(claim_cat_code = 'N/A', 'N', 'Y') AS CategoryIndicator,\n\tSQ_Work_Claims_Centers_of_Expertise.name,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_salvage_outstanding,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_subrogation_outstanding,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_pay_ctgry_type,\n\t-- *INF*: IIF(claim_pay_ctgry_type='IA','Y','N')\n\tIFF(claim_pay_ctgry_type = 'IA', 'Y', 'N') AS ExAdjusterIndicator,\n\tSQ_Work_Claims_Centers_of_Expertise.major_peril_code,\n\t-- *INF*: IIF(IN (major_peril_code,'210', '002') AND  IN(cause_of_loss ,'16','26','36','46','06','07','08'), 'CASUALTY',\r\n\t-- (IIF(IN(major_peril_code,'901','902') and IN(cause_of_loss ,'16','26','97','77','67','57'),'CASUALTY',\r\n\t-- IIF(IN(major_peril_code, '042' ,'017' ,'065' ,'066' ,'067',\r\n\t-- '084' ,'085' ,'100' ,'101' ,'110' ,'112' ,'114' ,'115' ,'116' ,'118' ,'119' , \r\n\t-- '120' ,'125' ,'130' ,'145' ,'146' ,'147' ,'272' ,'206' ,'165' ,'166' ,'168' ,\r\n\t-- '169' ,'170' ,'171' ,'173' ,'174' ,'178' ,'155' ,'269' ,'270' ,'271' ,'024' \r\n\t-- ,'480' ,'517' ,'530' ,'534' ,'540' ,'904' ,'010' ,'910' ,'273' ,'912' ,'919' ,\r\n\t-- '044'),'CASUALTY',NULL))))\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(\n\t    major_peril_code IN ('210','002') AND cause_of_loss IN ('16','26','36','46','06','07','08'),\n\t    'CASUALTY',\n\t    (\n\t        IFF(\n\t            major_peril_code IN ('901','902')\n\t    and cause_of_loss IN ('16','26','97','77','67','57'),\n\t            'CASUALTY',\n\t            IFF(\n\t                major_peril_code IN ('042','017','065','066','067','084','085','100','101','110','112','114','115','116','118','119','120','125','130','145','146','147','272','206','165','166','168','169','170','171','173','174','178','155','269','270','271','024','480','517','530','534','540','904','010','910','273','912','919','044'),\n\t                'CASUALTY',\n\t                NULL\n\t            )\n\t        ))\n\t) AS v_genmisc1_casualty,\n\t-- *INF*: IIF( IN  (major_peril_code,\r\n\t-- '490' ,'148' ,'015' ,'016' ,'909' ,'050' ,'062' ,'907' ,'071' ,'097' ,'200' ,\r\n\t-- '201' ,'210' ,'211' ,'220' ,'221','226' ,'227' ,'228' ,'229' ,'249' ,'250' ,\r\n\t-- '260' ,'280' ,'415' ,'425' ,'426' ,'435' , '455' ,'463' ,'911' ,'496' ,'550' ,'551' ,'565' ,'566' ,'570' ,'901' ,\r\n\t-- '902' ,'903' ,'905' ,'906' ,'908' , '914' , '002', '226'),'PROPERTY',null)\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(\n\t    major_peril_code IN ('490','148','015','016','909','050','062','907','071','097','200','201','210','211','220','221','226','227','228','229','249','250','260','280','415','425','426','435','455','463','911','496','550','551','565','566','570','901','902','903','905','906','908','914','002','226'),\n\t    'PROPERTY',\n\t    null\n\t) AS v_genmisc1_property,\n\t-- *INF*: IIF( IN  (major_peril_code,\r\n\t-- '920','921','922','924','925'),'BONDS',\r\n\t-- (IIF(major_peril_code='032','WORK COMP',NULL))\r\n\t-- )\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(\n\t    major_peril_code IN ('920','921','922','924','925'), 'BONDS',\n\t    (\n\t        IFF(\n\t            major_peril_code = '032', 'WORK COMP', NULL\n\t        ))\n\t) AS v_genmisc1_other,\n\t-- *INF*: --IIF(NOT ISNULL(v_genmisc1_casualty),v_genmisc1_casualty,(IIF(NOT ISNULL(v_genmisc1_property),v_genmisc1_property,(IIF(NOT ISNULL(v_genmisc1_other),v_genmisc1_other,(IIF(ISNULL(major_peril_code) AND ISNULL(cause_of_loss),'N/A')))))))\r\n\t-- \r\n\t-- ltrim(rtrim(:LKP.LKP_SupTypeOfLossRules(InsuranceSegmentCode, MajorPerilCode, cause_of_loss)))\r\n\t-- --PROD-11861\n\tltrim(rtrim(LKP_SUPTYPEOFLOSSRULES_InsuranceSegmentCode_MajorPerilCode_cause_of_loss.ClaimTypeCategory)) AS v_GeneralMiscellaneous1,\n\t-- *INF*: IIF(ISNULL(ltrim(rtrim(v_GeneralMiscellaneous1))),'N/A',ltrim(rtrim(v_GeneralMiscellaneous1)))\n\tIFF(\n\t    ltrim(rtrim(v_GeneralMiscellaneous1)) IS NULL, 'N/A', ltrim(rtrim(v_GeneralMiscellaneous1))\n\t) AS out_GeneralMiscellaneous1,\n\t-- *INF*: --LTRIM(RTRIM(Claimtype))\r\n\t-- --PROD-11861\r\n\t-- IIF(ltrim(rtrim(Claimtype))='PL PROPERTY' AND UPPER(v_GeneralMiscellaneous1)='CASUALTY','PL General Liability',IIF(ltrim(rtrim(Claimtype))='CL PROPERTY' AND UPPER(v_GeneralMiscellaneous1)='CASUALTY','CL General Liability',ltrim(rtrim(Claimtype))))\n\tIFF(\n\t    ltrim(rtrim(Claimtype)) = 'PL PROPERTY' AND UPPER(v_GeneralMiscellaneous1) = 'CASUALTY',\n\t    'PL General Liability',\n\t    IFF(\n\t        ltrim(rtrim(Claimtype)) = 'CL PROPERTY'\n\t    and UPPER(v_GeneralMiscellaneous1) = 'CASUALTY',\n\t        'CL General Liability',\n\t        ltrim(rtrim(Claimtype))\n\t    )\n\t) AS out_Claimtype,\n\t-- *INF*: IIF(claim_pay_ctgry_type='IP','Y','N')\n\tIFF(claim_pay_ctgry_type = 'IP', 'Y', 'N') AS GeneralMiscellaneous2,\n\tSQ_Work_Claims_Centers_of_Expertise.source_claim_occurence_status_code,\n\tSQ_Work_Claims_Centers_of_Expertise.type_bureau_code,\n\tLKP_Sup_Report_Office_Stage.claim_manager_code AS SupervisorCode,\n\t-- *INF*: IIF(ISNULL(SupervisorCode),'N/A',SupervisorCode)\n\tIFF(SupervisorCode IS NULL, 'N/A', SupervisorCode) AS o_SupervisorCode,\n\tLKP_Claim_Representative_Dim.handling_office_code AS OfficeCode,\n\t-- *INF*: IIF(ISNULL(OfficeCode),'N/A',OfficeCode)\n\tIFF(OfficeCode IS NULL, 'N/A', OfficeCode) AS O_Officecode,\n\tLKP_Claim_Representative_Dim.dept_mgr AS UnitName,\n\t-- *INF*: IIF(ISNULL(UnitName),'N/A',UnitName)\n\tIFF(UnitName IS NULL, 'N/A', UnitName) AS O_UnitName,\n\tLKP_Sup_Report_Office_Stage.director_code AS UnitCode,\n\t-- *INF*: IIF(ISNULL(UnitCode),'N/A',UnitCode)\n\tIFF(UnitCode IS NULL, 'N/A', UnitCode) AS O_Unitcode,\n\t-- *INF*: IIF(ISNULL(GeneralMiscellaneous10),'N','Y')\n\tIFF(GeneralMiscellaneous10 IS NULL, 'N', 'Y') AS out_GeneralMiscellaneous9,\n\tEXPTRANS_caseManager.CaseManager AS GeneralMiscellaneous10,\n\t-- *INF*: IIF(ISNULL(GeneralMiscellaneous10),'N/A',rtrim(ltrim(GeneralMiscellaneous10)))\n\tIFF(GeneralMiscellaneous10 IS NULL, 'N/A', rtrim(ltrim(GeneralMiscellaneous10))) AS out_GeneralMiscellaneous10,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_other_recovery_loss_outstanding,\n\tSQ_Work_Claims_Centers_of_Expertise.direct_other_recovery_alae_outstanding,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_reopen_date,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_closed_after_reopen_date,\n\tSQ_Work_Claims_Centers_of_Expertise.asl_code,\n\tSQ_Work_Claims_Centers_of_Expertise.ProductDescription,\n\tSQ_Work_Claims_Centers_of_Expertise.AgencyCode,\n\tLKP_Feature_Claim_Representative_Dim.claim_rep_full_name AS ClaimFeatureRepresentativeName,\n\tLKP_Feature_Claim_Representative_Dim.claim_rep_num AS ClaimFeatureRepresentativeCode,\n\tSQ_Work_Claims_Centers_of_Expertise.claim_loss_descript,\n\tSQ_Work_Claims_Centers_of_Expertise.source_claim_rpted_date,\n\tSQ_Work_Claims_Centers_of_Expertise.pol_eff_date,\n\tSQ_Work_Claims_Centers_of_Expertise.pol_exp_date\n\tFROM EXPTRANS_caseManager\n\t -- Manually join with EXP_CustomCoverageDescr\n\t -- Manually join with SQ_Work_Claims_Centers_of_Expertise\n\tLEFT JOIN LKP_Claim_Representative_Dim\n\tON LKP_Claim_Representative_Dim.claim_rep_dim_id = SQ_Work_Claims_Centers_of_Expertise.claim_rep_dim_id\n\tLEFT JOIN LKP_Feature_Claim_Representative_Dim\n\tON LKP_Feature_Claim_Representative_Dim.claim_rep_dim_id = SQ_Work_Claims_Centers_of_Expertise.ClaimRepresentativeDimFeatureClaimRepresentativeId\n\tLEFT JOIN LKP_Sup_Report_Office_Stage\n\tON LKP_Sup_Report_Office_Stage.report_office_code = LKP_Claim_Representative_Dim.handling_office_code\n\tLEFT JOIN LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment\n\tON LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment.SourceColumnName = 'INSURANCESEGMENT'\n\tAND LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__INSURANCESEGMENT_upper_v_insurancesegment.SourceColumnValue = upper(v_insurancesegment)\n\n\tLEFT JOIN LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript\n\tON LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript.SourceColumnName = 'SUBNONASLDESCRIPT'\n\tAND LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__SUBNONASLDESCRIPT_UPPER_LTRIM_RTRIM_sub_non_asl_code_descript.SourceColumnValue = UPPER(LTRIM(RTRIM(sub_non_asl_code_descript)))\n\n\tLEFT JOIN LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1\n\tON LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1.SourceColumnName = 'MAJORPERIL'\n\tAND LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__MAJORPERIL_UPPER_LTRIM_RTRIM_v_cvg_type_majorperil_p1.SourceColumnValue = UPPER(LTRIM(RTRIM(v_cvg_type_majorperil_p1)))\n\n\tLEFT JOIN LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1\n\tON LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1.SourceColumnName = 'RESERVECATEGORY'\n\tAND LKP_SUPCLAIMSCENTERSOFEXPERTISECOVERAGE__RESERVECATEGORY_UPPER_LTRIM_RTRIM_v_cvg_type_reserve_ctgry_descript_p1.SourceColumnValue = UPPER(LTRIM(RTRIM(v_cvg_type_reserve_ctgry_descript_p1)))\n\n\tLEFT JOIN LKP_SUPTYPEOFLOSSRULES LKP_SUPTYPEOFLOSSRULES_InsuranceSegmentCode_MajorPerilCode_cause_of_loss\n\tON LKP_SUPTYPEOFLOSSRULES_InsuranceSegmentCode_MajorPerilCode_cause_of_loss.InsuranceSegmentCode = InsuranceSegmentCode\n\tAND LKP_SUPTYPEOFLOSSRULES_InsuranceSegmentCode_MajorPerilCode_cause_of_loss.MajorPerilCode = MajorPerilCode\n\tAND LKP_SUPTYPEOFLOSSRULES_InsuranceSegmentCode_MajorPerilCode_cause_of_loss.CauseOfLoss = cause_of_loss\n\n),\nAGG_Claims AS (\n\tSELECT\n\tclaim_num,\n\tpol_num,\n\tclaim_loss_date,\n\tclaim_open_date,\n\to_claim_close_date AS claim_close_date,\n\tclaim_rep_full_name,\n\tclaim_rep_num,\n\thandling_office_mgr,\n\thandling_office_descript,\n\tloss_loc_state,\n\tstrtgc_bus_dvsn_code_descript,\n\tdirect_loss_paid_including_recoveries,\n\t-- *INF*: SUM(direct_loss_paid_including_recoveries)\n\tSUM(direct_loss_paid_including_recoveries) AS LossMiscellaneous1,\n\tdirect_loss_outstanding_excluding_recoveries,\n\t-- *INF*: SUM(direct_loss_outstanding_excluding_recoveries)\n\tSUM(direct_loss_outstanding_excluding_recoveries) AS LossReserveMiscellaneous1,\n\tdirect_alae_paid_including_recoveries,\n\t-- *INF*: SUM(direct_alae_paid_including_recoveries)\n\tSUM(direct_alae_paid_including_recoveries) AS ExpenseMiscellaneous1,\n\tdirect_alae_outstanding_excluding_recoveries,\n\t-- *INF*: SUM(direct_alae_outstanding_excluding_recoveries)\n\tSUM(direct_alae_outstanding_excluding_recoveries) AS ExpenseReserveMiscellaneous1,\n\tclaim_rep_email,\n\thandling_office_mgr_email,\n\tloss_loc_zip,\n\tCategoryIndicator,\n\tname,\n\tsource_claim_occurence_status_code,\n\tclaim_cat_code,\n\tLossIndemnity AS i_LossIndemnity,\n\t-- *INF*: SUM(i_LossIndemnity)\n\tSUM(i_LossIndemnity) AS o_LossIndemnity,\n\tLossMedical AS i_LossMedical,\n\t-- *INF*: SUM(i_LossMedical)\n\tSUM(i_LossMedical) AS o_LossMedical,\n\tout_CompanyName AS CompanyName,\n\tAgencyCode,\n\tClaimFeatureRepresentativeName,\n\tClaimFeatureRepresentativeCode,\n\tclaim_loss_descript,\n\tsource_claim_rpted_date,\n\tpol_eff_date,\n\tpol_exp_date\n\tFROM EXP_DeriveFields\n\tGROUP BY claim_num\n),\nSRT_claims AS (\n\tSELECT\n\tclaim_num, \n\tpol_num, \n\tclaim_loss_date, \n\tclaim_open_date, \n\tclaim_close_date, \n\tclaim_rep_full_name, \n\tclaim_rep_num, \n\thandling_office_mgr, \n\thandling_office_descript, \n\tloss_loc_state, \n\tstrtgc_bus_dvsn_code_descript AS strtgc_bus_dvsn_code, \n\tLossMiscellaneous1, \n\tLossReserveMiscellaneous1, \n\tExpenseMiscellaneous1, \n\tExpenseReserveMiscellaneous1, \n\tclaim_rep_email, \n\thandling_office_mgr_email, \n\tloss_loc_zip, \n\tCategoryIndicator, \n\tname, \n\tsource_claim_occurence_status_code, \n\tclaim_cat_code, \n\to_LossIndemnity AS LossIndemnity, \n\to_LossMedical AS LossMedical, \n\tCompanyName, \n\tAgencyCode, \n\tClaimFeatureRepresentativeName, \n\tClaimFeatureRepresentativeCode, \n\tclaim_loss_descript, \n\tsource_claim_rpted_date, \n\tpol_eff_date, \n\tpol_exp_date\n\tFROM AGG_Claims\n\tORDER BY claim_num ASC\n),\nAGG_SubClaims AS (\n\tSELECT\n\tclaim_num,\n\tsubclaim,\n\tm_d,\n\tout_Claimtype AS Claimtype,\n\tmissing_insurancesegment_cvgtype,\n\tmissing_sub_non_asl_code_descript_cvgtype,\n\tmissing_majorperil_cvgtype,\n\tmissing_reserve_ctgry_descript_cvgtype,\n\to_coveragetype AS CoverageType,\n\tdirect_loss_paid_including_recoveries,\n\t-- *INF*: SUM(direct_loss_paid_including_recoveries)\n\tSUM(direct_loss_paid_including_recoveries) AS LossTotal,\n\tdirect_alae_paid_including_recoveries,\n\t-- *INF*: SUM(direct_alae_paid_including_recoveries)\n\tSUM(direct_alae_paid_including_recoveries) AS ExpenseTotal,\n\tdirect_salvage_paid,\n\t-- *INF*: SUM(direct_salvage_paid)\n\tSUM(direct_salvage_paid) AS SalvageTotal,\n\tdirect_subrogation_paid,\n\t-- *INF*: SUM(direct_subrogation_paid)\n\tSUM(direct_subrogation_paid) AS SubrogationTotal,\n\to_claimant_full_name AS claimant_full_name,\n\tLegalIndicator,\n\tcause_of_loss_long_descript,\n\tjurisdiction_state_code,\n\tdirect_loss_outstanding_excluding_recoveries,\n\t-- *INF*: SUM(direct_loss_outstanding_excluding_recoveries)\n\tSUM(direct_loss_outstanding_excluding_recoveries) AS LossReserveTotal,\n\tdirect_alae_outstanding_excluding_recoveries,\n\t-- *INF*: SUM(direct_alae_outstanding_excluding_recoveries)\n\tSUM(direct_alae_outstanding_excluding_recoveries) AS ExpenseReserveTotal,\n\tExAdjusterIndicator,\n\tout_GeneralMiscellaneous1 AS GeneralMiscellaneous1,\n\tGeneralMiscellaneous2,\n\treserve_ctgry_descript AS GeneralMiscellaneous3,\n\tmajor_peril_descript AS GeneralMiscellaneous8,\n\tout_GeneralMiscellaneous9 AS GeneralMiscellaneous9,\n\tout_GeneralMiscellaneous10 AS GeneralMiscellaneous10,\n\to_SupervisorCode AS SupervisorCode,\n\tO_Officecode AS OfficeCode,\n\tO_UnitName AS UnitName,\n\tO_Unitcode AS UnitCode,\n\tAuditId,\n\tmajor_peril_code,\n\tcause_of_loss,\n\treserve_ctgry,\n\tdirect_other_recovery_loss_outstanding,\n\t-- *INF*: SUM(direct_other_recovery_loss_outstanding)\n\tSUM(direct_other_recovery_loss_outstanding) AS o_direct_other_recovery_loss_outstanding,\n\tdirect_other_recovery_alae_outstanding,\n\t-- *INF*: SUM(direct_other_recovery_alae_outstanding)\n\tSUM(direct_other_recovery_alae_outstanding) AS o_direct_other_recovery_alae_outstanding,\n\tdirect_salvage_outstanding,\n\t-- *INF*: SUM(direct_salvage_outstanding)\n\tSUM(direct_salvage_outstanding) AS o_direct_salvage_outstanding,\n\tdirect_subrogation_outstanding,\n\t-- *INF*: SUM(direct_subrogation_outstanding)\n\tSUM(direct_subrogation_outstanding) AS o_direct_subrogation_outstanding,\n\tProductDescription\n\tFROM EXP_DeriveFields\n\tGROUP BY claim_num, subclaim\n),\nSRT_subclaims AS (\n\tSELECT\n\tclaim_num, \n\tm_d, \n\tsubclaim, \n\tClaimtype, \n\tmissing_insurancesegment_cvgtype, \n\tmissing_sub_non_asl_code_descript_cvgtype, \n\tmissing_majorperil_cvgtype, \n\tmissing_reserve_ctgry_descript_cvgtype, \n\tCoverageType, \n\tstatus, \n\tLossTotal, \n\tExpenseTotal, \n\tSalvageTotal, \n\tSubrogationTotal, \n\tclaimant_full_name, \n\tLegalIndicator, \n\tcause_of_loss_long_descript, \n\tjurisdiction_state_code, \n\tLossReserveTotal, \n\tExpenseReserveTotal, \n\tSalvageIndicator, \n\tSubrogationIndicator, \n\tExAdjusterIndicator, \n\tGeneralMiscellaneous1, \n\tGeneralMiscellaneous2, \n\tGeneralMiscellaneous3 AS reserve_ctgry_descript, \n\tGeneralMiscellaneous8 AS major_peril_descript, \n\tSupervisorCode, \n\tOfficeCode, \n\tUnitName, \n\tUnitCode, \n\tGeneralMiscellaneous9, \n\tGeneralMiscellaneous10, \n\tAuditId, \n\to_direct_other_recovery_loss_outstanding, \n\to_direct_other_recovery_alae_outstanding, \n\to_direct_salvage_outstanding, \n\to_direct_subrogation_outstanding, \n\tdirect_salvage_paid, \n\tdirect_subrogation_paid, \n\tdirect_salvage_outstanding, \n\tdirect_subrogation_outstanding, \n\tProductDescription\n\tFROM AGG_SubClaims\n\tORDER BY claim_num ASC\n),\nJNR_cce AS (SELECT\n\tSRT_subclaims.claim_num, \n\tSRT_subclaims.m_d, \n\tSRT_subclaims.subclaim, \n\tSRT_subclaims.Claimtype, \n\tSRT_subclaims.missing_insurancesegment_cvgtype, \n\tSRT_subclaims.missing_sub_non_asl_code_descript_cvgtype, \n\tSRT_subclaims.missing_majorperil_cvgtype, \n\tSRT_subclaims.missing_reserve_ctgry_descript_cvgtype, \n\tSRT_subclaims.CoverageType, \n\tSRT_subclaims.status, \n\tSRT_subclaims.LossTotal, \n\tSRT_subclaims.ExpenseTotal, \n\tSRT_subclaims.SalvageTotal, \n\tSRT_subclaims.SubrogationTotal, \n\tSRT_subclaims.claimant_full_name, \n\tSRT_claims.LossIndemnity, \n\tSRT_claims.LossMedical, \n\tSRT_subclaims.LegalIndicator, \n\tSRT_subclaims.cause_of_loss_long_descript, \n\tSRT_subclaims.jurisdiction_state_code, \n\tSRT_subclaims.LossReserveTotal, \n\tSRT_subclaims.ExpenseReserveTotal, \n\tSRT_subclaims.SalvageIndicator, \n\tSRT_subclaims.SubrogationIndicator, \n\tSRT_subclaims.ExAdjusterIndicator, \n\tSRT_subclaims.GeneralMiscellaneous1, \n\tSRT_subclaims.GeneralMiscellaneous2, \n\tSRT_subclaims.reserve_ctgry_descript, \n\tSRT_subclaims.major_peril_descript, \n\tSRT_subclaims.SupervisorCode, \n\tSRT_subclaims.OfficeCode, \n\tSRT_subclaims.UnitName, \n\tSRT_subclaims.UnitCode, \n\tSRT_subclaims.GeneralMiscellaneous9, \n\tSRT_subclaims.GeneralMiscellaneous10, \n\tSRT_subclaims.AuditId, \n\tSRT_claims.claim_num AS claim_num1, \n\tSRT_claims.pol_num, \n\tSRT_claims.claim_loss_date, \n\tSRT_claims.claim_open_date, \n\tSRT_claims.claim_close_date, \n\tSRT_claims.claim_rep_full_name, \n\tSRT_claims.claim_rep_num, \n\tSRT_claims.handling_office_mgr, \n\tSRT_claims.handling_office_descript, \n\tSRT_claims.loss_loc_state, \n\tSRT_claims.prdct_code_descript, \n\tSRT_claims.strtgc_bus_dvsn_code AS strtgc_bus_dvsn_code_descript, \n\tSRT_claims.claim_loss_descript, \n\tSRT_claims.source_claim_rpted_date, \n\tSRT_claims.pol_eff_date, \n\tSRT_claims.pol_exp_date, \n\tSRT_claims.LossMiscellaneous1, \n\tSRT_claims.LossReserveMiscellaneous1, \n\tSRT_claims.ExpenseMiscellaneous1, \n\tSRT_claims.ExpenseReserveMiscellaneous1, \n\tSRT_claims.claim_rep_email, \n\tSRT_claims.handling_office_mgr_email, \n\tSRT_claims.loss_loc_zip, \n\tSRT_claims.CategoryIndicator, \n\tSRT_claims.name, \n\tSRT_claims.source_claim_occurence_status_code, \n\tSRT_claims.claim_cat_code, \n\tSRT_subclaims.o_direct_other_recovery_loss_outstanding, \n\tSRT_subclaims.o_direct_other_recovery_alae_outstanding, \n\tSRT_subclaims.o_direct_salvage_outstanding, \n\tSRT_subclaims.o_direct_subrogation_outstanding, \n\tSRT_subclaims.direct_salvage_paid, \n\tSRT_subclaims.direct_subrogation_paid, \n\tSRT_subclaims.direct_salvage_outstanding, \n\tSRT_subclaims.direct_subrogation_outstanding, \n\tSRT_subclaims.ProductDescription, \n\tSRT_claims.CompanyName, \n\tSRT_claims.AgencyCode, \n\tSRT_claims.ClaimFeatureRepresentativeName, \n\tSRT_claims.ClaimFeatureRepresentativeCode\n\tFROM SRT_subclaims\n\tLEFT OUTER JOIN SRT_claims\n\tON SRT_claims.claim_num = SRT_subclaims.claim_num\n),\nEXP_passthrough AS (\n\tSELECT\n\tAuditId,\n\tm_d AS ModifiedDate,\n\tclaim_num AS ClaimNumber,\n\tsubclaim AS SubClaimId,\n\tClaimtype,\n\tmissing_insurancesegment_cvgtype,\n\tmissing_sub_non_asl_code_descript_cvgtype,\n\tmissing_majorperil_cvgtype,\n\tmissing_reserve_ctgry_descript_cvgtype,\n\tCoverageType,\n\tstatus AS Status,\n\t-- *INF*: IIF(LossReserveTotal=0 AND\r\n\t-- ExpenseReserveTotal=0 AND\r\n\t-- o_direct_salvage_outstanding=0 AND\r\n\t-- o_direct_subrogation_outstanding=0 AND\r\n\t-- o_direct_other_recovery_loss_outstanding=0 AND\r\n\t-- o_direct_other_recovery_alae_outstanding=0,'CLOSE','OPEN')\n\tIFF(\n\t    LossReserveTotal = 0\n\t    and ExpenseReserveTotal = 0\n\t    and o_direct_salvage_outstanding = 0\n\t    and o_direct_subrogation_outstanding = 0\n\t    and o_direct_other_recovery_loss_outstanding = 0\n\t    and o_direct_other_recovery_alae_outstanding = 0,\n\t    'CLOSE',\n\t    'OPEN'\n\t) AS o_Status,\n\tpol_num AS PolicyNumber,\n\tLossTotal,\n\tExpenseTotal,\n\tSalvageTotal,\n\tSubrogationTotal,\n\tclaim_loss_date AS LossDate,\n\tclaim_open_date AS OpenedDate,\n\tclaim_close_date AS ClosedDate,\n\tclaim_rep_full_name AS AdjusterName,\n\tclaim_rep_num AS AdjusterCode,\n\tSupervisorCode,\n\thandling_office_mgr AS SupervisorName,\n\tOfficeCode,\n\thandling_office_descript AS OfficeName,\n\tUnitName,\n\tUnitCode,\n\tclaimant_full_name AS ClaimantName,\n\tLossIndemnity,\n\tLossMedical,\n\tLegalIndicator,\n\tloss_loc_state AS LossState,\n\tProductDescription AS PolicyType,\n\tcause_of_loss_long_descript AS LossType,\n\tCompanyName,\n\tjurisdiction_state_code AS Jurisdiction,\n\tLossMiscellaneous1,\n\tLossReserveTotal,\n\tLossReserveMiscellaneous1,\n\tExpenseMiscellaneous1,\n\tExpenseReserveTotal,\n\tExpenseReserveMiscellaneous1,\n\tclaim_rep_email AS AdjusterEmail,\n\thandling_office_mgr_email AS SupervisorEmail,\n\tloss_loc_zip AS LossPostal,\n\tCategoryIndicator,\n\tname AS InsuredName,\n\tSalvageIndicator,\n\t-- *INF*: IIF (SalvageTotal < 0 OR o_direct_salvage_outstanding < 0 ,'Y','N')\n\tIFF(SalvageTotal < 0 OR o_direct_salvage_outstanding < 0, 'Y', 'N') AS o_SalvageIndicator,\n\tSubrogationIndicator,\n\t-- *INF*: IIF (SubrogationTotal < 0 OR o_direct_subrogation_outstanding < 0 ,'Y','N')  \n\tIFF(SubrogationTotal < 0 OR o_direct_subrogation_outstanding < 0, 'Y', 'N') AS o_SubrogationIndicator,\n\tExAdjusterIndicator,\n\tGeneralMiscellaneous1,\n\tGeneralMiscellaneous2,\n\treserve_ctgry_descript AS GeneralMiscellaneous3,\n\tsource_claim_occurence_status_code AS GeneralMiscellaneous4,\n\tclaim_cat_code AS GeneralMiscellaneous6,\n\tmajor_peril_descript AS GeneralMiscellaneous8,\n\tGeneralMiscellaneous9,\n\tGeneralMiscellaneous10,\n\to_direct_other_recovery_loss_outstanding,\n\to_direct_other_recovery_alae_outstanding,\n\to_direct_salvage_outstanding,\n\to_direct_subrogation_outstanding,\n\tdirect_salvage_paid,\n\tdirect_salvage_outstanding,\n\tdirect_subrogation_paid,\n\tdirect_subrogation_outstanding,\n\t'N/A' AS defaultValue1,\n\tAgencyCode,\n\tClaimFeatureRepresentativeName,\n\tClaimFeatureRepresentativeCode,\n\tclaim_loss_descript,\n\tsource_claim_rpted_date,\n\tpol_eff_date,\n\tpol_exp_date,\n\to_direct_salvage_outstanding AS SalvageReserveAmount,\n\to_direct_subrogation_outstanding AS SubrogationReserveAmount,\n\tExpenseTotal + ExpenseReserveTotal AS ExpenseIncurred,\n\tLossTotal + LossReserveTotal AS LossIncurred,\n\tSalvageTotal + SalvageReserveAmount AS SalvageIncurred,\n\tSubrogationTotal + SubrogationReserveAmount AS SubrogationIncurred\n\tFROM JNR_cce\n),\nLKP_WorkClaimsCentersOfExpertiseExtract AS (\n\tSELECT\n\tWorkClaimsCentersOfExpertiseId,\n\tClaimtype,\n\tCoverageType,\n\tStatus,\n\tPolicyNumber,\n\tLossTotal,\n\tExpenseTotal,\n\tSalvageTotal,\n\tSubrogationTotal,\n\tLossDate,\n\tOpenedDate,\n\tClosedDate,\n\tAdjusterName,\n\tAdjusterCode,\n\tSupervisorCode,\n\tSupervisorName,\n\tOfficeCode,\n\tOfficeName,\n\tUnitName,\n\tUnitCode,\n\tClaimantName,\n\tLossIndemnity,\n\tLossMedical,\n\tLegalIndicator,\n\tLossState,\n\tPolicyType,\n\tLossType,\n\tCompanyName,\n\tJurisdiction,\n\tLossMiscellaneous1,\n\tLossReserveTotal,\n\tLossReserveMiscellaneous1,\n\tExpenseMiscellaneous1,\n\tExpenseReserveTotal,\n\tExpenseReserveMiscellaneous1,\n\tAdjusterEmail,\n\tSupervisorEmail,\n\tLossPostal,\n\tCategoryIndicator,\n\tInsuredName,\n\tGeneralMiscellaneous1,\n\tGeneralMiscellaneous3,\n\tGeneralMiscellaneous4,\n\tGeneralMiscellaneous6,\n\tGeneralMiscellaneous8,\n\tGeneralMiscellaneous9,\n\tGeneralMiscellaneous10,\n\tAgencyCode,\n\tClaimFeatureRepresentativeCode,\n\tClaimFeatureRepresentativeName,\n\tLossDescription,\n\tDateNotification,\n\tPolicyEffectiveDate,\n\tPolicyTerminationDate,\n\tClaimNumber,\n\tSubClaimId\n\tFROM (\n\t\tSELECT WorkClaimsCentersOfExpertiseExtract.WorkClaimsCentersOfExpertiseExtractId AS WorkClaimsCentersOfExpertiseId,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.Claimtype AS Claimtype,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.CoverageType AS CoverageType,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.STATUS AS STATUS,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.PolicyNumber AS PolicyNumber,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossTotal AS LossTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ExpenseTotal AS ExpenseTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SalvageTotal AS SalvageTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SubrogationTotal AS SubrogationTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossDate AS LossDate,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.OpenedDate AS OpenedDate,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ClosedDate AS ClosedDate,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.AdjusterName AS AdjusterName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.AdjusterCode AS AdjusterCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SupervisorCode AS SupervisorCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SupervisorName AS SupervisorName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.OfficeCode AS OfficeCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.OfficeName AS OfficeName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.UnitName AS UnitName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.UnitCode AS UnitCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ClaimantName AS ClaimantName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossIndemnity AS LossIndemnity,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossMedical AS LossMedical,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LegalIndicator AS LegalIndicator,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossState AS LossState,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.PolicyType AS PolicyType,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossType AS LossType,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.CompanyName AS CompanyName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.Jurisdiction AS Jurisdiction,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossMiscellaneous1 AS LossMiscellaneous1,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossReserveTotal AS LossReserveTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossReserveMiscellaneous1 AS LossReserveMiscellaneous1,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ExpenseMiscellaneous1 AS ExpenseMiscellaneous1,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ExpenseReserveTotal AS ExpenseReserveTotal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ExpenseReserveMiscellaneous1 AS ExpenseReserveMiscellaneous1,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.AdjusterEmail AS AdjusterEmail,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SupervisorEmail AS SupervisorEmail,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.LossPostal AS LossPostal,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.CategoryIndicator AS CategoryIndicator,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.InsuredName AS InsuredName,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous1 AS GeneralMiscellaneous1,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous3 AS GeneralMiscellaneous3,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous4 AS GeneralMiscellaneous4,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous6 AS GeneralMiscellaneous6,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous8 AS GeneralMiscellaneous8,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous9 AS GeneralMiscellaneous9,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous10 AS GeneralMiscellaneous10,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.AgencyCode AS AgencyCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ClaimNumber AS ClaimNumber,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.SubClaimId AS SubClaimId,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ClaimFeatureRepresentativeCode AS ClaimFeatureRepresentativeCode,\r\n\t\t\tWorkClaimsCentersOfExpertiseExtract.ClaimFeatureRepresentativeName AS ClaimFeatureRepresentativeName\r\n\t\t\t, WorkClaimsCentersOfExpertiseExtract.LossDescription AS LossDescription\r\n\t\t\t, WorkClaimsCentersOfExpertiseExtract.DateNotification AS DateNotification\r\n\t\t\t, WorkClaimsCentersOfExpertiseExtract.PolicyEffectiveDate AS PolicyEffectiveDate\r\n\t\t\t, WorkClaimsCentersOfExpertiseExtract.PolicyTerminationDate AS PolicyTerminationDate\r\n\t\tFROM WorkClaimsCentersOfExpertiseExtract\r\n\t\tORDER BY WorkClaimsCentersOfExpertiseExtract.ModifiedDate DESC --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ClaimNumber,SubClaimId ORDER BY WorkClaimsCentersOfExpertiseId) = 1\n),\nEXP_Flag_Row AS (\n\tSELECT\n\tLKP_WorkClaimsCentersOfExpertiseExtract.WorkClaimsCentersOfExpertiseId AS LKP_WorkClaimsCentersOfExpertiseId,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.Claimtype AS LKP_Claimtype,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.CoverageType AS LKP_CoverageType,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.Status AS LKP_PolicyNumber,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.PolicyNumber AS LKP_LossTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossTotal AS LKP_ExpenseTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ExpenseTotal AS LKP_SalvageTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.SalvageTotal AS LKP_SubrogationTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossDate AS LKP_LossDate,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.OpenedDate AS LKP_OpenedDate,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ClosedDate AS LKP_ClosedDate,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.AdjusterName AS LKP_AdjusterName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.AdjusterCode AS LKP_AdjusterCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.SupervisorCode AS LKP_SupervisorCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.SupervisorName AS LKP_SupervisorName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.OfficeCode AS LKP_OfficeCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.OfficeName AS LKP_OfficeName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.UnitName AS LKP_UnitName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.UnitCode AS LKP_UnitCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ClaimantName AS LKP_ClaimantName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossIndemnity AS LKP_LossIndemnity,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossMedical AS LKP_LossMedical,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LegalIndicator AS LKP_LegalIndicator,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossState AS LKP_LossState,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.PolicyType AS LKP_PolicyType,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossType AS LKP_LossType,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.CompanyName AS LKP_CompanyName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.Jurisdiction AS LKP_Jurisdiction,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossMiscellaneous1 AS LKP_LossMiscellaneous1,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossReserveTotal AS LKP_LossReserveTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossReserveMiscellaneous1 AS LKP_LossReserveMiscellaneous1,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ExpenseMiscellaneous1 AS LKP_ExpenseMiscellaneous1,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ExpenseReserveTotal AS LKP_ExpenseReserveTotal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ExpenseReserveMiscellaneous1 AS LKP_ExpenseReserveMiscellaneous1,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.AdjusterEmail AS LKP_AdjusterEmail,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.SupervisorEmail AS LKP_SupervisorEmail,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossPostal AS LKP_LossPostal,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.CategoryIndicator AS LKP_CategoryIndicator,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.InsuredName AS LKP_InsuredName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous1 AS LKP_GeneralMiscellaneous1,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous3 AS LKP_GeneralMiscellaneous3,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous4 AS LKP_GeneralMiscellaneous4,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous6 AS LKP_GeneralMiscellaneous6,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous8 AS LKP_GeneralMiscellaneous8,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous9 AS LKP_GeneralMiscellaneous9,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.GeneralMiscellaneous10 AS LKP_GeneralMiscellaneous10,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.AgencyCode AS LKP_AgencyCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ClaimFeatureRepresentativeCode AS LKP_ClaimFeatureRepresentativeCode,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.ClaimFeatureRepresentativeName AS LKP_ClaimFeatureRepresentativeName,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.LossDescription AS LKP_LossDescription,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.DateNotification AS LKP_DateNotification,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.PolicyEffectiveDate AS LKP_PolicyEffectiveDate,\n\tLKP_WorkClaimsCentersOfExpertiseExtract.PolicyTerminationDate AS LKP_PolicyTerminationDate,\n\tEXP_passthrough.AuditId,\n\tEXP_passthrough.ModifiedDate,\n\tEXP_passthrough.ClaimNumber,\n\tEXP_passthrough.SubClaimId,\n\tEXP_passthrough.Claimtype,\n\tEXP_passthrough.missing_insurancesegment_cvgtype,\n\tEXP_passthrough.missing_sub_non_asl_code_descript_cvgtype,\n\tEXP_passthrough.missing_majorperil_cvgtype,\n\tEXP_passthrough.missing_reserve_ctgry_descript_cvgtype,\n\tEXP_passthrough.CoverageType,\n\tEXP_passthrough.o_Status AS Status,\n\tEXP_passthrough.PolicyNumber,\n\tEXP_passthrough.LossTotal,\n\tEXP_passthrough.ExpenseTotal,\n\tEXP_passthrough.SalvageTotal,\n\tEXP_passthrough.SubrogationTotal,\n\tEXP_passthrough.LossDate,\n\tEXP_passthrough.OpenedDate,\n\tEXP_passthrough.ClosedDate,\n\tEXP_passthrough.AdjusterName,\n\tEXP_passthrough.AdjusterCode,\n\tEXP_passthrough.SupervisorCode,\n\tEXP_passthrough.SupervisorName,\n\tEXP_passthrough.OfficeCode,\n\tEXP_passthrough.OfficeName,\n\tEXP_passthrough.UnitName,\n\tEXP_passthrough.UnitCode,\n\tEXP_passthrough.ClaimantName,\n\tEXP_passthrough.LossIndemnity,\n\tEXP_passthrough.LossMedical,\n\tEXP_passthrough.LegalIndicator,\n\tEXP_passthrough.LossState,\n\tEXP_passthrough.PolicyType,\n\tEXP_passthrough.LossType,\n\tEXP_passthrough.CompanyName,\n\tEXP_passthrough.Jurisdiction,\n\tEXP_passthrough.LossMiscellaneous1,\n\tEXP_passthrough.LossReserveTotal,\n\tEXP_passthrough.LossReserveMiscellaneous1,\n\tEXP_passthrough.ExpenseMiscellaneous1,\n\tEXP_passthrough.ExpenseReserveTotal AS ExpenseReserveTotal1,\n\tEXP_passthrough.ExpenseReserveMiscellaneous1,\n\tEXP_passthrough.AdjusterEmail,\n\tEXP_passthrough.SupervisorEmail,\n\tEXP_passthrough.LossPostal,\n\tEXP_passthrough.CategoryIndicator,\n\tEXP_passthrough.InsuredName,\n\tEXP_passthrough.o_SalvageIndicator AS SalvageIndicator,\n\tEXP_passthrough.o_SubrogationIndicator AS SubrogationIndicator,\n\tEXP_passthrough.ExAdjusterIndicator,\n\tEXP_passthrough.GeneralMiscellaneous1,\n\tEXP_passthrough.GeneralMiscellaneous2,\n\tEXP_passthrough.GeneralMiscellaneous3,\n\tEXP_passthrough.GeneralMiscellaneous4,\n\tEXP_passthrough.GeneralMiscellaneous6,\n\tEXP_passthrough.GeneralMiscellaneous8,\n\tEXP_passthrough.GeneralMiscellaneous9,\n\tEXP_passthrough.GeneralMiscellaneous10,\n\tEXP_passthrough.AgencyCode,\n\tEXP_passthrough.ClaimFeatureRepresentativeCode,\n\tEXP_passthrough.ClaimFeatureRepresentativeName,\n\tEXP_passthrough.claim_loss_descript,\n\tEXP_passthrough.source_claim_rpted_date,\n\tEXP_passthrough.pol_eff_date,\n\tEXP_passthrough.pol_exp_date,\n\tEXP_passthrough.defaultValue1,\n\t-- *INF*: IIF(ISNULL(LKP_WorkClaimsCentersOfExpertiseId),'INSERT',\r\n\t-- IIF(NOT ISNULL(LKP_WorkClaimsCentersOfExpertiseId) AND (LKP_CoverageType<>CoverageType OR LKP_PolicyNumber<>PolicyNumber OR LKP_Claimtype<>Claimtype OR\r\n\t-- \r\n\t-- ROUND(abs(LKP_LossTotal-LossTotal ),2)>.001  OR \r\n\t-- ROUND(abs(LKP_ExpenseTotal-ExpenseTotal ),2)>.001OR\r\n\t-- ROUND(abs(LKP_SalvageTotal-SalvageTotal ),2)>.001OR\r\n\t-- ROUND(abs(LKP_SubrogationTotal-SubrogationTotal ),2)>.001 OR\r\n\t-- \r\n\t-- LKP_LossDate<>LossDate OR LKP_OpenedDate<>OpenedDate OR LKP_ClosedDate<>ClosedDate OR LKP_AdjusterName<>AdjusterName OR LKP_AdjusterCode<>AdjusterCode OR LKP_SupervisorCode<>SupervisorCode OR LKP_SupervisorName<>SupervisorName OR LKP_OfficeCode<>OfficeCode OR LKP_OfficeName<>OfficeName OR LKP_UnitName<>UnitName OR LKP_UnitCode<>UnitCode OR LKP_ClaimantName<>ClaimantName OR \r\n\t-- \r\n\t-- ROUND(abs(LKP_LossIndemnity-LossIndemnity ),2)>.001OR\r\n\t-- ROUND(abs(LKP_LossMedical-LossMedical ),2)>.001OR\r\n\t-- \r\n\t-- LKP_LegalIndicator<>LegalIndicator OR LKP_LossState<>LossState OR LKP_PolicyType<>PolicyType OR LKP_LossType<>LossType OR LKP_CompanyName<>CompanyName OR LKP_Jurisdiction<>Jurisdiction OR\r\n\t-- \r\n\t-- ROUND(abs(LKP_LossMiscellaneous1-LossMiscellaneous1 ),2)>.001 OR\r\n\t-- ROUND(abs(LKP_LossReserveTotal-LossReserveTotal ),2)>.001 OR\r\n\t-- ROUND(abs(LKP_LossReserveMiscellaneous1-LossReserveMiscellaneous1),2)>.001 OR\r\n\t-- ROUND(abs(LKP_ExpenseMiscellaneous1-ExpenseMiscellaneous1),2)>.001 OR\r\n\t-- ROUND(abs(LKP_ExpenseReserveTotal-ExpenseReserveTotal1),2)>.001OR\r\n\t-- ROUND(abs(LKP_ExpenseReserveMiscellaneous1-ExpenseReserveMiscellaneous1),2)>0.01 OR\r\n\t-- \r\n\t-- LKP_AdjusterEmail<>AdjusterEmail OR LKP_SupervisorEmail<>SupervisorEmail OR LKP_LossPostal<>LossPostal OR LKP_CategoryIndicator<>CategoryIndicator OR LKP_InsuredName<>InsuredName OR LKP_GeneralMiscellaneous1<>GeneralMiscellaneous1 OR LKP_GeneralMiscellaneous3<>GeneralMiscellaneous3 OR LKP_GeneralMiscellaneous4<>GeneralMiscellaneous4 OR  LKP_GeneralMiscellaneous6<>GeneralMiscellaneous6 OR LKP_GeneralMiscellaneous8<>GeneralMiscellaneous8 OR LKP_GeneralMiscellaneous9<>GeneralMiscellaneous9 OR LKP_GeneralMiscellaneous10<>GeneralMiscellaneous10 OR LKP_AgencyCode<>AgencyCode OR LKP_ClaimFeatureRepresentativeCode<>ClaimFeatureRepresentativeCode OR LKP_ClaimFeatureRepresentativeName<>ClaimFeatureRepresentativeName OR\r\n\t-- LKP_LossDescription<>claim_loss_descript OR \r\n\t-- LKP_DateNotification<>source_claim_rpted_date OR \r\n\t-- LKP_PolicyEffectiveDate<>pol_eff_date OR \r\n\t-- LKP_PolicyTerminationDate<>pol_exp_date\r\n\t-- ),'INSERT','NO CHANGE'))\n\tIFF(\n\t    LKP_WorkClaimsCentersOfExpertiseId IS NULL, 'INSERT',\n\t    IFF(\n\t        LKP_WorkClaimsCentersOfExpertiseId IS NULL\n\t        and (LKP_CoverageType <> CoverageType\n\t        or LKP_PolicyNumber <> PolicyNumber\n\t        or LKP_Claimtype <> Claimtype\n\t        or ROUND(abs(LKP_LossTotal - LossTotal), 2) > .001\n\t        or ROUND(abs(LKP_ExpenseTotal - ExpenseTotal), 2) > .001\n\t        or ROUND(abs(LKP_SalvageTotal - SalvageTotal), 2) > .001\n\t        or ROUND(abs(LKP_SubrogationTotal - SubrogationTotal), 2) > .001\n\t        or LKP_LossDate <> LossDate\n\t        or LKP_OpenedDate <> OpenedDate\n\t        or LKP_ClosedDate <> ClosedDate\n\t        or LKP_AdjusterName <> AdjusterName\n\t        or LKP_AdjusterCode <> AdjusterCode\n\t        or LKP_SupervisorCode <> SupervisorCode\n\t        or LKP_SupervisorName <> SupervisorName\n\t        or LKP_OfficeCode <> OfficeCode\n\t        or LKP_OfficeName <> OfficeName\n\t        or LKP_UnitName <> UnitName\n\t        or LKP_UnitCode <> UnitCode\n\t        or LKP_ClaimantName <> ClaimantName\n\t        or ROUND(abs(LKP_LossIndemnity - LossIndemnity), 2) > .001\n\t        or ROUND(abs(LKP_LossMedical - LossMedical), 2) > .001\n\t        or LKP_LegalIndicator <> LegalIndicator\n\t        or LKP_LossState <> LossState\n\t        or LKP_PolicyType <> PolicyType\n\t        or LKP_LossType <> LossType\n\t        or LKP_CompanyName <> CompanyName\n\t        or LKP_Jurisdiction <> Jurisdiction\n\t        or ROUND(abs(LKP_LossMiscellaneous1 - LossMiscellaneous1), 2) > .001\n\t        or ROUND(abs(LKP_LossReserveTotal - LossReserveTotal), 2) > .001\n\t        or ROUND(abs(LKP_LossReserveMiscellaneous1 - LossReserveMiscellaneous1), 2) > .001\n\t        or ROUND(abs(LKP_ExpenseMiscellaneous1 - ExpenseMiscellaneous1), 2) > .001\n\t        or ROUND(abs(LKP_ExpenseReserveTotal - ExpenseReserveTotal1), 2) > .001\n\t        or ROUND(abs(LKP_ExpenseReserveMiscellaneous1 - ExpenseReserveMiscellaneous1), 2) > 0.01\n\t        or LKP_AdjusterEmail <> AdjusterEmail\n\t        or LKP_SupervisorEmail <> SupervisorEmail\n\t        or LKP_LossPostal <> LossPostal\n\t        or LKP_CategoryIndicator <> CategoryIndicator\n\t        or LKP_InsuredName <> InsuredName\n\t        or LKP_GeneralMiscellaneous1 <> GeneralMiscellaneous1\n\t        or LKP_GeneralMiscellaneous3 <> GeneralMiscellaneous3\n\t        or LKP_GeneralMiscellaneous4 <> GeneralMiscellaneous4\n\t        or LKP_GeneralMiscellaneous6 <> GeneralMiscellaneous6\n\t        or LKP_GeneralMiscellaneous8 <> GeneralMiscellaneous8\n\t        or LKP_GeneralMiscellaneous9 <> GeneralMiscellaneous9\n\t        or LKP_GeneralMiscellaneous10 <> GeneralMiscellaneous10\n\t        or LKP_AgencyCode <> AgencyCode\n\t        or LKP_ClaimFeatureRepresentativeCode <> ClaimFeatureRepresentativeCode\n\t        or LKP_ClaimFeatureRepresentativeName <> ClaimFeatureRepresentativeName\n\t        or LKP_LossDescription <> claim_loss_descript\n\t        or LKP_DateNotification <> source_claim_rpted_date\n\t        or LKP_PolicyEffectiveDate <> pol_eff_date\n\t        or LKP_PolicyTerminationDate <> pol_exp_dNOT ate),\n\t        'INSERT',\n\t        'NO CHANGE'\n\t    )\n\t) AS Row_Flag,\n\t-- *INF*: IIF(ClaimNumber='N/A','IGNORE','INSERT')\n\tIFF(ClaimNumber = 'N/A', 'IGNORE', 'INSERT') AS NA_CLAIM_NO_FILTER,\n\t-- *INF*: IIF(LKP_Claimtype<>Claimtype,'TRUE','FALSE')\n\tIFF(LKP_Claimtype <> Claimtype, 'TRUE', 'FALSE') AS V_ClaimType,\n\t-- *INF*: IIF(LKP_CoverageType<>CoverageType,'TRUE','FALSE')\n\tIFF(LKP_CoverageType <> CoverageType, 'TRUE', 'FALSE') AS V_CoverageType,\n\t-- *INF*: IIF(LKP_PolicyNumber<>PolicyNumber,'TRUE','FALSE')\n\tIFF(LKP_PolicyNumber <> PolicyNumber, 'TRUE', 'FALSE') AS V_PolicyNumber,\n\t-- *INF*: ROUND(abs(LKP_LossTotal-LossTotal ),2)>.001\n\tROUND(abs(LKP_LossTotal - LossTotal), 2) > .001 AS V_LossTotal,\n\t-- *INF*: ROUND(abs(LKP_ExpenseTotal-ExpenseTotal ),2)>.001\n\tROUND(abs(LKP_ExpenseTotal - ExpenseTotal), 2) > .001 AS V_ExpenseTotal,\n\t-- *INF*: ROUND(abs(LKP_SalvageTotal-SalvageTotal ),2)>.001\n\tROUND(abs(LKP_SalvageTotal - SalvageTotal), 2) > .001 AS V_SalvageTotal,\n\t-- *INF*: ROUND(abs(LKP_SubrogationTotal-SubrogationTotal ),2)>.001\n\tROUND(abs(LKP_SubrogationTotal - SubrogationTotal), 2) > .001 AS V_SubrogationTotal,\n\t-- *INF*: IIF(LKP_LossDate<>LossDate,'TRUE','FALSE')\n\tIFF(LKP_LossDate <> LossDate, 'TRUE', 'FALSE') AS V_LossDate,\n\t-- *INF*: IIF(LKP_OpenedDate<>OpenedDate,'TRUE','FALSE')\n\tIFF(LKP_OpenedDate <> OpenedDate, 'TRUE', 'FALSE') AS V_OpenedDate,\n\t-- *INF*: IIF(LKP_ClosedDate<>ClosedDate,'TRUE','FALSE')\n\tIFF(LKP_ClosedDate <> ClosedDate, 'TRUE', 'FALSE') AS V_ClosedDate,\n\t-- *INF*: IIF(LKP_AdjusterName<>AdjusterName ,'TRUE','FALSE')\n\tIFF(LKP_AdjusterName <> AdjusterName, 'TRUE', 'FALSE') AS V_AdjusterName,\n\t-- *INF*: IIF(LKP_AdjusterCode<>AdjusterCode ,'TRUE','FALSE')\n\tIFF(LKP_AdjusterCode <> AdjusterCode, 'TRUE', 'FALSE') AS V_AdjusterCode,\n\t-- *INF*: IIF(LKP_SupervisorCode<>SupervisorCode,'TRUE','FALSE')\n\tIFF(LKP_SupervisorCode <> SupervisorCode, 'TRUE', 'FALSE') AS V_SupervisorCode,\n\t-- *INF*: IIF(LKP_SupervisorName<>SupervisorName,'TRUE','FALSE')\n\tIFF(LKP_SupervisorName <> SupervisorName, 'TRUE', 'FALSE') AS V_SuperVisorName,\n\t-- *INF*: IIF(LKP_OfficeCode<>OfficeCode,'TRUE','FALSE')\n\tIFF(LKP_OfficeCode <> OfficeCode, 'TRUE', 'FALSE') AS V_OfficeCode,\n\t-- *INF*: IIF(LKP_OfficeName<>OfficeName,'TRUE','FALSE')\r\n\t-- \r\n\t-- \n\tIFF(LKP_OfficeName <> OfficeName, 'TRUE', 'FALSE') AS V_Officename,\n\t-- *INF*: IIF( LKP_UnitName<>UnitName,'TRUE','FALSE')\n\tIFF(LKP_UnitName <> UnitName, 'TRUE', 'FALSE') AS V_Unitname,\n\t-- *INF*: IIF(LKP_UnitCode<>UnitCode,'TRUE','FALSE')\n\tIFF(LKP_UnitCode <> UnitCode, 'TRUE', 'FALSE') AS V_UnitCode,\n\t-- *INF*: IIF(LKP_ClaimantName<>ClaimantName,'TRUE','FALSE')\n\tIFF(LKP_ClaimantName <> ClaimantName, 'TRUE', 'FALSE') AS V_ClaimantName,\n\t-- *INF*: ROUND(abs(LKP_LossIndemnity-LossIndemnity ),2)>.001\r\n\t-- \n\tROUND(abs(LKP_LossIndemnity - LossIndemnity), 2) > .001 AS V_LossIndemnity,\n\t-- *INF*: ROUND(abs(LKP_LossMedical-LossMedical ),2)>.001\n\tROUND(abs(LKP_LossMedical - LossMedical), 2) > .001 AS V_LossMedical,\n\t-- *INF*: IIF(LKP_LegalIndicator<>LegalIndicator,'TRUE','FALSE')\n\tIFF(LKP_LegalIndicator <> LegalIndicator, 'TRUE', 'FALSE') AS V_LegalIndicator,\n\t-- *INF*: IIF(LKP_LossState<>LossState,'TRUE','FALSE')\n\tIFF(LKP_LossState <> LossState, 'TRUE', 'FALSE') AS V_LossState,\n\t-- *INF*: IIF(LKP_PolicyType<>PolicyType,'TRUE','FALSE')\n\tIFF(LKP_PolicyType <> PolicyType, 'TRUE', 'FALSE') AS V_PolicyType,\n\t-- *INF*: IIF(LKP_LossType<>LossType,'TRUE','FALSE')\n\tIFF(LKP_LossType <> LossType, 'TRUE', 'FALSE') AS V_LossType,\n\t-- *INF*: IIF(LKP_CompanyName<>CompanyName,'TRUE','FALSE')\n\tIFF(LKP_CompanyName <> CompanyName, 'TRUE', 'FALSE') AS V_CompanyName,\n\t-- *INF*: IIf(LKP_Jurisdiction<>Jurisdiction,'TRUE','FALSE')\n\tIFF(LKP_Jurisdiction <> Jurisdiction, 'TRUE', 'FALSE') AS V_Jurisdiction,\n\t-- *INF*: ROUND(abs(LKP_LossMiscellaneous1-LossMiscellaneous1 ),2)>.001\n\tROUND(abs(LKP_LossMiscellaneous1 - LossMiscellaneous1), 2) > .001 AS V_LossMiscellaneous1,\n\t-- *INF*: ROUND(abs(LKP_LossReserveTotal-LossReserveTotal ),2)>.001\n\tROUND(abs(LKP_LossReserveTotal - LossReserveTotal), 2) > .001 AS V_LossReserveTotal,\n\t-- *INF*: ROUND(abs(LKP_LossReserveMiscellaneous1-LossReserveMiscellaneous1),2)>.001\n\tROUND(abs(LKP_LossReserveMiscellaneous1 - LossReserveMiscellaneous1), 2) > .001 AS V_LossReserveMiscellaneous1,\n\t-- *INF*: ROUND(abs(LKP_ExpenseMiscellaneous1-ExpenseMiscellaneous1),2)>.001\n\tROUND(abs(LKP_ExpenseMiscellaneous1 - ExpenseMiscellaneous1), 2) > .001 AS V_ExpenseMiscellaneous1,\n\t-- *INF*: ROUND(abs(LKP_ExpenseReserveTotal-ExpenseReserveTotal1),2)>.001\n\tROUND(abs(LKP_ExpenseReserveTotal - ExpenseReserveTotal1), 2) > .001 AS V_ExpenseReserveTotal1,\n\t-- *INF*: ROUND(abs(LKP_ExpenseReserveMiscellaneous1-ExpenseReserveMiscellaneous1),2)>0.01\n\tROUND(abs(LKP_ExpenseReserveMiscellaneous1 - ExpenseReserveMiscellaneous1), 2) > 0.01 AS V_ExpenseReserveMiscellaneous1,\n\t-- *INF*: IIF(LKP_AdjusterEmail<>AdjusterEmail,'TRUE','FALSE')\n\tIFF(LKP_AdjusterEmail <> AdjusterEmail, 'TRUE', 'FALSE') AS V_AdjusterEmail,\n\t-- *INF*: IIF(LKP_SupervisorEmail<>SupervisorEmail,'TRUE','FALSE')\n\tIFF(LKP_SupervisorEmail <> SupervisorEmail, 'TRUE', 'FALSE') AS V_SupervisorEmail,\n\t-- *INF*: IIF(LKP_LossPostal<>LossPostal,'TRUE','FALSE')\n\tIFF(LKP_LossPostal <> LossPostal, 'TRUE', 'FALSE') AS V_LossPostal,\n\t-- *INF*: IIf(LKP_CategoryIndicator<>CategoryIndicator,'TRUE','FALSE')\n\tIFF(LKP_CategoryIndicator <> CategoryIndicator, 'TRUE', 'FALSE') AS V_CategoryIndicator,\n\t-- *INF*: IIF(LKP_InsuredName<>InsuredName,'TRUE','FALSE')\n\tIFF(LKP_InsuredName <> InsuredName, 'TRUE', 'FALSE') AS V_InsuredName,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous1<>GeneralMiscellaneous1,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous1 <> GeneralMiscellaneous1, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous1,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous3<>GeneralMiscellaneous3,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous3 <> GeneralMiscellaneous3, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous3,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous4<>GeneralMiscellaneous4,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous4 <> GeneralMiscellaneous4, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous4,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous6<>GeneralMiscellaneous6 ,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous6 <> GeneralMiscellaneous6, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous6,\n\t-- *INF*: IIf(LKP_GeneralMiscellaneous8<>GeneralMiscellaneous8,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous8 <> GeneralMiscellaneous8, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous8,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous9<>GeneralMiscellaneous9,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous9 <> GeneralMiscellaneous9, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous9,\n\t-- *INF*: IIF(LKP_GeneralMiscellaneous10<>GeneralMiscellaneous10 ,'TRUE','FALSE')\n\tIFF(LKP_GeneralMiscellaneous10 <> GeneralMiscellaneous10, 'TRUE', 'FALSE') AS V_GeneralMiscellaneous10,\n\t-- *INF*: IIF(LKP_ClaimFeatureRepresentativeCode<>ClaimFeatureRepresentativeCode,'TRUE','FALSE')\n\tIFF(LKP_ClaimFeatureRepresentativeCode <> ClaimFeatureRepresentativeCode, 'TRUE', 'FALSE') AS V_ClaimFeatureRepresentativeCode,\n\t-- *INF*: IIF(LKP_ClaimFeatureRepresentativeName<>ClaimFeatureRepresentativeName,'TRUE','FALSE')\n\tIFF(LKP_ClaimFeatureRepresentativeName <> ClaimFeatureRepresentativeName, 'TRUE', 'FALSE') AS V_ClaimFeatureRepresentativeName,\n\t-- *INF*: IIF(LKP_AgencyCode<>AgencyCode ,'TRUE','FALSE')\n\tIFF(LKP_AgencyCode <> AgencyCode, 'TRUE', 'FALSE') AS V_AgencyCode,\n\tEXP_passthrough.SalvageReserveAmount,\n\tEXP_passthrough.SubrogationReserveAmount,\n\tEXP_passthrough.ExpenseIncurred,\n\tEXP_passthrough.LossIncurred,\n\tEXP_passthrough.SalvageIncurred,\n\tEXP_passthrough.SubrogationIncurred\n\tFROM EXP_passthrough\n\tLEFT JOIN LKP_WorkClaimsCentersOfExpertiseExtract\n\tON LKP_WorkClaimsCentersOfExpertiseExtract.ClaimNumber = EXP_passthrough.ClaimNumber AND LKP_WorkClaimsCentersOfExpertiseExtract.SubClaimId = EXP_passthrough.SubClaimId\n),\nFIL_Inserts AS (\n\tSELECT\n\tAuditId, \n\tModifiedDate, \n\tClaimNumber, \n\tSubClaimId, \n\tClaimtype, \n\tCoverageType, \n\tStatus, \n\tPolicyNumber, \n\tLossTotal, \n\tExpenseTotal, \n\tSalvageTotal, \n\tSubrogationTotal, \n\tLossDate, \n\tOpenedDate, \n\tClosedDate, \n\tAdjusterName, \n\tAdjusterCode, \n\tSupervisorCode, \n\tSupervisorName, \n\tOfficeCode, \n\tOfficeName, \n\tUnitName, \n\tUnitCode, \n\tClaimantName, \n\tLossIndemnity, \n\tLossMedical, \n\tLegalIndicator, \n\tLossState, \n\tPolicyType, \n\tLossType, \n\tCompanyName, \n\tJurisdiction, \n\tLossMiscellaneous1, \n\tLossReserveTotal, \n\tLossReserveMiscellaneous1, \n\tExpenseMiscellaneous1, \n\tExpenseReserveTotal1, \n\tExpenseReserveMiscellaneous1, \n\tAdjusterEmail, \n\tSupervisorEmail, \n\tLossPostal, \n\tCategoryIndicator, \n\tInsuredName, \n\tSalvageIndicator, \n\tSubrogationIndicator, \n\tExAdjusterIndicator, \n\tGeneralMiscellaneous1, \n\tGeneralMiscellaneous2, \n\tGeneralMiscellaneous3, \n\tGeneralMiscellaneous4, \n\tGeneralMiscellaneous6, \n\tGeneralMiscellaneous8, \n\tGeneralMiscellaneous9, \n\tGeneralMiscellaneous10, \n\tAgencyCode, \n\tClaimFeatureRepresentativeCode, \n\tClaimFeatureRepresentativeName, \n\tclaim_loss_descript, \n\tsource_claim_rpted_date, \n\tpol_eff_date, \n\tpol_exp_date, \n\tdefaultValue1, \n\tRow_Flag, \n\tNA_CLAIM_NO_FILTER, \n\tSalvageReserveAmount, \n\tSubrogationReserveAmount, \n\tExpenseIncurred, \n\tLossIncurred, \n\tSalvageIncurred, \n\tSubrogationIncurred\n\tFROM EXP_Flag_Row\n\tWHERE Row_Flag='INSERT' AND NA_CLAIM_NO_FILTER='INSERT'\n),\nShortcut_to_WorkClaimsCentersOfExpertiseExtract AS (\n\tINSERT INTO Shortcut_to_WorkClaimsCentersOfExpertiseExtract\n\t(AuditId, ModifiedDate, ClaimNumber, SubClaimId, Claimtype, CoverageType, Status, PolicyNumber, LossTotal, ExpenseTotal, SalvageTotal, SubrogationTotal, LossDate, OpenedDate, ClosedDate, AdjusterName, AdjusterCode, SupervisorCode, SupervisorName, OfficeCode, OfficeName, UnitName, UnitCode, ClaimantName, LossIndemnity, LossMedical, LegalIndicator, LossState, PolicyType, LossType, CompanyName, Jurisdiction, LossMiscellaneous1, LossReserveTotal, LossReserveMiscellaneous1, ExpenseMiscellaneous1, ExpenseReserveTotal, ExpenseReserveMiscellaneous1, AdjusterEmail, SupervisorEmail, LossPostal, CategoryIndicator, InsuredName, SalvageIndicator, SubrogationIndicator, ExAdjusterIndicator, GeneralMiscellaneous1, GeneralMiscellaneous2, GeneralMiscellaneous3, GeneralMiscellaneous4, GeneralMiscellaneous6, GeneralMiscellaneous8, GeneralMiscellaneous9, GeneralMiscellaneous10, AgencyCode, ClaimFeatureRepresentativeCode, ClaimFeatureRepresentativeName, LossDescription, DateNotification, PolicyEffectiveDate, PolicyTerminationDate, SalvageReserveAmount, SubrogationReserveAmount, ExpenseIncurred, LossIncurred, SalvageIncurred, SubrogationIncurred)\n\tSELECT \n\tAUDITID, \n\tMODIFIEDDATE, \n\tCLAIMNUMBER, \n\tSUBCLAIMID, \n\tCLAIMTYPE, \n\tCOVERAGETYPE, \n\tSTATUS, \n\tPOLICYNUMBER, \n\tLOSSTOTAL, \n\tEXPENSETOTAL, \n\tSALVAGETOTAL, \n\tSUBROGATIONTOTAL, \n\tLOSSDATE, \n\tOPENEDDATE, \n\tCLOSEDDATE, \n\tADJUSTERNAME, \n\tADJUSTERCODE, \n\tSUPERVISORCODE, \n\tSUPERVISORNAME, \n\tOFFICECODE, \n\tOFFICENAME, \n\tUNITNAME, \n\tUNITCODE, \n\tCLAIMANTNAME, \n\tLOSSINDEMNITY, \n\tLOSSMEDICAL, \n\tLEGALINDICATOR, \n\tLOSSSTATE, \n\tPOLICYTYPE, \n\tLOSSTYPE, \n\tCOMPANYNAME, \n\tJURISDICTION, \n\tLOSSMISCELLANEOUS1, \n\tLOSSRESERVETOTAL, \n\tLOSSRESERVEMISCELLANEOUS1, \n\tEXPENSEMISCELLANEOUS1, \n\tExpenseReserveTotal1 AS EXPENSERESERVETOTAL, \n\tEXPENSERESERVEMISCELLANEOUS1, \n\tADJUSTEREMAIL, \n\tSUPERVISOREMAIL, \n\tLOSSPOSTAL, \n\tCATEGORYINDICATOR, \n\tINSUREDNAME, \n\tSALVAGEINDICATOR, \n\tSUBROGATIONINDICATOR, \n\tEXADJUSTERINDICATOR, \n\tGENERALMISCELLANEOUS1, \n\tGENERALMISCELLANEOUS2, \n\tGENERALMISCELLANEOUS3, \n\tGENERALMISCELLANEOUS4, \n\tGENERALMISCELLANEOUS6, \n\tGENERALMISCELLANEOUS8, \n\tGENERALMISCELLANEOUS9, \n\tGENERALMISCELLANEOUS10, \n\tAGENCYCODE, \n\tCLAIMFEATUREREPRESENTATIVECODE, \n\tCLAIMFEATUREREPRESENTATIVENAME, \n\tclaim_loss_descript AS LOSSDESCRIPTION, \n\tsource_claim_rpted_date AS DATENOTIFICATION, \n\tpol_eff_date AS POLICYEFFECTIVEDATE, \n\tpol_exp_date AS POLICYTERMINATIONDATE, \n\tSALVAGERESERVEAMOUNT, \n\tSUBROGATIONRESERVEAMOUNT, \n\tEXPENSEINCURRED, \n\tLOSSINCURRED, \n\tSALVAGEINCURRED, \n\tSUBROGATIONINCURRED\n\tFROM FIL_Inserts\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_BASE_DATE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}