{
    "name": "s_m_POL_STG_Insert_arch_pif_43jj_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43jj_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_pif_43jj_stage AS (\n\tSELECT\n\t\tpif_43jj_stage_id,\n\t\tpif_symbol,\n\t\tpif_policy_number,\n\t\tpif_module,\n\t\tpmd4j_rec_length,\n\t\tpmd4j_action_code,\n\t\tpmd4j_file_id,\n\t\tpmd4j_segment_id,\n\t\tpmd4j_segment_status,\n\t\tpmd4j_year_transaction,\n\t\tpmd4j_month_transaction,\n\t\tpmd4j_day_transaction,\n\t\tpmd4j_segment_level_code,\n\t\tpmd4j_segment_part_code,\n\t\tpmd4j_sub_part_code,\n\t\tpmd4j_insurance_line,\n\t\tpmd4j_location_number,\n\t\tpmd4j_sub_location_number,\n\t\tpmd4j_risk_unit_group,\n\t\tpmd4j_seq_rsk_unt_grp,\n\t\tpmd4j_risk_unit,\n\t\tpmd4j_risk_sequence,\n\t\tpmd4j_risk_type_ind,\n\t\tpmd4j_year_item_effective,\n\t\tpmd4j_month_item_effective,\n\t\tpmd4j_day_item_effective,\n\t\tpmd4j_use_code,\n\t\tpmd4j_sequence_use_code,\n\t\tpmd4j_year_process,\n\t\tpmd4j_month_process,\n\t\tpmd4j_day_process,\n\t\tpmd4j_use_code_data,\n\t\tpmd4j_sort_name,\n\t\tpmd4j_tax_loc,\n\t\tpmd4j_name_type_ind,\n\t\tpmd4j_address_line_1,\n\t\tpmd4j_addr_lin_2_pos_1,\n\t\tpmd4j_addr_lin_2_pos_2_30,\n\t\tpmd4j_address_line_3,\n\t\tpmd4j_address_line_4,\n\t\tpmd4j_id_number_9,\n\t\tpmd4j_postal_code_1,\n\t\tpmd4j_phone_area,\n\t\tpmd4j_phone_exchange,\n\t\tpmd4j_phone_number,\n\t\tpmd4j_phone_extension,\n\t\tpmd4j_interest_item,\n\t\tpmd4j_loc_line_exclusion,\n\t\tpmd4j_surcharge,\n\t\tpmd4j_municipal_tax,\n\t\tpmd4j_02_audit_code,\n\t\tpmd4j_02_legal_entity,\n\t\tpmd4j_dec_change_flag,\n\t\tpmd4j_blkt_misc_loc_exclusion,\n\t\tpmd4j_location_state,\n\t\tpmd4j_matching_loc_sw,\n\t\tpmd4j_item_expire_year_cc,\n\t\tpmd4j_item_expire_year_yy,\n\t\tpmd4j_item_expire_month,\n\t\tpmd4j_item_expire_day,\n\t\tpmd4j_class,\n\t\tpmd4j_name_ext_ind,\n\t\tpmd4j_aiex_alpha,\n\t\tpmd4j_address_stand_sw,\n\t\tpmd4j_city_tax_city_x,\n\t\tpmd4j_city_cf_tax,\n\t\tpmd4j_city_gl_tax,\n\t\tpmd4j_city_ca_tax,\n\t\tpmd4j_city_im_tax,\n\t\tpmd4j_city_ao_tax,\n\t\tpmd4j_city_tc1_tax,\n\t\tpmd4j_city_tc2_tax,\n\t\tpmd4j_city_tc3_tax,\n\t\tpmd4j_pms_future_use,\n\t\tpmd4j_wbm_action_ind,\n\t\tpmd4j_wbm_form,\n\t\tpmd4j_wbm_cdays,\n\t\tpmd4j_wbm_cprnt,\n\t\tpmd4j_dist_areax,\n\t\tpmd4j_risk_cityx,\n\t\tpmd4j_survey_status,\n\t\tpmd4j_survey_date,\n\t\tpmd4j_pc_indicator,\n\t\tpmd4j_ws_indicator,\n\t\tpmd4j_dist_area_uncomp,\n\t\tpmd4j_risk_city_uncomp,\n\t\tpmd4j_cnty_tax_cnty_x,\n\t\tpmd4j_cnty_cf_tax,\n\t\tpmd4j_cnty_gl_tax,\n\t\tpmd4j_cnty_ca_tax,\n\t\tpmd4j_cnty_im_tax,\n\t\tpmd4j_cnty_ao_tax,\n\t\tpmd4j_cnty_tc1_tax,\n\t\tpmd4j_cnty_tc2_tax,\n\t\tpmd4j_cnty_tc3_tax,\n\t\tpmd4j_city_tax_city_ovrride,\n\t\tpmd4j_city_cf_ovrride,\n\t\tpmd4j_city_gl_ovrride,\n\t\tpmd4j_city_im_ovrride,\n\t\tpmd4j_city_ca_ovrride,\n\t\tpmd4j_city_ao_ovrride,\n\t\tpmd4j_city_tc1_ovrride,\n\t\tpmd4j_city_tc2_ovrride,\n\t\tpmd4j_city_tc3_ovrride,\n\t\tpmd4j_cnty_tax_cnty_ovrride,\n\t\tpmd4j_cnty_cf_ovrride,\n\t\tpmd4j_cnty_gl_ovrride,\n\t\tpmd4j_cnty_im_ovrride,\n\t\tpmd4j_cnty_ca_ovrride,\n\t\tpmd4j_cnty_ao_ovrride,\n\t\tpmd4j_cnty_tc1_ovrride,\n\t\tpmd4j_cnty_tc2_ovrride,\n\t\tpmd4j_cnty_tc3_ovrride,\n\t\tpmd4j_municipal_tax_ovrride,\n\t\tpmd4j_addr_stand_ovrride,\n\t\tpmd4j_yr2000_cust_use,\n\t\tlogical_flag,\n\t\textract_date,\n\t\tas_of_date,\n\t\trecord_count,\n\t\tsource_system_id,\n\t\tinf_action,\n\t\tinf_timestamp\n\tFROM pif_43jj_stage\n),\nExp_arch_pif_43jj AS (\n\tSELECT\n\tpif_43jj_stage_id,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tpmd4j_rec_length,\n\tpmd4j_action_code,\n\tpmd4j_file_id,\n\tpmd4j_segment_id,\n\tpmd4j_segment_status,\n\tpmd4j_year_transaction,\n\tpmd4j_month_transaction,\n\tpmd4j_day_transaction,\n\tpmd4j_segment_level_code,\n\tpmd4j_segment_part_code,\n\tpmd4j_sub_part_code,\n\tpmd4j_insurance_line,\n\tpmd4j_location_number,\n\tpmd4j_sub_location_number,\n\tpmd4j_risk_unit_group,\n\tpmd4j_seq_rsk_unt_grp,\n\tpmd4j_risk_unit,\n\tpmd4j_risk_sequence,\n\tpmd4j_risk_type_ind,\n\tpmd4j_year_item_effective,\n\tpmd4j_month_item_effective,\n\tpmd4j_day_item_effective,\n\tpmd4j_use_code,\n\tpmd4j_sequence_use_code,\n\tpmd4j_year_process,\n\tpmd4j_month_process,\n\tpmd4j_day_process,\n\tpmd4j_use_code_data,\n\tpmd4j_sort_name,\n\tpmd4j_tax_loc,\n\tpmd4j_name_type_ind,\n\tpmd4j_address_line_1,\n\tpmd4j_addr_lin_2_pos_1,\n\tpmd4j_addr_lin_2_pos_2_30,\n\tpmd4j_address_line_3,\n\tpmd4j_address_line_4,\n\tpmd4j_id_number_9,\n\tpmd4j_postal_code_1,\n\tpmd4j_phone_area,\n\tpmd4j_phone_exchange,\n\tpmd4j_phone_number,\n\tpmd4j_phone_extension,\n\tpmd4j_interest_item,\n\tpmd4j_loc_line_exclusion,\n\tpmd4j_surcharge,\n\tpmd4j_municipal_tax,\n\tpmd4j_02_audit_code,\n\tpmd4j_02_legal_entity,\n\tpmd4j_dec_change_flag,\n\tpmd4j_blkt_misc_loc_exclusion,\n\tpmd4j_location_state,\n\tpmd4j_matching_loc_sw,\n\tpmd4j_item_expire_year_cc,\n\tpmd4j_item_expire_year_yy,\n\tpmd4j_item_expire_month,\n\tpmd4j_item_expire_day,\n\tpmd4j_class,\n\tpmd4j_name_ext_ind,\n\tpmd4j_aiex_alpha,\n\tpmd4j_address_stand_sw,\n\tpmd4j_city_tax_city_x,\n\tpmd4j_city_cf_tax,\n\tpmd4j_city_gl_tax,\n\tpmd4j_city_ca_tax,\n\tpmd4j_city_im_tax,\n\tpmd4j_city_ao_tax,\n\tpmd4j_city_tc1_tax,\n\tpmd4j_city_tc2_tax,\n\tpmd4j_city_tc3_tax,\n\tpmd4j_pms_future_use,\n\tpmd4j_wbm_action_ind,\n\tpmd4j_wbm_form,\n\tpmd4j_wbm_cdays,\n\tpmd4j_wbm_cprnt,\n\tpmd4j_dist_areax,\n\tpmd4j_risk_cityx,\n\tpmd4j_survey_status,\n\tpmd4j_survey_date,\n\tpmd4j_pc_indicator,\n\tpmd4j_ws_indicator,\n\tpmd4j_dist_area_uncomp,\n\tpmd4j_risk_city_uncomp,\n\tpmd4j_cnty_tax_cnty_x,\n\tpmd4j_cnty_cf_tax,\n\tpmd4j_cnty_gl_tax,\n\tpmd4j_cnty_ca_tax,\n\tpmd4j_cnty_im_tax,\n\tpmd4j_cnty_ao_tax,\n\tpmd4j_cnty_tc1_tax,\n\tpmd4j_cnty_tc2_tax,\n\tpmd4j_cnty_tc3_tax,\n\tpmd4j_city_tax_city_ovrride,\n\tpmd4j_city_cf_ovrride,\n\tpmd4j_city_gl_ovrride,\n\tpmd4j_city_im_ovrride,\n\tpmd4j_city_ca_ovrride,\n\tpmd4j_city_ao_ovrride,\n\tpmd4j_city_tc1_ovrride,\n\tpmd4j_city_tc2_ovrride,\n\tpmd4j_city_tc3_ovrride,\n\tpmd4j_cnty_tax_cnty_ovrride,\n\tpmd4j_cnty_cf_ovrride,\n\tpmd4j_cnty_gl_ovrride,\n\tpmd4j_cnty_im_ovrride,\n\tpmd4j_cnty_ca_ovrride,\n\tpmd4j_cnty_ao_ovrride,\n\tpmd4j_cnty_tc1_ovrride,\n\tpmd4j_cnty_tc2_ovrride,\n\tpmd4j_cnty_tc3_ovrride,\n\tpmd4j_municipal_tax_ovrride,\n\tpmd4j_addr_stand_ovrride,\n\tpmd4j_yr2000_cust_use,\n\tlogical_flag,\n\textract_date AS EXTRACT_DATE,\n\tas_of_date AS AS_OF_DATE,\n\trecord_count,\n\tsource_system_id AS SOURCE_SYSTEM_ID,\n\tinf_action,\n\tinf_timestamp,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AUDIT_ID\n\tFROM SQ_pif_43jj_stage\n),\narch_pif_43jj_stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_pif_43jj_stage\n\t(pif_43jj_stage_id, pif_symbol, pif_policy_number, pif_module, pmd4j_rec_length, pmd4j_action_code, pmd4j_file_id, pmd4j_segment_id, pmd4j_segment_status, pmd4j_year_transaction, pmd4j_month_transaction, pmd4j_day_transaction, pmd4j_segment_level_code, pmd4j_segment_part_code, pmd4j_sub_part_code, pmd4j_insurance_line, pmd4j_location_number, pmd4j_sub_location_number, pmd4j_risk_unit_group, pmd4j_seq_rsk_unt_grp, pmd4j_risk_unit, pmd4j_risk_sequence, pmd4j_risk_type_ind, pmd4j_year_item_effective, pmd4j_month_item_effective, pmd4j_day_item_effective, pmd4j_use_code, pmd4j_sequence_use_code, pmd4j_year_process, pmd4j_month_process, pmd4j_day_process, pmd4j_use_code_data, pmd4j_sort_name, pmd4j_tax_loc, pmd4j_name_type_ind, pmd4j_address_line_1, pmd4j_addr_lin_2_pos_1, pmd4j_addr_lin_2_pos_2_30, pmd4j_address_line_3, pmd4j_address_line_4, pmd4j_id_number_9, pmd4j_postal_code_1, pmd4j_phone_area, pmd4j_phone_exchange, pmd4j_phone_number, pmd4j_phone_extension, pmd4j_interest_item, pmd4j_loc_line_exclusion, pmd4j_surcharge, pmd4j_municipal_tax, pmd4j_02_audit_code, pmd4j_02_legal_entity, pmd4j_dec_change_flag, pmd4j_blkt_misc_loc_exclusion, pmd4j_location_state, pmd4j_matching_loc_sw, pmd4j_item_expire_year_cc, pmd4j_item_expire_year_yy, pmd4j_item_expire_month, pmd4j_item_expire_day, pmd4j_class, pmd4j_name_ext_ind, pmd4j_aiex_alpha, pmd4j_address_stand_sw, pmd4j_city_tax_city_x, pmd4j_city_cf_tax, pmd4j_city_gl_tax, pmd4j_city_ca_tax, pmd4j_city_im_tax, pmd4j_city_ao_tax, pmd4j_city_tc1_tax, pmd4j_city_tc2_tax, pmd4j_city_tc3_tax, pmd4j_pms_future_use, pmd4j_wbm_action_ind, pmd4j_wbm_form, pmd4j_wbm_cdays, pmd4j_wbm_cprnt, pmd4j_dist_areax, pmd4j_risk_cityx, pmd4j_survey_status, pmd4j_survey_date, pmd4j_pc_indicator, pmd4j_ws_indicator, pmd4j_dist_area_uncomp, pmd4j_risk_city_uncomp, pmd4j_cnty_tax_cnty_x, pmd4j_cnty_cf_tax, pmd4j_cnty_gl_tax, pmd4j_cnty_ca_tax, pmd4j_cnty_im_tax, pmd4j_cnty_ao_tax, pmd4j_cnty_tc1_tax, pmd4j_cnty_tc2_tax, pmd4j_cnty_tc3_tax, pmd4j_city_tax_city_ovrride, pmd4j_city_cf_ovrride, pmd4j_city_gl_ovrride, pmd4j_city_im_ovrride, pmd4j_city_ca_ovrride, pmd4j_city_ao_ovrride, pmd4j_city_tc1_ovrride, pmd4j_city_tc2_ovrride, pmd4j_city_tc3_ovrride, pmd4j_cnty_tax_cnty_ovrride, pmd4j_cnty_cf_ovrride, pmd4j_cnty_gl_ovrride, pmd4j_cnty_im_ovrride, pmd4j_cnty_ca_ovrride, pmd4j_cnty_ao_ovrride, pmd4j_cnty_tc1_ovrride, pmd4j_cnty_tc2_ovrride, pmd4j_cnty_tc3_ovrride, pmd4j_municipal_tax_ovrride, pmd4j_addr_stand_ovrride, pmd4j_yr2000_cust_use, logical_flag, extract_date, as_of_date, record_count, source_system_id, inf_action, inf_timestamp, audit_id)\n\tSELECT \n\tPIF_43JJ_STAGE_ID, \n\tPIF_SYMBOL, \n\tPIF_POLICY_NUMBER, \n\tPIF_MODULE, \n\tPMD4J_REC_LENGTH, \n\tPMD4J_ACTION_CODE, \n\tPMD4J_FILE_ID, \n\tPMD4J_SEGMENT_ID, \n\tPMD4J_SEGMENT_STATUS, \n\tPMD4J_YEAR_TRANSACTION, \n\tPMD4J_MONTH_TRANSACTION, \n\tPMD4J_DAY_TRANSACTION, \n\tPMD4J_SEGMENT_LEVEL_CODE, \n\tPMD4J_SEGMENT_PART_CODE, \n\tPMD4J_SUB_PART_CODE, \n\tPMD4J_INSURANCE_LINE, \n\tPMD4J_LOCATION_NUMBER, \n\tPMD4J_SUB_LOCATION_NUMBER, \n\tPMD4J_RISK_UNIT_GROUP, \n\tPMD4J_SEQ_RSK_UNT_GRP, \n\tPMD4J_RISK_UNIT, \n\tPMD4J_RISK_SEQUENCE, \n\tPMD4J_RISK_TYPE_IND, \n\tPMD4J_YEAR_ITEM_EFFECTIVE, \n\tPMD4J_MONTH_ITEM_EFFECTIVE, \n\tPMD4J_DAY_ITEM_EFFECTIVE, \n\tPMD4J_USE_CODE, \n\tPMD4J_SEQUENCE_USE_CODE, \n\tPMD4J_YEAR_PROCESS, \n\tPMD4J_MONTH_PROCESS, \n\tPMD4J_DAY_PROCESS, \n\tPMD4J_USE_CODE_DATA, \n\tPMD4J_SORT_NAME, \n\tPMD4J_TAX_LOC, \n\tPMD4J_NAME_TYPE_IND, \n\tPMD4J_ADDRESS_LINE_1, \n\tPMD4J_ADDR_LIN_2_POS_1, \n\tPMD4J_ADDR_LIN_2_POS_2_30, \n\tPMD4J_ADDRESS_LINE_3, \n\tPMD4J_ADDRESS_LINE_4, \n\tPMD4J_ID_NUMBER_9, \n\tPMD4J_POSTAL_CODE_1, \n\tPMD4J_PHONE_AREA, \n\tPMD4J_PHONE_EXCHANGE, \n\tPMD4J_PHONE_NUMBER, \n\tPMD4J_PHONE_EXTENSION, \n\tPMD4J_INTEREST_ITEM, \n\tPMD4J_LOC_LINE_EXCLUSION, \n\tPMD4J_SURCHARGE, \n\tPMD4J_MUNICIPAL_TAX, \n\tPMD4J_02_AUDIT_CODE, \n\tPMD4J_02_LEGAL_ENTITY, \n\tPMD4J_DEC_CHANGE_FLAG, \n\tPMD4J_BLKT_MISC_LOC_EXCLUSION, \n\tPMD4J_LOCATION_STATE, \n\tPMD4J_MATCHING_LOC_SW, \n\tPMD4J_ITEM_EXPIRE_YEAR_CC, \n\tPMD4J_ITEM_EXPIRE_YEAR_YY, \n\tPMD4J_ITEM_EXPIRE_MONTH, \n\tPMD4J_ITEM_EXPIRE_DAY, \n\tPMD4J_CLASS, \n\tPMD4J_NAME_EXT_IND, \n\tPMD4J_AIEX_ALPHA, \n\tPMD4J_ADDRESS_STAND_SW, \n\tPMD4J_CITY_TAX_CITY_X, \n\tPMD4J_CITY_CF_TAX, \n\tPMD4J_CITY_GL_TAX, \n\tPMD4J_CITY_CA_TAX, \n\tPMD4J_CITY_IM_TAX, \n\tPMD4J_CITY_AO_TAX, \n\tPMD4J_CITY_TC1_TAX, \n\tPMD4J_CITY_TC2_TAX, \n\tPMD4J_CITY_TC3_TAX, \n\tPMD4J_PMS_FUTURE_USE, \n\tPMD4J_WBM_ACTION_IND, \n\tPMD4J_WBM_FORM, \n\tPMD4J_WBM_CDAYS, \n\tPMD4J_WBM_CPRNT, \n\tPMD4J_DIST_AREAX, \n\tPMD4J_RISK_CITYX, \n\tPMD4J_SURVEY_STATUS, \n\tPMD4J_SURVEY_DATE, \n\tPMD4J_PC_INDICATOR, \n\tPMD4J_WS_INDICATOR, \n\tPMD4J_DIST_AREA_UNCOMP, \n\tPMD4J_RISK_CITY_UNCOMP, \n\tPMD4J_CNTY_TAX_CNTY_X, \n\tPMD4J_CNTY_CF_TAX, \n\tPMD4J_CNTY_GL_TAX, \n\tPMD4J_CNTY_CA_TAX, \n\tPMD4J_CNTY_IM_TAX, \n\tPMD4J_CNTY_AO_TAX, \n\tPMD4J_CNTY_TC1_TAX, \n\tPMD4J_CNTY_TC2_TAX, \n\tPMD4J_CNTY_TC3_TAX, \n\tPMD4J_CITY_TAX_CITY_OVRRIDE, \n\tPMD4J_CITY_CF_OVRRIDE, \n\tPMD4J_CITY_GL_OVRRIDE, \n\tPMD4J_CITY_IM_OVRRIDE, \n\tPMD4J_CITY_CA_OVRRIDE, \n\tPMD4J_CITY_AO_OVRRIDE, \n\tPMD4J_CITY_TC1_OVRRIDE, \n\tPMD4J_CITY_TC2_OVRRIDE, \n\tPMD4J_CITY_TC3_OVRRIDE, \n\tPMD4J_CNTY_TAX_CNTY_OVRRIDE, \n\tPMD4J_CNTY_CF_OVRRIDE, \n\tPMD4J_CNTY_GL_OVRRIDE, \n\tPMD4J_CNTY_IM_OVRRIDE, \n\tPMD4J_CNTY_CA_OVRRIDE, \n\tPMD4J_CNTY_AO_OVRRIDE, \n\tPMD4J_CNTY_TC1_OVRRIDE, \n\tPMD4J_CNTY_TC2_OVRRIDE, \n\tPMD4J_CNTY_TC3_OVRRIDE, \n\tPMD4J_MUNICIPAL_TAX_OVRRIDE, \n\tPMD4J_ADDR_STAND_OVRRIDE, \n\tPMD4J_YR2000_CUST_USE, \n\tLOGICAL_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, \n\tINF_ACTION, \n\tINF_TIMESTAMP, \n\to_AUDIT_ID AS AUDIT_ID\n\tFROM Exp_arch_pif_43jj\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}