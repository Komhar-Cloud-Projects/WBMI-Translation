WITH
SQ_PIF_42GQ_MS3_stage AS (
	SELECT
		pif_42gq_ms3_stage_id AS PIF_42GQ_MS3_stage_id,
		pif_symbol AS PIF_SYMBOL,
		pif_policy_number AS PIF_POLICY_NUMBER,
		pif_module AS PIF_MODULE,
		ipfcgq_rec_length AS IPFCGQ_REC_LENGTH,
		ipfcgq_action_code AS IPFCGQ_ACTION_CODE,
		ipfcgq_file_id AS IPFCGQ_FILE_ID,
		ipfcgq_segment_id AS IPFCGQ_SEGMENT_ID,
		ipfcgq_segment_level_code AS IPFCGQ_SEGMENT_LEVEL_CODE,
		ipfcgq_segment_part_code AS IPFCGQ_SEGMENT_PART_CODE,
		ipfcgq_sub_part_code AS IPFCGQ_SUB_PART_CODE,
		ipfcgq_year_of_loss AS IPFCGQ_YEAR_OF_LOSS,
		ipfcgq_month_of_loss AS IPFCGQ_MONTH_OF_LOSS,
		ipfcgq_day_of_loss AS IPFCGQ_DAY_OF_LOSS,
		ipfcgq_loss_occurence AS IPFCGQ_LOSS_OCCURENCE,
		ipfcgq_loss_claimant AS IPFCGQ_LOSS_CLAIMANT,
		ipfcgq_claimant_use_code AS IPFCGQ_CLAIMANT_USE_CODE,
		ipfcgq_claimant_use_seq AS IPFCGQ_CLAIMANT_USE_SEQ,
		ipfcgq_year_process AS IPFCGQ_YEAR_PROCESS,
		ipfcgq_month_process AS IPFCGQ_MONTH_PROCESS,
		ipfcgq_day_process AS IPFCGQ_DAY_PROCESS,
		ipfcgq_year_change_entry AS IPFCGQ_YEAR_CHANGE_ENTRY,
		ipfcgq_month_change_entry AS IPFCGQ_MONTH_CHANGE_ENTRY,
		ipfcgq_day_change_entry AS IPFCGQ_DAY_CHANGE_ENTRY,
		ipfcgq_sequence_change_entry AS IPFCGQ_SEQUENCE_CHANGE_ENTRY,
		ipfcgq_segment_status AS IPFCGQ_SEGMENT_STATUS,
		ipfcgq_entry_operator AS IPFCGQ_ENTRY_OPERATOR,
		ipfcgq_desc_of_injury AS IPFCGQ_DESC_OF_INJURY,
		ipfcgq_potential_recovery AS IPFCGQ_POTENTIAL_RECOVERY,
		ipfcgq_employer_tax_id AS IPFCGQ_EMPLOYER_TAX_ID,
		ipfcgq_employer_sic_code AS IPFCGQ_EMPLOYER_SIC_CODE,
		ipfcgq_employer_payroll AS IPFCGQ_EMPLOYER_PAYROLL,
		ipfcgq_injury_site_zip AS IPFCGQ_INJURY_SITE_ZIP,
		ipfcgq_clmnt_last_name AS IPFCGQ_CLMNT_LAST_NAME,
		ipfcgq_clmnt_first_init AS IPFCGQ_CLMNT_FIRST_INIT,
		ipfcgq_number_dependents AS IPFCGQ_NUMBER_DEPENDENTS,
		ipfcgq_other_wkly_pay AS IPFCGQ_OTHER_WKLY_PAY,
		ipfcgq_date_rptd_employer AS IPFCGQ_DATE_RPTD_EMPLOYER,
		ipfcgq_surgery AS IPFCGQ_SURGERY,
		ipfcgq_date_first_pay AS IPFCGQ_DATE_FIRST_PAY,
		ipfcgq_attorney_auth_rep AS IPFCGQ_ATTORNEY_AUTH_REP,
		ipfcgq_controverted_case AS IPFCGQ_CONTROVERTED_CASE,
		ipfcgq_deductible AS IPFCGQ_DEDUCTIBLE,
		ipfcgq_social_security AS IPFCGQ_SOCIAL_SECURITY,
		ipfcgq_unemployment AS IPFCGQ_UNEMPLOYMENT,
		ipfcgq_pension_plan AS IPFCGQ_PENSION_PLAN,
		ipfcgq_special_fund AS IPFCGQ_SPECIAL_FUND,
		ipfcgq_other AS IPFCGQ_OTHER,
		ipfcgq_date_hired AS IPFCGQ_DATE_HIRED,
		ipfcgq_date_max_med_imprv AS IPFCGQ_DATE_MAX_MED_IMPRV,
		ipfcgq_date_of_disability AS IPFCGQ_DATE_OF_DISABILITY,
		ipfcgq_occupational_code AS IPFCGQ_OCCUPATIONAL_CODE,
		ipfcgq_date_of_disclosure AS IPFCGQ_DATE_OF_DISCLOSURE,
		ipfcgq_jurisdiction_state AS IPFCGQ_JURISDICTION_STATE,
		ipfcgq_ms3_claim_status AS IPFCGQ_MS3_CLAIM_STATUS,
		ipfcgq_report_nbr AS IPFCGQ_REPORT_NBR,
		ipfcgq_due_date AS IPFCGQ_DUE_DATE,
		ipfcgq_correction AS IPFCGQ_CORRECTION,
		ipfcgq_error_codes AS IPFCGQ_ERROR_CODES,
		ipfcgq_number_of_part78 AS IPFCGQ_NUMBER_OF_PART78,
		ipfcgq_offset_onset_ind AS IPFCGQ_OFFSET_ONSET_IND,
		ipfcgq_date_hire AS IPFCGQ_DATE_HIRE,
		ipfcgq_pms_future_use_gq AS IPFCGQ_PMS_FUTURE_USE_GQ,
		ipfcgq_direct_reporting AS IPFCGQ_DIRECT_REPORTING,
		ipfcgq_cust_spl_use_gq AS IPFCGQ_CUST_SPL_USE_GQ,
		ipfcgq_yr2000_cust_use AS IPFCGQ_YR2000_CUST_USE,
		inf_action,
		inf_timestamp,
		logical_flag,
		extract_date AS EXTRACT_DATE,
		as_of_date AS AS_OF_DATE,
		record_count AS RECORD_COUNT,
		source_system_id AS SOURCE_SYSTEM_ID
	FROM PIF_42GQ_MS3_stage
),
EXP_arch_PIF_42GQ_MS3_stage AS (
	SELECT
	PIF_42GQ_MS3_stage_id,
	PIF_SYMBOL,
	PIF_POLICY_NUMBER,
	PIF_MODULE,
	IPFCGQ_REC_LENGTH,
	IPFCGQ_ACTION_CODE,
	IPFCGQ_FILE_ID,
	IPFCGQ_SEGMENT_ID,
	IPFCGQ_SEGMENT_LEVEL_CODE,
	IPFCGQ_SEGMENT_PART_CODE,
	IPFCGQ_SUB_PART_CODE,
	IPFCGQ_YEAR_OF_LOSS,
	IPFCGQ_MONTH_OF_LOSS,
	IPFCGQ_DAY_OF_LOSS,
	IPFCGQ_LOSS_OCCURENCE,
	IPFCGQ_LOSS_CLAIMANT,
	IPFCGQ_CLAIMANT_USE_CODE,
	IPFCGQ_CLAIMANT_USE_SEQ,
	IPFCGQ_YEAR_PROCESS,
	IPFCGQ_MONTH_PROCESS,
	IPFCGQ_DAY_PROCESS,
	IPFCGQ_YEAR_CHANGE_ENTRY,
	IPFCGQ_MONTH_CHANGE_ENTRY,
	IPFCGQ_DAY_CHANGE_ENTRY,
	IPFCGQ_SEQUENCE_CHANGE_ENTRY,
	IPFCGQ_SEGMENT_STATUS,
	IPFCGQ_ENTRY_OPERATOR,
	IPFCGQ_DESC_OF_INJURY,
	IPFCGQ_POTENTIAL_RECOVERY,
	IPFCGQ_EMPLOYER_TAX_ID,
	IPFCGQ_EMPLOYER_SIC_CODE,
	IPFCGQ_EMPLOYER_PAYROLL,
	IPFCGQ_INJURY_SITE_ZIP,
	IPFCGQ_CLMNT_LAST_NAME,
	IPFCGQ_CLMNT_FIRST_INIT,
	IPFCGQ_NUMBER_DEPENDENTS,
	IPFCGQ_OTHER_WKLY_PAY,
	IPFCGQ_DATE_RPTD_EMPLOYER,
	IPFCGQ_SURGERY,
	IPFCGQ_DATE_FIRST_PAY,
	IPFCGQ_ATTORNEY_AUTH_REP,
	IPFCGQ_CONTROVERTED_CASE,
	IPFCGQ_DEDUCTIBLE,
	IPFCGQ_SOCIAL_SECURITY,
	IPFCGQ_UNEMPLOYMENT,
	IPFCGQ_PENSION_PLAN,
	IPFCGQ_SPECIAL_FUND,
	IPFCGQ_OTHER,
	IPFCGQ_DATE_HIRED,
	IPFCGQ_DATE_MAX_MED_IMPRV,
	IPFCGQ_DATE_OF_DISABILITY,
	IPFCGQ_OCCUPATIONAL_CODE,
	IPFCGQ_DATE_OF_DISCLOSURE,
	IPFCGQ_JURISDICTION_STATE,
	IPFCGQ_MS3_CLAIM_STATUS,
	IPFCGQ_REPORT_NBR,
	IPFCGQ_DUE_DATE,
	IPFCGQ_CORRECTION,
	IPFCGQ_ERROR_CODES,
	IPFCGQ_NUMBER_OF_PART78,
	IPFCGQ_OFFSET_ONSET_IND,
	IPFCGQ_DATE_HIRE,
	IPFCGQ_PMS_FUTURE_USE_GQ,
	IPFCGQ_DIRECT_REPORTING,
	IPFCGQ_CUST_SPL_USE_GQ,
	IPFCGQ_YR2000_CUST_USE,
	inf_action,
	inf_timestamp,
	logical_flag,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_PIF_42GQ_MS3_stage
),
arch_PIF_42GQ_MS3_stage AS (
	INSERT INTO arch_PIF_42GQ_MS3_stage
	(pif_42gq_ms3_stage_id, pif_symbol, pif_policy_number, pif_module, ipfcgq_rec_length, ipfcgq_action_code, ipfcgq_file_id, ipfcgq_segment_id, ipfcgq_segment_level_code, ipfcgq_segment_part_code, ipfcgq_sub_part_code, ipfcgq_year_of_loss, ipfcgq_month_of_loss, ipfcgq_day_of_loss, ipfcgq_loss_occurence, ipfcgq_loss_claimant, ipfcgq_claimant_use_code, ipfcgq_claimant_use_seq, ipfcgq_year_process, ipfcgq_month_process, ipfcgq_day_process, ipfcgq_year_change_entry, ipfcgq_month_change_entry, ipfcgq_day_change_entry, ipfcgq_sequence_change_entry, ipfcgq_segment_status, ipfcgq_entry_operator, ipfcgq_desc_of_injury, ipfcgq_potential_recovery, ipfcgq_employer_tax_id, ipfcgq_employer_sic_code, ipfcgq_employer_payroll, ipfcgq_injury_site_zip, ipfcgq_clmnt_last_name, ipfcgq_clmnt_first_init, ipfcgq_number_dependents, ipfcgq_other_wkly_pay, ipfcgq_date_rptd_employer, ipfcgq_surgery, ipfcgq_date_first_pay, ipfcgq_attorney_auth_rep, ipfcgq_controverted_case, ipfcgq_deductible, ipfcgq_social_security, ipfcgq_unemployment, ipfcgq_pension_plan, ipfcgq_special_fund, ipfcgq_other, ipfcgq_date_hired, ipfcgq_date_max_med_imprv, ipfcgq_date_of_disability, ipfcgq_occupational_code, ipfcgq_date_of_disclosure, ipfcgq_jurisdiction_state, ipfcgq_ms3_claim_status, ipfcgq_report_nbr, ipfcgq_due_date, ipfcgq_correction, ipfcgq_error_codes, ipfcgq_number_of_part78, ipfcgq_offset_onset_ind, ipfcgq_date_hire, ipfcgq_pms_future_use_gq, ipfcgq_direct_reporting, ipfcgq_cust_spl_use_gq, ipfcgq_yr2000_cust_use, inf_action, inf_timestamp, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	PIF_42GQ_MS3_stage_id AS PIF_42GQ_MS3_STAGE_ID, 
	PIF_SYMBOL AS PIF_SYMBOL, 
	PIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, 
	PIF_MODULE AS PIF_MODULE, 
	IPFCGQ_REC_LENGTH AS IPFCGQ_REC_LENGTH, 
	IPFCGQ_ACTION_CODE AS IPFCGQ_ACTION_CODE, 
	IPFCGQ_FILE_ID AS IPFCGQ_FILE_ID, 
	IPFCGQ_SEGMENT_ID AS IPFCGQ_SEGMENT_ID, 
	IPFCGQ_SEGMENT_LEVEL_CODE AS IPFCGQ_SEGMENT_LEVEL_CODE, 
	IPFCGQ_SEGMENT_PART_CODE AS IPFCGQ_SEGMENT_PART_CODE, 
	IPFCGQ_SUB_PART_CODE AS IPFCGQ_SUB_PART_CODE, 
	IPFCGQ_YEAR_OF_LOSS AS IPFCGQ_YEAR_OF_LOSS, 
	IPFCGQ_MONTH_OF_LOSS AS IPFCGQ_MONTH_OF_LOSS, 
	IPFCGQ_DAY_OF_LOSS AS IPFCGQ_DAY_OF_LOSS, 
	IPFCGQ_LOSS_OCCURENCE AS IPFCGQ_LOSS_OCCURENCE, 
	IPFCGQ_LOSS_CLAIMANT AS IPFCGQ_LOSS_CLAIMANT, 
	IPFCGQ_CLAIMANT_USE_CODE AS IPFCGQ_CLAIMANT_USE_CODE, 
	IPFCGQ_CLAIMANT_USE_SEQ AS IPFCGQ_CLAIMANT_USE_SEQ, 
	IPFCGQ_YEAR_PROCESS AS IPFCGQ_YEAR_PROCESS, 
	IPFCGQ_MONTH_PROCESS AS IPFCGQ_MONTH_PROCESS, 
	IPFCGQ_DAY_PROCESS AS IPFCGQ_DAY_PROCESS, 
	IPFCGQ_YEAR_CHANGE_ENTRY AS IPFCGQ_YEAR_CHANGE_ENTRY, 
	IPFCGQ_MONTH_CHANGE_ENTRY AS IPFCGQ_MONTH_CHANGE_ENTRY, 
	IPFCGQ_DAY_CHANGE_ENTRY AS IPFCGQ_DAY_CHANGE_ENTRY, 
	IPFCGQ_SEQUENCE_CHANGE_ENTRY AS IPFCGQ_SEQUENCE_CHANGE_ENTRY, 
	IPFCGQ_SEGMENT_STATUS AS IPFCGQ_SEGMENT_STATUS, 
	IPFCGQ_ENTRY_OPERATOR AS IPFCGQ_ENTRY_OPERATOR, 
	IPFCGQ_DESC_OF_INJURY AS IPFCGQ_DESC_OF_INJURY, 
	IPFCGQ_POTENTIAL_RECOVERY AS IPFCGQ_POTENTIAL_RECOVERY, 
	IPFCGQ_EMPLOYER_TAX_ID AS IPFCGQ_EMPLOYER_TAX_ID, 
	IPFCGQ_EMPLOYER_SIC_CODE AS IPFCGQ_EMPLOYER_SIC_CODE, 
	IPFCGQ_EMPLOYER_PAYROLL AS IPFCGQ_EMPLOYER_PAYROLL, 
	IPFCGQ_INJURY_SITE_ZIP AS IPFCGQ_INJURY_SITE_ZIP, 
	IPFCGQ_CLMNT_LAST_NAME AS IPFCGQ_CLMNT_LAST_NAME, 
	IPFCGQ_CLMNT_FIRST_INIT AS IPFCGQ_CLMNT_FIRST_INIT, 
	IPFCGQ_NUMBER_DEPENDENTS AS IPFCGQ_NUMBER_DEPENDENTS, 
	IPFCGQ_OTHER_WKLY_PAY AS IPFCGQ_OTHER_WKLY_PAY, 
	IPFCGQ_DATE_RPTD_EMPLOYER AS IPFCGQ_DATE_RPTD_EMPLOYER, 
	IPFCGQ_SURGERY AS IPFCGQ_SURGERY, 
	IPFCGQ_DATE_FIRST_PAY AS IPFCGQ_DATE_FIRST_PAY, 
	IPFCGQ_ATTORNEY_AUTH_REP AS IPFCGQ_ATTORNEY_AUTH_REP, 
	IPFCGQ_CONTROVERTED_CASE AS IPFCGQ_CONTROVERTED_CASE, 
	IPFCGQ_DEDUCTIBLE AS IPFCGQ_DEDUCTIBLE, 
	IPFCGQ_SOCIAL_SECURITY AS IPFCGQ_SOCIAL_SECURITY, 
	IPFCGQ_UNEMPLOYMENT AS IPFCGQ_UNEMPLOYMENT, 
	IPFCGQ_PENSION_PLAN AS IPFCGQ_PENSION_PLAN, 
	IPFCGQ_SPECIAL_FUND AS IPFCGQ_SPECIAL_FUND, 
	IPFCGQ_OTHER AS IPFCGQ_OTHER, 
	IPFCGQ_DATE_HIRED AS IPFCGQ_DATE_HIRED, 
	IPFCGQ_DATE_MAX_MED_IMPRV AS IPFCGQ_DATE_MAX_MED_IMPRV, 
	IPFCGQ_DATE_OF_DISABILITY AS IPFCGQ_DATE_OF_DISABILITY, 
	IPFCGQ_OCCUPATIONAL_CODE AS IPFCGQ_OCCUPATIONAL_CODE, 
	IPFCGQ_DATE_OF_DISCLOSURE AS IPFCGQ_DATE_OF_DISCLOSURE, 
	IPFCGQ_JURISDICTION_STATE AS IPFCGQ_JURISDICTION_STATE, 
	IPFCGQ_MS3_CLAIM_STATUS AS IPFCGQ_MS3_CLAIM_STATUS, 
	IPFCGQ_REPORT_NBR AS IPFCGQ_REPORT_NBR, 
	IPFCGQ_DUE_DATE AS IPFCGQ_DUE_DATE, 
	IPFCGQ_CORRECTION AS IPFCGQ_CORRECTION, 
	IPFCGQ_ERROR_CODES AS IPFCGQ_ERROR_CODES, 
	IPFCGQ_NUMBER_OF_PART78 AS IPFCGQ_NUMBER_OF_PART78, 
	IPFCGQ_OFFSET_ONSET_IND AS IPFCGQ_OFFSET_ONSET_IND, 
	IPFCGQ_DATE_HIRE AS IPFCGQ_DATE_HIRE, 
	IPFCGQ_PMS_FUTURE_USE_GQ AS IPFCGQ_PMS_FUTURE_USE_GQ, 
	IPFCGQ_DIRECT_REPORTING AS IPFCGQ_DIRECT_REPORTING, 
	IPFCGQ_CUST_SPL_USE_GQ AS IPFCGQ_CUST_SPL_USE_GQ, 
	IPFCGQ_YR2000_CUST_USE AS IPFCGQ_YR2000_CUST_USE, 
	INF_ACTION, 
	INF_TIMESTAMP, 
	LOGICAL_FLAG, 
	EXTRACT_DATE AS EXTRACT_DATE, 
	AS_OF_DATE AS AS_OF_DATE, 
	RECORD_COUNT AS RECORD_COUNT, 
	SOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_arch_PIF_42GQ_MS3_stage
),