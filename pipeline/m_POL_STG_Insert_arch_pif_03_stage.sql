WITH
SQ_pif_03_stage AS (
	SELECT
		pif_03_stage_id,
		pif_symbol,
		pif_policy_number,
		pif_module,
		comments_rec_length,
		comments_action_code,
		comments_file_id,
		comments_id,
		comments_segment_part_code,
		comments_reason_suspended,
		comments_type_request,
		comments_dest_branch,
		comments_dest,
		comments_requested_by,
		comments_suspense_date,
		comments_seq,
		comments_loss_date,
		comments_loss_occurance,
		comments_loss_claimant,
		comments_frequency,
		comments_area,
		comments_area_2,
		comments_pms_future_use,
		comments_payment_ind,
		comments_cust_future_use,
		comments_yr2000_cust_use,
		comments_wbc_key,
		comments_dup_key_seq_num,
		extract_date,
		as_of_date,
		record_count,
		source_system_id,
		inf_action,
		inf_timestamp
	FROM pif_03_stage
),
EXP_arch_pif_03 AS (
	SELECT
	pif_03_stage_id,
	pif_symbol,
	pif_policy_number,
	pif_module,
	comments_rec_length,
	comments_action_code,
	comments_file_id,
	comments_id,
	comments_segment_part_code,
	comments_reason_suspended,
	comments_type_request,
	comments_dest_branch,
	comments_dest,
	comments_requested_by,
	comments_suspense_date,
	comments_seq,
	comments_loss_date,
	comments_loss_occurance,
	comments_loss_claimant,
	comments_frequency,
	comments_area,
	comments_area_2,
	comments_pms_future_use,
	comments_payment_ind,
	comments_cust_future_use,
	comments_yr2000_cust_use,
	comments_wbc_key,
	comments_dup_key_seq_num,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	inf_action,
	inf_timestamp,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_pif_03_stage
),
arch_pif_03_stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_pif_03_stage
	(pif_03_stage_id, pif_symbol, pif_policy_number, pif_module, comments_rec_length, comments_action_code, comments_file_id, comments_id, comments_segment_part_code, comments_reason_suspended, comments_type_request, comments_dest_branch, comments_dest, comments_requested_by, comments_suspense_date, comments_seq, comments_loss_date, comments_loss_occurance, comments_loss_claimant, comments_frequency, comments_area, comments_area_2, comments_pms_future_use, comments_payment_ind, comments_cust_future_use, comments_yr2000_cust_use, comments_wbc_key, comments_dup_key_seq_num, extract_date, as_of_date, record_count, source_system_id, audit_id, inf_action, inf_timestamp)
	SELECT 
	PIF_03_STAGE_ID, 
	PIF_SYMBOL, 
	PIF_POLICY_NUMBER, 
	PIF_MODULE, 
	COMMENTS_REC_LENGTH, 
	COMMENTS_ACTION_CODE, 
	COMMENTS_FILE_ID, 
	COMMENTS_ID, 
	COMMENTS_SEGMENT_PART_CODE, 
	COMMENTS_REASON_SUSPENDED, 
	COMMENTS_TYPE_REQUEST, 
	COMMENTS_DEST_BRANCH, 
	COMMENTS_DEST, 
	COMMENTS_REQUESTED_BY, 
	COMMENTS_SUSPENSE_DATE, 
	COMMENTS_SEQ, 
	COMMENTS_LOSS_DATE, 
	COMMENTS_LOSS_OCCURANCE, 
	COMMENTS_LOSS_CLAIMANT, 
	COMMENTS_FREQUENCY, 
	COMMENTS_AREA, 
	COMMENTS_AREA_2, 
	COMMENTS_PMS_FUTURE_USE, 
	COMMENTS_PAYMENT_IND, 
	COMMENTS_CUST_FUTURE_USE, 
	COMMENTS_YR2000_CUST_USE, 
	COMMENTS_WBC_KEY, 
	COMMENTS_DUP_KEY_SEQ_NUM, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	o_audit_id AS AUDIT_ID, 
	INF_ACTION, 
	INF_TIMESTAMP
	FROM EXP_arch_pif_03
),