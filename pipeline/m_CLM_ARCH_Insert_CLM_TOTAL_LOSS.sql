WITH
SQ_clm_total_loss_stage AS (
	SELECT
		clm_total_loss_stage_id,
		tch_claim_nbr,
		tch_client_id,
		object_type_cd,
		object_seq_nbr,
		cov_type_cd,
		cov_seq_nbr,
		bur_cause_loss,
		seq_nbr,
		add_status,
		add_status_ts,
		add_upload_ts,
		add_uuid,
		vehicle_vin,
		vehicle_year,
		vehicle_make,
		vehicle_model,
		loss_date,
		loss_owner,
		new_owner,
		owner_retained,
		payment_retained,
		loss_acv,
		sales_tax,
		title_fees,
		registration,
		deductible,
		salvage_amount,
		create_ts,
		create_user_id,
		update_ts,
		update_user_id,
		extract_date,
		as_of_date,
		record_count,
		source_system_id
	FROM clm_total_loss_stage
),
EXP_get_values AS (
	SELECT
	clm_total_loss_stage_id,
	tch_claim_nbr,
	tch_client_id,
	object_type_cd,
	object_seq_nbr,
	cov_type_cd,
	cov_seq_nbr,
	bur_cause_loss,
	seq_nbr,
	add_status,
	add_status_ts,
	add_upload_ts,
	add_uuid,
	vehicle_vin,
	vehicle_year,
	vehicle_make,
	vehicle_model,
	loss_date,
	loss_owner,
	new_owner,
	owner_retained,
	payment_retained,
	loss_acv,
	sales_tax,
	title_fees,
	registration,
	deductible,
	salvage_amount,
	create_ts,
	create_user_id,
	update_ts,
	update_user_id,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id
	FROM SQ_clm_total_loss_stage
),
arch_clm_total_loss_stage AS (
	INSERT INTO arch_clm_total_loss_stage
	(clm_total_loss_stage_id, tch_claim_nbr, tch_client_id, object_type_cd, object_seq_nbr, cov_type_cd, cov_seq_nbr, bur_cause_loss, seq_nbr, add_status, add_status_ts, add_upload_ts, add_uuid, vehicle_vin, vehicle_year, vehicle_make, vehicle_model, loss_date, loss_owner, new_owner, owner_retained, payment_retained, loss_acv, sales_tax, title_fees, registration, deductible, salvage_amount, create_ts, create_user_id, update_ts, update_user_id, extract_date, as_of_date, record_count, source_system_id, audit_id)
	SELECT 
	CLM_TOTAL_LOSS_STAGE_ID, 
	TCH_CLAIM_NBR, 
	TCH_CLIENT_ID, 
	OBJECT_TYPE_CD, 
	OBJECT_SEQ_NBR, 
	COV_TYPE_CD, 
	COV_SEQ_NBR, 
	BUR_CAUSE_LOSS, 
	SEQ_NBR, 
	ADD_STATUS, 
	ADD_STATUS_TS, 
	ADD_UPLOAD_TS, 
	ADD_UUID, 
	VEHICLE_VIN, 
	VEHICLE_YEAR, 
	VEHICLE_MAKE, 
	VEHICLE_MODEL, 
	LOSS_DATE, 
	LOSS_OWNER, 
	NEW_OWNER, 
	OWNER_RETAINED, 
	PAYMENT_RETAINED, 
	LOSS_ACV, 
	SALES_TAX, 
	TITLE_FEES, 
	REGISTRATION, 
	DEDUCTIBLE, 
	SALVAGE_AMOUNT, 
	CREATE_TS, 
	CREATE_USER_ID, 
	UPDATE_TS, 
	UPDATE_USER_ID, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID
	FROM EXP_get_values
),