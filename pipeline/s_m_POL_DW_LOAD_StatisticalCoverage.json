{
    "name": "s_m_POL_DW_LOAD_StatisticalCoverage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_DW_LOAD_StatisticalCoverage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Policy_PolicyAKID AS (\n\tSELECT\n\tpol_ak_id,\n\tpol_key\n\tFROM (\n\t\tSELECT policy.pol_ak_id as pol_ak_id, ltrim(rtrim(policy.pol_key)) as pol_key FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER_V2}.policy\r\n\t\tWHERE crrnt_snpsht_flag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key ORDER BY pol_ak_id DESC) = 1\n),\nLKP_RiskLocation_RiskLocationAKID AS (\n\tSELECT\n\tRiskLocationAKID,\n\tRiskLocationID,\n\tCurrentSnapshotFlag,\n\tPolicyAKID,\n\tLocationUnitNumber,\n\tRiskTerritory,\n\tStateProvinceCode,\n\tZipPostalCode,\n\tTaxLocation\n\tFROM (\n\t\tSELECT RiskLocationAKID   AS RiskLocationAKID,\r\n\t\t       PolicyAKID         AS PolicyAKID,\r\n\t\tLOC.RiskLocationID as RiskLocationID,\r\n\t\tLOC.CurrentSnapshotFlag AS CurrentSnapshotFlag,\r\n\t\t       LTRIM(RTRIM(LocationUnitNumber)) AS LocationUnitNumber,\r\n\t\t       LTRIM(RTRIM(RiskTerritory))      AS RiskTerritory,\r\n\t\t       LTRIM(RTRIM(StateProvinceCode))  AS StateProvinceCode,\r\n\t\t       LTRIM(RTRIM(ZipPostalCode))      AS ZipPostalCode,\r\n\t\t       LTRIM(RTRIM(TaxLocation))        AS TaxLocation\r\n\t\tFROM\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.RiskLocation LOC\r\n\t\tINNER JOIN  @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER_V2}.Policy POL\r\n\t\tON\tLOC.PolicyAKID = POL.pol_ak_id\r\n\t\tWHERE POL.crrnt_snpsht_flag = 1 AND LOC.CurrentSnapshotFlag =1\r\n\t\t       AND POL.SOURCE_SYS_ID = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\r\n\t\t       AND  EXISTS  (SELECT DISTINCT PolicyKey FROM  \r\n\t\t\t\t\t\t\t\t\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkPolicyKeyList\r\n\t\t\t\t\t\t\t\t\tWHERE POL.pol_key = PolicyKey AND @{pipeline().parameters.WHERE_CLAUSE_EDW})\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyAKID,LocationUnitNumber,RiskTerritory,StateProvinceCode,ZipPostalCode,TaxLocation ORDER BY RiskLocationAKID DESC) = 1\n),\nLKP_PolicyCoverage_PolicyCoverageAKID AS (\n\tSELECT\n\tPolicyCoverageAKID,\n\tPolicyCoverageHashKey\n\tFROM (\n\t\tSELECT PolicyCoverageAKID    AS PolicyCoverageAKID,\r\n\t\t       \t      PolicyCoverageHashKey AS PolicyCoverageHashKey\r\n\t\tFROM\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.RiskLocation LOC \r\n\t\tINNER JOIN @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER_V2}.Policy POL\r\n\t\t         ON LOC.PolicyAKID = POL.pol_ak_id \r\n\t\tINNER JOIN @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PolicyCoverage POLCOV\r\n\t\tON LOC.RiskLocationAKID = POLCOV.RiskLocationAKID\r\n\t\tWHERE  POL.crrnt_snpsht_flag = 1\r\n\t\t       AND LOC.CurrentSnapshotFlag = 1\r\n\t\t       AND POLCOV.CurrentSnapshotFlag = 1 \r\n\t\t       AND POL.SOURCE_SYS_ID = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\r\n\t\t       AND  EXISTS  (SELECT DISTINCT PolicyKey FROM  \r\n\t\t\t\t\t\t\t\t\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkPolicyKeyList\r\n\t\t\t\t\t\t\t\t\tWHERE POL.pol_key = PolicyKey AND @{pipeline().parameters.WHERE_CLAUSE_EDW})\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyCoverageHashKey ORDER BY PolicyCoverageAKID DESC) = 1\n),\nLKP_PolicyCoverage_InsuranceLine AS (\n\tSELECT\n\tInsuranceLine,\n\tPolicyCoverageAKID\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceLine,\n\t\t\tPolicyCoverageAKID\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PolicyCoverage\n\t\tWHERE CurrentSnapshotFlag=1 AND SourceSystemID = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyCoverageAKID ORDER BY InsuranceLine) = 1\n),\nLKP_SupInsuranceReferenceLineOfBusinessRules AS (\n\tSELECT\n\tInsuranceReferenceLineOfBusinessCode,\n\tSequenceNumber,\n\tIdentifiers\n\tFROM (\n\t\tSELECT InsuranceReferenceLineOfBusinessCode as InsuranceReferenceLineOfBusinessCode, \r\n\t\tSequenceNumber as SequenceNumber,\r\n\t\t(case\twhen SequenceNumber=1 then PolicySymbol\r\n\t\t\t\twhen SequenceNumber=2 then PolicySymbol +'&'+ ClassOfBusiness\r\n\t\t\t\twhen SequenceNumber=28 then PolicySymbol +'&'+ InsuranceLine+'&'+ TypeBureauCode+'&'+ RiskUnitGroup\r\n\t\t\t\twhen SequenceNumber=3 then PolicySymbol +'&'+ InsuranceLine+'&'+ TypeBureauCode\r\n\t\t\t\twhen SequenceNumber=4 then PolicySymbol +'&'+ InsuranceLine+'&'+ RiskUnitGroup\r\n\t\t\t\twhen SequenceNumber=5 then TypeBureauCode+'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=6 then TypeBureauCode\r\n\t\t\t\twhen SequenceNumber=7 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=8 then PolicySymbol +'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=9 then PolicySymbol +'&'+ TypeBureauCode\r\n\t\t\t\twhen SequenceNumber=10 then PolicySymbol +'&'+ TypeBureauCode+'&'+ RiskUnitGroup\r\n\t\t\t\twhen SequenceNumber=11 then PolicySymbol +'&'+ TypeBureauCode+'&'+ ClassCode\r\n\t\t\t\twhen SequenceNumber=12 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode+'&'+ RiskUnitGroup\r\n\t\t\t\twhen SequenceNumber=13 then PolicySymbol +'&'+ InsuranceLine\r\n\t\t\t\twhen SequenceNumber=14 then PolicySymbol +'&'+ TypeBureauCode\r\n\t\t\t\twhen SequenceNumber=15 then MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=16 then PolicySymbol +'&'+ LocationUnitNumber+'&'+ BureauCode2\r\n\t\t\t\twhen SequenceNumber=17 then PolicySymbol +'&'+ BureauSpecialUseCode\r\n\t\t\t\twhen SequenceNumber=18 then PolicySymbol +'&'+ TypeBureauCode\r\n\t\t\t\twhen SequenceNumber=19 then PolicySymbol +'&'+ TypeBureauCode+'&'+ ClassCode\r\n\t\t\t\twhen SequenceNumber=20 then PolicySymbol +'&'+ ClassCode\r\n\t\t\t\twhen SequenceNumber=21 then PolicySymbol +'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=22 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=23 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode\r\n\t\t\t\twhen SequenceNumber=24 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode + '&' + BureauCode2\r\n\t\t\t\twhen SequenceNumber=25 then TypeBureauCode+'&'+ MajorPerilCode + '&' + BureauCode2\r\n\t\t\t\twhen SequenceNumber=26 then PolicySymbol + '&'+ ClassCode\r\n\t\t\t\twhen SequenceNumber=27 then PolicySymbol +'&'+ TypeBureauCode+'&'+ MajorPerilCode\r\n\t\tend\r\n\t\t) as Identifiers\r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupInsuranceReferenceLineOfBusinessRules\r\n\t\twhere CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SequenceNumber,Identifiers ORDER BY InsuranceReferenceLineOfBusinessCode) = 1\n),\nSQ_pif_4514_stage AS (\n\tSELECT DISTINCT RTRIM(A.pif_symbol) as pif_symbol,\r\n\t       \t   A.pif_policy_number,\r\n\t                A.pif_module, \r\n\t                LTRIM(RTRIM(sar_insurance_line)) as sar_insurance_line,\r\n\t                CASE LEN(sar_location_x) WHEN '0' THEN LTRIM(RTRIM(sar_unit)) ELSE LTRIM(RTRIM(sar_location_x)) END as sar_location_x,\r\n\t                LTRIM(RTRIM(sar_sub_location_x)) as sar_sub_location_x,\r\n\t                LTRIM(RTRIM(sar_risk_unit_group)) as sar_risk_unit_group,\r\n\t                LTRIM(RTRIM(sar_class_code_grp_x + sar_class_code_mem_x)) as sar_class_code_grp_x,\r\n\t                LTRIM(RTRIM(sar_unit + sar_risk_unit_continued))      AS sar_unit,\r\n\t                CASE LEN(LTRIM(RTRIM(COALESCE(SAR_SEQ_RSK_UNT_A, ''))))\r\n\t                  WHEN '0' THEN 'N/A'\r\n\t                          ELSE LTRIM(RTRIM(SAR_SEQ_RSK_UNT_A))\r\n\t                END                                         AS sar_seq_rsk_unt_a,\r\n\t                LTRIM(RTRIM(sar_type_exposure)) as sar_type_exposure,\r\n\t                LTRIM(RTRIM(sar_major_peril)) as sar_major_peril,\r\n\t                LTRIM(RTRIM(sar_seq_no)) as sar_seq_no,\r\n\t                sar_cov_eff_year,\r\n\t                sar_cov_eff_month,\r\n\t                sar_cov_eff_day,\r\n\t                LTRIM(RTRIM(sar_state)) as sar_state,\r\n\t                LTRIM(RTRIM(sar_loc_prov_territory)) as sar_loc_prov_territory,\r\n\t                CASE WHEN LEN(LTRIM(RTRIM(sar_county_first_two)) + LTRIM(RTRIM(sar_county_last_one)) + LTRIM(RTRIM(sar_city))) < 6 THEN '000000' ELSE \r\n\t       \t    LTRIM(RTRIM(sar_county_first_two)) + LTRIM(RTRIM(sar_county_last_one)) + LTRIM(RTRIM(sar_city)) END as sar_city,\r\n\t               LTRIM(RTRIM(sar_special_use)) as sar_special_use,\r\n\t                LTRIM(RTRIM(sar_section)) as sar_section,\r\n\t                LTRIM(RTRIM(sar_type_bureau)) as sar_type_bureau,\r\n\t                LTRIM(RTRIM(sar_class_1_4)) + LTRIM(RTRIM(sar_class_5_6))  AS sar_class_code,\r\n\t                LTRIM(RTRIM(sar_class_1_4)) as sar_class_1_4,\r\n\t                LTRIM(RTRIM(sar_sub_line)) as sar_sub_line,\r\n\t                LTRIM(RTRIM(sar_code_2)) as sar_code_2,\r\n\t                LTRIM(RTRIM(sar_zip_postal_code)) as sar_zip_postal_code,\r\n\t                LTRIM(RTRIM(pif_line_business)) as pif_line_business,\r\n\t                LTRIM(RTRIM(wb_class_of_business)) as wb_class_of_business,\r\n\t                D.PMDUYC1ClassOfInsured\r\n\tFROM  @{pipeline().parameters.SOURCE_TABLE_OWNER}.@{pipeline().parameters.SOURCE_TABLE_NAME_4514} A\r\n\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.pif_02_stage C\r\n\ton C.pif_symbol=A.pif_symbol and C.pif_policy_number=A.pif_policy_number and C.pif_module=A.pif_module\r\n\t@{pipeline().parameters.JOIN_CONDITION}\r\n\t(SELECT DISTINCT Policykey FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.work_policytransactionstatus \r\n\tWHERE AuditID = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AND PolicyStatus <> 'NOCHANGE')  B\r\n\tON  A.policykey = B.policykey\r\n\t\r\n\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.Pif43UYCRStage D\r\n\ton PIF43UYCRstageId in (\r\n\tselect max(PIF43UYCRstageId) from @{pipeline().parameters.SOURCE_TABLE_OWNER}.Pif43UYCRStage D1\r\n\twhere D1.PifSymbol=D.PifSymbol\r\n\tand D1.PifPolicyNumber=D.PifPolicyNumber\r\n\tand D1.PifPolicyModule=D.PifPolicyModule\r\n\tand D1.PMDUYC1InsuranceLine=D.PMDUYC1InsuranceLine\r\n\tand D1.PMDUYC1LocationNumber=D.PMDUYC1LocationNumber\r\n\tand D1.PMDUYC1SubLocationNumber=D.PMDUYC1SubLocationNumber\r\n\tand D1.PMDUYC1YearItemEffective=D.PMDUYC1YearItemEffective\r\n\tand D1.PMDUYC1MonthItemEffective=D.PMDUYC1MonthItemEffective\r\n\tand D1.PMDUYC1DayItemEffective=D.PMDUYC1DayItemEffective\r\n\tand D1.PMDUYC1Coverage=D.PMDUYC1Coverage\r\n\t)\r\n\tand D.PifSymbol=A.pif_symbol\r\n\tand D.PifPolicyNumber=A.pif_policy_number\r\n\tand D.PifPolicyModule=A.pif_module\r\n\tand D.PMDUYC1InsuranceLine=A.sar_insurance_line\r\n\tand D.PMDUYC1LocationNumber=(case when len(ltrim(rtrim(sar_location_x)))=0 then 0 \r\n\t                                  when isnumeric(sar_location_x)=1 then convert(decimal(4,0),sar_location_x) else -1 end)\r\n\tand D.PMDUYC1SubLocationNumber=(case when LEN(ltrim(rtrim(sar_sub_location_x)))=0 then 0 \r\n\t                                     when isnumeric(sar_sub_location_x)=1 then convert(numeric(3,0),sar_sub_location_x) else -1 end)\r\n\tand D.PMDUYC1YearItemEffective=A.sar_cov_eff_year\r\n\tand D.PMDUYC1MonthItemEffective=A.sar_cov_eff_month\r\n\tand D.PMDUYC1DayItemEffective=A.sar_cov_eff_day\r\n\tand D.PMDUYC1Coverage=A.sar_unit\r\n\t\r\n\tWHERE A.logical_flag IN ('0','1','2','3')  \r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Default AS (\n\tSELECT\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tpif_symbol  ||  pif_policy_number  || pif_module AS Policy_Key,\n\tsar_insurance_line,\n\tsar_location_x,\n\tsar_sub_location_x,\n\tsar_risk_unit_group,\n\tsar_class_code_grp_x,\n\tsar_unit,\n\tsar_seq_rsk_unt_a,\n\tsar_type_exposure,\n\tsar_major_peril,\n\tsar_seq_no,\n\tsar_cov_eff_year,\n\tsar_cov_eff_month,\n\tsar_cov_eff_day,\n\tsar_state,\n\tsar_loc_prov_territory,\n\tsar_city,\n\tsar_section,\n\tsar_type_bureau,\n\tsar_class_code,\n\tsar_sub_line,\n\tsar_zip_postal_code,\n\tsar_class_1_4,\n\tsar_code_2,\n\tsar_special_use,\n\tpif_line_business,\n\twb_class_of_business,\n\tPMDUYC1ClassOfInsured\n\tFROM SQ_pif_4514_stage\n),\nEXP_Values AS (\n\tSELECT\n\tpif_symbol,\n\tPolicy_Key,\n\t-- *INF*: :LKP.LKP_POLICY_POLICYAKID(Policy_Key)\n\tLKP_POLICY_POLICYAKID_Policy_Key.pol_ak_id AS v_policyAKID,\n\tsar_location_x,\n\t-- *INF*: LTRIM(RTRIM(sar_location_x))\n\tLTRIM(RTRIM(sar_location_x)) AS v_RiskLocation_Unit,\n\tsar_state,\n\t-- *INF*: IIF(LTRIM(RTRIM(sar_state))='00', '0', LTRIM(RTRIM(sar_state)))\n\tIFF(LTRIM(RTRIM(sar_state)) = '00', '0', LTRIM(RTRIM(sar_state))) AS v_sar_state,\n\tsar_loc_prov_territory,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_loc_prov_territory)\r\n\t-- \r\n\t-- --IIF(ISNULL(sar_loc_prov_territory) OR IS_SPACES(sar_loc_prov_territory) OR LENGTH(sar_loc_prov_territory) = 0, 'N/A',\r\n\t-- -- LTRIM(RTRIM(sar_loc_prov_territory)))\r\n\t-- \r\n\t-- \r\n\t-- \n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_loc_prov_territory) AS v_sar_loc_prov_territory,\n\tsar_city,\n\t-- *INF*: LTRIM(RTRIM(sar_city))\r\n\t-- \r\n\t-- --IIF(IS_SPACES(LTRIM(RTRIM(sar_city)))  OR ISNULL(LTRIM(RTRIM(sar_city))) OR LENGTH(LTRIM(RTRIM(sar_city))) < 3, '000', LTRIM(RTRIM(sar_city)))\r\n\t-- \r\n\t-- \n\tLTRIM(RTRIM(sar_city)) AS v_sar_city,\n\t-- *INF*: IIF(REG_MATCH(:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_city) ,'(\\d{6})')\r\n\t-- ,:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_city)\r\n\t-- ,'000000')\r\n\t-- \r\n\t-- ---:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_county_first_two  ||  sar_county_last_one  ||  sar_city)\r\n\t-- \r\n\t-- --v_sar_county_first_two  ||  v_sar_county_last_one  ||  v_sar_city\r\n\t-- \r\n\t-- --IIF(ISNULL(Tax_Location)  OR IS_SPACES(Tax_Location)  OR LENGTH(Tax_Location) = 0 , '000000', Tax_Location)\n\tIFF(REG_MATCH(:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_city), '(\\d{6})'), :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_city), '000000') AS v_Tax_Location,\n\tsar_zip_postal_code,\n\t-- *INF*: IIF(ISNULL(sar_zip_postal_code)  OR IS_SPACES(sar_zip_postal_code)  OR LENGTH(sar_zip_postal_code) = 0 , 'N/A', LTRIM(RTRIM(sar_zip_postal_code)))\n\tIFF(sar_zip_postal_code IS NULL OR IS_SPACES(sar_zip_postal_code) OR LENGTH(sar_zip_postal_code) = 0, 'N/A', LTRIM(RTRIM(sar_zip_postal_code))) AS v_sar_zip_postal_code,\n\t-- *INF*: :LKP.LKP_RISKLOCATION_RISKLOCATIONAKID(v_policyAKID, v_RiskLocation_Unit, v_sar_loc_prov_territory, v_sar_state, v_sar_zip_postal_code, v_Tax_Location)\r\n\t-- \n\tLKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.RiskLocationAKID AS v_RiskLocationAKID,\n\tsar_insurance_line,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_insurance_line)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_insurance_line) AS v_sar_insurance_line,\n\tsar_type_bureau,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_type_bureau)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_type_bureau) AS v_sar_type_bureau,\n\tsar_sub_location_x,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_sub_location_x)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_sub_location_x) AS v_sar_sub_location_x,\n\tv_sar_sub_location_x AS SubLocationUnitNumber,\n\tsar_risk_unit_group,\n\t-- *INF*: IIF(REG_MATCH(:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_risk_unit_group) ,'(\\d{3})')\r\n\t-- ,:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_risk_unit_group)\r\n\t-- ,'N/A')\r\n\t-- \r\n\t-- ---- Checking the length of the field to 3 and all the positions of the field are any one of 0-9, if it is not then we are defaulting it to 'N/A', by this way we are cleansing junk values from the source.\r\n\t-- \r\n\t-- ---:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_risk_unit_group)\n\tIFF(REG_MATCH(:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_risk_unit_group), '(\\d{3})'), :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_risk_unit_group), 'N/A') AS v_sar_risk_unit_group,\n\tv_sar_risk_unit_group AS RiskUnitGroup,\n\tsar_class_code_grp_x,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_code_grp_x)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_code_grp_x) AS v_sar_class_code_grp_x,\n\tv_sar_class_code_grp_x AS RiskUnitGroupSequenceNumber,\n\tsar_unit,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_unit)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_unit) AS v_sar_unit,\n\tv_sar_unit AS RiskUnit,\n\tsar_seq_rsk_unt_a,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_seq_rsk_unt_a)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_seq_rsk_unt_a) AS v_sar_seq_rsk_unt_a,\n\tv_sar_seq_rsk_unt_a AS RiskUnitSequenceNumber,\n\t-- *INF*: DECODE(v_sar_risk_unit_group, '340', SUBSTR(v_sar_seq_rsk_unt_a,2,1), NULL)\n\tDECODE(v_sar_risk_unit_group,\n\t'340', SUBSTR(v_sar_seq_rsk_unt_a, 2, 1),\n\tNULL) AS prdct_type_code_OUT,\n\tsar_type_exposure,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_type_exposure)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_type_exposure) AS v_sar_type_exposure,\n\tv_sar_type_exposure AS PMSTypeExposure,\n\tsar_major_peril,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_major_peril)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_major_peril) AS v_sar_major_peril,\n\tv_sar_major_peril AS MajorPerilCode,\n\tsar_seq_no,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_seq_no)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_seq_no) AS v_sar_seq_no,\n\tv_sar_seq_no AS MajorPerilSequenceNumber,\n\tsar_cov_eff_year,\n\t-- *INF*: TO_CHAR(sar_cov_eff_year)\n\tTO_CHAR(sar_cov_eff_year) AS v_sar_cov_eff_year,\n\tsar_cov_eff_month,\n\t-- *INF*: TO_CHAR(sar_cov_eff_month)\n\tTO_CHAR(sar_cov_eff_month) AS v_sar_cov_eff_month,\n\tsar_cov_eff_day,\n\t-- *INF*: TO_CHAR(sar_cov_eff_day)\n\tTO_CHAR(sar_cov_eff_day) AS v_sar_cov_eff_day,\n\t-- *INF*: TO_DATE(v_sar_cov_eff_month || '/' || v_sar_cov_eff_day || '/'|| v_sar_cov_eff_year ,'MM/DD/YYYY')\n\tTO_DATE(v_sar_cov_eff_month || '/' || v_sar_cov_eff_day || '/' || v_sar_cov_eff_year, 'MM/DD/YYYY') AS v_sar_cov_eff_date,\n\tv_sar_cov_eff_date AS StatisticalCoverageEffectiveDate,\n\t-- *INF*: MD5(TO_CHAR(v_policyAKID)  || \r\n\t-- TO_CHAR(v_RiskLocationAKID)  || \r\n\t--  v_sar_insurance_line  || \r\n\t--  v_sar_type_bureau\r\n\t-- )\n\tMD5(TO_CHAR(v_policyAKID) || TO_CHAR(v_RiskLocationAKID) || v_sar_insurance_line || v_sar_type_bureau) AS v_PolicyCoverageHashKey,\n\t-- *INF*: :LKP.LKP_POLICYCOVERAGE_POLICYCOVERAGEAKID(v_PolicyCoverageHashKey)\r\n\t-- \r\n\t-- \n\tLKP_POLICYCOVERAGE_POLICYCOVERAGEAKID_v_PolicyCoverageHashKey.PolicyCoverageAKID AS v_PolicyCoverageAKID,\n\t-- *INF*: DECODE(v_PolicyCoverageAKID, NULL, -1, v_PolicyCoverageAKID)\n\tDECODE(v_PolicyCoverageAKID,\n\tNULL, - 1,\n\tv_PolicyCoverageAKID) AS PolicyCoverageAKID_OUT,\n\t-- *INF*: :LKP.LKP_POLICYCOVERAGE_INSURANCELINE(v_PolicyCoverageAKID)\n\tLKP_POLICYCOVERAGE_INSURANCELINE_v_PolicyCoverageAKID.InsuranceLine AS ins_line_OUT,\n\tsar_section,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_section)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_section) AS v_sar_section,\n\tv_sar_section AS ReinsuranceSectionCode,\n\tsar_class_code,\n\tPMDUYC1ClassOfInsured,\n\tsar_sub_line,\n\tsar_class_1_4,\n\tsar_code_2,\n\tsar_special_use,\n\tpif_line_business,\n\twb_class_of_business,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(wb_class_of_business)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(wb_class_of_business) AS v_wb_class_of_business,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(PMDUYC1ClassOfInsured)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(PMDUYC1ClassOfInsured) AS v_PMDUYC1ClassOfInsured,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_code)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_code) AS v_sar_class_code,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_sub_line)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_sub_line) AS v_sar_sub_line,\n\t-- *INF*: MD5(\r\n\t-- TO_CHAR(v_PolicyCoverageAKID)   || \r\n\t-- v_sar_sub_location_x   || \r\n\t-- v_sar_risk_unit_group   || \r\n\t-- v_sar_class_code_grp_x   || \r\n\t-- v_sar_unit   || \r\n\t-- v_sar_seq_rsk_unt_a   || \r\n\t-- v_sar_major_peril   || \r\n\t-- v_sar_seq_no   || \r\n\t-- v_sar_sub_line   || \r\n\t-- v_sar_type_exposure   || \r\n\t-- v_sar_class_code   || \r\n\t-- v_sar_section\r\n\t-- )\n\tMD5(TO_CHAR(v_PolicyCoverageAKID) || v_sar_sub_location_x || v_sar_risk_unit_group || v_sar_class_code_grp_x || v_sar_unit || v_sar_seq_rsk_unt_a || v_sar_major_peril || v_sar_seq_no || v_sar_sub_line || v_sar_type_exposure || v_sar_class_code || v_sar_section) AS v_StatisticalCoverageHashKey,\n\t-- *INF*: SUBSTR(pif_symbol,1,2)\n\tSUBSTR(pif_symbol, 1, 2) AS v_pif_symbol_first2,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_1_4)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_class_1_4) AS v_sar_class_1_4,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_code_2)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_code_2) AS v_sar_code_2,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(sar_special_use)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(sar_special_use) AS v_sar_special_use,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(pif_line_business)\n\t:UDF.DEFAULT_VALUE_FOR_STRINGS(pif_line_business) AS v_pif_line_business,\n\t-- *INF*: ---IIF(UPPER(v_pif_symbol_first2)='NF' AND IN(v_wb_class_of_business, 'XN', 'XO', 'XP', 'XQ'), v_PMDUYC1ClassOfInsured, v_sar_class_code)\r\n\t-- \r\n\t-- v_sar_class_code\n\tv_sar_class_code AS o_ClassCode,\n\tv_sar_sub_line AS o_SublineCode,\n\tv_StatisticalCoverageHashKey AS o_StatisticalCoverageHashKey,\n\t-- *INF*: Policy_Key  ||  TO_CHAR(v_PolicyCoverageAKID)\n\tPolicy_Key || TO_CHAR(v_PolicyCoverageAKID) AS o_StatisticalCoverageKey,\n\t-- *INF*: ---:LKP.LKP_COVERAGEDETAIL_COVERAGEDETAILAKID(v_CoverageDetailHashKey)\n\t'' AS o_CoverageDetailAKID,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_sar_major_peril='032',\r\n\t-- '100',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2,'BD', 'NA', 'NS', 'BC', 'CP', 'BG', 'BH', 'NB', 'CA','XX') AND IN(v_sar_insurance_line,'N/A','CA') AND IN(v_sar_type_bureau, 'AL', 'AP', 'AN'))  \r\n\t-- OR (IN(v_pif_symbol_first2, 'BA', 'BB') AND v_sar_insurance_line='GL' AND IN(v_sar_risk_unit_group, '110', '111')),\r\n\t-- '200',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND IN(v_sar_major_peril, '599', '919') AND IN(v_sar_risk_unit_group, '345', '367')) \r\n\t-- OR (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND IN(v_sar_major_peril, '530', '540', '919', '599') AND v_sar_class_code != '99999' AND  NOT IN(v_sar_risk_unit_group, '345', '346', '355', '900', '901',  '286', '365', '367','000'))\r\n\t-- OR (IN(v_pif_symbol_first2, 'GL', 'XX') AND v_pif_line_business != 'SMP' AND IN(v_sar_major_peril, '084', '085'))\r\n\t--  OR (pif_symbol = 'DUM'),\r\n\t-- '300',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NN',\r\n\t-- --'310',\r\n\t-- '312',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NK',\r\n\t-- '311',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND IN(v_sar_major_peril, '530') AND v_sar_class_code='99999' AND IN(v_sar_sub_line, '334', '336')),\r\n\t-- '320',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND IN(v_sar_major_peril, '599') AND IN(v_sar_sub_line, '334', '336','345','346','347')),\r\n\t-- '320',\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- (v_pif_symbol_first2='CP' AND v_sar_insurance_line='GL' AND v_sar_risk_unit_group='346'),\r\n\t-- '321',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NE',\r\n\t-- '330',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS', 'GA') AND v_sar_insurance_line='GA'),\r\n\t-- '340',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CD', 'CM') AND IN(v_sar_risk_unit_group, '367', '900')),\r\n\t-- '310',\r\n\t-- \r\n\t-- (v_pif_symbol_first2='CM' AND v_sar_insurance_line='GL' AND IN(v_sar_risk_unit_group, '901', '902', '903')),\r\n\t-- '360',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND v_sar_risk_unit_group='345'),\r\n\t-- '365',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line='GL' AND (v_sar_risk_unit_group='355' or v_sar_sub_line='332' )),\r\n\t-- '370',\r\n\t-- \r\n\t-- (v_pif_symbol_first2='CP' AND v_sar_insurance_line='GL' AND v_sar_sub_line='365'),\r\n\t-- '380',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'BA', 'BB', 'XX', 'XA') AND IN(v_pif_line_business, 'BOP', 'BO') AND v_sar_insurance_line != 'CA'),\r\n\t-- '400',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'BC', 'BD') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG', 'N/A')),\r\n\t-- '410',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'BG', 'BH', 'GG') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'GA', 'CG', 'N/A')),\r\n\t-- '420',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'NA', 'NB') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG')),\r\n\t-- '430',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'SM','XX') AND (v_pif_line_business = 'SMP') AND IN(v_sar_type_bureau, 'AP','BM','BT','CF','FT','GL','GS','IM')),\r\n\t-- '440',\r\n\t-- \r\n\t-- v_pif_symbol_first2='BO',\r\n\t-- '450',\r\n\t-- \r\n\t-- IN(v_pif_symbol_first2,'CP','NS') AND v_pif_line_business = 'CPP' AND  v_sar_type_bureau='CR',\r\n\t-- '520',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS', 'CF', 'PX') AND IN(v_sar_insurance_line, 'CF', 'CR', 'GS', 'BM', 'N/A', 'CG') AND  NOT IN(v_sar_type_bureau, 'AL', 'AP', 'AN', 'GL', 'IM')),\r\n\t-- '500',\r\n\t-- \r\n\t-- v_pif_symbol_first2='FF',\r\n\t-- '510',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_type_bureau='IM'),\r\n\t-- '550',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NC',\r\n\t-- '610',\r\n\t-- \r\n\t-- (v_pif_symbol_first2='NF' AND IN(v_wb_class_of_business, 'XN', 'XO', 'XP', 'XQ','9')),\r\n\t-- '620',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NJ',\r\n\t-- '630',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NL',\r\n\t-- '640',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NM',\r\n\t-- '650',\r\n\t-- \r\n\t-- v_pif_symbol_first2='NO',\r\n\t-- '660',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'HA', 'HB', 'HH', 'HX', 'IB', 'IP', 'PA', 'PX', 'XX') AND IN(v_sar_type_bureau, 'PH', 'PI', 'PL', 'PQ', 'MS')),\r\n\t-- '800',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'FL', 'FP') AND IN(v_sar_type_bureau, 'PF', 'PQ', 'MS')) \r\n\t--  OR (v_pif_symbol_first2='HH' AND v_sar_type_bureau='PF'),\r\n\t-- '820',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'HH', 'PA', 'PM', 'PP', 'PS', 'PT', 'HA', 'XX', 'XA') AND IN(v_sar_type_bureau, 'RL', 'RP', 'RN')),\r\n\t-- '850',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'HH', 'UP', 'HX', 'XX') AND v_sar_type_bureau='GL' AND v_sar_major_peril='017'),\r\n\t-- '890',\r\n\t-- \r\n\t-- (IN(v_pif_symbol_first2, 'NU', 'CU', 'CP', 'UC') AND v_sar_type_bureau='GL' AND v_sar_major_peril='517'),\r\n\t-- '900',\r\n\t-- \r\n\t-- '000'\r\n\t-- )\n\tDECODE(TRUE,\n\tv_sar_major_peril = '032', '100',\n\t( IN(v_pif_symbol_first2, 'BD', 'NA', 'NS', 'BC', 'CP', 'BG', 'BH', 'NB', 'CA', 'XX') AND IN(v_sar_insurance_line, 'N/A', 'CA') AND IN(v_sar_type_bureau, 'AL', 'AP', 'AN') ) OR ( IN(v_pif_symbol_first2, 'BA', 'BB') AND v_sar_insurance_line = 'GL' AND IN(v_sar_risk_unit_group, '110', '111') ), '200',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND IN(v_sar_major_peril, '599', '919') AND IN(v_sar_risk_unit_group, '345', '367') ) OR ( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND IN(v_sar_major_peril, '530', '540', '919', '599') AND v_sar_class_code != '99999' AND NOT IN(v_sar_risk_unit_group, '345', '346', '355', '900', '901', '286', '365', '367', '000') ) OR ( IN(v_pif_symbol_first2, 'GL', 'XX') AND v_pif_line_business != 'SMP' AND IN(v_sar_major_peril, '084', '085') ) OR ( pif_symbol = 'DUM' ), '300',\n\tv_pif_symbol_first2 = 'NN', '312',\n\tv_pif_symbol_first2 = 'NK', '311',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND IN(v_sar_major_peril, '530') AND v_sar_class_code = '99999' AND IN(v_sar_sub_line, '334', '336') ), '320',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND IN(v_sar_major_peril, '599') AND IN(v_sar_sub_line, '334', '336', '345', '346', '347') ), '320',\n\t( v_pif_symbol_first2 = 'CP' AND v_sar_insurance_line = 'GL' AND v_sar_risk_unit_group = '346' ), '321',\n\tv_pif_symbol_first2 = 'NE', '330',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS', 'GA') AND v_sar_insurance_line = 'GA' ), '340',\n\t( IN(v_pif_symbol_first2, 'CD', 'CM') AND IN(v_sar_risk_unit_group, '367', '900') ), '310',\n\t( v_pif_symbol_first2 = 'CM' AND v_sar_insurance_line = 'GL' AND IN(v_sar_risk_unit_group, '901', '902', '903') ), '360',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND v_sar_risk_unit_group = '345' ), '365',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_insurance_line = 'GL' AND ( v_sar_risk_unit_group = '355' OR v_sar_sub_line = '332' ) ), '370',\n\t( v_pif_symbol_first2 = 'CP' AND v_sar_insurance_line = 'GL' AND v_sar_sub_line = '365' ), '380',\n\t( IN(v_pif_symbol_first2, 'BA', 'BB', 'XX', 'XA') AND IN(v_pif_line_business, 'BOP', 'BO') AND v_sar_insurance_line != 'CA' ), '400',\n\t( IN(v_pif_symbol_first2, 'BC', 'BD') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG', 'N/A') ), '410',\n\t( IN(v_pif_symbol_first2, 'BG', 'BH', 'GG') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'GA', 'CG', 'N/A') ), '420',\n\t( IN(v_pif_symbol_first2, 'NA', 'NB') AND IN(v_sar_insurance_line, 'CF', 'GL', 'CR', 'IM', 'CG') ), '430',\n\t( IN(v_pif_symbol_first2, 'SM', 'XX') AND ( v_pif_line_business = 'SMP' ) AND IN(v_sar_type_bureau, 'AP', 'BM', 'BT', 'CF', 'FT', 'GL', 'GS', 'IM') ), '440',\n\tv_pif_symbol_first2 = 'BO', '450',\n\tIN(v_pif_symbol_first2, 'CP', 'NS') AND v_pif_line_business = 'CPP' AND v_sar_type_bureau = 'CR', '520',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS', 'CF', 'PX') AND IN(v_sar_insurance_line, 'CF', 'CR', 'GS', 'BM', 'N/A', 'CG') AND NOT IN(v_sar_type_bureau, 'AL', 'AP', 'AN', 'GL', 'IM') ), '500',\n\tv_pif_symbol_first2 = 'FF', '510',\n\t( IN(v_pif_symbol_first2, 'CP', 'NS') AND v_sar_type_bureau = 'IM' ), '550',\n\tv_pif_symbol_first2 = 'NC', '610',\n\t( v_pif_symbol_first2 = 'NF' AND IN(v_wb_class_of_business, 'XN', 'XO', 'XP', 'XQ', '9') ), '620',\n\tv_pif_symbol_first2 = 'NJ', '630',\n\tv_pif_symbol_first2 = 'NL', '640',\n\tv_pif_symbol_first2 = 'NM', '650',\n\tv_pif_symbol_first2 = 'NO', '660',\n\t( IN(v_pif_symbol_first2, 'HA', 'HB', 'HH', 'HX', 'IB', 'IP', 'PA', 'PX', 'XX') AND IN(v_sar_type_bureau, 'PH', 'PI', 'PL', 'PQ', 'MS') ), '800',\n\t( IN(v_pif_symbol_first2, 'FL', 'FP') AND IN(v_sar_type_bureau, 'PF', 'PQ', 'MS') ) OR ( v_pif_symbol_first2 = 'HH' AND v_sar_type_bureau = 'PF' ), '820',\n\t( IN(v_pif_symbol_first2, 'HH', 'PA', 'PM', 'PP', 'PS', 'PT', 'HA', 'XX', 'XA') AND IN(v_sar_type_bureau, 'RL', 'RP', 'RN') ), '850',\n\t( IN(v_pif_symbol_first2, 'HH', 'UP', 'HX', 'XX') AND v_sar_type_bureau = 'GL' AND v_sar_major_peril = '017' ), '890',\n\t( IN(v_pif_symbol_first2, 'NU', 'CU', 'CP', 'UC') AND v_sar_type_bureau = 'GL' AND v_sar_major_peril = '517' ), '900',\n\t'000') AS o_SourceProductCode,\n\tSYSDATE AS o_CurrentDate,\n\t-- *INF*: :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(1,v_pif_symbol_first2)\n\tLKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_1_v_pif_symbol_first2.InsuranceReferenceLineOfBusinessCode AS v_Rule1,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule1), v_Rule1, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(2,v_pif_symbol_first2 || '&' || v_wb_class_of_business))\n\tIFF(NOT v_Rule1 IS NULL, v_Rule1, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_2_v_pif_symbol_first2_v_wb_class_of_business.InsuranceReferenceLineOfBusinessCode) AS v_Rule2,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule2), v_Rule2, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(28,v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_type_bureau || '&' || v_sar_risk_unit_group))\n\tIFF(NOT v_Rule2 IS NULL, v_Rule2, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_28_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau_v_sar_risk_unit_group.InsuranceReferenceLineOfBusinessCode) AS v_Rule28,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule28), v_Rule28, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(3,v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_type_bureau))\n\tIFF(NOT v_Rule28 IS NULL, v_Rule28, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_3_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau.InsuranceReferenceLineOfBusinessCode) AS v_Rule3,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule3), v_Rule3, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(4,v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_risk_unit_group))\n\tIFF(NOT v_Rule3 IS NULL, v_Rule3, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_4_v_pif_symbol_first2_v_sar_insurance_line_v_sar_risk_unit_group.InsuranceReferenceLineOfBusinessCode) AS v_Rule4,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule4), v_Rule4, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(5,v_sar_type_bureau || '&' || v_sar_major_peril))\n\tIFF(NOT v_Rule4 IS NULL, v_Rule4, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_5_v_sar_type_bureau_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule5,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule5), v_Rule5, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(6,v_sar_type_bureau))\n\tIFF(NOT v_Rule5 IS NULL, v_Rule5, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_6_v_sar_type_bureau.InsuranceReferenceLineOfBusinessCode) AS v_Rule6,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule6), v_Rule6, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(7,v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril))\n\tIFF(NOT v_Rule6 IS NULL, v_Rule6, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_7_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule7,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule7), v_Rule7, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(8,v_pif_symbol_first2 || '&' || v_sar_major_peril))\n\tIFF(NOT v_Rule7 IS NULL, v_Rule7, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_8_v_pif_symbol_first2_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule8,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule8), v_Rule8, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(9,v_pif_symbol_first2 || '&' || v_sar_type_bureau))\n\tIFF(NOT v_Rule8 IS NULL, v_Rule8, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_9_v_pif_symbol_first2_v_sar_type_bureau.InsuranceReferenceLineOfBusinessCode) AS v_Rule9,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule9), v_Rule9, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(10,v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_risk_unit_group))\n\tIFF(NOT v_Rule9 IS NULL, v_Rule9, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_10_v_pif_symbol_first2_v_sar_type_bureau_v_sar_risk_unit_group.InsuranceReferenceLineOfBusinessCode) AS v_Rule10,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule10), v_Rule10, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(11,v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&'  || v_sar_class_code))\n\tIFF(NOT v_Rule10 IS NULL, v_Rule10, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_11_v_pif_symbol_first2_v_sar_type_bureau_v_sar_class_code.InsuranceReferenceLineOfBusinessCode) AS v_Rule11,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule11), v_Rule11, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(12,v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril || '&' || v_sar_risk_unit_group))\n\tIFF(NOT v_Rule11 IS NULL, v_Rule11, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_12_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_risk_unit_group.InsuranceReferenceLineOfBusinessCode) AS v_Rule12,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule12), v_Rule12, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(13,v_pif_symbol_first2 || '&' || v_sar_insurance_line))\n\tIFF(NOT v_Rule12 IS NULL, v_Rule12, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_13_v_pif_symbol_first2_v_sar_insurance_line.InsuranceReferenceLineOfBusinessCode) AS v_Rule13,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  NOT ISNULL(v_Rule13), \r\n\t-- v_Rule13, \r\n\t-- v_sar_major_peril != '517' AND  NOT IN(SUBSTR(v_sar_class_code,1,5),'22222','22250'), :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(14,v_pif_symbol_first2 || '&' || v_sar_type_bureau), \r\n\t-- NULL)\n\tDECODE(TRUE,\n\tNOT v_Rule13 IS NULL, v_Rule13,\n\tv_sar_major_peril != '517' AND NOT IN(SUBSTR(v_sar_class_code, 1, 5), '22222', '22250'), LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_14_v_pif_symbol_first2_v_sar_type_bureau.InsuranceReferenceLineOfBusinessCode,\n\tNULL) AS v_Rule14,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule14), v_Rule14, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(15,v_sar_major_peril))\n\tIFF(NOT v_Rule14 IS NULL, v_Rule14, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_15_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule15,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule15), v_Rule15, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(16,v_pif_symbol_first2 || '&' || SUBSTR(v_sar_unit,1,1) || '&' || v_sar_code_2))\n\tIFF(NOT v_Rule15 IS NULL, v_Rule15, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_16_v_pif_symbol_first2_SUBSTR_v_sar_unit_1_1_v_sar_code_2.InsuranceReferenceLineOfBusinessCode) AS v_Rule16,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule16), v_Rule16, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(17,v_pif_symbol_first2 || '&' || SUBSTR(v_sar_special_use,1,4)))\n\tIFF(NOT v_Rule16 IS NULL, v_Rule16, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_17_v_pif_symbol_first2_SUBSTR_v_sar_special_use_1_4.InsuranceReferenceLineOfBusinessCode) AS v_Rule17,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule17), v_Rule17, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(18,v_pif_symbol_first2 || '&' || v_sar_type_bureau))\n\tIFF(NOT v_Rule17 IS NULL, v_Rule17, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_18_v_pif_symbol_first2_v_sar_type_bureau.InsuranceReferenceLineOfBusinessCode) AS v_Rule18,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule18), v_Rule18, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(19,v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || SUBSTR(v_sar_class_code,1,1)))\n\tIFF(NOT v_Rule18 IS NULL, v_Rule18, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_19_v_pif_symbol_first2_v_sar_type_bureau_SUBSTR_v_sar_class_code_1_1.InsuranceReferenceLineOfBusinessCode) AS v_Rule19,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule19), v_Rule19, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(20,v_pif_symbol_first2 || '&' || v_sar_class_1_4))\n\tIFF(NOT v_Rule19 IS NULL, v_Rule19, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_20_v_pif_symbol_first2_v_sar_class_1_4.InsuranceReferenceLineOfBusinessCode) AS v_Rule20,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule20), v_Rule20, :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(22, v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril ))\n\tIFF(NOT v_Rule20 IS NULL, v_Rule20, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_22_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule22,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule22), v_Rule22,  :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(23,v_pif_symbol_first2 || '&' ||  v_sar_type_bureau || '&' || v_sar_major_peril))\n\tIFF(NOT v_Rule22 IS NULL, v_Rule22, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_23_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode) AS v_Rule23,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule23), v_Rule23,  :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(24,v_pif_symbol_first2 || '&' ||  v_sar_type_bureau || '&' || v_sar_major_peril || '&' || v_sar_code_2))\n\tIFF(NOT v_Rule23 IS NULL, v_Rule23, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_24_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.InsuranceReferenceLineOfBusinessCode) AS v_Rule24,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule24), v_Rule24,  :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(25,v_sar_type_bureau || '&' ||  v_sar_major_peril || '&' || v_sar_code_2))\n\tIFF(NOT v_Rule24 IS NULL, v_Rule24, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_25_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.InsuranceReferenceLineOfBusinessCode) AS v_Rule25,\n\t-- *INF*: IIF( NOT ISNULL(v_Rule25), v_Rule25,  :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(26,v_pif_symbol_first2  ||  '&'  ||  v_sar_class_code))\n\tIFF(NOT v_Rule25 IS NULL, v_Rule25, LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_26_v_pif_symbol_first2_v_sar_class_code.InsuranceReferenceLineOfBusinessCode) AS v_Rule26,\n\t-- *INF*: DECODE(TRUE, NOT ISNULL(v_Rule26), v_Rule26, \r\n\t-- NOT IN(v_sar_class_code,'923500' , '962000','990000', '943700','944200'),\r\n\t--  :LKP.LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES(27,v_pif_symbol_first2 || '&' ||  v_sar_type_bureau || '&' || v_sar_major_peril), \r\n\t-- NULL)\n\tDECODE(TRUE,\n\tNOT v_Rule26 IS NULL, v_Rule26,\n\tNOT IN(v_sar_class_code, '923500', '962000', '990000', '943700', '944200'), LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_27_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.InsuranceReferenceLineOfBusinessCode,\n\tNULL) AS v_Rule27,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  NOT ISNULL(v_Rule27),v_Rule27,\r\n\t-- '000'\r\n\t-- )\n\tDECODE(TRUE,\n\tNOT v_Rule27 IS NULL, v_Rule27,\n\t'000') AS o_InsuranceReferenceLineOfBusinessCode,\n\t-- *INF*: IIF(v_sar_insurance_line='CF' AND v_sar_class_1_4 != 'N/A' AND SUBSTR(v_sar_class_1_4,1,2)<'35' AND (REG_MATCH(SUBSTR(v_sar_class_1_4,3,1),'[a-zA-Z]')=1 OR LENGTH(v_sar_class_1_4)=2), SUBSTR(v_sar_class_1_4,1,2), 'N/A')\n\tIFF(v_sar_insurance_line = 'CF' AND v_sar_class_1_4 != 'N/A' AND SUBSTR(v_sar_class_1_4, 1, 2) < '35' AND ( REG_MATCH(SUBSTR(v_sar_class_1_4, 3, 1), '[a-zA-Z]') = 1 OR LENGTH(v_sar_class_1_4) = 2 ), SUBSTR(v_sar_class_1_4, 1, 2), 'N/A') AS o_SpecialClassLevel1,\n\tv_StatisticalCoverageHashKey AS o_CoverageGuid,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- UPPER(v_sar_insurance_line)='WC', \r\n\t-- 'NCCI', \r\n\t-- IN(UPPER(v_pif_symbol_first2), 'NC', 'NJ', 'NL', 'NM', 'NO'),\r\n\t-- 'SFAA',\r\n\t-- UPPER( v_pif_symbol_first2)= 'NF' AND IN (UPPER(v_wb_class_of_business), 'XN', 'XO', 'XP', 'XQ'),\r\n\t-- 'SFAA',\r\n\t-- 'ISO')\n\tDECODE(TRUE,\n\tUPPER(v_sar_insurance_line) = 'WC', 'NCCI',\n\tIN(UPPER(v_pif_symbol_first2), 'NC', 'NJ', 'NL', 'NM', 'NO'), 'SFAA',\n\tUPPER(v_pif_symbol_first2) = 'NF' AND IN(UPPER(v_wb_class_of_business), 'XN', 'XO', 'XP', 'XQ'), 'SFAA',\n\t'ISO') AS o_ClassCodeOrganizationCode\n\tFROM EXP_Default\n\tLEFT JOIN LKP_POLICY_POLICYAKID LKP_POLICY_POLICYAKID_Policy_Key\n\tON LKP_POLICY_POLICYAKID_Policy_Key.pol_key = Policy_Key\n\n\tLEFT JOIN LKP_RISKLOCATION_RISKLOCATIONAKID LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location\n\tON LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.PolicyAKID = v_policyAKID\n\tAND LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.LocationUnitNumber = v_RiskLocation_Unit\n\tAND LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.RiskTerritory = v_sar_loc_prov_territory\n\tAND LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.StateProvinceCode = v_sar_state\n\tAND LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.ZipPostalCode = v_sar_zip_postal_code\n\tAND LKP_RISKLOCATION_RISKLOCATIONAKID_v_policyAKID_v_RiskLocation_Unit_v_sar_loc_prov_territory_v_sar_state_v_sar_zip_postal_code_v_Tax_Location.TaxLocation = v_Tax_Location\n\n\tLEFT JOIN LKP_POLICYCOVERAGE_POLICYCOVERAGEAKID LKP_POLICYCOVERAGE_POLICYCOVERAGEAKID_v_PolicyCoverageHashKey\n\tON LKP_POLICYCOVERAGE_POLICYCOVERAGEAKID_v_PolicyCoverageHashKey.PolicyCoverageHashKey = v_PolicyCoverageHashKey\n\n\tLEFT JOIN LKP_POLICYCOVERAGE_INSURANCELINE LKP_POLICYCOVERAGE_INSURANCELINE_v_PolicyCoverageAKID\n\tON LKP_POLICYCOVERAGE_INSURANCELINE_v_PolicyCoverageAKID.PolicyCoverageAKID = v_PolicyCoverageAKID\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_1_v_pif_symbol_first2\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_1_v_pif_symbol_first2.SequenceNumber = 1\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_1_v_pif_symbol_first2.Identifiers = v_pif_symbol_first2\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_2_v_pif_symbol_first2_v_wb_class_of_business\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_2_v_pif_symbol_first2_v_wb_class_of_business.SequenceNumber = 2\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_2_v_pif_symbol_first2_v_wb_class_of_business.Identifiers = v_pif_symbol_first2 || '&' || v_wb_class_of_business\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_28_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau_v_sar_risk_unit_group\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_28_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau_v_sar_risk_unit_group.SequenceNumber = 28\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_28_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau_v_sar_risk_unit_group.Identifiers = v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_type_bureau || '&' || v_sar_risk_unit_group\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_3_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_3_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau.SequenceNumber = 3\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_3_v_pif_symbol_first2_v_sar_insurance_line_v_sar_type_bureau.Identifiers = v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_type_bureau\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_4_v_pif_symbol_first2_v_sar_insurance_line_v_sar_risk_unit_group\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_4_v_pif_symbol_first2_v_sar_insurance_line_v_sar_risk_unit_group.SequenceNumber = 4\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_4_v_pif_symbol_first2_v_sar_insurance_line_v_sar_risk_unit_group.Identifiers = v_pif_symbol_first2 || '&' || v_sar_insurance_line || '&' || v_sar_risk_unit_group\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_5_v_sar_type_bureau_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_5_v_sar_type_bureau_v_sar_major_peril.SequenceNumber = 5\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_5_v_sar_type_bureau_v_sar_major_peril.Identifiers = v_sar_type_bureau || '&' || v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_6_v_sar_type_bureau\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_6_v_sar_type_bureau.SequenceNumber = 6\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_6_v_sar_type_bureau.Identifiers = v_sar_type_bureau\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_7_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_7_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.SequenceNumber = 7\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_7_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_8_v_pif_symbol_first2_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_8_v_pif_symbol_first2_v_sar_major_peril.SequenceNumber = 8\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_8_v_pif_symbol_first2_v_sar_major_peril.Identifiers = v_pif_symbol_first2 || '&' || v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_9_v_pif_symbol_first2_v_sar_type_bureau\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_9_v_pif_symbol_first2_v_sar_type_bureau.SequenceNumber = 9\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_9_v_pif_symbol_first2_v_sar_type_bureau.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_10_v_pif_symbol_first2_v_sar_type_bureau_v_sar_risk_unit_group\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_10_v_pif_symbol_first2_v_sar_type_bureau_v_sar_risk_unit_group.SequenceNumber = 10\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_10_v_pif_symbol_first2_v_sar_type_bureau_v_sar_risk_unit_group.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_risk_unit_group\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_11_v_pif_symbol_first2_v_sar_type_bureau_v_sar_class_code\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_11_v_pif_symbol_first2_v_sar_type_bureau_v_sar_class_code.SequenceNumber = 11\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_11_v_pif_symbol_first2_v_sar_type_bureau_v_sar_class_code.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_class_code\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_12_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_risk_unit_group\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_12_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_risk_unit_group.SequenceNumber = 12\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_12_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_risk_unit_group.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril || '&' || v_sar_risk_unit_group\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_13_v_pif_symbol_first2_v_sar_insurance_line\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_13_v_pif_symbol_first2_v_sar_insurance_line.SequenceNumber = 13\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_13_v_pif_symbol_first2_v_sar_insurance_line.Identifiers = v_pif_symbol_first2 || '&' || v_sar_insurance_line\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_14_v_pif_symbol_first2_v_sar_type_bureau\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_14_v_pif_symbol_first2_v_sar_type_bureau.SequenceNumber = 14\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_14_v_pif_symbol_first2_v_sar_type_bureau.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_15_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_15_v_sar_major_peril.SequenceNumber = 15\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_15_v_sar_major_peril.Identifiers = v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_16_v_pif_symbol_first2_SUBSTR_v_sar_unit_1_1_v_sar_code_2\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_16_v_pif_symbol_first2_SUBSTR_v_sar_unit_1_1_v_sar_code_2.SequenceNumber = 16\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_16_v_pif_symbol_first2_SUBSTR_v_sar_unit_1_1_v_sar_code_2.Identifiers = v_pif_symbol_first2 || '&' || SUBSTR(v_sar_unit, 1, 1) || '&' || v_sar_code_2\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_17_v_pif_symbol_first2_SUBSTR_v_sar_special_use_1_4\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_17_v_pif_symbol_first2_SUBSTR_v_sar_special_use_1_4.SequenceNumber = 17\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_17_v_pif_symbol_first2_SUBSTR_v_sar_special_use_1_4.Identifiers = v_pif_symbol_first2 || '&' || SUBSTR(v_sar_special_use, 1, 4)\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_18_v_pif_symbol_first2_v_sar_type_bureau\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_18_v_pif_symbol_first2_v_sar_type_bureau.SequenceNumber = 18\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_18_v_pif_symbol_first2_v_sar_type_bureau.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_19_v_pif_symbol_first2_v_sar_type_bureau_SUBSTR_v_sar_class_code_1_1\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_19_v_pif_symbol_first2_v_sar_type_bureau_SUBSTR_v_sar_class_code_1_1.SequenceNumber = 19\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_19_v_pif_symbol_first2_v_sar_type_bureau_SUBSTR_v_sar_class_code_1_1.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || SUBSTR(v_sar_class_code, 1, 1)\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_20_v_pif_symbol_first2_v_sar_class_1_4\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_20_v_pif_symbol_first2_v_sar_class_1_4.SequenceNumber = 20\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_20_v_pif_symbol_first2_v_sar_class_1_4.Identifiers = v_pif_symbol_first2 || '&' || v_sar_class_1_4\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_22_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_22_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.SequenceNumber = 22\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_22_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_23_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_23_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.SequenceNumber = 23\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_23_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_24_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_24_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.SequenceNumber = 24\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_24_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril || '&' || v_sar_code_2\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_25_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_25_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.SequenceNumber = 25\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_25_v_sar_type_bureau_v_sar_major_peril_v_sar_code_2.Identifiers = v_sar_type_bureau || '&' || v_sar_major_peril || '&' || v_sar_code_2\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_26_v_pif_symbol_first2_v_sar_class_code\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_26_v_pif_symbol_first2_v_sar_class_code.SequenceNumber = 26\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_26_v_pif_symbol_first2_v_sar_class_code.Identifiers = v_pif_symbol_first2 || '&' || v_sar_class_code\n\n\tLEFT JOIN LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_27_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril\n\tON LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_27_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.SequenceNumber = 27\n\tAND LKP_SUPINSURANCEREFERENCELINEOFBUSINESSRULES_27_v_pif_symbol_first2_v_sar_type_bureau_v_sar_major_peril.Identifiers = v_pif_symbol_first2 || '&' || v_sar_type_bureau || '&' || v_sar_major_peril\n\n),\nLKP_ClassificationReference AS (\n\tSELECT\n\tOriginatingOrganizationCode,\n\tInsuranceLineCode,\n\tClassCode\n\tFROM (\n\t\tSELECT DISTINCT LTRIM(RTRIM(OriginatingOrganizationCode)) as OriginatingOrganizationCode, \r\n\t\tLTRIM(RTRIM(InsuranceLineCode)) as InsuranceLineCode, \r\n\t\tLTRIM(RTRIM(ClassCode)) as ClassCode \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.ClassificationReference\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceLineCode,ClassCode ORDER BY OriginatingOrganizationCode) = 1\n),\nLKP_InsuranceReferenceLineOfBusiness AS (\n\tSELECT\n\tInsuranceReferenceLineOfBusinessAKId,\n\tInsuranceReferenceLineOfBusinessCode\n\tFROM (\n\t\tSELECT \n\t\t\tInsuranceReferenceLineOfBusinessAKId,\n\t\t\tInsuranceReferenceLineOfBusinessCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceLineOfBusiness\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceReferenceLineOfBusinessCode ORDER BY InsuranceReferenceLineOfBusinessAKId) = 1\n),\nLKP_SupProduct AS (\n\tSELECT\n\tProductCode,\n\tSourceProductCode,\n\tEffectiveDate,\n\tExpirationDate\n\tFROM (\n\t\tSELECT \n\t\t\tProductCode,\n\t\t\tSourceProductCode,\n\t\t\tEffectiveDate,\n\t\t\tExpirationDate\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SupProduct\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SourceProductCode,EffectiveDate,ExpirationDate ORDER BY ProductCode) = 1\n),\nLKP_Product AS (\n\tSELECT\n\tProductAKId,\n\tProductCode\n\tFROM (\n\t\tSELECT \n\t\t\tProductAKId,\n\t\t\tProductCode\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.Product\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ProductCode ORDER BY ProductAKId) = 1\n),\nLKP_StatisticalCoverage AS (\n\tSELECT\n\tCurrentSnapshotFlag,\n\tStatisticalCoverageAKID,\n\tStatisticalCoverageID,\n\tSpecialClassGroupCode,\n\tAnnualStatementLineId,\n\tClassCodeOrganizationCode,\n\tClassCode,\n\tStatisticalCoverageHashKey\n\tFROM (\n\t\tSELECT StatisticalCoverageID AS StatisticalCoverageID,\r\n\t\tSTATCOV.CurrentSnapshotFlag AS CurrentSnapshotFlag,\r\n\t\tSTATCOV.StatisticalCoverageAKID AS StatisticalCoverageAKID,\r\n\t\tStatisticalCoverageHashKey AS StatisticalCoverageHashKey,\r\n\t\tSpecialClassGroupCode as SpecialClassGroupCode,\r\n\t\tAnnualStatementLineId as AnnualStatementLineId,\r\n\t\tClassCodeOrganizationCode as ClassCodeOrganizationCode,\r\n\t\tClassCode as ClassCode\r\n\t\tFROM\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.RiskLocation LOC\r\n\t\tINNER JOIN  @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER_V2}.Policy POL\r\n\t\tON LOC.PolicyAKID = POL.pol_ak_id\r\n\t\tINNER JOIN \t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.PolicyCoverage POLCOV\r\n\t\tON LOC.RiskLocationAKID = POLCOV.RiskLocationAKID\r\n\t\tINNER JOIN \t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.StatisticalCoverage STATCOV\r\n\t\tON POLCOV.PolicyCoverageAKID = STATCOV.PolicyCoverageAKID\r\n\t\tWHERE\tPOL.crrnt_snpsht_flag = 1 AND LOC.CurrentSnapshotFlag =1\r\n\t\t\t\tAND POLCOV.CurrentSnapshotFlag =1\r\n\t\t        \tAND POL.SOURCE_SYS_ID = '@{pipeline().parameters.SOURCE_SYSTEM_ID}'\r\n\t\t        \tAND  EXISTS  (SELECT DISTINCT PolicyKey FROM  \r\n\t\t\t\t\t\t\t\t\t@{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkPolicyKeyList\r\n\t\t\t\t\t\t\t\t\tWHERE POL.pol_key = PolicyKey AND @{pipeline().parameters.WHERE_CLAUSE_EDW})\r\n\t\tORDER BY StatisticalCoverageHashKey,STATCOV.CurrentSnapshotFlag\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StatisticalCoverageHashKey ORDER BY CurrentSnapshotFlag DESC) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tLKP_StatisticalCoverage.CurrentSnapshotFlag AS LKP_CurrentSnapshotFlag,\n\t-- *INF*: Decode(LKP_CurrentSnapshotFlag,'T','1','F','0',LKP_CurrentSnapshotFlag)\n\tDecode(LKP_CurrentSnapshotFlag,\n\t'T', '1',\n\t'F', '0',\n\tLKP_CurrentSnapshotFlag) AS v_LKP_CurrentSnapshotFlag,\n\tLKP_StatisticalCoverage.StatisticalCoverageAKID AS LKP_StatisticalCoverageAKID,\n\tLKP_StatisticalCoverage.StatisticalCoverageID AS i_StatisticalCoverageID,\n\tLKP_StatisticalCoverage.SpecialClassGroupCode AS i_SpecialClassGroupCode,\n\tLKP_StatisticalCoverage.AnnualStatementLineId AS i_AnnualStatementLineId,\n\tLKP_StatisticalCoverage.ClassCodeOrganizationCode AS i_ClassCodeOrganizationCode,\n\tLKP_StatisticalCoverage.ClassCode AS i_ClassCode,\n\tLKP_InsuranceReferenceLineOfBusiness.InsuranceReferenceLineOfBusinessAKId AS i_InsuranceReferenceLineOfBusinessAKId,\n\tLKP_Product.ProductAKId AS i_ProductAKId,\n\tLKP_ClassificationReference.OriginatingOrganizationCode AS i_OriginatingOrganizationCode,\n\tEXP_Values.ins_line_OUT AS i_InsuranceLine,\n\tEXP_Values.PolicyCoverageAKID_OUT,\n\tEXP_Values.SubLocationUnitNumber,\n\tEXP_Values.RiskUnitGroup,\n\tEXP_Values.RiskUnitGroupSequenceNumber,\n\tEXP_Values.RiskUnit,\n\tEXP_Values.RiskUnitSequenceNumber,\n\tEXP_Values.MajorPerilCode,\n\tEXP_Values.MajorPerilSequenceNumber,\n\tEXP_Values.o_SublineCode AS SublineCode,\n\tEXP_Values.PMSTypeExposure,\n\tEXP_Values.o_ClassCode AS ClassCode,\n\tEXP_Values.StatisticalCoverageEffectiveDate,\n\tEXP_Values.ReinsuranceSectionCode,\n\tEXP_Values.o_StatisticalCoverageHashKey AS StatisticalCoverageHashKey,\n\tEXP_Values.o_StatisticalCoverageKey AS StatisticalCoverageKey,\n\tEXP_Values.o_CoverageGuid AS CoverageGuid,\n\tEXP_Values.o_SpecialClassLevel1 AS SpecialClassGroupCode,\n\tEXP_Values.o_ClassCodeOrganizationCode AS ClassCodeOrganizationCode,\n\t-1 AS v_AnnualStatementLineId,\n\t'1' AS o_CurrentSnapshotFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditID,\n\t-- *INF*: TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AS o_EffectiveDate,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS o_ExpirationDate,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS o_SourceSystemID,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\t0 AS o_logicalIndicator,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS o_StatisticalCoverageExpirationDate,\n\t-- *INF*: IIF(ISNULL(i_ProductAKId),-1,i_ProductAKId)\n\tIFF(i_ProductAKId IS NULL, - 1, i_ProductAKId) AS o_ProductAKId,\n\t-- *INF*: IIF(ISNULL(i_InsuranceReferenceLineOfBusinessAKId),-1,i_InsuranceReferenceLineOfBusinessAKId)\n\tIFF(i_InsuranceReferenceLineOfBusinessAKId IS NULL, - 1, i_InsuranceReferenceLineOfBusinessAKId) AS o_InsuranceReferenceLineOfBusinessAKId,\n\tv_AnnualStatementLineId AS o_AnnualStatementLineId,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_StatisticalCoverageID), 'NEW', v_LKP_CurrentSnapshotFlag='0' or\r\n\t-- i_SpecialClassGroupCode != SpecialClassGroupCode OR \r\n\t-- i_AnnualStatementLineId != v_AnnualStatementLineId OR \r\n\t-- i_ClassCodeOrganizationCode != ClassCodeOrganizationCode OR i_ClassCode != ClassCode,\r\n\t-- 'UPDATE',\r\n\t-- 'NOCHANGE')\n\tDECODE(TRUE,\n\ti_StatisticalCoverageID IS NULL, 'NEW',\n\tv_LKP_CurrentSnapshotFlag = '0' OR i_SpecialClassGroupCode != SpecialClassGroupCode OR i_AnnualStatementLineId != v_AnnualStatementLineId OR i_ClassCodeOrganizationCode != ClassCodeOrganizationCode OR i_ClassCode != ClassCode, 'UPDATE',\n\t'NOCHANGE') AS o_ChangeFlag\n\tFROM EXP_Values\n\tLEFT JOIN LKP_ClassificationReference\n\tON LKP_ClassificationReference.InsuranceLineCode = EXP_Values.ins_line_OUT AND LKP_ClassificationReference.ClassCode = EXP_Values.o_ClassCode\n\tLEFT JOIN LKP_InsuranceReferenceLineOfBusiness\n\tON LKP_InsuranceReferenceLineOfBusiness.InsuranceReferenceLineOfBusinessCode = EXP_Values.o_InsuranceReferenceLineOfBusinessCode\n\tLEFT JOIN LKP_Product\n\tON LKP_Product.ProductCode = LKP_SupProduct.ProductCode\n\tLEFT JOIN LKP_StatisticalCoverage\n\tON LKP_StatisticalCoverage.StatisticalCoverageHashKey = EXP_Values.o_StatisticalCoverageHashKey\n),\nAGG_Eliminate_Dups AS (\n\tSELECT\n\tLKP_StatisticalCoverageAKID, \n\ti_StatisticalCoverageID AS LKP_StatisticalCoverageID, \n\to_CurrentSnapshotFlag AS CurrentSnapshotFlag, \n\to_AuditID AS AuditID, \n\to_EffectiveDate AS EffectiveDate, \n\to_ExpirationDate AS ExpirationDate, \n\to_SourceSystemID AS SourceSystemID, \n\to_CreatedDate AS CreatedDate, \n\to_ModifiedDate AS ModifiedDate, \n\to_logicalIndicator AS logicalIndicator, \n\tStatisticalCoverageHashKey, \n\tPolicyCoverageAKID_OUT AS PolicyCoverageAKID, \n\tStatisticalCoverageKey, \n\tSubLocationUnitNumber, \n\tRiskUnitGroup, \n\tRiskUnitGroupSequenceNumber, \n\tRiskUnit, \n\tRiskUnitSequenceNumber, \n\tMajorPerilCode, \n\tMajorPerilSequenceNumber, \n\tSublineCode, \n\tPMSTypeExposure, \n\tClassCode, \n\tStatisticalCoverageEffectiveDate, \n\to_StatisticalCoverageExpirationDate AS StatisticalCoverageExpirationDate, \n\tReinsuranceSectionCode, \n\to_ProductAKId AS ProductAKId, \n\to_InsuranceReferenceLineOfBusinessAKId AS InsuranceReferenceLineOfBusinessAKId, \n\to_AnnualStatementLineId AS AnnualStatementLineId, \n\tCoverageGuid, \n\tSpecialClassGroupCode, \n\tClassCodeOrganizationCode, \n\to_ChangeFlag AS ChangeFlag\n\tFROM EXP_Detect_Changes\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StatisticalCoverageHashKey, StatisticalCoverageKey ORDER BY NULL) = 1\n),\nRTR_StatisticalCoverage AS (\n\tSELECT\n\tLKP_StatisticalCoverageAKID,\n\tLKP_StatisticalCoverageID,\n\tCurrentSnapshotFlag,\n\tAuditID,\n\tEffectiveDate,\n\tExpirationDate,\n\tSourceSystemID,\n\tCreatedDate,\n\tModifiedDate,\n\tlogicalIndicator,\n\tStatisticalCoverageHashKey,\n\tPolicyCoverageAKID,\n\tStatisticalCoverageKey,\n\tSubLocationUnitNumber,\n\tRiskUnitGroup,\n\tRiskUnitGroupSequenceNumber,\n\tRiskUnit,\n\tRiskUnitSequenceNumber,\n\tMajorPerilCode,\n\tMajorPerilSequenceNumber,\n\tSublineCode,\n\tPMSTypeExposure,\n\tClassCode,\n\tStatisticalCoverageEffectiveDate,\n\tStatisticalCoverageExpirationDate,\n\tReinsuranceSectionCode,\n\tProductAKId,\n\tInsuranceReferenceLineOfBusinessAKId,\n\tAnnualStatementLineId,\n\tCoverageGuid,\n\tSpecialClassGroupCode,\n\tClassCodeOrganizationCode,\n\tChangeFlag\n\tFROM AGG_Eliminate_Dups\n),\nRTR_StatisticalCoverage_Insert AS (SELECT * FROM RTR_StatisticalCoverage WHERE ChangeFlag='NEW'),\nRTR_StatisticalCoverage_Update AS (SELECT * FROM RTR_StatisticalCoverage WHERE ChangeFlag='UPDATE'),\nEXP_Update_DataCollect AS (\n\tSELECT\n\tLKP_StatisticalCoverageID AS StatisticalCoverageID,\n\tModifiedDate,\n\tClassCode,\n\tAnnualStatementLineId,\n\tSpecialClassGroupCode,\n\tClassCodeOrganizationCode,\n\t'1' AS CurrentSnapshotFlag,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS ExpirationDate\n\tFROM RTR_StatisticalCoverage_Update\n),\nUPD_StatisticalCoverage AS (\n\tSELECT\n\tStatisticalCoverageID, \n\tModifiedDate, \n\tClassCode, \n\tAnnualStatementLineId, \n\tSpecialClassGroupCode, \n\tClassCodeOrganizationCode, \n\tCurrentSnapshotFlag, \n\tExpirationDate\n\tFROM EXP_Update_DataCollect\n),\nTGT_StatisticalCoverage_Update AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.StatisticalCoverage AS T\n\tUSING UPD_StatisticalCoverage AS S\n\tON T.StatisticalCoverageID = S.StatisticalCoverageID\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.CurrentSnapshotFlag = S.CurrentSnapshotFlag, T.ExpirationDate = S.ExpirationDate, T.ModifiedDate = S.ModifiedDate, T.ClassCode = S.ClassCode, T.AnnualStatementLineId = S.AnnualStatementLineId, T.SpecialClassGroupCode = S.SpecialClassGroupCode, T.ClassCodeOrganizationCode = S.ClassCodeOrganizationCode\n),\nSEQ_StatisticalCoverageAKID AS (\n\tCREATE SEQUENCE SEQ_StatisticalCoverageAKID\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_TGT_DataCollect AS (\n\tSELECT\n\tLKP_StatisticalCoverageAKID,\n\tCurrentSnapshotFlag,\n\tAuditID,\n\tEffectiveDate,\n\tExpirationDate,\n\tSourceSystemID,\n\tCreatedDate,\n\tModifiedDate,\n\tlogicalIndicator,\n\tStatisticalCoverageHashKey,\n\t-- *INF*: IIF(ISNULL(LKP_StatisticalCoverageAKID),NEXTVAL,LKP_StatisticalCoverageAKID)\n\tIFF(LKP_StatisticalCoverageAKID IS NULL, NEXTVAL, LKP_StatisticalCoverageAKID) AS StatisticalCoverageAKID,\n\tPolicyCoverageAKID,\n\tStatisticalCoverageKey,\n\tSubLocationUnitNumber,\n\tRiskUnitGroup,\n\tRiskUnitGroupSequenceNumber,\n\tRiskUnit,\n\tRiskUnitSequenceNumber,\n\tMajorPerilCode,\n\tMajorPerilSequenceNumber,\n\tSublineCode,\n\tPMSTypeExposure,\n\tClassCode,\n\tStatisticalCoverageEffectiveDate,\n\tStatisticalCoverageExpirationDate,\n\tReinsuranceSectionCode,\n\tProductAKId,\n\tInsuranceReferenceLineOfBusinessAKId,\n\tAnnualStatementLineId,\n\tCoverageGuid,\n\tSpecialClassGroupCode,\n\tClassCodeOrganizationCode,\n\tSEQ_StatisticalCoverageAKID.NEXTVAL\n\tFROM RTR_StatisticalCoverage_Insert\n),\nTGT_StatisticalCoverage_Insert AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.StatisticalCoverage\n\t(CurrentSnapshotFlag, AuditID, EffectiveDate, ExpirationDate, SourceSystemID, CreatedDate, ModifiedDate, LogicalIndicator, StatisticalCoverageHashKey, StatisticalCoverageAKID, PolicyCoverageAKID, StatisticalCoverageKey, SubLocationUnitNumber, RiskUnitGroup, RiskUnitGroupSequenceNumber, RiskUnit, RiskUnitSequenceNumber, MajorPerilCode, MajorPerilSequenceNumber, SublineCode, PMSTypeExposure, ClassCode, StatisticalCoverageEffectiveDate, StatisticalCoverageExpirationDate, ReinsuranceSectionCode, ProductAKId, InsuranceReferenceLineOfBusinessAKId, AnnualStatementLineId, CoverageGuid, SpecialClassGroupCode, ClassCodeOrganizationCode)\n\tSELECT \n\tCURRENTSNAPSHOTFLAG, \n\tAUDITID, \n\tEFFECTIVEDATE, \n\tEXPIRATIONDATE, \n\tSOURCESYSTEMID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tlogicalIndicator AS LOGICALINDICATOR, \n\tSTATISTICALCOVERAGEHASHKEY, \n\tSTATISTICALCOVERAGEAKID, \n\tPOLICYCOVERAGEAKID, \n\tSTATISTICALCOVERAGEKEY, \n\tSUBLOCATIONUNITNUMBER, \n\tRISKUNITGROUP, \n\tRISKUNITGROUPSEQUENCENUMBER, \n\tRISKUNIT, \n\tRISKUNITSEQUENCENUMBER, \n\tMAJORPERILCODE, \n\tMAJORPERILSEQUENCENUMBER, \n\tSUBLINECODE, \n\tPMSTYPEEXPOSURE, \n\tCLASSCODE, \n\tSTATISTICALCOVERAGEEFFECTIVEDATE, \n\tSTATISTICALCOVERAGEEXPIRATIONDATE, \n\tREINSURANCESECTIONCODE, \n\tPRODUCTAKID, \n\tINSURANCEREFERENCELINEOFBUSINESSAKID, \n\tANNUALSTATEMENTLINEID, \n\tCOVERAGEGUID, \n\tSPECIALCLASSGROUPCODE, \n\tCLASSCODEORGANIZATIONCODE\n\tFROM EXP_TGT_DataCollect\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246483"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905516"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604218"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 01:21:59"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 01:54:57"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Stage_Policy"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Policy"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "WC_STAGE"
            },
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "RPT_EDM"
            },
            "JOIN_CONDITION": {
                "type": "string",
                "defaultValue": "INNER JOIN"
            },
            "TARGET_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "V2"
            },
            "SOURCE_TABLE_NAME_4514": {
                "type": "string",
                "defaultValue": "pif_4514_stage"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "PMS"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "AND 1=1"
            },
            "WHERE_CLAUSE_EDW": {
                "type": "string",
                "defaultValue": "1=1"
            },
            "MERGED_SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "EXCEED AND PMS"
            }
        },
        "folder": {
            "name": "Policy DataWarehouse/"
        },
        "annotations": []
    }
}