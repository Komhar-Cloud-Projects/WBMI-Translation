WITH
SQ_offset_onset_cov_stage AS (
	SELECT
		offset_onset_cov_stage_id,
		tch_claim_nbr,
		off_onset_ts,
		major_peril,
		cause_of_loss,
		reserve_cat,
		loss_disability,
		cov_eff_date,
		unit_seq_nbr,
		off_client_id,
		on_majr_peril_seq,
		off_majr_peril_seq,
		on_sar_id,
		off_sar_id,
		off_ins_line,
		off_loc_unit_num,
		off_risk_unit_grp,
		off_rsk_unt_gr_seq,
		off_risk_unit,
		off_risk_type_ind,
		off_sub_loc_num,
		off_seq_risk_unit,
		on_ins_line,
		on_loc_unit_num,
		on_risk_unit_grp,
		on_rsk_unt_gr_seq,
		on_risk_unit,
		on_risk_type_ind,
		on_sub_loc_num,
		on_seq_risk_unit,
		off_cov_eff_date,
		off_cov_exp_date,
		cov_type_cd,
		cov_seq_nbr,
		process_sta_ind,
		logical_flag,
		extract_date,
		as_of_date,
		record_count,
		source_system_id,
		off_coverage_form,
		off_coverage_type,
		off_risk_type,
		on_coverage_form,
		on_coverage_type,
		on_risk_type,
		off_pol_cov_id,
		on_pol_cov_id
	FROM offset_onset_cov_stage
	WHERE offset_onset_cov_stage.off_onset_ts >= '@{pipeline().parameters.SELECTION_START_TS}'
),
EXP_Default AS (
	SELECT
	offset_onset_cov_stage_id,
	tch_claim_nbr,
	off_onset_ts,
	major_peril,
	cause_of_loss,
	reserve_cat,
	loss_disability,
	cov_eff_date,
	unit_seq_nbr,
	off_client_id,
	on_majr_peril_seq,
	off_majr_peril_seq,
	on_sar_id,
	off_sar_id,
	off_ins_line,
	off_loc_unit_num,
	off_risk_unit_grp,
	off_rsk_unt_gr_seq,
	off_risk_unit,
	off_risk_type_ind,
	off_sub_loc_num,
	off_seq_risk_unit,
	on_ins_line,
	on_loc_unit_num,
	on_risk_unit_grp,
	on_rsk_unt_gr_seq,
	on_risk_unit,
	on_risk_type_ind,
	on_sub_loc_num,
	on_seq_risk_unit,
	off_cov_eff_date,
	off_cov_exp_date,
	cov_type_cd,
	cov_seq_nbr,
	process_sta_ind,
	logical_flag,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	off_coverage_form,
	off_coverage_type,
	off_risk_type,
	on_coverage_form,
	on_coverage_type,
	on_risk_type,
	off_pol_cov_id,
	on_pol_cov_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AUDIT_ID_OP
	FROM SQ_offset_onset_cov_stage
),
arch_offset_onset_cov_stage AS (
	INSERT INTO arch_offset_onset_cov_stage
	(offset_onset_cov_stage_id, tch_claim_nbr, off_onset_ts, major_peril, cause_of_loss, reserve_cat, loss_disability, cov_eff_date, unit_seq_nbr, off_client_id, on_majr_peril_seq, off_majr_peril_seq, on_sar_id, off_sar_id, off_ins_line, off_loc_unit_num, off_risk_unit_grp, off_rsk_unt_gr_seq, off_risk_unit, off_risk_type_ind, off_sub_loc_num, off_seq_risk_unit, on_ins_line, on_loc_unit_num, on_risk_unit_grp, on_rsk_unt_gr_seq, on_risk_unit, on_risk_type_ind, on_sub_loc_num, on_seq_risk_unit, off_cov_eff_date, off_cov_exp_date, cov_type_cd, cov_seq_nbr, process_sta_ind, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id, off_coverage_form, off_coverage_type, off_risk_type, on_coverage_form, on_coverage_type, on_risk_type, off_pol_cov_id, on_pol_cov_id)
	SELECT 
	OFFSET_ONSET_COV_STAGE_ID, 
	TCH_CLAIM_NBR, 
	OFF_ONSET_TS, 
	MAJOR_PERIL, 
	CAUSE_OF_LOSS, 
	RESERVE_CAT, 
	LOSS_DISABILITY, 
	COV_EFF_DATE, 
	UNIT_SEQ_NBR, 
	OFF_CLIENT_ID, 
	ON_MAJR_PERIL_SEQ, 
	OFF_MAJR_PERIL_SEQ, 
	ON_SAR_ID, 
	OFF_SAR_ID, 
	OFF_INS_LINE, 
	OFF_LOC_UNIT_NUM, 
	OFF_RISK_UNIT_GRP, 
	OFF_RSK_UNT_GR_SEQ, 
	OFF_RISK_UNIT, 
	OFF_RISK_TYPE_IND, 
	OFF_SUB_LOC_NUM, 
	OFF_SEQ_RISK_UNIT, 
	ON_INS_LINE, 
	ON_LOC_UNIT_NUM, 
	ON_RISK_UNIT_GRP, 
	ON_RSK_UNT_GR_SEQ, 
	ON_RISK_UNIT, 
	ON_RISK_TYPE_IND, 
	ON_SUB_LOC_NUM, 
	ON_SEQ_RISK_UNIT, 
	OFF_COV_EFF_DATE, 
	OFF_COV_EXP_DATE, 
	COV_TYPE_CD, 
	COV_SEQ_NBR, 
	PROCESS_STA_IND, 
	LOGICAL_FLAG, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	o_AUDIT_ID_OP AS AUDIT_ID, 
	OFF_COVERAGE_FORM, 
	OFF_COVERAGE_TYPE, 
	OFF_RISK_TYPE, 
	ON_COVERAGE_FORM, 
	ON_COVERAGE_TYPE, 
	ON_RISK_TYPE, 
	OFF_POL_COV_ID, 
	ON_POL_COV_ID
	FROM EXP_Default
),