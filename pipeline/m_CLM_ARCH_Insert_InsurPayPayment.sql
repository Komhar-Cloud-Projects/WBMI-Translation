WITH
SQ_InsurPayPaymentStage AS (
	SELECT
		InsurPayPaymentStageId,
		ExtractDate,
		SourceSystemId,
		InsurPayPaymentId,
		ExceedDraftNumber,
		InsurPayBatchId,
		InsurPayTrackingNumber,
		InsurPayStatus,
		PaymentCashedDate,
		PaymentMethod,
		OFACSubmittedTimestamp,
		FlaggedByOFAC,
		StopPayRequestedTime,
		CreatedUserId,
		CreatedDate,
		ModifiedUserId,
		ModifiedDate,
		CheckNumber,
		AccountNumberLast4Digit,
		PaidDate,
		PaymentType,
		StopPayRequestedUser,
		UploadAttemptCount,
		SupPaymentWorkflowId,
		LateInsurPayStatusNotifiedTimestamp,
		ExpediteRequested,
		CertifiedRequested,
		AdditionalDocumentsMessageRequested,
		MailTrackingNumber,
		LateExpeditedPaymentNotifiedTimestamp,
		LateExpeditedPaymentReceivedNotifiedTimestamp,
		AttachedDocumentCount
	FROM InsurPayPaymentStage
),
EXPTRANS AS (
	SELECT
	InsurPayPaymentStageId,
	ExtractDate,
	SourceSystemId,
	InsurPayPaymentId,
	ExceedDraftNumber,
	InsurPayBatchId,
	InsurPayTrackingNumber,
	InsurPayStatus,
	PaymentCashedDate,
	PaymentMethod,
	OFACSubmittedTimestamp,
	FlaggedByOFAC,
	StopPayRequestedTime,
	CreatedUserId,
	CreatedDate,
	ModifiedUserId,
	ModifiedDate,
	CheckNumber,
	AccountNumberLast4Digit,
	PaidDate,
	PaymentType,
	StopPayRequestedUser,
	UploadAttemptCount,
	SupPaymentWorkflowId,
	LateInsurPayStatusNotifiedTimestamp,
	ExpediteRequested,
	CertifiedRequested,
	AdditionalDocumentsMessageRequested,
	MailTrackingNumber,
	LateExpeditedPaymentNotifiedTimestamp,
	LateExpeditedPaymentReceivedNotifiedTimestamp,
	AttachedDocumentCount,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId
	FROM SQ_InsurPayPaymentStage
),
ArchInsurPayPaymentStage AS (
	INSERT INTO ArchInsurPayPaymentStage
	(AuditId, InsurPayPaymentStageId, ExtractDate, SourceSystemId, InsurPayPaymentId, ExceedDraftNumber, InsurPayBatchId, InsurPayTrackingNumber, InsurPayStatus, PaymentCashedDate, PaymentMethod, OFACSubmittedTimestamp, FlaggedByOFAC, StopPayRequestedTime, CreatedUserId, CreatedDate, ModifiedUserId, ModifiedDate, CheckNumber, AccountNumberLast4Digit, PaidDate, PaymentType, StopPayRequestedUser, UploadAttemptCount, SupPaymentWorkflowId, LateInsurPayStatusNotifiedTimestamp, ExpediteRequested, CertifiedRequested, AdditionalDocumentsMessageRequested, MailTrackingNumber, LateExpeditedPaymentNotifiedTimestamp, LateExpeditedPaymentReceivedNotifiedTimestamp, AttachedDocumentCount)
	SELECT 
	AUDITID, 
	INSURPAYPAYMENTSTAGEID, 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	INSURPAYPAYMENTID, 
	EXCEEDDRAFTNUMBER, 
	INSURPAYBATCHID, 
	INSURPAYTRACKINGNUMBER, 
	INSURPAYSTATUS, 
	PAYMENTCASHEDDATE, 
	PAYMENTMETHOD, 
	OFACSUBMITTEDTIMESTAMP, 
	FLAGGEDBYOFAC, 
	STOPPAYREQUESTEDTIME, 
	CREATEDUSERID, 
	CREATEDDATE, 
	MODIFIEDUSERID, 
	MODIFIEDDATE, 
	CHECKNUMBER, 
	ACCOUNTNUMBERLAST4DIGIT, 
	PAIDDATE, 
	PAYMENTTYPE, 
	STOPPAYREQUESTEDUSER, 
	UPLOADATTEMPTCOUNT, 
	SUPPAYMENTWORKFLOWID, 
	LATEINSURPAYSTATUSNOTIFIEDTIMESTAMP, 
	EXPEDITEREQUESTED, 
	CERTIFIEDREQUESTED, 
	ADDITIONALDOCUMENTSMESSAGEREQUESTED, 
	MAILTRACKINGNUMBER, 
	LATEEXPEDITEDPAYMENTNOTIFIEDTIMESTAMP, 
	LATEEXPEDITEDPAYMENTRECEIVEDNOTIFIEDTIMESTAMP, 
	ATTACHEDDOCUMENTCOUNT
	FROM EXPTRANS
),