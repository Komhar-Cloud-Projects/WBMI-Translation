{
    "name": "s_m_POL_ExampleIDO_ARCH_Insert_ArchDCCACoveragePIPStage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_ARCH_Insert_ArchDCCACoveragePIPStage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_DCCACoveragePIPStage AS (\n\tSELECT\n\t\tDCCACoveragePIPStageId,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tCoverageId,\n\t\tCA_CoveragePIPId,\n\t\tSessionId,\n\t\tAccDeathBenDescription,\n\t\tAccDeathBenOtherDescription,\n\t\tAdditionalChiropractic,\n\t\tAdditionalCombinationLimitIndicator,\n\t\tAdditionalLimit,\n\t\tAdditionalLimitPA,\n\t\tAlternativeCare,\n\t\tApplyPIPDeductible,\n\t\tAutoDealersOptions,\n\t\tBroadened,\n\t\tBroadenedPIP,\n\t\tCoordinationOfBenefits,\n\t\tDeductibleOnly,\n\t\tEmployeeOperated,\n\t\tEmployeeOperatedOrWorkersComp,\n\t\tExcessMedical,\n\t\tExcessWorkLoss,\n\t\tExclusionOfWorkLossIndicator,\n\t\tExclustionOfWorkLoss,\n\t\tExtendedPIP,\n\t\tFamilyMembers,\n\t\tFurnished,\n\t\tGovernmentSponsored,\n\t\tGuestPIP,\n\t\tIncreasedLimits,\n\t\tInterstateBasis,\n\t\tManagedCare,\n\t\tMedicalExpenseBenefit,\n\t\tMedicalExpenseElimination,\n\t\tMedicalExpensesDescription,\n\t\tMedicalExpensesOtherDescription,\n\t\tNamedFamily,\n\t\tNamedFamilyMembers,\n\t\tNamedInsuredOnly,\n\t\tNumberOfFamilyMembers,\n\t\tNumberOfNamedIndividuals,\n\t\tNumberOfResidentRelatives,\n\t\tOptionalBasicEconomicLoss,\n\t\tOwnerOperated,\n\t\tPedestrianFirstParty,\n\t\tPedestrianOnly,\n\t\tPIPWaiver,\n\t\tResidentChildren,\n\t\tStackedPIP,\n\t\tTortLimitationElimination,\n\t\tTortMedicalExpenseSecondaryOption,\n\t\tTXPIPAutoDescription,\n\t\tTXPIPAutoOtherDescription,\n\t\tUnderwriterOverride,\n\t\tWorkComp,\n\t\tWorkCompAndEmployeeOperated,\n\t\tWorkLossAndADB,\n\t\tWorkLossCoordination,\n\t\tWorkLossDescription,\n\t\tWorkLossOtherDescription\n\tFROM DCCACoveragePIPStage\n),\nEXP_Set_MetaData AS (\n\tSELECT\n\tDCCACoveragePIPStageId,\n\tExtractDate,\n\tSourceSystemId,\n\tCoverageId,\n\tCA_CoveragePIPId,\n\tSessionId,\n\tAccDeathBenDescription,\n\tAccDeathBenOtherDescription,\n\tAdditionalChiropractic AS i_AdditionalChiropractic,\n\t-- *INF*: DECODE(i_AdditionalChiropractic,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_AdditionalChiropractic,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_AdditionalChiropractic,\n\tAdditionalCombinationLimitIndicator AS i_AdditionalCombinationLimitIndicator,\n\t-- *INF*: DECODE(i_AdditionalCombinationLimitIndicator,'T','1','F','0')\n\tDECODE(\n\t    i_AdditionalCombinationLimitIndicator,\n\t    'T', '1',\n\t    'F', '0'\n\t) AS o_AdditionalCombinationLimitIndicator,\n\tAdditionalLimit AS i_AdditionalLimit,\n\t-- *INF*: DECODE(i_AdditionalLimit,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_AdditionalLimit,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_AdditionalLimit,\n\tAdditionalLimitPA AS i_AdditionalLimitPA,\n\t-- *INF*: DECODE(i_AdditionalLimitPA,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_AdditionalLimitPA,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_AdditionalLimitPA,\n\tAlternativeCare AS i_AlternativeCare,\n\t-- *INF*: DECODE(i_AlternativeCare,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_AlternativeCare,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_AlternativeCare,\n\tApplyPIPDeductible,\n\tAutoDealersOptions,\n\tBroadened AS i_Broadened,\n\t-- *INF*: DECODE(i_Broadened,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_Broadened,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_Broadened,\n\tBroadenedPIP AS i_BroadenedPIP,\n\t-- *INF*: DECODE(i_BroadenedPIP,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_BroadenedPIP,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_BroadenedPIP,\n\tCoordinationOfBenefits,\n\tDeductibleOnly AS i_DeductibleOnly,\n\t-- *INF*: DECODE(i_DeductibleOnly,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_DeductibleOnly,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_DeductibleOnly,\n\tEmployeeOperated AS i_EmployeeOperated,\n\t-- *INF*: DECODE(i_EmployeeOperated,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_EmployeeOperated,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_EmployeeOperated,\n\tEmployeeOperatedOrWorkersComp AS i_EmployeeOperatedOrWorkersComp,\n\t-- *INF*: DECODE(i_EmployeeOperatedOrWorkersComp,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_EmployeeOperatedOrWorkersComp,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_EmployeeOperatedOrWorkersComp,\n\tExcessMedical AS i_ExcessMedical,\n\t-- *INF*: DECODE(i_ExcessMedical,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_ExcessMedical,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ExcessMedical,\n\tExcessWorkLoss AS i_ExcessWorkLoss,\n\t-- *INF*: DECODE(i_ExcessWorkLoss,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_ExcessWorkLoss,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ExcessWorkLoss,\n\tExclusionOfWorkLossIndicator AS i_ExclusionOfWorkLossIndicator,\n\t-- *INF*: DECODE(i_ExclusionOfWorkLossIndicator,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_ExclusionOfWorkLossIndicator,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ExclusionOfWorkLossIndicator,\n\tExclustionOfWorkLoss,\n\tExtendedPIP,\n\tFamilyMembers AS i_FamilyMembers,\n\t-- *INF*: DECODE(i_FamilyMembers,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_FamilyMembers,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_FamilyMembers,\n\tFurnished AS i_Furnished,\n\t-- *INF*: DECODE(i_Furnished,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_Furnished,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_Furnished,\n\tGovernmentSponsored AS i_GovernmentSponsored,\n\t-- *INF*: DECODE(i_GovernmentSponsored,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_GovernmentSponsored,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_GovernmentSponsored,\n\tGuestPIP AS i_GuestPIP,\n\t-- *INF*: DECODE(i_GuestPIP,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_GuestPIP,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_GuestPIP,\n\tIncreasedLimits AS i_IncreasedLimits,\n\t-- *INF*: DECODE(i_IncreasedLimits,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_IncreasedLimits,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_IncreasedLimits,\n\tInterstateBasis AS i_InterstateBasis,\n\t-- *INF*: DECODE(i_InterstateBasis,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_InterstateBasis,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_InterstateBasis,\n\tManagedCare AS i_ManagedCare,\n\t-- *INF*: DECODE(i_ManagedCare,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_ManagedCare,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ManagedCare,\n\tMedicalExpenseBenefit AS i_MedicalExpenseBenefit,\n\t-- *INF*: DECODE(i_MedicalExpenseBenefit,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_MedicalExpenseBenefit,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_MedicalExpenseBenefit,\n\tMedicalExpenseElimination AS i_MedicalExpenseElimination,\n\t-- *INF*: DECODE(i_MedicalExpenseElimination,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_MedicalExpenseElimination,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_MedicalExpenseElimination,\n\tMedicalExpensesDescription,\n\tMedicalExpensesOtherDescription,\n\tNamedFamily,\n\tNamedFamilyMembers,\n\tNamedInsuredOnly AS i_NamedInsuredOnly,\n\t-- *INF*: DECODE(i_NamedInsuredOnly,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_NamedInsuredOnly,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_NamedInsuredOnly,\n\tNumberOfFamilyMembers,\n\tNumberOfNamedIndividuals,\n\tNumberOfResidentRelatives,\n\tOptionalBasicEconomicLoss AS i_OptionalBasicEconomicLoss,\n\t-- *INF*: DECODE(i_OptionalBasicEconomicLoss,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_OptionalBasicEconomicLoss,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_OptionalBasicEconomicLoss,\n\tOwnerOperated AS i_OwnerOperated,\n\t-- *INF*: DECODE(i_OwnerOperated,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_OwnerOperated,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_OwnerOperated,\n\tPedestrianFirstParty AS i_PedestrianFirstParty,\n\t-- *INF*: DECODE(i_PedestrianFirstParty,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_PedestrianFirstParty,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_PedestrianFirstParty,\n\tPedestrianOnly AS i_PedestrianOnly,\n\t-- *INF*: DECODE(i_PedestrianOnly,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_PedestrianOnly,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_PedestrianOnly,\n\tPIPWaiver AS i_PIPWaiver,\n\t-- *INF*: DECODE(i_PIPWaiver,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_PIPWaiver,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_PIPWaiver,\n\tResidentChildren AS i_ResidentChildren,\n\t-- *INF*: DECODE(i_ResidentChildren,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_ResidentChildren,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_ResidentChildren,\n\tStackedPIP AS i_StackedPIP,\n\t-- *INF*: DECODE(i_StackedPIP,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_StackedPIP,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_StackedPIP,\n\tTortLimitationElimination AS i_TortLimitationElimination,\n\t-- *INF*: DECODE(i_TortLimitationElimination,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_TortLimitationElimination,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_TortLimitationElimination,\n\tTortMedicalExpenseSecondaryOption AS i_TortMedicalExpenseSecondaryOption,\n\t-- *INF*: DECODE(i_TortMedicalExpenseSecondaryOption,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_TortMedicalExpenseSecondaryOption,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_TortMedicalExpenseSecondaryOption,\n\tTXPIPAutoDescription,\n\tTXPIPAutoOtherDescription,\n\tUnderwriterOverride AS i_UnderwriterOverride,\n\t-- *INF*: DECODE(i_UnderwriterOverride,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_UnderwriterOverride,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_UnderwriterOverride,\n\tWorkComp AS i_WorkComp,\n\t-- *INF*: DECODE(i_WorkComp,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_WorkComp,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_WorkComp,\n\tWorkCompAndEmployeeOperated AS i_WorkCompAndEmployeeOperated,\n\t-- *INF*: DECODE(i_WorkCompAndEmployeeOperated,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_WorkCompAndEmployeeOperated,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_WorkCompAndEmployeeOperated,\n\tWorkLossAndADB,\n\tWorkLossCoordination AS i_WorkLossCoordination,\n\t-- *INF*: DECODE(i_WorkLossCoordination,'T','1','F','0',NULL)\n\tDECODE(\n\t    i_WorkLossCoordination,\n\t    'T', '1',\n\t    'F', '0',\n\t    NULL\n\t) AS o_WorkLossCoordination,\n\tWorkLossDescription,\n\tWorkLossOtherDescription,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_DCCACoveragePIPStage\n),\nArchDCCACoveragePIPStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchDCCACoveragePIPStage\n\t(ExtractDate, SourceSystemId, AuditId, DCCACoveragePIPStageId, CoverageId, CA_CoveragePIPId, SessionId, AccDeathBenDescription, AccDeathBenOtherDescription, AdditionalChiropractic, AdditionalCombinationLimitIndicator, AdditionalLimit, AdditionalLimitPA, AlternativeCare, ApplyPIPDeductible, AutoDealersOptions, Broadened, BroadenedPIP, CoordinationOfBenefits, DeductibleOnly, EmployeeOperated, EmployeeOperatedOrWorkersComp, ExcessMedical, ExcessWorkLoss, ExclusionOfWorkLossIndicator, ExclustionOfWorkLoss, ExtendedPIP, FamilyMembers, Furnished, GovernmentSponsored, GuestPIP, IncreasedLimits, InterstateBasis, ManagedCare, MedicalExpenseBenefit, MedicalExpenseElimination, MedicalExpensesDescription, MedicalExpensesOtherDescription, NamedFamily, NamedFamilyMembers, NamedInsuredOnly, NumberOfFamilyMembers, NumberOfNamedIndividuals, NumberOfResidentRelatives, OptionalBasicEconomicLoss, OwnerOperated, PedestrianFirstParty, PedestrianOnly, PIPWaiver, ResidentChildren, StackedPIP, TortLimitationElimination, TortMedicalExpenseSecondaryOption, TXPIPAutoDescription, TXPIPAutoOtherDescription, UnderwriterOverride, WorkComp, WorkCompAndEmployeeOperated, WorkLossAndADB, WorkLossCoordination, WorkLossDescription, WorkLossOtherDescription)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID, \n\tDCCACOVERAGEPIPSTAGEID, \n\tCOVERAGEID, \n\tCA_COVERAGEPIPID, \n\tSESSIONID, \n\tACCDEATHBENDESCRIPTION, \n\tACCDEATHBENOTHERDESCRIPTION, \n\to_AdditionalChiropractic AS ADDITIONALCHIROPRACTIC, \n\to_AdditionalCombinationLimitIndicator AS ADDITIONALCOMBINATIONLIMITINDICATOR, \n\to_AdditionalLimit AS ADDITIONALLIMIT, \n\to_AdditionalLimitPA AS ADDITIONALLIMITPA, \n\to_AlternativeCare AS ALTERNATIVECARE, \n\tAPPLYPIPDEDUCTIBLE, \n\tAUTODEALERSOPTIONS, \n\to_Broadened AS BROADENED, \n\to_BroadenedPIP AS BROADENEDPIP, \n\tCOORDINATIONOFBENEFITS, \n\to_DeductibleOnly AS DEDUCTIBLEONLY, \n\to_EmployeeOperated AS EMPLOYEEOPERATED, \n\to_EmployeeOperatedOrWorkersComp AS EMPLOYEEOPERATEDORWORKERSCOMP, \n\to_ExcessMedical AS EXCESSMEDICAL, \n\to_ExcessWorkLoss AS EXCESSWORKLOSS, \n\to_ExclusionOfWorkLossIndicator AS EXCLUSIONOFWORKLOSSINDICATOR, \n\tEXCLUSTIONOFWORKLOSS, \n\tEXTENDEDPIP, \n\to_FamilyMembers AS FAMILYMEMBERS, \n\to_Furnished AS FURNISHED, \n\to_GovernmentSponsored AS GOVERNMENTSPONSORED, \n\to_GuestPIP AS GUESTPIP, \n\to_IncreasedLimits AS INCREASEDLIMITS, \n\to_InterstateBasis AS INTERSTATEBASIS, \n\to_ManagedCare AS MANAGEDCARE, \n\to_MedicalExpenseBenefit AS MEDICALEXPENSEBENEFIT, \n\to_MedicalExpenseElimination AS MEDICALEXPENSEELIMINATION, \n\tMEDICALEXPENSESDESCRIPTION, \n\tMEDICALEXPENSESOTHERDESCRIPTION, \n\tNAMEDFAMILY, \n\tNAMEDFAMILYMEMBERS, \n\to_NamedInsuredOnly AS NAMEDINSUREDONLY, \n\tNUMBEROFFAMILYMEMBERS, \n\tNUMBEROFNAMEDINDIVIDUALS, \n\tNUMBEROFRESIDENTRELATIVES, \n\to_OptionalBasicEconomicLoss AS OPTIONALBASICECONOMICLOSS, \n\to_OwnerOperated AS OWNEROPERATED, \n\to_PedestrianFirstParty AS PEDESTRIANFIRSTPARTY, \n\to_PedestrianOnly AS PEDESTRIANONLY, \n\to_PIPWaiver AS PIPWAIVER, \n\to_ResidentChildren AS RESIDENTCHILDREN, \n\to_StackedPIP AS STACKEDPIP, \n\to_TortLimitationElimination AS TORTLIMITATIONELIMINATION, \n\to_TortMedicalExpenseSecondaryOption AS TORTMEDICALEXPENSESECONDARYOPTION, \n\tTXPIPAUTODESCRIPTION, \n\tTXPIPAUTOOTHERDESCRIPTION, \n\to_UnderwriterOverride AS UNDERWRITEROVERRIDE, \n\to_WorkComp AS WORKCOMP, \n\to_WorkCompAndEmployeeOperated AS WORKCOMPANDEMPLOYEEOPERATED, \n\tWORKLOSSANDADB, \n\to_WorkLossCoordination AS WORKLOSSCOORDINATION, \n\tWORKLOSSDESCRIPTION, \n\tWORKLOSSOTHERDESCRIPTION\n\tFROM EXP_Set_MetaData\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}