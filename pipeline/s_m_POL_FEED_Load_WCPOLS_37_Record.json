{
    "name": "s_m_POL_FEED_Load_WCPOLS_37_Record",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_37_Record",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_SupWCPOLS AS (\n\tSELECT\n\tWCPOLSCode,\n\tSourcesystemID,\n\tSourceCode,\n\tTableName,\n\tProcessName,\n\ti_SourcesystemID,\n\ti_SourceCode,\n\ti_TableName,\n\ti_ProcessName\n\tFROM (\n\t\tSELECT\r\n\t\t     WCPOLSCode as WCPOLSCode\r\n\t\t\t,SourcesystemID as SourcesystemID\r\n\t\t\t,SourceCode as SourceCode\r\n\t\t\t,TableName as TableName\r\n\t\t\t,ProcessName as ProcessName\r\n\t\tFROM SupWCPOLS\r\n\t\tWHERE CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SourcesystemID,SourceCode,TableName,ProcessName ORDER BY WCPOLSCode) = 1\n),\nSQ_WCPOLS_37_Record AS (\n\tSELECT distinct\r\n\t\tST.WCTrackHistoryID\r\n\t\t,F.FormName\r\n\t\t,PT.Name\r\n\t\t,Pol.TransactionEffectiveDate\r\n\t\t,PDSP.NameOfSoleProprietorIncluded\r\n\t\t,PDSP.IncludedSolePropState\r\n\t    ,PDP.NameOfPartnersIncluded\r\n\t\t,PDP.IncludedPartnersState\r\n\t\t,PDOFF.NameOfOfficersIncluded\r\n\t\t,PDOFF.IncludedOfficersState\r\n\t\t,PDOTH.NameOfOthersIncluded\r\n\t\t,PDOTH.IncludedOthersState\r\n\t\r\n\tFROM dbo.WorkWCStateTerm ST\r\n\t\r\n\tINNER JOIN dbo.WorkWCForms F\r\n\t\tON ST.WCTrackHistoryID = F.WCTrackHistoryID\r\n\tAND F.FormName like 'WC000310%'AND (F.OnPolicy=1 or F.[Add]=1) AND (F.Remove is NULL or F.Remove=0)\r\n\t\r\n\tINNER JOIN dbo.WorkWCParty PT\r\n\t\tON PT.WCTrackHistoryID = ST.WCTrackHistoryID\r\n\t\t\tAND PT.PartyAssociationType = 'Account'\r\n\t\r\n\tINNER JOIN dbo.WorkWCPolicy Pol\r\n\t\tON Pol.WCTrackHistoryID = ST.WCTrackHistoryID \r\n\t\r\n\tLEFT JOIN \r\n\t(Select SPName.WCTrackHistoryID,SPName.Value as NameOfSoleProprietorIncluded,SPState.Value as IncludedSolePropState,SPName.ProcessID from \r\n\tdbo.WorkWCPolicyDetails SPName\r\n\tINNER JOIN WorkWCPolicyDetails SPState\r\n\t\tON SPName.WCTrackHistoryID = SPState.WCTrackHistoryID \r\n\t\tAND SPName.ProcessID=SPState.ProcessID\r\n\t\tAND SPName.PolicyID=SPState.PolicyID\r\n\t\tAND SPName.Attribute='NameOfSoleProprietorIncluded'\r\n\t\tAND SPState.Attribute='IncludedSolePropState'\r\n\t)PDSP\r\n\tON PDSP.WCTrackHistoryID = ST.WCTrackHistoryID \r\n\t\r\n\tLEFT JOIN \r\n\t(Select PName.WCTrackHistoryID,PName.Value as NameOfPartnersIncluded,PState.Value as IncludedPartnersState,PName.ProcessID from \r\n\tdbo.WorkWCPolicyDetails PName\r\n\tINNER JOIN WorkWCPolicyDetails PState\r\n\t\tON PName.WCTrackHistoryID = PState.WCTrackHistoryID \r\n\t\tAND PName.ProcessID=PState.ProcessID\r\n\t\tAND PName.PolicyID=PState.PolicyID\r\n\t\tAND PName.Attribute='NameOfPartnersIncluded'\r\n\t\tAND PState.Attribute='IncludedPartnersState'\r\n\t)PDP\r\n\tON PDP.WCTrackHistoryID = ST.WCTrackHistoryID \r\n\t\r\n\tLEFT JOIN \r\n\t(Select OFFName.WCTrackHistoryID,OFFName.Value as NameOfOfficersIncluded,OFFState.Value as IncludedOfficersState,OFFName.ProcessID from \r\n\tdbo.WorkWCPolicyDetails OFFName\r\n\tINNER JOIN WorkWCPolicyDetails OFFState\r\n\t\tON OFFName.WCTrackHistoryID = OFFState.WCTrackHistoryID \r\n\t\tAND OFFName.ProcessID=OFFState.ProcessID\r\n\t\tAND OFFName.PolicyID=OFFState.PolicyID\r\n\t\tAND OFFName.Attribute='NameOfOfficersIncluded'\r\n\t\tAND OFFState.Attribute='IncludedOfficersState'\r\n\t)PDOFF\r\n\tON PDOFF.WCTrackHistoryID = ST.WCTrackHistoryID \r\n\t\r\n\tLEFT JOIN \r\n\t(Select OTHName.WCTrackHistoryID,OTHName.Value as NameOfOthersIncluded,OTHState.Value as IncludedOthersState,OTHName.ProcessID from \r\n\tdbo.WorkWCPolicyDetails OTHName\r\n\tINNER JOIN WorkWCPolicyDetails OTHState\r\n\t\tON OTHName.WCTrackHistoryID = OTHState.WCTrackHistoryID \r\n\t\tAND OTHName.ProcessID=OTHState.ProcessID\r\n\t\tAND OTHName.PolicyID=OTHState.PolicyID\r\n\t\tAND OTHName.Attribute='NameOfOthersIncluded'\r\n\t\tAND OTHState.Attribute='IncludedOthersState'\r\n\t)PDOTH\r\n\tON PDOTH.WCTrackHistoryID = ST.WCTrackHistoryID \r\n\t\r\n\tWHERE 1 = 1\r\n\tAND ST.AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tAND (PDSP.NameOfSoleProprietorIncluded IS NOT NULL OR PDP.NameOfPartnersIncluded IS NOT NULL \r\n\tOR PDOFF.NameOfOfficersIncluded IS NOT NULL OR PDOTH.NameOfOthersIncluded IS NOT NULL)\r\n\t@{pipeline().parameters.WHERE_CLAUSE_37}\r\n\t\r\n\tORDER BY ST.WCTrackHistoryID\n),\nEXP_StateLogic AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tFormName,\n\tName,\n\tTransactionEffectiveDate,\n\tNameOfSoleProprietorIncluded,\n\tIncludedSolePropState AS IN_IncludedSolePropState,\n\t-- *INF*:  IIF(IsNull(:LKP.LKP_SupWCPOLS('DCT',IN_IncludedSolePropState,'WCPOLS37Record','StateCodeRecord37')),'',:LKP.LKP_SupWCPOLS('DCT',IN_IncludedSolePropState,'WCPOLS37Record','StateCodeRecord37'))\n\tIFF(\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode IS NULL,\n\t    '',\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode\n\t) AS O_IncludedSolePropState,\n\tNameOfPartnersIncluded,\n\tIncludedPartnersState AS IN_IncludedPartnersState,\n\t-- *INF*:  IIF(IsNull(:LKP.LKP_SupWCPOLS('DCT',IN_IncludedPartnersState,'WCPOLS37Record','StateCodeRecord37')),'',:LKP.LKP_SupWCPOLS('DCT',IN_IncludedPartnersState,'WCPOLS37Record','StateCodeRecord37'))\n\tIFF(\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode IS NULL,\n\t    '',\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode\n\t) AS O_IncludedPartnersState,\n\tNameOfOfficersIncluded,\n\tIncludedOfficersState AS IN_IncludedOfficersState,\n\t-- *INF*:  IIF(IsNull(:LKP.LKP_SupWCPOLS('DCT',IN_IncludedOfficersState,'WCPOLS37Record','StateCodeRecord37')),'',:LKP.LKP_SupWCPOLS('DCT',IN_IncludedOfficersState,'WCPOLS37Record','StateCodeRecord37'))\n\tIFF(\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode IS NULL,\n\t    '',\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode\n\t) AS O_IncludedOfficersState,\n\tNameOfOthersIncluded,\n\tIncludedOthersState AS IN_IncludedOthersState,\n\t-- *INF*:  IIF(IsNull(:LKP.LKP_SupWCPOLS('DCT',IN_IncludedOthersState,'WCPOLS37Record','StateCodeRecord37')),'',:LKP.LKP_SupWCPOLS('DCT',IN_IncludedOthersState,'WCPOLS37Record','StateCodeRecord37'))\n\tIFF(\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode IS NULL,\n\t    '',\n\t    LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.WCPOLSCode\n\t) AS O_IncludedOthersState\n\tFROM SQ_WCPOLS_37_Record\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37\n\tON LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.SourceCode = IN_IncludedSolePropState\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.TableName = 'WCPOLS37Record'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedSolePropState_WCPOLS37Record_StateCodeRecord37.ProcessName = 'StateCodeRecord37'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37\n\tON LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.SourceCode = IN_IncludedPartnersState\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.TableName = 'WCPOLS37Record'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedPartnersState_WCPOLS37Record_StateCodeRecord37.ProcessName = 'StateCodeRecord37'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37\n\tON LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.SourceCode = IN_IncludedOfficersState\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.TableName = 'WCPOLS37Record'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOfficersState_WCPOLS37Record_StateCodeRecord37.ProcessName = 'StateCodeRecord37'\n\n\tLEFT JOIN LKP_SUPWCPOLS LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37\n\tON LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.SourcesystemID = 'DCT'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.SourceCode = IN_IncludedOthersState\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.TableName = 'WCPOLS37Record'\n\tAND LKP_SUPWCPOLS__DCT_IN_IncludedOthersState_WCPOLS37Record_StateCodeRecord37.ProcessName = 'StateCodeRecord37'\n\n),\nSQ_WCPols00Record AS (\n\tSELECT\r\n\t\tWCTrackHistoryID,\r\n\t\tLinkData,\r\n\t     AuditId\r\n\t\tFROM dbo.WCPols00Record\r\n\tWHERE 1=1\r\n\tAND AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tORDER BY WCTrackHistoryID\n),\nJNR_WCPols_37_Record AS (SELECT\n\tSQ_WCPols00Record.WCTrackHistoryID, \n\tSQ_WCPols00Record.AuditId, \n\tSQ_WCPols00Record.LinkData, \n\tEXP_StateLogic.WCTrackHistoryID AS WCTrackHistoryID1, \n\tEXP_StateLogic.FormName, \n\tEXP_StateLogic.Name, \n\tEXP_StateLogic.TransactionEffectiveDate, \n\tEXP_StateLogic.NameOfSoleProprietorIncluded, \n\tEXP_StateLogic.O_IncludedSolePropState AS IncludedSolePropState, \n\tEXP_StateLogic.NameOfPartnersIncluded, \n\tEXP_StateLogic.O_IncludedPartnersState AS IncludedPartnersState, \n\tEXP_StateLogic.NameOfOfficersIncluded, \n\tEXP_StateLogic.O_IncludedOfficersState AS IncludedOfficersState, \n\tEXP_StateLogic.NameOfOthersIncluded, \n\tEXP_StateLogic.O_IncludedOthersState AS IncludedOthersState\n\tFROM SQ_WCPols00Record\n\tINNER JOIN EXP_StateLogic\n\tON EXP_StateLogic.WCTrackHistoryID = SQ_WCPols00Record.WCTrackHistoryID\n),\nmplt_Parse_FormNameField AS (WITH\n\tINPUT_FormName AS (\n\t\t\n\t),\n\tEXPTRANS AS (\n\t\tSELECT\n\t\tParsedNameOfForm,\n\t\tFormNameFromSource,\n\t\t-- *INF*: REVERSE(FormNameFromSource)\n\t\tREVERSE(FormNameFromSource) AS vReversedFromNameFromSource,\n\t\t-- *INF*: REVERSE(substr(vReversedFromNameFromSource,1,4))\n\t\tREVERSE(substr(vReversedFromNameFromSource, 1, 4)) AS vFormEdition,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- substr(vReversedFromNameFromSource,5,1) >='A' and substr(vReversedFromNameFromSource,5,1) <='Z', substr(vReversedFromNameFromSource,5,1),\r\n\t\t-- ' '\r\n\t\t-- )\r\n\t\t-- \r\n\t\t-- -- check if within A and Z, if not then space\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    substr(vReversedFromNameFromSource, 5, 1) >= 'A' and substr(vReversedFromNameFromSource, 5, 1) <= 'Z', substr(vReversedFromNameFromSource, 5, 1),\n\t\t    ' '\n\t\t) AS vBureauCode,\n\t\tvFormEdition AS oFormEdition,\n\t\tvBureauCode AS oBureauCode\n\t\tFROM INPUT_FormName\n\t),\n\tOUTPUT_FormName AS (\n\t\tSELECT\n\t\tParsedNameOfForm, \n\t\tFormNameFromSource, \n\t\toFormEdition AS FormEdition, \n\t\toBureauCode AS BureauCode\n\t\tFROM EXPTRANS\n\t),\n),\nEXP_Counter AS (\n\tSELECT\n\tSYSDATE AS ExtractDate,\n\tJNR_WCPols_37_Record.AuditId,\n\tJNR_WCPols_37_Record.WCTrackHistoryID,\n\tJNR_WCPols_37_Record.LinkData,\n\t'37' AS RecordTypeCode,\n\t'WC000310' AS EndorsementNumber,\n\tmplt_Parse_FormNameField.BureauCode,\n\tmplt_Parse_FormNameField.FormEdition,\n\tJNR_WCPols_37_Record.Name,\n\tJNR_WCPols_37_Record.TransactionEffectiveDate,\n\t-- *INF*: TO_CHAR(TransactionEffectiveDate,'YYMMDD')\r\n\t-- \n\tTO_CHAR(TransactionEffectiveDate, 'YYMMDD') AS o_TransactionEffectiveDate,\n\tJNR_WCPols_37_Record.NameOfSoleProprietorIncluded,\n\t-- *INF*: IIF(INSTR(NameOfSoleProprietorIncluded,'(',1,1)>0,\r\n\t-- SUBSTR(NameOfSoleProprietorIncluded,1,INSTR(NameOfSoleProprietorIncluded,'(',1,1)-1),NameOfSoleProprietorIncluded)\n\tIFF(\n\t    REGEXP_INSTR(NameOfSoleProprietorIncluded, '(', 1, 1) > 0,\n\t    SUBSTR(NameOfSoleProprietorIncluded, 1, REGEXP_INSTR(NameOfSoleProprietorIncluded, '(', 1, 1) - 1),\n\t    NameOfSoleProprietorIncluded\n\t) AS v_NameOfSoleProprietorIncluded,\n\tJNR_WCPols_37_Record.IncludedSolePropState,\n\tJNR_WCPols_37_Record.NameOfPartnersIncluded,\n\t-- *INF*: IIF(INSTR(NameOfPartnersIncluded,'(',1,1)>0,\r\n\t-- SUBSTR(NameOfPartnersIncluded,1,INSTR(NameOfPartnersIncluded,'(',1,1)-1),NameOfPartnersIncluded)\n\tIFF(\n\t    REGEXP_INSTR(NameOfPartnersIncluded, '(', 1, 1) > 0,\n\t    SUBSTR(NameOfPartnersIncluded, 1, REGEXP_INSTR(NameOfPartnersIncluded, '(', 1, 1) - 1),\n\t    NameOfPartnersIncluded\n\t) AS v_NameOfPartnersIncluded,\n\tJNR_WCPols_37_Record.IncludedPartnersState,\n\tJNR_WCPols_37_Record.NameOfOfficersIncluded,\n\t-- *INF*: IIF(INSTR(NameOfOfficersIncluded,'(',1,1)>0,\r\n\t-- SUBSTR(NameOfOfficersIncluded,1,INSTR(NameOfOfficersIncluded,'(',1,1)-1),NameOfOfficersIncluded)\n\tIFF(\n\t    REGEXP_INSTR(NameOfOfficersIncluded, '(', 1, 1) > 0,\n\t    SUBSTR(NameOfOfficersIncluded, 1, REGEXP_INSTR(NameOfOfficersIncluded, '(', 1, 1) - 1),\n\t    NameOfOfficersIncluded\n\t) AS v_NameOfOfficersIncluded,\n\tJNR_WCPols_37_Record.IncludedOfficersState,\n\tJNR_WCPols_37_Record.NameOfOthersIncluded,\n\t-- *INF*: IIF(INSTR(NameOfOthersIncluded,'(',1,1)>0,\r\n\t-- SUBSTR(NameOfOthersIncluded,1,INSTR(NameOfOthersIncluded,'(',1,1)-1),NameOfOthersIncluded)\n\tIFF(\n\t    REGEXP_INSTR(NameOfOthersIncluded, '(', 1, 1) > 0,\n\t    SUBSTR(NameOfOthersIncluded, 1, REGEXP_INSTR(NameOfOthersIncluded, '(', 1, 1) - 1),\n\t    NameOfOthersIncluded\n\t) AS v_NameOfOthersIncluded,\n\tJNR_WCPols_37_Record.IncludedOthersState,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ((NOT ISNULL(NameOfSoleProprietorIncluded) AND LTRIM(RTRIM(NameOfSoleProprietorIncluded))<>'') OR (NOT ISNULL(IncludedSolePropState) AND LTRIM(RTRIM(IncludedSolePropState))<>'')),'S',\r\n\t-- ((NOT ISNULL(NameOfPartnersIncluded) AND LTRIM(RTRIM(NameOfPartnersIncluded))<>'') OR (NOT ISNULL(IncludedPartnersState) AND LTRIM(RTRIM(IncludedPartnersState))<>'')),'P',\r\n\t-- ((NOT ISNULL(NameOfOfficersIncluded) AND LTRIM(RTRIM(NameOfOfficersIncluded))<>'') OR (NOT ISNULL(IncludedOfficersState) AND LTRIM(RTRIM(IncludedOfficersState))<>'')),'O',\r\n\t-- ((NOT ISNULL(NameOfOthersIncluded) AND LTRIM(RTRIM(NameOfOthersIncluded))<>'') OR (NOT ISNULL(IncludedOthersState) AND LTRIM(RTRIM(IncludedOthersState))<>'')),'X',\r\n\t-- '')\n\tDECODE(\n\t    TRUE,\n\t    ((NameOfSoleProprietorIncluded IS NULL AND LTRIM(RTRIM(NameOfSoleProprietorIncluded)) <NOT > '') OR (IncludedSolePropState IS NULL AND LTRIM(RTRIM(IncludedSolePropState)) <NOT > '')), 'S',\n\t    ((NameOfPartnersIncluded IS NULL AND LTRIM(RTRIM(NameOfPartnersIncluded)) <NOT > '') OR (IncludedPartnersState IS NULL AND LTRIM(RTRIM(IncludedPartnersState)) <NOT > '')), 'P',\n\t    ((NameOfOfficersIncluded IS NULL AND LTRIM(RTRIM(NameOfOfficersIncluded)) <NOT > '') OR (IncludedOfficersState IS NULL AND LTRIM(RTRIM(IncludedOfficersState)) <NOT > '')), 'O',\n\t    ((NameOfOthersIncluded IS NULL AND LTRIM(RTRIM(NameOfOthersIncluded)) <NOT > '') OR (IncludedOthersState IS NULL AND LTRIM(RTRIM(IncludedOthersState)) <NOT > '')), 'X',\n\t    ''\n\t) AS DescriptorCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- (NOT ISNULL(v_NameOfSoleProprietorIncluded) AND LTRIM(RTRIM(v_NameOfSoleProprietorIncluded))<>'') ,LTRIM(RTRIM(v_NameOfSoleProprietorIncluded)),\r\n\t-- (NOT ISNULL(v_NameOfPartnersIncluded) AND LTRIM(RTRIM(v_NameOfPartnersIncluded))<>'') ,LTRIM(RTRIM(v_NameOfPartnersIncluded)),\r\n\t-- (NOT ISNULL(v_NameOfOfficersIncluded) AND LTRIM(RTRIM(v_NameOfOfficersIncluded))<>'') ,LTRIM(RTRIM(v_NameOfOfficersIncluded)),\r\n\t-- (NOT ISNULL(v_NameOfOthersIncluded) AND LTRIM(RTRIM(v_NameOfOthersIncluded))<>'') ,LTRIM(RTRIM(v_NameOfOthersIncluded)),\r\n\t-- '')\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    (v_NameOfSoleProprietorIncluded IS NULL AND LTRIM(RTRIM(v_NameOfSoleProprietorIncluded)) <NOT > ''), LTRIM(RTRIM(v_NameOfSoleProprietorIncluded)),\n\t    (v_NameOfPartnersIncluded IS NULL AND LTRIM(RTRIM(v_NameOfPartnersIncluded)) <NOT > ''), LTRIM(RTRIM(v_NameOfPartnersIncluded)),\n\t    (v_NameOfOfficersIncluded IS NULL AND LTRIM(RTRIM(v_NameOfOfficersIncluded)) <NOT > ''), LTRIM(RTRIM(v_NameOfOfficersIncluded)),\n\t    (v_NameOfOthersIncluded IS NULL AND LTRIM(RTRIM(v_NameOfOthersIncluded)) <NOT > ''), LTRIM(RTRIM(v_NameOfOthersIncluded)),\n\t    ''\n\t) AS NameOfPersonToBeIncluded,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- (NOT ISNULL(IncludedSolePropState) AND LTRIM(RTRIM(IncludedSolePropState))<>''),LTRIM(RTRIM(IncludedSolePropState)),\r\n\t-- (NOT ISNULL(IncludedPartnersState) AND LTRIM(RTRIM(IncludedPartnersState))<>''),LTRIM(RTRIM(IncludedPartnersState)),\r\n\t-- (NOT ISNULL(IncludedOfficersState) AND LTRIM(RTRIM(IncludedOfficersState))<>''),LTRIM(RTRIM(IncludedOfficersState)),\r\n\t-- (NOT ISNULL(IncludedOthersState) AND LTRIM(RTRIM(IncludedOthersState))<>''),LTRIM(RTRIM(IncludedOthersState)),\r\n\t-- '')\n\tDECODE(\n\t    TRUE,\n\t    (IncludedSolePropState IS NULL AND LTRIM(RTRIM(IncludedSolePropState)) <NOT > ''), LTRIM(RTRIM(IncludedSolePropState)),\n\t    (IncludedPartnersState IS NULL AND LTRIM(RTRIM(IncludedPartnersState)) <NOT > ''), LTRIM(RTRIM(IncludedPartnersState)),\n\t    (IncludedOfficersState IS NULL AND LTRIM(RTRIM(IncludedOfficersState)) <NOT > ''), LTRIM(RTRIM(IncludedOfficersState)),\n\t    (IncludedOthersState IS NULL AND LTRIM(RTRIM(IncludedOthersState)) <NOT > ''), LTRIM(RTRIM(IncludedOthersState)),\n\t    ''\n\t) AS StateCode,\n\tWCTrackHistoryID AS v_CurrentRecord,\n\t-- *INF*: IIF(v_CurrentRecord<>v_PreviousRecord,0,1)\n\tIFF(v_CurrentRecord <> v_PreviousRecord, 0, 1) AS v_ChangeFlag,\n\tWCTrackHistoryID AS v_PreviousRecord,\n\t-- *INF*: IIF(v_ChangeFlag=1,v_Counter+1,1)\n\tIFF(v_ChangeFlag = 1, v_Counter + 1, 1) AS v_Counter,\n\t-- *INF*: MOD(v_Counter,3)\n\tMOD(v_Counter, 3) AS Split,\n\t-- *INF*: CEIL(v_Counter/3)\n\tCEIL(v_Counter / 3) AS GroupKey\n\tFROM JNR_WCPols_37_Record\n\t -- Manually join with mplt_Parse_FormNameField\n),\nEXP_Split AS (\n\tSELECT\n\tExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tRecordTypeCode,\n\tEndorsementNumber,\n\tBureauCode,\n\tFormEdition,\n\tName,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate,\n\tDescriptorCode,\n\tNameOfPersonToBeIncluded,\n\tStateCode,\n\tSplit,\n\tGroupKey,\n\t-- *INF*: IIF(Split=1,DescriptorCode,'')\n\tIFF(Split = 1, DescriptorCode, '') AS O_DescriptorCode,\n\t-- *INF*: IIF(Split=1,NameOfPersonToBeIncluded,'')\n\tIFF(Split = 1, NameOfPersonToBeIncluded, '') AS O_NameOfPersonToBeIncluded,\n\t-- *INF*: IIF(Split=1,StateCode,'')\n\tIFF(Split = 1, StateCode, '') AS O_StateCode,\n\t-- *INF*: IIF(Split=2,DescriptorCode,'')\n\tIFF(Split = 2, DescriptorCode, '') AS O_DescriptorCode2,\n\t-- *INF*: IIF(Split=2,NameOfPersonToBeIncluded,'')\n\tIFF(Split = 2, NameOfPersonToBeIncluded, '') AS O_NameOfPersonToBeIncluded2,\n\t-- *INF*: IIF(Split=2,StateCode,'')\n\tIFF(Split = 2, StateCode, '') AS O_StateCode2,\n\t-- *INF*: IIF(Split=0,DescriptorCode,'')\n\tIFF(Split = 0, DescriptorCode, '') AS O_DescriptorCode3,\n\t-- *INF*: IIF(Split=0,NameOfPersonToBeIncluded,'')\n\tIFF(Split = 0, NameOfPersonToBeIncluded, '') AS O_NameOfPersonToBeIncluded3,\n\t-- *INF*: IIF(Split=0,StateCode,'')\n\tIFF(Split = 0, StateCode, '') AS O_StateCode3\n\tFROM EXP_Counter\n),\nAGG_GroupData AS (\n\tSELECT\n\tExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tRecordTypeCode,\n\tEndorsementNumber,\n\tBureauCode,\n\tFormEdition,\n\tSplit,\n\tGroupKey,\n\tO_DescriptorCode AS IN_DescriptorCode,\n\tO_NameOfPersonToBeIncluded AS IN_NameOfPersonToBeIncluded,\n\tO_StateCode AS IN_StateCode,\n\tO_DescriptorCode2 AS IN_DescriptorCode2,\n\tO_NameOfPersonToBeIncluded2 AS IN_NameOfPersonToBeIncluded2,\n\tO_StateCode2 AS IN_StateCode2,\n\tO_DescriptorCode3 AS IN_DescriptorCode3,\n\tO_NameOfPersonToBeIncluded3 AS IN_NameOfPersonToBeIncluded3,\n\tO_StateCode3 AS IN_StateCode3,\n\t-- *INF*: MAX(IN_DescriptorCode)\n\tMAX(IN_DescriptorCode) AS DescriptorCode,\n\t-- *INF*: MAX(IN_NameOfPersonToBeIncluded)\n\tMAX(IN_NameOfPersonToBeIncluded) AS NameOfPersonToBeIncluded,\n\t-- *INF*: MAX(IN_StateCode)\n\tMAX(IN_StateCode) AS StateCode,\n\t-- *INF*: MAX(IN_DescriptorCode2)\n\tMAX(IN_DescriptorCode2) AS DescriptorCode2,\n\t-- *INF*: MAX(IN_NameOfPersonToBeIncluded2)\n\tMAX(IN_NameOfPersonToBeIncluded2) AS NameOfPersonToBeIncluded2,\n\t-- *INF*: MAX(IN_StateCode2)\n\tMAX(IN_StateCode2) AS StateCode2,\n\t-- *INF*: MAX(IN_DescriptorCode3)\n\tMAX(IN_DescriptorCode3) AS DescriptorCode3,\n\t-- *INF*: MAX(IN_NameOfPersonToBeIncluded3)\n\tMAX(IN_NameOfPersonToBeIncluded3) AS NameOfPersonToBeIncluded3,\n\t-- *INF*: MAX(IN_StateCode3)\n\tMAX(IN_StateCode3) AS StateCode3,\n\tName,\n\tTransactionEffectiveDate\n\tFROM EXP_Split\n\tGROUP BY WCTrackHistoryID, GroupKey\n),\nEXP_Target AS (\n\tSELECT\n\tExtractDate,\n\tAuditId,\n\tWCTrackHistoryID,\n\tLinkData,\n\tRecordTypeCode,\n\tEndorsementNumber,\n\tBureauCode,\n\tFormEdition,\n\tDescriptorCode,\n\tNameOfPersonToBeIncluded,\n\tStateCode,\n\tDescriptorCode2,\n\tNameOfPersonToBeIncluded2,\n\tStateCode2,\n\tDescriptorCode3,\n\tNameOfPersonToBeIncluded3,\n\tStateCode3,\n\tName,\n\tTransactionEffectiveDate\n\tFROM AGG_GroupData\n),\nWCPols37Record AS (\n\tINSERT INTO WCPols37Record\n\t(ExtractDate, AuditId, WCTrackHistoryID, LinkData, RecordTypeCode, EndorsementNumber, BureauVersionIdentifierEditionIdentifier, CarrierVersionIdentifier, DescriptorCode, NameOfPersonToBeIncluded, StateCode, DescriptorCode2, NameOfPersonToBeIncluded2, StateCode2, DescriptorCode3, NameOfPersonToBeIncluded3, StateCode3, NameOfInsured, EndorsementEffectiveDate)\n\tSELECT \n\tEXTRACTDATE, \n\tAUDITID, \n\tWCTRACKHISTORYID, \n\tLINKDATA, \n\tRECORDTYPECODE, \n\tENDORSEMENTNUMBER, \n\tBureauCode AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER, \n\tFormEdition AS CARRIERVERSIONIDENTIFIER, \n\tDESCRIPTORCODE, \n\tNAMEOFPERSONTOBEINCLUDED, \n\tSTATECODE, \n\tDESCRIPTORCODE2, \n\tNAMEOFPERSONTOBEINCLUDED2, \n\tSTATECODE2, \n\tDESCRIPTORCODE3, \n\tNAMEOFPERSONTOBEINCLUDED3, \n\tSTATECODE3, \n\tName AS NAMEOFINSURED, \n\tTransactionEffectiveDate AS ENDORSEMENTEFFECTIVEDATE\n\tFROM EXP_Target\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_37": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}