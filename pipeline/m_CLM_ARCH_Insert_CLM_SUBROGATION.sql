WITH
SQ_clm_subrogation_stage AS (
	SELECT
		clm_subrogation_stage_id,
		tch_claim_nbr,
		tch_claimant_id,
		object_type_cd,
		object_seq_nbr,
		cov_type_cd,
		cov_seq_nbr,
		bur_cause_loss,
		insd_deduct,
		ref_subro_dt,
		general_comment,
		install_reached,
		amt_of_agreement,
		install_amt_month,
		start_pmt_dt,
		update_ts,
		update_user_id,
		create_ts,
		create_user_id,
		closure_date,
		subro_rep_clt_id,
		subro_mgr_clt_id,
		referring_adj_id,
		file_status,
		deduct_has_been,
		extract_date,
		as_of_date,
		record_count,
		source_system_id
	FROM clm_subrogation_stage
),
EXP_get_values AS (
	SELECT
	clm_subrogation_stage_id,
	tch_claim_nbr,
	tch_claimant_id,
	object_type_cd,
	object_seq_nbr,
	cov_type_cd,
	cov_seq_nbr,
	bur_cause_loss,
	insd_deduct,
	ref_subro_dt,
	general_comment,
	install_reached,
	amt_of_agreement,
	install_amt_month,
	start_pmt_dt,
	update_ts,
	update_user_id,
	create_ts,
	create_user_id,
	closure_date,
	subro_rep_clt_id,
	subro_mgr_clt_id,
	referring_adj_id,
	file_status,
	deduct_has_been,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id
	FROM SQ_clm_subrogation_stage
),
arch_clm_subrogation_stage AS (
	INSERT INTO arch_clm_subrogation_stage
	(clm_subrogation_stage_id, tch_claim_nbr, tch_claimant_id, object_type_cd, object_seq_nbr, cov_type_cd, cov_seq_nbr, bur_cause_loss, insd_deduct, ref_subro_dt, general_comment, install_reached, amt_of_agreement, install_amt_month, start_pmt_dt, update_ts, update_user_id, create_ts, create_user_id, closure_date, subro_rep_clt_id, subro_mgr_clt_id, referring_adj_id, file_status, deduct_has_been, extract_date, as_of_date, record_count, source_system_id)
	SELECT 
	CLM_SUBROGATION_STAGE_ID, 
	TCH_CLAIM_NBR, 
	TCH_CLAIMANT_ID, 
	OBJECT_TYPE_CD, 
	OBJECT_SEQ_NBR, 
	COV_TYPE_CD, 
	COV_SEQ_NBR, 
	BUR_CAUSE_LOSS, 
	INSD_DEDUCT, 
	REF_SUBRO_DT, 
	GENERAL_COMMENT, 
	INSTALL_REACHED, 
	AMT_OF_AGREEMENT, 
	INSTALL_AMT_MONTH, 
	START_PMT_DT, 
	UPDATE_TS, 
	UPDATE_USER_ID, 
	CREATE_TS, 
	CREATE_USER_ID, 
	CLOSURE_DATE, 
	SUBRO_REP_CLT_ID, 
	SUBRO_MGR_CLT_ID, 
	REFERRING_ADJ_ID, 
	FILE_STATUS, 
	DEDUCT_HAS_BEEN, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID
	FROM EXP_get_values
),