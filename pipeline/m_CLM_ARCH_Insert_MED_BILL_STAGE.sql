WITH
SQ_med_bill_stage AS (
	SELECT
		med_bill_stage_id,
		med_bill_id,
		vendor_bill_num,
		pt_acct_num,
		pt_last_name,
		pt_first_name,
		pt_mid_name,
		pt_addr,
		pt_city,
		pt_state,
		pt_zip_code,
		pt_dob,
		pt_gndr,
		pt_ssn,
		pt_inj_dt,
		refer_physician,
		serv_from_date,
		serv_to_date,
		inpt_outpt_ind,
		bill_issued_date,
		bill_rcvd_date,
		bus_rcvd_date,
		bill_process_date,
		pt_admit_date,
		pt_discharge_date,
		daily_hospital_rt,
		bill_review_cost,
		total_bill_charge,
		total_bill_red,
		total_network_red,
		total_recom_pay,
		total_addtl_charge,
		bill_type,
		bill_status_code,
		fee_sched_code,
		network_name,
		network_num,
		serv_line_num,
		deleted_ind,
		emplyr,
		acct_id,
		vendor_code,
		extract_date,
		as_of_date,
		record_count,
		source_system_id,
		ebill_ind,
		autopay_ind,
		eor_rcvd_date,
		original_vendor_bill_num,
		auto_adjudicated
	FROM med_bill_stage
),
EXP_arch_med_bill_stage AS (
	SELECT
	med_bill_stage_id,
	med_bill_id,
	vendor_bill_num,
	pt_acct_num,
	pt_last_name,
	pt_first_name,
	pt_mid_name,
	pt_addr,
	pt_city,
	pt_state,
	pt_zip_code,
	pt_dob,
	pt_gndr,
	pt_ssn,
	pt_inj_dt,
	refer_physician,
	serv_from_date,
	serv_to_date,
	inpt_outpt_ind,
	bill_issued_date,
	bill_rcvd_date,
	bus_rcvd_date,
	bill_process_date,
	pt_admit_date,
	pt_discharge_date,
	daily_hospital_rt,
	bill_review_cost,
	total_bill_charge,
	total_bill_red,
	total_network_red,
	total_recom_pay,
	total_addtl_charge,
	bill_type,
	bill_status_code,
	fee_sched_code,
	network_name,
	network_num,
	serv_line_num,
	deleted_ind,
	emplyr,
	acct_id,
	vendor_code,
	extract_date,
	as_of_date,
	record_count,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP,
	ebill_ind,
	autopay_ind,
	eor_rcvd_date,
	original_vendor_bill_num,
	auto_adjudicated
	FROM SQ_med_bill_stage
),
arch_med_bill_stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_med_bill_stage
	(med_bill_stage_id, med_bill_id, vendor_bill_num, pt_acct_num, pt_last_name, pt_first_name, pt_mid_name, pt_addr, pt_city, pt_state, pt_zip_code, pt_dob, pt_gndr, pt_ssn, pt_inj_dt, refer_physician, serv_from_date, serv_to_date, inpt_outpt_ind, bill_issued_date, bill_rcvd_date, bus_rcvd_date, bill_process_date, pt_admit_date, pt_discharge_date, daily_hospital_rt, bill_review_cost, total_bill_charge, total_bill_red, total_network_red, total_recom_pay, total_addtl_charge, bill_type, bill_status_code, fee_sched_code, network_name, network_num, serv_line_num, deleted_ind, emplyr, acct_id, vendor_code, extract_date, as_of_date, record_count, source_system_id, audit_id, ebill_ind, autopay_ind, eor_rcvd_date, original_vendor_bill_num, auto_adjudicated)
	SELECT 
	MED_BILL_STAGE_ID, 
	MED_BILL_ID, 
	VENDOR_BILL_NUM, 
	PT_ACCT_NUM, 
	PT_LAST_NAME, 
	PT_FIRST_NAME, 
	PT_MID_NAME, 
	PT_ADDR, 
	PT_CITY, 
	PT_STATE, 
	PT_ZIP_CODE, 
	PT_DOB, 
	PT_GNDR, 
	PT_SSN, 
	PT_INJ_DT, 
	REFER_PHYSICIAN, 
	SERV_FROM_DATE, 
	SERV_TO_DATE, 
	INPT_OUTPT_IND, 
	BILL_ISSUED_DATE, 
	BILL_RCVD_DATE, 
	BUS_RCVD_DATE, 
	BILL_PROCESS_DATE, 
	PT_ADMIT_DATE, 
	PT_DISCHARGE_DATE, 
	DAILY_HOSPITAL_RT, 
	BILL_REVIEW_COST, 
	TOTAL_BILL_CHARGE, 
	TOTAL_BILL_RED, 
	TOTAL_NETWORK_RED, 
	TOTAL_RECOM_PAY, 
	TOTAL_ADDTL_CHARGE, 
	BILL_TYPE, 
	BILL_STATUS_CODE, 
	FEE_SCHED_CODE, 
	NETWORK_NAME, 
	NETWORK_NUM, 
	SERV_LINE_NUM, 
	DELETED_IND, 
	EMPLYR, 
	ACCT_ID, 
	VENDOR_CODE, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID, 
	EBILL_IND, 
	AUTOPAY_IND, 
	EOR_RCVD_DATE, 
	ORIGINAL_VENDOR_BILL_NUM, 
	AUTO_ADJUDICATED
	FROM EXP_arch_med_bill_stage
),