WITH
SQ_Pif43UZWCStage AS (
	SELECT
		Pif43UZWCStageId,
		PifSymbol,
		PifPolicyNumber,
		PifPolicyModule,
		PMDU4W1RecLength,
		PMDU4W1ActionCode,
		PMDU4W1FileID,
		PMDU4W1SegmentID,
		PMDU4W1SegmentStatus,
		PMDU4W1YearTransaction,
		PMDU4W1MonthTransaction,
		PMDU4W1DayTransaction,
		PMDU4W1SegmentLevelCode,
		PMDU4W1SegmentPartCode,
		PMDU4W1SubPartCode,
		PMDU4W1InsuranceLine,
		PMDU4W1WCRatingState,
		PMDU4W1LocationNumber,
		PMDU4W1ClassCode,
		PMDU4W1ClassCodeSeq,
		PMDU4W1SplitRateSeq,
		PMDU4W1YearItemEffective,
		PMDU4W1MonthItemEffective,
		PMDU4W1DayItemEffective,
		PMDU4W1AuditNumber,
		PMDU4W1AuditNumSeq,
		PMDU4W1YearProcess,
		PMDU4W1MonthProcess,
		PMDU4W1DayProcess,
		PMDU4W1YearItemExpire,
		PMDU4W1MonthItemExpire,
		PMDU4W1DayItemExpire,
		PMDU4W1ClassTableFlag,
		PMDU4W1ClassCodeSuffix1,
		PMDU4W1ClassCodeSuffix2,
		PMDU4W1PremiumBasisTyp,
		PMDU4W1PremiumBasisAmt,
		PMDU4W1GovernClassInd,
		PMDU4W1Rate,
		PMDU4W1RateMgInd,
		PMDU4W1ClassTermPrem,
		PMDU4W1ClassTermPrmMgInd,
		PMDU4W1ClassDescInd,
		PMDU4W1ClassDesc1St8Bytes,
		PMDU4W1ClassDescRemainder,
		PMDU4W1SicCode,
		PMDU4W1ClassDescFlag,
		PMDU4W1MinimumPremium,
		PMDU4W1MinPrmMgInd,
		PMDU4W1SurchargeAmt,
		PMDU4W1SurchargeType,
		PMDU4W1WaverPct,
		PMDU4W1WaverPctMgInd,
		PMDU4W1WaverType1,
		PMDU4W1WaiverType2,
		PMDU4W1WaivTypeMgInd,
		PMDU4W1ExposureCoverageCode1,
		PMDU4W1ExposureCoverageCode2,
		PMDU4W1ExposCodeMgInd,
		PMDU4W1SeasonalRiskInd,
		PMDU4W1LossConstant,
		PMDU4W1HazardGroup,
		PMDU4W1DepositPremium,
		PMDU4W1TaxLocation,
		PMDU4W1WaiverPremium,
		PMDU4W1SurchargePremium,
		PMDU4W1AuditSegBuiltInd,
		PMDU4W1YearRatingExpire,
		PMDU4W1MonthRatingExpire,
		PMDU4W1DayRatingExpire,
		PMDU4W1ManuallyRatedInd,
		PMDU4W1YearAnnRateDate,
		PMDU4W1MonthAnnRateDate,
		PMDU4W1DayAnnRateDate,
		PMDU4W1BureauRate,
		PMDU4W1ARatedIndicator,
		PMDU4W1PmsFutureUse,
		PMDU4W1PolicyFullMinPrem,
		PMDU4W1CustomerFutureUse,
		PMDU4W1Yr2000CustUse,
		extract_date,
		source_system_id
	FROM Pif43UZWCStage
),
EXP_ArchPif43UZWCStage AS (
	SELECT
	Pif43UZWCStageId,
	PifSymbol,
	PifPolicyNumber,
	PifPolicyModule,
	PMDU4W1RecLength,
	PMDU4W1ActionCode,
	PMDU4W1FileID,
	PMDU4W1SegmentID,
	PMDU4W1SegmentStatus,
	PMDU4W1YearTransaction,
	PMDU4W1MonthTransaction,
	PMDU4W1DayTransaction,
	PMDU4W1SegmentLevelCode,
	PMDU4W1SegmentPartCode,
	PMDU4W1SubPartCode,
	PMDU4W1InsuranceLine,
	PMDU4W1WCRatingState,
	PMDU4W1LocationNumber,
	PMDU4W1ClassCode,
	PMDU4W1ClassCodeSeq,
	PMDU4W1SplitRateSeq,
	PMDU4W1YearItemEffective,
	PMDU4W1MonthItemEffective,
	PMDU4W1DayItemEffective,
	PMDU4W1AuditNumber,
	PMDU4W1AuditNumSeq,
	PMDU4W1YearProcess,
	PMDU4W1MonthProcess,
	PMDU4W1DayProcess,
	PMDU4W1YearItemExpire,
	PMDU4W1MonthItemExpire,
	PMDU4W1DayItemExpire,
	PMDU4W1ClassTableFlag,
	PMDU4W1ClassCodeSuffix1,
	PMDU4W1ClassCodeSuffix2,
	PMDU4W1PremiumBasisTyp,
	PMDU4W1PremiumBasisAmt,
	PMDU4W1GovernClassInd,
	PMDU4W1Rate,
	PMDU4W1RateMgInd,
	PMDU4W1ClassTermPrem,
	PMDU4W1ClassTermPrmMgInd,
	PMDU4W1ClassDescInd,
	PMDU4W1ClassDesc1St8Bytes,
	PMDU4W1ClassDescRemainder,
	PMDU4W1SicCode,
	PMDU4W1ClassDescFlag,
	PMDU4W1MinimumPremium,
	PMDU4W1MinPrmMgInd,
	PMDU4W1SurchargeAmt,
	PMDU4W1SurchargeType,
	PMDU4W1WaverPct,
	PMDU4W1WaverPctMgInd,
	PMDU4W1WaverType1,
	PMDU4W1WaiverType2,
	PMDU4W1WaivTypeMgInd,
	PMDU4W1ExposureCoverageCode1,
	PMDU4W1ExposureCoverageCode2,
	PMDU4W1ExposCodeMgInd,
	PMDU4W1SeasonalRiskInd,
	PMDU4W1LossConstant,
	PMDU4W1HazardGroup,
	PMDU4W1DepositPremium,
	PMDU4W1TaxLocation,
	PMDU4W1WaiverPremium,
	PMDU4W1SurchargePremium,
	PMDU4W1AuditSegBuiltInd,
	PMDU4W1YearRatingExpire,
	PMDU4W1MonthRatingExpire,
	PMDU4W1DayRatingExpire,
	PMDU4W1ManuallyRatedInd,
	PMDU4W1YearAnnRateDate,
	PMDU4W1MonthAnnRateDate,
	PMDU4W1DayAnnRateDate,
	PMDU4W1BureauRate,
	PMDU4W1ARatedIndicator,
	PMDU4W1PmsFutureUse,
	PMDU4W1PolicyFullMinPrem,
	PMDU4W1CustomerFutureUse,
	PMDU4W1Yr2000CustUse,
	extract_date,
	source_system_id,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_auditid
	FROM SQ_Pif43UZWCStage
),
ArchPif43UZWCStage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43UZWCStage
	(Pif43UZWCStageId, PifSymbol, PifPolicyNumber, PifPolicyModule, PMDU4W1RecLength, PMDU4W1ActionCode, PMDU4W1FileID, PMDU4W1SegmentID, PMDU4W1SegmentStatus, PMDU4W1YearTransaction, PMDU4W1MonthTransaction, PMDU4W1DayTransaction, PMDU4W1SegmentLevelCode, PMDU4W1SegmentPartCode, PMDU4W1SubPartCode, PMDU4W1InsuranceLine, PMDU4W1WCRatingState, PMDU4W1LocationNumber, PMDU4W1ClassCode, PMDU4W1ClassCodeSeq, PMDU4W1SplitRateSeq, PMDU4W1YearItemEffective, PMDU4W1MonthItemEffective, PMDU4W1DayItemEffective, PMDU4W1AuditNumber, PMDU4W1AuditNumSeq, PMDU4W1YearProcess, PMDU4W1MonthProcess, PMDU4W1DayProcess, PMDU4W1YearItemExpire, PMDU4W1MonthItemExpire, PMDU4W1DayItemExpire, PMDU4W1ClassTableFlag, PMDU4W1ClassCodeSuffix1, PMDU4W1ClassCodeSuffix2, PMDU4W1PremiumBasisTyp, PMDU4W1PremiumBasisAmt, PMDU4W1GovernClassInd, PMDU4W1Rate, PMDU4W1RateMgInd, PMDU4W1ClassTermPrem, PMDU4W1ClassTermPrmMgInd, PMDU4W1ClassDescInd, PMDU4W1ClassDesc1St8Bytes, PMDU4W1ClassDescRemainder, PMDU4W1SicCode, PMDU4W1ClassDescFlag, PMDU4W1MinimumPremium, PMDU4W1MinPrmMgInd, PMDU4W1SurchargeAmt, PMDU4W1SurchargeType, PMDU4W1WaverPct, PMDU4W1WaverPctMgInd, PMDU4W1WaverType1, PMDU4W1WaiverType2, PMDU4W1WaivTypeMgInd, PMDU4W1ExposureCoverageCode1, PMDU4W1ExposureCoverageCode2, PMDU4W1ExposCodeMgInd, PMDU4W1SeasonalRiskInd, PMDU4W1LossConstant, PMDU4W1HazardGroup, PMDU4W1DepositPremium, PMDU4W1TaxLocation, PMDU4W1WaiverPremium, PMDU4W1SurchargePremium, PMDU4W1AuditSegBuiltInd, PMDU4W1YearRatingExpire, PMDU4W1MonthRatingExpire, PMDU4W1DayRatingExpire, PMDU4W1ManuallyRatedInd, PMDU4W1YearAnnRateDate, PMDU4W1MonthAnnRateDate, PMDU4W1DayAnnRateDate, PMDU4W1BureauRate, PMDU4W1ARatedIndicator, PMDU4W1PmsFutureUse, PMDU4W1PolicyFullMinPrem, PMDU4W1CustomerFutureUse, PMDU4W1Yr2000CustUse, extract_date, source_system_id, audit_id)
	SELECT 
	PIF43UZWCSTAGEID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFPOLICYMODULE, 
	PMDU4W1RECLENGTH, 
	PMDU4W1ACTIONCODE, 
	PMDU4W1FILEID, 
	PMDU4W1SEGMENTID, 
	PMDU4W1SEGMENTSTATUS, 
	PMDU4W1YEARTRANSACTION, 
	PMDU4W1MONTHTRANSACTION, 
	PMDU4W1DAYTRANSACTION, 
	PMDU4W1SEGMENTLEVELCODE, 
	PMDU4W1SEGMENTPARTCODE, 
	PMDU4W1SUBPARTCODE, 
	PMDU4W1INSURANCELINE, 
	PMDU4W1WCRATINGSTATE, 
	PMDU4W1LOCATIONNUMBER, 
	PMDU4W1CLASSCODE, 
	PMDU4W1CLASSCODESEQ, 
	PMDU4W1SPLITRATESEQ, 
	PMDU4W1YEARITEMEFFECTIVE, 
	PMDU4W1MONTHITEMEFFECTIVE, 
	PMDU4W1DAYITEMEFFECTIVE, 
	PMDU4W1AUDITNUMBER, 
	PMDU4W1AUDITNUMSEQ, 
	PMDU4W1YEARPROCESS, 
	PMDU4W1MONTHPROCESS, 
	PMDU4W1DAYPROCESS, 
	PMDU4W1YEARITEMEXPIRE, 
	PMDU4W1MONTHITEMEXPIRE, 
	PMDU4W1DAYITEMEXPIRE, 
	PMDU4W1CLASSTABLEFLAG, 
	PMDU4W1CLASSCODESUFFIX1, 
	PMDU4W1CLASSCODESUFFIX2, 
	PMDU4W1PREMIUMBASISTYP, 
	PMDU4W1PREMIUMBASISAMT, 
	PMDU4W1GOVERNCLASSIND, 
	PMDU4W1RATE, 
	PMDU4W1RATEMGIND, 
	PMDU4W1CLASSTERMPREM, 
	PMDU4W1CLASSTERMPRMMGIND, 
	PMDU4W1CLASSDESCIND, 
	PMDU4W1CLASSDESC1ST8BYTES, 
	PMDU4W1CLASSDESCREMAINDER, 
	PMDU4W1SICCODE, 
	PMDU4W1CLASSDESCFLAG, 
	PMDU4W1MINIMUMPREMIUM, 
	PMDU4W1MINPRMMGIND, 
	PMDU4W1SURCHARGEAMT, 
	PMDU4W1SURCHARGETYPE, 
	PMDU4W1WAVERPCT, 
	PMDU4W1WAVERPCTMGIND, 
	PMDU4W1WAVERTYPE1, 
	PMDU4W1WAIVERTYPE2, 
	PMDU4W1WAIVTYPEMGIND, 
	PMDU4W1EXPOSURECOVERAGECODE1, 
	PMDU4W1EXPOSURECOVERAGECODE2, 
	PMDU4W1EXPOSCODEMGIND, 
	PMDU4W1SEASONALRISKIND, 
	PMDU4W1LOSSCONSTANT, 
	PMDU4W1HAZARDGROUP, 
	PMDU4W1DEPOSITPREMIUM, 
	PMDU4W1TAXLOCATION, 
	PMDU4W1WAIVERPREMIUM, 
	PMDU4W1SURCHARGEPREMIUM, 
	PMDU4W1AUDITSEGBUILTIND, 
	PMDU4W1YEARRATINGEXPIRE, 
	PMDU4W1MONTHRATINGEXPIRE, 
	PMDU4W1DAYRATINGEXPIRE, 
	PMDU4W1MANUALLYRATEDIND, 
	PMDU4W1YEARANNRATEDATE, 
	PMDU4W1MONTHANNRATEDATE, 
	PMDU4W1DAYANNRATEDATE, 
	PMDU4W1BUREAURATE, 
	PMDU4W1ARATEDINDICATOR, 
	PMDU4W1PMSFUTUREUSE, 
	PMDU4W1POLICYFULLMINPREM, 
	PMDU4W1CUSTOMERFUTUREUSE, 
	PMDU4W1YR2000CUSTUSE, 
	EXTRACT_DATE, 
	SOURCE_SYSTEM_ID, 
	o_auditid AS AUDIT_ID
	FROM EXP_ArchPif43UZWCStage
),