WITH
SQ_Pif350Stage AS (
	SELECT
		Pif350StageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		VehicleDescriptionSegmentId,
		UnitNum,
		VehicleDescriptionSegmentNumber,
		AmendmentNumber,
		State,
		Territory,
		YearMake,
		MakeDescription,
		SerialNumber,
		TypeVehicle,
		Performance,
		Body,
		CostNew,
		Symbol,
		DriverAssigned,
		UseCode,
		MilesToWork,
		DaysPerWeek,
		AnnualMiles,
		VehicleClassCode,
		DriverClassCode,
		MultiCarOverrideIndicator,
		AntiLockDiscountIndicator,
		PipRatingBasisIndicator,
		AntiTheftDeviceIndicator,
		PassiveRestraintIndicator,
		SpecialUse,
		ZipPostalCode,
		TaxLocation,
		VehicleRatingAge,
		VehicleActualAge,
		LastChangeDateCentury,
		LastChangeDateYear,
		LastChangeDateMonth,
		LastchangeDateDay,
		CreditDateCentury,
		CreditDateYear,
		CreditDateMonth,
		CreditDateDay,
		VehicleWeight,
		CubicCentimeters,
		CommuterDiscount,
		StatedAmount,
		VehicleIdentificationNumber,
		SafeDriverDiscount,
		HomeAndHighwayModIndicator,
		CollisionClass,
		VehicleFarthestZone,
		VehicleSize,
		CommercialUse,
		Radius,
		SpecialIndustry,
		SchoolBusPolSubdiv,
		SchoolChartRegPlate,
		HADirectExcessSwitch,
		RideSharing,
		MunicipalLiabilityVolunteerWorkers,
		DriveTrainDualControl,
		SnowmobilePassengerHazard,
		RateBookIdStore,
		LeasedAutoIndicator,
		FleetIndicator,
		CededIndicator,
		RegTerrtory,
		StatTerritory,
		PackageModificationAssignment,
		PointDriver,
		PassOrFail,
		MinimumRetainedSwitch,
		Substitute,
		DefensiveDriverCreditFactor,
		DefensiveDriverCreditIndicator,
		AntiTheftFactor,
		PassiveRestraintFactor,
		GoodStudentIndicator,
		GDDIndicator,
		DTDIndicator,
		GDDFactor,
		DGDFactor,
		DGDIndicator,
		TotalOperators,
		YouthfulOperator,
		PolicyOperators,
		TotalVehicles,
		AntiLockFactor,
		NhSdipPercent,
		APCFactor,
		APCIndicator,
		WLWFactor,
		WLWIndicator,
		CDDIndicator,
		VehicleAddDate,
		CoverageRateBookId_1,
		CoverageRateBookId_2,
		CoverageRateBookId_3,
		CoverageRateBookId_4,
		CoverageRateBookId_5,
		CoverageRateBookId_6,
		CoverageRateBookId_7,
		CoverageRateBookId_8,
		CoverageRateBookId_9,
		CoverageRateBookId_10,
		CoverageRateBookId_11,
		CoverageRateBookId_12,
		CoverageRateBookId_13,
		CoverageRateBookId_14,
		PreInspInd,
		ConvertedTerritory,
		Location,
		VehicleRatingAge2,
		VehicleActualAge2,
		TerritoryManualOverride,
		MultipleTerritories,
		PmsFutureUse,
		CustomerFutureUse,
		WBMVehicleIndicator,
		MultiCarDiscountIndicator,
		VehicleDeletedIndicator,
		PrimarySecondFactor,
		AntiTheftStatHold,
		DriverDiscount1,
		DriverDiscount2,
		SecondaryFactor,
		ZipIndicator,
		CreditScoreFactor,
		Override,
		VehicleWeight2,
		MakeDescription2,
		CheckDigit,
		HoldTerritory,
		InstructorsVehicles,
		AddVehicleDateYear,
		AddVehicleDateMonth,
		AddVehicleDateDay,
		ComprehensiveSymbol,
		CollisionSymbol,
		HomeOwnForm,
		HomeOwnFactor,
		BillPlanFactor,
		CostNew7,
		StatedAmount7,
		YR2000CustomerUse,
		DuplicateKeySequenceNumber
	FROM Pif350Stage
),
EXP_Pif350Stage AS (
	SELECT
	Pif350StageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	VehicleDescriptionSegmentId,
	UnitNum,
	VehicleDescriptionSegmentNumber,
	AmendmentNumber,
	State,
	Territory,
	YearMake,
	MakeDescription,
	SerialNumber,
	TypeVehicle,
	Performance,
	Body,
	CostNew,
	Symbol,
	DriverAssigned,
	UseCode,
	MilesToWork,
	DaysPerWeek,
	AnnualMiles,
	VehicleClassCode,
	DriverClassCode,
	MultiCarOverrideIndicator,
	AntiLockDiscountIndicator,
	PipRatingBasisIndicator,
	AntiTheftDeviceIndicator,
	PassiveRestraintIndicator,
	SpecialUse,
	ZipPostalCode,
	TaxLocation,
	VehicleRatingAge,
	VehicleActualAge,
	LastChangeDateCentury,
	LastChangeDateYear,
	LastChangeDateMonth,
	LastchangeDateDay,
	CreditDateCentury,
	CreditDateYear,
	CreditDateMonth,
	CreditDateDay,
	VehicleWeight,
	CubicCentimeters,
	CommuterDiscount,
	StatedAmount,
	VehicleIdentificationNumber,
	SafeDriverDiscount,
	HomeAndHighwayModIndicator,
	CollisionClass,
	VehicleFarthestZone,
	VehicleSize,
	CommercialUse,
	Radius,
	SpecialIndustry,
	SchoolBusPolSubdiv,
	SchoolChartRegPlate,
	HADirectExcessSwitch,
	RideSharing,
	MunicipalLiabilityVolunteerWorkers,
	DriveTrainDualControl,
	SnowmobilePassengerHazard,
	RateBookIdStore,
	LeasedAutoIndicator,
	FleetIndicator,
	CededIndicator,
	RegTerrtory,
	StatTerritory,
	PackageModificationAssignment,
	PointDriver,
	PassOrFail,
	MinimumRetainedSwitch,
	Substitute,
	DefensiveDriverCreditFactor,
	DefensiveDriverCreditIndicator,
	AntiTheftFactor,
	PassiveRestraintFactor,
	GoodStudentIndicator,
	GDDIndicator,
	DTDIndicator,
	GDDFactor,
	DGDFactor,
	DGDIndicator,
	TotalOperators,
	YouthfulOperator,
	PolicyOperators,
	TotalVehicles,
	AntiLockFactor,
	NhSdipPercent,
	APCFactor,
	APCIndicator,
	WLWFactor,
	WLWIndicator,
	CDDIndicator,
	VehicleAddDate,
	CoverageRateBookId_1,
	CoverageRateBookId_2,
	CoverageRateBookId_3,
	CoverageRateBookId_4,
	CoverageRateBookId_5,
	CoverageRateBookId_6,
	CoverageRateBookId_7,
	CoverageRateBookId_8,
	CoverageRateBookId_9,
	CoverageRateBookId_10,
	CoverageRateBookId_11,
	CoverageRateBookId_12,
	CoverageRateBookId_13,
	CoverageRateBookId_14,
	PreInspInd,
	ConvertedTerritory,
	Location,
	VehicleRatingAge2,
	VehicleActualAge2,
	TerritoryManualOverride,
	MultipleTerritories,
	PmsFutureUse,
	CustomerFutureUse,
	WBMVehicleIndicator,
	MultiCarDiscountIndicator,
	VehicleDeletedIndicator,
	PrimarySecondFactor,
	AntiTheftStatHold,
	DriverDiscount1,
	DriverDiscount2,
	SecondaryFactor,
	ZipIndicator,
	CreditScoreFactor,
	Override,
	VehicleWeight2,
	MakeDescription2,
	CheckDigit,
	HoldTerritory,
	InstructorsVehicles,
	AddVehicleDateYear,
	AddVehicleDateMonth,
	AddVehicleDateDay,
	ComprehensiveSymbol,
	CollisionSymbol,
	HomeOwnForm,
	HomeOwnFactor,
	BillPlanFactor,
	CostNew7,
	StatedAmount7,
	YR2000CustomerUse,
	DuplicateKeySequenceNumber,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_Pif350Stage
),
archPif350Stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archPif350Stage
	(ExtractDate, SourceSystemid, PifSymbol, PifPolicyNumber, PifModule, VehicleDescriptionSegmentId, UnitNum, VehicleDescriptionSegmentNumber, AmendmentNumber, State, Territory, YearMake, MakeDescription, SerialNumber, TypeVehicle, Performance, Body, CostNew, Symbol, DriverAssigned, UseCode, MilesToWork, DaysPerWeek, AnnualMiles, VehicleClassCode, DriverClassCode, MultiCarOverrideIndicator, AntiLockDiscountIndicator, PipRatingBasisIndicator, AntiTheftDeviceIndicator, PassiveRestraintIndicator, SpecialUse, ZipPostalCode, TaxLocation, VehicleRatingAge, VehicleActualAge, LastChangeDateCentury, LastChangeDateYear, LastChangeDateMonth, LastchangeDateDay, CreditDateCentury, CreditDateYear, CreditDateMonth, CreditDateDay, VehicleWeight, CubicCentimeters, CommuterDiscount, StatedAmount, VehicleIdentificationNumber, SafeDriverDiscount, HomeAndHighwayModIndicator, CollisionClass, VehicleFarthestZone, VehicleSize, CommercialUse, Radius, SpecialIndustry, SchoolBusPolSubdiv, SchoolChartRegPlate, HADirectExcessSwitch, RideSharing, MunicipalLiabilityVolunteerWorkers, DriveTrainDualControl, SnowmobilePassengerHazard, RateBookIdStore, LeasedAutoIndicator, FleetIndicator, CededIndicator, RegTerrtory, StatTerritory, PackageModificationAssignment, PointDriver, PassOrFail, MinimumRetainedSwitch, Substitute, DefensiveDriverCreditFactor, DefensiveDriverCreditIndicator, AntiTheftFactor, PassiveRestraintFactor, GoodStudentIndicator, GDDIndicator, DTDIndicator, GDDFactor, DGDFactor, DGDIndicator, TotalOperators, YouthfulOperator, PolicyOperators, TotalVehicles, AntiLockFactor, NhSdipPercent, APCFactor, APCIndicator, WLWFactor, WLWIndicator, CDDIndicator, VehicleAddDate, CoverageRateBookId_1, CoverageRateBookId_2, CoverageRateBookId_3, CoverageRateBookId_4, CoverageRateBookId_5, CoverageRateBookId_6, CoverageRateBookId_7, CoverageRateBookId_8, CoverageRateBookId_9, CoverageRateBookId_10, CoverageRateBookId_11, CoverageRateBookId_12, CoverageRateBookId_13, CoverageRateBookId_14, PreInspInd, ConvertedTerritory, Location, VehicleRatingAge2, VehicleActualAge2, TerritoryManualOverride, MultipleTerritories, PmsFutureUse, CustomerFutureUse, WBMVehicleIndicator, MultiCarDiscountIndicator, VehicleDeletedIndicator, PrimarySecondFactor, AntiTheftStatHold, DriverDiscount1, DriverDiscount2, SecondaryFactor, ZipIndicator, CreditScoreFactor, Override, VehicleWeight2, MakeDescription2, CheckDigit, HoldTerritory, InstructorsVehicles, AddVehicleDateYear, AddVehicleDateMonth, AddVehicleDateDay, ComprehensiveSymbol, CollisionSymbol, HomeOwnForm, HomeOwnFactor, BillPlanFactor, CostNew7, StatedAmount7, YR2000CustomerUse, DuplicateKeySequenceNumber, AuditId)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	VEHICLEDESCRIPTIONSEGMENTID, 
	UNITNUM, 
	VEHICLEDESCRIPTIONSEGMENTNUMBER, 
	AMENDMENTNUMBER, 
	STATE, 
	TERRITORY, 
	YEARMAKE, 
	MAKEDESCRIPTION, 
	SERIALNUMBER, 
	TYPEVEHICLE, 
	PERFORMANCE, 
	BODY, 
	COSTNEW, 
	SYMBOL, 
	DRIVERASSIGNED, 
	USECODE, 
	MILESTOWORK, 
	DAYSPERWEEK, 
	ANNUALMILES, 
	VEHICLECLASSCODE, 
	DRIVERCLASSCODE, 
	MULTICAROVERRIDEINDICATOR, 
	ANTILOCKDISCOUNTINDICATOR, 
	PIPRATINGBASISINDICATOR, 
	ANTITHEFTDEVICEINDICATOR, 
	PASSIVERESTRAINTINDICATOR, 
	SPECIALUSE, 
	ZIPPOSTALCODE, 
	TAXLOCATION, 
	VEHICLERATINGAGE, 
	VEHICLEACTUALAGE, 
	LASTCHANGEDATECENTURY, 
	LASTCHANGEDATEYEAR, 
	LASTCHANGEDATEMONTH, 
	LASTCHANGEDATEDAY, 
	CREDITDATECENTURY, 
	CREDITDATEYEAR, 
	CREDITDATEMONTH, 
	CREDITDATEDAY, 
	VEHICLEWEIGHT, 
	CUBICCENTIMETERS, 
	COMMUTERDISCOUNT, 
	STATEDAMOUNT, 
	VEHICLEIDENTIFICATIONNUMBER, 
	SAFEDRIVERDISCOUNT, 
	HOMEANDHIGHWAYMODINDICATOR, 
	COLLISIONCLASS, 
	VEHICLEFARTHESTZONE, 
	VEHICLESIZE, 
	COMMERCIALUSE, 
	RADIUS, 
	SPECIALINDUSTRY, 
	SCHOOLBUSPOLSUBDIV, 
	SCHOOLCHARTREGPLATE, 
	HADIRECTEXCESSSWITCH, 
	RIDESHARING, 
	MUNICIPALLIABILITYVOLUNTEERWORKERS, 
	DRIVETRAINDUALCONTROL, 
	SNOWMOBILEPASSENGERHAZARD, 
	RATEBOOKIDSTORE, 
	LEASEDAUTOINDICATOR, 
	FLEETINDICATOR, 
	CEDEDINDICATOR, 
	REGTERRTORY, 
	STATTERRITORY, 
	PACKAGEMODIFICATIONASSIGNMENT, 
	POINTDRIVER, 
	PASSORFAIL, 
	MINIMUMRETAINEDSWITCH, 
	SUBSTITUTE, 
	DEFENSIVEDRIVERCREDITFACTOR, 
	DEFENSIVEDRIVERCREDITINDICATOR, 
	ANTITHEFTFACTOR, 
	PASSIVERESTRAINTFACTOR, 
	GOODSTUDENTINDICATOR, 
	GDDINDICATOR, 
	DTDINDICATOR, 
	GDDFACTOR, 
	DGDFACTOR, 
	DGDINDICATOR, 
	TOTALOPERATORS, 
	YOUTHFULOPERATOR, 
	POLICYOPERATORS, 
	TOTALVEHICLES, 
	ANTILOCKFACTOR, 
	NHSDIPPERCENT, 
	APCFACTOR, 
	APCINDICATOR, 
	WLWFACTOR, 
	WLWINDICATOR, 
	CDDINDICATOR, 
	VEHICLEADDDATE, 
	COVERAGERATEBOOKID_1, 
	COVERAGERATEBOOKID_2, 
	COVERAGERATEBOOKID_3, 
	COVERAGERATEBOOKID_4, 
	COVERAGERATEBOOKID_5, 
	COVERAGERATEBOOKID_6, 
	COVERAGERATEBOOKID_7, 
	COVERAGERATEBOOKID_8, 
	COVERAGERATEBOOKID_9, 
	COVERAGERATEBOOKID_10, 
	COVERAGERATEBOOKID_11, 
	COVERAGERATEBOOKID_12, 
	COVERAGERATEBOOKID_13, 
	COVERAGERATEBOOKID_14, 
	PREINSPIND, 
	CONVERTEDTERRITORY, 
	LOCATION, 
	VEHICLERATINGAGE2, 
	VEHICLEACTUALAGE2, 
	TERRITORYMANUALOVERRIDE, 
	MULTIPLETERRITORIES, 
	PMSFUTUREUSE, 
	CUSTOMERFUTUREUSE, 
	WBMVEHICLEINDICATOR, 
	MULTICARDISCOUNTINDICATOR, 
	VEHICLEDELETEDINDICATOR, 
	PRIMARYSECONDFACTOR, 
	ANTITHEFTSTATHOLD, 
	DRIVERDISCOUNT1, 
	DRIVERDISCOUNT2, 
	SECONDARYFACTOR, 
	ZIPINDICATOR, 
	CREDITSCOREFACTOR, 
	OVERRIDE, 
	VEHICLEWEIGHT2, 
	MAKEDESCRIPTION2, 
	CHECKDIGIT, 
	HOLDTERRITORY, 
	INSTRUCTORSVEHICLES, 
	ADDVEHICLEDATEYEAR, 
	ADDVEHICLEDATEMONTH, 
	ADDVEHICLEDATEDAY, 
	COMPREHENSIVESYMBOL, 
	COLLISIONSYMBOL, 
	HOMEOWNFORM, 
	HOMEOWNFACTOR, 
	BILLPLANFACTOR, 
	COSTNEW7, 
	STATEDAMOUNT7, 
	YR2000CUSTOMERUSE, 
	DUPLICATEKEYSEQUENCENUMBER, 
	o_audit_id AS AUDITID
	FROM EXP_Pif350Stage
),