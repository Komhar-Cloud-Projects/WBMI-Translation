{
    "name": "s_m_CLM_ARCH_Insert_PIF_CLMXFIL_STAGE",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_PIF_CLMXFIL_STAGE",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_pif_clmxfil_stage AS (\n\tSELECT\n\t\tpif_clmxfil_stage_id,\n\t\tclmxfil_type,\n\t\tclmxfil_policy_loc,\n\t\tclmxfil_policy_sym,\n\t\tclmxfil_policy_number,\n\t\tclmxfil_policy_mod,\n\t\tclmxfil_master_co,\n\t\tclmxfil_year_of_loss,\n\t\tclmxfil_month_of_loss,\n\t\tclmxfil_day_of_loss,\n\t\tclmxfil_occurence_number,\n\t\tclmxfil_claimant_number,\n\t\tclmxfil_insur_line,\n\t\tclmxfil_location,\n\t\tclmxfil_sub_location,\n\t\tclmxfil_risk_unit_group,\n\t\tclmxfil_class_code_grp,\n\t\tclmxfil_class_code_mem,\n\t\tclmxfil_loss_unit,\n\t\tclmxfil_seq_risk_unit,\n\t\tclmxfil_type_exposure,\n\t\tclmxfil_coverage,\n\t\tclmxfil_major_peril_seq,\n\t\tclmxfil_member,\n\t\tclmxfil_loss_disability,\n\t\tclmxfil_res_category,\n\t\tclmxfil_rein_layer,\n\t\tclmxfil_rein_id,\n\t\tclmxfil_rein_co_num,\n\t\tclmxfil_rein_broker,\n\t\tclmxfil_onset_only,\n\t\tclmxfil_d_policy_loc,\n\t\tclmxfil_d_policy_sym,\n\t\tclmxfil_d_policy_number,\n\t\tclmxfil_d_policy_mod,\n\t\tclmxfil_d_master_co,\n\t\tclmxfil_d_year_of_loss,\n\t\tclmxfil_d_month_of_loss,\n\t\tclmxfil_d_day_of_loss,\n\t\tclmxfil_d_occurence_number,\n\t\tclmxfil_d_claimant_number,\n\t\tclmxfil_d_insur_line,\n\t\tclmxfil_d_location,\n\t\tclmxfil_d_sub_location,\n\t\tclmxfil_d_risk_unit_group,\n\t\tclmxfil_d_class_code_grp,\n\t\tclmxfil_d_class_code_mem,\n\t\tclmxfil_d_loss_unit,\n\t\tclmxfil_d_seq_risk_unit,\n\t\tclmxfil_d_type_exposure,\n\t\tclmxfil_d_coverage,\n\t\tclmxfil_d_major_peril_seq,\n\t\tclmxfil_d_member,\n\t\tclmxfil_d_loss_disability,\n\t\tclmxfil_d_res_category,\n\t\tclmxfil_d_rein_layer,\n\t\tclmxfil_d_rein_id,\n\t\tclmxfil_d_rein_co_num,\n\t\tclmxfil_d_rein_broker,\n\t\tclmxfil_d_cat_code,\n\t\tclmxfil_d_loss_state,\n\t\tclmxfil_d_cause_loss,\n\t\tclmxfil_d_seg_id_from_stat,\n\t\tclmxfil_d_cov_eff_date,\n\t\tclmxfil_d_loc_num,\n\t\tclmxfil_d_lob,\n\t\tclmxfil_d_claim_office,\n\t\tclmxfil_d_claim_number,\n\t\tclmxfil_d_pass_fail_ind,\n\t\tclmxfil_activity_date,\n\t\tclmxfil_d_claim_payee,\n\t\tlogical_flag,\n\t\textract_date,\n\t\tas_of_date,\n\t\trecord_count,\n\t\tsource_system_id\n\tFROM pif_clmxfil_stage\n),\nEXP_arch_PIF_4578_stage AS (\n\tSELECT\n\tpif_clmxfil_stage_id,\n\tclmxfil_type,\n\tclmxfil_policy_loc,\n\tclmxfil_policy_sym,\n\tclmxfil_policy_number,\n\tclmxfil_policy_mod,\n\tclmxfil_master_co,\n\tclmxfil_year_of_loss,\n\tclmxfil_month_of_loss,\n\tclmxfil_day_of_loss,\n\tclmxfil_occurence_number,\n\tclmxfil_claimant_number,\n\tclmxfil_insur_line,\n\tclmxfil_location,\n\tclmxfil_sub_location,\n\tclmxfil_risk_unit_group,\n\tclmxfil_class_code_grp,\n\tclmxfil_class_code_mem,\n\tclmxfil_loss_unit,\n\tclmxfil_seq_risk_unit,\n\tclmxfil_type_exposure,\n\tclmxfil_coverage,\n\tclmxfil_major_peril_seq,\n\tclmxfil_member,\n\tclmxfil_loss_disability,\n\tclmxfil_res_category,\n\tclmxfil_rein_layer,\n\tclmxfil_rein_id,\n\tclmxfil_rein_co_num,\n\tclmxfil_rein_broker,\n\tclmxfil_onset_only,\n\tclmxfil_d_policy_loc,\n\tclmxfil_d_policy_sym,\n\tclmxfil_d_policy_number,\n\tclmxfil_d_policy_mod,\n\tclmxfil_d_master_co,\n\tclmxfil_d_year_of_loss,\n\tclmxfil_d_month_of_loss,\n\tclmxfil_d_day_of_loss,\n\tclmxfil_d_occurence_number,\n\tclmxfil_d_claimant_number,\n\tclmxfil_d_insur_line,\n\tclmxfil_d_location,\n\tclmxfil_d_sub_location,\n\tclmxfil_d_risk_unit_group,\n\tclmxfil_d_class_code_grp,\n\tclmxfil_d_class_code_mem,\n\tclmxfil_d_loss_unit,\n\tclmxfil_d_seq_risk_unit,\n\tclmxfil_d_type_exposure,\n\tclmxfil_d_coverage,\n\tclmxfil_d_major_peril_seq,\n\tclmxfil_d_member,\n\tclmxfil_d_loss_disability,\n\tclmxfil_d_res_category,\n\tclmxfil_d_rein_layer,\n\tclmxfil_d_rein_id,\n\tclmxfil_d_rein_co_num,\n\tclmxfil_d_rein_broker,\n\tclmxfil_d_cat_code,\n\tclmxfil_d_loss_state,\n\tclmxfil_d_cause_loss,\n\tclmxfil_d_seg_id_from_stat,\n\tclmxfil_d_cov_eff_date,\n\tclmxfil_d_loc_num,\n\tclmxfil_d_lob,\n\tclmxfil_d_claim_office,\n\tclmxfil_d_claim_number,\n\tclmxfil_d_pass_fail_ind,\n\tclmxfil_activity_date,\n\tclmxfil_d_claim_payee,\n\tlogical_flag,\n\textract_date,\n\tas_of_date,\n\trecord_count,\n\tsource_system_id,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_pif_clmxfil_stage\n),\narch_pif_clmxfil_stage AS (\n\tINSERT INTO arch_pif_clmxfil_stage\n\t(pif_clmxfil_stage_id, clmxfil_type, clmxfil_policy_loc, clmxfil_policy_sym, clmxfil_policy_number, clmxfil_policy_mod, clmxfil_master_co, clmxfil_year_of_loss, clmxfil_month_of_loss, clmxfil_day_of_loss, clmxfil_occurence_number, clmxfil_claimant_number, clmxfil_insur_line, clmxfil_location, clmxfil_sub_location, clmxfil_risk_unit_group, clmxfil_class_code_grp, clmxfil_class_code_mem, clmxfil_loss_unit, clmxfil_seq_risk_unit, clmxfil_type_exposure, clmxfil_coverage, clmxfil_major_peril_seq, clmxfil_member, clmxfil_loss_disability, clmxfil_res_category, clmxfil_rein_layer, clmxfil_rein_id, clmxfil_rein_co_num, clmxfil_rein_broker, clmxfil_onset_only, clmxfil_d_policy_loc, clmxfil_d_policy_sym, clmxfil_d_policy_number, clmxfil_d_policy_mod, clmxfil_d_master_co, clmxfil_d_year_of_loss, clmxfil_d_month_of_loss, clmxfil_d_day_of_loss, clmxfil_d_occurence_number, clmxfil_d_claimant_number, clmxfil_d_insur_line, clmxfil_d_location, clmxfil_d_sub_location, clmxfil_d_risk_unit_group, clmxfil_d_class_code_grp, clmxfil_d_class_code_mem, clmxfil_d_loss_unit, clmxfil_d_seq_risk_unit, clmxfil_d_type_exposure, clmxfil_d_coverage, clmxfil_d_major_peril_seq, clmxfil_d_member, clmxfil_d_loss_disability, clmxfil_d_res_category, clmxfil_d_rein_layer, clmxfil_d_rein_id, clmxfil_d_rein_co_num, clmxfil_d_rein_broker, clmxfil_d_cat_code, clmxfil_d_loss_state, clmxfil_d_cause_loss, clmxfil_d_seg_id_from_stat, clmxfil_d_cov_eff_date, clmxfil_d_loc_num, clmxfil_d_lob, clmxfil_d_claim_office, clmxfil_d_claim_number, clmxfil_d_pass_fail_ind, clmxfil_activity_date, clmxfil_d_claim_payee, logical_flag, extract_date, as_of_date, record_count, source_system_id, audit_id)\n\tSELECT \n\tPIF_CLMXFIL_STAGE_ID, \n\tCLMXFIL_TYPE, \n\tCLMXFIL_POLICY_LOC, \n\tCLMXFIL_POLICY_SYM, \n\tCLMXFIL_POLICY_NUMBER, \n\tCLMXFIL_POLICY_MOD, \n\tCLMXFIL_MASTER_CO, \n\tCLMXFIL_YEAR_OF_LOSS, \n\tCLMXFIL_MONTH_OF_LOSS, \n\tCLMXFIL_DAY_OF_LOSS, \n\tCLMXFIL_OCCURENCE_NUMBER, \n\tCLMXFIL_CLAIMANT_NUMBER, \n\tCLMXFIL_INSUR_LINE, \n\tCLMXFIL_LOCATION, \n\tCLMXFIL_SUB_LOCATION, \n\tCLMXFIL_RISK_UNIT_GROUP, \n\tCLMXFIL_CLASS_CODE_GRP, \n\tCLMXFIL_CLASS_CODE_MEM, \n\tCLMXFIL_LOSS_UNIT, \n\tCLMXFIL_SEQ_RISK_UNIT, \n\tCLMXFIL_TYPE_EXPOSURE, \n\tCLMXFIL_COVERAGE, \n\tCLMXFIL_MAJOR_PERIL_SEQ, \n\tCLMXFIL_MEMBER, \n\tCLMXFIL_LOSS_DISABILITY, \n\tCLMXFIL_RES_CATEGORY, \n\tCLMXFIL_REIN_LAYER, \n\tCLMXFIL_REIN_ID, \n\tCLMXFIL_REIN_CO_NUM, \n\tCLMXFIL_REIN_BROKER, \n\tCLMXFIL_ONSET_ONLY, \n\tCLMXFIL_D_POLICY_LOC, \n\tCLMXFIL_D_POLICY_SYM, \n\tCLMXFIL_D_POLICY_NUMBER, \n\tCLMXFIL_D_POLICY_MOD, \n\tCLMXFIL_D_MASTER_CO, \n\tCLMXFIL_D_YEAR_OF_LOSS, \n\tCLMXFIL_D_MONTH_OF_LOSS, \n\tCLMXFIL_D_DAY_OF_LOSS, \n\tCLMXFIL_D_OCCURENCE_NUMBER, \n\tCLMXFIL_D_CLAIMANT_NUMBER, \n\tCLMXFIL_D_INSUR_LINE, \n\tCLMXFIL_D_LOCATION, \n\tCLMXFIL_D_SUB_LOCATION, \n\tCLMXFIL_D_RISK_UNIT_GROUP, \n\tCLMXFIL_D_CLASS_CODE_GRP, \n\tCLMXFIL_D_CLASS_CODE_MEM, \n\tCLMXFIL_D_LOSS_UNIT, \n\tCLMXFIL_D_SEQ_RISK_UNIT, \n\tCLMXFIL_D_TYPE_EXPOSURE, \n\tCLMXFIL_D_COVERAGE, \n\tCLMXFIL_D_MAJOR_PERIL_SEQ, \n\tCLMXFIL_D_MEMBER, \n\tCLMXFIL_D_LOSS_DISABILITY, \n\tCLMXFIL_D_RES_CATEGORY, \n\tCLMXFIL_D_REIN_LAYER, \n\tCLMXFIL_D_REIN_ID, \n\tCLMXFIL_D_REIN_CO_NUM, \n\tCLMXFIL_D_REIN_BROKER, \n\tCLMXFIL_D_CAT_CODE, \n\tCLMXFIL_D_LOSS_STATE, \n\tCLMXFIL_D_CAUSE_LOSS, \n\tCLMXFIL_D_SEG_ID_FROM_STAT, \n\tCLMXFIL_D_COV_EFF_DATE, \n\tCLMXFIL_D_LOC_NUM, \n\tCLMXFIL_D_LOB, \n\tCLMXFIL_D_CLAIM_OFFICE, \n\tCLMXFIL_D_CLAIM_NUMBER, \n\tCLMXFIL_D_PASS_FAIL_IND, \n\tCLMXFIL_ACTIVITY_DATE, \n\tCLMXFIL_D_CLAIM_PAYEE, \n\tLOGICAL_FLAG, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_arch_PIF_4578_stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}