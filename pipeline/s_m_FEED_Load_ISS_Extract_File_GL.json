{
    "name": "s_m_FEED_Load_ISS_Extract_File_GL",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_ISS_Extract_File_GL",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_ISSGeneralLiabilityExtract AS (\n\tSELECT\n\t\tISSGeneralLiabilityExtractId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tEDWPremiumMasterCalculationPKId,\n\t\tEDWLossMasterCalculationPKId,\n\t\tTypeBureauCode,\n\t\tBureauLineOfInsurance,\n\t\tBureauCompanyNumber,\n\t\tStateProvinceCode,\n\t\tPremiumMasterRunDate,\n\t\tLossMasterRunDate,\n\t\tPolicyKey,\n\t\tPremiumMasterClassCode,\n\t\tLossMasterClassCode,\n\t\tClaimNumber,\n\t\tClaimantNumber,\n\t\tRiskTerritoryCode,\n\t\tPolicyEffectiveDate,\n\t\tCauseOfLoss,\n\t\tSublineCode,\n\t\tPackageModificationAdjustmentGroupDescription,\n\t\tPremiumMasterDirectWrittenPremiumAmount,\n\t\tPaidLossAmount,\n\t\tOutstandingLossAmount,\n\t\tPolicyExpirationDate,\n\t\tInceptionToDatePaidLossAmount,\n\t\tClaimantCoverageDetailId,\n\t\tAnnualStatementLineNumber,\n\t\tWrittenExposure,\n\t\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\t\tClaimlossdate,\n\t\tTypeofPolicycontract,\n\t\tClaimsEntryYear,\n\t\tPaidAllocatedlossAdjustmentExpenseAmount,\n\t\tZipPostalCode,\n\t\tTransactionEffectiveDate\n\tFROM ISSGeneralLiabilityExtract\n\tWHERE @{pipeline().parameters.WHERE_CLAUSE_GL}\n),\nEXP_CleanData_GL AS (\n\tSELECT\n\tISSGeneralLiabilityExtractId AS i_WorkISSExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tPolicyKey AS i_PolicyKey,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tClaimNumber AS i_ClaimNumber,\n\tClaimantNumber AS i_ClaimantNumber,\n\tRiskTerritoryCode AS i_RiskTerritoryCode,\n\tPolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tCauseOfLoss AS i_CauseOfLoss,\n\tSublineCode AS i_SublineCode,\n\tPackageModificationAdjustmentGroupDescription AS i_PackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tPolicyExpirationDate AS i_PolicyExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tWrittenExposure AS i_WrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount AS i_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate AS i_Claimlossdate,\n\tTypeofPolicycontract AS i_TypeofPolicycontract,\n\tClaimsEntryYear AS i_ClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount AS i_PaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode AS i_ZipPostalCode,\n\tTransactionEffectiveDate AS i_TransactionEffectiveDate,\n\ti_WorkISSExtractId AS o_WorkISSExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: LTRIM(RTRIM(i_TypeBureauCode))\n\tLTRIM(RTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: LTRIM(RTRIM(i_BureauLineOfInsurance))\n\tLTRIM(RTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\t-- *INF*: LTRIM(RTRIM(i_BureauCompanyNumber))\n\tLTRIM(RTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: LTRIM(RTRIM(i_StateProvinceCode))\n\tLTRIM(RTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyKey))\n\tLTRIM(RTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: LTRIM(RTRIM(i_PremiumMasterClassCode))\n\tLTRIM(RTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_LossMasterClassCode))\n\tLTRIM(RTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimNumber))\n\tLTRIM(RTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimantNumber))\n\tLTRIM(RTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\t-- *INF*: LTRIM(RTRIM(i_RiskTerritoryCode))\n\tLTRIM(RTRIM(i_RiskTerritoryCode)) AS o_RiskTerritoryCode,\n\ti_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: LTRIM(RTRIM(i_CauseOfLoss))\n\tLTRIM(RTRIM(i_CauseOfLoss)) AS o_CauseOfLoss,\n\t-- *INF*: LTRIM(RTRIM(i_DeductibleAmount))\n\tLTRIM(RTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: LTRIM(RTRIM(i_CoverageCode))\n\tLTRIM(RTRIM(i_CoverageCode)) AS o_CoverageCode,\n\t-- *INF*: LTRIM(RTRIM(i_ConstructionCode))\n\tLTRIM(RTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(i_ISOFireProtectionCode))\n\tLTRIM(RTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: LTRIM(RTRIM(i_SublineCode))\n\tLTRIM(RTRIM(i_SublineCode)) AS o_SublineCode,\n\t-- *INF*: LTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription))\n\tLTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription)) AS o_PackageModificationAdjustmentGroupDescription,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyForm))\n\tLTRIM(RTRIM(i_PolicyForm)) AS o_PolicyForm,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_PolicyExpirationDate AS o_PolicyExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailID,\n\ti_AnnualStatementLineNumber AS o_AnnualStatementLineNumber,\n\ti_WrittenExposure AS o_WrittenExposure,\n\ti_OutstandingAllocatedLossAdjustmentExpenseAmount AS o_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\ti_Claimlossdate AS o_Claimlossdate,\n\t-- *INF*: LTRIM(RTRIM(i_TypeofPolicycontract))\n\tLTRIM(RTRIM(i_TypeofPolicycontract)) AS o_TypeofPolicycontract,\n\ti_ClaimsEntryYear AS o_ClaimsEntryYear,\n\ti_PaidAllocatedlossAdjustmentExpenseAmount AS o_PaidAllocatedlossAdjustmentExpenseAmount,\n\ti_ZipPostalCode AS o_ZipPostalCode,\n\ti_TransactionEffectiveDate AS o_TransactionEffectiveDate\n\tFROM SQ_ISSGeneralLiabilityExtract\n),\nEXP_Target_GL AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_GL_GL'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_GL_GL' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\to_WorkISSExtractId AS WorkISSExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_PolicyKey AS PolicyKey,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_RiskTerritoryCode AS RiskTerritoryCode,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_CoverageCode AS CoverageCode,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_SublineCode AS SublineCode,\n\to_PackageModificationAdjustmentGroupDescription AS PackageModificationAdjustmentGroupDescription,\n\to_PolicyForm AS PolicyForm,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailID AS ClaimantCoverageDetailID,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_WrittenExposure AS WrittenExposure,\n\to_OutstandingAllocatedLossAdjustmentExpenseAmount AS OutstandingAllocatedLossAdjustmentExpenseAmount,\n\to_Claimlossdate AS Claimlossdate,\n\to_TypeofPolicycontract AS TypeofPolicycontract,\n\to_ClaimsEntryYear AS ClaimsEntryYear,\n\to_PaidAllocatedlossAdjustmentExpenseAmount AS PaidAllocatedlossAdjustmentExpenseAmount,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate\n\tFROM EXP_CleanData_GL\n),\nSRT_FlatFile_GL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tClaimlossdate, \n\tTypeofPolicycontract, \n\tClaimsEntryYear, \n\tWrittenExposure, \n\tPaidAllocatedlossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tZipPostalCode, \n\tTransactionEffectiveDate\n\tFROM EXP_Target_GL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_GL AS (\n\tINSERT INTO ISSFlatFile_GL\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, WrittenExposure, PaidAllocatedlossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tCLAIMLOSSDATE, \n\tTYPEOFPOLICYCONTRACT, \n\tCLAIMSENTRYYEAR, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tZIPPOSTALCODE, \n\tTRANSACTIONEFFECTIVEDATE\n\tFROM SRT_FlatFile_GL\n),\nSQ_ISSProfessionalLiabilityExtract AS (\n\tSELECT\n\t\tISSProfessionalLiabilityExtractId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tEDWPremiumMasterCalculationPKId,\n\t\tEDWLossMasterCalculationPKId,\n\t\tTypeBureauCode,\n\t\tBureauLineOfInsurance,\n\t\tBureauCompanyNumber,\n\t\tStateProvinceCode,\n\t\tPremiumMasterRunDate,\n\t\tLossMasterRunDate,\n\t\tPolicyKey,\n\t\tPremiumMasterClassCode,\n\t\tLossMasterClassCode,\n\t\tClaimNumber,\n\t\tClaimantNumber,\n\t\tRiskTerritoryCode,\n\t\tPolicyEffectiveDate,\n\t\tCauseOfLoss,\n\t\tSublineCode,\n\t\tPackageModificationAdjustmentGroupDescription,\n\t\tPremiumMasterDirectWrittenPremiumAmount,\n\t\tPaidLossAmount,\n\t\tOutstandingLossAmount,\n\t\tPolicyExpirationDate,\n\t\tInceptionToDatePaidLossAmount,\n\t\tClaimantCoverageDetailId,\n\t\tAnnualStatementLineNumber,\n\t\tWrittenExposure,\n\t\tOutstandingAllocatedLossAdjustmentExpenseAmount,\n\t\tClaimlossdate,\n\t\tTypeofPolicycontract,\n\t\tClaimsEntryYear,\n\t\tPaidAllocatedlossAdjustmentExpenseAmount,\n\t\tZipPostalCode,\n\t\tTransactionEffectiveDate\n\tFROM ISSProfessionalLiabilityExtract\n\tWHERE @{pipeline().parameters.WHERE_CLAUSE_PL}\n),\nEXP_CleanData_PL AS (\n\tSELECT\n\tISSProfessionalLiabilityExtractId AS i_WorkISSExtractId,\n\tAuditId AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tPolicyKey AS i_PolicyKey,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tClaimNumber AS i_ClaimNumber,\n\tClaimantNumber AS i_ClaimantNumber,\n\tRiskTerritoryCode AS i_RiskTerritoryCode,\n\tPolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tCauseOfLoss AS i_CauseOfLoss,\n\tSublineCode AS i_SublineCode,\n\tPackageModificationAdjustmentGroupDescription AS i_PackageModificationAdjustmentGroupDescription,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tPolicyExpirationDate AS i_PolicyExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tWrittenExposure AS i_WrittenExposure,\n\tOutstandingAllocatedLossAdjustmentExpenseAmount AS i_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\tClaimlossdate AS i_Claimlossdate,\n\tTypeofPolicycontract AS i_TypeofPolicycontract,\n\tClaimsEntryYear AS i_ClaimsEntryYear,\n\tPaidAllocatedlossAdjustmentExpenseAmount AS i_PaidAllocatedlossAdjustmentExpenseAmount,\n\tZipPostalCode AS i_ZipPostalCode,\n\tTransactionEffectiveDate AS i_TransactionEffectiveDate,\n\ti_WorkISSExtractId AS o_WorkISSExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: LTRIM(RTRIM(i_TypeBureauCode))\n\tLTRIM(RTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: LTRIM(RTRIM(i_BureauLineOfInsurance))\n\tLTRIM(RTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\t-- *INF*: LTRIM(RTRIM(i_BureauCompanyNumber))\n\tLTRIM(RTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: LTRIM(RTRIM(i_StateProvinceCode))\n\tLTRIM(RTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyKey))\n\tLTRIM(RTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: LTRIM(RTRIM(i_PremiumMasterClassCode))\n\tLTRIM(RTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_LossMasterClassCode))\n\tLTRIM(RTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimNumber))\n\tLTRIM(RTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimantNumber))\n\tLTRIM(RTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\t-- *INF*: LTRIM(RTRIM(i_RiskTerritoryCode))\n\tLTRIM(RTRIM(i_RiskTerritoryCode)) AS o_RiskTerritoryCode,\n\ti_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: LTRIM(RTRIM(i_CauseOfLoss))\n\tLTRIM(RTRIM(i_CauseOfLoss)) AS o_CauseOfLoss,\n\t-- *INF*: LTRIM(RTRIM(i_DeductibleAmount))\n\tLTRIM(RTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: LTRIM(RTRIM(i_CoverageCode))\n\tLTRIM(RTRIM(i_CoverageCode)) AS o_CoverageCode,\n\t-- *INF*: LTRIM(RTRIM(i_ConstructionCode))\n\tLTRIM(RTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(i_ISOFireProtectionCode))\n\tLTRIM(RTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: LTRIM(RTRIM(i_SublineCode))\n\tLTRIM(RTRIM(i_SublineCode)) AS o_SublineCode,\n\t-- *INF*: LTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription))\n\tLTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription)) AS o_PackageModificationAdjustmentGroupDescription,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyForm))\n\tLTRIM(RTRIM(i_PolicyForm)) AS o_PolicyForm,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_PolicyExpirationDate AS o_PolicyExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailID,\n\ti_AnnualStatementLineNumber AS o_AnnualStatementLineNumber,\n\ti_WrittenExposure AS o_WrittenExposure,\n\ti_OutstandingAllocatedLossAdjustmentExpenseAmount AS o_OutstandingAllocatedLossAdjustmentExpenseAmount,\n\ti_Claimlossdate AS o_Claimlossdate,\n\t-- *INF*: LTRIM(RTRIM(i_TypeofPolicycontract))\n\tLTRIM(RTRIM(i_TypeofPolicycontract)) AS o_TypeofPolicycontract,\n\ti_ClaimsEntryYear AS o_ClaimsEntryYear,\n\ti_PaidAllocatedlossAdjustmentExpenseAmount AS o_PaidAllocatedlossAdjustmentExpenseAmount,\n\ti_ZipPostalCode AS o_ZipPostalCode,\n\ti_TransactionEffectiveDate AS o_TransactionEffectiveDate\n\tFROM SQ_ISSProfessionalLiabilityExtract\n),\nEXP_Target_PL AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_GL_PL_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_GL_PL_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\to_WorkISSExtractId AS WorkISSExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_PolicyKey AS PolicyKey,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_RiskTerritoryCode AS RiskTerritoryCode,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_CoverageCode AS CoverageCode,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_SublineCode AS SublineCode,\n\to_PackageModificationAdjustmentGroupDescription AS PackageModificationAdjustmentGroupDescription,\n\to_PolicyForm AS PolicyForm,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailID AS ClaimantCoverageDetailID,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_WrittenExposure AS WrittenExposure,\n\to_OutstandingAllocatedLossAdjustmentExpenseAmount AS OutstandingAllocatedLossAdjustmentExpenseAmount,\n\to_Claimlossdate AS Claimlossdate,\n\to_TypeofPolicycontract AS TypeofPolicycontract,\n\to_ClaimsEntryYear AS ClaimsEntryYear,\n\to_PaidAllocatedlossAdjustmentExpenseAmount AS PaidAllocatedlossAdjustmentExpenseAmount,\n\to_ZipPostalCode AS ZipPostalCode,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate\n\tFROM EXP_CleanData_PL\n),\nSRT_FlatFile_PL AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tClaimlossdate, \n\tTypeofPolicycontract, \n\tClaimsEntryYear, \n\tWrittenExposure, \n\tPaidAllocatedlossAdjustmentExpenseAmount, \n\tOutstandingAllocatedLossAdjustmentExpenseAmount, \n\tZipPostalCode, \n\tTransactionEffectiveDate\n\tFROM EXP_Target_PL\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, AnnualStatementLineNumber ASC, ZipPostalCode ASC\n),\nISSFlatFile_PL AS (\n\tINSERT INTO ISSFlatFile_GL\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, SublineCode, PackageModificationAdjustmentGroupDescription, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, Claimlossdate, TypeofPolicycontract, ClaimsEntryYear, WrittenExposure, PaidAllocatedlossAdjustmentExpenseAmount, OutstandingAllocatedLossAdjustmentExpenseAmount, ZipPostalCode, TransactionEffectiveDate)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tCLAIMLOSSDATE, \n\tTYPEOFPOLICYCONTRACT, \n\tCLAIMSENTRYYEAR, \n\tWRITTENEXPOSURE, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tOUTSTANDINGALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tZIPPOSTALCODE, \n\tTRANSACTIONEFFECTIVEDATE\n\tFROM SRT_FlatFile_PL\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WHERE_CLAUSE_GL": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_PL": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}