{
    "name": "m_CLM_DM_LOAD_Claim_Master_1099_List_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Master_1099_List_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_claim_master_1099_list AS (\n\tSELECT \r\n\tclaim_master_1099_list.claim_master_1099_list_id, \r\n\tclaim_master_1099_list.claim_master_1099_list_ak_id, \r\n\tclaim_master_1099_list.tax_id, \r\n\tclaim_master_1099_list.irs_tax_id, \r\n\tclaim_master_1099_list.tax_id_type, \r\n\tclaim_master_1099_list.reportable_ind, \r\n\tclaim_master_1099_list.tax_levy_ind, \r\n\tclaim_master_1099_list.irs_name, \r\n\tclaim_master_1099_list.address_line_1, \r\n\tclaim_master_1099_list.address_line_2,\r\n\t claim_master_1099_list.city, \r\n\tclaim_master_1099_list.state_code, \r\n\tclaim_master_1099_list.zip_code, \r\n\tclaim_master_1099_list.country_code, \r\n\tclaim_master_1099_list.phone, \r\n\tclaim_master_1099_list.irs_1099_type, \r\n\tclaim_master_1099_list.vendor_type_code, \r\n\tclaim_master_1099_list.err_flag,\r\n\tclaim_master_1099_list.crrnt_snpsht_flag,\r\n\tclaim_master_1099_list.eff_from_date,\r\n\tclaim_master_1099_list.eff_to_date,\r\n\t claim_master_1099_list.created_date, \r\n\tclaim_master_1099_list.modified_date \r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_master_1099_list\r\n\twhere claim_master_1099_list.modified_date >= '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_claim_master_1099_list_dim AS (\n\tSELECT\n\tclaim_master_1099_list_id,\n\tclaim_master_1099_list_ak_id,\n\ttax_id AS in_tax_id,\n\t-- *INF*: LTRIM(RTRIM(in_tax_id))\n\tLTRIM(RTRIM(in_tax_id)) AS v_tax_id,\n\tv_tax_id AS out_tax_id,\n\tirs_tax_id,\n\ttax_id_type,\n\treportable_ind,\n\ttax_levy_ind,\n\tirs_name,\n\taddress_line_1,\n\taddress_line_2,\n\tcity,\n\tstate_code,\n\tzip_code,\n\tcountry_code,\n\tphone,\n\tirs_1099_type,\n\tvendor_type_code AS in_vendor_type_code,\n\t-- *INF*: ltrim(rtrim(in_vendor_type_code))\n\tltrim(rtrim(in_vendor_type_code)) AS v_vendor_code_type,\n\tv_vendor_code_type AS vendor_code_type,\n\terr_flag,\n\tcrrnt_snpsht_flag,\n\t-- *INF*: DECODE(crrnt_snpsht_flag,\r\n\t-- 'T',1,\r\n\t-- 'F',0,\r\n\t-- '1',1,\r\n\t-- '0',0,\r\n\t-- 0)\n\tDECODE(crrnt_snpsht_flag,\n\t'T', 1,\n\t'F', 0,\n\t'1', 1,\n\t'0', 0,\n\t0) AS crrnt_snpsht_flag_out,\n\teff_from_date,\n\teff_to_date,\n\tcreated_date,\n\tmodified_date\n\tFROM SQ_claim_master_1099_list\n),\nLKP_claim_master_1099_list_dim AS (\n\tSELECT\n\tclaim_master_1099_list_dim_id,\n\tedw_claim_master_1099_list_pk_id,\n\tedw_claim_master_1099_list_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_master_1099_list_dim_id,\n\t\t\tedw_claim_master_1099_list_pk_id,\n\t\t\tedw_claim_master_1099_list_ak_id\n\t\tFROM claim_master_1099_list_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_master_1099_list_pk_id,edw_claim_master_1099_list_ak_id ORDER BY claim_master_1099_list_dim_id) = 1\n),\nLKP_sup_claim_vendor_1099_type AS (\n\tSELECT\n\tvendor_type_code_descript,\n\tvendor_type_code\n\tFROM (\n\t\tSELECT \r\n\t\tsup_claim_vendor_1099_type.vendor_type_code_descript as vendor_type_code_descript, \r\n\t\tltrim(rtrim(sup_claim_vendor_1099_type.vendor_type_code)) as vendor_type_code \r\n\t\tFROM \r\n\t\tsup_claim_vendor_1099_type\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY vendor_type_code ORDER BY vendor_type_code_descript) = 1\n),\nEXP_tocheck_source AS (\n\tSELECT\n\tLKP_claim_master_1099_list_dim.claim_master_1099_list_dim_id AS LKP_claim_master_1099_list_dim_id,\n\tEXP_claim_master_1099_list_dim.claim_master_1099_list_id,\n\tEXP_claim_master_1099_list_dim.claim_master_1099_list_ak_id,\n\tEXP_claim_master_1099_list_dim.out_tax_id AS tax_id,\n\tEXP_claim_master_1099_list_dim.tax_id_type,\n\tEXP_claim_master_1099_list_dim.reportable_ind,\n\tEXP_claim_master_1099_list_dim.tax_levy_ind,\n\tEXP_claim_master_1099_list_dim.irs_name,\n\tEXP_claim_master_1099_list_dim.address_line_1,\n\tEXP_claim_master_1099_list_dim.address_line_2,\n\tEXP_claim_master_1099_list_dim.city,\n\tEXP_claim_master_1099_list_dim.state_code,\n\tEXP_claim_master_1099_list_dim.zip_code,\n\tEXP_claim_master_1099_list_dim.country_code,\n\tEXP_claim_master_1099_list_dim.phone,\n\tEXP_claim_master_1099_list_dim.irs_1099_type,\n\tEXP_claim_master_1099_list_dim.vendor_code_type,\n\tLKP_sup_claim_vendor_1099_type.vendor_type_code_descript AS in_vendor_type_code_descript,\n\t-- *INF*: iif(isnull(in_vendor_type_code_descript) or IS_SPACES(in_vendor_type_code_descript) or LENGTH(in_vendor_type_code_descript)=0,'N/A',in_vendor_type_code_descript)\n\tIFF(in_vendor_type_code_descript IS NULL OR IS_SPACES(in_vendor_type_code_descript) OR LENGTH(in_vendor_type_code_descript) = 0, 'N/A', in_vendor_type_code_descript) AS v_vendor_type_code_descript,\n\tv_vendor_type_code_descript AS vendor_type_code_descript,\n\tEXP_claim_master_1099_list_dim.err_flag,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_system_id,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\t-- *INF*: IIF(ISNULL(LKP_claim_master_1099_list_dim_id),1,0)\n\tIFF(LKP_claim_master_1099_list_dim_id IS NULL, 1, 0) AS V_LKP_claim_master_1099_list_dim_id,\n\tV_LKP_claim_master_1099_list_dim_id AS OUT_LKP_claim_master_1099_list_dim_id,\n\tEXP_claim_master_1099_list_dim.irs_tax_id,\n\tEXP_claim_master_1099_list_dim.crrnt_snpsht_flag_out AS edw_crrnt_snpsht_flag,\n\tEXP_claim_master_1099_list_dim.eff_from_date AS edw_eff_from_date,\n\tEXP_claim_master_1099_list_dim.eff_to_date AS edw_eff_to_date,\n\tEXP_claim_master_1099_list_dim.created_date AS created_date1,\n\tEXP_claim_master_1099_list_dim.modified_date AS modified_date1\n\tFROM EXP_claim_master_1099_list_dim\n\tLEFT JOIN LKP_claim_master_1099_list_dim\n\tON LKP_claim_master_1099_list_dim.edw_claim_master_1099_list_pk_id = EXP_claim_master_1099_list_dim.claim_master_1099_list_id AND LKP_claim_master_1099_list_dim.edw_claim_master_1099_list_ak_id = EXP_claim_master_1099_list_dim.claim_master_1099_list_ak_id\n\tLEFT JOIN LKP_sup_claim_vendor_1099_type\n\tON LKP_sup_claim_vendor_1099_type.vendor_type_code = EXP_claim_master_1099_list_dim.vendor_code_type\n),\nRTR_claim_master_1099_list_dim AS (\n\tSELECT\n\tLKP_claim_master_1099_list_dim_id,\n\tclaim_master_1099_list_id,\n\tclaim_master_1099_list_ak_id,\n\ttax_id,\n\ttax_id_type,\n\treportable_ind,\n\ttax_levy_ind,\n\tirs_name,\n\taddress_line_1,\n\taddress_line_2,\n\tcity,\n\tstate_code,\n\tzip_code,\n\tcountry_code,\n\tphone,\n\tirs_1099_type,\n\tvendor_code_type,\n\tvendor_type_code_descript,\n\terr_flag,\n\tedw_crrnt_snpsht_flag AS crrnt_snpsht_flag,\n\taudit_id,\n\tedw_eff_from_date AS eff_from_date,\n\tedw_eff_to_date AS eff_to_date,\n\tcreated_date1 AS created_date,\n\tmodified_date1 AS modified_date,\n\tOUT_LKP_claim_master_1099_list_dim_id,\n\tirs_tax_id\n\tFROM EXP_tocheck_source\n),\nRTR_claim_master_1099_list_dim_INSERT AS (SELECT * FROM RTR_claim_master_1099_list_dim WHERE OUT_LKP_claim_master_1099_list_dim_id=1),\nRTR_claim_master_1099_list_dim_DEFAULT1 AS (SELECT * FROM RTR_claim_master_1099_list_dim WHERE NOT ( (OUT_LKP_claim_master_1099_list_dim_id=1) )),\nTGT_claim_master_1099_list_dim_INSERT AS (\n\tINSERT INTO claim_master_1099_list_dim\n\t(edw_claim_master_1099_list_pk_id, edw_claim_master_1099_list_ak_id, tax_id, irs_tax_id, tax_id_type, reportable_ind, tax_levy_ind, irs_name, address_line_1, address_line_2, city, state_code, zip_code, country_code, phone, irs_1099_type, vendor_type_code, vendor_type_code_descript, err_flag, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date)\n\tSELECT \n\tclaim_master_1099_list_id AS EDW_CLAIM_MASTER_1099_LIST_PK_ID, \n\tclaim_master_1099_list_ak_id AS EDW_CLAIM_MASTER_1099_LIST_AK_ID, \n\tTAX_ID, \n\tIRS_TAX_ID, \n\tTAX_ID_TYPE, \n\tREPORTABLE_IND, \n\tTAX_LEVY_IND, \n\tIRS_NAME, \n\taddress_line_ AS ADDRESS_LINE_1, \n\tADDRESS_LINE_2, \n\tCITY, \n\tSTATE_CODE, \n\tZIP_CODE, \n\tCOUNTRY_CODE, \n\tPHONE, \n\tIRS_1099_TYPE, \n\tvendor_code_type AS VENDOR_TYPE_CODE, \n\tVENDOR_TYPE_CODE_DESCRIPT, \n\tERR_FLAG, \n\tCRRNT_SNPSHT_FLAG, \n\tAUDIT_ID, \n\tEFF_FROM_DATE, \n\tEFF_TO_DATE, \n\tCREATED_DATE, \n\tMODIFIED_DATE\n\tFROM RTR_claim_master_1099_list_dim_INSERT\n),\nUPD_claim_master_1099_list_dim AS (\n\tSELECT\n\tLKP_claim_master_1099_list_dim_id AS LKP_claim_master_1099_list_dim_id2, \n\tclaim_master_1099_list_id AS claim_master_1099_list_id2, \n\tclaim_master_1099_list_ak_id AS claim_master_1099_list_ak_id2, \n\ttax_id AS tax_id2, \n\ttax_id_type AS tax_id_type2, \n\treportable_ind AS reportable_ind2, \n\ttax_levy_ind AS tax_levy_ind2, \n\tirs_name AS irs_name2, \n\taddress_line_1 AS address_line_12, \n\taddress_line_ AS address_line_22, \n\tcity AS city2, \n\tstate_code AS state_code2, \n\tzip_code AS zip_code2, \n\tcountry_code AS country_code2, \n\tphone AS phone2, \n\tirs_1099_type AS irs_1099_type2, \n\tvendor_code_type AS vendor_code_type2, \n\tvendor_type_code_descript AS vendor_type_code_descript2, \n\terr_flag AS err_flag2, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag2, \n\taudit_id AS audit_id2, \n\teff_from_date AS eff_from_date2, \n\teff_to_date AS eff_to_date2, \n\tcreated_date AS created_date2, \n\tmodified_date AS modified_date2, \n\tirs_tax_id AS irs_tax_id2\n\tFROM RTR_claim_master_1099_list_dim_DEFAULT1\n),\nTGT_claim_master_1099_list_dim_UPDATE AS (\n\tMERGE INTO claim_master_1099_list_dim AS T\n\tUSING UPD_claim_master_1099_list_dim AS S\n\tON T.claim_master_1099_list_dim_id = S.LKP_claim_master_1099_list_dim_id2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.tax_id = S.tax_id2, T.irs_tax_id = S.irs_tax_id2, T.tax_id_type = S.tax_id_type2, T.reportable_ind = S.reportable_ind2, T.tax_levy_ind = S.tax_levy_ind2, T.irs_name = S.irs_name2, T.address_line_1 = S.address_line_12, T.address_line_2 = S.address_line_22, T.city = S.city2, T.state_code = S.state_code2, T.zip_code = S.zip_code2, T.country_code = S.country_code2, T.phone = S.phone2, T.irs_1099_type = S.irs_1099_type2, T.vendor_type_code = S.vendor_code_type2, T.vendor_type_code_descript = S.vendor_type_code_descript2, T.err_flag = S.err_flag2, T.crrnt_snpsht_flag = S.crrnt_snpsht_flag2, T.audit_id = S.audit_id2, T.eff_from_date = S.eff_from_date2, T.eff_to_date = S.eff_to_date2, T.created_date = S.created_date2, T.modified_date = S.modified_date2\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604499"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "PMS AND EXCEED"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}