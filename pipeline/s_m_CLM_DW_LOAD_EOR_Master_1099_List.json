{
    "name": "s_m_CLM_DW_LOAD_EOR_Master_1099_List",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DW_LOAD_EOR_Master_1099_List",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_master_1099_list_stage AS (\n\tSELECT\n\t\tmaster_1099_list_stage_id,\n\t\ttax_id,\n\t\treportable_ind,\n\t\ttax_levy_ind,\n\t\tirs_name,\n\t\taddress_line_1,\n\t\taddress_line_2,\n\t\tcity,\n\t\tstate_code,\n\t\tzip_code,\n\t\tcountry_code,\n\t\tmodified_ts,\n\t\tmodified_user_id,\n\t\tnotes,\n\t\tsearch_tax_id,\n\t\ttax_id_type,\n\t\tphone,\n\t\tlast_modified_dt,\n\t\tirs_1099_type,\n\t\tvendor_type_cd,\n\t\textract_date,\n\t\tas_of_date,\n\t\trecord_count,\n\t\tsource_system_id,\n\t\tis_valid\n\tFROM master_1099_list_stage\n\tWHERE master_1099_list_stage.is_valid in ('Y','N')\n),\nEXP_Validate_Data AS (\n\tSELECT\n\tmaster_1099_list_stage_id AS IN_master_1099_list_stage_id,\n\ttax_id AS IN_tax_id,\n\t-- *INF*: LTRIM(RTRIM(IN_tax_id))\n\tLTRIM(RTRIM(IN_tax_id\n\t\t)\n\t) AS v_tax_id_1,\n\t-- *INF*: iif(isnull(IN_tax_id)  OR length(IN_tax_id)= 0 OR IS_SPACES(IN_tax_id), '000000000',ltrim(rtrim(IN_tax_id)) )\n\tIFF(IN_tax_id IS NULL \n\t\tOR length(IN_tax_id\n\t\t) = 0 \n\t\tOR LENGTH(IN_tax_id)>0 AND TRIM(IN_tax_id)='',\n\t\t'000000000',\n\t\tltrim(rtrim(IN_tax_id\n\t\t\t)\n\t\t)\n\t) AS v_tax_id,\n\tv_tax_id AS out_tax_id,\n\treportable_ind AS IN_reportable_ind,\n\t-- *INF*: iif(isnull(IN_reportable_ind)  OR length(IN_reportable_ind)= 0 OR IS_SPACES(IN_reportable_ind), 'N/A',ltrim(rtrim(IN_reportable_ind)) )\n\tIFF(IN_reportable_ind IS NULL \n\t\tOR length(IN_reportable_ind\n\t\t) = 0 \n\t\tOR LENGTH(IN_reportable_ind)>0 AND TRIM(IN_reportable_ind)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_reportable_ind\n\t\t\t)\n\t\t)\n\t) AS v_reportable_ind,\n\tv_reportable_ind AS out_reportable_id,\n\ttax_levy_ind AS IN_tax_levy_ind,\n\t-- *INF*: iif(isnull(IN_tax_levy_ind)  OR length(IN_tax_levy_ind)= 0 OR IS_SPACES(IN_tax_levy_ind), 'N/A',ltrim(rtrim(IN_tax_levy_ind)) )\n\tIFF(IN_tax_levy_ind IS NULL \n\t\tOR length(IN_tax_levy_ind\n\t\t) = 0 \n\t\tOR LENGTH(IN_tax_levy_ind)>0 AND TRIM(IN_tax_levy_ind)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_tax_levy_ind\n\t\t\t)\n\t\t)\n\t) AS v_tax_levy_ind,\n\tv_tax_levy_ind AS out_v_tax_levy_ind,\n\tirs_name AS IN_irs_name,\n\t-- *INF*: iif(isnull(IN_irs_name)  OR length(IN_irs_name)= 0 OR IS_SPACES(IN_irs_name), 'N/A',ltrim(rtrim(IN_irs_name)) )\n\tIFF(IN_irs_name IS NULL \n\t\tOR length(IN_irs_name\n\t\t) = 0 \n\t\tOR LENGTH(IN_irs_name)>0 AND TRIM(IN_irs_name)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_irs_name\n\t\t\t)\n\t\t)\n\t) AS v_irs_name,\n\tv_irs_name AS out_irs_name,\n\taddress_line_1 AS IN_address_line_1,\n\t-- *INF*: iif(isnull(IN_address_line_1)  OR length(IN_address_line_1)= 0 OR IS_SPACES(IN_address_line_1), 'N/A',ltrim(rtrim(IN_address_line_1)) )\n\tIFF(IN_address_line_1 IS NULL \n\t\tOR length(IN_address_line_1\n\t\t) = 0 \n\t\tOR LENGTH(IN_address_line_1)>0 AND TRIM(IN_address_line_1)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_address_line_1\n\t\t\t)\n\t\t)\n\t) AS v_address_line_1,\n\tv_address_line_1 AS out_address_line_1,\n\taddress_line_2 AS IN_address_line_2,\n\t-- *INF*: iif(isnull(IN_address_line_2)  OR length(IN_address_line_2)= 0 OR IS_SPACES(IN_address_line_2), 'N/A',ltrim(rtrim(IN_address_line_2)) )\n\tIFF(IN_address_line_2 IS NULL \n\t\tOR length(IN_address_line_2\n\t\t) = 0 \n\t\tOR LENGTH(IN_address_line_2)>0 AND TRIM(IN_address_line_2)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_address_line_2\n\t\t\t)\n\t\t)\n\t) AS v_address_line_2,\n\tv_address_line_2 AS out_address_line_2,\n\tcity AS IN_city,\n\t-- *INF*: iif(isnull(IN_city)  OR length(IN_city)= 0 OR IS_SPACES(IN_city), 'N/A',ltrim(rtrim(IN_city)) )\n\tIFF(IN_city IS NULL \n\t\tOR length(IN_city\n\t\t) = 0 \n\t\tOR LENGTH(IN_city)>0 AND TRIM(IN_city)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_city\n\t\t\t)\n\t\t)\n\t) AS v_city,\n\tv_city AS out_city,\n\tstate_code AS IN_state_code,\n\t-- *INF*: iif(isnull(IN_state_code)  OR length(IN_state_code)= 0 OR IS_SPACES(IN_state_code), 'N/A',ltrim(rtrim(IN_state_code)) )\n\tIFF(IN_state_code IS NULL \n\t\tOR length(IN_state_code\n\t\t) = 0 \n\t\tOR LENGTH(IN_state_code)>0 AND TRIM(IN_state_code)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_state_code\n\t\t\t)\n\t\t)\n\t) AS v_state_code,\n\tv_state_code AS out_state_code,\n\tzip_code AS IN_zip_code,\n\t-- *INF*: iif(isnull(IN_zip_code)  OR length(IN_zip_code)= 0 OR IS_SPACES(IN_zip_code), 'N/A',ltrim(rtrim(IN_zip_code)) )\n\tIFF(IN_zip_code IS NULL \n\t\tOR length(IN_zip_code\n\t\t) = 0 \n\t\tOR LENGTH(IN_zip_code)>0 AND TRIM(IN_zip_code)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_zip_code\n\t\t\t)\n\t\t)\n\t) AS v_zip_code,\n\tv_zip_code AS out_zip_code,\n\tcountry_code AS IN_country_code,\n\t-- *INF*: iif(isnull(IN_country_code)  OR length(IN_country_code)= 0 OR IS_SPACES(IN_country_code), 'N/A',ltrim(rtrim(IN_country_code)) )\n\tIFF(IN_country_code IS NULL \n\t\tOR length(IN_country_code\n\t\t) = 0 \n\t\tOR LENGTH(IN_country_code)>0 AND TRIM(IN_country_code)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_country_code\n\t\t\t)\n\t\t)\n\t) AS v_country_code,\n\tv_country_code AS out_country_code,\n\tmodified_ts AS IN_modified_ts,\n\tmodified_user_id AS IN_modified_user_id,\n\tnotes AS IN_notes,\n\tsearch_tax_id AS IN_search_tax_id,\n\ttax_id_type AS in_tax_id_type,\n\t-- *INF*: iif(isnull(in_tax_id_type)  OR length(ltrim(ltrim(in_tax_id_type)))= 0 OR IS_SPACES(in_tax_id_type), '',ltrim(rtrim(in_tax_id_type)) )\n\tIFF(in_tax_id_type IS NULL \n\t\tOR length(ltrim(ltrim(in_tax_id_type\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0 \n\t\tOR LENGTH(in_tax_id_type)>0 AND TRIM(in_tax_id_type)='',\n\t\t'',\n\t\tltrim(rtrim(in_tax_id_type\n\t\t\t)\n\t\t)\n\t) AS tax_id_type,\n\tphone AS IN_phone,\n\t-- *INF*: iif(isnull(IN_phone)  OR length(IN_phone)= 0 OR IS_SPACES(IN_phone), 'N/A',ltrim(rtrim(IN_phone)) )\n\tIFF(IN_phone IS NULL \n\t\tOR length(IN_phone\n\t\t) = 0 \n\t\tOR LENGTH(IN_phone)>0 AND TRIM(IN_phone)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_phone\n\t\t\t)\n\t\t)\n\t) AS v_phone,\n\tv_phone AS out_phone,\n\t-- *INF*: iif(SUBSTR(v_tax_id_1,3,1)='-' and INSTR(v_tax_id_1,' ')=0 and LENGTH(v_tax_id_1)=10,0,IIF(LENGTH(v_tax_id_1)=11,0,\r\n\t-- -1))\r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(SUBSTR(v_tax_id_1, 3, 1\n\t\t) = '-' \n\t\tAND REGEXP_INSTR(v_tax_id_1, ' '\n\t\t) = 0 \n\t\tAND LENGTH(v_tax_id_1\n\t\t) = 10,\n\t\t0,\n\t\tIFF(LENGTH(v_tax_id_1\n\t\t\t) = 11,\n\t\t\t0,\n\t\t\t- 1\n\t\t)\n\t) AS v_err_flag,\n\tv_err_flag AS out_err_flag,\n\tlast_modified_dt AS IN_last_modified_dt,\n\tirs_1099_type AS in_irs_1099_type,\n\t-- *INF*: iif(isnull(in_irs_1099_type)  OR length(in_irs_1099_type)= 0 OR IS_SPACES(in_irs_1099_type), 'M',ltrim(rtrim(in_irs_1099_type)) )\n\tIFF(in_irs_1099_type IS NULL \n\t\tOR length(in_irs_1099_type\n\t\t) = 0 \n\t\tOR LENGTH(in_irs_1099_type)>0 AND TRIM(in_irs_1099_type)='',\n\t\t'M',\n\t\tltrim(rtrim(in_irs_1099_type\n\t\t\t)\n\t\t)\n\t) AS v_irs_1099_type,\n\tv_irs_1099_type AS irs_1099_type,\n\tvendor_type_cd AS in_vendor_type_cd,\n\t-- *INF*: iif(isnull(in_vendor_type_cd)  OR length(in_vendor_type_cd)= 0 OR IS_SPACES(in_vendor_type_cd), 'N/A',ltrim(rtrim(in_vendor_type_cd)) )\n\tIFF(in_vendor_type_cd IS NULL \n\t\tOR length(in_vendor_type_cd\n\t\t) = 0 \n\t\tOR LENGTH(in_vendor_type_cd)>0 AND TRIM(in_vendor_type_cd)='',\n\t\t'N/A',\n\t\tltrim(rtrim(in_vendor_type_cd\n\t\t\t)\n\t\t)\n\t) AS v_vendor_type_cd,\n\tv_vendor_type_cd AS vendor_type_cd,\n\textract_date AS IN_extract_date,\n\tas_of_date AS IN_as_of_date,\n\trecord_count AS IN_record_count,\n\tsource_system_id AS IN_source_system_id,\n\t-- *INF*: iif(isnull(IN_modified_ts),TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'),IN_modified_ts)\r\n\t-- \r\n\t-- \n\tIFF(IN_modified_ts IS NULL,\n\t\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tIN_modified_ts\n\t) AS modified_ts,\n\t-- *INF*: iif(isnull(IN_modified_user_id)  OR length(IN_modified_user_id)= 0 OR IS_SPACES(IN_modified_user_id), 'N/A',ltrim(rtrim(IN_modified_user_id)) )\n\tIFF(IN_modified_user_id IS NULL \n\t\tOR length(IN_modified_user_id\n\t\t) = 0 \n\t\tOR LENGTH(IN_modified_user_id)>0 AND TRIM(IN_modified_user_id)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_modified_user_id\n\t\t\t)\n\t\t)\n\t) AS modified_user_id,\n\t-- *INF*: iif(isnull(IN_notes)  OR length(IN_notes)= 0 OR IS_SPACES(IN_notes), 'N/A',ltrim(rtrim(IN_notes)) )\n\tIFF(IN_notes IS NULL \n\t\tOR length(IN_notes\n\t\t) = 0 \n\t\tOR LENGTH(IN_notes)>0 AND TRIM(IN_notes)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_notes\n\t\t\t)\n\t\t)\n\t) AS notes,\n\t-- *INF*: iif(isnull(IN_search_tax_id)  OR length(IN_search_tax_id)= 0 OR IS_SPACES(IN_search_tax_id), 'N/A',ltrim(rtrim(IN_search_tax_id)) )\n\tIFF(IN_search_tax_id IS NULL \n\t\tOR length(IN_search_tax_id\n\t\t) = 0 \n\t\tOR LENGTH(IN_search_tax_id)>0 AND TRIM(IN_search_tax_id)='',\n\t\t'N/A',\n\t\tltrim(rtrim(IN_search_tax_id\n\t\t\t)\n\t\t)\n\t) AS v_search_tax_id,\n\tv_search_tax_id AS search_tax_id,\n\tis_valid AS in_is_valid,\n\t-- *INF*: IIF(isnull(in_is_valid) or length(rtrim(ltrim(in_is_valid)))=0 or IS_SPACES(in_is_valid), 'N',in_is_valid) \n\tIFF(in_is_valid IS NULL \n\t\tOR length(rtrim(ltrim(in_is_valid\n\t\t\t\t)\n\t\t\t)\n\t\t) = 0 \n\t\tOR LENGTH(in_is_valid)>0 AND TRIM(in_is_valid)='',\n\t\t'N',\n\t\tin_is_valid\n\t) AS is_valid\n\tFROM SQ_master_1099_list_stage\n),\nFIL_keep_conditions AS (\n\tSELECT\n\tout_tax_id AS tax_id, \n\tout_reportable_id AS reportable_id, \n\tout_v_tax_levy_ind AS tax_levy_ind, \n\tout_irs_name AS irs_name, \n\tout_address_line_1 AS address_line_1, \n\tout_address_line_2 AS address_line_2, \n\tout_city AS city, \n\tout_state_code AS state_code, \n\tout_zip_code AS zip_code, \n\tout_country_code AS country_code, \n\ttax_id_type, \n\tout_phone AS phone, \n\tout_err_flag AS err_flag, \n\tirs_1099_type, \n\tvendor_type_cd, \n\tsearch_tax_id, \n\tis_valid, \n\tIN_modified_ts AS modified_ts\n\tFROM EXP_Validate_Data\n\tWHERE err_flag=0 and is_valid !='' and tax_id_type!='' and search_tax_id !='N/A'\n),\nLKP_claim_master_1099_list AS (\n\tSELECT\n\tclaim_master_1099_list_id,\n\tclaim_master_1099_list_ak_id,\n\ttax_id,\n\tirs_tax_id,\n\ttax_id_type,\n\treportable_ind,\n\ttax_levy_ind,\n\tirs_name,\n\taddress_line_1,\n\taddress_line_2,\n\tcity,\n\tstate_code,\n\tzip_code,\n\tcountry_code,\n\tphone,\n\tirs_1099_type,\n\tvendor_type_code,\n\terr_flag,\n\tcrrnt_snpsht_flag,\n\taudit_id,\n\teff_from_date,\n\teff_to_date,\n\tsource_system_id,\n\tcreated_date,\n\tmodified_date,\n\tin_tax_id_type\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_master_1099_list_id,\n\t\t\tclaim_master_1099_list_ak_id,\n\t\t\ttax_id,\n\t\t\tirs_tax_id,\n\t\t\ttax_id_type,\n\t\t\treportable_ind,\n\t\t\ttax_levy_ind,\n\t\t\tirs_name,\n\t\t\taddress_line_1,\n\t\t\taddress_line_2,\n\t\t\tcity,\n\t\t\tstate_code,\n\t\t\tzip_code,\n\t\t\tcountry_code,\n\t\t\tphone,\n\t\t\tirs_1099_type,\n\t\t\tvendor_type_code,\n\t\t\terr_flag,\n\t\t\tcrrnt_snpsht_flag,\n\t\t\taudit_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date,\n\t\t\tsource_system_id,\n\t\t\tcreated_date,\n\t\t\tmodified_date,\n\t\t\tin_tax_id_type\n\t\tFROM claim_master_1099_list\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY irs_tax_id,tax_id_type ORDER BY claim_master_1099_list_id DESC) = 1\n),\nEXP_detect_changes AS (\n\tSELECT\n\tLKP_claim_master_1099_list.claim_master_1099_list_id AS LKP_claim_master_1099_list_id,\n\tLKP_claim_master_1099_list.claim_master_1099_list_ak_id AS LKP_claim_master_1099_list_ak_id,\n\tLKP_claim_master_1099_list.tax_id AS LKP_tax_id,\n\tLKP_claim_master_1099_list.irs_tax_id AS LKP_irs_tax_id,\n\tLKP_claim_master_1099_list.tax_id_type AS LKP_tax_id_type,\n\tLKP_claim_master_1099_list.reportable_ind AS LKP_reportable_ind,\n\tLKP_claim_master_1099_list.tax_levy_ind AS LKP_tax_levy_ind,\n\tLKP_claim_master_1099_list.irs_name AS LKP_irs_name,\n\tLKP_claim_master_1099_list.address_line_1 AS LKP_address_line_1,\n\tLKP_claim_master_1099_list.address_line_2 AS LKP_address_line_2,\n\tLKP_claim_master_1099_list.city AS LKP_city,\n\tLKP_claim_master_1099_list.state_code AS LKP_state_code,\n\tLKP_claim_master_1099_list.zip_code AS LKP_zip_code,\n\tLKP_claim_master_1099_list.country_code AS LKP_country_code,\n\tLKP_claim_master_1099_list.phone AS LKP_phone,\n\tLKP_claim_master_1099_list.irs_1099_type AS LKP_irs_1099_type1,\n\tLKP_claim_master_1099_list.vendor_type_code AS LKP_vendor_type_code,\n\tLKP_claim_master_1099_list.err_flag AS LKP_err_flag,\n\tLKP_claim_master_1099_list.crrnt_snpsht_flag AS LKP_crrnt_snpsht_flag1,\n\t-- *INF*: DECODE(true,\r\n\t-- LKP_crrnt_snpsht_flag1= 'T', 1,\r\n\t-- LKP_crrnt_snpsht_flag1='1',1,\r\n\t-- LKP_crrnt_snpsht_flag1='Y',1,\r\n\t-- 0)\r\n\t-- \r\n\t-- -- bit types seem to be randomly converted to either integers or strings in informatica so allowances have to be made when trying to do comparisons.\n\tDECODE(true,\n\t\tLKP_crrnt_snpsht_flag1 = 'T', 1,\n\t\tLKP_crrnt_snpsht_flag1 = '1', 1,\n\t\tLKP_crrnt_snpsht_flag1 = 'Y', 1,\n\t\t0\n\t) AS v_LKP_crrnt_snpsht_flag1,\n\tLKP_claim_master_1099_list.audit_id AS LKP_audit_id1,\n\tLKP_claim_master_1099_list.eff_from_date AS LKP_eff_from_date1,\n\tLKP_claim_master_1099_list.eff_to_date AS LKP_eff_to_date1,\n\tLKP_claim_master_1099_list.source_system_id AS LKP_source_system_id1,\n\tLKP_claim_master_1099_list.created_date AS LKP_created_date1,\n\tLKP_claim_master_1099_list.modified_date AS LKP_modified_date1,\n\tFIL_keep_conditions.tax_id AS out_tax_id,\n\tFIL_keep_conditions.reportable_id AS out_reportable_id,\n\tFIL_keep_conditions.tax_levy_ind AS out_v_tax_levy_ind,\n\tFIL_keep_conditions.irs_name AS out_irs_name,\n\tFIL_keep_conditions.address_line_1 AS out_address_line_1,\n\tFIL_keep_conditions.address_line_2 AS out_address_line_2,\n\tFIL_keep_conditions.city AS out_city,\n\tFIL_keep_conditions.state_code AS out_state_code,\n\tFIL_keep_conditions.zip_code AS out_zip_code,\n\tFIL_keep_conditions.country_code AS out_country_code,\n\tFIL_keep_conditions.tax_id_type AS in_tax_id_type,\n\tFIL_keep_conditions.phone AS out_phone,\n\tFIL_keep_conditions.err_flag AS out_err_flag,\n\tFIL_keep_conditions.irs_1099_type,\n\tFIL_keep_conditions.vendor_type_cd,\n\tFIL_keep_conditions.is_valid,\n\t-- *INF*: IIF(is_valid='Y',1,0)\n\tIFF(is_valid = 'Y',\n\t\t1,\n\t\t0\n\t) AS v_crrnt_snpsht_flag,\n\tv_crrnt_snpsht_flag AS out_crrnt_snpsht_flag,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(LKP_claim_master_1099_list_id),'NEW',\r\n\t-- rtrim(ltrim(LKP_tax_id)) <> rtrim(ltrim(out_tax_id)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_tax_id_type)) <> rtrim(ltrim(in_tax_id_type)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_reportable_ind)) <> rtrim(ltrim(out_reportable_id)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_tax_levy_ind)) <> rtrim(ltrim(out_v_tax_levy_ind)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_irs_name)) <> rtrim(ltrim(out_irs_name)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_address_line_1)) <> rtrim(ltrim(out_address_line_1)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_address_line_2)) <> rtrim(ltrim(out_address_line_2)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_city)) <> rtrim(ltrim(out_city)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_state_code)) <> rtrim(ltrim(out_state_code)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_zip_code)) <> rtrim(ltrim(out_zip_code)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_country_code)) <> rtrim(ltrim(out_country_code)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_phone)) <> rtrim(ltrim(out_phone)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_irs_1099_type1)) <> rtrim(ltrim(irs_1099_type)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_vendor_type_code)) <> rtrim(ltrim(vendor_type_cd)),'UPDATE',\r\n\t-- rtrim(ltrim(LKP_irs_tax_id)) <> rtrim(ltrim(search_tax_id)),'UPDATE',\r\n\t-- v_LKP_crrnt_snpsht_flag1 <> v_crrnt_snpsht_flag, 'UPDATE',\r\n\t-- 'NOCHANGE')\n\tDECODE(TRUE,\n\t\tLKP_claim_master_1099_list_id IS NULL, 'NEW',\n\t\trtrim(ltrim(LKP_tax_id\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_tax_id\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_tax_id_type\n\t\t\t)\n\t\t) <> rtrim(ltrim(in_tax_id_type\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_reportable_ind\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_reportable_id\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_tax_levy_ind\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_v_tax_levy_ind\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_irs_name\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_irs_name\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_address_line_1\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_address_line_1\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_address_line_2\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_address_line_2\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_city\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_city\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_state_code\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_state_code\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_zip_code\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_zip_code\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_country_code\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_country_code\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_phone\n\t\t\t)\n\t\t) <> rtrim(ltrim(out_phone\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_irs_1099_type1\n\t\t\t)\n\t\t) <> rtrim(ltrim(irs_1099_type\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_vendor_type_code\n\t\t\t)\n\t\t) <> rtrim(ltrim(vendor_type_cd\n\t\t\t)\n\t\t), 'UPDATE',\n\t\trtrim(ltrim(LKP_irs_tax_id\n\t\t\t)\n\t\t) <> rtrim(ltrim(search_tax_id\n\t\t\t)\n\t\t), 'UPDATE',\n\t\tv_LKP_crrnt_snpsht_flag1 <> v_crrnt_snpsht_flag, 'UPDATE',\n\t\t'NOCHANGE'\n\t) AS v_change_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: IIF(v_change_flag='NEW',TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS'),SYSDATE)\r\n\t-- --TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tIFF(v_change_flag = 'NEW',\n\t\tTO_DATE('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS'\n\t\t),\n\t\tSYSDATE\n\t) AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_DATE('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS'\n\t) AS eff_to_date,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS source_system_id,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\t-- *INF*: iif(ISNULL(LKP_claim_master_1099_list_id),1,0)\n\tIFF(LKP_claim_master_1099_list_id IS NULL,\n\t\t1,\n\t\t0\n\t) AS v_check_master_list_id,\n\tv_check_master_list_id AS out_check_master_list_id,\n\tFIL_keep_conditions.search_tax_id,\n\tv_change_flag AS change_flag,\n\tFIL_keep_conditions.modified_ts\n\tFROM FIL_keep_conditions\n\tLEFT JOIN LKP_claim_master_1099_list\n\tON LKP_claim_master_1099_list.irs_tax_id = FIL_keep_conditions.search_tax_id AND LKP_claim_master_1099_list.tax_id_type = FIL_keep_conditions.tax_id_type\n),\nRTR_claim_master_1099_list AS (\n\tSELECT\n\tLKP_claim_master_1099_list_id,\n\tLKP_claim_master_1099_list_ak_id,\n\tout_tax_id,\n\tout_reportable_id,\n\tout_v_tax_levy_ind,\n\tout_irs_name,\n\tout_address_line_1,\n\tout_address_line_2,\n\tout_city,\n\tout_state_code,\n\tout_zip_code,\n\tout_country_code,\n\tin_tax_id_type,\n\tout_phone,\n\tout_err_flag,\n\tirs_1099_type,\n\tvendor_type_cd,\n\tout_crrnt_snpsht_flag AS crrnt_snpsht_flag,\n\taudit_id,\n\teff_from_date,\n\teff_to_date,\n\tsource_system_id,\n\tcreated_date,\n\tmodified_date,\n\tout_check_master_list_id AS check_master_list_id,\n\tsearch_tax_id,\n\tchange_flag\n\tFROM EXP_detect_changes\n),\nRTR_claim_master_1099_list_INSERT AS (SELECT * FROM RTR_claim_master_1099_list WHERE IN(change_flag,'NEW')),\nRTR_claim_master_1099_list_UPDATE AS (SELECT * FROM RTR_claim_master_1099_list WHERE change_flag='UPDATE'),\nSEQ_claim_master_1099_list_ak_id AS (\n\tCREATE SEQUENCE SEQ_claim_master_1099_list_ak_id\n\tSTART = 0\n\tINCREMENT = 1;\n),\nEXP_Insert_Update_Out AS (\n\tSELECT\n\tLKP_claim_master_1099_list_id AS LKP_claim_master_1099_list_id1,\n\tLKP_claim_master_1099_list_ak_id AS LKP_claim_master_1099_list_ak_id1,\n\t-- *INF*: IIF(change_flag1='NEW',NEXTVAL,LKP_claim_master_1099_list_ak_id1)\n\tIFF(change_flag1 = 'NEW',\n\t\tNEXTVAL,\n\t\tLKP_claim_master_1099_list_ak_id1\n\t) AS claim_master_1099_list_ak_id,\n\tout_tax_id AS out_tax_id1,\n\tout_reportable_id AS out_reportable_id1,\n\tout_v_tax_levy_ind AS out_v_tax_levy_ind1,\n\tout_irs_name AS out_irs_name1,\n\tout_address_line_ AS out_address_line_11,\n\tout_address_line_2 AS out_address_line_21,\n\tout_city AS out_city1,\n\tout_state_code AS out_state_code1,\n\tout_zip_code AS out_zip_code1,\n\tout_country_code AS out_country_code1,\n\tin_tax_id_type AS in_tax_id_type1,\n\tout_phone AS out_phone1,\n\tout_err_flag AS out_err_flag1,\n\tirs_1099_type AS irs_1099_type1,\n\tvendor_type_cd AS vendor_type_cd1,\n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1,\n\taudit_id AS audit_id1,\n\teff_from_date AS eff_from_date1,\n\teff_to_date AS eff_to_date1,\n\tsource_system_id AS source_system_id1,\n\tcreated_date AS created_date1,\n\tmodified_date AS modified_date1,\n\tcheck_master_list_id AS check_master_list_id1,\n\tsearch_tax_id AS search_tax_id1,\n\texpire_eff_to_date AS expire_eff_to_date1,\n\texpire_crrnt_snpsht_flag AS expire_crrnt_snpsht_flag1,\n\tchange_flag AS change_flag1,\n\tSEQ_claim_master_1099_list_ak_id.NEXTVAL\n\tFROM RTR_claim_master_1099_list_INSERT\n),\nUPD_Claim_Master_1099_List_Insert AS (\n\tSELECT\n\tclaim_master_1099_list_ak_id, \n\tout_tax_id1, \n\tout_reportable_id1, \n\tout_v_tax_levy_ind1, \n\tout_irs_name1, \n\tout_address_line_11, \n\tout_address_line_21, \n\tout_city1, \n\tout_state_code1, \n\tout_zip_code1, \n\tout_country_code1, \n\tin_tax_id_type1, \n\tout_phone1, \n\tout_err_flag1, \n\tirs_1099_type1, \n\tvendor_type_cd1, \n\tcrrnt_snpsht_flag1, \n\taudit_id1, \n\teff_from_date1, \n\teff_to_date1, \n\tsource_system_id1, \n\tcreated_date1, \n\tmodified_date1, \n\tcheck_master_list_id1, \n\tsearch_tax_id1\n\tFROM EXP_Insert_Update_Out\n),\nTGT_claim_master_1099_list_INSERT AS (\n\tINSERT INTO claim_master_1099_list\n\t(claim_master_1099_list_ak_id, tax_id, irs_tax_id, tax_id_type, reportable_ind, tax_levy_ind, irs_name, address_line_1, address_line_2, city, state_code, zip_code, country_code, phone, irs_1099_type, vendor_type_code, err_flag, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, source_system_id, created_date, modified_date)\n\tSELECT \n\tCLAIM_MASTER_1099_LIST_AK_ID, \n\tout_tax_id1 AS TAX_ID, \n\tsearch_tax_id1 AS IRS_TAX_ID, \n\tin_tax_id_type1 AS TAX_ID_TYPE, \n\tout_reportable_id1 AS REPORTABLE_IND, \n\tout_v_tax_levy_ind1 AS TAX_LEVY_IND, \n\tout_irs_name1 AS IRS_NAME, \n\tout_address_line_11 AS ADDRESS_LINE_1, \n\tout_address_line_21 AS ADDRESS_LINE_2, \n\tout_city1 AS CITY, \n\tout_state_code1 AS STATE_CODE, \n\tout_zip_code1 AS ZIP_CODE, \n\tout_country_code1 AS COUNTRY_CODE, \n\tout_phone1 AS PHONE, \n\tirs_1099_type1 AS IRS_1099_TYPE, \n\tvendor_type_cd1 AS VENDOR_TYPE_CODE, \n\tout_err_flag1 AS ERR_FLAG, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tsource_system_id1 AS SOURCE_SYSTEM_ID, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE\n\tFROM UPD_Claim_Master_1099_List_Insert\n),\nUPD_cliam_master_1099_list_UPDATE AS (\n\tSELECT\n\tLKP_claim_master_1099_list_id AS LKP_claim_master_1099_list_id2, \n\tout_tax_id AS out_tax_id2, \n\tout_reportable_id AS out_reportable_id2, \n\tout_v_tax_levy_ind AS out_v_tax_levy_ind2, \n\tout_irs_name AS out_irs_name2, \n\tout_address_line_1 AS out_address_line_12, \n\tout_address_line_2 AS out_address_line_22, \n\tout_city AS out_city2, \n\tout_state_code AS out_state_code2, \n\tout_zip_code AS out_zip_code2, \n\tout_country_code AS out_country_code2, \n\tin_tax_id_type AS in_tax_id_type2, \n\tout_phone AS out_phone2, \n\tirs_1099_type AS irs_1099_type2, \n\tvendor_type_cd AS vendor_type_cd2, \n\taudit_id AS audit_id2, \n\tmodified_date AS modified_date2, \n\tsearch_tax_id AS search_tax_id2, \n\texpire_eff_to_date AS expire_eff_to_date3, \n\texpire_crrnt_snpsht_flag AS expire_crrnt_snpsht_flag3, \n\teff_from_date AS eff_from_date3, \n\tout_err_flag AS out_err_flag3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3\n\tFROM RTR_claim_master_1099_list_UPDATE\n),\nTGT_claim_master_1099_list_UPDATE AS (\n\tMERGE INTO claim_master_1099_list AS T\n\tUSING UPD_cliam_master_1099_list_UPDATE AS S\n\tON T.claim_master_1099_list_id = S.LKP_claim_master_1099_list_id2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.tax_id = S.out_tax_id2, T.irs_tax_id = S.search_tax_id2, T.tax_id_type = S.in_tax_id_type2, T.reportable_ind = S.out_reportable_id2, T.tax_levy_ind = S.out_v_tax_levy_ind2, T.irs_name = S.out_irs_name2, T.address_line_1 = S.out_address_line_12, T.address_line_2 = S.out_address_line_22, T.city = S.out_city2, T.state_code = S.out_state_code2, T.zip_code = S.out_zip_code2, T.country_code = S.out_country_code2, T.phone = S.out_phone2, T.irs_1099_type = S.irs_1099_type2, T.vendor_type_code = S.vendor_type_cd2, T.err_flag = S.out_err_flag3, T.crrnt_snpsht_flag = S.crrnt_snpsht_flag3, T.audit_id = S.audit_id2, T.eff_from_date = S.eff_from_date3, T.modified_date = S.modified_date2\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataWarehouse/"
        },
        "annotations": []
    }
}