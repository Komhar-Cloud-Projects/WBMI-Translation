WITH
SQ_DCTransactionStaging AS (
	SELECT
		TransactionId,
		SessionId,
		Id,
		Type,
		State,
		EffectiveDate,
		ScheduleDate,
		CreatedDate,
		CreatedUser,
		OriginalCharge,
		Charge,
		ProRateFactor,
		TermPremium,
		PriorPremium,
		NewPremium,
		HistoryID,
		ConvertedTransactionType,
		CancellationDate,
		TransactionDate,
		ExpirationDate,
		Deposit,
		AuditCharge,
		AuditPremium,
		StatusUserContext,
		StatusUser,
		PolicyStatus,
		IssuedDate,
		IssuedUserName,
		ExtractDate,
		SourceSystemId,
		ShortRateFactor
	FROM DCTransactionStaging
),
EXP_Metadata AS (
	SELECT
	TransactionId,
	SessionId,
	Id,
	Type,
	State,
	EffectiveDate,
	ScheduleDate,
	CreatedDate,
	CreatedUser,
	OriginalCharge,
	Charge,
	ProRateFactor,
	TermPremium,
	PriorPremium,
	NewPremium,
	HistoryID,
	ConvertedTransactionType,
	CancellationDate,
	TransactionDate,
	ExpirationDate,
	Deposit,
	AuditCharge,
	AuditPremium,
	StatusUserContext,
	StatusUser,
	PolicyStatus,
	IssuedDate,
	IssuedUserName,
	ExtractDate,
	SourceSystemId,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,
	ShortRateFactor
	FROM SQ_DCTransactionStaging
),
archDCTransactionStaging AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.archDCTransactionStaging
	(TransactionId, SessionId, Id, Type, State, EffectiveDate, ScheduleDate, CreatedDate, CreatedUser, OriginalCharge, Charge, ProRateFactor, TermPremium, PriorPremium, NewPremium, HistoryID, ConvertedTransactionType, CancellationDate, TransactionDate, ExpirationDate, Deposit, AuditCharge, AuditPremium, StatusUserContext, StatusUser, PolicyStatus, IssuedDate, IssuedUserName, ExtractDate, SourceSystemId, AuditId, ShortRateFactor)
	SELECT 
	TRANSACTIONID, 
	SESSIONID, 
	ID, 
	TYPE, 
	STATE, 
	EFFECTIVEDATE, 
	SCHEDULEDATE, 
	CREATEDDATE, 
	CREATEDUSER, 
	ORIGINALCHARGE, 
	CHARGE, 
	PRORATEFACTOR, 
	TERMPREMIUM, 
	PRIORPREMIUM, 
	NEWPREMIUM, 
	HISTORYID, 
	CONVERTEDTRANSACTIONTYPE, 
	CANCELLATIONDATE, 
	TRANSACTIONDATE, 
	EXPIRATIONDATE, 
	DEPOSIT, 
	AUDITCHARGE, 
	AUDITPREMIUM, 
	STATUSUSERCONTEXT, 
	STATUSUSER, 
	POLICYSTATUS, 
	ISSUEDDATE, 
	ISSUEDUSERNAME, 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_AuditId AS AUDITID, 
	SHORTRATEFACTOR
	FROM EXP_Metadata
),