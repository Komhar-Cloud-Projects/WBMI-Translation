{
    "name": "s_m_POL_STG_Insert_arch_pif_43lxgl_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43lxgl_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_Pif43LXGLStage AS (\n\tSELECT\n\t\tPif43LXGLStageId,\n\t\tPifSymbol,\n\t\tPifPolicyNumber,\n\t\tPifModule,\n\t\tPmdlxg1RecLength,\n\t\tPmdlxg1ActionCode,\n\t\tPmdlxg1FileId,\n\t\tPmdlxg1SegmentId,\n\t\tPmdlxg1SegmentStatus,\n\t\tPmdlxg1YearTransaction,\n\t\tPmdlxg1MonthTransaction,\n\t\tPmdlxg1DayTransaction,\n\t\tPmdlxg1SegmentLevelCode AS PmdlxgiSegmentLevelCode,\n\t\tPmdlxg1SegmentPartCode,\n\t\tPmdlxg1SubPartCode,\n\t\tPmdlxg1InsuranceLine,\n\t\tPmdlxg1LocationNumber,\n\t\tPmdlxg1YearItemEffective,\n\t\tPmdlxg1MonthItemEffective,\n\t\tPmdlxg1DayItemEffective,\n\t\tPmdlxg1YearProcess,\n\t\tPmdlxg1MonthProcess,\n\t\tPmdlxg1DayProcess,\n\t\tPmdlxg1CompanyNumber,\n\t\tPmdlxg1YearOrigProcess,\n\t\tPmdlxg1MonthOrigProcess,\n\t\tPmdlxg1DayOrigProcess,\n\t\tPmdlxg1OccurClaimsMadeInd,\n\t\tPmdlxg1ClmsMadeYr,\n\t\tPmdlxg1ClmsMadeMo,\n\t\tPmdlxg1ClmsMadeDay,\n\t\tPmdlxg1YearRetro,\n\t\tPmdlxg1MonthRetro,\n\t\tPmdlxg1DayRetro,\n\t\tPmdlxg1SplitLimInd,\n\t\tPmdlxg1FringeCode1,\n\t\tPmdlxg1FringeRate1,\n\t\tPmdlxg1FringeRateMgInd1,\n\t\tPmdlxg1FringeCode2,\n\t\tPmdlxg1FringeRate2,\n\t\tPmdlxg1FringeRateMgInd2,\n\t\tPmdlxg1FringeCode3,\n\t\tPmdlxg1FringeRate3,\n\t\tPmdlxg1FringeRateMgInd3,\n\t\tPmdlxg1FringeCode4,\n\t\tPmdlxg1FringeRate4,\n\t\tPmdlxg1FringeRateMgInd4,\n\t\tPmdlxg1FringeCode5,\n\t\tPmdlxg1FringeRate5,\n\t\tPmdlxg1FringeRateMgInd5,\n\t\tPmdlxg1FringeCode6,\n\t\tPmdlxg1FringeRate6,\n\t\tPmdlxg1FringeRateMgInd6,\n\t\tPmdlxg1FringeCode7,\n\t\tPmdlxg1FringeRate7,\n\t\tPmdlxg1FringeRateMgInd7,\n\t\tPmdlxg1FringeCode8,\n\t\tPmdlxg1FringeRate8,\n\t\tPmdlxg1FringeRateMgInd8,\n\t\tPmdlxg1FringeCode9,\n\t\tPmdlxg1FringeRate9,\n\t\tPmdlxg1FringeRateMgInd9,\n\t\tPmdlxg1FringeCode10,\n\t\tPmdlxg1FringeRate10,\n\t\tPmdlxg1FringeRateMgInd10,\n\t\tPmdlxg1AuditFrequencyCode,\n\t\tPmdlxg1AuditType,\n\t\tPmdlxg1TexasDiscInd,\n\t\tPmdlxg1TexasDiscMgInd,\n\t\tPmdlxg1TexasDiscPercent,\n\t\tPmdlxg1DecChangeFlag,\n\t\tPmdlxg1PmaCode,\n\t\tPmdlxg1IrpmExperPercent,\n\t\tPmdlxg1ScheduledPercent,\n\t\tPmdlxg1ExpensePercent,\n\t\tPmdlxg1OtherPercent,\n\t\tPmdlxg1CommReduction,\n\t\tPmdlxg1CommRate,\n\t\tPmdlxg1RateLevelDate,\n\t\tPmdlxg1WorkSheetInd,\n\t\tPmdlxg1ProdwIndicator,\n\t\tPmdlxg1CutOffYr,\n\t\tPmdlxg1CutOffMo,\n\t\tPmdlxg1CutOffDay,\n\t\tPmdlxg1PmsFutureUse,\n\t\tPmdlxg1CustSplUse,\n\t\tPmdlxg1Yr2000CustUse,\n\t\tPmdlxg1WbcKey,\n\t\tExtractDate,\n\t\tAsOfDate,\n\t\tRecordCount,\n\t\tSourceSystemId\n\tFROM Pif43LXGLStage\n),\nEXP_Values AS (\n\tSELECT\n\tPif43LXGLStageId AS Pif43LXStageId,\n\tPifSymbol,\n\tPifPolicyNumber,\n\tPifModule,\n\tPmdlxg1RecLength,\n\tPmdlxg1ActionCode,\n\tPmdlxg1FileId,\n\tPmdlxg1SegmentId,\n\tPmdlxg1SegmentStatus,\n\tPmdlxg1YearTransaction,\n\tPmdlxg1MonthTransaction,\n\tPmdlxg1DayTransaction,\n\tPmdlxgiSegmentLevelCode,\n\tPmdlxg1SegmentPartCode,\n\tPmdlxg1SubPartCode,\n\tPmdlxg1InsuranceLine,\n\tPmdlxg1LocationNumber,\n\tPmdlxg1YearItemEffective,\n\tPmdlxg1MonthItemEffective,\n\tPmdlxg1DayItemEffective,\n\tPmdlxg1YearProcess,\n\tPmdlxg1MonthProcess,\n\tPmdlxg1DayProcess,\n\tPmdlxg1CompanyNumber,\n\tPmdlxg1YearOrigProcess,\n\tPmdlxg1MonthOrigProcess,\n\tPmdlxg1DayOrigProcess,\n\tPmdlxg1OccurClaimsMadeInd,\n\tPmdlxg1ClmsMadeYr,\n\tPmdlxg1ClmsMadeMo,\n\tPmdlxg1ClmsMadeDay,\n\tPmdlxg1YearRetro,\n\tPmdlxg1MonthRetro,\n\tPmdlxg1DayRetro,\n\tPmdlxg1SplitLimInd,\n\tPmdlxg1FringeCode1,\n\tPmdlxg1FringeRate1,\n\tPmdlxg1FringeRateMgInd1,\n\tPmdlxg1FringeCode2,\n\tPmdlxg1FringeRate2,\n\tPmdlxg1FringeRateMgInd2,\n\tPmdlxg1FringeCode3,\n\tPmdlxg1FringeRate3,\n\tPmdlxg1FringeRateMgInd3,\n\tPmdlxg1FringeCode4,\n\tPmdlxg1FringeRate4,\n\tPmdlxg1FringeRateMgInd4,\n\tPmdlxg1FringeCode5,\n\tPmdlxg1FringeRate5,\n\tPmdlxg1FringeRateMgInd5,\n\tPmdlxg1FringeCode6,\n\tPmdlxg1FringeRate6,\n\tPmdlxg1FringeRateMgInd6,\n\tPmdlxg1FringeCode7,\n\tPmdlxg1FringeRate7,\n\tPmdlxg1FringeRateMgInd7,\n\tPmdlxg1FringeCode8,\n\tPmdlxg1FringeRate8,\n\tPmdlxg1FringeRateMgInd8,\n\tPmdlxg1FringeCode9,\n\tPmdlxg1FringeRate9,\n\tPmdlxg1FringeRateMgInd9,\n\tPmdlxg1FringeCode10,\n\tPmdlxg1FringeRate10,\n\tPmdlxg1FringeRateMgInd10,\n\tPmdlxg1AuditFrequencyCode,\n\tPmdlxg1AuditType,\n\tPmdlxg1TexasDiscInd,\n\tPmdlxg1TexasDiscMgInd,\n\tPmdlxg1TexasDiscPercent,\n\tPmdlxg1DecChangeFlag,\n\tPmdlxg1PmaCode,\n\tPmdlxg1IrpmExperPercent AS Pmdlxg1IrpmExperPerce,\n\tPmdlxg1ScheduledPercent AS Pmdlxg1ScheduledPercen,\n\tPmdlxg1ExpensePercent,\n\tPmdlxg1OtherPercent,\n\tPmdlxg1CommReduction,\n\tPmdlxg1CommRate,\n\tPmdlxg1RateLevelDate,\n\tPmdlxg1WorkSheetInd,\n\tPmdlxg1ProdwIndicator,\n\tPmdlxg1CutOffYr,\n\tPmdlxg1CutOffMo,\n\tPmdlxg1CutOffDay,\n\tPmdlxg1PmsFutureUse,\n\tPmdlxg1CustSplUse,\n\tPmdlxg1Yr2000CustUse,\n\tPmdlxg1WbcKey,\n\tExtractDate,\n\tAsOfDate,\n\tRecordCount,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId\n\tFROM SQ_Pif43LXGLStage\n),\nArchPif43LXGLStage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPif43LXGLStage\n\t(Pif43LXGLStageId, PifSymbol, PifPolicyNumber, PifModule, Pmdlxg1RecLength, Pmdlxg1ActionCode, Pmdlxg1FileId, Pmdlxg1SegmentId, Pmdlxg1SegmentStatus, Pmdlxg1YearTransaction, Pmdlxg1MonthTransaction, Pmdlxg1DayTransaction, Pmdlxg1SegmentLevelCode, Pmdlxg1SegmentPartCode, Pmdlxg1SubPartCode, Pmdlxg1InsuranceLine, Pmdlxg1LocationNumber, Pmdlxg1YearItemEffective, Pmdlxg1MonthItemEffective, Pmdlxg1DayItemEffective, Pmdlxg1YearProcess, Pmdlxg1MonthProcess, Pmdlxg1DayProcess, Pmdlxg1CompanyNumber, Pmdlxg1YearOrigProcess, Pmdlxg1MonthOrigProcess, Pmdlxg1DayOrigProcess, Pmdlxg1OccurClaimsMadeInd, Pmdlxg1ClmsMadeYr, Pmdlxg1ClmsMadeMo, Pmdlxg1ClmsMadeDay, Pmdlxg1YearRetro, Pmdlxg1MonthRetro, Pmdlxg1DayRetro, Pmdlxg1SplitLimInd, Pmdlxg1FringeCode1, Pmdlxg1FringeRate1, Pmdlxg1FringeRateMgInd1, Pmdlxg1FringeCode2, Pmdlxg1FringeRate2, Pmdlxg1FringeRateMgInd2, Pmdlxg1FringeCode3, Pmdlxg1FringeRate3, Pmdlxg1FringeRateMgInd3, Pmdlxg1FringeCode4, Pmdlxg1FringeRate4, Pmdlxg1FringeRateMgInd4, Pmdlxg1FringeCode5, Pmdlxg1FringeRate5, Pmdlxg1FringeRateMgInd5, Pmdlxg1FringeCode6, Pmdlxg1FringeRate6, Pmdlxg1FringeRateMgInd6, Pmdlxg1FringeCode7, Pmdlxg1FringeRate7, Pmdlxg1FringeRateMgInd7, Pmdlxg1FringeCode8, Pmdlxg1FringeRate8, Pmdlxg1FringeRateMgInd8, Pmdlxg1FringeCode9, Pmdlxg1FringeRate9, Pmdlxg1FringeRateMgInd9, Pmdlxg1FringeCode10, Pmdlxg1FringeRate10, Pmdlxg1FringeRateMgInd10, Pmdlxg1AuditFrequencyCode, Pmdlxg1AuditType, Pmdlxg1TexasDiscInd, Pmdlxg1TexasDiscMgInd, Pmdlxg1TexasDiscPercent, Pmdlxg1DecChangeFlag, Pmdlxg1PmaCode, Pmdlxg1IrpmExperPercent, Pmdlxg1ScheduledPercent, Pmdlxg1ExpensePercent, Pmdlxg1OtherPercent, Pmdlxg1CommReduction, Pmdlxg1CommRate, Pmdlxg1RateLevelDate, Pmdlxg1WorkSheetInd, Pmdlxg1ProdwIndicator, Pmdlxg1CutOffYr, Pmdlxg1CutOffMo, Pmdlxg1CutOffDay, Pmdlxg1PmsFutureUse, Pmdlxg1CustSplUse, Pmdlxg1Yr2000CustUse, Pmdlxg1WbcKey, ExtractDate, AsOfDate, RecordCount, SourceSystemId, AuditId)\n\tSELECT \n\tPif43LXStageId AS PIF43LXGLSTAGEID, \n\tPIFSYMBOL, \n\tPIFPOLICYNUMBER, \n\tPIFMODULE, \n\tPMDLXG1RECLENGTH, \n\tPMDLXG1ACTIONCODE, \n\tPMDLXG1FILEID, \n\tPMDLXG1SEGMENTID, \n\tPMDLXG1SEGMENTSTATUS, \n\tPMDLXG1YEARTRANSACTION, \n\tPMDLXG1MONTHTRANSACTION, \n\tPMDLXG1DAYTRANSACTION, \n\tPmdlxgiSegmentLevelCode AS PMDLXG1SEGMENTLEVELCODE, \n\tPMDLXG1SEGMENTPARTCODE, \n\tPMDLXG1SUBPARTCODE, \n\tPMDLXG1INSURANCELINE, \n\tPMDLXG1LOCATIONNUMBER, \n\tPMDLXG1YEARITEMEFFECTIVE, \n\tPMDLXG1MONTHITEMEFFECTIVE, \n\tPMDLXG1DAYITEMEFFECTIVE, \n\tPMDLXG1YEARPROCESS, \n\tPMDLXG1MONTHPROCESS, \n\tPMDLXG1DAYPROCESS, \n\tPMDLXG1COMPANYNUMBER, \n\tPMDLXG1YEARORIGPROCESS, \n\tPMDLXG1MONTHORIGPROCESS, \n\tPMDLXG1DAYORIGPROCESS, \n\tPMDLXG1OCCURCLAIMSMADEIND, \n\tPMDLXG1CLMSMADEYR, \n\tPMDLXG1CLMSMADEMO, \n\tPMDLXG1CLMSMADEDAY, \n\tPMDLXG1YEARRETRO, \n\tPMDLXG1MONTHRETRO, \n\tPMDLXG1DAYRETRO, \n\tPMDLXG1SPLITLIMIND, \n\tPMDLXG1FRINGECODE1, \n\tPMDLXG1FRINGERATE1, \n\tPMDLXG1FRINGERATEMGIND1, \n\tPMDLXG1FRINGECODE2, \n\tPMDLXG1FRINGERATE2, \n\tPMDLXG1FRINGERATEMGIND2, \n\tPMDLXG1FRINGECODE3, \n\tPMDLXG1FRINGERATE3, \n\tPMDLXG1FRINGERATEMGIND3, \n\tPMDLXG1FRINGECODE4, \n\tPMDLXG1FRINGERATE4, \n\tPMDLXG1FRINGERATEMGIND4, \n\tPMDLXG1FRINGECODE5, \n\tPMDLXG1FRINGERATE5, \n\tPMDLXG1FRINGERATEMGIND5, \n\tPMDLXG1FRINGECODE6, \n\tPMDLXG1FRINGERATE6, \n\tPMDLXG1FRINGERATEMGIND6, \n\tPMDLXG1FRINGECODE7, \n\tPMDLXG1FRINGERATE7, \n\tPMDLXG1FRINGERATEMGIND7, \n\tPMDLXG1FRINGECODE8, \n\tPMDLXG1FRINGERATE8, \n\tPMDLXG1FRINGERATEMGIND8, \n\tPMDLXG1FRINGECODE9, \n\tPMDLXG1FRINGERATE9, \n\tPMDLXG1FRINGERATEMGIND9, \n\tPMDLXG1FRINGECODE10, \n\tPMDLXG1FRINGERATE10, \n\tPMDLXG1FRINGERATEMGIND10, \n\tPMDLXG1AUDITFREQUENCYCODE, \n\tPMDLXG1AUDITTYPE, \n\tPMDLXG1TEXASDISCIND, \n\tPMDLXG1TEXASDISCMGIND, \n\tPMDLXG1TEXASDISCPERCENT, \n\tPMDLXG1DECCHANGEFLAG, \n\tPMDLXG1PMACODE, \n\tPmdlxg1IrpmExperPerce AS PMDLXG1IRPMEXPERPERCENT, \n\tPmdlxg1ScheduledPercen AS PMDLXG1SCHEDULEDPERCENT, \n\tPMDLXG1EXPENSEPERCENT, \n\tPMDLXG1OTHERPERCENT, \n\tPMDLXG1COMMREDUCTION, \n\tPMDLXG1COMMRATE, \n\tPMDLXG1RATELEVELDATE, \n\tPMDLXG1WORKSHEETIND, \n\tPMDLXG1PRODWINDICATOR, \n\tPMDLXG1CUTOFFYR, \n\tPMDLXG1CUTOFFMO, \n\tPMDLXG1CUTOFFDAY, \n\tPMDLXG1PMSFUTUREUSE, \n\tPMDLXG1CUSTSPLUSE, \n\tPMDLXG1YR2000CUSTUSE, \n\tPMDLXG1WBCKEY, \n\tEXTRACTDATE, \n\tASOFDATE, \n\tRECORDCOUNT, \n\tSOURCESYSTEMID, \n\to_AuditId AS AUDITID\n\tFROM EXP_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}