{
    "name": "s_m_POL_FEED_Load_WCPOLS_30_Record",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_30_Record",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkWCTrackHistory AS (\n\tdeclare  @GroupSize float = 6.0  -- need float type to force a decimal when dividing so they can be rounded up\r\n\t\r\n\tselect\r\n\tB.WCTrackHistoryID as WCTrackHistoryID,\r\n\tB.ParsedFormName as ParsedFormName,\r\n\tB.FormName as FormName,\r\n\tB.[State] as [State],\r\n\tB.StateCode as StateCode,\r\n\tB.PremiumDiscountLevel1Factor as PremiumDiscountLevel1Factor,\r\n\tB.PremiumDiscountLevel2Factor as PremiumDiscountLevel2Factor,\r\n\tB.PremiumDiscountLevel3Factor as PremiumDiscountLevel3Factor,\r\n\tB.PremiumDiscountLevel4Factor as PremiumDiscountLevel4Factor,\r\n\tB.PremiumDiscountAveragePercentageDiscount as PremiumDiscountAveragePercentageDiscount,\r\n\tB.Name as Name,\r\n\tB.TransactionEffectiveDate as TransactionEffectiveDate,\r\n\tceiling(round(cast(B.rn as float)/@GroupSize,1)) as GroupId, \r\n\tB.rn%cast(@GroupSize as int) as GroupRowNumber \r\n\t--B.rn as GroupRowNumber\r\n\tFROM\r\n\t(\r\n\tSelect \r\n\tA.WCTrackHistoryID as WCTrackHistoryID,\r\n\tA.ParsedFormName as ParsedFormName,\r\n\tA.FormName as FormName,\r\n\tA.[State] as [State],\r\n\tA.StateCode as StateCode,\r\n\tA.PremiumDiscountLevel1Factor as PremiumDiscountLevel1Factor,\r\n\tA.PremiumDiscountLevel2Factor as PremiumDiscountLevel2Factor,\r\n\tA.PremiumDiscountLevel3Factor as PremiumDiscountLevel3Factor,\r\n\tA.PremiumDiscountLevel4Factor as PremiumDiscountLevel4Factor,\r\n\tA.PremiumDiscountAveragePercentageDiscount as PremiumDiscountAveragePercentageDiscount,\r\n\tA.Name as Name,\r\n\tA.TransactionEffectiveDate as TransactionEffectiveDate,\r\n\t\r\n\tROW_NUMBER() over (partition by A.WCTrackHistoryID, A.FormName order by A.RateEffectiveDate, A.[State] ) as rn\r\n\tFrom \r\n\t(SELECT Distinct\r\n\tTrack.WCTrackHistoryID as WCTrackHistoryID, \r\n\t'WC000406' as ParsedFormName,\r\n\tForms.FormName as FormName, \r\n\t\r\n\tStateTerm.[State] as State,\r\n\tsup.WCPOLSCode as StateCode,\r\n\tStateTerm.PremiumDiscountLevel1Factor as PremiumDiscountLevel1Factor,\r\n\tStateTerm.PremiumDiscountLevel2Factor as PremiumDiscountLevel2Factor,\r\n\tStateTerm.PremiumDiscountLevel3Factor as PremiumDiscountLevel3Factor,\r\n\tStateTerm.PremiumDiscountLevel4Factor as PremiumDiscountLevel4Factor,\r\n\tStateTerm.PremiumDiscountAveragePercentageDiscount  as PremiumDiscountAveragePercentageDiscount , \r\n\tStateTerm.wc_stateid,\r\n\tParty.Name as Name,\r\n\tPolicy.TransactionEffectiveDate as TransactionEffectiveDate,\r\n\tStateTerm.RateEffectiveDate\r\n\tFROM\r\n\tWorkWCForms Forms\r\n\tinner join WorkWCTrackHistory Track \ton \r\n\t\tForms.WCTrackHistoryID=Track.WCTrackHistoryID and \r\n\t\tForms.FormName like 'WC000406%' and \r\n\t\t((Forms.OnPolicy=1 OR Forms.[Add] = 1) AND (Forms.Remove is null OR Forms.Remove = 0))\r\n\tinner join WorkWCParty Party on \r\n\t\tParty.WCTrackHistoryID=Track.WCTrackHistoryID AND \r\n\t\tParty.PartyAssociationType='Account'\r\n\tinner join WorkWCPolicy Policy on \r\n\t\tPolicy.WCTrackHistoryID=Track.WCTrackHistoryID\r\n\tinner join WorkWCStateTerm StateTerm on \r\n\t\tStateTerm.WCTrackHistoryID=Track.WCTrackHistoryID\r\n\tinner join SupWCPOLS Sup on StateTerm.[State]=SourceCode AND\r\n\tTableName='WCPOLS30Record' and ProcessName='StateCodeRecord30'\r\n\t\r\n\tWHERE\r\n\tForms.Auditid = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\t@{pipeline().parameters.WHERE_CLAUSE_30}\r\n\t\r\n\t) A\r\n\t) B\r\n\torder by WCTrackHistoryID,FormName, GroupId, GroupRowNumber\n),\nEXP_InputCheck AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tParsedFormName,\n\tFormName,\n\tState,\n\tStateCode,\n\tPremiumDiscountLevel1Factor,\n\tPremiumDiscountLevel2Factor,\n\tPremiumDiscountLevel3Factor,\n\tPremiumDiscountLevel4Factor,\n\tPremiumDiscountAveragePercentageDiscount,\n\tName,\n\tTransactionEffectiveDate,\n\tGroupId,\n\tGroupRowNumber\n\tFROM SQ_WorkWCTrackHistory\n),\nSQ_WCPols00Record AS (\n\tSELECT\r\n\t\tWCTrackHistoryID,\r\n\t\tLinkData,\r\n\t      AuditId\r\n\tFROM dbo.WCPols00Record\r\n\tWHERE \r\n\t AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\r\n\tORDER BY WCTrackHistoryID\n),\nJNR_JoinSQs AS (SELECT\n\tSQ_WCPols00Record.WCTrackHistoryID, \n\tSQ_WCPols00Record.LinkData, \n\tSQ_WCPols00Record.AuditId, \n\tEXP_InputCheck.WCTrackHistoryID AS WCTrackHistoryID1, \n\tEXP_InputCheck.ParsedFormName, \n\tEXP_InputCheck.FormName, \n\tEXP_InputCheck.State, \n\tEXP_InputCheck.StateCode, \n\tEXP_InputCheck.PremiumDiscountLevel1Factor, \n\tEXP_InputCheck.PremiumDiscountLevel2Factor, \n\tEXP_InputCheck.PremiumDiscountLevel3Factor, \n\tEXP_InputCheck.PremiumDiscountLevel4Factor, \n\tEXP_InputCheck.PremiumDiscountAveragePercentageDiscount, \n\tEXP_InputCheck.Name, \n\tEXP_InputCheck.TransactionEffectiveDate, \n\tEXP_InputCheck.GroupId, \n\tEXP_InputCheck.GroupRowNumber\n\tFROM SQ_WCPols00Record\n\tINNER JOIN EXP_InputCheck\n\tON EXP_InputCheck.WCTrackHistoryID = SQ_WCPols00Record.WCTrackHistoryID\n),\nSRT_OrderByKeys AS (\n\tSELECT\n\tWCTrackHistoryID, \n\tFormName, \n\tGroupId, \n\tGroupRowNumber, \n\tState, \n\tStateCode, \n\tLinkData, \n\tAuditId, \n\tParsedFormName, \n\tPremiumDiscountLevel1Factor, \n\tPremiumDiscountLevel2Factor, \n\tPremiumDiscountLevel3Factor, \n\tPremiumDiscountLevel4Factor, \n\tPremiumDiscountAveragePercentageDiscount, \n\tName, \n\tTransactionEffectiveDate\n\tFROM JNR_JoinSQs\n\tORDER BY WCTrackHistoryID ASC, FormName ASC, GroupId ASC, GroupRowNumber ASC\n),\nAGG_GroupByTrackIdFormName AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tFormName,\n\tGroupId,\n\tGroupRowNumber AS rn,\n\tStateCode,\n\tLinkData,\n\tAuditId,\n\tParsedFormName,\n\tPremiumDiscountLevel1Factor,\n\tPremiumDiscountLevel2Factor,\n\tPremiumDiscountLevel3Factor,\n\tPremiumDiscountLevel4Factor,\n\tPremiumDiscountAveragePercentageDiscount,\n\t-- *INF*: MAX(StateCode, rn=1)\n\tMAX(StateCode, rn = 1) AS State_1,\n\t-- *INF*: MAX(StateCode, rn=2)\n\tMAX(StateCode, rn = 2) AS State_2,\n\t-- *INF*: MAX(StateCode, rn=3)\n\tMAX(StateCode, rn = 3) AS State_3,\n\t-- *INF*: MAX(StateCode, rn=4)\n\tMAX(StateCode, rn = 4) AS State_4,\n\t-- *INF*: MAX(StateCode, rn=5)\n\tMAX(StateCode, rn = 5) AS State_5,\n\t-- *INF*: MAX(StateCode, rn=0)\n\tMAX(StateCode, rn = 0) AS State_6,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=1)\n\tMAX(PremiumDiscountLevel1Factor, rn = 1) AS PremiumDiscountLevel1Factor_1,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=1)\n\tMAX(PremiumDiscountLevel2Factor, rn = 1) AS PremiumDiscountLevel2Factor_1,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=1)\n\tMAX(PremiumDiscountLevel3Factor, rn = 1) AS PremiumDiscountLevel3Factor_1,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=1)\n\tMAX(PremiumDiscountLevel4Factor, rn = 1) AS PremiumDiscountLevel4Factor_1,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=1)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 1) AS PremiumDiscountAveragePercentageDiscount_1,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=2)\n\tMAX(PremiumDiscountLevel1Factor, rn = 2) AS PremiumDiscountLevel1Factor_2,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=2)\n\tMAX(PremiumDiscountLevel2Factor, rn = 2) AS PremiumDiscountLevel2Factor_2,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=2)\n\tMAX(PremiumDiscountLevel3Factor, rn = 2) AS PremiumDiscountLevel3Factor_2,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=2)\n\tMAX(PremiumDiscountLevel4Factor, rn = 2) AS PremiumDiscountLevel4Factor_2,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=2)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 2) AS PremiumDiscountAveragePercentageDiscount_2,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=3)\n\tMAX(PremiumDiscountLevel1Factor, rn = 3) AS PremiumDiscountLevel1Factor_3,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=3)\n\tMAX(PremiumDiscountLevel2Factor, rn = 3) AS PremiumDiscountLevel2Factor_3,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=3)\n\tMAX(PremiumDiscountLevel3Factor, rn = 3) AS PremiumDiscountLevel3Factor_3,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=3)\n\tMAX(PremiumDiscountLevel4Factor, rn = 3) AS PremiumDiscountLevel4Factor_3,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=3)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 3) AS PremiumDiscountAveragePercentageDiscount_3,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=4)\n\tMAX(PremiumDiscountLevel1Factor, rn = 4) AS PremiumDiscountLevel1Factor_4,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=4)\n\tMAX(PremiumDiscountLevel2Factor, rn = 4) AS PremiumDiscountLevel2Factor_4,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=4)\n\tMAX(PremiumDiscountLevel3Factor, rn = 4) AS PremiumDiscountLevel3Factor_4,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=4)\n\tMAX(PremiumDiscountLevel4Factor, rn = 4) AS PremiumDiscountLevel4Factor_4,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=4)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 4) AS PremiumDiscountAveragePercentageDiscount_4,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=5)\n\tMAX(PremiumDiscountLevel1Factor, rn = 5) AS PremiumDiscountLevel1Factor_5,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=5)\n\tMAX(PremiumDiscountLevel2Factor, rn = 5) AS PremiumDiscountLevel2Factor_5,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=5)\n\tMAX(PremiumDiscountLevel3Factor, rn = 5) AS PremiumDiscountLevel3Factor_5,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=5)\n\tMAX(PremiumDiscountLevel4Factor, rn = 5) AS PremiumDiscountLevel4Factor_5,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=5)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 5) AS PremiumDiscountAveragePercentageDiscount_5,\n\t-- *INF*: MAX(PremiumDiscountLevel1Factor, rn=0)\n\tMAX(PremiumDiscountLevel1Factor, rn = 0) AS PremiumDiscountLevel1Factor_6,\n\t-- *INF*: MAX(PremiumDiscountLevel2Factor, rn=0)\n\tMAX(PremiumDiscountLevel2Factor, rn = 0) AS PremiumDiscountLevel2Factor_6,\n\t-- *INF*: MAX(PremiumDiscountLevel3Factor, rn=0)\n\tMAX(PremiumDiscountLevel3Factor, rn = 0) AS PremiumDiscountLevel3Factor_6,\n\t-- *INF*: MAX(PremiumDiscountLevel4Factor, rn=0)\n\tMAX(PremiumDiscountLevel4Factor, rn = 0) AS PremiumDiscountLevel4Factor_6,\n\t-- *INF*: MAX(PremiumDiscountAveragePercentageDiscount, rn=0)\n\tMAX(PremiumDiscountAveragePercentageDiscount, rn = 0) AS PremiumDiscountAveragePercentageDiscount_6,\n\tName,\n\tTransactionEffectiveDate\n\tFROM SRT_OrderByKeys\n\tGROUP BY WCTrackHistoryID, FormName, GroupId\n),\nEXP_AggOutput AS (\n\tSELECT\n\tWCTrackHistoryID,\n\tLinkData,\n\tCURRENT_TIMESTAMP AS ExtractDate,\n\tAuditId,\n\t'30' AS RecordTypeCode,\n\tParsedFormName,\n\tFormName,\n\tState_1 AS i_State_1,\n\tState_2 AS i_State_2,\n\tState_3 AS i_State_3,\n\tState_4 AS i_State_4,\n\tState_5 AS i_State_5,\n\tState_6 AS i_State_6,\n\t-- *INF*: IIF(not ISNULL(i_State_1) AND length(rtrim(ltrim(i_State_1)))>0,1,0)\n\tIFF(i_State_1 IS NULL AND length(rtrim(ltrim(i_State_1)))NOT  > 0, 1, 0) AS o_State_1_Valid,\n\t-- *INF*: IIF(not ISNULL(i_State_2) AND length(rtrim(ltrim(i_State_2)))>0,1,0)\n\tIFF(i_State_2 IS NULL AND length(rtrim(ltrim(i_State_2)))NOT  > 0, 1, 0) AS o_State_2_Valid,\n\t-- *INF*: IIF(not ISNULL(i_State_3) AND length(rtrim(ltrim(i_State_3)))>0,1,0)\n\tIFF(i_State_3 IS NULL AND length(rtrim(ltrim(i_State_3)))NOT  > 0, 1, 0) AS o_State_3_Valid,\n\t-- *INF*: IIF(not ISNULL(i_State_4) AND length(rtrim(ltrim(i_State_4)))>0,1,0)\n\tIFF(i_State_4 IS NULL AND length(rtrim(ltrim(i_State_4)))NOT  > 0, 1, 0) AS o_State_4_Valid,\n\t-- *INF*: IIF(not ISNULL(i_State_5) AND length(rtrim(ltrim(i_State_5)))>0,1,0)\n\tIFF(i_State_5 IS NULL AND length(rtrim(ltrim(i_State_5)))NOT  > 0, 1, 0) AS o_State_5_Valid,\n\t-- *INF*: IIF(not ISNULL(i_State_6) AND length(rtrim(ltrim(i_State_6)))>0,1,0)\n\tIFF(i_State_6 IS NULL AND length(rtrim(ltrim(i_State_6)))NOT  > 0, 1, 0) AS o_State_6_Valid,\n\tPremiumDiscountLevel1Factor_1 AS i_PremiumDiscountLevel1Factor_1,\n\tPremiumDiscountLevel2Factor_1 AS i_PremiumDiscountLevel2Factor_1,\n\tPremiumDiscountLevel3Factor_1 AS i_PremiumDiscountLevel3Factor_1,\n\tPremiumDiscountLevel4Factor_1 AS i_PremiumDiscountLevel4Factor_1,\n\tPremiumDiscountAveragePercentageDiscount_1 AS i_PremiumDiscountAveragePercentageDiscount_1,\n\tPremiumDiscountLevel1Factor_2,\n\tPremiumDiscountLevel2Factor_2,\n\tPremiumDiscountLevel3Factor_2,\n\tPremiumDiscountLevel4Factor_2,\n\tPremiumDiscountAveragePercentageDiscount_2,\n\tPremiumDiscountLevel1Factor_3,\n\tPremiumDiscountLevel2Factor_3,\n\tPremiumDiscountLevel3Factor_3,\n\tPremiumDiscountLevel4Factor_3,\n\tPremiumDiscountAveragePercentageDiscount_3,\n\tPremiumDiscountLevel1Factor_4,\n\tPremiumDiscountLevel2Factor_4,\n\tPremiumDiscountLevel3Factor_4,\n\tPremiumDiscountLevel4Factor_4,\n\tPremiumDiscountAveragePercentageDiscount_4,\n\tPremiumDiscountLevel1Factor_5,\n\tPremiumDiscountLevel2Factor_5,\n\tPremiumDiscountLevel3Factor_5,\n\tPremiumDiscountLevel4Factor_5,\n\tPremiumDiscountAveragePercentageDiscount_5,\n\tPremiumDiscountLevel1Factor_6,\n\tPremiumDiscountLevel2Factor_6,\n\tPremiumDiscountLevel3Factor_6,\n\tPremiumDiscountLevel4Factor_6,\n\tPremiumDiscountAveragePercentageDiscount_6,\n\tName,\n\tTransactionEffectiveDate,\n\t-- *INF*: TO_CHAR(TransactionEffectiveDate,'YYMMDD')\n\tTO_CHAR(TransactionEffectiveDate, 'YYMMDD') AS o_TransactionEffectiveDate\n\tFROM AGG_GroupByTrackIdFormName\n),\nmplt_Parse_FormNameField AS (WITH\n\tINPUT_FormName AS (\n\t\t\n\t),\n\tEXPTRANS AS (\n\t\tSELECT\n\t\tParsedNameOfForm,\n\t\tFormNameFromSource,\n\t\t-- *INF*: REVERSE(FormNameFromSource)\n\t\tREVERSE(FormNameFromSource) AS vReversedFromNameFromSource,\n\t\t-- *INF*: REVERSE(substr(vReversedFromNameFromSource,1,4))\n\t\tREVERSE(substr(vReversedFromNameFromSource, 1, 4)) AS vFormEdition,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- substr(vReversedFromNameFromSource,5,1) >='A' and substr(vReversedFromNameFromSource,5,1) <='Z', substr(vReversedFromNameFromSource,5,1),\r\n\t\t-- ' '\r\n\t\t-- )\r\n\t\t-- \r\n\t\t-- -- check if within A and Z, if not then space\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    substr(vReversedFromNameFromSource, 5, 1) >= 'A' and substr(vReversedFromNameFromSource, 5, 1) <= 'Z', substr(vReversedFromNameFromSource, 5, 1),\n\t\t    ' '\n\t\t) AS vBureauCode,\n\t\tvFormEdition AS oFormEdition,\n\t\tvBureauCode AS oBureauCode\n\t\tFROM INPUT_FormName\n\t),\n\tOUTPUT_FormName AS (\n\t\tSELECT\n\t\tParsedNameOfForm, \n\t\tFormNameFromSource, \n\t\toFormEdition AS FormEdition, \n\t\toBureauCode AS BureauCode\n\t\tFROM EXPTRANS\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_1 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_2 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_3 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_4 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_5 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nmplt_WCPOLS_FormatPremiumFactors_6 AS (WITH\n\tINPUT_WCPOLS_FormatPremiumFactors AS (\n\t\t\n\t),\n\tEXP_mplt_Input AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode,\n\t\tPremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage,\n\t\t'0010' AS FirstPremiumDiscountLayer,\n\t\t'0190' AS SecondPremiumDiscountLayer,\n\t\t'1550' AS ThirdPremiumDiscountLayer,\n\t\t'1550' AS BalancePremiumDiscountLayer\n\t\tFROM INPUT_WCPOLS_FormatPremiumFactors\n\t),\n\tEXP_ApplyFormatting AS (\n\t\tSELECT\n\t\tIsValid,\n\t\tStateCode AS i_StateCode,\n\t\tPremiumDiscountLevel1Factor AS i_PremiumDiscountLevel1Factor,\n\t\tPremiumDiscountLevel2Factor AS i_PremiumDiscountLevel2Factor,\n\t\tPremiumDiscountLevel3Factor AS i_PremiumDiscountLevel3Factor,\n\t\tPremiumDiscountLevel4Factor AS i_PremiumDiscountLevel4Factor,\n\t\tPremiumDiscountAveragePercentage AS i_PremiumDiscountAveragePercentage,\n\t\tFirstPremiumDiscountLayer AS i_FirstPremiumDiscountLayer,\n\t\tSecondPremiumDiscountLayer AS i_SecondPremiumDiscountLayer,\n\t\tThirdPremiumDiscountLayer AS i_ThirdPremiumDiscountLayer,\n\t\tBalancePremiumDiscountLayer AS i_BalancePremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1 and NOT ISNULL(i_StateCode),rtrim(ltrim(i_StateCode)),'')\n\t\tIFF(IsValid = 1 and i_StateCode IS NOT NULL, rtrim(ltrim(i_StateCode)), '') AS o_StateCode,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel1Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel1Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel1Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel1Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel1Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel2Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel2Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel2Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel2Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel2Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel3Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel3Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel3Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel3Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel3Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- IsValid=1 AND NOT ISNULL(i_PremiumDiscountLevel4Factor),LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountLevel4Factor*1000)),3,'0'),\r\n\t\t-- IsValid=1,'000',\r\n\t\t-- ''\r\n\t\t-- )\n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1 AND i_PremiumDiscountLevel4Factor IS NOT NULL, LPAD(TO_CHAR(CAST(i_PremiumDiscountLevel4Factor * 1000 AS INTEGER)), 3, '0'),\n\t\t    IsValid = 1, '000',\n\t\t    ''\n\t\t) AS o_PremiumDiscountLevel4Factor,\n\t\t-- *INF*: DECODE(TRUE,\r\n\t\t-- --IsValid=1, LPAD(REPLACECHR(0,i_PremiumDiscountAveragePercentage,'.',''),3,'0'),\r\n\t\t-- IsValid=1, LPAD(TO_CHAR(TO_INTEGER(i_PremiumDiscountAveragePercentage*10)),3,'0'),\r\n\t\t-- '')\r\n\t\t-- \r\n\t\t-- \n\t\tDECODE(\n\t\t    TRUE,\n\t\t    IsValid = 1, LPAD(TO_CHAR(CAST(i_PremiumDiscountAveragePercentage * 10 AS INTEGER)), 3, '0'),\n\t\t    ''\n\t\t) AS o_PremiumDiscountAveragePercentage,\n\t\t-- *INF*: IIF(IsValid=1, i_FirstPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_FirstPremiumDiscountLayer, '') AS o_FirstPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_SecondPremiumDiscountLayer, '')\n\t\tIFF(IsValid = 1, i_SecondPremiumDiscountLayer, '') AS o_SecondPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1, i_ThirdPremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_ThirdPremiumDiscountLayer, '') AS o_ThirdPremiumDiscountLayer,\n\t\t-- *INF*: IIF(IsValid=1,i_BalancePremiumDiscountLayer,'')\n\t\tIFF(IsValid = 1, i_BalancePremiumDiscountLayer, '') AS o_BalancePremiumDiscountLayer\n\t\tFROM EXP_mplt_Input\n\t),\n\tOUTPUT_WCPOLS_FormatPremiumFactors AS (\n\t\tSELECT\n\t\to_StateCode AS StateCode, \n\t\to_PremiumDiscountLevel1Factor AS PremiumDiscountLevel1Factor, \n\t\to_PremiumDiscountLevel2Factor AS PremiumDiscountLevel2Factor, \n\t\to_PremiumDiscountLevel3Factor AS PremiumDiscountLevel3Factor, \n\t\to_PremiumDiscountLevel4Factor AS PremiumDiscountLevel4Factor, \n\t\to_PremiumDiscountAveragePercentage AS PremiumDiscountAveragePercentage, \n\t\to_FirstPremiumDiscountLayer AS FirstPremiumDiscountLayer, \n\t\to_SecondPremiumDiscountLayer AS SecondPremiumDiscountLayer, \n\t\to_ThirdPremiumDiscountLayer AS ThirdPremiumDiscountLayer, \n\t\to_BalancePremiumDiscountLayer AS BalancePremiumDiscountLayer\n\t\tFROM EXP_ApplyFormatting\n\t),\n),\nWCPols30Record AS (\n\n\t------------ PRE SQL ----------\n\tDELETE\r\n\t  FROM dbo.WCPols30Record\r\n\tWHERE AuditId = @{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}\n\t-------------------------------\n\n\n\tINSERT INTO WCPols30Record\n\t(ExtractDate, AuditId, WCTrackHistoryID, LinkData, RecordTypeCode, EndorsementNumber, BureauVersionIdentifierEditionIdentifier, CarrierVersionIdentifier, StateCode, FirstPremiumDiscountLayer, FirstPremiumDiscountPercentage, SecondNextPremiumDiscountLayer, SecondNextPremiumDiscountPercentage, ThirdNextPremiumDiscountLayer, ThirdNextPremiumDiscountPercentage, BalancePremiumDiscountLayer, BalancePremiumDiscountPercentage, AveragePercentageDiscount, StateCode2, FirstPremiumDiscountLayer2, FirstPremiumDiscountPercentage2, SecondNextPremiumDiscountLayer2, SecondNextPremiumDiscountPercentage2, ThirdNextPremiumDiscountLayer2, ThirdNextPremiumDiscountPercentage2, BalancePremiumDiscountLayer2, BalancePremiumDiscountPercentage2, StateCode3, FirstPremiumDiscountLayer3, FirstPremiumDiscountPercentage3, SecondNextPremiumDiscountLayer3, SecondNextPremiumDiscountPercentage3, ThirdNextPremiumDiscountLayer3, ThirdNextPremiumDiscountPercentage3, BalancePremiumDiscountLayer3, BalancePremiumDiscountPercentage3, StateCode4, FirstPremiumDiscountLayer4, FirstPremiumDiscountPercentage4, SecondNextPremiumDiscountLayer4, SecondNextPremiumDiscountPercentage4, ThirdNextPremiumDiscountLayer4, ThirdNextPremiumDiscountPercentage4, BalancePremiumDiscountLayer4, BalancePremiumDiscountPercentage4, StateCode5, FirstPremiumDiscountLayer5, FirstPremiumDiscountPercentage5, SecondNextPremiumDiscountLayer5, SecondNextPremiumDiscountPercentage5, ThirdNextPremiumDiscountLayer5, ThirdNextPremiumDiscountPercentage5, BalancePremiumDiscountLayer5, BalancePremiumDiscountPercentage5, StateCode6, FirstPremiumDiscountLayer6, FirstPremiumDiscountPercentage6, SecondNextPremiumDiscountLayer6, SecondNextPremiumDiscountPercentage6, ThirdNextPremiumDiscountLayer6, ThirdNextPremiumDiscountPercentage6, BalancePremiumDiscountLayer6, BalancePremiumDiscountPercentage6, NameOfInsured, EndorsementEffectiveDate)\n\tSELECT \n\tEXP_AggOutput.EXTRACTDATE, \n\tEXP_AggOutput.AUDITID, \n\tEXP_AggOutput.WCTRACKHISTORYID, \n\tEXP_AggOutput.LINKDATA, \n\tEXP_AggOutput.RECORDTYPECODE, \n\tmplt_Parse_FormNameField.ParsedNameOfForm1 AS ENDORSEMENTNUMBER, \n\tmplt_Parse_FormNameField.BureauCode AS BUREAUVERSIONIDENTIFIEREDITIONIDENTIFIER, \n\tmplt_Parse_FormNameField.FormEdition AS CARRIERVERSIONIDENTIFIER, \n\tmplt_WCPOLS_FormatPremiumFactors_1.StateCode1 AS STATECODE, \n\tmplt_WCPOLS_FormatPremiumFactors_1.FIRSTPREMIUMDISCOUNTLAYER, \n\tmplt_WCPOLS_FormatPremiumFactors_1.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE, \n\tmplt_WCPOLS_FormatPremiumFactors_1.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER, \n\tmplt_WCPOLS_FormatPremiumFactors_1.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE, \n\tmplt_WCPOLS_FormatPremiumFactors_1.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER, \n\tmplt_WCPOLS_FormatPremiumFactors_1.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE, \n\tmplt_WCPOLS_FormatPremiumFactors_1.BALANCEPREMIUMDISCOUNTLAYER, \n\tmplt_WCPOLS_FormatPremiumFactors_1.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE, \n\tmplt_WCPOLS_FormatPremiumFactors_1.PremiumDiscountAveragePercentage1 AS AVERAGEPERCENTAGEDISCOUNT, \n\tmplt_WCPOLS_FormatPremiumFactors_2.StateCode1 AS STATECODE2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.FirstPremiumDiscountLayer AS FIRSTPREMIUMDISCOUNTLAYER2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.BalancePremiumDiscountLayer AS BALANCEPREMIUMDISCOUNTLAYER2, \n\tmplt_WCPOLS_FormatPremiumFactors_2.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE2, \n\tmplt_WCPOLS_FormatPremiumFactors_3.StateCode1 AS STATECODE3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.FirstPremiumDiscountLayer AS FIRSTPREMIUMDISCOUNTLAYER3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.BalancePremiumDiscountLayer AS BALANCEPREMIUMDISCOUNTLAYER3, \n\tmplt_WCPOLS_FormatPremiumFactors_3.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE3, \n\tmplt_WCPOLS_FormatPremiumFactors_4.StateCode1 AS STATECODE4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.FirstPremiumDiscountLayer AS FIRSTPREMIUMDISCOUNTLAYER4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.BalancePremiumDiscountLayer AS BALANCEPREMIUMDISCOUNTLAYER4, \n\tmplt_WCPOLS_FormatPremiumFactors_4.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE4, \n\tmplt_WCPOLS_FormatPremiumFactors_5.StateCode1 AS STATECODE5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.FirstPremiumDiscountLayer AS FIRSTPREMIUMDISCOUNTLAYER5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.BalancePremiumDiscountLayer AS BALANCEPREMIUMDISCOUNTLAYER5, \n\tmplt_WCPOLS_FormatPremiumFactors_5.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE5, \n\tmplt_WCPOLS_FormatPremiumFactors_6.StateCode1 AS STATECODE6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.FirstPremiumDiscountLayer AS FIRSTPREMIUMDISCOUNTLAYER6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.PremiumDiscountLevel1Factor1 AS FIRSTPREMIUMDISCOUNTPERCENTAGE6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.SecondPremiumDiscountLayer AS SECONDNEXTPREMIUMDISCOUNTLAYER6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.PremiumDiscountLevel2Factor1 AS SECONDNEXTPREMIUMDISCOUNTPERCENTAGE6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.ThirdPremiumDiscountLayer AS THIRDNEXTPREMIUMDISCOUNTLAYER6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.PremiumDiscountLevel3Factor1 AS THIRDNEXTPREMIUMDISCOUNTPERCENTAGE6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.BalancePremiumDiscountLayer AS BALANCEPREMIUMDISCOUNTLAYER6, \n\tmplt_WCPOLS_FormatPremiumFactors_6.PremiumDiscountLevel4Factor1 AS BALANCEPREMIUMDISCOUNTPERCENTAGE6, \n\tEXP_AggOutput.Name AS NAMEOFINSURED, \n\tEXP_AggOutput.o_TransactionEffectiveDate AS ENDORSEMENTEFFECTIVEDATE\n\tFROM mplt_WCPOLS_FormatPremiumFactors_5\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE_30": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}