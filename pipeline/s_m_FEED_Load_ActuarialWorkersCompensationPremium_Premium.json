{
    "name": "s_m_FEED_Load_ActuarialWorkersCompensationPremium_Premium",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_ActuarialWorkersCompensationPremium_Premium",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_PhysicalState AS (\n\tSELECT\n\tStateCode_Desc,\n\tStateAbbreviation\n\tFROM (\n\t\tselect \r\n\t\tStateAbbreviation as StateAbbreviation,\r\n\t\tStateCode+'|'+StateDescription as StateCode_Desc\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.StateDim\r\n\t\twhere CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StateAbbreviation ORDER BY StateCode_Desc) = 1\n),\nSQ_ActuarialAnalysis23Monthly_Premium AS (\n\tDeclare @BaseDate as date\r\n\tDeclare @Date as int\r\n\t\r\n\tset @BaseDate = case when '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QA%' or '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QC%'\r\n\tthen\r\n\tconvert(date,EOMONTH(getdate(),0))\r\n\telse\r\n\tconvert(date,EOMONTH(getdate(),-1))\r\n\tend \r\n\t\r\n\tSET @Date=CONCAT (datepart (yy,@BaseDate), FORMAT (@BaseDate,'MM')) \r\n\t\r\n\t\r\n\tSELECT \r\n\t\r\n\tPTF.modifiedPremiumtransactionmonthlyfactID as ActuarialworkerscompensationFactID,\r\n\t IRD.EnterpriseGroupCode as EnterpriseGroupCode,\r\n\t IRD.EnterpriseGroupAbbreviation as EnterpriseGroupAbbreviation,\r\n\t IRD.StrategicProfitCenterCode as StrategicProfitCenterCode,\r\n\t IRD.StrategicProfitCenterAbbreviation as StrategicProfitCenterAbbreviation,\r\n\t IRD.InsuranceReferenceLegalEntityCode as LegalEntityCode,\r\n\t IRD.InsuranceReferenceLegalEntityAbbreviation as LegalEntityAbbreviation,\r\n\t IRD.PolicyOfferingCode as PolicyOfferingCode,\r\n\t IRD.PolicyOfferingAbbreviation as PolicyOfferingAbbreviation,\r\n\t IRD.PolicyOfferingDescription as PolicyOfferingDescription,\r\n\t IRD.ProductCode as ProductCode,\r\n\t IRD.ProductAbbreviation as ProductAbbreviation,\r\n\t IRD.ProductDescription as ProductDescription,\r\n\t IRD.InsuranceReferenceLineOfBusinessCode as LineofBusinessCode,\r\n\t IRD.InsuranceReferenceLineOfBusinessAbbreviation as LineofBusinessAbbreviation,\r\n\t IRD.InsuranceReferenceLineOfBusinessDescription as LineofBusinessDescription,\r\n\t IRD.AccountingProductCode as AccountingProductCode,\r\n\t IRD.AccountingProductAbbreviation as AccountingProductAbbreviation,\r\n\t IRD.AccountingProductDescription as AccountingProductDescription,\r\n\t IRD.RatingPlanCode as RatingPlanCode,\r\n\t IRD.RatingPlanDescription as RatingPlanDescription, \r\n\t IRD.InsuranceSegmentCode as InsuranceSegmentCode,\r\n\t IRD.InsuranceSegmentDescription as InsuranceSegmentDescription,\r\n\t IRCD.CoverageSummaryCode as CoverageSummaryCode,\r\n\t IRCD.CoverageSummaryDescription as CoverageSummaryDescription,\r\n\t IRCD.CoverageGroupCode as CoverageGroupCode,\r\n\t IRCD.CoverageGroupDescription as CoverageGroupDescription,\r\n\t IRCD.CoverageCode as CoverageCode,\r\n\t IRCD.CoverageDescription as CoverageDescription,\r\n\t IRCD.RatedCoverageCode as RatedCoverageCode,\r\n\t IRCD.RatedCoverageDescription as RatedCoverageDescription,\r\n\t SUBSTRING(CDD.ClassCode,1,4) as ClassCode, \r\n\t CDD.ClassDescription as ClassDescription,\r\n\t CDD.RiskGradeCode as RiskGradeCode,\r\n\t CD.clndr_date as AccountingDate,\r\n\t CDD.RatingStateProvinceCode as RatingStateCode,\r\n\t CDD.RatingStateProvinceAbbreviation as RatingStateAbbreviation,\r\n\t CDD.LocationNumber as LocationNumber,\r\n\t CDD.RatingCity as RatingLocationCity,\r\n\t CDD.RatingCounty as RatingLocationCounty,\r\n\t CDD.RatingPostalCode as RatingLocationZIPCode,\r\n\t AD.EDWAgencyAKID as EDWAgencyAKID,\r\n\t ccd.edw_contract_cust_ak_id as edw_contract_cust_ak_id,\r\n\t pol.edw_pol_ak_id as pol_ak_id,\r\n\t CDWCD.HazardGroupCode as HazardGroupCode,\r\n\t CDD.DeductibleAmount as DeductibleAmount,\r\n\t CDWCD.PolicyPerAccidentLimit as LimitPerAccident,\r\n\t CDWCD.PolicyPerDiseaseLimit as LimitPerDisease,\r\n\t CDWCD.PolicyAggregateLimit as AggregateLimit,\r\n\t CDD.ExposureBasis as ExposureBasis,\r\n\t PTF.EDWPremiumMasterCalculationPKId as EDWPremiumMasterCalculationPKId,\r\n\t PTF.DirectWrittenPremium as DirectWrittenPremium,\r\n\t PTF.SubjectWrittenPremium as SubjectDirectWrittenPremium,\r\n\t PTF.ExperienceModifiedPremium as ExperienceModifiedDirectWrittenPremium,\r\n\t PTF.ScheduleModifiedPremium as ScheduleModifiedDirectWrittenPremium,\r\n\t PTF.OtherModifiedPremium as OtherModifiedDirectWrittenPremium,\r\n\t PTF.ClassifiedPremium as ClassifiedDirectWrittenPremium,\r\n\t CDWCD.AdmiraltyActFlag as Admir_act_ind,\r\n\t CDWCD.FederalEmployersLiabilityActFlag as Fela_ind,\r\n\t CDWCD.USLongShoreAndHarborWorkersCompensationActFlag as Uslh_ind,\r\n\t CDD.CoverageEffectiveDate as CoverageEffectiveDate,\r\n\t CDD.CoverageExpirationDate as CoverageExpirationDate,\r\n\t CDD.CoverageCancellationDate as CoverageCancellationDate,\r\n\t PTF.GeneratedRecordFlag as GeneratedRecordFlag\r\n\tFROM \r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.ModifiedPremiumTransactionMonthlyFact PTF \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol on PTF.PolicyDimId= pol.pol_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim AD on PTF.AgencyDimId =AD.AgencyDimID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer_dim CCD on PTF.ContractCustomerDimId=CCD.contract_cust_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.calendar_dim CD on CD.clndr_id = PTF.RunDateId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC'\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceCoverageDim IRCD on IRCD.InsuranceReferenceCoverageDimId = PTF.InsuranceReferenceCoverageDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailDim CDD on PTF.CoverageDetailDimId = CDD.CoverageDetailDimId\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailWorkersCompensationDim CDWCD on CDD.CoverageDetailDimId=CDWCD.CoverageDetailDimId\r\n\twhere CD.CalendarYearMonth  <= @Date\r\n\tAND PTF.modifiedPremiumtransactionmonthlyfactID % @{pipeline().parameters.NUM_OF_PARTITIONS}=1\n\t\n\tUNION ALL\n\tDeclare @BaseDate as date\r\n\tDeclare @Date as int\r\n\t\r\n\tset @BaseDate = case when '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QA%' or '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QC%'\r\n\tthen\r\n\tconvert(date,EOMONTH(getdate(),0))\r\n\telse\r\n\tconvert(date,EOMONTH(getdate(),-1))\r\n\tend \r\n\t\r\n\tSET @Date=CONCAT (datepart (yy,@BaseDate), FORMAT (@BaseDate,'MM')) \r\n\t\r\n\t\r\n\tSELECT \r\n\t\r\n\tPTF.modifiedPremiumtransactionmonthlyfactID as ActuarialworkerscompensationFactID,\r\n\t IRD.EnterpriseGroupCode as EnterpriseGroupCode,\r\n\t IRD.EnterpriseGroupAbbreviation as EnterpriseGroupAbbreviation,\r\n\t IRD.StrategicProfitCenterCode as StrategicProfitCenterCode,\r\n\t IRD.StrategicProfitCenterAbbreviation as StrategicProfitCenterAbbreviation,\r\n\t IRD.InsuranceReferenceLegalEntityCode as LegalEntityCode,\r\n\t IRD.InsuranceReferenceLegalEntityAbbreviation as LegalEntityAbbreviation,\r\n\t IRD.PolicyOfferingCode as PolicyOfferingCode,\r\n\t IRD.PolicyOfferingAbbreviation as PolicyOfferingAbbreviation,\r\n\t IRD.PolicyOfferingDescription as PolicyOfferingDescription,\r\n\t IRD.ProductCode as ProductCode,\r\n\t IRD.ProductAbbreviation as ProductAbbreviation,\r\n\t IRD.ProductDescription as ProductDescription,\r\n\t IRD.InsuranceReferenceLineOfBusinessCode as LineofBusinessCode,\r\n\t IRD.InsuranceReferenceLineOfBusinessAbbreviation as LineofBusinessAbbreviation,\r\n\t IRD.InsuranceReferenceLineOfBusinessDescription as LineofBusinessDescription,\r\n\t IRD.AccountingProductCode as AccountingProductCode,\r\n\t IRD.AccountingProductAbbreviation as AccountingProductAbbreviation,\r\n\t IRD.AccountingProductDescription as AccountingProductDescription,\r\n\t IRD.RatingPlanCode as RatingPlanCode,\r\n\t IRD.RatingPlanDescription as RatingPlanDescription, \r\n\t IRD.InsuranceSegmentCode as InsuranceSegmentCode,\r\n\t IRD.InsuranceSegmentDescription as InsuranceSegmentDescription,\r\n\t IRCD.CoverageSummaryCode as CoverageSummaryCode,\r\n\t IRCD.CoverageSummaryDescription as CoverageSummaryDescription,\r\n\t IRCD.CoverageGroupCode as CoverageGroupCode,\r\n\t IRCD.CoverageGroupDescription as CoverageGroupDescription,\r\n\t IRCD.CoverageCode as CoverageCode,\r\n\t IRCD.CoverageDescription as CoverageDescription,\r\n\t IRCD.RatedCoverageCode as RatedCoverageCode,\r\n\t IRCD.RatedCoverageDescription as RatedCoverageDescription,\r\n\t SUBSTRING(CDD.ClassCode,1,4) as ClassCode, \r\n\t CDD.ClassDescription as ClassDescription,\r\n\t CDD.RiskGradeCode as RiskGradeCode,\r\n\t CD.clndr_date as AccountingDate,\r\n\t CDD.RatingStateProvinceCode as RatingStateCode,\r\n\t CDD.RatingStateProvinceAbbreviation as RatingStateAbbreviation,\r\n\t CDD.LocationNumber as LocationNumber,\r\n\t CDD.RatingCity as RatingLocationCity,\r\n\t CDD.RatingCounty as RatingLocationCounty,\r\n\t CDD.RatingPostalCode as RatingLocationZIPCode,\r\n\t AD.EDWAgencyAKID as EDWAgencyAKID,\r\n\t ccd.edw_contract_cust_ak_id as edw_contract_cust_ak_id,\r\n\t pol.edw_pol_ak_id as pol_ak_id,\r\n\t CDWCD.HazardGroupCode as HazardGroupCode,\r\n\t CDD.DeductibleAmount as DeductibleAmount,\r\n\t CDWCD.PolicyPerAccidentLimit as LimitPerAccident,\r\n\t CDWCD.PolicyPerDiseaseLimit as LimitPerDisease,\r\n\t CDWCD.PolicyAggregateLimit as AggregateLimit,\r\n\t CDD.ExposureBasis as ExposureBasis,\r\n\t PTF.EDWPremiumMasterCalculationPKId as EDWPremiumMasterCalculationPKId,\r\n\t PTF.DirectWrittenPremium as DirectWrittenPremium,\r\n\t PTF.SubjectWrittenPremium as SubjectDirectWrittenPremium,\r\n\t PTF.ExperienceModifiedPremium as ExperienceModifiedDirectWrittenPremium,\r\n\t PTF.ScheduleModifiedPremium as ScheduleModifiedDirectWrittenPremium,\r\n\t PTF.OtherModifiedPremium as OtherModifiedDirectWrittenPremium,\r\n\t PTF.ClassifiedPremium as ClassifiedDirectWrittenPremium,\r\n\t CDWCD.AdmiraltyActFlag as Admir_act_ind,\r\n\t CDWCD.FederalEmployersLiabilityActFlag as Fela_ind,\r\n\t CDWCD.USLongShoreAndHarborWorkersCompensationActFlag as Uslh_ind,\r\n\t CDD.CoverageEffectiveDate as CoverageEffectiveDate,\r\n\t CDD.CoverageExpirationDate as CoverageExpirationDate,\r\n\t CDD.CoverageCancellationDate as CoverageCancellationDate,\r\n\t PTF.GeneratedRecordFlag as GeneratedRecordFlag\r\n\tFROM \r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.ModifiedPremiumTransactionMonthlyFact PTF \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol on PTF.PolicyDimId= pol.pol_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim AD on PTF.AgencyDimId =AD.AgencyDimID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer_dim CCD on PTF.ContractCustomerDimId=CCD.contract_cust_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.calendar_dim CD on CD.clndr_id = PTF.RunDateId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC'\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceCoverageDim IRCD on IRCD.InsuranceReferenceCoverageDimId = PTF.InsuranceReferenceCoverageDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailDim CDD on PTF.CoverageDetailDimId = CDD.CoverageDetailDimId\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailWorkersCompensationDim CDWCD on CDD.CoverageDetailDimId=CDWCD.CoverageDetailDimId\r\n\twhere CD.CalendarYearMonth  <= @Date\r\n\tAND PTF.modifiedPremiumtransactionmonthlyfactID % @{pipeline().parameters.NUM_OF_PARTITIONS}=2\n\t\n\tUNION ALL\n\tDeclare @BaseDate as date\r\n\tDeclare @Date as int\r\n\t\r\n\tset @BaseDate = case when '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QA%' or '@{pipeline().parameters.PMINTEGRATIONSERVICENAME}' like '%QC%'\r\n\tthen\r\n\tconvert(date,EOMONTH(getdate(),0))\r\n\telse\r\n\tconvert(date,EOMONTH(getdate(),-1))\r\n\tend \r\n\t\r\n\tSET @Date=CONCAT (datepart (yy,@BaseDate), FORMAT (@BaseDate,'MM')) \r\n\t\r\n\t\r\n\tSELECT \r\n\t\r\n\tPTF.modifiedPremiumtransactionmonthlyfactID as ActuarialworkerscompensationFactID,\r\n\t IRD.EnterpriseGroupCode as EnterpriseGroupCode,\r\n\t IRD.EnterpriseGroupAbbreviation as EnterpriseGroupAbbreviation,\r\n\t IRD.StrategicProfitCenterCode as StrategicProfitCenterCode,\r\n\t IRD.StrategicProfitCenterAbbreviation as StrategicProfitCenterAbbreviation,\r\n\t IRD.InsuranceReferenceLegalEntityCode as LegalEntityCode,\r\n\t IRD.InsuranceReferenceLegalEntityAbbreviation as LegalEntityAbbreviation,\r\n\t IRD.PolicyOfferingCode as PolicyOfferingCode,\r\n\t IRD.PolicyOfferingAbbreviation as PolicyOfferingAbbreviation,\r\n\t IRD.PolicyOfferingDescription as PolicyOfferingDescription,\r\n\t IRD.ProductCode as ProductCode,\r\n\t IRD.ProductAbbreviation as ProductAbbreviation,\r\n\t IRD.ProductDescription as ProductDescription,\r\n\t IRD.InsuranceReferenceLineOfBusinessCode as LineofBusinessCode,\r\n\t IRD.InsuranceReferenceLineOfBusinessAbbreviation as LineofBusinessAbbreviation,\r\n\t IRD.InsuranceReferenceLineOfBusinessDescription as LineofBusinessDescription,\r\n\t IRD.AccountingProductCode as AccountingProductCode,\r\n\t IRD.AccountingProductAbbreviation as AccountingProductAbbreviation,\r\n\t IRD.AccountingProductDescription as AccountingProductDescription,\r\n\t IRD.RatingPlanCode as RatingPlanCode,\r\n\t IRD.RatingPlanDescription as RatingPlanDescription, \r\n\t IRD.InsuranceSegmentCode as InsuranceSegmentCode,\r\n\t IRD.InsuranceSegmentDescription as InsuranceSegmentDescription,\r\n\t IRCD.CoverageSummaryCode as CoverageSummaryCode,\r\n\t IRCD.CoverageSummaryDescription as CoverageSummaryDescription,\r\n\t IRCD.CoverageGroupCode as CoverageGroupCode,\r\n\t IRCD.CoverageGroupDescription as CoverageGroupDescription,\r\n\t IRCD.CoverageCode as CoverageCode,\r\n\t IRCD.CoverageDescription as CoverageDescription,\r\n\t IRCD.RatedCoverageCode as RatedCoverageCode,\r\n\t IRCD.RatedCoverageDescription as RatedCoverageDescription,\r\n\t SUBSTRING(CDD.ClassCode,1,4) as ClassCode, \r\n\t CDD.ClassDescription as ClassDescription,\r\n\t CDD.RiskGradeCode as RiskGradeCode,\r\n\t CD.clndr_date as AccountingDate,\r\n\t CDD.RatingStateProvinceCode as RatingStateCode,\r\n\t CDD.RatingStateProvinceAbbreviation as RatingStateAbbreviation,\r\n\t CDD.LocationNumber as LocationNumber,\r\n\t CDD.RatingCity as RatingLocationCity,\r\n\t CDD.RatingCounty as RatingLocationCounty,\r\n\t CDD.RatingPostalCode as RatingLocationZIPCode,\r\n\t AD.EDWAgencyAKID as EDWAgencyAKID,\r\n\t ccd.edw_contract_cust_ak_id as edw_contract_cust_ak_id,\r\n\t pol.edw_pol_ak_id as pol_ak_id,\r\n\t CDWCD.HazardGroupCode as HazardGroupCode,\r\n\t CDD.DeductibleAmount as DeductibleAmount,\r\n\t CDWCD.PolicyPerAccidentLimit as LimitPerAccident,\r\n\t CDWCD.PolicyPerDiseaseLimit as LimitPerDisease,\r\n\t CDWCD.PolicyAggregateLimit as AggregateLimit,\r\n\t CDD.ExposureBasis as ExposureBasis,\r\n\t PTF.EDWPremiumMasterCalculationPKId as EDWPremiumMasterCalculationPKId,\r\n\t PTF.DirectWrittenPremium as DirectWrittenPremium,\r\n\t PTF.SubjectWrittenPremium as SubjectDirectWrittenPremium,\r\n\t PTF.ExperienceModifiedPremium as ExperienceModifiedDirectWrittenPremium,\r\n\t PTF.ScheduleModifiedPremium as ScheduleModifiedDirectWrittenPremium,\r\n\t PTF.OtherModifiedPremium as OtherModifiedDirectWrittenPremium,\r\n\t PTF.ClassifiedPremium as ClassifiedDirectWrittenPremium,\r\n\t CDWCD.AdmiraltyActFlag as Admir_act_ind,\r\n\t CDWCD.FederalEmployersLiabilityActFlag as Fela_ind,\r\n\t CDWCD.USLongShoreAndHarborWorkersCompensationActFlag as Uslh_ind,\r\n\t CDD.CoverageEffectiveDate as CoverageEffectiveDate,\r\n\t CDD.CoverageExpirationDate as CoverageExpirationDate,\r\n\t CDD.CoverageCancellationDate as CoverageCancellationDate,\r\n\t PTF.GeneratedRecordFlag as GeneratedRecordFlag\r\n\tFROM \r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.ModifiedPremiumTransactionMonthlyFact PTF \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol on PTF.PolicyDimId= pol.pol_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim AD on PTF.AgencyDimId =AD.AgencyDimID \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer_dim CCD on PTF.ContractCustomerDimId=CCD.contract_cust_dim_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.calendar_dim CD on CD.clndr_id = PTF.RunDateId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC'\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceCoverageDim IRCD on IRCD.InsuranceReferenceCoverageDimId = PTF.InsuranceReferenceCoverageDimId\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailDim CDD on PTF.CoverageDetailDimId = CDD.CoverageDetailDimId\r\n\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.CoverageDetailWorkersCompensationDim CDWCD on CDD.CoverageDetailDimId=CDWCD.CoverageDetailDimId\r\n\twhere CD.CalendarYearMonth  <= @Date\r\n\tAND PTF.modifiedPremiumtransactionmonthlyfactID % @{pipeline().parameters.NUM_OF_PARTITIONS}=3\n),\nLKP_AD_Current_SD AS (\n\tSELECT\n\tEDWAgencyAKID,\n\tAgencyCode,\n\tAgencyDoingBusinessAsName,\n\tAgencyStateAbbreviation,\n\tAgencyPhysicalAddressCity,\n\tAgencyZIPCode,\n\tSalesDivisionDimId\n\tFROM (\n\t\tselect \r\n\t\t ad_Current.EDWAgencyAKID as EDWAgencyAKID,\r\n\t\t ad_Current.AgencyCode as AgencyCode,\r\n\t\t ad_Current.AgencyDoingBusinessAsName as AgencyDoingBusinessAsName,\r\n\t\t ad_current.PhysicalStateAbbreviation as AgencyStateAbbreviation,\r\n\t\t ad_Current.PhysicalCity as AgencyPhysicalAddressCity,\r\n\t\t ad_Current.PhysicalZipCode as AgencyZIPCode,\r\n\t\t-- Removed below columns as per WREQ-13710\r\n\t\t-- ad_Current.LegalPrimaryAgencyCode as PrimaryAgencyCode,\r\n\t\t-- SD.AgencyDoingBusinessAsName as PrimaryAgencyDoingBusinessAsName,\r\n\t\t-- SD.PhysicalStateAbbreviation as PrimaryAgencyStateAbbreviation,\r\n\t\t-- SD.PhysicalCity as PrimaryAgencyPhysicalAddressCity,\r\n\t\t-- SD.PhysicalZipCode as PrimaryAgencyZIPCode,\r\n\t\t ad_current.SalesDivisionDimId as SalesDivisionDimId\r\n\t\t from\r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim ad_Current --to get the current Agency attribute \r\n\t\t--LEFT JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim SD on SD.AgencyCode=ad_Current.LegalPrimaryAgencyCode AND SD.CurrentSnapshotFlag= 1 \r\n\t\twhere ad_Current.CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID ORDER BY EDWAgencyAKID) = 1\n),\nLKP_AgencyRelationship AS (\n\tSELECT\n\tPrim_Agency_Code,\n\tPrim_Agency_State_Code,\n\tprim_agency_name,\n\tprim_agency_status_code,\n\tprim_agency_state_abbr,\n\tprim_agency_city,\n\tprim_agency_zip_code,\n\tEDWAgencyAKID\n\tFROM (\n\t\tselect Latest_LPAC.EDWAgencyAKId as EDWAgencyAKId ,\r\n\t\t  SD.agencycode as prim_agency_code,\r\n\t\t  Left((SD.agencycode),2) as prim_agency_state_code,\r\n\t\t  SD.AgencyDoingBusinessAsName as prim_agency_name,\r\n\t\tSD.AgencyStatusCode as prim_agency_status_code,\r\n\t\tSD.PhysicalStateAbbreviation as prim_agency_state_abbr,\r\n\t\tSD.PhysicalCity as prim_agency_city,\r\n\t\tSD.PhysicalZipCode as prim_agency_zip_code\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER_V3}.AgencyDim SD \r\n\t\tInner Join  (\r\n\t\t Select EDWAgencyAKId,EDWLegalPrimaryAgencyAKId from \r\n\t\t  (\r\n\t\t\tselect EDWAgencyAKId, \r\n\t\t  EDWLegalPrimaryAgencyAKId, row_number() over (partition by edwAgencyAKID order by AgencyRelationshipexpirationdate desc ) As rowNum \r\n\t\t  from @{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyRelationshipCurrent\r\n\t\t  where AgencyRelationshipexpirationdate != '1800-01-01'\r\n\t\t  ) a\r\n\t\t  where a.rowNum = 1 \r\n\t\t  ) Latest_LPAC\r\n\t\t  on Latest_LPAC.EDWLegalPrimaryAgencyAKId=SD.EDWAgencyAKId\r\n\t\t  where SD.CurrentSnapshotFlag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID ORDER BY Prim_Agency_Code) = 1\n),\nLKP_CCD_Current AS (\n\tSELECT\n\tcust_num,\n\tname,\n\tsic_code,\n\tsic_code_descript,\n\tnaics_code,\n\tnaics_code_descript,\n\tfed_tax_id,\n\tedw_contract_cust_ak_id\n\tFROM (\n\t\tSELECT cust_num as cust_num, [name] as name, sic_code as sic_code, sic_code_descript as sic_code_descript, naics_code as naics_code ,\r\n\t\tnaics_code_descript as naics_code_descript, fed_tax_id as fed_tax_id , edw_contract_cust_ak_id  as edw_contract_cust_ak_id\r\n\t\tFROM DBO.contract_customer_dim WHERE crrnt_snpsht_flag =1 \r\n\t\tand edw_contract_cust_ak_id in (\r\n\t\tSELECT DISTINCT CC.edw_contract_cust_ak_id\r\n\t\tFROM DBO.premiummasterfact PTF \r\n\t\tINNER JOIN DBO.contract_customer_dim CC on PTF.ContractCustomerDimID= CC.contract_cust_dim_id \r\n\t\tINNER JOIN DBO.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC'\r\n\t\t)\r\n\t\tORDER BY edw_contract_cust_ak_id --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id ORDER BY cust_num) = 1\n),\nLKP_Pol_Current AS (\n\tSELECT\n\tedw_pol_ak_id,\n\tProgramCode,\n\tProgramDescription,\n\tAssociationCode,\n\tAssociationDescription,\n\tindustry_risk_grade_code,\n\tindustry_risk_grade_code_descript,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_rsn_code,\n\tpol_cancellation_rsn_code_descript,\n\torig_incptn_date,\n\trenl_code,\n\trenl_code_descript,\n\tpol_status_code,\n\tpol_status_code_descript,\n\tpol_key,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_issue_code,\n\tpol_issue_code_descript,\n\tstate_of_domicile_code,\n\tstate_of_domicile_abbrev,\n\tstate_of_domicile_code_descript,\n\tprim_bus_class_code,\n\tprim_bus_class_code_descript,\n\tBusinessClassDimId,\n\tUnderwritingDivisionDimId,\n\tserv_center_support_code,\n\tprior_pol_key,\n\tRolloverPriorCarrier,\n\tAgencyEmployeeDimID,\n\tPriorPolicyNumber,\n\tPriorPolicySymbol,\n\tPriorPolicyVersion,\n\tPriorPolicyEffectiveDate\n\tFROM (\n\t\tSELECT policy_dim.edw_pol_ak_id as edw_pol_ak_id,\r\n\t\tpolicy_dim.ProgramCode as ProgramCode, \r\n\t\tpolicy_dim.ProgramDescription as ProgramDescription, \r\n\t\tpolicy_dim.AssociationCode as AssociationCode, \r\n\t\tpolicy_dim.AssociationDescription as AssociationDescription, \r\n\t\tpolicy_dim.industry_risk_grade_code as industry_risk_grade_code, \r\n\t\tpolicy_dim.industry_risk_grade_code_descript as industry_risk_grade_code_descript, \r\n\t\tpolicy_dim.pol_eff_date as pol_eff_date, policy_dim.pol_exp_date as pol_exp_date, \r\n\t\tpolicy_dim.pol_cancellation_rsn_code as pol_cancellation_rsn_code, \r\n\t\tpolicy_dim.pol_cancellation_rsn_code_descript as pol_cancellation_rsn_code_descript, \r\n\t\tpolicy_dim.orig_incptn_date as orig_incptn_date, \r\n\t\tpolicy_dim.renl_code as renl_code, \r\n\t\tpolicy_dim.renl_code_descript as renl_code_descript, \r\n\t\tpolicy_dim.pol_status_code as pol_status_code, \r\n\t\tpolicy_dim.pol_status_code_descript as pol_status_code_descript, \r\n\t\tpolicy_dim.pol_key as pol_key, \r\n\t\tpolicy_dim.pol_sym as pol_sym, \r\n\t\tpolicy_dim.pol_num as pol_num, \r\n\t\tpolicy_dim.pol_mod as pol_mod, \r\n\t\tpolicy_dim.pol_issue_code as pol_issue_code, \r\n\t\tpolicy_dim.pol_issue_code_descript as pol_issue_code_descript, \r\n\t\tpolicy_dim.state_of_domicile_code as state_of_domicile_code, \r\n\t\tpolicy_dim.state_of_domicile_abbrev as state_of_domicile_abbrev, \r\n\t\tpolicy_dim.state_of_domicile_code_descript as state_of_domicile_code_descript, \r\n\t\tpolicy_dim.prim_bus_class_code as prim_bus_class_code, \r\n\t\tpolicy_dim.prim_bus_class_code_descript as prim_bus_class_code_descript, \r\n\t\tpolicy_dim.BusinessClassDimId as BusinessClassDimId, \r\n\t\tpolicy_dim.UnderwritingDivisionDimId as UnderwritingDivisionDimId, \r\n\t\tpolicy_dim.serv_center_support_code as serv_center_support_code, \r\n\t\tpolicy_dim.prior_pol_key as prior_pol_key, \r\n\t\tpolicy_dim.RolloverPriorCarrier as RolloverPriorCarrier, \r\n\t\tpolicy_dim.AgencyEmployeeDimID as AgencyEmployeeDimID, \r\n\t\tprior_pol.pol_num as PriorPolicyNumber,\r\n\t\tprior_pol.pol_sym as PriorPolicySymbol,\r\n\t\tprior_pol.pol_mod as PriorPolicyVersion,\r\n\t\tprior_pol.pol_eff_date as PriorPolicyEffectiveDate\r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim policy_dim\r\n\t\tLEFT OUTER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim prior_pol on prior_pol.pol_key= policy_dim.prior_pol_key \r\n\t\tand prior_pol.crrnt_snpsht_flag =1 and policy_dim.crrnt_snpsht_flag = 1\r\n\t\tWHERE policy_dim.edw_pol_ak_id in (\r\n\t\tSELECT DISTINCT POL.edw_pol_ak_id\r\n\t\tFROM DBO.premiummasterfact PTF \r\n\t\tINNER JOIN DBO.policy_dim pol on PTF.PolicyDimId= pol.pol_dim_id \r\n\t\tINNER JOIN DBO.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC')\r\n\t\tORDER BY policy_dim.edw_pol_ak_id --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_ak_id ORDER BY edw_pol_ak_id) = 1\n),\nLKP_aed_current AS (\n\tSELECT\n\tProducerCode,\n\tProducerFullName,\n\ti_AgencyEmployeeDimID,\n\tAgencyEmployeeDimID\n\tFROM (\n\t\tselect AED.AgencyEmployeeDimID as AgencyEmployeeDimID,\r\n\t\taed_current.ProducerCode as ProducerCode,\r\n\t\t(case when aed_current.AgencyEmployeeRole= 'Producer' then \r\n\t\taed_current.AgencyEmployeeFirstName + ' ' + aed_current.agencyemployeelastname else 'N/A' end ) as ProducerFullName\r\n\t\tfrom\r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyEmployeeDim AED \r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.AgencyEmployeeDim aed_current --to get the current AgencyEmployeeDim attribute\r\n\t\ton aed.EDWAgencyEmployeeAKID = aed_current.EDWAgencyEmployeeAKID  and aed_current.CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyEmployeeDimID ORDER BY ProducerCode) = 1\n),\nEXP_PassVal AS (\n\tSELECT\n\tSQ_ActuarialAnalysis23Monthly_Premium.ModifiedPremiumTransactionMonthlyFactId,\n\tSQ_ActuarialAnalysis23Monthly_Premium.EnterpriseGroupCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.EnterpriseGroupAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.StrategicProfitCenterCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.StrategicProfitCenterAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LegalEntityCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LegalEntityAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyOfferingCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyOfferingAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyOfferingDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ProductCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ProductAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ProductDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LineOfBusinessCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LineOfBusinessAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LineOfBusinessDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.AccountingProductCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.AccountingProductAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.AccountingProductDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingPlanCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingPlanDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.InsuranceSegmentCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.InsuranceSegmentDescription,\n\tLKP_Pol_Current.ProgramCode,\n\tLKP_Pol_Current.ProgramDescription,\n\tLKP_Pol_Current.AssociationCode,\n\tLKP_Pol_Current.AssociationDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageSummaryCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageSummaryDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageGroupCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageGroupDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ClassCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ClassDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RiskGradeCode AS IndustryRiskGradeCode,\n\t-- *INF*: DECODE (TRUE,IndustryRiskGradeCode='1' , 'Excellent' ,\r\n\t-- IndustryRiskGradeCode='2' , 'Excellent' ,\r\n\t-- IndustryRiskGradeCode='3' , 'Good' ,\r\n\t-- IndustryRiskGradeCode='4' , 'Good' ,\r\n\t-- IndustryRiskGradeCode='5' , 'Average' ,\r\n\t-- IndustryRiskGradeCode='6' , 'Marginal' ,\r\n\t-- IndustryRiskGradeCode='7' , 'Marginal' ,\r\n\t-- IndustryRiskGradeCode='8' , 'Poor' ,\r\n\t-- IndustryRiskGradeCode='9' , 'Poor' ,\r\n\t-- IndustryRiskGradeCode='0' , 'NSI Bonds' ,\r\n\t-- IndustryRiskGradeCode='D' , 'Do Not Write' ,\r\n\t-- IndustryRiskGradeCode='N/A' , 'Not Available' ,\r\n\t-- IndustryRiskGradeCode='DNW' , 'Do Not Write' ,\r\n\t-- IndustryRiskGradeCode='NSI' , 'NSI' ,\r\n\t-- IndustryRiskGradeCode='Argent' , 'Argent' , 'Not Available')\n\tDECODE(\n\t    TRUE,\n\t    IndustryRiskGradeCode = '1', 'Excellent',\n\t    IndustryRiskGradeCode = '2', 'Excellent',\n\t    IndustryRiskGradeCode = '3', 'Good',\n\t    IndustryRiskGradeCode = '4', 'Good',\n\t    IndustryRiskGradeCode = '5', 'Average',\n\t    IndustryRiskGradeCode = '6', 'Marginal',\n\t    IndustryRiskGradeCode = '7', 'Marginal',\n\t    IndustryRiskGradeCode = '8', 'Poor',\n\t    IndustryRiskGradeCode = '9', 'Poor',\n\t    IndustryRiskGradeCode = '0', 'NSI Bonds',\n\t    IndustryRiskGradeCode = 'D', 'Do Not Write',\n\t    IndustryRiskGradeCode = 'N/A', 'Not Available',\n\t    IndustryRiskGradeCode = 'DNW', 'Do Not Write',\n\t    IndustryRiskGradeCode = 'NSI', 'NSI',\n\t    IndustryRiskGradeCode = 'Argent', 'Argent',\n\t    'Not Available'\n\t) AS v_IndustryRiskGradeDescription,\n\tv_IndustryRiskGradeDescription AS IndustryRiskGradeDescription,\n\tLKP_Pol_Current.pol_eff_date AS PolicyEffectiveDate,\n\tLKP_Pol_Current.pol_exp_date AS PolicyExpirationDate,\n\tLKP_Pol_Current.pol_cancellation_rsn_code AS PolicyCancellationReasonCode,\n\tLKP_Pol_Current.pol_cancellation_rsn_code_descript AS PolicyCancellationReasonCodeDescription,\n\tLKP_Pol_Current.orig_incptn_date AS PolicyOriginalInceptionDate,\n\tLKP_Pol_Current.renl_code AS PolicyRenewalCode,\n\tLKP_Pol_Current.renl_code_descript AS PolicyRenewalDescription,\n\tLKP_Pol_Current.pol_status_code AS PolicyStatusCode,\n\tLKP_Pol_Current.pol_status_code_descript AS PolicyStatusCodeDescription,\n\tSQ_ActuarialAnalysis23Monthly_Premium.AccountingDate,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingStateCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingStateAbbreviation,\n\tSQ_ActuarialAnalysis23Monthly_Premium.LocationNumber,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingLocationCity,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingLocationCounty,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatingLocationZIPCode,\n\tLKP_Pol_Current.pol_key AS PolicyKey,\n\tLKP_Pol_Current.pol_sym AS PolicySymbol,\n\tLKP_Pol_Current.pol_num AS PolicyNumber,\n\tLKP_Pol_Current.pol_mod AS PolicyVersion,\n\tLKP_Pol_Current.pol_issue_code AS PolicyIssueCode,\n\tLKP_Pol_Current.pol_issue_code_descript AS PolicyIssueCodeDescription,\n\tLKP_Pol_Current.state_of_domicile_code AS PrimaryRatingStateCode,\n\tLKP_Pol_Current.state_of_domicile_abbrev AS PrimaryRatingStateAbbreviation,\n\tLKP_Pol_Current.state_of_domicile_code_descript AS PrimaryRatingStateDescription,\n\tLKP_Pol_Current.prim_bus_class_code AS PrimaryBusinessClassificationCode,\n\tLKP_Pol_Current.prim_bus_class_code_descript AS PrimaryBusinessClassificationDescription,\n\tLKP_Pol_Current.BusinessClassDimId,\n\tLKP_AD_Current_SD.AgencyCode,\n\tLKP_AD_Current_SD.AgencyDoingBusinessAsName,\n\tLKP_AD_Current_SD.AgencyStateAbbreviation,\n\tLKP_AD_Current_SD.AgencyPhysicalAddressCity,\n\tLKP_AD_Current_SD.AgencyZIPCode,\n\tLKP_aed_current.ProducerCode,\n\tLKP_aed_current.ProducerFullName,\n\tLKP_Pol_Current.UnderwritingDivisionDimId,\n\tLKP_AgencyRelationship.Prim_Agency_Code AS PrimaryAgencyCode,\n\tLKP_AgencyRelationship.prim_agency_name AS PrimaryAgencyDoingBusinessAsName,\n\tLKP_AgencyRelationship.prim_agency_state_abbr AS PrimaryAgencyStateAbbreviation,\n\tLKP_AgencyRelationship.prim_agency_city AS PrimaryAgencyPhysicalAddressCity,\n\tLKP_AgencyRelationship.prim_agency_zip_code AS PrimaryAgencyZIPCode,\n\tLKP_AD_Current_SD.SalesDivisionDimId,\n\tLKP_CCD_Current.cust_num AS CustomerNumber,\n\tLKP_CCD_Current.name AS FirstNamedInsured,\n\tLKP_CCD_Current.sic_code AS SICCode,\n\tLKP_CCD_Current.sic_code_descript AS SICDescription,\n\tLKP_CCD_Current.naics_code AS NAICSCode,\n\tLKP_CCD_Current.naics_code_descript AS NAICSDescription,\n\tLKP_Pol_Current.serv_center_support_code AS CustomerCareIndicator,\n\tLKP_Pol_Current.prior_pol_key AS PriorPolicyKey,\n\tLKP_Pol_Current.PriorPolicyNumber,\n\tLKP_Pol_Current.PriorPolicySymbol,\n\tLKP_Pol_Current.PriorPolicyVersion,\n\tSQ_ActuarialAnalysis23Monthly_Premium.pol_ak_id,\n\tSQ_ActuarialAnalysis23Monthly_Premium.HazardGroupCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.DeductibleAmount,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyPerAccidentLimit,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyPerDiseaseLimit,\n\tSQ_ActuarialAnalysis23Monthly_Premium.PolicyAggregateLimit,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ExposureBasis,\n\tSQ_ActuarialAnalysis23Monthly_Premium.EDWPremiumMasterCalculationPKId,\n\tSQ_ActuarialAnalysis23Monthly_Premium.DirectWrittenPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.SubjectWrittenPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ExperienceModifiedPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ScheduleModifiedPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.OtherModifiedPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.ClassifiedPremium,\n\tSQ_ActuarialAnalysis23Monthly_Premium.AdmiraltyActFlag,\n\tSQ_ActuarialAnalysis23Monthly_Premium.FederalEmployersLiabilityActFlag,\n\tSQ_ActuarialAnalysis23Monthly_Premium.USLongShoreAndHarborWorkersCompensationActFlag,\n\tLKP_CCD_Current.fed_tax_id AS FederalEmployerIDNumberfein,\n\tLKP_Pol_Current.RolloverPriorCarrier,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageEffectiveDate,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageExpirationDate,\n\tSQ_ActuarialAnalysis23Monthly_Premium.CoverageCancellationDate,\n\tLKP_Pol_Current.PriorPolicyEffectiveDate,\n\tSQ_ActuarialAnalysis23Monthly_Premium.GeneratedRecordFlag,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatedCoverageCode,\n\tSQ_ActuarialAnalysis23Monthly_Premium.RatedCoverageDescription\n\tFROM SQ_ActuarialAnalysis23Monthly_Premium\n\tLEFT JOIN LKP_AD_Current_SD\n\tON LKP_AD_Current_SD.EDWAgencyAKID = SQ_ActuarialAnalysis23Monthly_Premium.EDWAgencyAKID\n\tLEFT JOIN LKP_AgencyRelationship\n\tON LKP_AgencyRelationship.EDWAgencyAKID = LKP_AD_Current_SD.EDWAgencyAKID\n\tLEFT JOIN LKP_CCD_Current\n\tON LKP_CCD_Current.edw_contract_cust_ak_id = SQ_ActuarialAnalysis23Monthly_Premium.edw_contract_cust_ak_id\n\tLEFT JOIN LKP_Pol_Current\n\tON LKP_Pol_Current.edw_pol_ak_id = SQ_ActuarialAnalysis23Monthly_Premium.pol_ak_id\n\tLEFT JOIN LKP_aed_current\n\tON LKP_aed_current.AgencyEmployeeDimID = LKP_Pol_Current.AgencyEmployeeDimID\n),\nLKP_BusinessClassDim AS (\n\tSELECT\n\tBusinessSegmentCode,\n\tBusinessSegmentDescription,\n\tStrategicBusinessGroupCode,\n\tStrategicBusinessGroupDescription,\n\tBusinessClassDimId\n\tFROM (\n\t\tSELECT \n\t\t\tBusinessSegmentCode,\n\t\t\tBusinessSegmentDescription,\n\t\t\tStrategicBusinessGroupCode,\n\t\t\tStrategicBusinessGroupDescription,\n\t\t\tBusinessClassDimId\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.BusinessClassDim\n\t\tWHERE CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY BusinessClassDimId ORDER BY BusinessSegmentCode) = 1\n),\nLKP_StateDim AS (\n\tSELECT\n\tStateDimID,\n\tStateDescription,\n\tin_RatingStateAbbreviation,\n\tStateAbbreviation\n\tFROM (\n\t\tSELECT \n\t\t\tStateDimID,\n\t\t\tStateDescription,\n\t\t\tin_RatingStateAbbreviation,\n\t\t\tStateAbbreviation\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.StateDim\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY StateAbbreviation ORDER BY StateDimID) = 1\n),\nLKP_DividendFact AS (\n\tSELECT\n\tDividendTypeDimId,\n\tin_pol_ak_id,\n\tin_StateDimID,\n\tpol_ak_id,\n\tStateDimId\n\tFROM (\n\t\tSelect pol.edw_pol_ak_id as pol_ak_id ,\r\n\t\tDF.StateDimId as StateDimId ,\r\n\t\tDF.DividendTypeDimId as DividendTypeDimId \r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.DividendFact DF \r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD on DF.StrategicProfitCenterDimId = IRD.InsuranceReferenceDimId and IRD.PolicyOfferingAbbreviation='WC'\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim pol on DF.PolicyDimId= pol.pol_dim_id \r\n\t\tOrder by pol.edw_pol_ak_id,DF.StateDimId,DF.DividendRundateId desc\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,StateDimId ORDER BY DividendTypeDimId) = 1\n),\nLKP_DividendTypeDim AS (\n\tSELECT\n\tDividendType,\n\tDividendPlan,\n\tin_DividendTypeDimId,\n\tDividendTypeDimId\n\tFROM (\n\t\tSELECT \n\t\t\tDividendType,\n\t\t\tDividendPlan,\n\t\t\tin_DividendTypeDimId,\n\t\t\tDividendTypeDimId\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.DividendTypeDim\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY DividendTypeDimId ORDER BY DividendType) = 1\n),\nLKP_PolicyCurrentStatusDim AS (\n\tSELECT\n\tPolicyCancellationDate,\n\tPolicyStatusCode,\n\tPolicyStatusDescription,\n\tin_pol_ak_id,\n\tEDWPolicyAKId\n\tFROM (\n\t\tSELECT EDWPolicyAKId as EDWPolicyAKId, PolicyCancellationDate as PolicyCancellationDate,\r\n\t\tcase \r\n\t\twhen PolicyStatusDescription = 'Cancelled' then 'C'\r\n\t\twhen PolicyStatusDescription = 'Future Inforce' then 'F'\r\n\t\twhen PolicyStatusDescription = 'Inforce' then 'I'\r\n\t\twhen PolicyStatusDescription = 'Not Inforce' then 'N'\r\n\t\telse 'N/A'\r\n\t\tend as PolicyStatusCode,\r\n\t\tPolicyStatusDescription as PolicyStatusDescription\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCurrentStatusDim pol_cstatus\r\n\t\twhere RunDate = (select max(b.rundate) from  @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCurrentStatusDim b where b.EDWPolicyAKId=pol_cstatus.EDWPolicyAKId)\r\n\t\tAND EDWPolicyAKId in (\r\n\t\tSELECT DISTINCT POL.edw_pol_ak_id\r\n\t\tFROM DBO.premiummasterfact PTF \r\n\t\tINNER JOIN DBO.policy_dim pol on PTF.PolicyDimId= pol.pol_dim_id \r\n\t\tINNER JOIN DBO.InsuranceReferenceDim IRD on IRD.InsuranceReferenceDimid= PTF.InsuranceReferenceDimId and PolicyOfferingAbbreviation='WC')\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWPolicyAKId ORDER BY PolicyCancellationDate) = 1\n),\nLKP_PremiumMasterFact AS (\n\tSELECT\n\tEDWPremiumMasterCalculationPKID,\n\tWrittenExposure,\n\tin_EDWPremiumMasterCalculationPKId\n\tFROM (\n\t\tSelect PMF.EDWPremiumMasterCalculationPKID as EDWPremiumMasterCalculationPKID ,\r\n\t\tPMF.WrittenExposure as WrittenExposure\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumMasterFact PMF \r\n\t\tInner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD on PMF.InsuranceReferenceDimId = IRD.InsuranceReferenceDimId  \r\n\t\tWHERE IRD.PolicyOfferingAbbreviation='WC' and PMF.AuditID > 0 \r\n\t\tand PMF.EDWPremiumMasterCalculationPKID <> -1 \r\n\t\tand PMF.WrittenExposure <> 0.00\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWPremiumMasterCalculationPKID ORDER BY EDWPremiumMasterCalculationPKID) = 1\n),\nLKP_SalesDivisionDim AS (\n\tSELECT\n\tRegionalSalesManagerDisplayName,\n\tSalesTerritoryCode,\n\tSalesDivisionDimID\n\tFROM (\n\t\tSELECT \n\t\t\tRegionalSalesManagerDisplayName,\n\t\t\tSalesTerritoryCode,\n\t\t\tSalesDivisionDimID\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.SalesDivisionDim\n\t\tWHERE CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY SalesDivisionDimID ORDER BY RegionalSalesManagerDisplayName) = 1\n),\nLKP_UnderwritingDivisionDim AS (\n\tSELECT\n\tUnderwriterDisplayName,\n\tUnderwriterManagerDisplayName,\n\tUnderwritingRegionCodeDescription,\n\tUnderwritingDivisionDimID\n\tFROM (\n\t\tSELECT \n\t\t\tUnderwriterDisplayName,\n\t\t\tUnderwriterManagerDisplayName,\n\t\t\tUnderwritingRegionCodeDescription,\n\t\t\tUnderwritingDivisionDimID\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.UnderwritingDivisionDim\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY UnderwritingDivisionDimID ORDER BY UnderwriterDisplayName) = 1\n),\nEXP_GetValues AS (\n\tSELECT\n\tEXP_PassVal.ModifiedPremiumTransactionMonthlyFactId AS i_ModifiedPremiumTransactionMonthlyFactId,\n\tEXP_PassVal.EnterpriseGroupCode AS i_EnterpriseGroupCode,\n\tEXP_PassVal.EnterpriseGroupAbbreviation AS i_EnterpriseGroupAbbreviation,\n\tEXP_PassVal.StrategicProfitCenterCode AS i_StrategicProfitCenterCode,\n\tEXP_PassVal.StrategicProfitCenterAbbreviation AS i_StrategicProfitCenterAbbreviation,\n\tEXP_PassVal.LegalEntityCode AS i_LegalEntityCode,\n\tEXP_PassVal.LegalEntityAbbreviation AS i_LegalEntityAbbreviation,\n\tEXP_PassVal.PolicyOfferingCode AS i_PolicyOfferingCode,\n\tEXP_PassVal.PolicyOfferingAbbreviation AS i_PolicyOfferingAbbreviation,\n\tEXP_PassVal.PolicyOfferingDescription AS i_PolicyOfferingDescription,\n\tEXP_PassVal.ProductCode AS i_ProductCode,\n\tEXP_PassVal.ProductAbbreviation AS i_ProductAbbreviation,\n\tEXP_PassVal.ProductDescription AS i_ProductDescription,\n\tEXP_PassVal.LineOfBusinessCode AS i_LineOfBusinessCode,\n\tEXP_PassVal.LineOfBusinessAbbreviation AS i_LineOfBusinessAbbreviation,\n\tEXP_PassVal.LineOfBusinessDescription AS i_LineOfBusinessDescription,\n\tEXP_PassVal.AccountingProductCode AS i_AccountingProductCode,\n\tEXP_PassVal.AccountingProductAbbreviation AS i_AccountingProductAbbreviation,\n\tEXP_PassVal.AccountingProductDescription AS i_AccountingProductDescription,\n\tEXP_PassVal.RatingPlanCode AS i_RatingPlanCode,\n\tEXP_PassVal.RatingPlanDescription AS i_RatingPlanDescription,\n\tEXP_PassVal.InsuranceSegmentCode AS i_InsuranceSegmentCode,\n\tEXP_PassVal.InsuranceSegmentDescription AS i_InsuranceSegmentDescription,\n\tEXP_PassVal.ProgramCode AS i_ProgramCode,\n\tEXP_PassVal.ProgramDescription AS i_ProgramDescription,\n\tEXP_PassVal.AssociationCode AS i_AssociationCode,\n\tEXP_PassVal.AssociationDescription AS i_AssociationDescription,\n\tEXP_PassVal.CoverageSummaryCode AS i_CoverageSummaryCode,\n\tEXP_PassVal.CoverageSummaryDescription AS i_CoverageSummaryDescription,\n\tEXP_PassVal.CoverageGroupCode AS i_CoverageGroupCode,\n\tEXP_PassVal.CoverageGroupDescription AS i_CoverageGroupDescription,\n\tEXP_PassVal.CoverageCode AS i_CoverageCode,\n\tEXP_PassVal.CoverageDescription AS i_CoverageDescription,\n\tEXP_PassVal.RatedCoverageCode AS i_RatedCoverageCode,\n\tEXP_PassVal.RatedCoverageDescription AS i_RatedCoverageDescription,\n\tEXP_PassVal.ClassCode AS i_ClassCode,\n\tEXP_PassVal.ClassDescription AS i_ClassDescription,\n\tEXP_PassVal.IndustryRiskGradeCode AS i_IndustryRiskGradeCode,\n\tEXP_PassVal.IndustryRiskGradeDescription AS i_IndustryRiskGradeDescription,\n\tEXP_PassVal.PolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tEXP_PassVal.PolicyExpirationDate AS i_PolicyExpirationDate,\n\tLKP_PolicyCurrentStatusDim.PolicyCancellationDate AS i_PolicyCancellationDate,\n\tEXP_PassVal.PolicyCancellationReasonCode AS i_PolicyCancellationReasonCode,\n\tEXP_PassVal.PolicyCancellationReasonCodeDescription AS i_PolicyCancellationReasonCodeDescription,\n\tEXP_PassVal.PolicyOriginalInceptionDate AS i_PolicyOriginalInceptionDate,\n\tEXP_PassVal.PolicyRenewalCode AS i_PolicyRenewalCode,\n\tEXP_PassVal.PolicyRenewalDescription AS i_PolicyRenewalDescription,\n\tLKP_PolicyCurrentStatusDim.PolicyStatusCode AS i_PolicyStatusCode,\n\tLKP_PolicyCurrentStatusDim.PolicyStatusDescription AS i_PolicyStatusCodeDescription,\n\tEXP_PassVal.AccountingDate AS i_AccountingDate,\n\tEXP_PassVal.RatingStateCode AS i_RatingStateCode,\n\tEXP_PassVal.RatingStateAbbreviation AS i_RatingStateAbbreviation,\n\tLKP_StateDim.StateDescription AS lkp_RatingStateName,\n\tEXP_PassVal.LocationNumber AS i_LocationNumber,\n\tEXP_PassVal.RatingLocationCity AS i_RatingLocationCity,\n\tEXP_PassVal.RatingLocationCounty AS i_RatingLocationCounty,\n\tEXP_PassVal.RatingLocationZIPCode AS i_RatingLocationZIPCode,\n\tEXP_PassVal.PolicyKey AS i_PolicyKey,\n\tEXP_PassVal.PolicySymbol AS i_PolicySymbol,\n\tEXP_PassVal.PolicyNumber AS i_PolicyNumber,\n\tEXP_PassVal.PolicyVersion AS i_PolicyVersion,\n\tEXP_PassVal.PolicyIssueCode AS i_PolicyIssueCode,\n\tEXP_PassVal.PolicyIssueCodeDescription AS i_PolicyIssueCodeDescription,\n\tEXP_PassVal.PrimaryRatingStateCode AS i_PrimaryRatingStateCode,\n\tEXP_PassVal.PrimaryRatingStateAbbreviation AS i_PrimaryRatingStateAbbreviation,\n\tEXP_PassVal.PrimaryRatingStateDescription AS i_PrimaryRatingStateDescription,\n\tEXP_PassVal.PrimaryBusinessClassificationCode AS i_PrimaryBusinessClassificationCode,\n\tEXP_PassVal.PrimaryBusinessClassificationDescription AS i_PrimaryBusinessClassificationDescription,\n\tLKP_BusinessClassDim.BusinessSegmentCode AS lkp_BusinessSegmentCode,\n\tLKP_BusinessClassDim.BusinessSegmentDescription AS lkp_BusinessSegmentDescription,\n\tLKP_BusinessClassDim.StrategicBusinessGroupCode AS lkp_StrategicBusinessGroupCode,\n\tLKP_BusinessClassDim.StrategicBusinessGroupDescription AS lkp_StrategicBusinessGroupDescription,\n\tEXP_PassVal.AgencyCode AS i_AgencyCode,\n\tEXP_PassVal.AgencyDoingBusinessAsName AS i_AgencyDoingBusinessAsName,\n\tEXP_PassVal.AgencyStateAbbreviation AS i_AgencyStateAbbreviation,\n\tEXP_PassVal.AgencyPhysicalAddressCity AS i_AgencyPhysicalAddressCity,\n\tEXP_PassVal.AgencyZIPCode AS i_AgencyZIPCode,\n\tEXP_PassVal.ProducerCode AS i_ProducerCode,\n\tEXP_PassVal.ProducerFullName AS i_ProducerFullName,\n\tLKP_UnderwritingDivisionDim.UnderwriterDisplayName AS lkp_UnderwriterDisplayName,\n\tLKP_UnderwritingDivisionDim.UnderwriterManagerDisplayName AS lkp_UnderwriterManagerDisplayName,\n\tLKP_UnderwritingDivisionDim.UnderwritingRegionCodeDescription AS lkp_UnderwritingRegionCodeDescription,\n\tEXP_PassVal.PrimaryAgencyCode AS i_PrimaryAgencyCode,\n\tEXP_PassVal.PrimaryAgencyDoingBusinessAsName AS i_PrimaryAgencyDoingBusinessAsName,\n\tEXP_PassVal.PrimaryAgencyStateAbbreviation AS i_PrimaryAgencyStateAbbreviation,\n\tEXP_PassVal.PrimaryAgencyPhysicalAddressCity AS i_PrimaryAgencyPhysicalAddressCity,\n\tEXP_PassVal.PrimaryAgencyZIPCode AS i_PrimaryAgencyZIPCode,\n\tLKP_SalesDivisionDim.RegionalSalesManagerDisplayName AS lkp_RegionalSalesManagerDisplayName,\n\tLKP_SalesDivisionDim.SalesTerritoryCode AS lkp_SalesTerritoryCode,\n\tEXP_PassVal.CustomerNumber AS i_CustomerNumber,\n\tEXP_PassVal.FirstNamedInsured AS i_FirstNamedInsured,\n\tEXP_PassVal.SICCode AS i_SICCode,\n\tEXP_PassVal.SICDescription AS i_SICDescription,\n\tEXP_PassVal.NAICSCode AS i_NAICSCode,\n\tEXP_PassVal.NAICSDescription AS i_NAICSDescription,\n\tEXP_PassVal.CustomerCareIndicator AS i_CustomerCareIndicator,\n\tEXP_PassVal.PriorPolicyKey AS i_PriorPolicyKey,\n\tEXP_PassVal.PriorPolicyNumber AS i_PriorPolicyNumber,\n\tEXP_PassVal.PriorPolicySymbol AS i_PriorPolicySymbol,\n\tEXP_PassVal.PriorPolicyVersion AS i_PriorPolicyVersion,\n\tLKP_DividendTypeDim.DividendPlan AS lkp_DividendPlan,\n\tLKP_DividendTypeDim.DividendType AS lkp_DividendType,\n\tEXP_PassVal.HazardGroupCode AS i_HazardGroupCode,\n\tEXP_PassVal.DeductibleAmount AS i_DeductibleAmount,\n\tEXP_PassVal.PolicyPerAccidentLimit AS i_PolicyPerAccidentLimit,\n\tEXP_PassVal.PolicyPerDiseaseLimit AS i_PolicyPerDiseaseLimit,\n\tEXP_PassVal.PolicyAggregateLimit AS i_PolicyAggregateLimit,\n\tEXP_PassVal.ExposureBasis AS i_ExposureBasis,\n\tEXP_PassVal.DirectWrittenPremium AS i_DirectWrittenPremium,\n\tEXP_PassVal.SubjectWrittenPremium AS i_SubjectWrittenPremium,\n\tEXP_PassVal.ExperienceModifiedPremium AS i_ExperienceModifiedPremium,\n\tEXP_PassVal.ScheduleModifiedPremium AS i_ScheduleModifiedPremium,\n\tEXP_PassVal.OtherModifiedPremium AS i_OtherModifiedPremium,\n\tEXP_PassVal.ClassifiedPremium AS i_ClassifiedPremium,\n\tEXP_PassVal.AdmiraltyActFlag AS i_AdmiraltyActFlag,\n\tEXP_PassVal.FederalEmployersLiabilityActFlag AS i_FederalEmployersLiabilityActFlag,\n\tEXP_PassVal.USLongShoreAndHarborWorkersCompensationActFlag AS i_USLongShoreAndHarborWorkersCompensationActFlag,\n\tEXP_PassVal.FederalEmployerIDNumberfein AS i_FederalEmployerIDNumberfein,\n\tEXP_PassVal.RolloverPriorCarrier AS i_RolloverPriorCarrier,\n\tEXP_PassVal.CoverageEffectiveDate AS i_CoverageEffectiveDate,\n\tEXP_PassVal.CoverageExpirationDate AS i_CoverageExpirationDate,\n\tEXP_PassVal.CoverageCancellationDate AS i_CoverageCancellationDate,\n\tEXP_PassVal.PriorPolicyEffectiveDate AS i_PriorPolicyEffectiveDate,\n\tEXP_PassVal.GeneratedRecordFlag AS i_GeneratedRecordFlag,\n\tLKP_PremiumMasterFact.EDWPremiumMasterCalculationPKID AS lkp_EDWPremiumMasterCalculationPKID,\n\tLKP_PremiumMasterFact.WrittenExposure AS lkp_WrittenExposure,\n\t-- *INF*: :LKP.LKP_PhysicalState(i_AgencyStateAbbreviation)\n\tLKP_PHYSICALSTATE_i_AgencyStateAbbreviation.StateCode_Desc AS v_AgencyStateCode_desc,\n\t-- *INF*: :LKP.LKP_PhysicalState(i_PrimaryAgencyStateAbbreviation)\n\tLKP_PHYSICALSTATE_i_PrimaryAgencyStateAbbreviation.StateCode_Desc AS v_PrimaryAgencyStateCode_desc,\n\t-- *INF*: IIF(i_PolicyIssueCode='N','Y','N')\r\n\t-- \n\tIFF(i_PolicyIssueCode = 'N', 'Y', 'N') AS v_NewBusinessIndicator,\n\t-- *INF*: IIF( ISNULL(lkp_EDWPremiumMasterCalculationPKID) , 0.00 ,IIF(i_GeneratedRecordFlag='F' or i_GeneratedRecordFlag = '0',lkp_WrittenExposure,0.00))\n\tIFF(\n\t    lkp_EDWPremiumMasterCalculationPKID IS NULL, 0.00,\n\t    IFF(\n\t        i_GeneratedRecordFlag = 'F'\n\t    or i_GeneratedRecordFlag = '0', lkp_WrittenExposure,\n\t        0.00\n\t    )\n\t) AS v_DirectWrittenExposure,\n\t-- *INF*: IIF(ISNULL(i_PolicyEffectiveDate),TO_DATE('1800-01-01 00:00:00','YYYY-MM-DD HH24:MI:SS'),i_PolicyEffectiveDate)\n\tIFF(\n\t    i_PolicyEffectiveDate IS NULL, TO_TIMESTAMP('1800-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_PolicyEffectiveDate\n\t) AS v_PolicyEffectiveDate,\n\t-- *INF*: IIF(ISNULL(i_PolicyExpirationDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_PolicyExpirationDate)\n\tIFF(\n\t    i_PolicyExpirationDate IS NULL, TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_PolicyExpirationDate\n\t) AS v_PolicyExpirationDate,\n\t-- *INF*: IIF(ISNULL(i_PolicyCancellationDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_PolicyCancellationDate)\n\tIFF(\n\t    i_PolicyCancellationDate IS NULL,\n\t    TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_PolicyCancellationDate\n\t) AS v_PolicyCancellationDate,\n\t-- *INF*: IIF(ISNULL(i_AccountingDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_AccountingDate)\n\tIFF(\n\t    i_AccountingDate IS NULL, TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_AccountingDate\n\t) AS v_AccountingDate,\n\t-- *INF*: DECODE(i_AdmiraltyActFlag, 'F' , 'N' , 'T' , 'Y' , 'N' )\n\tDECODE(\n\t    i_AdmiraltyActFlag,\n\t    'F', 'N',\n\t    'T', 'Y',\n\t    'N'\n\t) AS v_AdmiraltyActFlag,\n\t-- *INF*: DECODE(i_FederalEmployersLiabilityActFlag, 'F' , 'N' , 'T' , 'Y' , 'N' )\n\tDECODE(\n\t    i_FederalEmployersLiabilityActFlag,\n\t    'F', 'N',\n\t    'T', 'Y',\n\t    'N'\n\t) AS v_FederalEmployersLiabilityActFlag,\n\t-- *INF*: DECODE(i_USLongShoreAndHarborWorkersCompensationActFlag, 'F' , 'N' , 'T' , 'Y' , 'N' )\n\tDECODE(\n\t    i_USLongShoreAndHarborWorkersCompensationActFlag,\n\t    'F', 'N',\n\t    'T', 'Y',\n\t    'N'\n\t) AS v_USLongshoreAndHarborWorkersCompensationActFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate,\n\t-- *INF*: IIF(ISNULL(i_ModifiedPremiumTransactionMonthlyFactId ), -1, i_ModifiedPremiumTransactionMonthlyFactId)\r\n\t-- \r\n\t--  \n\tIFF(\n\t    i_ModifiedPremiumTransactionMonthlyFactId IS NULL, - 1,\n\t    i_ModifiedPremiumTransactionMonthlyFactId\n\t) AS o_EDWActuarialWorkersCompensationFactId,\n\t'WrittenPremium' AS o_EDWActuarialWorkersCompensationFactType,\n\t-- *INF*: IIF(ISNULL(i_EnterpriseGroupCode ),'N/A',i_EnterpriseGroupCode ) \n\tIFF(i_EnterpriseGroupCode IS NULL, 'N/A', i_EnterpriseGroupCode) AS o_EnterpriseGroupCode,\n\t-- *INF*: IIF(ISNULL(i_EnterpriseGroupAbbreviation ),'N/A', i_EnterpriseGroupAbbreviation)\n\tIFF(i_EnterpriseGroupAbbreviation IS NULL, 'N/A', i_EnterpriseGroupAbbreviation) AS o_EnterpriseGroupAbbreviation,\n\t-- *INF*: IIF(ISNULL( i_StrategicProfitCenterCode),'N/A', i_StrategicProfitCenterCode)\n\tIFF(i_StrategicProfitCenterCode IS NULL, 'N/A', i_StrategicProfitCenterCode) AS o_StrategicProfitCenterCode,\n\t-- *INF*: IIF(ISNULL(i_StrategicProfitCenterAbbreviation ),'N/A',i_StrategicProfitCenterAbbreviation )\n\tIFF(i_StrategicProfitCenterAbbreviation IS NULL, 'N/A', i_StrategicProfitCenterAbbreviation) AS o_StrategicProfitCenterAbbreviation,\n\t-- *INF*: IIF(ISNULL(i_LegalEntityCode ),'N/A',i_LegalEntityCode )\n\tIFF(i_LegalEntityCode IS NULL, 'N/A', i_LegalEntityCode) AS o_LegalEntityCode,\n\t-- *INF*: IIF(ISNULL( i_LegalEntityAbbreviation),'N/A',i_LegalEntityAbbreviation )\n\tIFF(i_LegalEntityAbbreviation IS NULL, 'N/A', i_LegalEntityAbbreviation) AS o_LegalEntityAbbreviation,\n\t-- *INF*: IIF(ISNULL(i_PolicyOfferingCode ),'N/A',i_PolicyOfferingCode )\n\tIFF(i_PolicyOfferingCode IS NULL, 'N/A', i_PolicyOfferingCode) AS o_PolicyOfferingCode,\n\t-- *INF*: IIF(ISNULL(i_PolicyOfferingAbbreviation ),'N/A',i_PolicyOfferingAbbreviation )\n\tIFF(i_PolicyOfferingAbbreviation IS NULL, 'N/A', i_PolicyOfferingAbbreviation) AS o_PolicyOfferingAbbreviation,\n\t-- *INF*: IIF(ISNULL( i_PolicyOfferingDescription),'N/A', i_PolicyOfferingDescription)\n\tIFF(i_PolicyOfferingDescription IS NULL, 'N/A', i_PolicyOfferingDescription) AS o_PolicyOfferingDescription,\n\t-- *INF*: IIF(ISNULL( i_ProductCode),'N/A',  i_ProductCode)\n\tIFF(i_ProductCode IS NULL, 'N/A', i_ProductCode) AS o_ProductCode,\n\t-- *INF*: IIF(ISNULL(i_ProductAbbreviation ),'N/A', i_ProductAbbreviation)\n\tIFF(i_ProductAbbreviation IS NULL, 'N/A', i_ProductAbbreviation) AS o_ProductAbbreviation,\n\t-- *INF*: IIF(ISNULL( i_ProductDescription),'N/A',i_ProductDescription )\n\tIFF(i_ProductDescription IS NULL, 'N/A', i_ProductDescription) AS o_ProductDescription,\n\t-- *INF*: IIF(ISNULL(i_LineOfBusinessCode ),'N/A',i_LineOfBusinessCode )\n\tIFF(i_LineOfBusinessCode IS NULL, 'N/A', i_LineOfBusinessCode) AS o_LineOfBusinessCode,\n\t-- *INF*: IIF(ISNULL( i_LineOfBusinessAbbreviation),'N/A',i_LineOfBusinessAbbreviation )\n\tIFF(i_LineOfBusinessAbbreviation IS NULL, 'N/A', i_LineOfBusinessAbbreviation) AS o_LineOfBusinessAbbreviation,\n\t-- *INF*: IIF(ISNULL(i_LineOfBusinessDescription ),'N/A',i_LineOfBusinessDescription )\n\tIFF(i_LineOfBusinessDescription IS NULL, 'N/A', i_LineOfBusinessDescription) AS o_LineOfBusinessDescription,\n\t-- *INF*: IIF(ISNULL( i_AccountingProductCode),'N/A',i_AccountingProductCode )\n\tIFF(i_AccountingProductCode IS NULL, 'N/A', i_AccountingProductCode) AS o_AccountingProductCode,\n\t-- *INF*: IIF(ISNULL( i_AccountingProductAbbreviation),'N/A',i_AccountingProductAbbreviation )\n\tIFF(i_AccountingProductAbbreviation IS NULL, 'N/A', i_AccountingProductAbbreviation) AS o_AccountingProductAbbreviation,\n\t-- *INF*: IIF(ISNULL( i_AccountingProductDescription),'N/A', i_AccountingProductDescription)\n\tIFF(i_AccountingProductDescription IS NULL, 'N/A', i_AccountingProductDescription) AS o_AccountingProductDescription,\n\t-- *INF*: IIF(ISNULL(i_RatingPlanCode ),'N/A', i_RatingPlanCode)\n\tIFF(i_RatingPlanCode IS NULL, 'N/A', i_RatingPlanCode) AS o_RatingPlanCode,\n\t-- *INF*: IIF(ISNULL( i_RatingPlanDescription),'N/A', i_RatingPlanDescription)\n\tIFF(i_RatingPlanDescription IS NULL, 'N/A', i_RatingPlanDescription) AS o_RatingPlanDescription,\n\t-- *INF*: IIF(ISNULL(i_InsuranceSegmentCode ),'N/A',i_InsuranceSegmentCode )\n\tIFF(i_InsuranceSegmentCode IS NULL, 'N/A', i_InsuranceSegmentCode) AS o_InsuranceSegmentCode,\n\t-- *INF*: IIF(ISNULL( i_InsuranceSegmentDescription),'N/A',i_InsuranceSegmentDescription )\n\tIFF(i_InsuranceSegmentDescription IS NULL, 'N/A', i_InsuranceSegmentDescription) AS o_InsuranceSegmentDescription,\n\t-- *INF*: IIF(ISNULL( i_ProgramCode),'N/A', i_ProgramCode)\n\tIFF(i_ProgramCode IS NULL, 'N/A', i_ProgramCode) AS o_ProgramCode,\n\t-- *INF*: IIF(ISNULL( i_ProgramDescription),'N/A', i_ProgramDescription)\n\tIFF(i_ProgramDescription IS NULL, 'N/A', i_ProgramDescription) AS o_ProgramDescription,\n\t-- *INF*: IIF(ISNULL(i_AssociationCode ),'N/A',i_AssociationCode )\n\tIFF(i_AssociationCode IS NULL, 'N/A', i_AssociationCode) AS o_AssociationCode,\n\t-- *INF*: IIF(ISNULL( i_AssociationDescription),'N/A', i_AssociationDescription)\n\tIFF(i_AssociationDescription IS NULL, 'N/A', i_AssociationDescription) AS o_AssociationDescription,\n\t-- *INF*: IIF(ISNULL( i_CoverageSummaryCode),'N/A',i_CoverageSummaryCode )\n\tIFF(i_CoverageSummaryCode IS NULL, 'N/A', i_CoverageSummaryCode) AS o_CoverageSummaryCode,\n\t-- *INF*: IIF(ISNULL(i_CoverageSummaryDescription ),'N/A', i_CoverageSummaryDescription)\n\tIFF(i_CoverageSummaryDescription IS NULL, 'N/A', i_CoverageSummaryDescription) AS o_CoverageSummaryDescription,\n\t-- *INF*: IIF(ISNULL(i_CoverageGroupCode ),'N/A', i_CoverageGroupCode)\n\tIFF(i_CoverageGroupCode IS NULL, 'N/A', i_CoverageGroupCode) AS o_CoverageGroupCode,\n\t-- *INF*: IIF(ISNULL(i_CoverageGroupDescription ),'N/A', i_CoverageGroupDescription)\n\tIFF(i_CoverageGroupDescription IS NULL, 'N/A', i_CoverageGroupDescription) AS o_CoverageGroupDescription,\n\t-- *INF*: IIF(ISNULL( i_CoverageCode),'N/A', i_CoverageCode)\n\tIFF(i_CoverageCode IS NULL, 'N/A', i_CoverageCode) AS o_CoverageCode,\n\t-- *INF*: IIF(ISNULL( i_CoverageDescription),'N/A', i_CoverageDescription)\n\tIFF(i_CoverageDescription IS NULL, 'N/A', i_CoverageDescription) AS o_CoverageDescription,\n\t-- *INF*: IIF(ISNULL( i_RatedCoverageCode),'N/A', i_RatedCoverageCode)\n\tIFF(i_RatedCoverageCode IS NULL, 'N/A', i_RatedCoverageCode) AS o_RatedCoverageCode,\n\t-- *INF*: IIF(ISNULL( i_RatedCoverageDescription),'N/A', i_RatedCoverageDescription)\n\tIFF(i_RatedCoverageDescription IS NULL, 'N/A', i_RatedCoverageDescription) AS o_RatedCoverageDescription,\n\t-- *INF*: IIF(ISNULL(i_ClassCode ),'N/A', i_ClassCode)\n\tIFF(i_ClassCode IS NULL, 'N/A', i_ClassCode) AS o_ClassCode,\n\t-- *INF*: IIF(ISNULL(i_ClassDescription ),'N/A',i_ClassDescription )\n\tIFF(i_ClassDescription IS NULL, 'N/A', i_ClassDescription) AS o_ClassDescription,\n\t-- *INF*: IIF(ISNULL(i_IndustryRiskGradeCode ),'N/A', i_IndustryRiskGradeCode)\n\tIFF(i_IndustryRiskGradeCode IS NULL, 'N/A', i_IndustryRiskGradeCode) AS o_IndustryRiskGradeCode,\n\t-- *INF*: IIF(ISNULL( i_IndustryRiskGradeDescription),'N/A',i_IndustryRiskGradeDescription )\n\tIFF(i_IndustryRiskGradeDescription IS NULL, 'N/A', i_IndustryRiskGradeDescription) AS o_IndustryRiskGradeDescription,\n\t-- *INF*: GET_DATE_PART(v_PolicyEffectiveDate,'YYYY')\n\tDATE_PART(v_PolicyEffectiveDate, 'YYYY') AS o_PolicyEffectiveYear,\n\t-- *INF*: TO_INTEGER(TO_CHAR(v_PolicyEffectiveDate,'Q'))\n\tCAST(TO_CHAR(v_PolicyEffectiveDate, 'Q') AS INTEGER) AS o_PolicyEffectiveQuarter,\n\t-- *INF*: GET_DATE_PART(v_PolicyEffectiveDate,'MM')\n\tDATE_PART(v_PolicyEffectiveDate, 'MM') AS o_PolicyEffectiveMonthNumber,\n\t-- *INF*: TO_CHAR(v_PolicyEffectiveDate,'MONTH')\n\tTO_CHAR(v_PolicyEffectiveDate, 'MONTH') AS o_PolicyEffectiveMonthDescription,\n\tv_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: GET_DATE_PART(v_PolicyExpirationDate,'YYYY')\n\tDATE_PART(v_PolicyExpirationDate, 'YYYY') AS o_PolicyExpirationYear,\n\t-- *INF*: TO_INTEGER(TO_CHAR(v_PolicyExpirationDate,'Q'))\n\tCAST(TO_CHAR(v_PolicyExpirationDate, 'Q') AS INTEGER) AS o_PolicyExpirationQuarter,\n\t-- *INF*: GET_DATE_PART(v_PolicyExpirationDate,'MM')\n\tDATE_PART(v_PolicyExpirationDate, 'MM') AS o_PolicyExpirationMonthNumber,\n\t-- *INF*: TO_CHAR(v_PolicyExpirationDate,'MONTH')\n\tTO_CHAR(v_PolicyExpirationDate, 'MONTH') AS o_PolicyExpirationMonthDescription,\n\tv_PolicyExpirationDate AS o_PolicyExpirationDate,\n\t-- *INF*: GET_DATE_PART(v_PolicyCancellationDate,'YYYY')\n\tDATE_PART(v_PolicyCancellationDate, 'YYYY') AS o_PolicyCancellationYear,\n\t-- *INF*: TO_INTEGER(TO_CHAR(v_PolicyCancellationDate,'Q'))\n\tCAST(TO_CHAR(v_PolicyCancellationDate, 'Q') AS INTEGER) AS o_PolicyCancellationQuarter,\n\t-- *INF*: GET_DATE_PART(v_PolicyCancellationDate,'MM')\n\tDATE_PART(v_PolicyCancellationDate, 'MM') AS o_PolicyCancellationMonth,\n\t-- *INF*: TO_CHAR(v_PolicyCancellationDate,'MONTH')\n\tTO_CHAR(v_PolicyCancellationDate, 'MONTH') AS o_PolicyCancellationMonthDescription,\n\tv_PolicyCancellationDate AS o_PolicyCancellationDate,\n\t-- *INF*: IIF(ISNULL(i_PolicyCancellationReasonCode ),'N/A', i_PolicyCancellationReasonCode)\n\tIFF(i_PolicyCancellationReasonCode IS NULL, 'N/A', i_PolicyCancellationReasonCode) AS o_PolicyCancellationReasonCode,\n\t-- *INF*: IIF(ISNULL( i_PolicyCancellationReasonCodeDescription),'N/A', i_PolicyCancellationReasonCodeDescription)\n\tIFF(\n\t    i_PolicyCancellationReasonCodeDescription IS NULL, 'N/A',\n\t    i_PolicyCancellationReasonCodeDescription\n\t) AS o_PolicyCancellationReasonCodeDescription,\n\t-- *INF*: IIF(ISNULL(i_PolicyOriginalInceptionDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_PolicyOriginalInceptionDate)\n\tIFF(\n\t    i_PolicyOriginalInceptionDate IS NULL,\n\t    TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_PolicyOriginalInceptionDate\n\t) AS o_PolicyOriginalInceptionDate,\n\t-- *INF*: IIF(ISNULL( i_PolicyRenewalCode),'N/A',i_PolicyRenewalCode )\n\tIFF(i_PolicyRenewalCode IS NULL, 'N/A', i_PolicyRenewalCode) AS o_PolicyRenewalCode,\n\t-- *INF*: IIF(ISNULL(i_PolicyRenewalDescription ),'N/A',i_PolicyRenewalDescription )\n\tIFF(i_PolicyRenewalDescription IS NULL, 'N/A', i_PolicyRenewalDescription) AS o_PolicyRenewalDescription,\n\t-- *INF*: IIF(ISNULL( i_PolicyStatusCode),'N/A',i_PolicyStatusCode )\n\tIFF(i_PolicyStatusCode IS NULL, 'N/A', i_PolicyStatusCode) AS o_PolicyStatusCode,\n\t-- *INF*: IIF(ISNULL(i_PolicyStatusCodeDescription ),'N/A', i_PolicyStatusCodeDescription)\n\tIFF(i_PolicyStatusCodeDescription IS NULL, 'N/A', i_PolicyStatusCodeDescription) AS o_PolicyStatusCodeDescription,\n\t-- *INF*: GET_DATE_PART(v_AccountingDate,'YYYY')\n\tDATE_PART(v_AccountingDate, 'YYYY') AS o_AccountingYear,\n\t-- *INF*: TO_INTEGER(TO_CHAR(v_AccountingDate,'Q'))\n\tCAST(TO_CHAR(v_AccountingDate, 'Q') AS INTEGER) AS o_AccountingMonthQuarter,\n\t-- *INF*: GET_DATE_PART(v_AccountingDate,'MM')\n\tDATE_PART(v_AccountingDate, 'MM') AS o_AccountingMonthNumber,\n\t-- *INF*: TO_CHAR(v_AccountingDate,'MONTH')\n\tTO_CHAR(v_AccountingDate, 'MONTH') AS o_AccountingMonthName,\n\tv_AccountingDate AS o_AccountingDate,\n\t-- *INF*: IIF(ISNULL( i_RatingStateCode),'N/A',i_RatingStateCode )\n\tIFF(i_RatingStateCode IS NULL, 'N/A', i_RatingStateCode) AS o_RatingStateCode,\n\t-- *INF*: IIF(ISNULL(i_RatingStateAbbreviation ),'N/A', i_RatingStateAbbreviation)\n\tIFF(i_RatingStateAbbreviation IS NULL, 'N/A', i_RatingStateAbbreviation) AS o_RatingStateAbbreviation,\n\t-- *INF*: IIF(ISNULL( lkp_RatingStateName),'N/A', lkp_RatingStateName)\n\tIFF(lkp_RatingStateName IS NULL, 'N/A', lkp_RatingStateName) AS o_RatingStateName,\n\t-- *INF*: IIF(ISNULL( i_LocationNumber),'N/A',i_LocationNumber )\n\tIFF(i_LocationNumber IS NULL, 'N/A', i_LocationNumber) AS o_LocationNumber,\n\t-- *INF*: IIF(ISNULL(i_RatingLocationCity ),'N/A',i_RatingLocationCity)\n\tIFF(i_RatingLocationCity IS NULL, 'N/A', i_RatingLocationCity) AS o_RatingLocationCity,\n\t-- *INF*: IIF(ISNULL(i_RatingLocationCounty ),'N/A',i_RatingLocationCounty )\n\tIFF(i_RatingLocationCounty IS NULL, 'N/A', i_RatingLocationCounty) AS o_RatingLocationCounty,\n\t-- *INF*: IIF(ISNULL(i_RatingLocationZIPCode ),'N/A', i_RatingLocationZIPCode)\n\tIFF(i_RatingLocationZIPCode IS NULL, 'N/A', i_RatingLocationZIPCode) AS o_RatingLocationZIPCode,\n\t-- *INF*: IIF(ISNULL( i_PolicyKey),'N/A', i_PolicyKey)\n\tIFF(i_PolicyKey IS NULL, 'N/A', i_PolicyKey) AS o_PolicyKey,\n\t-- *INF*: IIF(ISNULL( i_PolicySymbol),'N/A',i_PolicySymbol )\n\tIFF(i_PolicySymbol IS NULL, 'N/A', i_PolicySymbol) AS o_PolicySymbol,\n\t-- *INF*: IIF(ISNULL( i_PolicyNumber),'N/A', i_PolicyNumber)\n\tIFF(i_PolicyNumber IS NULL, 'N/A', i_PolicyNumber) AS o_PolicyNumber,\n\t-- *INF*: IIF(ISNULL(i_PolicyVersion ),'NA',i_PolicyVersion)\n\tIFF(i_PolicyVersion IS NULL, 'NA', i_PolicyVersion) AS o_PolicyVersion,\n\t-- *INF*: IIF(ISNULL(i_PolicyIssueCode ),'N/A',i_PolicyIssueCode )\n\tIFF(i_PolicyIssueCode IS NULL, 'N/A', i_PolicyIssueCode) AS o_PolicyIssueCode,\n\t-- *INF*: IIF(ISNULL(i_PolicyIssueCodeDescription ),'N/A',i_PolicyIssueCodeDescription )\n\tIFF(i_PolicyIssueCodeDescription IS NULL, 'N/A', i_PolicyIssueCodeDescription) AS o_PolicyIssueCodeDescription,\n\t-- *INF*: IIF(ISNULL( i_PrimaryRatingStateCode),'N/A', i_PrimaryRatingStateCode)\n\tIFF(i_PrimaryRatingStateCode IS NULL, 'N/A', i_PrimaryRatingStateCode) AS o_PrimaryRatingStateCode,\n\t-- *INF*: IIF(ISNULL(i_PrimaryRatingStateAbbreviation ),'N/A',i_PrimaryRatingStateAbbreviation )\n\tIFF(i_PrimaryRatingStateAbbreviation IS NULL, 'N/A', i_PrimaryRatingStateAbbreviation) AS o_PrimaryRatingStateAbbreviation,\n\t-- *INF*: IIF(ISNULL(i_PrimaryRatingStateDescription ),'N/A', i_PrimaryRatingStateDescription)\n\tIFF(i_PrimaryRatingStateDescription IS NULL, 'N/A', i_PrimaryRatingStateDescription) AS o_PrimaryRatingStateDescription,\n\t-- *INF*: IIF(ISNULL(i_PrimaryBusinessClassificationCode ),'N/A', i_PrimaryBusinessClassificationCode)\n\tIFF(i_PrimaryBusinessClassificationCode IS NULL, 'N/A', i_PrimaryBusinessClassificationCode) AS o_PrimaryBusinessClassificationCode,\n\t-- *INF*: IIF(ISNULL( i_PrimaryBusinessClassificationDescription),'N/A',i_PrimaryBusinessClassificationDescription )\n\tIFF(\n\t    i_PrimaryBusinessClassificationDescription IS NULL, 'N/A',\n\t    i_PrimaryBusinessClassificationDescription\n\t) AS o_PrimaryBusinessClassificationDescription,\n\t-- *INF*: IIF(ISNULL(lkp_BusinessSegmentCode ),'N/A', lkp_BusinessSegmentCode)\n\tIFF(lkp_BusinessSegmentCode IS NULL, 'N/A', lkp_BusinessSegmentCode) AS o_BusinessSegmentCode,\n\t-- *INF*: IIF(ISNULL(lkp_BusinessSegmentDescription ),'N/A',lkp_BusinessSegmentDescription)\n\tIFF(lkp_BusinessSegmentDescription IS NULL, 'N/A', lkp_BusinessSegmentDescription) AS o_BusinessSegmentDescription,\n\t-- *INF*: IIF(ISNULL(lkp_StrategicBusinessGroupCode ),'N/A', lkp_StrategicBusinessGroupCode)\n\tIFF(lkp_StrategicBusinessGroupCode IS NULL, 'N/A', lkp_StrategicBusinessGroupCode) AS o_StrategicBusinessGroupCode,\n\t-- *INF*: IIF(ISNULL( lkp_StrategicBusinessGroupDescription),'N/A', lkp_StrategicBusinessGroupDescription)\n\tIFF(\n\t    lkp_StrategicBusinessGroupDescription IS NULL, 'N/A', lkp_StrategicBusinessGroupDescription\n\t) AS o_StrategicBusinessGroupDescription,\n\t-- *INF*: IIF(ISNULL( i_AgencyCode),'N/A',i_AgencyCode )\n\tIFF(i_AgencyCode IS NULL, 'N/A', i_AgencyCode) AS o_AgencyCode,\n\t-- *INF*: IIF(ISNULL(i_AgencyDoingBusinessAsName ),'N/A',i_AgencyDoingBusinessAsName )\n\tIFF(i_AgencyDoingBusinessAsName IS NULL, 'N/A', i_AgencyDoingBusinessAsName) AS o_AgencyDoingBusinessAsName,\n\t-- *INF*: IIF( ISNULL(v_AgencyStateCode_desc) ,'N/A' ,\r\n\t-- SUBSTR(v_AgencyStateCode_desc,1,(INSTR(v_AgencyStateCode_desc,'|')-1)) )\n\tIFF(\n\t    v_AgencyStateCode_desc IS NULL, 'N/A',\n\t    SUBSTR(v_AgencyStateCode_desc, 1, (REGEXP_INSTR(v_AgencyStateCode_desc, '|') - 1))\n\t) AS o_AgencyStateCode,\n\t-- *INF*: IIF(ISNULL(i_AgencyStateAbbreviation ),'NA', i_AgencyStateAbbreviation)\n\tIFF(i_AgencyStateAbbreviation IS NULL, 'NA', i_AgencyStateAbbreviation) AS o_AgencyStateAbbreviation,\n\t-- *INF*: IIF( ISNULL(v_AgencyStateCode_desc) ,'N/A' ,SUBSTR(v_AgencyStateCode_desc,(INSTR(v_AgencyStateCode_desc,'|')+1),LENGTH(v_AgencyStateCode_desc)))\n\tIFF(\n\t    v_AgencyStateCode_desc IS NULL, 'N/A',\n\t    SUBSTR(v_AgencyStateCode_desc, (REGEXP_INSTR(v_AgencyStateCode_desc, '|') + 1), LENGTH(v_AgencyStateCode_desc))\n\t) AS o_AgencyStateDescription,\n\t-- *INF*: IIF(ISNULL( i_AgencyPhysicalAddressCity),'N/A', i_AgencyPhysicalAddressCity)\n\tIFF(i_AgencyPhysicalAddressCity IS NULL, 'N/A', i_AgencyPhysicalAddressCity) AS o_AgencyPhysicalAddressCity,\n\t-- *INF*: IIF(ISNULL(i_AgencyZIPCode ),'N/A', i_AgencyZIPCode)\n\tIFF(i_AgencyZIPCode IS NULL, 'N/A', i_AgencyZIPCode) AS o_AgencyZIPCode,\n\t-- *INF*: IIF(ISNULL( i_ProducerCode),'N/A',i_ProducerCode )\n\tIFF(i_ProducerCode IS NULL, 'N/A', i_ProducerCode) AS o_ProducerCode,\n\t-- *INF*: IIF(ISNULL( i_ProducerFullName),'N/A', i_ProducerFullName)\n\tIFF(i_ProducerFullName IS NULL, 'N/A', i_ProducerFullName) AS o_ProducerFullName,\n\t-- *INF*: IIF(ISNULL(lkp_UnderwriterDisplayName),'N/A', lkp_UnderwriterDisplayName)\n\tIFF(lkp_UnderwriterDisplayName IS NULL, 'N/A', lkp_UnderwriterDisplayName) AS o_UnderwriterDisplayName,\n\t-- *INF*: IIF(ISNULL( lkp_UnderwriterManagerDisplayName),'N/A', lkp_UnderwriterManagerDisplayName)\n\tIFF(lkp_UnderwriterManagerDisplayName IS NULL, 'N/A', lkp_UnderwriterManagerDisplayName) AS o_UnderwriterManagerDisplayName,\n\t-- *INF*: IIF(ISNULL(lkp_UnderwritingRegionCodeDescription ),'N/A',lkp_UnderwritingRegionCodeDescription )\n\tIFF(\n\t    lkp_UnderwritingRegionCodeDescription IS NULL, 'N/A', lkp_UnderwritingRegionCodeDescription\n\t) AS o_UnderwritingRegionCodeDescription,\n\t-- *INF*: IIF(ISNULL(i_PrimaryAgencyCode ),'N/A',i_PrimaryAgencyCode)\n\tIFF(i_PrimaryAgencyCode IS NULL, 'N/A', i_PrimaryAgencyCode) AS o_PrimaryAgencyCode,\n\t-- *INF*: IIF(ISNULL( i_PrimaryAgencyDoingBusinessAsName),'N/A',i_PrimaryAgencyDoingBusinessAsName )\n\tIFF(i_PrimaryAgencyDoingBusinessAsName IS NULL, 'N/A', i_PrimaryAgencyDoingBusinessAsName) AS o_PrimaryAgencyDoingBusinessAsName,\n\t-- *INF*: IIF( ISNULL(v_PrimaryAgencyStateCode_desc) ,'N/A' ,\r\n\t-- SUBSTR(v_PrimaryAgencyStateCode_desc,1,(INSTR(v_PrimaryAgencyStateCode_desc,'|')-1)) )\n\tIFF(\n\t    v_PrimaryAgencyStateCode_desc IS NULL, 'N/A',\n\t    SUBSTR(v_PrimaryAgencyStateCode_desc, 1, (REGEXP_INSTR(v_PrimaryAgencyStateCode_desc, '|') - 1))\n\t) AS o_PrimaryAgencyStateCode,\n\t-- *INF*: IIF(ISNULL(i_PrimaryAgencyStateAbbreviation ),'NA', i_PrimaryAgencyStateAbbreviation)\n\tIFF(i_PrimaryAgencyStateAbbreviation IS NULL, 'NA', i_PrimaryAgencyStateAbbreviation) AS o_PrimaryAgencyStateAbbreviation,\n\t-- *INF*: IIF( ISNULL(v_PrimaryAgencyStateCode_desc) ,'N/A' ,SUBSTR(v_PrimaryAgencyStateCode_desc,(INSTR(v_PrimaryAgencyStateCode_desc,'|')+1),LENGTH(v_PrimaryAgencyStateCode_desc)))\n\tIFF(\n\t    v_PrimaryAgencyStateCode_desc IS NULL, 'N/A',\n\t    SUBSTR(v_PrimaryAgencyStateCode_desc, (REGEXP_INSTR(v_PrimaryAgencyStateCode_desc, '|') + 1), LENGTH(v_PrimaryAgencyStateCode_desc))\n\t) AS o_PrimaryAgencyStateDescription,\n\t-- *INF*: IIF(ISNULL( i_PrimaryAgencyPhysicalAddressCity),'N/A', i_PrimaryAgencyPhysicalAddressCity)\n\tIFF(i_PrimaryAgencyPhysicalAddressCity IS NULL, 'N/A', i_PrimaryAgencyPhysicalAddressCity) AS o_PrimaryAgencyPhysicalAddressCity,\n\t-- *INF*: IIF(ISNULL( i_PrimaryAgencyZIPCode),'N/A',i_PrimaryAgencyZIPCode )\n\tIFF(i_PrimaryAgencyZIPCode IS NULL, 'N/A', i_PrimaryAgencyZIPCode) AS o_PrimaryAgencyZIPCode,\n\t-- *INF*: IIF(ISNULL(lkp_RegionalSalesManagerDisplayName ),'N/A', lkp_RegionalSalesManagerDisplayName)\n\tIFF(lkp_RegionalSalesManagerDisplayName IS NULL, 'N/A', lkp_RegionalSalesManagerDisplayName) AS o_RegionalSalesManagerDisplayName,\n\t-- *INF*: IIF(ISNULL( lkp_SalesTerritoryCode),'N/A',lkp_SalesTerritoryCode )\n\tIFF(lkp_SalesTerritoryCode IS NULL, 'N/A', lkp_SalesTerritoryCode) AS o_SalesTerritoryCode,\n\t-- *INF*: IIF(ISNULL( i_CustomerNumber),'N/A',i_CustomerNumber )\n\tIFF(i_CustomerNumber IS NULL, 'N/A', i_CustomerNumber) AS o_CustomerNumber,\n\t-- *INF*: IIF(ISNULL( i_FirstNamedInsured),'N/A', i_FirstNamedInsured)\n\tIFF(i_FirstNamedInsured IS NULL, 'N/A', i_FirstNamedInsured) AS o_FirstNamedInsured,\n\t-- *INF*: IIF(ISNULL( i_SICCode),'N/A', i_SICCode)\n\tIFF(i_SICCode IS NULL, 'N/A', i_SICCode) AS o_SICCode,\n\t-- *INF*: IIF(ISNULL(i_SICDescription ),'N/A', i_SICDescription)\n\tIFF(i_SICDescription IS NULL, 'N/A', i_SICDescription) AS o_SICDescription,\n\t-- *INF*: IIF(ISNULL( i_NAICSCode),'N/A',i_NAICSCode)\n\tIFF(i_NAICSCode IS NULL, 'N/A', i_NAICSCode) AS o_NAICSCode,\n\t-- *INF*: IIF(ISNULL( i_NAICSDescription),'N/A',i_NAICSDescription )\n\tIFF(i_NAICSDescription IS NULL, 'N/A', i_NAICSDescription) AS o_NAICSDescription,\n\t-- *INF*: IIF(ISNULL(i_CustomerCareIndicator ),'N/A', i_CustomerCareIndicator)\n\tIFF(i_CustomerCareIndicator IS NULL, 'N/A', i_CustomerCareIndicator) AS o_CustomerCareIndicator,\n\tv_NewBusinessIndicator AS o_NewBusinessIndicator,\n\t-- *INF*: IIF(ISNULL(i_PriorPolicyKey ),'N/A', i_PriorPolicyKey)\n\tIFF(i_PriorPolicyKey IS NULL, 'N/A', i_PriorPolicyKey) AS o_PriorPolicyKey,\n\t-- *INF*: IIF(ISNULL( i_PriorPolicyNumber),'N/A',i_PriorPolicyNumber )\n\tIFF(i_PriorPolicyNumber IS NULL, 'N/A', i_PriorPolicyNumber) AS o_PriorPolicyNumber,\n\t-- *INF*: IIF(ISNULL(i_PriorPolicySymbol ),'N/A', i_PriorPolicySymbol)\n\tIFF(i_PriorPolicySymbol IS NULL, 'N/A', i_PriorPolicySymbol) AS o_PriorPolicySymbol,\n\t-- *INF*: IIF(ISNULL( i_PriorPolicyVersion),'N/A',i_PriorPolicyVersion )\n\tIFF(i_PriorPolicyVersion IS NULL, 'N/A', i_PriorPolicyVersion) AS o_PriorPolicyVersion,\n\t-- *INF*: ADD_TO_DATE(ADD_TO_DATE(TRUNC(LAST_DAY(ADD_TO_DATE(SYSDATE,'MM',-1))),'DD',1),'SS',-1)\r\n\t-- \r\n\t-- -- to get the previous month last date\n\tDATEADD(SECOND,- 1,DATEADD(DAY,1,TRUNC(LAST_DAY(DATEADD(MONTH,- 1,CURRENT_TIMESTAMP))))) AS o_LastBookedDate,\n\t-- *INF*: IIF(ISNULL( i_HazardGroupCode),'N/A', i_HazardGroupCode)\n\tIFF(i_HazardGroupCode IS NULL, 'N/A', i_HazardGroupCode) AS o_HazardGroupCode,\n\t-- *INF*: IIF(ISNULL(lkp_DividendPlan ),'N/A',lkp_DividendPlan )\n\tIFF(lkp_DividendPlan IS NULL, 'N/A', lkp_DividendPlan) AS o_DividendPlan,\n\t-- *INF*: IIF(ISNULL( lkp_DividendType),'N/A', lkp_DividendType)\n\tIFF(lkp_DividendType IS NULL, 'N/A', lkp_DividendType) AS o_DividendType,\n\t-- *INF*: IIF(ISNULL( i_DeductibleAmount),'N/A', i_DeductibleAmount)\n\tIFF(i_DeductibleAmount IS NULL, 'N/A', i_DeductibleAmount) AS o_DeductibleAmount,\n\t-- *INF*: IIF(ISNULL(i_PolicyPerAccidentLimit ),'N/A', i_PolicyPerAccidentLimit)\n\tIFF(i_PolicyPerAccidentLimit IS NULL, 'N/A', i_PolicyPerAccidentLimit) AS o_PolicyPerAccidentLimit,\n\t-- *INF*: IIF(ISNULL(i_PolicyPerDiseaseLimit ),'N/A', i_PolicyPerDiseaseLimit)\n\tIFF(i_PolicyPerDiseaseLimit IS NULL, 'N/A', i_PolicyPerDiseaseLimit) AS o_PolicyPerDiseaseLimit,\n\t-- *INF*: IIF(ISNULL( i_PolicyAggregateLimit),'N/A', i_PolicyAggregateLimit)\n\tIFF(i_PolicyAggregateLimit IS NULL, 'N/A', i_PolicyAggregateLimit) AS o_PolicyAggregateLimit,\n\t-- *INF*: IIF(ISNULL( i_ExposureBasis),'N/A', i_ExposureBasis)\n\tIFF(i_ExposureBasis IS NULL, 'N/A', i_ExposureBasis) AS o_ExposureBasis,\n\tv_DirectWrittenExposure AS o_DirectWrittenExposure,\n\t-- *INF*: IIF(ISNULL(i_DirectWrittenPremium ),0.00, i_DirectWrittenPremium)\r\n\t-- \n\tIFF(i_DirectWrittenPremium IS NULL, 0.00, i_DirectWrittenPremium) AS o_DirectWrittenPremium,\n\t-- *INF*: IIF(ISNULL(i_SubjectWrittenPremium ),0.00,i_SubjectWrittenPremium )\n\tIFF(i_SubjectWrittenPremium IS NULL, 0.00, i_SubjectWrittenPremium) AS o_SubjectWrittenPremium,\n\t-- *INF*: IIF(ISNULL(i_ExperienceModifiedPremium),0.00,i_ExperienceModifiedPremium )\n\tIFF(i_ExperienceModifiedPremium IS NULL, 0.00, i_ExperienceModifiedPremium) AS o_ExperienceModifiedPremium,\n\t-- *INF*: IIF(ISNULL( i_ScheduleModifiedPremium),0.00, i_ScheduleModifiedPremium)\n\tIFF(i_ScheduleModifiedPremium IS NULL, 0.00, i_ScheduleModifiedPremium) AS o_ScheduleModifiedPremium,\n\t-- *INF*: IIF(ISNULL(i_OtherModifiedPremium ),0.00,i_OtherModifiedPremium )\n\tIFF(i_OtherModifiedPremium IS NULL, 0.00, i_OtherModifiedPremium) AS o_OtherModifiedPremium,\n\t-- *INF*: IIF(ISNULL( i_ClassifiedPremium),0.00, i_ClassifiedPremium)\n\tIFF(i_ClassifiedPremium IS NULL, 0.00, i_ClassifiedPremium) AS o_ClassifiedPremium,\n\t0.00 AS o_DirectEarnedExposure,\n\t0.00 AS o_DirectEarnedPremium,\n\t0.00 AS o_SubjectDirectEarnedPremium,\n\t0.00 AS o_ExperienceModifiedDirectEarnedPremium,\n\t0.00 AS o_ScheduleModifiedDirectEarnedPremium,\n\t0.00 AS o_OtherModifiedDirectEarnedPremium,\n\t0.00 AS o_ClassifiedDirectEarnedPremium,\n\t0.00 AS o_PassThroughChargeAmount,\n\tv_AdmiraltyActFlag AS o_AdmiraltyActFlag,\n\tv_FederalEmployersLiabilityActFlag AS o_FederalEmployersLiabilityActFlag,\n\tv_USLongshoreAndHarborWorkersCompensationActFlag AS o_USLongShoreAndHarborWorkersCompensationActFlag,\n\t-- *INF*: IIF(ISNULL(i_FederalEmployerIDNumberfein ),'N/A', i_FederalEmployerIDNumberfein)\n\tIFF(i_FederalEmployerIDNumberfein IS NULL, 'N/A', i_FederalEmployerIDNumberfein) AS o_FederalEmployerIDNumberfein,\n\t-- *INF*: IIF(ISNULL( i_RolloverPriorCarrier),'N/A',i_RolloverPriorCarrier )\n\tIFF(i_RolloverPriorCarrier IS NULL, 'N/A', i_RolloverPriorCarrier) AS o_RolloverPriorCarrier,\n\t-- *INF*: IIF(ISNULL(i_CoverageEffectiveDate),TO_DATE('1800-01-01 00:00:00','YYYY-MM-DD HH24:MI:SS'),i_CoverageEffectiveDate)\n\tIFF(\n\t    i_CoverageEffectiveDate IS NULL,\n\t    TO_TIMESTAMP('1800-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_CoverageEffectiveDate\n\t) AS o_CoverageEffectiveDate,\n\t-- *INF*: IIF(ISNULL(i_CoverageExpirationDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_CoverageExpirationDate)\n\tIFF(\n\t    i_CoverageExpirationDate IS NULL,\n\t    TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_CoverageExpirationDate\n\t) AS o_CoverageExpirationDate,\n\t-- *INF*: IIF(ISNULL(i_CoverageCancellationDate),TO_DATE('2100-12-31 23:59:59','YYYY-MM-DD HH24:MI:SS'),i_CoverageCancellationDate)\n\tIFF(\n\t    i_CoverageCancellationDate IS NULL,\n\t    TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_CoverageCancellationDate\n\t) AS o_CoverageCancellationDate,\n\t-- *INF*: IIF(ISNULL(i_PriorPolicyEffectiveDate),TO_DATE('1800-01-01 00:00:00','YYYY-MM-DD HH24:MI:SS'),i_PriorPolicyEffectiveDate)\n\tIFF(\n\t    i_PriorPolicyEffectiveDate IS NULL,\n\t    TO_TIMESTAMP('1800-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS'),\n\t    i_PriorPolicyEffectiveDate\n\t) AS o_PriorPolicyEffectiveDate\n\tFROM EXP_PassVal\n\tLEFT JOIN LKP_BusinessClassDim\n\tON LKP_BusinessClassDim.BusinessClassDimId = EXP_PassVal.BusinessClassDimId\n\tLEFT JOIN LKP_DividendTypeDim\n\tON LKP_DividendTypeDim.DividendTypeDimId = LKP_DividendFact.DividendTypeDimId\n\tLEFT JOIN LKP_PolicyCurrentStatusDim\n\tON LKP_PolicyCurrentStatusDim.EDWPolicyAKId = EXP_PassVal.pol_ak_id\n\tLEFT JOIN LKP_PremiumMasterFact\n\tON LKP_PremiumMasterFact.EDWPremiumMasterCalculationPKID = EXP_PassVal.EDWPremiumMasterCalculationPKId\n\tLEFT JOIN LKP_SalesDivisionDim\n\tON LKP_SalesDivisionDim.SalesDivisionDimID = EXP_PassVal.SalesDivisionDimId\n\tLEFT JOIN LKP_StateDim\n\tON LKP_StateDim.StateAbbreviation = EXP_PassVal.RatingStateAbbreviation\n\tLEFT JOIN LKP_UnderwritingDivisionDim\n\tON LKP_UnderwritingDivisionDim.UnderwritingDivisionDimID = EXP_PassVal.UnderwritingDivisionDimId\n\tLEFT JOIN LKP_PHYSICALSTATE LKP_PHYSICALSTATE_i_AgencyStateAbbreviation\n\tON LKP_PHYSICALSTATE_i_AgencyStateAbbreviation.StateAbbreviation = i_AgencyStateAbbreviation\n\n\tLEFT JOIN LKP_PHYSICALSTATE LKP_PHYSICALSTATE_i_PrimaryAgencyStateAbbreviation\n\tON LKP_PHYSICALSTATE_i_PrimaryAgencyStateAbbreviation.StateAbbreviation = i_PrimaryAgencyStateAbbreviation\n\n),\nActuarialWorkersCompensationPremium AS (\n\tTRUNCATE TABLE ActuarialWorkersCompensationPremium;\n\tINSERT INTO ActuarialWorkersCompensationPremium\n\t(AuditId, CreatedDate, ModifiedDate, EDWActuarialWorkersCompensationFactId, EDWActuarialWorkersCompensationFactType, EnterpriseGroupCode, EnterpriseGroupAbbreviation, StrategicProfitCenterCode, StrategicProfitCenterAbbreviation, LegalEntityCode, LegalEntityAbbreviation, PolicyOfferingCode, PolicyOfferingAbbreviation, PolicyOfferingDescription, ProductCode, ProductAbbreviation, ProductDescription, LineofBusinessCode, LineofBusinessAbbreviation, LineofBusinessDescription, AccountingProductCode, AccountingProductAbbreviation, AccountingProductDescription, RatingPlanCode, RatingPlanDescription, InsuranceSegmentCode, InsuranceSegmentDescription, ProgramCode, ProgramDescription, AssociationCode, AssociationDescription, CoverageSummaryCode, CoverageSummaryDescription, CoverageGroupCode, CoverageGroupDescription, CoverageCode, CoverageDescription, ClassCode, ClassCodeDescription, IndustryRiskGradeCode, IndustryRiskGradeDescription, PolicyEffectiveYear, PolicyEffectiveQuarter, PolicyEffectiveMonthNumber, PolicyEffectiveMonthDescription, PolicyEffectiveDate, PolicyExpirationYear, PolicyExpirationQuarter, PolicyExpirationMonthNumber, PolicyExpirationMonthDescription, PolicyExpirationDate, PolicyCancellationYear, PolicyCancellationQuarter, PolicyCancellationMonth, PolicyCancellationMonthDescription, PolicyCancellationDate, PolicyCancellationReasonCode, PolicyCancellationReasonCodeDescription, PolicyOriginalInceptionDate, PolicyRenewalCode, PolicyRenewalDescription, PolicyStatusCode, PolicyStatusCodeDescription, AccountingYear, AccountingMonthQuarter, AccountingMonthNumber, AccountingMonthName, AccountingDate, RatingStateCode, RatingStateAbbreviation, RatingStateName, LocationNumber, RatingLocationCity, RatingLocationCounty, RatingLocationZIPCode, PolicyKey, PolicySymbol, PolicyNumber, PolicyVersion, PolicyIssueCode, PolicyIssueCodeDescription, PrimaryRatingStateCode, PrimaryRatingStateAbbreviation, PrimaryRatingStateDescription, PrimaryBusinessClassificationCode, PrimaryBusinessClassificationDescription, BusinessSegmentCode, BusinessSegmentDescription, StrategicBusinessGroupCode, StrategicBusinessGroupDescription, AgencyCode, AgencyDoingBusinessAsName, AgencyStateCode, AgencyStateAbbreviation, AgencyStateDescription, AgencyPhysicalAddressCity, AgencyZIPCode, ProducerCode, ProducerFullName, UnderwriterFullName, UnderwritingManagerName, UnderwritingRegionName, PrimaryAgencyCode, PrimaryAgencyDoingBusinessAsName, PrimaryAgencyStateCode, PrimaryAgencyStateAbbreviation, PrimaryAgencyStateDescription, PrimaryAgencyPhysicalAddressCity, PrimaryAgencyZIPCode, RegionalSalesManagerFullName, SalesTerritoryCode, CustomerNumber, FirstNamedInsured, SICCode, SICDescription, NAICSCode, NAICSDescription, CustomerCareIndicator, NewBusinessIndicator, PriorPolicyKey, PriorPolicyNumber, PriorPolicySymbol, PriorPolicyVersion, LastBookedDate, HazardGroupCode, DividendPlan, DividendType, DeductibleAmount, LimitPerAccident, LimitPerDisease, AggregateLimit, ExposureBasis, DirectWrittenExposure, DirectWrittenPremium, SubjectDirectWrittenPremium, ExperienceModifiedDirectWrittenPremium, ScheduleModifiedDirectWrittenPremium, OtherModifiedDirectWrittenPremium, ClassifiedDirectWrittenPremium, DirectEarnedExposure, DirectEarnedPremium, SubjectDirectEarnedPremium, ExperienceModifiedDirectEarnedPremium, ScheduleModifiedDirectEarnedPremium, OtherModifiedDirectEarnedPremium, ClassifiedDirectEarnedPremium, PassThroughChargeAmount, AdmiraltyActFlag, FederalEmployersLiabilityActFlag, USLongshoreAndHarborWorkersCompensationActFlag, FederalEmployerIDNumber, PriorCarrier, CoverageEffectiveDate, CoverageExpirationDate, CoverageCancellationDate, PriorPolicyEffectiveDate, RatedCoverageCode, RatedCoverageDescription)\n\tSELECT \n\tAUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\to_EDWActuarialWorkersCompensationFactId AS EDWACTUARIALWORKERSCOMPENSATIONFACTID, \n\to_EDWActuarialWorkersCompensationFactType AS EDWACTUARIALWORKERSCOMPENSATIONFACTTYPE, \n\to_EnterpriseGroupCode AS ENTERPRISEGROUPCODE, \n\to_EnterpriseGroupAbbreviation AS ENTERPRISEGROUPABBREVIATION, \n\to_StrategicProfitCenterCode AS STRATEGICPROFITCENTERCODE, \n\to_StrategicProfitCenterAbbreviation AS STRATEGICPROFITCENTERABBREVIATION, \n\to_LegalEntityCode AS LEGALENTITYCODE, \n\to_LegalEntityAbbreviation AS LEGALENTITYABBREVIATION, \n\to_PolicyOfferingCode AS POLICYOFFERINGCODE, \n\to_PolicyOfferingAbbreviation AS POLICYOFFERINGABBREVIATION, \n\to_PolicyOfferingDescription AS POLICYOFFERINGDESCRIPTION, \n\to_ProductCode AS PRODUCTCODE, \n\to_ProductAbbreviation AS PRODUCTABBREVIATION, \n\to_ProductDescription AS PRODUCTDESCRIPTION, \n\to_LineOfBusinessCode AS LINEOFBUSINESSCODE, \n\to_LineOfBusinessAbbreviation AS LINEOFBUSINESSABBREVIATION, \n\to_LineOfBusinessDescription AS LINEOFBUSINESSDESCRIPTION, \n\to_AccountingProductCode AS ACCOUNTINGPRODUCTCODE, \n\to_AccountingProductAbbreviation AS ACCOUNTINGPRODUCTABBREVIATION, \n\to_AccountingProductDescription AS ACCOUNTINGPRODUCTDESCRIPTION, \n\to_RatingPlanCode AS RATINGPLANCODE, \n\to_RatingPlanDescription AS RATINGPLANDESCRIPTION, \n\to_InsuranceSegmentCode AS INSURANCESEGMENTCODE, \n\to_InsuranceSegmentDescription AS INSURANCESEGMENTDESCRIPTION, \n\to_ProgramCode AS PROGRAMCODE, \n\to_ProgramDescription AS PROGRAMDESCRIPTION, \n\to_AssociationCode AS ASSOCIATIONCODE, \n\to_AssociationDescription AS ASSOCIATIONDESCRIPTION, \n\to_CoverageSummaryCode AS COVERAGESUMMARYCODE, \n\to_CoverageSummaryDescription AS COVERAGESUMMARYDESCRIPTION, \n\to_CoverageGroupCode AS COVERAGEGROUPCODE, \n\to_CoverageGroupDescription AS COVERAGEGROUPDESCRIPTION, \n\to_CoverageCode AS COVERAGECODE, \n\to_CoverageDescription AS COVERAGEDESCRIPTION, \n\to_ClassCode AS CLASSCODE, \n\to_ClassDescription AS CLASSCODEDESCRIPTION, \n\to_IndustryRiskGradeCode AS INDUSTRYRISKGRADECODE, \n\to_IndustryRiskGradeDescription AS INDUSTRYRISKGRADEDESCRIPTION, \n\to_PolicyEffectiveYear AS POLICYEFFECTIVEYEAR, \n\to_PolicyEffectiveQuarter AS POLICYEFFECTIVEQUARTER, \n\to_PolicyEffectiveMonthNumber AS POLICYEFFECTIVEMONTHNUMBER, \n\to_PolicyEffectiveMonthDescription AS POLICYEFFECTIVEMONTHDESCRIPTION, \n\to_PolicyEffectiveDate AS POLICYEFFECTIVEDATE, \n\to_PolicyExpirationYear AS POLICYEXPIRATIONYEAR, \n\to_PolicyExpirationQuarter AS POLICYEXPIRATIONQUARTER, \n\to_PolicyExpirationMonthNumber AS POLICYEXPIRATIONMONTHNUMBER, \n\to_PolicyExpirationMonthDescription AS POLICYEXPIRATIONMONTHDESCRIPTION, \n\to_PolicyExpirationDate AS POLICYEXPIRATIONDATE, \n\to_PolicyCancellationYear AS POLICYCANCELLATIONYEAR, \n\to_PolicyCancellationQuarter AS POLICYCANCELLATIONQUARTER, \n\to_PolicyCancellationMonth AS POLICYCANCELLATIONMONTH, \n\to_PolicyCancellationMonthDescription AS POLICYCANCELLATIONMONTHDESCRIPTION, \n\to_PolicyCancellationDate AS POLICYCANCELLATIONDATE, \n\to_PolicyCancellationReasonCode AS POLICYCANCELLATIONREASONCODE, \n\to_PolicyCancellationReasonCodeDescription AS POLICYCANCELLATIONREASONCODEDESCRIPTION, \n\to_PolicyOriginalInceptionDate AS POLICYORIGINALINCEPTIONDATE, \n\to_PolicyRenewalCode AS POLICYRENEWALCODE, \n\to_PolicyRenewalDescription AS POLICYRENEWALDESCRIPTION, \n\to_PolicyStatusCode AS POLICYSTATUSCODE, \n\to_PolicyStatusCodeDescription AS POLICYSTATUSCODEDESCRIPTION, \n\to_AccountingYear AS ACCOUNTINGYEAR, \n\to_AccountingMonthQuarter AS ACCOUNTINGMONTHQUARTER, \n\to_AccountingMonthNumber AS ACCOUNTINGMONTHNUMBER, \n\to_AccountingMonthName AS ACCOUNTINGMONTHNAME, \n\to_AccountingDate AS ACCOUNTINGDATE, \n\to_RatingStateCode AS RATINGSTATECODE, \n\to_RatingStateAbbreviation AS RATINGSTATEABBREVIATION, \n\to_RatingStateName AS RATINGSTATENAME, \n\to_LocationNumber AS LOCATIONNUMBER, \n\to_RatingLocationCity AS RATINGLOCATIONCITY, \n\to_RatingLocationCounty AS RATINGLOCATIONCOUNTY, \n\to_RatingLocationZIPCode AS RATINGLOCATIONZIPCODE, \n\to_PolicyKey AS POLICYKEY, \n\to_PolicySymbol AS POLICYSYMBOL, \n\to_PolicyNumber AS POLICYNUMBER, \n\to_PolicyVersion AS POLICYVERSION, \n\to_PolicyIssueCode AS POLICYISSUECODE, \n\to_PolicyIssueCodeDescription AS POLICYISSUECODEDESCRIPTION, \n\to_PrimaryRatingStateCode AS PRIMARYRATINGSTATECODE, \n\to_PrimaryRatingStateAbbreviation AS PRIMARYRATINGSTATEABBREVIATION, \n\to_PrimaryRatingStateDescription AS PRIMARYRATINGSTATEDESCRIPTION, \n\to_PrimaryBusinessClassificationCode AS PRIMARYBUSINESSCLASSIFICATIONCODE, \n\to_PrimaryBusinessClassificationDescription AS PRIMARYBUSINESSCLASSIFICATIONDESCRIPTION, \n\to_BusinessSegmentCode AS BUSINESSSEGMENTCODE, \n\to_BusinessSegmentDescription AS BUSINESSSEGMENTDESCRIPTION, \n\to_StrategicBusinessGroupCode AS STRATEGICBUSINESSGROUPCODE, \n\to_StrategicBusinessGroupDescription AS STRATEGICBUSINESSGROUPDESCRIPTION, \n\to_AgencyCode AS AGENCYCODE, \n\to_AgencyDoingBusinessAsName AS AGENCYDOINGBUSINESSASNAME, \n\to_AgencyStateCode AS AGENCYSTATECODE, \n\to_AgencyStateAbbreviation AS AGENCYSTATEABBREVIATION, \n\to_AgencyStateDescription AS AGENCYSTATEDESCRIPTION, \n\to_AgencyPhysicalAddressCity AS AGENCYPHYSICALADDRESSCITY, \n\to_AgencyZIPCode AS AGENCYZIPCODE, \n\to_ProducerCode AS PRODUCERCODE, \n\to_ProducerFullName AS PRODUCERFULLNAME, \n\to_UnderwriterDisplayName AS UNDERWRITERFULLNAME, \n\to_UnderwriterManagerDisplayName AS UNDERWRITINGMANAGERNAME, \n\to_UnderwritingRegionCodeDescription AS UNDERWRITINGREGIONNAME, \n\to_PrimaryAgencyCode AS PRIMARYAGENCYCODE, \n\to_PrimaryAgencyDoingBusinessAsName AS PRIMARYAGENCYDOINGBUSINESSASNAME, \n\to_PrimaryAgencyStateCode AS PRIMARYAGENCYSTATECODE, \n\to_PrimaryAgencyStateAbbreviation AS PRIMARYAGENCYSTATEABBREVIATION, \n\to_PrimaryAgencyStateDescription AS PRIMARYAGENCYSTATEDESCRIPTION, \n\to_PrimaryAgencyPhysicalAddressCity AS PRIMARYAGENCYPHYSICALADDRESSCITY, \n\to_PrimaryAgencyZIPCode AS PRIMARYAGENCYZIPCODE, \n\to_RegionalSalesManagerDisplayName AS REGIONALSALESMANAGERFULLNAME, \n\to_SalesTerritoryCode AS SALESTERRITORYCODE, \n\to_CustomerNumber AS CUSTOMERNUMBER, \n\to_FirstNamedInsured AS FIRSTNAMEDINSURED, \n\to_SICCode AS SICCODE, \n\to_SICDescription AS SICDESCRIPTION, \n\to_NAICSCode AS NAICSCODE, \n\to_NAICSDescription AS NAICSDESCRIPTION, \n\to_CustomerCareIndicator AS CUSTOMERCAREINDICATOR, \n\to_NewBusinessIndicator AS NEWBUSINESSINDICATOR, \n\to_PriorPolicyKey AS PRIORPOLICYKEY, \n\to_PriorPolicyNumber AS PRIORPOLICYNUMBER, \n\to_PriorPolicySymbol AS PRIORPOLICYSYMBOL, \n\to_PriorPolicyVersion AS PRIORPOLICYVERSION, \n\to_LastBookedDate AS LASTBOOKEDDATE, \n\to_HazardGroupCode AS HAZARDGROUPCODE, \n\to_DividendPlan AS DIVIDENDPLAN, \n\to_DividendType AS DIVIDENDTYPE, \n\to_DeductibleAmount AS DEDUCTIBLEAMOUNT, \n\to_PolicyPerAccidentLimit AS LIMITPERACCIDENT, \n\to_PolicyPerDiseaseLimit AS LIMITPERDISEASE, \n\to_PolicyAggregateLimit AS AGGREGATELIMIT, \n\to_ExposureBasis AS EXPOSUREBASIS, \n\to_DirectWrittenExposure AS DIRECTWRITTENEXPOSURE, \n\to_DirectWrittenPremium AS DIRECTWRITTENPREMIUM, \n\to_SubjectWrittenPremium AS SUBJECTDIRECTWRITTENPREMIUM, \n\to_ExperienceModifiedPremium AS EXPERIENCEMODIFIEDDIRECTWRITTENPREMIUM, \n\to_ScheduleModifiedPremium AS SCHEDULEMODIFIEDDIRECTWRITTENPREMIUM, \n\to_OtherModifiedPremium AS OTHERMODIFIEDDIRECTWRITTENPREMIUM, \n\to_ClassifiedPremium AS CLASSIFIEDDIRECTWRITTENPREMIUM, \n\to_DirectEarnedExposure AS DIRECTEARNEDEXPOSURE, \n\to_DirectEarnedPremium AS DIRECTEARNEDPREMIUM, \n\to_SubjectDirectEarnedPremium AS SUBJECTDIRECTEARNEDPREMIUM, \n\to_ExperienceModifiedDirectEarnedPremium AS EXPERIENCEMODIFIEDDIRECTEARNEDPREMIUM, \n\to_ScheduleModifiedDirectEarnedPremium AS SCHEDULEMODIFIEDDIRECTEARNEDPREMIUM, \n\to_OtherModifiedDirectEarnedPremium AS OTHERMODIFIEDDIRECTEARNEDPREMIUM, \n\to_ClassifiedDirectEarnedPremium AS CLASSIFIEDDIRECTEARNEDPREMIUM, \n\to_PassThroughChargeAmount AS PASSTHROUGHCHARGEAMOUNT, \n\to_AdmiraltyActFlag AS ADMIRALTYACTFLAG, \n\to_FederalEmployersLiabilityActFlag AS FEDERALEMPLOYERSLIABILITYACTFLAG, \n\to_USLongShoreAndHarborWorkersCompensationActFlag AS USLONGSHOREANDHARBORWORKERSCOMPENSATIONACTFLAG, \n\to_FederalEmployerIDNumberfein AS FEDERALEMPLOYERIDNUMBER, \n\to_RolloverPriorCarrier AS PRIORCARRIER, \n\to_CoverageEffectiveDate AS COVERAGEEFFECTIVEDATE, \n\to_CoverageExpirationDate AS COVERAGEEXPIRATIONDATE, \n\to_CoverageCancellationDate AS COVERAGECANCELLATIONDATE, \n\to_PriorPolicyEffectiveDate AS PRIORPOLICYEFFECTIVEDATE, \n\to_RatedCoverageCode AS RATEDCOVERAGECODE, \n\to_RatedCoverageDescription AS RATEDCOVERAGEDESCRIPTION\n\tFROM EXP_GetValues\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "PMINTEGRATIONSERVICENAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V3": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "NUM_OF_PARTITIONS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}