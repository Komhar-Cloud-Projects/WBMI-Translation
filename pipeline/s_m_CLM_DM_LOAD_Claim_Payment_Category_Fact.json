{
    "name": "s_m_CLM_DM_LOAD_Claim_Payment_Category_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Payment_Category_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_calender_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nSQ_claim_payment_category AS (\n\tSELECT A.claim_pay_ctgry_id,\r\n\t       A.claim_pay_ctgry_ak_id,\r\n\t       A.claim_pay_ak_id,\r\n\t       A.claim_pay_ctgry_type,\r\n\t       A.claim_pay_ctgry_seq_num,\r\n\t       A.claim_pay_ctgry_amt,\r\n\t       A.claim_pay_ctgry_earned_amt,\r\n\t       A.claim_pay_ctgry_billed_amt,\r\n\t       A.claim_pay_ctgry_start_date,\r\n\t       A.claim_pay_ctgry_end_date,\r\n\t       A.financial_type_code,\r\n\t       A.invc_num,\r\n\t       A.cost_containment_saving_amt,\r\n\t       A.cost_containment_red_amt,\r\n\t       A.cost_containment_ppo_amt,\r\n\t       A.attorney_fee_amt,\r\n\t       A.attorney_cost_amt,\r\n\t       A.attorney_file_num,\r\n\t       A.hourly_rate,\r\n\t       A.hours_worked,\r\n\t       A.num_of_days,\r\n\t       A.num_of_weeks,\r\n\t       A.tpd_rate,\r\n\t       A.tpd_rate_fac,\r\n\t       A.tpd_wage_loss,\r\n\t       A.tpd_wkly_wage,\r\n\t       A.claim_pay_ctgry_lump_sum_ind\r\n\tFROM   claim_payment_category A\r\n\tWHERE A.claim_pay_ctgry_id % 2= 1\n),\nLKP_claim_transaction AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tclaim_pay_ak_id\n\tFROM (\n\t\tSELECT A.claimant_cov_det_ak_id as claimant_cov_det_ak_id, \r\n\t\tA.claim_pay_ak_id as claim_pay_ak_id \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_transaction A\r\n\t\tWHERE A.claim_pay_ak_id <> -1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ak_id ORDER BY claimant_cov_det_ak_id DESC) = 1\n),\nEXP_get_values AS (\n\tSELECT\n\tLKP_claim_transaction.claimant_cov_det_ak_id,\n\tSQ_claim_payment_category.claim_pay_ctgry_id,\n\tSQ_claim_payment_category.claim_pay_ctgry_ak_id,\n\tSQ_claim_payment_category.claim_pay_ak_id,\n\tSQ_claim_payment_category.claim_pay_ctgry_type,\n\tSQ_claim_payment_category.claim_pay_ctgry_seq_num,\n\tSQ_claim_payment_category.claim_pay_ctgry_amt,\n\tSQ_claim_payment_category.claim_pay_ctgry_earned_amt,\n\tSQ_claim_payment_category.claim_pay_ctgry_billed_amt,\n\tSQ_claim_payment_category.claim_pay_ctgry_start_date,\n\tSQ_claim_payment_category.claim_pay_ctgry_end_date,\n\tSQ_claim_payment_category.financial_type_code,\n\tSQ_claim_payment_category.invc_num,\n\tSQ_claim_payment_category.cost_containment_saving_amt,\n\tSQ_claim_payment_category.cost_containment_red_amt,\n\tSQ_claim_payment_category.cost_containment_ppo_amt,\n\tSQ_claim_payment_category.attorney_fee_amt,\n\tSQ_claim_payment_category.attorney_cost_amt,\n\tSQ_claim_payment_category.attorney_file_num,\n\tSQ_claim_payment_category.hourly_rate,\n\tSQ_claim_payment_category.hours_worked,\n\tSQ_claim_payment_category.num_of_days,\n\tSQ_claim_payment_category.num_of_weeks,\n\tSQ_claim_payment_category.tpd_rate,\n\tSQ_claim_payment_category.tpd_rate_fac,\n\tSQ_claim_payment_category.tpd_wage_loss,\n\tSQ_claim_payment_category.tpd_wkly_wage,\n\t-- *INF*: to_date('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS trans_date,\n\tSQ_claim_payment_category.claim_pay_ctgry_lump_sum_ind\n\tFROM SQ_claim_payment_category\n\tLEFT JOIN LKP_claim_transaction\n\tON LKP_claim_transaction.claim_pay_ak_id = SQ_claim_payment_category.claim_pay_ak_id\n),\nLKP_ClaimFeature AS (\n\tSELECT\n\tClaimRepresentativeAkId,\n\tFeatureRepresentativeAssignedDate,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tselect CF.ClaimRepresentativeAkId as ClaimRepresentativeAkId, \r\n\t\t\tCF.FeatureRepresentativeAssignedDate as FeatureRepresentativeAssignedDate, \r\n\t\t\tCCD.claimant_cov_det_ak_id as claimant_cov_det_ak_id\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO \r\n\t\t\ton CCD.claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id and CPO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.ClaimFeature CF \r\n\t\t\ton CCD.claim_party_occurrence_ak_id = CF.ClaimPartyOccurrenceAKId and CF.CurrentSnapshotFlag = 1\r\n\t\twhere CCD.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY ClaimRepresentativeAkId) = 1\n),\nLKP_Claim_Payment_Dim AS (\n\tSELECT\n\tIN_claim_pay_ak_id,\n\tclaim_pay_dim_id,\n\tpay_issued_date,\n\tpay_cashed_date,\n\tpay_voided_date,\n\tpay_reposted_date,\n\tedw_claim_pay_ak_id\n\tFROM (\n\t\tSELECT claim_payment_dim.claim_pay_dim_id    AS claim_pay_dim_id,\r\n\t\t       claim_payment_dim.pay_issued_date     AS pay_issued_date,\r\n\t\t       claim_payment_dim.pay_cashed_date     AS pay_cashed_date,\r\n\t\t       claim_payment_dim.pay_voided_date     AS pay_voided_date,\r\n\t\t       claim_payment_dim.pay_reposted_date   AS pay_reposted_date,\r\n\t\t       claim_payment_dim.edw_claim_pay_ak_id AS edw_claim_pay_ak_id\r\n\t\tFROM   @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_payment_dim\r\n\t\tWHERE  edw_claim_pay_ak_id IN \r\n\t\t(SELECT claim_pay_ak_id  FROM   @{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_payment_category)\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_pay_ak_id ORDER BY IN_claim_pay_ak_id DESC) = 1\n),\nLKP_claim_financial_type_dim AS (\n\tSELECT\n\tclaim_financial_type_dim_id,\n\tfinancial_type_code\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_financial_type_dim_id,\n\t\t\tfinancial_type_code\n\t\tFROM claim_financial_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY financial_type_code ORDER BY claim_financial_type_dim_id) = 1\n),\nLKP_claim_pay_ctgry_type_dim AS (\n\tSELECT\n\tclaim_pay_ctgry_type_dim_id,\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_lump_sum_ind\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\tclaim_pay_ctgry_type,\n\t\t\tclaim_pay_ctgry_lump_sum_ind\n\t\tFROM claim_payment_category_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ctgry_type,claim_pay_ctgry_lump_sum_ind ORDER BY claim_pay_ctgry_type_dim_id) = 1\n),\nLKP_claim_rep_dim_id AS (\n\tSELECT\n\tclaim_rep_dim_id,\n\tedw_claim_rep_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_rep_dim_id,\n\t\t\tedw_claim_rep_ak_id\n\t\tFROM claim_representative_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_rep_ak_id ORDER BY claim_rep_dim_id) = 1\n),\nmplt_claimant_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_CLAIMANT_COV_DIM AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaimant_cov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claimant_cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id\n\t\tFROM LKP_CLAIMANT_COV_DIM\n\t),\n),\nmplt_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nEXP_Cov_Level_Dim_Ids AS (\n\tSELECT\n\tEXP_get_values.claimant_cov_det_ak_id,\n\tEXP_get_values.trans_date,\n\tmplt_coverage_dim_id.cov_dim_id,\n\tLKP_claim_pay_ctgry_type_dim.claim_pay_ctgry_type_dim_id,\n\tLKP_Claim_Payment_Dim.claim_pay_dim_id,\n\tLKP_Claim_Payment_Dim.pay_issued_date,\n\tLKP_Claim_Payment_Dim.pay_cashed_date,\n\tLKP_Claim_Payment_Dim.pay_voided_date,\n\tLKP_Claim_Payment_Dim.pay_reposted_date,\n\tLKP_claim_financial_type_dim.claim_financial_type_dim_id,\n\tmplt_claimant_coverage_dim_id.claimant_cov_dim_id,\n\tEXP_get_values.claim_pay_ctgry_id,\n\tEXP_get_values.claim_pay_ctgry_ak_id,\n\tEXP_get_values.claim_pay_ak_id,\n\tEXP_get_values.claim_pay_ctgry_type,\n\tEXP_get_values.claim_pay_ctgry_seq_num,\n\tEXP_get_values.claim_pay_ctgry_amt,\n\tEXP_get_values.claim_pay_ctgry_earned_amt,\n\tEXP_get_values.claim_pay_ctgry_billed_amt,\n\tEXP_get_values.claim_pay_ctgry_start_date,\n\tEXP_get_values.claim_pay_ctgry_end_date,\n\tEXP_get_values.financial_type_code,\n\tEXP_get_values.invc_num,\n\tEXP_get_values.cost_containment_saving_amt,\n\tEXP_get_values.cost_containment_red_amt,\n\tEXP_get_values.cost_containment_ppo_amt,\n\tEXP_get_values.attorney_fee_amt,\n\tEXP_get_values.attorney_cost_amt,\n\tEXP_get_values.attorney_file_num,\n\tEXP_get_values.hourly_rate,\n\tEXP_get_values.hours_worked,\n\tEXP_get_values.num_of_days,\n\tEXP_get_values.num_of_weeks,\n\tEXP_get_values.tpd_rate,\n\tEXP_get_values.tpd_rate_fac,\n\tEXP_get_values.tpd_wage_loss,\n\tEXP_get_values.tpd_wkly_wage,\n\tLKP_claim_rep_dim_id.claim_rep_dim_id AS FeatureRepresentativeDimId,\n\tLKP_ClaimFeature.FeatureRepresentativeAssignedDate\n\tFROM EXP_get_values\n\t -- Manually join with mplt_claimant_coverage_dim_id\n\t -- Manually join with mplt_coverage_dim_id\n\tLEFT JOIN LKP_ClaimFeature\n\tON LKP_ClaimFeature.claimant_cov_det_ak_id = EXP_get_values.claimant_cov_det_ak_id\n\tLEFT JOIN LKP_Claim_Payment_Dim\n\tON LKP_Claim_Payment_Dim.edw_claim_pay_ak_id = EXP_get_values.claim_pay_ak_id\n\tLEFT JOIN LKP_claim_financial_type_dim\n\tON LKP_claim_financial_type_dim.financial_type_code = EXP_get_values.financial_type_code\n\tLEFT JOIN LKP_claim_pay_ctgry_type_dim\n\tON LKP_claim_pay_ctgry_type_dim.claim_pay_ctgry_type = EXP_get_values.claim_pay_ctgry_type AND LKP_claim_pay_ctgry_type_dim.claim_pay_ctgry_lump_sum_ind = EXP_get_values.claim_pay_ctgry_lump_sum_ind\n\tLEFT JOIN LKP_claim_rep_dim_id\n\tON LKP_claim_rep_dim_id.edw_claim_rep_ak_id = LKP_ClaimFeature.ClaimRepresentativeAkId\n),\nmplt_Claimant_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nEXP_Claimant_Dim_Ids AS (\n\tSELECT\n\tEXP_Cov_Level_Dim_Ids.claimant_cov_det_ak_id,\n\tEXP_Cov_Level_Dim_Ids.trans_date,\n\tEXP_Cov_Level_Dim_Ids.cov_dim_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_type_dim_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_dim_id,\n\tEXP_Cov_Level_Dim_Ids.pay_issued_date,\n\tEXP_Cov_Level_Dim_Ids.pay_cashed_date,\n\tEXP_Cov_Level_Dim_Ids.pay_voided_date,\n\tEXP_Cov_Level_Dim_Ids.pay_reposted_date,\n\tEXP_Cov_Level_Dim_Ids.claim_financial_type_dim_id,\n\tEXP_Cov_Level_Dim_Ids.claimant_cov_dim_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_ak_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ak_id,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_type,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_seq_num,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_amt,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_earned_amt,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_billed_amt,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_start_date,\n\tEXP_Cov_Level_Dim_Ids.claim_pay_ctgry_end_date,\n\tEXP_Cov_Level_Dim_Ids.financial_type_code,\n\tEXP_Cov_Level_Dim_Ids.invc_num,\n\tEXP_Cov_Level_Dim_Ids.cost_containment_saving_amt,\n\tEXP_Cov_Level_Dim_Ids.cost_containment_red_amt,\n\tEXP_Cov_Level_Dim_Ids.cost_containment_ppo_amt,\n\tEXP_Cov_Level_Dim_Ids.attorney_fee_amt,\n\tEXP_Cov_Level_Dim_Ids.attorney_cost_amt,\n\tEXP_Cov_Level_Dim_Ids.attorney_file_num,\n\tEXP_Cov_Level_Dim_Ids.hourly_rate,\n\tEXP_Cov_Level_Dim_Ids.hours_worked,\n\tEXP_Cov_Level_Dim_Ids.num_of_days,\n\tEXP_Cov_Level_Dim_Ids.num_of_weeks,\n\tEXP_Cov_Level_Dim_Ids.tpd_rate,\n\tEXP_Cov_Level_Dim_Ids.tpd_rate_fac,\n\tEXP_Cov_Level_Dim_Ids.tpd_wage_loss,\n\tEXP_Cov_Level_Dim_Ids.tpd_wkly_wage,\n\tmplt_Claimant_dim_id.claimant_dim_id,\n\tEXP_Cov_Level_Dim_Ids.FeatureRepresentativeDimId,\n\tEXP_Cov_Level_Dim_Ids.FeatureRepresentativeAssignedDate\n\tFROM EXP_Cov_Level_Dim_Ids\n\t -- Manually join with mplt_Claimant_dim_id\n),\nmplt_Claim_occurence_dim_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Strategic_Business_Division_Dim AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)\n\t\t) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(\n\t\t    UDF_DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)\n\t\t) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, CURRENT_TIMESTAMP, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_get_dim_id AS (\n\tSELECT\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_id,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_ak_id,\n\tEXP_Claimant_Dim_Ids.claim_pay_ak_id,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_type,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_seq_num,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_amt,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_earned_amt,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_billed_amt,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_pay_ctgry_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\r\n\t-- \n\tLKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_pay_ctgry_start_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_pay_ctgry_start_date_id), -1, v_claim_pay_ctgry_start_date_id)\n\tIFF(v_claim_pay_ctgry_start_date_id IS NULL, - 1, v_claim_pay_ctgry_start_date_id) AS claim_pay_ctgry_start_date_id_out,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_end_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_pay_ctgry_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_pay_ctgry_end_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_pay_ctgry_end_date_id), -1, v_claim_pay_ctgry_end_date_id)\n\tIFF(v_claim_pay_ctgry_end_date_id IS NULL, - 1, v_claim_pay_ctgry_end_date_id) AS claim_pay_ctgry_end_date_id_out,\n\tEXP_Claimant_Dim_Ids.claim_financial_type_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_financial_type_dim_id), -1, claim_financial_type_dim_id)\n\tIFF(claim_financial_type_dim_id IS NULL, - 1, claim_financial_type_dim_id) AS claim_financial_type_dim_id_out,\n\tEXP_Claimant_Dim_Ids.financial_type_code,\n\tEXP_Claimant_Dim_Ids.invc_num,\n\tEXP_Claimant_Dim_Ids.cost_containment_saving_amt,\n\tEXP_Claimant_Dim_Ids.cost_containment_red_amt,\n\tEXP_Claimant_Dim_Ids.cost_containment_ppo_amt,\n\tEXP_Claimant_Dim_Ids.attorney_fee_amt,\n\tEXP_Claimant_Dim_Ids.attorney_cost_amt,\n\tEXP_Claimant_Dim_Ids.attorney_file_num,\n\tEXP_Claimant_Dim_Ids.hourly_rate,\n\tEXP_Claimant_Dim_Ids.hours_worked,\n\tEXP_Claimant_Dim_Ids.num_of_days,\n\tEXP_Claimant_Dim_Ids.num_of_weeks,\n\tEXP_Claimant_Dim_Ids.tpd_rate,\n\tEXP_Claimant_Dim_Ids.tpd_rate_fac,\n\tEXP_Claimant_Dim_Ids.tpd_wage_loss,\n\tEXP_Claimant_Dim_Ids.tpd_wkly_wage,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_occurrence_dim_id), -1, claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_out,\n\tEXP_Claimant_Dim_Ids.claimant_dim_id,\n\t-- *INF*: IIF(ISNULL(claimant_dim_id), -1, claimant_dim_id)\n\tIFF(claimant_dim_id IS NULL, - 1, claimant_dim_id) AS claimant_dim_id_out,\n\tEXP_Claimant_Dim_Ids.claimant_cov_dim_id,\n\t-- *INF*: IIF(ISNULL(claimant_cov_dim_id), -1, claimant_cov_dim_id)\r\n\t-- \n\tIFF(claimant_cov_dim_id IS NULL, - 1, claimant_cov_dim_id) AS claimant_cov_dim_id_out,\n\tmplt_Claim_occurence_dim_id.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id), -1, pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_out,\n\tmplt_Claim_occurence_dim_id.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id), -1, agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_out,\n\tmplt_Claim_occurence_dim_id.claim_loss_date,\n\tmplt_Claim_occurence_dim_id.claim_discovery_date,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_rpted_date,\n\tmplt_Claim_occurence_dim_id.claim_cat_start_date,\n\tmplt_Claim_occurence_dim_id.claim_cat_end_date,\n\tmplt_Claim_occurence_dim_id.claim_rep_assigned_date,\n\tmplt_Claim_occurence_dim_id.claim_rep_unassigned_date,\n\tmplt_Claim_occurence_dim_id.claim_scripted_date,\n\tmplt_Claim_occurence_dim_id.source_claim_rpted_date,\n\tmplt_Claim_occurence_dim_id.claim_open_date,\n\tmplt_Claim_occurence_dim_id.claim_close_date,\n\tmplt_Claim_occurence_dim_id.claim_reopen_date,\n\tmplt_Claim_occurence_dim_id.claim_closed_after_reopen_date,\n\tmplt_Claim_occurence_dim_id.claim_notice_only_date,\n\tmplt_Claim_occurence_dim_id.pol_eff_date,\n\tmplt_Claim_occurence_dim_id.pol_exp_date,\n\tEXP_Claimant_Dim_Ids.pay_issued_date,\n\tEXP_Claimant_Dim_Ids.pay_cashed_date,\n\tEXP_Claimant_Dim_Ids.pay_voided_date,\n\tEXP_Claimant_Dim_Ids.pay_reposted_date,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_claim_rep_id), -1, claim_rep_dim_prim_claim_rep_id)\r\n\t-- \n\tIFF(claim_rep_dim_prim_claim_rep_id IS NULL, - 1, claim_rep_dim_prim_claim_rep_id) AS claim_rep_dim_prim_claim_rep_id_out,\n\tEXP_Claimant_Dim_Ids.claim_pay_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_pay_dim_id), -1, claim_pay_dim_id)\n\tIFF(claim_pay_dim_id IS NULL, - 1, claim_pay_dim_id) AS claim_pay_dim_id_out,\n\tEXP_Claimant_Dim_Ids.claim_pay_ctgry_type_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_pay_ctgry_type_dim_id), -1, claim_pay_ctgry_type_dim_id)\n\tIFF(claim_pay_ctgry_type_dim_id IS NULL, - 1, claim_pay_ctgry_type_dim_id) AS claim_pay_ctgry_type_dim_id_out,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tEXP_Claimant_Dim_Ids.cov_dim_id,\n\t-- *INF*: IIF(ISNULL(cov_dim_id), -1, cov_dim_id)\n\tIFF(cov_dim_id IS NULL, - 1, cov_dim_id) AS cov_dim_id_out,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id),-1,claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_out,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id),-1,claim_rep_dim_prim_litigation_handler_id)\n\tIFF(\n\t    claim_rep_dim_prim_litigation_handler_id IS NULL, - 1,\n\t    claim_rep_dim_prim_litigation_handler_id\n\t) AS claim_rep_dim_prim_litigation_handler_id_out,\n\t-1 AS default_dim_id,\n\tmplt_Claim_occurence_dim_id.AgencyDimID,\n\tmplt_Claim_occurence_dim_id.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_dim_id_out,\n\tmplt_Claim_occurence_dim_id.claim_case_dim_id,\n\t-- *INF*: iif(isnull(claim_case_dim_id)\r\n\t-- ,-1\r\n\t-- ,claim_case_dim_id)\n\tIFF(claim_case_dim_id IS NULL, - 1, claim_case_dim_id) AS claim_case_dim_id_out,\n\tmplt_Claim_occurence_dim_id.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tmplt_Strategic_Business_Division_Dim.strtgc_bus_dvsn_dim_id,\n\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_out,\n\tmplt_Claim_occurence_dim_id.AgencyAKID,\n\tmplt_Claim_occurence_dim_id.SalesTerritoryAKID,\n\tmplt_Claim_occurence_dim_id.RegionalSalesManagerAKID,\n\tmplt_Claim_occurence_dim_id.SalesDirectorAKID,\n\tmplt_Claim_occurence_dim_id.StrategicProfitCenterAKId,\n\tmplt_Claim_occurence_dim_id.InsuranceSegmentAKId,\n\tmplt_Claim_occurence_dim_id.PolicyOfferingAKId,\n\tEXP_Claimant_Dim_Ids.FeatureRepresentativeDimId,\n\t-- *INF*: IIF(ISNULL(FeatureRepresentativeDimId),\r\n\t-- -1,\r\n\t-- FeatureRepresentativeDimId)\n\tIFF(FeatureRepresentativeDimId IS NULL, - 1, FeatureRepresentativeDimId) AS FeatureRepresentativeDimId_out,\n\tEXP_Claimant_Dim_Ids.FeatureRepresentativeAssignedDate\n\tFROM EXP_Claimant_Dim_Ids\n\t -- Manually join with mplt_Claim_occurence_dim_id\n\t -- Manually join with mplt_Strategic_Business_Division_Dim\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_pay_ctgry_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_pay_ctgry_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_pay_ctgry_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n),\nEXP_Date_Ids AS (\n\tSELECT\n\tclaim_pay_ctgry_id,\n\tclaim_pay_ctgry_ak_id,\n\tclaim_pay_ak_id,\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_seq_num,\n\tclaim_pay_ctgry_amt,\n\tclaim_pay_ctgry_earned_amt,\n\tclaim_pay_ctgry_billed_amt,\n\tclaim_pay_ctgry_start_date_id_out,\n\tclaim_pay_ctgry_end_date_id_out,\n\tclaim_financial_type_dim_id_out,\n\tinvc_num,\n\tcost_containment_saving_amt,\n\tcost_containment_red_amt,\n\tcost_containment_ppo_amt,\n\tattorney_fee_amt,\n\tattorney_cost_amt,\n\tattorney_file_num,\n\thourly_rate,\n\thours_worked,\n\tnum_of_days,\n\tnum_of_weeks,\n\ttpd_rate,\n\ttpd_rate_fac,\n\ttpd_wage_loss,\n\ttpd_wkly_wage,\n\tclaim_occurrence_dim_id_out,\n\tclaimant_dim_id_out,\n\tclaimant_cov_dim_id_out,\n\tpol_key_dim_id_out,\n\tagency_dim_id_out,\n\tclaim_rep_dim_prim_claim_rep_id_out,\n\tclaim_pay_dim_id_out,\n\tclaim_pay_ctgry_type_dim_id_out,\n\taudit_id,\n\tcov_dim_id_out,\n\tclaim_rep_dim_examiner_id_out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tdefault_dim_id,\n\tclaim_created_by_dim_id_out,\n\tclaim_case_dim_id_out,\n\tcontract_cust_dim_id_out,\n\tstrtgc_bus_dvsn_dim_id_out,\n\tclaim_loss_date AS IN_claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(v_claim_loss_date_id IS NOT NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tclaim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(v_claim_discovery_date_id IS NOT NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tclaim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(v_claim_occurrence_rpted_date_id IS NOT NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tclaim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(v_claim_cat_start_date_id IS NOT NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tclaim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(v_claim_cat_end_date_id IS NOT NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tclaim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, -1)\n\tIFF(v_claim_rep_assigned_date_id IS NOT NULL, v_claim_rep_assigned_date_id, - 1) AS claim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, -1)\n\tIFF(v_claim_rep_unassigned_date_id IS NOT NULL, v_claim_rep_unassigned_date_id, - 1) AS claim_rep_unassigned_date_id,\n\tclaim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_scripted_date_id), v_claim_scripted_date_id, -1)\n\tIFF(v_claim_scripted_date_id IS NOT NULL, v_claim_scripted_date_id, - 1) AS claim_scripted_date_id,\n\tsource_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_source_claim_rpted_date_id), v_source_claim_rpted_date_id, -1)\n\tIFF(v_source_claim_rpted_date_id IS NOT NULL, v_source_claim_rpted_date_id, - 1) AS source_claim_rpted_date_id,\n\tclaim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date_id), v_claim_open_date_id, -1)\n\tIFF(v_claim_open_date_id IS NOT NULL, v_claim_open_date_id, - 1) AS claim_open_date_id,\n\tclaim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date_id), v_claim_close_date_id, -1)\n\tIFF(v_claim_close_date_id IS NOT NULL, v_claim_close_date_id, - 1) AS claim_close_date_id,\n\tclaim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date_id), v_claim_reopen_date_id, -1)\n\tIFF(v_claim_reopen_date_id IS NOT NULL, v_claim_reopen_date_id, - 1) AS claim_reopen_date_id,\n\tclaim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date_id), v_claim_closed_after_reopen_date_id, -1)\n\tIFF(\n\t    v_claim_closed_after_reopen_date_id IS NOT NULL, v_claim_closed_after_reopen_date_id, - 1\n\t) AS claim_closed_after_reopen_date_id,\n\tclaim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date_id), v_claim_notice_only_date_id, -1)\n\tIFF(v_claim_notice_only_date_id IS NOT NULL, v_claim_notice_only_date_id, - 1) AS claim_notice_only_date_id,\n\tpol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_eff_date_id), v_pol_eff_date_id, -1)\n\tIFF(v_pol_eff_date_id IS NOT NULL, v_pol_eff_date_id, - 1) AS pol_eff_date_id,\n\tpol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_exp_date_id), v_pol_exp_date_id, -1)\n\tIFF(v_pol_exp_date_id IS NOT NULL, v_pol_exp_date_id, - 1) AS pol_exp_date_id,\n\tpay_issued_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pay_issued_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_issued_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_issued_date_id), v_pay_issued_date_id, -1)\n\tIFF(v_pay_issued_date_id IS NOT NULL, v_pay_issued_date_id, - 1) AS pay_issued_date_id,\n\tpay_cashed_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pay_cashed_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_cashed_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_cashed_date_id), v_pay_cashed_date_id, -1)\n\tIFF(v_pay_cashed_date_id IS NOT NULL, v_pay_cashed_date_id, - 1) AS pay_cashed_date_id,\n\tpay_voided_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pay_voided_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_voided_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_voided_date_id), v_pay_voided_date_id, -1)\n\tIFF(v_pay_voided_date_id IS NOT NULL, v_pay_voided_date_id, - 1) AS pay_voided_date_id,\n\tpay_reposted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pay_reposted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_reposted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_reposted_date_id), v_pay_reposted_date_id, -1)\n\tIFF(v_pay_reposted_date_id IS NOT NULL, v_pay_reposted_date_id, - 1) AS pay_reposted_date_id,\n\tFeatureRepresentativeDimId_out AS FeatureRepresentativeDimId,\n\tFeatureRepresentativeAssignedDate,\n\t-- *INF*: :LKP.LKP_calender_dim(to_date(to_char(FeatureRepresentativeAssignedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_FeatureRepresentativeAssignedDate_id,\n\t-- *INF*: IIF(NOT ISNULL(v_FeatureRepresentativeAssignedDate_id),\r\n\t-- v_FeatureRepresentativeAssignedDate_id,\r\n\t-- -1)\n\tIFF(\n\t    v_FeatureRepresentativeAssignedDate_id IS NOT NULL, v_FeatureRepresentativeAssignedDate_id,\n\t    - 1\n\t) AS FeatureRepresentativeAssignedDate_id\n\tFROM EXP_get_dim_id\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(IN_claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_issued_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_cashed_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_voided_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(pay_reposted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_FeatureRepresentativeAssignedDate_MM_DD_YYYY_MM_DD_YYYY.clndr_date = TO_TIMESTAMP(to_char(FeatureRepresentativeAssignedDate, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n),\nLKP_Claim_Payment_Category_Fact AS (\n\tSELECT\n\tclaim_pay_ctgry_fact_id,\n\tedw_claim_pay_ctgry_pk_id,\n\tedw_claim_pay_ctgry_ak_id,\n\tclaim_occurrence_dim_id,\n\tclaimant_dim_id,\n\tclaimant_cov_dim_id,\n\tcov_dim_id,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_dim_examiner_id,\n\tclaim_rep_dim_prim_litigation_handler_id,\n\tclaim_rep_dim_trans_entry_oper_id,\n\tclaim_rep_dim_claim_created_by_id,\n\tpol_dim_id,\n\tagency_dim_id,\n\tclaim_pay_dim_id,\n\tclaim_financial_type_dim_id,\n\tclaim_pay_ctgry_type_dim_id,\n\tclaim_pay_ctgry_amt,\n\tclaim_pay_ctgry_earned_amt,\n\tclaim_pay_ctgry_billed_amt,\n\tclaim_pay_ctgry_start_date_id,\n\tclaim_pay_ctgry_end_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tpay_issued_date_id,\n\tpay_cashed_date_id,\n\tpay_voided_date_id,\n\tpay_reposted_date_id,\n\tinvc_num,\n\tcost_containment_saving_amt,\n\tcost_containment_red_amt,\n\tcost_containment_ppo_amt,\n\tattorney_fee_amt,\n\tattorney_cost_amt,\n\tattorney_file_num,\n\thourly_rate,\n\thours_worked,\n\tnum_of_days,\n\tnum_of_weeks,\n\ttpd_rate,\n\ttpd_rate_fac,\n\ttpd_wage_loss,\n\ttpd_wkly_wage,\n\tclaim_case_dim_id,\n\tcontract_cust_dim_id,\n\tstrtgc_bus_dvsn_dim_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_ctgry_fact_id,\n\t\t\tedw_claim_pay_ctgry_pk_id,\n\t\t\tedw_claim_pay_ctgry_ak_id,\n\t\t\tclaim_occurrence_dim_id,\n\t\t\tclaimant_dim_id,\n\t\t\tclaimant_cov_dim_id,\n\t\t\tcov_dim_id,\n\t\t\tclaim_rep_dim_prim_claim_rep_id,\n\t\t\tclaim_rep_dim_examiner_id,\n\t\t\tclaim_rep_dim_prim_litigation_handler_id,\n\t\t\tclaim_rep_dim_trans_entry_oper_id,\n\t\t\tclaim_rep_dim_claim_created_by_id,\n\t\t\tpol_dim_id,\n\t\t\tagency_dim_id,\n\t\t\tclaim_pay_dim_id,\n\t\t\tclaim_financial_type_dim_id,\n\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\tclaim_pay_ctgry_amt,\n\t\t\tclaim_pay_ctgry_earned_amt,\n\t\t\tclaim_pay_ctgry_billed_amt,\n\t\t\tclaim_pay_ctgry_start_date_id,\n\t\t\tclaim_pay_ctgry_end_date_id,\n\t\t\tclaim_loss_date_id,\n\t\t\tclaim_discovery_date_id,\n\t\t\tclaim_scripted_date_id,\n\t\t\tsource_claim_rpted_date_id,\n\t\t\tclaim_rpted_date_id,\n\t\t\tclaim_open_date_id,\n\t\t\tclaim_close_date_id,\n\t\t\tclaim_reopen_date_id,\n\t\t\tclaim_closed_after_reopen_date_id,\n\t\t\tclaim_notice_only_date_id,\n\t\t\tclaim_cat_start_date_id,\n\t\t\tclaim_cat_end_date_id,\n\t\t\tclaim_rep_assigned_date_id,\n\t\t\tclaim_rep_unassigned_date_id,\n\t\t\tpol_eff_date_id,\n\t\t\tpol_exp_date_id,\n\t\t\tpay_issued_date_id,\n\t\t\tpay_cashed_date_id,\n\t\t\tpay_voided_date_id,\n\t\t\tpay_reposted_date_id,\n\t\t\tinvc_num,\n\t\t\tcost_containment_saving_amt,\n\t\t\tcost_containment_red_amt,\n\t\t\tcost_containment_ppo_amt,\n\t\t\tattorney_fee_amt,\n\t\t\tattorney_cost_amt,\n\t\t\tattorney_file_num,\n\t\t\thourly_rate,\n\t\t\thours_worked,\n\t\t\tnum_of_days,\n\t\t\tnum_of_weeks,\n\t\t\ttpd_rate,\n\t\t\ttpd_rate_fac,\n\t\t\ttpd_wage_loss,\n\t\t\ttpd_wkly_wage,\n\t\t\tclaim_case_dim_id,\n\t\t\tcontract_cust_dim_id,\n\t\t\tstrtgc_bus_dvsn_dim_id\n\t\tFROM claim_payment_category_fact\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_pay_ctgry_pk_id ORDER BY claim_pay_ctgry_fact_id) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_fact_id AS lkp_claim_pay_ctgry_fact_id,\n\tLKP_Claim_Payment_Category_Fact.edw_claim_pay_ctgry_pk_id AS lkp_edw_claim_pay_ctgry_pk_id,\n\tLKP_Claim_Payment_Category_Fact.edw_claim_pay_ctgry_ak_id AS lkp_edw_claim_pay_ctgry_ak_id,\n\tLKP_Claim_Payment_Category_Fact.claim_occurrence_dim_id AS lkp_claim_occurrence_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claimant_dim_id AS lkp_claimant_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claimant_cov_dim_id AS lkp_claimant_cov_dim_id,\n\tLKP_Claim_Payment_Category_Fact.cov_dim_id AS lkp_cov_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_dim_prim_claim_rep_id AS lkp_claim_rep_dim_prim_claim_rep_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_dim_examiner_id AS lkp_claim_rep_dim_examiner_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_dim_prim_litigation_handler_id AS lkp_claim_rep_dim_prim_litigation_handler_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_dim_trans_entry_oper_id AS lkp_claim_rep_dim_trans_entry_oper_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_dim_claim_created_by_id AS lkp_claim_rep_dim_claim_created_by_id,\n\tLKP_Claim_Payment_Category_Fact.pol_dim_id AS lkp_pol_key_dim_id,\n\tLKP_Claim_Payment_Category_Fact.agency_dim_id AS lkp_agency_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_dim_id AS lkp_claim_pay_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claim_financial_type_dim_id AS lkp_claim_financial_type_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_type_dim_id AS lkp_claim_pay_ctgry_type_dim_id,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_amt AS lkp_claim_pay_ctgry_amt,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_earned_amt AS lkp_claim_pay_ctgry_earned_amt,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_billed_amt AS lkp_claim_pay_ctgry_billed_amt,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_start_date_id AS lkp_claim_pay_ctgry_start_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_pay_ctgry_end_date_id AS lkp_claim_pay_ctgry_end_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_loss_date_id AS lkp_claim_loss_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_discovery_date_id AS lkp_claim_discovery_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_scripted_date_id AS lkp_claim_scripted_date_id,\n\tLKP_Claim_Payment_Category_Fact.source_claim_rpted_date_id AS lkp_source_claim_rpted_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rpted_date_id AS lkp_claim_rpted_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_open_date_id AS lkp_claim_open_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_close_date_id AS lkp_claim_close_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_reopen_date_id AS lkp_claim_reopen_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_closed_after_reopen_date_id AS lkp_claim_closed_after_reopen_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_notice_only_date_id AS lkp_claim_notice_only_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_cat_start_date_id AS lkp_claim_cat_start_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_cat_end_date_id AS lkp_claim_cat_end_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_assigned_date_id AS lkp_claim_rep_assigned_date_id,\n\tLKP_Claim_Payment_Category_Fact.claim_rep_unassigned_date_id AS lkp_claim_rep_unassigned_date_id,\n\tLKP_Claim_Payment_Category_Fact.pol_eff_date_id AS lkp_pol_eff_date_id,\n\tLKP_Claim_Payment_Category_Fact.pol_exp_date_id AS lkp_pol_exp_date_id,\n\tLKP_Claim_Payment_Category_Fact.pay_issued_date_id AS lkp_pay_issued_date_id,\n\tLKP_Claim_Payment_Category_Fact.pay_cashed_date_id AS lkp_pay_cashed_date_id,\n\tLKP_Claim_Payment_Category_Fact.pay_voided_date_id AS lkp_pay_voided_date_id,\n\tLKP_Claim_Payment_Category_Fact.pay_reposted_date_id AS lkp_pay_reposted_date_id,\n\tLKP_Claim_Payment_Category_Fact.invc_num AS lkp_invc_num,\n\tLKP_Claim_Payment_Category_Fact.cost_containment_saving_amt AS lkp_cost_containment_saving_amt,\n\tLKP_Claim_Payment_Category_Fact.cost_containment_red_amt AS lkp_cost_containment_red_amt,\n\tLKP_Claim_Payment_Category_Fact.cost_containment_ppo_amt AS lkp_cost_containment_ppo_amt,\n\tLKP_Claim_Payment_Category_Fact.attorney_fee_amt AS lkp_attorney_fee_amt,\n\tLKP_Claim_Payment_Category_Fact.attorney_cost_amt AS lkp_attorney_cost_amt,\n\tLKP_Claim_Payment_Category_Fact.attorney_file_num AS lkp_attorney_file_num,\n\tLKP_Claim_Payment_Category_Fact.hourly_rate AS lkp_hourly_rate,\n\tLKP_Claim_Payment_Category_Fact.hours_worked AS lkp_hours_worked,\n\tLKP_Claim_Payment_Category_Fact.num_of_days AS lkp_num_of_days,\n\tLKP_Claim_Payment_Category_Fact.num_of_weeks AS lkp_num_of_weeks,\n\tLKP_Claim_Payment_Category_Fact.tpd_rate AS lkp_tpd_rate,\n\tLKP_Claim_Payment_Category_Fact.tpd_rate_fac AS lkp_tpd_rate_fac,\n\tLKP_Claim_Payment_Category_Fact.tpd_wage_loss AS lkp_tpd_wage_loss,\n\tLKP_Claim_Payment_Category_Fact.tpd_wkly_wage AS lkp_tpd_wkly_wage,\n\tLKP_Claim_Payment_Category_Fact.claim_case_dim_id AS lkp_claim_case_dim_id,\n\tLKP_Claim_Payment_Category_Fact.contract_cust_dim_id AS lkp_contract_cust_dim_id,\n\tLKP_Claim_Payment_Category_Fact.strtgc_bus_dvsn_dim_id AS lkp_strtgc_bus_dvsn_dim_id,\n\tEXP_Date_Ids.claim_pay_ctgry_id,\n\tEXP_Date_Ids.claim_pay_ctgry_ak_id,\n\tEXP_Date_Ids.claim_pay_ak_id,\n\tEXP_Date_Ids.claim_pay_ctgry_type,\n\tEXP_Date_Ids.claim_pay_ctgry_seq_num,\n\tEXP_Date_Ids.claim_pay_ctgry_amt,\n\tEXP_Date_Ids.claim_pay_ctgry_earned_amt,\n\tEXP_Date_Ids.claim_pay_ctgry_billed_amt,\n\tEXP_Date_Ids.claim_pay_ctgry_start_date_id_out,\n\tEXP_Date_Ids.claim_pay_ctgry_end_date_id_out,\n\tEXP_Date_Ids.claim_financial_type_dim_id_out,\n\tEXP_Date_Ids.invc_num,\n\tEXP_Date_Ids.cost_containment_saving_amt,\n\tEXP_Date_Ids.cost_containment_red_amt,\n\tEXP_Date_Ids.cost_containment_ppo_amt,\n\tEXP_Date_Ids.attorney_fee_amt,\n\tEXP_Date_Ids.attorney_cost_amt,\n\tEXP_Date_Ids.attorney_file_num,\n\tEXP_Date_Ids.hourly_rate,\n\tEXP_Date_Ids.hours_worked,\n\tEXP_Date_Ids.num_of_days,\n\tEXP_Date_Ids.num_of_weeks,\n\tEXP_Date_Ids.tpd_rate,\n\tEXP_Date_Ids.tpd_rate_fac,\n\tEXP_Date_Ids.tpd_wage_loss,\n\tEXP_Date_Ids.tpd_wkly_wage,\n\tEXP_Date_Ids.claim_occurrence_dim_id_out,\n\tEXP_Date_Ids.claimant_dim_id_out,\n\tEXP_Date_Ids.claimant_cov_dim_id_out,\n\tEXP_Date_Ids.pol_key_dim_id_out,\n\tEXP_Date_Ids.agency_dim_id_out,\n\tEXP_Date_Ids.claim_rep_dim_prim_claim_rep_id_out,\n\tEXP_Date_Ids.claim_pay_dim_id_out,\n\tEXP_Date_Ids.claim_pay_ctgry_type_dim_id_out,\n\tEXP_Date_Ids.audit_id,\n\tEXP_Date_Ids.cov_dim_id_out,\n\tEXP_Date_Ids.claim_rep_dim_examiner_id_out,\n\tEXP_Date_Ids.claim_rep_dim_prim_litigation_handler_id_out,\n\tEXP_Date_Ids.claim_created_by_dim_id_out,\n\tEXP_Date_Ids.default_dim_id,\n\tEXP_Date_Ids.claim_case_dim_id_out,\n\tEXP_Date_Ids.claim_loss_date_id,\n\tEXP_Date_Ids.claim_discovery_date_id,\n\tEXP_Date_Ids.claim_scripted_date_id,\n\tEXP_Date_Ids.source_claim_rpted_date_id AS source_claim_scripted_date_id,\n\tEXP_Date_Ids.claim_occurrence_rpted_date_id AS claim_rpted_date_id,\n\tEXP_Date_Ids.claim_open_date_id,\n\tEXP_Date_Ids.claim_close_date_id,\n\tEXP_Date_Ids.claim_reopen_date_id,\n\tEXP_Date_Ids.claim_closed_after_reopen_date_id,\n\tEXP_Date_Ids.claim_notice_only_date_id,\n\tEXP_Date_Ids.claim_cat_start_date_id,\n\tEXP_Date_Ids.claim_cat_end_date_id,\n\tEXP_Date_Ids.claim_rep_assigned_date_id,\n\tEXP_Date_Ids.claim_rep_unassigned_date_id,\n\tEXP_Date_Ids.pol_eff_date_id,\n\tEXP_Date_Ids.pol_exp_date_id,\n\tEXP_Date_Ids.pay_issued_date_id,\n\tEXP_Date_Ids.pay_cashed_date_id,\n\tEXP_Date_Ids.pay_voided_date_id,\n\tEXP_Date_Ids.pay_reposted_date_id,\n\tEXP_Date_Ids.contract_cust_dim_id_out AS contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(lkp_claim_pay_ctgry_fact_id) ,'NEW',\r\n\t-- IIF(\r\n\t-- lkp_edw_claim_pay_ctgry_ak_id <> claim_pay_ctgry_ak_id     OR\r\n\t-- lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id_out   OR\r\n\t-- lkp_claimant_dim_id <> claimant_dim_id_out   OR\r\n\t-- lkp_claimant_cov_dim_id <> claimant_cov_dim_id_out    OR\r\n\t-- lkp_cov_dim_id <>cov_dim_id_out   OR\r\n\t-- lkp_claim_rep_dim_prim_claim_rep_id <> claim_rep_dim_prim_claim_rep_id_out   OR\r\n\t-- lkp_claim_rep_dim_examiner_id <> claim_rep_dim_examiner_id_out   OR\r\n\t-- lkp_claim_rep_dim_prim_litigation_handler_id <> claim_rep_dim_prim_litigation_handler_id_out   OR\r\n\t-- lkp_claim_rep_dim_trans_entry_oper_id <> default_dim_id   OR\r\n\t-- lkp_claim_rep_dim_claim_created_by_id <> claim_created_by_dim_id_out OR\r\n\t-- lkp_pol_key_dim_id <> pol_key_dim_id_out   OR\r\n\t-- lkp_agency_dim_id <> agency_dim_id_out   OR\r\n\t-- lkp_claim_pay_dim_id <> claim_pay_dim_id_out   OR\r\n\t-- lkp_claim_financial_type_dim_id <> claim_financial_type_dim_id_out   OR\r\n\t-- lkp_claim_pay_ctgry_type_dim_id <> claim_pay_ctgry_type_dim_id_out   OR\r\n\t-- ROUND(ABS(lkp_claim_pay_ctgry_amt - claim_pay_ctgry_amt)) >0.01   OR\r\n\t-- ROUND(ABS(lkp_claim_pay_ctgry_earned_amt - claim_pay_ctgry_earned_amt)) > 0.01   OR\r\n\t-- ROUND(ABS(lkp_claim_pay_ctgry_billed_amt - claim_pay_ctgry_billed_amt))>0.01   OR\r\n\t-- lkp_claim_pay_ctgry_start_date_id <> claim_pay_ctgry_start_date_id_out   OR\r\n\t-- lkp_claim_pay_ctgry_end_date_id <> claim_pay_ctgry_end_date_id_out   OR\r\n\t-- lkp_claim_loss_date_id <> claim_loss_date_id   OR\r\n\t-- lkp_claim_discovery_date_id <> claim_discovery_date_id   OR\r\n\t-- lkp_claim_scripted_date_id <> claim_scripted_date_id   OR\r\n\t-- lkp_source_claim_rpted_date_id <> source_claim_scripted_date_id   OR\r\n\t-- lkp_claim_rpted_date_id <> claim_rpted_date_id   OR\r\n\t-- lkp_claim_open_date_id <> claim_open_date_id   OR\r\n\t-- lkp_claim_close_date_id <> claim_close_date_id   OR\r\n\t-- lkp_claim_reopen_date_id <> claim_reopen_date_id   OR\r\n\t-- lkp_claim_closed_after_reopen_date_id <> claim_closed_after_reopen_date_id   OR\r\n\t-- lkp_claim_notice_only_date_id <> claim_notice_only_date_id   OR\r\n\t-- lkp_claim_cat_start_date_id <> claim_cat_start_date_id   OR\r\n\t-- lkp_claim_cat_end_date_id <> claim_cat_end_date_id   OR\r\n\t-- lkp_claim_rep_assigned_date_id <> claim_rep_assigned_date_id   OR\r\n\t-- lkp_claim_rep_unassigned_date_id <> claim_rep_unassigned_date_id   OR\r\n\t-- lkp_pol_eff_date_id <> pol_eff_date_id   OR\r\n\t-- lkp_pol_exp_date_id <> pol_exp_date_id   OR\r\n\t-- lkp_pay_issued_date_id <> pay_issued_date_id   OR\r\n\t-- lkp_pay_cashed_date_id <> pay_cashed_date_id   OR\r\n\t-- lkp_pay_voided_date_id <> pay_voided_date_id   OR\r\n\t-- lkp_pay_reposted_date_id <> pay_reposted_date_id   OR\r\n\t-- lkp_claim_case_dim_id <> claim_case_dim_id_out OR\r\n\t-- LTRIM(RTRIM(lkp_invc_num)) <> LTRIM(RTRIM(invc_num))   OR\r\n\t-- ROUND(ABS(lkp_cost_containment_saving_amt - cost_containment_saving_amt))>0.01   OR\r\n\t-- ROUND(ABS(lkp_cost_containment_red_amt - cost_containment_red_amt))>0.01   OR\r\n\t-- ROUND(ABS(lkp_cost_containment_ppo_amt - cost_containment_ppo_amt))>0.01  OR\r\n\t-- ROUND(ABS(lkp_attorney_fee_amt - attorney_fee_amt))>0.01   OR\r\n\t-- ROUND(ABS(lkp_attorney_cost_amt - attorney_cost_amt))>0.01  OR\r\n\t-- LTRIM(RTRIM(lkp_attorney_file_num)) <> LTRIM(RTRIM(attorney_file_num))   OR\r\n\t-- ROUND(ABS(lkp_hourly_rate -  hourly_rate))>0.01   OR\r\n\t-- ROUND(ABS(lkp_hours_worked - hours_worked))>0.01   OR\r\n\t-- lkp_num_of_days <> num_of_days   OR\r\n\t-- lkp_num_of_weeks <> num_of_weeks   OR\r\n\t-- ROUND(ABS(lkp_tpd_rate - tpd_rate))>0.01   OR\r\n\t-- ROUND(ABS(lkp_tpd_rate_fac - tpd_rate_fac))>0.01   OR\r\n\t-- ROUND(ABS(lkp_tpd_wage_loss - tpd_wage_loss))>0.01   OR\r\n\t-- ROUND(ABS(lkp_tpd_wkly_wage - tpd_wkly_wage))>0.01   OR\r\n\t-- ---LTRIM(RTRIM(lkp_claim_pay_ctgry_comment)) <> LTRIM(RTRIM(claim_pay_ctgry_comment)) OR\r\n\t-- lkp_contract_cust_dim_id <> contract_cust_dim_id  OR\r\n\t-- lkp_strtgc_bus_dvsn_dim_id <> strtgc_bus_dvsn_dim_id, \r\n\t-- 'UPDATE','NOCHANGE'))\r\n\t-- \n\tIFF(\n\t    lkp_claim_pay_ctgry_fact_id IS NULL, 'NEW',\n\t    IFF(\n\t        lkp_edw_claim_pay_ctgry_ak_id <> claim_pay_ctgry_ak_id\n\t        or lkp_claim_occurrence_dim_id <> claim_occurrence_dim_id_out\n\t        or lkp_claimant_dim_id <> claimant_dim_id_out\n\t        or lkp_claimant_cov_dim_id <> claimant_cov_dim_id_out\n\t        or lkp_cov_dim_id <> cov_dim_id_out\n\t        or lkp_claim_rep_dim_prim_claim_rep_id <> claim_rep_dim_prim_claim_rep_id_out\n\t        or lkp_claim_rep_dim_examiner_id <> claim_rep_dim_examiner_id_out\n\t        or lkp_claim_rep_dim_prim_litigation_handler_id <> claim_rep_dim_prim_litigation_handler_id_out\n\t        or lkp_claim_rep_dim_trans_entry_oper_id <> default_dim_id\n\t        or lkp_claim_rep_dim_claim_created_by_id <> claim_created_by_dim_id_out\n\t        or lkp_pol_key_dim_id <> pol_key_dim_id_out\n\t        or lkp_agency_dim_id <> agency_dim_id_out\n\t        or lkp_claim_pay_dim_id <> claim_pay_dim_id_out\n\t        or lkp_claim_financial_type_dim_id <> claim_financial_type_dim_id_out\n\t        or lkp_claim_pay_ctgry_type_dim_id <> claim_pay_ctgry_type_dim_id_out\n\t        or ROUND(ABS(lkp_claim_pay_ctgry_amt - claim_pay_ctgry_amt)) > 0.01\n\t        or ROUND(ABS(lkp_claim_pay_ctgry_earned_amt - claim_pay_ctgry_earned_amt)) > 0.01\n\t        or ROUND(ABS(lkp_claim_pay_ctgry_billed_amt - claim_pay_ctgry_billed_amt)) > 0.01\n\t        or lkp_claim_pay_ctgry_start_date_id <> claim_pay_ctgry_start_date_id_out\n\t        or lkp_claim_pay_ctgry_end_date_id <> claim_pay_ctgry_end_date_id_out\n\t        or lkp_claim_loss_date_id <> claim_loss_date_id\n\t        or lkp_claim_discovery_date_id <> claim_discovery_date_id\n\t        or lkp_claim_scripted_date_id <> claim_scripted_date_id\n\t        or lkp_source_claim_rpted_date_id <> source_claim_scripted_date_id\n\t        or lkp_claim_rpted_date_id <> claim_rpted_date_id\n\t        or lkp_claim_open_date_id <> claim_open_date_id\n\t        or lkp_claim_close_date_id <> claim_close_date_id\n\t        or lkp_claim_reopen_date_id <> claim_reopen_date_id\n\t        or lkp_claim_closed_after_reopen_date_id <> claim_closed_after_reopen_date_id\n\t        or lkp_claim_notice_only_date_id <> claim_notice_only_date_id\n\t        or lkp_claim_cat_start_date_id <> claim_cat_start_date_id\n\t        or lkp_claim_cat_end_date_id <> claim_cat_end_date_id\n\t        or lkp_claim_rep_assigned_date_id <> claim_rep_assigned_date_id\n\t        or lkp_claim_rep_unassigned_date_id <> claim_rep_unassigned_date_id\n\t        or lkp_pol_eff_date_id <> pol_eff_date_id\n\t        or lkp_pol_exp_date_id <> pol_exp_date_id\n\t        or lkp_pay_issued_date_id <> pay_issued_date_id\n\t        or lkp_pay_cashed_date_id <> pay_cashed_date_id\n\t        or lkp_pay_voided_date_id <> pay_voided_date_id\n\t        or lkp_pay_reposted_date_id <> pay_reposted_date_id\n\t        or lkp_claim_case_dim_id <> claim_case_dim_id_out\n\t        or LTRIM(RTRIM(lkp_invc_num)) <> LTRIM(RTRIM(invc_num))\n\t        or ROUND(ABS(lkp_cost_containment_saving_amt - cost_containment_saving_amt)) > 0.01\n\t        or ROUND(ABS(lkp_cost_containment_red_amt - cost_containment_red_amt)) > 0.01\n\t        or ROUND(ABS(lkp_cost_containment_ppo_amt - cost_containment_ppo_amt)) > 0.01\n\t        or ROUND(ABS(lkp_attorney_fee_amt - attorney_fee_amt)) > 0.01\n\t        or ROUND(ABS(lkp_attorney_cost_amt - attorney_cost_amt)) > 0.01\n\t        or LTRIM(RTRIM(lkp_attorney_file_num)) <> LTRIM(RTRIM(attorney_file_num))\n\t        or ROUND(ABS(lkp_hourly_rate - hourly_rate)) > 0.01\n\t        or ROUND(ABS(lkp_hours_worked - hours_worked)) > 0.01\n\t        or lkp_num_of_days <> num_of_days\n\t        or lkp_num_of_weeks <> num_of_weeks\n\t        or ROUND(ABS(lkp_tpd_rate - tpd_rate)) > 0.01\n\t        or ROUND(ABS(lkp_tpd_rate_fac - tpd_rate_fac)) > 0.01\n\t        or ROUND(ABS(lkp_tpd_wage_loss - tpd_wage_loss)) > 0.01\n\t        or ROUND(ABS(lkp_tpd_wkly_wage - tpd_wkly_wage)) > 0.01\n\t        or lkp_contract_cust_dim_id <> contract_cust_dim_id\n\t        or lkp_strtgc_bus_dvsn_dim_id <> strtgc_bus_dvsn_dim_id,\n\t        'UPDATE',\n\t        'NOCHANGE'\n\t    )\n\t) AS v_changed_flag,\n\tv_changed_flag AS changed_flag,\n\tSYSDATE AS modified_date,\n\tEXP_Date_Ids.strtgc_bus_dvsn_dim_id_out AS strtgc_bus_dvsn_dim_id,\n\tEXP_Date_Ids.FeatureRepresentativeDimId,\n\tEXP_Date_Ids.FeatureRepresentativeAssignedDate_id\n\tFROM EXP_Date_Ids\n\tLEFT JOIN LKP_Claim_Payment_Category_Fact\n\tON LKP_Claim_Payment_Category_Fact.edw_claim_pay_ctgry_pk_id = EXP_Date_Ids.claim_pay_ctgry_id\n),\nRTR_claim_payment_category_fact AS (\n\tSELECT\n\tlkp_claim_pay_ctgry_fact_id AS claim_pay_ctgry_fact_id,\n\tclaim_pay_ctgry_id,\n\tclaim_pay_ctgry_ak_id,\n\tclaim_pay_ak_id,\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_seq_num,\n\tclaim_pay_ctgry_amt,\n\tclaim_pay_ctgry_earned_amt,\n\tclaim_pay_ctgry_billed_amt,\n\tclaim_pay_ctgry_start_date_id_out AS claim_pay_ctgry_start_date_id,\n\tclaim_pay_ctgry_end_date_id_out AS claim_pay_ctgry_end_date_id,\n\tclaim_financial_type_dim_id_out AS claim_financial_type_dim_id,\n\tinvc_num,\n\tcost_containment_saving_amt,\n\tcost_containment_red_amt,\n\tcost_containment_ppo_amt,\n\tattorney_fee_amt,\n\tattorney_cost_amt,\n\tattorney_file_num,\n\thourly_rate,\n\thours_worked,\n\tnum_of_days,\n\tnum_of_weeks,\n\ttpd_rate,\n\ttpd_rate_fac,\n\ttpd_wage_loss,\n\ttpd_wkly_wage,\n\taudit_id,\n\tclaim_occurrence_dim_id_out AS claim_occurrence_dim_id,\n\tclaimant_dim_id_out AS claimant_dim_id,\n\tclaimant_cov_dim_id_out AS claimant_cov_dim_id,\n\tpol_key_dim_id_out AS pol_key_dim_id,\n\tagency_dim_id_out AS agency_dim_id,\n\tclaim_pay_dim_id_out AS claim_pay_dim_id,\n\tclaim_rep_dim_prim_claim_rep_id_out AS claim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_dim_examiner_id_out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tclaim_created_by_dim_id_out,\n\tclaim_pay_ctgry_type_dim_id_out AS claim_pay_ctgry_type_dim_id,\n\tcov_dim_id_out AS cov_dim_id,\n\tclaim_case_dim_id_out,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_scripted_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tpay_issued_date_id,\n\tpay_cashed_date_id,\n\tpay_voided_date_id,\n\tpay_reposted_date_id,\n\tdefault_dim_id,\n\tchanged_flag,\n\tmodified_date,\n\tcontract_cust_dim_id,\n\tstrtgc_bus_dvsn_dim_id,\n\tFeatureRepresentativeDimId,\n\tFeatureRepresentativeAssignedDate_id\n\tFROM EXP_Detect_Changes\n),\nRTR_claim_payment_category_fact_INSERT AS (SELECT * FROM RTR_claim_payment_category_fact WHERE changed_flag = 'NEW'\r\n\r\n\r\n--ISNULL(claim_pay_ctgry_fact_id)),\nRTR_claim_payment_category_fact_UPDATE AS (SELECT * FROM RTR_claim_payment_category_fact WHERE changed_flag = 'UPDATE'\r\n\r\n--NOT ISNULL(claim_pay_ctgry_fact_id)),\nUPD_claim_payment_category_fact_update AS (\n\tSELECT\n\tclaim_pay_ctgry_fact_id AS claim_pay_ctgry_fact_id3, \n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id3, \n\tclaim_pay_ctgry_ak_id AS claim_pay_ctgry_ak_id3, \n\tclaim_pay_ak_id AS claim_pay_ak_id3, \n\tclaim_pay_ctgry_type AS claim_pay_ctgry_type3, \n\tclaim_pay_ctgry_seq_num AS claim_pay_ctgry_seq_num3, \n\tclaim_pay_ctgry_amt AS claim_pay_ctgry_amt3, \n\tclaim_pay_ctgry_earned_amt AS claim_pay_ctgry_earned_amt3, \n\tclaim_pay_ctgry_billed_amt AS claim_pay_ctgry_billed_amt3, \n\tclaim_pay_ctgry_start_date_id AS claim_pay_ctgry_start_date_id3, \n\tclaim_pay_ctgry_end_date_id AS claim_pay_ctgry_end_date_id3, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id3, \n\tinvc_num AS invc_num3, \n\tcost_containment_saving_amt AS cost_containment_saving_amt3, \n\tcost_containment_red_amt AS cost_containment_red_amt3, \n\tcost_containment_ppo_amt AS cost_containment_ppo_amt3, \n\tattorney_fee_amt AS attorney_fee_amt3, \n\tattorney_cost_amt AS attorney_cost_amt3, \n\tattorney_file_num AS attorney_file_num3, \n\thourly_rate AS hourly_rate3, \n\thours_worked AS hours_worked3, \n\tnum_of_days AS num_of_days3, \n\tnum_of_weeks AS num_of_weeks3, \n\ttpd_rate AS tpd_rate3, \n\ttpd_rate_fac AS tpd_rate_fac3, \n\ttpd_wage_loss AS tpd_wage_loss3, \n\ttpd_wkly_wage AS tpd_wkly_wage3, \n\taudit_id AS audit_id3, \n\tclaim_pay_dim_id AS claim_pay_dim_id3, \n\tclaim_rep_dim_prim_claim_rep_id AS claim_rep_dim_prim_claim_rep_id3, \n\tclaim_rep_dim_examiner_id_out AS claim_rep_dim_examiner_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out1, \n\tclaim_pay_ctgry_type_dim_id AS claim_pay_ctgry_type_dim_id3, \n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id3, \n\tclaimant_dim_id AS claimant_dim_id3, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id3, \n\tpol_key_dim_id AS pol_key_dim_id3, \n\tagency_dim_id AS agency_dim_id3, \n\tcov_dim_id AS cov_dim_id3, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out3, \n\tclaim_loss_date_id, \n\tclaim_discovery_date_id, \n\tclaim_scripted_date_id, \n\tsource_claim_scripted_date_id, \n\tclaim_rpted_date_id, \n\tclaim_open_date_id, \n\tclaim_close_date_id, \n\tclaim_reopen_date_id, \n\tclaim_closed_after_reopen_date_id, \n\tclaim_notice_only_date_id, \n\tclaim_cat_start_date_id, \n\tclaim_cat_end_date_id, \n\tclaim_rep_assigned_date_id, \n\tclaim_rep_unassigned_date_id, \n\tpol_eff_date_id, \n\tpol_exp_date_id, \n\tpay_issued_date_id, \n\tpay_cashed_date_id, \n\tpay_voided_date_id, \n\tpay_reposted_date_id, \n\tmodified_date AS modified_date3, \n\tclaim_created_by_dim_id_out AS claim_created_by_dim_id_out3, \n\tcontract_cust_dim_id AS contract_cust_dim_id3, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id3, \n\tFeatureRepresentativeDimId AS FeatureRepresentativeDimId3, \n\tFeatureRepresentativeAssignedDate_id AS FeatureRepresentativeAssignedDate_id3\n\tFROM RTR_claim_payment_category_fact_UPDATE\n),\nclaim_payment_category_fact_update AS (\n\tMERGE INTO claim_payment_category_fact AS T\n\tUSING UPD_claim_payment_category_fact_update AS S\n\tON T.claim_pay_ctgry_fact_id = S.claim_pay_ctgry_fact_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.claim_occurrence_dim_id = S.claim_occurrence_dim_id3, T.claimant_dim_id = S.claimant_dim_id3, T.claimant_cov_dim_id = S.claimant_cov_dim_id3, T.cov_dim_id = S.cov_dim_id3, T.claim_rep_dim_prim_claim_rep_id = S.claim_rep_dim_prim_claim_rep_id3, T.claim_rep_dim_examiner_id = S.claim_rep_dim_examiner_id_out1, T.claim_rep_dim_prim_litigation_handler_id = S.claim_rep_dim_prim_litigation_handler_id_out1, T.claim_rep_dim_claim_created_by_id = S.claim_created_by_dim_id_out3, T.pol_dim_id = S.pol_key_dim_id3, T.agency_dim_id = S.agency_dim_id3, T.claim_pay_dim_id = S.claim_pay_dim_id3, T.claim_financial_type_dim_id = S.claim_financial_type_dim_id3, T.claim_pay_ctgry_type_dim_id = S.claim_pay_ctgry_type_dim_id3, T.claim_pay_ctgry_amt = S.claim_pay_ctgry_amt3, T.claim_pay_ctgry_earned_amt = S.claim_pay_ctgry_earned_amt3, T.claim_pay_ctgry_billed_amt = S.claim_pay_ctgry_billed_amt3, T.claim_pay_ctgry_start_date_id = S.claim_pay_ctgry_start_date_id3, T.claim_pay_ctgry_end_date_id = S.claim_pay_ctgry_end_date_id3, T.claim_loss_date_id = S.claim_loss_date_id, T.claim_discovery_date_id = S.claim_discovery_date_id, T.claim_scripted_date_id = S.claim_scripted_date_id, T.source_claim_rpted_date_id = S.source_claim_scripted_date_id, T.claim_rpted_date_id = S.claim_rpted_date_id, T.claim_open_date_id = S.claim_open_date_id, T.claim_close_date_id = S.claim_close_date_id, T.claim_reopen_date_id = S.claim_reopen_date_id, T.claim_closed_after_reopen_date_id = S.claim_closed_after_reopen_date_id, T.claim_notice_only_date_id = S.claim_notice_only_date_id, T.claim_cat_start_date_id = S.claim_cat_start_date_id, T.claim_cat_end_date_id = S.claim_cat_end_date_id, T.claim_rep_assigned_date_id = S.claim_rep_assigned_date_id, T.claim_rep_unassigned_date_id = S.claim_rep_unassigned_date_id, T.pol_eff_date_id = S.pol_eff_date_id, T.pol_exp_date_id = S.pol_exp_date_id, T.pay_issued_date_id = S.pay_issued_date_id, T.pay_cashed_date_id = S.pay_cashed_date_id, T.pay_voided_date_id = S.pay_voided_date_id, T.pay_reposted_date_id = S.pay_reposted_date_id, T.invc_num = S.invc_num3, T.cost_containment_saving_amt = S.cost_containment_saving_amt3, T.cost_containment_red_amt = S.cost_containment_red_amt3, T.cost_containment_ppo_amt = S.cost_containment_ppo_amt3, T.attorney_fee_amt = S.attorney_fee_amt3, T.attorney_cost_amt = S.attorney_cost_amt3, T.attorney_file_num = S.attorney_file_num3, T.hourly_rate = S.hourly_rate3, T.hours_worked = S.hours_worked3, T.num_of_days = S.num_of_days3, T.num_of_weeks = S.num_of_weeks3, T.tpd_rate = S.tpd_rate3, T.tpd_rate_fac = S.tpd_rate_fac3, T.tpd_wage_loss = S.tpd_wage_loss3, T.tpd_wkly_wage = S.tpd_wkly_wage3, T.claim_case_dim_id = S.claim_case_dim_id_out3, T.contract_cust_dim_id = S.contract_cust_dim_id3, T.strtgc_bus_dvsn_dim_id = S.strtgc_bus_dvsn_dim_id3, T.ClaimRepresentativeDimFeatureClaimRepresentativeId = S.FeatureRepresentativeDimId3, T.FeatureRepresentativeAssignedDateId = S.FeatureRepresentativeAssignedDate_id3\n),\nUPD_claim_payment_category_insert AS (\n\tSELECT\n\tclaim_pay_ctgry_fact_id AS claim_pay_ctgry_fact_id1, \n\tclaim_pay_ctgry_id AS claim_pay_ctgry_id1, \n\tclaim_pay_ctgry_ak_id AS claim_pay_ctgry_ak_id1, \n\tclaim_pay_ak_id AS claim_pay_ak_id1, \n\tclaim_pay_ctgry_type AS claim_pay_ctgry_type1, \n\tclaim_pay_ctgry_seq_num AS claim_pay_ctgry_seq_num1, \n\tclaim_pay_ctgry_amt AS claim_pay_ctgry_amt1, \n\tclaim_pay_ctgry_earned_amt AS claim_pay_ctgry_earned_amt1, \n\tclaim_pay_ctgry_billed_amt AS claim_pay_ctgry_billed_amt1, \n\tclaim_pay_ctgry_start_date_id AS claim_pay_ctgry_start_date_id1, \n\tclaim_pay_ctgry_end_date_id AS claim_pay_ctgry_end_date_id1, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id1, \n\tinvc_num AS invc_num1, \n\tcost_containment_saving_amt AS cost_containment_saving_amt1, \n\tcost_containment_red_amt AS cost_containment_red_amt1, \n\tcost_containment_ppo_amt AS cost_containment_ppo_amt1, \n\tattorney_fee_amt AS attorney_fee_amt1, \n\tattorney_cost_amt AS attorney_cost_amt1, \n\tattorney_file_num AS attorney_file_num1, \n\thourly_rate AS hourly_rate1, \n\thours_worked AS hours_worked1, \n\tnum_of_days AS num_of_days1, \n\tnum_of_weeks AS num_of_weeks1, \n\ttpd_rate AS tpd_rate1, \n\ttpd_rate_fac AS tpd_rate_fac1, \n\ttpd_wage_loss AS tpd_wage_loss1, \n\ttpd_wkly_wage AS tpd_wkly_wage1, \n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id1, \n\tclaimant_dim_id AS claimant_dim_id1, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id1, \n\tpol_key_dim_id AS pol_key_dim_id1, \n\tagency_dim_id AS agency_dim_id1, \n\tclaim_pay_dim_id AS claim_pay_dim_id1, \n\tclaim_rep_dim_prim_claim_rep_id, \n\tclaim_rep_dim_examiner_id_out AS claim_rep_dim_examiner_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out1, \n\tclaim_pay_ctgry_type_dim_id AS claim_pay_ctgry_type_dim_id1, \n\taudit_id AS audit_id1, \n\tcov_dim_id AS cov_dim_id1, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out1, \n\tclaim_loss_date_id, \n\tclaim_discovery_date_id, \n\tclaim_scripted_date_id, \n\tsource_claim_scripted_date_id, \n\tclaim_rpted_date_id, \n\tclaim_open_date_id, \n\tclaim_close_date_id, \n\tclaim_reopen_date_id, \n\tclaim_closed_after_reopen_date_id, \n\tclaim_notice_only_date_id, \n\tclaim_cat_start_date_id, \n\tclaim_cat_end_date_id, \n\tclaim_rep_assigned_date_id, \n\tclaim_rep_unassigned_date_id, \n\tpol_eff_date_id, \n\tpol_exp_date_id, \n\tpay_issued_date_id, \n\tpay_cashed_date_id, \n\tpay_voided_date_id, \n\tpay_reposted_date_id, \n\tdefault_dim_id AS default_dim_id1, \n\tclaim_created_by_dim_id_out AS claim_created_by_dim_id_out1, \n\tcontract_cust_dim_id AS contract_cust_dim_id1, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id1, \n\tFeatureRepresentativeDimId AS FeatureRepresentativeDimId1, \n\tFeatureRepresentativeAssignedDate_id AS FeatureRepresentativeAssignedDate_id1\n\tFROM RTR_claim_payment_category_fact_INSERT\n),\nclaim_payment_category_fact_insert AS (\n\tINSERT INTO claim_payment_category_fact\n\t(edw_claim_pay_ctgry_pk_id, edw_claim_pay_ctgry_ak_id, claim_occurrence_dim_id, claimant_dim_id, claimant_cov_dim_id, cov_dim_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_examiner_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_claim_created_by_id, pol_dim_id, agency_dim_id, claim_pay_dim_id, claim_financial_type_dim_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_amt, claim_pay_ctgry_earned_amt, claim_pay_ctgry_billed_amt, claim_pay_ctgry_start_date_id, claim_pay_ctgry_end_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, pay_issued_date_id, pay_cashed_date_id, pay_voided_date_id, pay_reposted_date_id, invc_num, cost_containment_saving_amt, cost_containment_red_amt, cost_containment_ppo_amt, attorney_fee_amt, attorney_cost_amt, attorney_file_num, hourly_rate, hours_worked, num_of_days, num_of_weeks, tpd_rate, tpd_rate_fac, tpd_wage_loss, tpd_wkly_wage, audit_id, claim_case_dim_id, contract_cust_dim_id, strtgc_bus_dvsn_dim_id, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId)\n\tSELECT \n\tclaim_pay_ctgry_id1 AS EDW_CLAIM_PAY_CTGRY_PK_ID, \n\tclaim_pay_ctgry_ak_id1 AS EDW_CLAIM_PAY_CTGRY_AK_ID, \n\tclaim_occurrence_dim_id1 AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaimant_dim_id1 AS CLAIMANT_DIM_ID, \n\tclaimant_cov_dim_id1 AS CLAIMANT_COV_DIM_ID, \n\tcov_dim_id1 AS COV_DIM_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tclaim_rep_dim_examiner_id_out1 AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_out1 AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tdefault_dim_id1 AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tclaim_created_by_dim_id_out1 AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id1 AS POL_DIM_ID, \n\tagency_dim_id1 AS AGENCY_DIM_ID, \n\tclaim_pay_dim_id1 AS CLAIM_PAY_DIM_ID, \n\tclaim_financial_type_dim_id1 AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\tclaim_pay_ctgry_type_dim_id1 AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tclaim_pay_ctgry_amt1 AS CLAIM_PAY_CTGRY_AMT, \n\tclaim_pay_ctgry_earned_amt1 AS CLAIM_PAY_CTGRY_EARNED_AMT, \n\tclaim_pay_ctgry_billed_amt1 AS CLAIM_PAY_CTGRY_BILLED_AMT, \n\tclaim_pay_ctgry_start_date_id1 AS CLAIM_PAY_CTGRY_START_DATE_ID, \n\tclaim_pay_ctgry_end_date_id1 AS CLAIM_PAY_CTGRY_END_DATE_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tsource_claim_scripted_date_id AS SOURCE_CLAIM_RPTED_DATE_ID, \n\tCLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\tPAY_ISSUED_DATE_ID, \n\tPAY_CASHED_DATE_ID, \n\tPAY_VOIDED_DATE_ID, \n\tPAY_REPOSTED_DATE_ID, \n\tinvc_num1 AS INVC_NUM, \n\tcost_containment_saving_amt1 AS COST_CONTAINMENT_SAVING_AMT, \n\tcost_containment_red_amt1 AS COST_CONTAINMENT_RED_AMT, \n\tcost_containment_ppo_amt1 AS COST_CONTAINMENT_PPO_AMT, \n\tattorney_fee_amt1 AS ATTORNEY_FEE_AMT, \n\tattorney_cost_amt1 AS ATTORNEY_COST_AMT, \n\tattorney_file_num1 AS ATTORNEY_FILE_NUM, \n\thourly_rate1 AS HOURLY_RATE, \n\thours_worked1 AS HOURS_WORKED, \n\tnum_of_days1 AS NUM_OF_DAYS, \n\tnum_of_weeks1 AS NUM_OF_WEEKS, \n\ttpd_rate1 AS TPD_RATE, \n\ttpd_rate_fac1 AS TPD_RATE_FAC, \n\ttpd_wage_loss1 AS TPD_WAGE_LOSS, \n\ttpd_wkly_wage1 AS TPD_WKLY_WAGE, \n\taudit_id1 AS AUDIT_ID, \n\tclaim_case_dim_id_out1 AS CLAIM_CASE_DIM_ID, \n\tcontract_cust_dim_id1 AS CONTRACT_CUST_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id1 AS STRTGC_BUS_DVSN_DIM_ID, \n\tFeatureRepresentativeDimId1 AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tFeatureRepresentativeAssignedDate_id1 AS FEATUREREPRESENTATIVEASSIGNEDDATEID\n\tFROM UPD_claim_payment_category_insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "DB_NAME_DATAMART": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Claims DataMart/"
        },
        "annotations": []
    }
}