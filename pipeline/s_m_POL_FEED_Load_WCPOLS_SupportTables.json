{
    "name": "s_m_POL_FEED_Load_WCPOLS_SupportTables",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_Load_WCPOLS_SupportTables",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_SUPWCPOLS AS (\n\n-- TODO Manual --\n\n),\nEXP_SUPWCPOLS AS (\n\tSELECT\n\tCode,\n\tDescription,\n\tSourceCode,\n\tTableName,\n\tProcessName,\n\tNotes,\n\tNCCIRequiredFlag,\n\tWIRequiredFlag,\n\tMNRequiredFlag,\n\tMIRequiredFlag,\n\tNCRequiredFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Auditid,\n\t'1' AS CurrentSnapshotFlag,\n\tCURRENT_TIMESTAMP AS CreatedDate,\n\tCURRENT_TIMESTAMP AS ModifiedDate,\n\t'DCT' AS SourcesystemID,\n\t-- *INF*: Ltrim(Rtrim(Code))\n\tLtrim(Rtrim(Code)) AS o_WCPOLSCode,\n\t-- *INF*: Ltrim(Rtrim(Description))\n\tLtrim(Rtrim(Description)) AS o_WCPOLSDescription,\n\t-- *INF*: Ltrim(Rtrim(SourceCode))\n\tLtrim(Rtrim(SourceCode)) AS o_SourceCode,\n\t-- *INF*: Ltrim(Rtrim(TableName))\n\tLtrim(Rtrim(TableName)) AS o_TableName,\n\t-- *INF*: Ltrim(Rtrim(ProcessName))\n\tLtrim(Rtrim(ProcessName)) AS o_ProcessName,\n\t-- *INF*: IIF(IN(NCCIRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCCIRequiredFlag IN ('Y','1'), '1', '0') AS o_NCCIRequiredFlag,\n\t-- *INF*: IIF(IN(WIRequiredFlag,'Y','1'),'1','0')\n\tIFF(WIRequiredFlag IN ('Y','1'), '1', '0') AS o_WIRequiredFlag,\n\t-- *INF*: IIF(IN(MIRequiredFlag,'Y','1'),'1','0')\n\tIFF(MIRequiredFlag IN ('Y','1'), '1', '0') AS o_MIRequiredFlag,\n\t-- *INF*: IIF(IN(MNRequiredFlag,'Y','1'),'1','0')\n\tIFF(MNRequiredFlag IN ('Y','1'), '1', '0') AS o_MNRequiredFlag,\n\t-- *INF*: IIF(IN(NCRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCRequiredFlag IN ('Y','1'), '1', '0') AS o_NCRequiredFlag\n\tFROM SQ_SUPWCPOLS\n),\nSupWCPOLS AS (\n\tTRUNCATE TABLE SupWCPOLS;\n\tINSERT INTO SupWCPOLS\n\t(Auditid, CurrentSnapshotFlag, CreatedDate, ModifiedDate, SourcesystemID, WCPOLSCode, WCPOLSDescription, SourceCode, TableName, ProcessName, NCCIRequiredFlag, WIRequiredFlag, MIRequiredFlag, MNRequiredFlag, NCRequiredFlag)\n\tSELECT \n\tAUDITID, \n\tCURRENTSNAPSHOTFLAG, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tSOURCESYSTEMID, \n\to_WCPOLSCode AS WCPOLSCODE, \n\to_WCPOLSDescription AS WCPOLSDESCRIPTION, \n\to_SourceCode AS SOURCECODE, \n\to_TableName AS TABLENAME, \n\to_ProcessName AS PROCESSNAME, \n\to_NCCIRequiredFlag AS NCCIREQUIREDFLAG, \n\to_WIRequiredFlag AS WIREQUIREDFLAG, \n\to_MIRequiredFlag AS MIREQUIREDFLAG, \n\to_MNRequiredFlag AS MNREQUIREDFLAG, \n\to_NCRequiredFlag AS NCREQUIREDFLAG\n\tFROM EXP_SUPWCPOLS\n),\nSQ_SupWCPOLSTransactionTypeNeeded AS (\n\n-- TODO Manual --\n\n),\nEXP_SupWCPOLSTransactionTypeNeeded AS (\n\tSELECT\n\tSourceTransactionType,\n\tWCPOLSTransactionType,\n\tNotes,\n\tNCCIRequiredFlag,\n\tWIRequiredFlag,\n\tMNRequiredFlag,\n\tMIRequiredFlag,\n\tTableName,\n\tNCRequiredFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Auditid,\n\t'1' AS CurrentSnapshotFlag,\n\tCURRENT_TIMESTAMP AS CreatedDate,\n\tCURRENT_TIMESTAMP AS ModifiedDate,\n\t'DCT' AS SourcesystemID,\n\t-- *INF*: Ltrim(Rtrim(SourceTransactionType))\n\tLtrim(Rtrim(SourceTransactionType)) AS o_SourceTransactionType,\n\t-- *INF*: Ltrim(Rtrim(WCPOLSTransactionType))\n\tLtrim(Rtrim(WCPOLSTransactionType)) AS o_WCPOLSTransactionType,\n\t-- *INF*: Ltrim(Rtrim(Notes))\n\tLtrim(Rtrim(Notes)) AS o_Notes,\n\t-- *INF*: Ltrim(Rtrim(TableName))\n\tLtrim(Rtrim(TableName)) AS o_TableName,\n\t-- *INF*: IIF(IN(NCCIRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCCIRequiredFlag IN ('Y','1'), '1', '0') AS o_NCCIRequiredFlag,\n\t-- *INF*: IIF(IN(WIRequiredFlag,'Y','1'),'1','0')\n\tIFF(WIRequiredFlag IN ('Y','1'), '1', '0') AS o_WIRequiredFlag,\n\t-- *INF*: IIF(IN(MIRequiredFlag,'Y','1'),'1','0')\n\tIFF(MIRequiredFlag IN ('Y','1'), '1', '0') AS o_MIRequiredFlag,\n\t-- *INF*: IIF(IN(MNRequiredFlag,'Y','1'),'1','0')\n\tIFF(MNRequiredFlag IN ('Y','1'), '1', '0') AS o_MNRequiredFlag,\n\t-- *INF*: IIF(IN(NCRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCRequiredFlag IN ('Y','1'), '1', '0') AS o_NCRequiredFlag\n\tFROM SQ_SupWCPOLSTransactionTypeNeeded\n),\nSupWCPOLSTransactionTypeNeeded AS (\n\tINSERT INTO SupWCPOLSTransactionTypeNeeded\n\t(Auditid, CurrentSnapshotFlag, CreatedDate, ModifiedDate, SourcesystemID, SourceTransactionType, WCPOLSTransactionType, Notes, TableName, NCCIRequiredFlag, WIRequiredFlag, MIRequiredFlag, MNRequiredFlag, NCRequiredFlag)\n\tSELECT \n\tAUDITID, \n\tCURRENTSNAPSHOTFLAG, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tSOURCESYSTEMID, \n\to_SourceTransactionType AS SOURCETRANSACTIONTYPE, \n\to_WCPOLSTransactionType AS WCPOLSTRANSACTIONTYPE, \n\to_Notes AS NOTES, \n\to_TableName AS TABLENAME, \n\to_NCCIRequiredFlag AS NCCIREQUIREDFLAG, \n\to_WIRequiredFlag AS WIREQUIREDFLAG, \n\to_MIRequiredFlag AS MIREQUIREDFLAG, \n\to_MNRequiredFlag AS MNREQUIREDFLAG, \n\to_NCRequiredFlag AS NCREQUIREDFLAG\n\tFROM EXP_SupWCPOLSTransactionTypeNeeded\n),\nSQ_SUPWCPOLSFieldNeeded AS (\n\n-- TODO Manual --\n\n),\nEXP_SUPWCPOLSFieldNeeded AS (\n\tSELECT\n\tTable_name,\n\tField_Name,\n\tNCCIRequiredFlag,\n\tWIRequiredFlag,\n\tMNRequiredFlag,\n\tMIRequiredFlag,\n\tFileDataType_A_AN_N AS FileDataType,\n\tNCRequiredFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Auditid,\n\t'1' AS CurrentSnapshotFlag,\n\tCURRENT_TIMESTAMP AS CreatedDate,\n\tCURRENT_TIMESTAMP AS ModifiedDate,\n\t'DCT' AS SourcesystemID,\n\t-- *INF*: Ltrim(Rtrim(Table_name))\n\tLtrim(Rtrim(Table_name)) AS o_TableName,\n\t-- *INF*: Ltrim(Rtrim(Field_Name))\n\tLtrim(Rtrim(Field_Name)) AS o_FieldName,\n\t-- *INF*: IIF(IN(NCCIRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCCIRequiredFlag IN ('Y','1'), '1', '0') AS o_NCCIRequiredFlag,\n\t-- *INF*: IIF(IN(WIRequiredFlag,'Y','1'),'1','0')\n\tIFF(WIRequiredFlag IN ('Y','1'), '1', '0') AS o_WIRequiredFlag,\n\t-- *INF*: IIF(IN(MIRequiredFlag,'Y','1'),'1','0')\n\tIFF(MIRequiredFlag IN ('Y','1'), '1', '0') AS o_MIRequiredFlag,\n\t-- *INF*: IIF(IN(MNRequiredFlag,'Y','1'),'1','0')\n\tIFF(MNRequiredFlag IN ('Y','1'), '1', '0') AS o_MNRequiredFlag,\n\t-- *INF*: Ltrim(Rtrim(FileDataType))\n\tLtrim(Rtrim(FileDataType)) AS o_FieldDataType,\n\t-- *INF*: IIF(IN(NCRequiredFlag,'Y','1'),'1','0')\n\tIFF(NCRequiredFlag IN ('Y','1'), '1', '0') AS o_NCRequiredFlag\n\tFROM SQ_SUPWCPOLSFieldNeeded\n),\nSupWCPOLSFieldNeeded AS (\n\tTRUNCATE TABLE SupWCPOLSFieldNeeded;\n\tINSERT INTO SupWCPOLSFieldNeeded\n\t(Auditid, CurrentSnapshotFlag, CreatedDate, ModifiedDate, TableName, FieldName, NCCIRequiredFlag, WIRequiredFlag, MIRequiredFlag, MNRequiredFlag, FieldDataType, NCRequiredFlag)\n\tSELECT \n\tAUDITID, \n\tCURRENTSNAPSHOTFLAG, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\to_TableName AS TABLENAME, \n\to_FieldName AS FIELDNAME, \n\to_NCCIRequiredFlag AS NCCIREQUIREDFLAG, \n\to_WIRequiredFlag AS WIREQUIREDFLAG, \n\to_MIRequiredFlag AS MIREQUIREDFLAG, \n\to_MNRequiredFlag AS MNREQUIREDFLAG, \n\to_FieldDataType AS FIELDDATATYPE, \n\to_NCRequiredFlag AS NCREQUIREDFLAG\n\tFROM EXP_SUPWCPOLSFieldNeeded\n),\nSQ_SUPWCPOLSSmallDeductible AS (\n\n-- TODO Manual --\n\n),\nEXP_SUPWCPOLSSmallDeductible AS (\n\tSELECT\n\tStateCode,\n\tFormName,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID,\n\t'1' AS CurrentSnapshotFlag,\n\tCURRENT_TIMESTAMP AS CreatedDate,\n\tCURRENT_TIMESTAMP AS ModifiedDate,\n\t'DCT' AS SourcesystemID,\n\t-- *INF*: LTRIM(RTRIM(StateCode))\n\tLTRIM(RTRIM(StateCode)) AS o_StateCode,\n\t-- *INF*: LTRIM(RTRIM(FormName))\n\tLTRIM(RTRIM(FormName)) AS o_FormName\n\tFROM SQ_SUPWCPOLSSmallDeductible\n),\nSUPWCPOLSSmallDeductible AS (\n\tTRUNCATE TABLE SUPWCPOLSSmallDeductible;\n\tINSERT INTO SUPWCPOLSSmallDeductible\n\t(Auditid, CurrentSnapshotFlag, CreatedDate, ModifiedDate, SourcesystemID, StateCode, FormName)\n\tSELECT \n\tAuditID AS AUDITID, \n\tCURRENTSNAPSHOTFLAG, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tSOURCESYSTEMID, \n\to_StateCode AS STATECODE, \n\to_FormName AS FORMNAME\n\tFROM EXP_SUPWCPOLSSmallDeductible\n),\nSQ_SupClaimAdministratorFEIN AS (\n\n-- TODO Manual --\n\n),\nEXP_SupClaimAdministratorFEIN AS (\n\tSELECT\n\tStateCode,\n\tAdjustingCompany,\n\tClaimAdministratorFEIN,\n\tAffiliateTPA,\n\t'1' AS CurrentSnapshotFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS Auditid,\n\tCURRENT_TIMESTAMP AS CreatedDate,\n\tCURRENT_TIMESTAMP AS ModifiedDate,\n\t-- *INF*: LTRIM(RTRIM(StateCode))\n\tLTRIM(RTRIM(StateCode)) AS o_StateCode,\n\t-- *INF*: LTRIM(RTRIM(AdjustingCompany))\n\tLTRIM(RTRIM(AdjustingCompany)) AS o_AdjustingCompany,\n\t-- *INF*: LTRIM(RTRIM(ClaimAdministratorFEIN))\n\tLTRIM(RTRIM(ClaimAdministratorFEIN)) AS o_ClaimAdministratorFEIN,\n\t-- *INF*: LTRIM(RTRIM(AffiliateTPA))\n\tLTRIM(RTRIM(AffiliateTPA)) AS o_AffiliateTPA\n\tFROM SQ_SupClaimAdministratorFEIN\n),\nSupClaimAdministratorFEIN AS (\n\tTRUNCATE TABLE SupClaimAdministratorFEIN;\n\tINSERT INTO SupClaimAdministratorFEIN\n\t(CurrentSnapshotFlag, AuditId, CreatedDate, ModifiedDate, StateCode, AdjustingCompany, ClaimAdministratorFEIN, AffiliateTPA)\n\tSELECT \n\tCURRENTSNAPSHOTFLAG, \n\tAuditid AS AUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\to_StateCode AS STATECODE, \n\to_AdjustingCompany AS ADJUSTINGCOMPANY, \n\to_ClaimAdministratorFEIN AS CLAIMADMINISTRATORFEIN, \n\to_AffiliateTPA AS AFFILIATETPA\n\tFROM EXP_SupClaimAdministratorFEIN\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}