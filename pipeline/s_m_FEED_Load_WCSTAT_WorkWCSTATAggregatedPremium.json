{
    "name": "s_m_FEED_Load_WCSTAT_WorkWCSTATAggregatedPremium",
    "properties": {
        "activities": [
            {
                "name": "m_FEED_Load_WCSTAT_WorkWCSTATAggregatedPremium",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_MultiStatePolicy AS (\n\tSELECT\n\tPolicyAKId\n\tFROM (\n\t\tselect PolicyAKId as PolicyAKId\r\n\t\tfrom (\r\n\t\tSELECT distinct RL.PolicyAKId, RL.StateProvinceCode \r\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RL.RiskLocationAKID = PC.RiskLocationAKID and RL.CurrentSnapshotFlag = 1\r\n\t\tand PC.CurrentSnapshotFlag  = 1\r\n\t\t)src\r\n\t\tgroup by PolicyAKId having count(*)>1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyAKId ORDER BY PolicyAKId) = 1\n),\nLKP_SupClassificationWorkersCompensation AS (\n\tSELECT\n\tSubjecttoExperienceModificationClassIndicator,\n\tClassCode,\n\tRatingStateCode,\n\tEffectiveDate,\n\tExpirationDate\n\tFROM (\n\t\tSELECT concat(s.SubjecttoExperienceModificationClassIndicator ,s.ExperienceModificationClassIndicator) as SubjecttoExperienceModificationClassIndicator, \r\n\t\t s.ClassCode as ClassCode,s.RatingStateCode as RatingStateCode, \r\n\t\t s.EffectiveDate as EffectiveDate,s.ExpirationDate as ExpirationDate \r\n\t\t  FROM [RPT_EDM].[dbo].SupClassificationWorkersCompensation as s\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ClassCode,RatingStateCode,EffectiveDate,ExpirationDate ORDER BY SubjecttoExperienceModificationClassIndicator) = 1\n),\nLKP_AuditSchedule AS (\n\tSELECT\n\tAuditStatus,\n\tPolicyKey,\n\tInsuranceLine,\n\tAuditEffectiveDate,\n\tAuditExpirationDate\n\tFROM (\n\t\tSELECT \n\t\t\tAuditStatus,\n\t\t\tPolicyKey,\n\t\t\tInsuranceLine,\n\t\t\tAuditEffectiveDate,\n\t\t\tAuditExpirationDate\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.AuditSchedule\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,InsuranceLine,AuditEffectiveDate,AuditExpirationDate ORDER BY AuditStatus) = 1\n),\nLKP_ExpModTotalPremiumAmount AS (\n\tSELECT\n\tTotalPremiumTransactionAmount,\n\tPolicyKey\n\tFROM (\n\t\tselect sum(pt.PremiumTransactionAmount) as TotalPremiumTransactionAmount, POL.pol_key as PolicyKey\r\n\t\t \r\n\t\tFROM PremiumTransaction PT\r\n\t\t \r\n\t\tinner join RatingCoverage RC\r\n\t\ton PT.RatingCoverageAKID=RC.RatingCoverageAKID\r\n\t\tand RC.EffectiveDate=PT.EffectiveDate\r\n\t\t \r\n\t\tinner join SupClassificationWorkersCompensation SCWC\r\n\t\ton SCWC.ClassCode = RC.ClassCode\r\n\t\tAND SCWC.ExperienceModificationClassIndicator = 'Y'\r\n\t\tAND SCWC.CurrentSnapshotFlag = 1\r\n\t\t \r\n\t\tinner join PolicyCoverage PC\r\n\t\ton PC.PolicyCoverageAKID=RC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\tand PC.TypeBureauCode in ('WC','WP','WorkersCompensation')\r\n\t\t \r\n\t\tinner join v2.policy POL\r\n\t\ton POL.pol_ak_id=PC.PolicyAKID\r\n\t\tand POL.crrnt_snpsht_flag=1\r\n\t\tand PT.CurrentSnapshotFlag=1\r\n\t\t \r\n\t\tgroup by POL.pol_key\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey ORDER BY TotalPremiumTransactionAmount) = 1\n),\nSEQTRANS AS (\n\tCREATE SEQUENCE SEQTRANS\n\tSTART = 0\n\tINCREMENT = 1;\n),\nLKP_sup_state AS (\n\tSELECT\n\tstate_abbrev,\n\tstate_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(state_code)) as state_code,\r\n\t\tLTRIM(RTRIM(state_abbrev)) as state_abbrev \r\n\t\tFROM sup_state\r\n\t\tWHERE crrnt_snpsht_flag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY state_code ORDER BY state_abbrev) = 1\n),\nlkp_ClaimNumber AS (\n\tSELECT\n\tTypeOfRecoveryCode,\n\tClaim_Number,\n\tclaim_party_occurrence_ak_id\n\tFROM (\n\t\tselect distinct RTRIM(Claim_Number) as Claim_Number, ,claim_party_occurrence_ak_id as claim_party_occurrence_ak_id,\r\n\t\tTypeOfRecoveryCode as TypeOfRecoveryCode \r\n\t\tfrom (\r\n\t\tSELECT (CASE WHEN rtrim(ltrim(co.s3p_claim_num)) ='N/A' THEN (RIGHT('000'+CAST((DATEDIFF(d, DATEADD(yy, DATEDIFF(yy,0,co.claim_loss_date),0),co.claim_loss_date)+1) AS VARCHAR),3)+co.claim_occurrence_num+cpo.claimant_num) ELSE co.s3p_claim_num END) AS Claim_Number,\r\n\t\tMAX(case when (cttd.pms_trans_code in ('81','82','83','84','85','86','87','88','89')) AND cltf.direct_subrogation_paid <> 0  then '03' else '01' end) AS TypeOfRecoveryCode\r\n\t\t,cpo.claim_party_occurrence_ak_id\r\n\t\tFROM claim_loss_transaction_fact cltf\r\n\t\tinner join claimant_coverage_dim  ccdim on ccdim.claimant_cov_dim_id = cltf.claimant_cov_dim_id\r\n\t\tINNER JOIN loss_master_fact LMF ON LMF.claimant_cov_dim_id=ccdim.claimant_cov_dim_id\r\n\t\tinner join claim_transaction_type_dim  cttd on cltf.claim_trans_type_dim_id =cttd.claim_trans_type_dim_id and trans_kind_code = 'D' \r\n\t\tinner join calendar_dim c on cltf.claim_trans_date_id=c.clndr_id\r\n\t\tinner join  @{pipeline().parameters.SOURCE_DATABASE_NAME_IL}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail  ccd\r\n\t\ton ccdim.edw_claimant_cov_det_ak_id =ccd.claimant_cov_det_ak_id  and ccd.crrnt_snpsht_flag=1\r\n\t\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME_IL}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence   cpo\r\n\t\tON ccd.claim_party_occurrence_ak_id=cpo.claim_party_occurrence_ak_id \r\n\t\tAND cpo.crrnt_snpsht_flag=1 AND ccd.crrnt_snpsht_flag = 1\r\n\t\tinner join @{pipeline().parameters.SOURCE_DATABASE_NAME_IL}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence co\r\n\t\tON cpo.claim_occurrence_ak_id=co.claim_occurrence_ak_id \r\n\t\tAND co.crrnt_snpsht_flag=1 \r\n\t\tWHERE c.clndr_date <DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}+1, 0)\r\n\t\tGROUP BY (CASE WHEN rtrim(ltrim(co.s3p_claim_num)) ='N/A' THEN (RIGHT('000'+CAST((DATEDIFF(d, DATEADD(yy, DATEDIFF(yy,0,co.claim_loss_date),0),co.claim_loss_date)+1) AS VARCHAR),3)+co.claim_occurrence_num+cpo.claimant_num) ELSE co.s3p_claim_num END)\r\n\t\t,cpo.claim_party_occurrence_ak_id\r\n\t\tHAVING MAX(case when (cttd.pms_trans_code in ('81','82','83','84','85','86','87','88','89')) AND cltf.direct_subrogation_paid <> 0  then '03' else '01' end) ='03'\r\n\t\t) t\r\n\t\torder by Claim_Number, claim_party_occurrence_ak_id,TypeOfRecoveryCode\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY Claim_Number,claim_party_occurrence_ak_id ORDER BY TypeOfRecoveryCode) = 1\n),\nLKP_PremiumTransaction_pol_ak_id AS (\n\tSELECT\n\tpol_ak_id\n\tFROM (\n\t\tSELECT DISTINCT P.pol_ak_id AS pol_ak_id\r\n\t\t   from @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton SC.StatisticalCoverageAKID=PT.StatisticalCoverageAKID\r\n\t\tand SC.CurrentSnapshotFlag=1 and  PT.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton PC.PolicyCoverageAKID=SC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\t\ton PC.RiskLocationAKID=RL.RiskLocationAKID\r\n\t\tand RL.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy P\r\n\t\ton P.pol_ak_id=RL.PolicyAKID \r\n\t\tand P.crrnt_snpsht_flag=1 \r\n\t\t\r\n\t\twhere SC.SourceSystemID='PMS'  \r\n\t\tand PC.TypeBureauCode in ('WC','WP','WorkersCompensation')  and  PT.PremiumType='D'   and PT.ReasonAmendedCode != 'CWO'\r\n\t\tand DATEDIFF(MM,P.pol_eff_date, DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}, 0) )  > 18\r\n\t\tand PT.PremiumTransactionBookedDate>=DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}, 0)\r\n\t\tand PT.PremiumTransactionBookedDate<DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}+1, 0)\r\n\t\t\r\n\t\tUNION ALL\r\n\t\t\r\n\t\tSELECT DISTINCT  P.pol_ak_id AS pol_ak_id\r\n\t\t   from @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton RC.RatingCoverageAKID=PT.RatingCoverageAKId\r\n\t\tand RC.EffectiveDate=PT.EffectiveDate and PT.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton PC.PolicyCoverageAKID=RC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\t\ton PC.RiskLocationAKID=RL.RiskLocationAKID\r\n\t\tand RL.CurrentSnapshotFlag=1\r\n\t\t\r\n\t\tinner join @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy P\r\n\t\ton P.pol_ak_id=RL.PolicyAKID \r\n\t\tand P.crrnt_snpsht_flag=1 \r\n\t\t\r\n\t\twhere RC.SourceSystemID='DCT' and PC.TypeBureauCode in ('WC','WP','WorkersCompensation')  and PT.PremiumType='D'\r\n\t\tand PT.ReasonAmendedCode NOT IN ('CWO','Claw Back')\r\n\t\tand DATEDIFF(MM,P.pol_eff_date, DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}, 0) )  > 18\r\n\t\tand PT.PremiumTransactionBookedDate>=DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}, 0)\r\n\t\tand PT.PremiumTransactionBookedDate<DATEADD(MM, DATEDIFF(MM, 0, GETDATE()) + @{pipeline().parameters.NUM_OF_MONTHS}+1, 0)\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id ORDER BY pol_ak_id) = 1\n),\nSQ_WorkWCSTATPremium AS (\n\tSELECT\n\t\tWorkWCSTATPremiumId,\n\t\tAuditId,\n\t\tCreatedDate,\n\t\tModifiedDate,\n\t\tSourceSystemId,\n\t\tPremiumMasterCalculationID,\n\t\tPremiumMasterRunDate,\n\t\tStateRatingEffectiveDate,\n\t\tWCRetrospectiveRatingIndicator,\n\t\tExperienceModificationFactor,\n\t\tExperienceModificationEffectiveDate,\n\t\tPremiumMasterPremium,\n\t\tBaseRate,\n\t\tTypeBureauCode,\n\t\tPolicySymbol,\n\t\tPolicyNumber,\n\t\tPolicyModulus,\n\t\tStateProvinceCode,\n\t\tPolicyEffectiveDate,\n\t\tPolicyExpiryDate,\n\t\tPolicyCancellationDate,\n\t\tPolicyCancellationIndicator,\n\t\tInterstateRiskId,\n\t\tFederalTaxId,\n\t\tPolicyTerm,\n\t\tPolicyAKId,\n\t\tInsuranceSegmentAbbreviation,\n\t\tCustomerRole,\n\t\tName,\n\t\tAddressLine1,\n\t\tCityName,\n\t\tStateProvCodeContractCustomerAddress,\n\t\tZipPostalCode,\n\t\tClassCode,\n\t\tExposure,\n\t\tDeductibleAmount,\n\t\tInsuranceLine,\n\t\tBalanceMinimumPremiumTotal,\n\t\tRateEffectiveDate,\n\t\tReasonAmendedCode,\n\t\tStrategicProfitCenterAbbreviation,\n\t\tPolicyStatusCode,\n\t\tPremiumTransactionEnteredDate,\n\t\tOffsetOnsetCode,\n\t\tPolicyKey,\n\t\tCoverageType,\n\t\tPremiumTransactionCode,\n\t\tCoverageGUID,\n\t\tRatingCoverageAKID,\n\t\tRunMonthAuditTransactionFlag,\n\t\tAgeOfPolicy,\n\t\tTermType,\n\t\tPeriodStartDate,\n\t\tPeriodEndDate,\n\t\tAnyARDIndicator,\n\t\tExperienceRated,\n\t\tPremiumTransactionEffectiveDate,\n\t\tLossesSubjectToDeductibleCode,\n\t\tBasisOfDeductibleCalculationCode\n\tFROM WorkWCSTATPremium\n\tWHERE AuditId=@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID}  \r\n\t @{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_workWcStatPremiumSource AS (\n\tSELECT\n\tWorkWCSTATPremiumId AS workWcStatPremiumSourceID,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tPolicySymbol AS pol_sym,\n\tPolicyNumber AS pol_num,\n\tPolicyModulus AS pol_mod,\n\tStateProvinceCode,\n\tPolicyEffectiveDate AS pol_eff_date,\n\tPolicyExpiryDate AS pol_exp_date,\n\tPolicyCancellationDate AS pol_cancellation_date,\n\tPolicyCancellationIndicator AS pol_cancellation_ind,\n\tInterstateRiskId,\n\tFederalTaxId AS fed_tax_id,\n\tPolicyTerm AS pol_term,\n\tPolicyAKId AS pol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tCustomerRole AS cust_role,\n\tName AS name,\n\tAddressLine1 AS addr_line_1,\n\tCityName AS city_name,\n\tStateProvCodeContractCustomerAddress AS state_prov_code,\n\tZipPostalCode AS zip_postal_code,\n\tClassCode,\n\tExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tBalanceMinimumPremiumTotal AS BalMinPremiumTotal,\n\tRateEffectiveDate,\n\tSourceSystemId AS SourceSystem,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tPolicyStatusCode AS pol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tPolicyKey AS Pol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tRunMonthAuditTransactionFlag AS RunMonthAuditTransFlag,\n\tAgeOfPolicy,\n\tTermType,\n\tPeriodStartDate AS Period_start_date,\n\tPeriodEndDate AS Period_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tPremiumTransactionEffectiveDate,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM SQ_WorkWCSTATPremium\n),\nRTR_Premium AS (\n\tSELECT\n\tworkWcStatPremiumSourceID,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tBalMinPremiumTotal,\n\tRateEffectiveDate,\n\tSourceSystem,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tPol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tRunMonthAuditTransFlag,\n\tAgeOfPolicy,\n\tTermType,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tPremiumTransactionEffectiveDate,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM EXP_workWcStatPremiumSource\n),\nRTR_Premium_PMS AS (SELECT * FROM RTR_Premium WHERE SourceSystem='PMS'),\nRTR_Premium_DCT AS (SELECT * FROM RTR_Premium WHERE SourceSystem='DCT'),\nRTR_Premium_DCT_MN AS (SELECT * FROM RTR_Premium WHERE SourceSystem='DCT PT'),\nEXP_dct AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tPol_key AS pol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tExposure AS WrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tBalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag AS RunMonthAuditTransFlag3,\n\tAgeOfPolicy AS AgeOfPolicy3,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate AS PremiumTransactionEffectiveDate3,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM RTR_Premium_DCT\n),\nSRT_Premium_DCT AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tpol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tWrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tBalMinPremiumTotal, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tRunMonthAuditTransFlag3, \n\tAgeOfPolicy3, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate3, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM EXP_dct\n\tORDER BY pol_key ASC\n),\nAGG_Premium_DCT_PremiumTotal AS (\n\tSELECT\n\tpol_key,\n\tPremiumMasterPremium,\n\t-- *INF*: ROUND(sum(PremiumMasterPremium))\n\tROUND(sum(PremiumMasterPremium)) AS o_PolicyPremiumTotal\n\tFROM SRT_Premium_DCT\n\tGROUP BY pol_key\n),\nJNR_Premium_DCT_PremiumTotal AS (SELECT\n\tSRT_Premium_DCT.SourceSystem, \n\tSRT_Premium_DCT.PremiumMasterCalculationID, \n\tSRT_Premium_DCT.PremiumMasterRunDate, \n\tSRT_Premium_DCT.StateRatingEffectiveDate, \n\tSRT_Premium_DCT.WCRetrospectiveRatingIndicator, \n\tSRT_Premium_DCT.ExperienceModificationFactor, \n\tSRT_Premium_DCT.ExperienceModificationEffectiveDate, \n\tSRT_Premium_DCT.PremiumMasterPremium, \n\tSRT_Premium_DCT.BaseRate, \n\tSRT_Premium_DCT.TypeBureauCode, \n\tSRT_Premium_DCT.pol_sym, \n\tSRT_Premium_DCT.pol_num, \n\tSRT_Premium_DCT.pol_mod, \n\tSRT_Premium_DCT.pol_key, \n\tSRT_Premium_DCT.CoverageType, \n\tSRT_Premium_DCT.PremiumTransactionCode, \n\tSRT_Premium_DCT.CoverageGUID, \n\tSRT_Premium_DCT.RatingCoverageAKID, \n\tSRT_Premium_DCT.Period_start_date, \n\tSRT_Premium_DCT.Period_end_date, \n\tSRT_Premium_DCT.AnyARDIndicator, \n\tSRT_Premium_DCT.ExperienceRated, \n\tSRT_Premium_DCT.TermType, \n\tSRT_Premium_DCT.StateProvinceCode, \n\tSRT_Premium_DCT.pol_eff_date, \n\tSRT_Premium_DCT.pol_exp_date, \n\tSRT_Premium_DCT.pol_cancellation_date, \n\tSRT_Premium_DCT.pol_cancellation_ind, \n\tSRT_Premium_DCT.InterstateRiskId, \n\tSRT_Premium_DCT.pol_id, \n\tSRT_Premium_DCT.fed_tax_id, \n\tSRT_Premium_DCT.pol_term, \n\tSRT_Premium_DCT.pol_ak_id, \n\tSRT_Premium_DCT.InsuranceSegmentAbbreviation, \n\tSRT_Premium_DCT.cust_role, \n\tSRT_Premium_DCT.name, \n\tSRT_Premium_DCT.addr_line_1, \n\tSRT_Premium_DCT.city_name, \n\tSRT_Premium_DCT.state_prov_code, \n\tSRT_Premium_DCT.zip_postal_code, \n\tSRT_Premium_DCT.ClassCode, \n\tSRT_Premium_DCT.WrittenExposure, \n\tSRT_Premium_DCT.DeductibleAmount, \n\tSRT_Premium_DCT.InsuranceLine, \n\tSRT_Premium_DCT.BalMinPremiumTotal, \n\tSRT_Premium_DCT.ReasonAmendedCode, \n\tSRT_Premium_DCT.StrategicProfitCenterAbbreviation, \n\tSRT_Premium_DCT.pol_status_code, \n\tSRT_Premium_DCT.PremiumTransactionEnteredDate, \n\tSRT_Premium_DCT.OffsetOnsetCode, \n\tAGG_Premium_DCT_PremiumTotal.pol_key AS pol_key1, \n\tAGG_Premium_DCT_PremiumTotal.o_PolicyPremiumTotal AS o_PremiumMasterPremium, \n\tSRT_Premium_DCT.RunMonthAuditTransFlag3, \n\tSRT_Premium_DCT.AgeOfPolicy3, \n\tSRT_Premium_DCT.RateEffectiveDate, \n\tSRT_Premium_DCT.PremiumTransactionEffectiveDate3, \n\tSRT_Premium_DCT.LossesSubjectToDeductibleCode, \n\tSRT_Premium_DCT.BasisOfDeductibleCalculationCode\n\tFROM SRT_Premium_DCT\n\tLEFT OUTER JOIN AGG_Premium_DCT_PremiumTotal\n\tON AGG_Premium_DCT_PremiumTotal.pol_key = SRT_Premium_DCT.pol_key\n),\nSRT_Premium_DCT_ManualPremium AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tpol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tWrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tBalMinPremiumTotal, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\to_PremiumMasterPremium AS o_PolicyPremiumTotal, \n\tRunMonthAuditTransFlag3, \n\tAgeOfPolicy3, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate3, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_Premium_DCT_PremiumTotal\n\tORDER BY pol_key ASC, StateProvinceCode ASC\n),\nAGG_Premium_DCT_ManualPremium AS (\n\tSELECT\n\tpol_key,\n\tStateProvinceCode,\n\tPremiumMasterPremium,\n\tCoverageType,\n\t-- *INF*: sum(iif(CoverageType='ManualPremium', 1, 0))\n\tsum(\n\t    IFF(\n\t        CoverageType = 'ManualPremium', 1, 0\n\t    )) AS o_ManualPremiumInd,\n\t-- *INF*: round(sum(iif(CoverageType='ManualPremium', PremiumMasterPremium, 0)))\n\tround(sum(\n\t        IFF(\n\t            CoverageType = 'ManualPremium', PremiumMasterPremium, 0\n\t        ))) AS o_PolicyStateManualPremiumTotal\n\tFROM SRT_Premium_DCT_ManualPremium\n\tGROUP BY pol_key, StateProvinceCode\n),\nJNR_Premium_DCT_ManualPremium AS (SELECT\n\tSRT_Premium_DCT_ManualPremium.SourceSystem, \n\tSRT_Premium_DCT_ManualPremium.PremiumMasterCalculationID, \n\tSRT_Premium_DCT_ManualPremium.PremiumMasterRunDate, \n\tSRT_Premium_DCT_ManualPremium.StateRatingEffectiveDate, \n\tSRT_Premium_DCT_ManualPremium.WCRetrospectiveRatingIndicator, \n\tSRT_Premium_DCT_ManualPremium.ExperienceModificationFactor, \n\tSRT_Premium_DCT_ManualPremium.ExperienceModificationEffectiveDate, \n\tSRT_Premium_DCT_ManualPremium.PremiumMasterPremium, \n\tSRT_Premium_DCT_ManualPremium.BaseRate, \n\tSRT_Premium_DCT_ManualPremium.TypeBureauCode, \n\tSRT_Premium_DCT_ManualPremium.pol_sym, \n\tSRT_Premium_DCT_ManualPremium.pol_num, \n\tSRT_Premium_DCT_ManualPremium.pol_mod, \n\tSRT_Premium_DCT_ManualPremium.pol_key, \n\tSRT_Premium_DCT_ManualPremium.CoverageType, \n\tSRT_Premium_DCT_ManualPremium.PremiumTransactionCode, \n\tSRT_Premium_DCT_ManualPremium.CoverageGUID, \n\tSRT_Premium_DCT_ManualPremium.RatingCoverageAKID, \n\tSRT_Premium_DCT_ManualPremium.Period_start_date, \n\tSRT_Premium_DCT_ManualPremium.Period_end_date, \n\tSRT_Premium_DCT_ManualPremium.AnyARDIndicator, \n\tSRT_Premium_DCT_ManualPremium.ExperienceRated, \n\tSRT_Premium_DCT_ManualPremium.TermType, \n\tSRT_Premium_DCT_ManualPremium.StateProvinceCode, \n\tSRT_Premium_DCT_ManualPremium.pol_eff_date, \n\tSRT_Premium_DCT_ManualPremium.pol_exp_date, \n\tSRT_Premium_DCT_ManualPremium.pol_cancellation_date, \n\tSRT_Premium_DCT_ManualPremium.pol_cancellation_ind, \n\tSRT_Premium_DCT_ManualPremium.InterstateRiskId, \n\tSRT_Premium_DCT_ManualPremium.pol_id, \n\tSRT_Premium_DCT_ManualPremium.fed_tax_id, \n\tSRT_Premium_DCT_ManualPremium.pol_term, \n\tSRT_Premium_DCT_ManualPremium.pol_ak_id, \n\tSRT_Premium_DCT_ManualPremium.InsuranceSegmentAbbreviation, \n\tSRT_Premium_DCT_ManualPremium.cust_role, \n\tSRT_Premium_DCT_ManualPremium.name, \n\tSRT_Premium_DCT_ManualPremium.addr_line_1, \n\tSRT_Premium_DCT_ManualPremium.city_name, \n\tSRT_Premium_DCT_ManualPremium.state_prov_code, \n\tSRT_Premium_DCT_ManualPremium.zip_postal_code, \n\tSRT_Premium_DCT_ManualPremium.ClassCode, \n\tSRT_Premium_DCT_ManualPremium.WrittenExposure, \n\tSRT_Premium_DCT_ManualPremium.DeductibleAmount, \n\tSRT_Premium_DCT_ManualPremium.InsuranceLine, \n\tSRT_Premium_DCT_ManualPremium.o_PolicyPremiumTotal, \n\tAGG_Premium_DCT_ManualPremium.o_ManualPremiumInd, \n\tAGG_Premium_DCT_ManualPremium.o_PolicyStateManualPremiumTotal, \n\tSRT_Premium_DCT_ManualPremium.BalMinPremiumTotal, \n\tSRT_Premium_DCT_ManualPremium.ReasonAmendedCode, \n\tSRT_Premium_DCT_ManualPremium.StrategicProfitCenterAbbreviation, \n\tSRT_Premium_DCT_ManualPremium.pol_status_code, \n\tSRT_Premium_DCT_ManualPremium.PremiumTransactionEnteredDate, \n\tSRT_Premium_DCT_ManualPremium.OffsetOnsetCode, \n\tAGG_Premium_DCT_ManualPremium.StateProvinceCode AS StateProvinceCode1, \n\tAGG_Premium_DCT_ManualPremium.pol_key AS pol_key2, \n\tSRT_Premium_DCT_ManualPremium.RunMonthAuditTransFlag3, \n\tSRT_Premium_DCT_ManualPremium.AgeOfPolicy3, \n\tSRT_Premium_DCT_ManualPremium.RateEffectiveDate, \n\tSRT_Premium_DCT_ManualPremium.PremiumTransactionEffectiveDate3, \n\tSRT_Premium_DCT_ManualPremium.LossesSubjectToDeductibleCode, \n\tSRT_Premium_DCT_ManualPremium.BasisOfDeductibleCalculationCode\n\tFROM SRT_Premium_DCT_ManualPremium\n\tLEFT OUTER JOIN AGG_Premium_DCT_ManualPremium\n\tON AGG_Premium_DCT_ManualPremium.pol_key = SRT_Premium_DCT_ManualPremium.pol_key AND AGG_Premium_DCT_ManualPremium.StateProvinceCode = SRT_Premium_DCT_ManualPremium.StateProvinceCode\n),\nEXP_Premium_DCT AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tWrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\to_PolicyPremiumTotal AS PolicyPremiumTotal,\n\to_ManualPremiumInd AS ManualPremiumInd,\n\to_PolicyStateManualPremiumTotal AS PolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag3,\n\tAgeOfPolicy3,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate3,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_Premium_DCT_ManualPremium\n),\nEXP_PMS AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tPol_key AS pol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_ AS addr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tExposure AS WrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tPol_key AS policy_pol_key,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag AS RunMonthAuditTransFlag1,\n\tAgeOfPolicy AS AgeOfPolicy1,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate AS PremiumTransactionEffectiveDate1,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM RTR_Premium_PMS\n),\nSRT_Premium_PMS AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tpol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tWrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tpolicy_pol_key, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tRunMonthAuditTransFlag1, \n\tAgeOfPolicy1, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate1, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM EXP_PMS\n\tORDER BY pol_key ASC\n),\nAGG_Premium_PMS_PremiumTotal AS (\n\tSELECT\n\tpol_key AS policy_pol_key,\n\tPremiumMasterPremium,\n\t-- *INF*: round(sum(PremiumMasterPremium))\n\tround(sum(PremiumMasterPremium)) AS o_PolicyPremiumTotal\n\tFROM SRT_Premium_PMS\n\tGROUP BY policy_pol_key\n),\nJNR_Premium_PMS_PremiumTotal AS (SELECT\n\tSRT_Premium_PMS.SourceSystem, \n\tSRT_Premium_PMS.PremiumMasterCalculationID, \n\tSRT_Premium_PMS.PremiumMasterRunDate, \n\tSRT_Premium_PMS.StateRatingEffectiveDate, \n\tSRT_Premium_PMS.WCRetrospectiveRatingIndicator, \n\tSRT_Premium_PMS.ExperienceModificationFactor, \n\tSRT_Premium_PMS.ExperienceModificationEffectiveDate, \n\tSRT_Premium_PMS.PremiumMasterPremium, \n\tSRT_Premium_PMS.BaseRate, \n\tSRT_Premium_PMS.TypeBureauCode, \n\tSRT_Premium_PMS.pol_sym, \n\tSRT_Premium_PMS.pol_num, \n\tSRT_Premium_PMS.pol_mod, \n\tSRT_Premium_PMS.pol_key, \n\tSRT_Premium_PMS.CoverageType, \n\tSRT_Premium_PMS.PremiumTransactionCode, \n\tSRT_Premium_PMS.CoverageGUID, \n\tSRT_Premium_PMS.RatingCoverageAKID, \n\tSRT_Premium_PMS.Period_start_date, \n\tSRT_Premium_PMS.Period_end_date, \n\tSRT_Premium_PMS.AnyARDIndicator, \n\tSRT_Premium_PMS.ExperienceRated, \n\tSRT_Premium_PMS.TermType, \n\tSRT_Premium_PMS.StateProvinceCode, \n\tSRT_Premium_PMS.pol_eff_date, \n\tSRT_Premium_PMS.pol_exp_date, \n\tSRT_Premium_PMS.pol_cancellation_date, \n\tSRT_Premium_PMS.pol_cancellation_ind, \n\tSRT_Premium_PMS.InterstateRiskId, \n\tSRT_Premium_PMS.pol_id, \n\tSRT_Premium_PMS.fed_tax_id, \n\tSRT_Premium_PMS.pol_term, \n\tSRT_Premium_PMS.pol_ak_id, \n\tSRT_Premium_PMS.InsuranceSegmentAbbreviation, \n\tSRT_Premium_PMS.cust_role, \n\tSRT_Premium_PMS.name, \n\tSRT_Premium_PMS.addr_line_1, \n\tSRT_Premium_PMS.city_name, \n\tSRT_Premium_PMS.state_prov_code, \n\tSRT_Premium_PMS.zip_postal_code, \n\tSRT_Premium_PMS.ClassCode, \n\tSRT_Premium_PMS.WrittenExposure, \n\tSRT_Premium_PMS.DeductibleAmount, \n\tSRT_Premium_PMS.InsuranceLine, \n\tSRT_Premium_PMS.policy_pol_key, \n\tSRT_Premium_PMS.ReasonAmendedCode, \n\tSRT_Premium_PMS.StrategicProfitCenterAbbreviation, \n\tSRT_Premium_PMS.pol_status_code, \n\tSRT_Premium_PMS.PremiumTransactionEnteredDate, \n\tSRT_Premium_PMS.OffsetOnsetCode, \n\tAGG_Premium_PMS_PremiumTotal.policy_pol_key AS agg_policy_pol_key, \n\tAGG_Premium_PMS_PremiumTotal.o_PolicyPremiumTotal AS PolicyPremiumTotal, \n\tSRT_Premium_PMS.RunMonthAuditTransFlag1, \n\tSRT_Premium_PMS.AgeOfPolicy1, \n\tSRT_Premium_PMS.RateEffectiveDate, \n\tSRT_Premium_PMS.PremiumTransactionEffectiveDate1, \n\tSRT_Premium_PMS.LossesSubjectToDeductibleCode, \n\tSRT_Premium_PMS.BasisOfDeductibleCalculationCode\n\tFROM SRT_Premium_PMS\n\tINNER JOIN AGG_Premium_PMS_PremiumTotal\n\tON AGG_Premium_PMS_PremiumTotal.policy_pol_key = SRT_Premium_PMS.pol_key\n),\nSRT_Premium_PMS_ManualPremium AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tpol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tpolicy_pol_key, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tWrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tPolicyPremiumTotal, \n\tRunMonthAuditTransFlag1, \n\tAgeOfPolicy1, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate1, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_Premium_PMS_PremiumTotal\n\tORDER BY pol_key ASC, StateProvinceCode ASC\n),\nAGG_Premium_PMS_ManualPremium AS (\n\tSELECT\n\tpol_key AS policy_pol_key,\n\tStateProvinceCode,\n\tPremiumMasterPremium,\n\tClassCode,\n\t-- *INF*: SUM(IIF(LENGTH(ClassCode)=6, 1, 0))\n\tSUM(\n\t    IFF(\n\t        LENGTH(ClassCode) = 6, 1, 0\n\t    )) AS o_ManualPremiumInd,\n\t-- *INF*: SUM(IIF(LENGTH(ClassCode)=6, PremiumMasterPremium, 0))\n\tSUM(\n\t    IFF(\n\t        LENGTH(ClassCode) = 6, PremiumMasterPremium, 0\n\t    )) AS o_PolicyStateManualPremiumTotal,\n\t-- *INF*: round(SUM(IIF(ClassCode='0990', PremiumMasterPremium, 0)))\n\tround(SUM(\n\t        IFF(\n\t            ClassCode = '0990', PremiumMasterPremium, 0\n\t        ))) AS o_BalMinPremiumTotal\n\tFROM SRT_Premium_PMS_ManualPremium\n\tGROUP BY policy_pol_key, StateProvinceCode\n),\nJNR_Premium_PMS_ManualPremium AS (SELECT\n\tSRT_Premium_PMS_ManualPremium.SourceSystem, \n\tSRT_Premium_PMS_ManualPremium.PremiumMasterCalculationID, \n\tSRT_Premium_PMS_ManualPremium.PremiumMasterRunDate, \n\tSRT_Premium_PMS_ManualPremium.StateRatingEffectiveDate, \n\tSRT_Premium_PMS_ManualPremium.WCRetrospectiveRatingIndicator, \n\tSRT_Premium_PMS_ManualPremium.ExperienceModificationFactor, \n\tSRT_Premium_PMS_ManualPremium.ExperienceModificationEffectiveDate, \n\tSRT_Premium_PMS_ManualPremium.PremiumMasterPremium, \n\tSRT_Premium_PMS_ManualPremium.BaseRate, \n\tSRT_Premium_PMS_ManualPremium.TypeBureauCode, \n\tSRT_Premium_PMS_ManualPremium.pol_sym, \n\tSRT_Premium_PMS_ManualPremium.pol_num, \n\tSRT_Premium_PMS_ManualPremium.pol_mod, \n\tSRT_Premium_PMS_ManualPremium.pol_key, \n\tSRT_Premium_PMS_ManualPremium.CoverageType, \n\tSRT_Premium_PMS_ManualPremium.PremiumTransactionCode, \n\tSRT_Premium_PMS_ManualPremium.CoverageGUID, \n\tSRT_Premium_PMS_ManualPremium.RatingCoverageAKID, \n\tSRT_Premium_PMS_ManualPremium.Period_start_date, \n\tSRT_Premium_PMS_ManualPremium.Period_end_date, \n\tSRT_Premium_PMS_ManualPremium.AnyARDIndicator, \n\tSRT_Premium_PMS_ManualPremium.ExperienceRated, \n\tSRT_Premium_PMS_ManualPremium.TermType, \n\tSRT_Premium_PMS_ManualPremium.StateProvinceCode, \n\tSRT_Premium_PMS_ManualPremium.pol_eff_date, \n\tSRT_Premium_PMS_ManualPremium.pol_exp_date, \n\tSRT_Premium_PMS_ManualPremium.pol_cancellation_date, \n\tSRT_Premium_PMS_ManualPremium.pol_cancellation_ind, \n\tSRT_Premium_PMS_ManualPremium.InterstateRiskId, \n\tSRT_Premium_PMS_ManualPremium.pol_id, \n\tSRT_Premium_PMS_ManualPremium.fed_tax_id, \n\tSRT_Premium_PMS_ManualPremium.pol_term, \n\tSRT_Premium_PMS_ManualPremium.pol_ak_id, \n\tSRT_Premium_PMS_ManualPremium.InsuranceSegmentAbbreviation, \n\tSRT_Premium_PMS_ManualPremium.cust_role, \n\tSRT_Premium_PMS_ManualPremium.name, \n\tSRT_Premium_PMS_ManualPremium.addr_line_1, \n\tSRT_Premium_PMS_ManualPremium.city_name, \n\tSRT_Premium_PMS_ManualPremium.state_prov_code, \n\tSRT_Premium_PMS_ManualPremium.zip_postal_code, \n\tSRT_Premium_PMS_ManualPremium.ClassCode, \n\tSRT_Premium_PMS_ManualPremium.WrittenExposure, \n\tSRT_Premium_PMS_ManualPremium.DeductibleAmount, \n\tSRT_Premium_PMS_ManualPremium.InsuranceLine, \n\tSRT_Premium_PMS_ManualPremium.PolicyPremiumTotal, \n\tAGG_Premium_PMS_ManualPremium.o_ManualPremiumInd, \n\tAGG_Premium_PMS_ManualPremium.o_PolicyStateManualPremiumTotal, \n\tAGG_Premium_PMS_ManualPremium.o_BalMinPremiumTotal, \n\tSRT_Premium_PMS_ManualPremium.policy_pol_key, \n\tSRT_Premium_PMS_ManualPremium.ReasonAmendedCode, \n\tSRT_Premium_PMS_ManualPremium.StrategicProfitCenterAbbreviation, \n\tSRT_Premium_PMS_ManualPremium.pol_status_code, \n\tSRT_Premium_PMS_ManualPremium.PremiumTransactionEnteredDate, \n\tSRT_Premium_PMS_ManualPremium.OffsetOnsetCode, \n\tAGG_Premium_PMS_ManualPremium.policy_pol_key AS policy_pol_key1, \n\tAGG_Premium_PMS_ManualPremium.StateProvinceCode AS StateProvinceCode1, \n\tSRT_Premium_PMS_ManualPremium.RunMonthAuditTransFlag1, \n\tSRT_Premium_PMS_ManualPremium.AgeOfPolicy1, \n\tSRT_Premium_PMS_ManualPremium.RateEffectiveDate, \n\tSRT_Premium_PMS_ManualPremium.PremiumTransactionEffectiveDate1, \n\tSRT_Premium_PMS_ManualPremium.LossesSubjectToDeductibleCode, \n\tSRT_Premium_PMS_ManualPremium.BasisOfDeductibleCalculationCode\n\tFROM SRT_Premium_PMS_ManualPremium\n\tLEFT OUTER JOIN AGG_Premium_PMS_ManualPremium\n\tON AGG_Premium_PMS_ManualPremium.policy_pol_key = SRT_Premium_PMS_ManualPremium.pol_key AND AGG_Premium_PMS_ManualPremium.StateProvinceCode = SRT_Premium_PMS_ManualPremium.StateProvinceCode\n),\nEXP_Premium_PMS AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tWrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tPolicyPremiumTotal,\n\to_ManualPremiumInd AS ManualPremiumInd,\n\to_PolicyStateManualPremiumTotal AS PolicyStateManualPremiumTotal,\n\to_BalMinPremiumTotal AS BalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag1,\n\tAgeOfPolicy1,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate1,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_Premium_PMS_ManualPremium\n),\nSRT_Premium_mnsc AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tPol_key AS pol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tExposure AS WrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tBalMinPremiumTotal, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tRunMonthAuditTransFlag AS RunMonthAuditTransFlag4, \n\tAgeOfPolicy AS AgeOfPolicy4, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate AS PremiumTransactionEffectiveDate4, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM RTR_Premium_DCT_MN\n\tORDER BY pol_key ASC\n),\nAGG_Premium_mnsc AS (\n\tSELECT\n\tpol_key,\n\tPremiumMasterPremium,\n\t-- *INF*: sum(PremiumMasterPremium)\n\tsum(PremiumMasterPremium) AS o_PolicyPremiumTotal\n\tFROM SRT_Premium_mnsc\n\tGROUP BY pol_key\n),\nJNR_Premium_mnsc AS (SELECT\n\tSRT_Premium_mnsc.SourceSystem, \n\tSRT_Premium_mnsc.PremiumMasterCalculationID, \n\tSRT_Premium_mnsc.PremiumMasterRunDate, \n\tSRT_Premium_mnsc.StateRatingEffectiveDate, \n\tSRT_Premium_mnsc.WCRetrospectiveRatingIndicator, \n\tSRT_Premium_mnsc.ExperienceModificationFactor, \n\tSRT_Premium_mnsc.ExperienceModificationEffectiveDate, \n\tSRT_Premium_mnsc.PremiumMasterPremium, \n\tSRT_Premium_mnsc.BaseRate, \n\tSRT_Premium_mnsc.TypeBureauCode, \n\tSRT_Premium_mnsc.pol_sym, \n\tSRT_Premium_mnsc.pol_num, \n\tSRT_Premium_mnsc.pol_mod, \n\tSRT_Premium_mnsc.pol_key, \n\tSRT_Premium_mnsc.CoverageType, \n\tSRT_Premium_mnsc.PremiumTransactionCode, \n\tSRT_Premium_mnsc.CoverageGUID, \n\tSRT_Premium_mnsc.RatingCoverageAKID, \n\tSRT_Premium_mnsc.Period_start_date, \n\tSRT_Premium_mnsc.Period_end_date, \n\tSRT_Premium_mnsc.AnyARDIndicator, \n\tSRT_Premium_mnsc.ExperienceRated, \n\tSRT_Premium_mnsc.TermType, \n\tSRT_Premium_mnsc.StateProvinceCode, \n\tSRT_Premium_mnsc.pol_eff_date, \n\tSRT_Premium_mnsc.pol_exp_date, \n\tSRT_Premium_mnsc.pol_cancellation_date, \n\tSRT_Premium_mnsc.pol_cancellation_ind, \n\tSRT_Premium_mnsc.InterstateRiskId, \n\tSRT_Premium_mnsc.pol_id, \n\tSRT_Premium_mnsc.fed_tax_id, \n\tSRT_Premium_mnsc.pol_term, \n\tSRT_Premium_mnsc.pol_ak_id, \n\tSRT_Premium_mnsc.InsuranceSegmentAbbreviation, \n\tSRT_Premium_mnsc.cust_role, \n\tSRT_Premium_mnsc.name, \n\tSRT_Premium_mnsc.addr_line_1, \n\tSRT_Premium_mnsc.city_name, \n\tSRT_Premium_mnsc.state_prov_code, \n\tSRT_Premium_mnsc.zip_postal_code, \n\tSRT_Premium_mnsc.ClassCode, \n\tSRT_Premium_mnsc.WrittenExposure, \n\tSRT_Premium_mnsc.DeductibleAmount, \n\tSRT_Premium_mnsc.InsuranceLine, \n\tSRT_Premium_mnsc.ManualPremiumInd, \n\tSRT_Premium_mnsc.PolicyStateManualPremiumTotal, \n\tSRT_Premium_mnsc.BalMinPremiumTotal, \n\tSRT_Premium_mnsc.ReasonAmendedCode, \n\tSRT_Premium_mnsc.StrategicProfitCenterAbbreviation, \n\tSRT_Premium_mnsc.pol_status_code, \n\tSRT_Premium_mnsc.PremiumTransactionEnteredDate, \n\tSRT_Premium_mnsc.OffsetOnsetCode, \n\tAGG_Premium_mnsc.pol_key AS pol_key1, \n\tAGG_Premium_mnsc.o_PolicyPremiumTotal, \n\tSRT_Premium_mnsc.RunMonthAuditTransFlag4, \n\tSRT_Premium_mnsc.AgeOfPolicy4, \n\tSRT_Premium_mnsc.RateEffectiveDate, \n\tSRT_Premium_mnsc.PremiumTransactionEffectiveDate4, \n\tSRT_Premium_mnsc.LossesSubjectToDeductibleCode, \n\tSRT_Premium_mnsc.BasisOfDeductibleCalculationCode\n\tFROM SRT_Premium_mnsc\n\tLEFT OUTER JOIN AGG_Premium_mnsc\n\tON AGG_Premium_mnsc.pol_key = SRT_Premium_mnsc.pol_key\n),\nEXP_Premium_mnsc AS (\n\tSELECT\n\tSourceSystem,\n\t'DCT' AS o_SourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tWrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\to_PolicyPremiumTotal AS PolicyPremiumTotal,\n\t0 AS ManualPremiumInd,\n\t0 AS PolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag4,\n\tAgeOfPolicy4,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate4,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_Premium_mnsc\n),\nUnion_ AS (\n\tSELECT o_SourceSystem AS SourceSystem, PremiumMasterCalculationID, PremiumMasterRunDate, StateRatingEffectiveDate, WCRetrospectiveRatingIndicator, ExperienceModificationFactor, ExperienceModificationEffectiveDate, PremiumMasterPremium, BaseRate, TypeBureauCode, pol_sym, pol_num, pol_mod, pol_key, CoverageType, PremiumTransactionCode, CoverageGUID, RatingCoverageAKID, Period_start_date, Period_end_date, AnyARDIndicator, ExperienceRated, TermType, StateProvinceCode, pol_eff_date, pol_exp_date, pol_cancellation_date, pol_cancellation_ind, InterstateRiskId, pol_id, fed_tax_id, pol_term, pol_ak_id, InsuranceSegmentAbbreviation, cust_role, name, addr_line_1, city_name, state_prov_code, zip_postal_code, ClassCode, WrittenExposure, DeductibleAmount, InsuranceLine, PolicyPremiumTotal, ManualPremiumInd, PolicyStateManualPremiumTotal, BalMinPremiumTotal, ReasonAmendedCode, StrategicProfitCenterAbbreviation, pol_status_code, PremiumTransactionEnteredDate, OffsetOnsetCode, RunMonthAuditTransFlag4 AS RunMonthAuditTransFlag1, AgeOfPolicy4 AS AgeOfPolicy1, RateEffectiveDate, PremiumTransactionEffectiveDate4 AS PremiumTransactionEffectiveDate1, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode\n\tFROM EXP_Premium_mnsc\n\tUNION\n\tSELECT SourceSystem, PremiumMasterCalculationID, PremiumMasterRunDate, StateRatingEffectiveDate, WCRetrospectiveRatingIndicator, ExperienceModificationFactor, ExperienceModificationEffectiveDate, PremiumMasterPremium, BaseRate, TypeBureauCode, pol_sym, pol_num, pol_mod, pol_key, CoverageType, PremiumTransactionCode, CoverageGUID, RatingCoverageAKID, Period_start_date, Period_end_date, AnyARDIndicator, ExperienceRated, TermType, StateProvinceCode, pol_eff_date, pol_exp_date, pol_cancellation_date, pol_cancellation_ind, InterstateRiskId, pol_id, fed_tax_id, pol_term, pol_ak_id, InsuranceSegmentAbbreviation, cust_role, name, addr_line_1, city_name, state_prov_code, zip_postal_code, ClassCode, WrittenExposure, DeductibleAmount, InsuranceLine, PolicyPremiumTotal, ManualPremiumInd, PolicyStateManualPremiumTotal, BalMinPremiumTotal, ReasonAmendedCode, StrategicProfitCenterAbbreviation, pol_status_code, PremiumTransactionEnteredDate, OffsetOnsetCode, RunMonthAuditTransFlag3 AS RunMonthAuditTransFlag1, AgeOfPolicy3 AS AgeOfPolicy1, RateEffectiveDate, PremiumTransactionEffectiveDate3 AS PremiumTransactionEffectiveDate1, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode\n\tFROM EXP_Premium_DCT\n\tUNION\n\tSELECT SourceSystem, PremiumMasterCalculationID, PremiumMasterRunDate, StateRatingEffectiveDate, WCRetrospectiveRatingIndicator, ExperienceModificationFactor, ExperienceModificationEffectiveDate, PremiumMasterPremium, BaseRate, TypeBureauCode, pol_sym, pol_num, pol_mod, pol_key, CoverageType, PremiumTransactionCode, CoverageGUID, RatingCoverageAKID, Period_start_date, Period_end_date, AnyARDIndicator, ExperienceRated, TermType, StateProvinceCode, pol_eff_date, pol_exp_date, pol_cancellation_date, pol_cancellation_ind, InterstateRiskId, pol_id, fed_tax_id, pol_term, pol_ak_id, InsuranceSegmentAbbreviation, cust_role, name, addr_line_1, city_name, state_prov_code, zip_postal_code, ClassCode, WrittenExposure, DeductibleAmount, InsuranceLine, PolicyPremiumTotal, ManualPremiumInd, PolicyStateManualPremiumTotal, BalMinPremiumTotal, ReasonAmendedCode, StrategicProfitCenterAbbreviation, pol_status_code, PremiumTransactionEnteredDate, OffsetOnsetCode, RunMonthAuditTransFlag1, AgeOfPolicy1, RateEffectiveDate, PremiumTransactionEffectiveDate1, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode\n\tFROM EXP_Premium_PMS\n),\nEXP_State AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tWrittenExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tPolicyPremiumTotal,\n\tManualPremiumInd,\n\tPolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag1,\n\tAgeOfPolicy1,\n\tRateEffectiveDate,\n\tPremiumTransactionEffectiveDate1,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM Union_\n),\nSRT_State_Detail AS (\n\tSELECT\n\tSourceSystem, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tpol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\tWrittenExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tRunMonthAuditTransFlag1, \n\tAgeOfPolicy1, \n\tRateEffectiveDate, \n\tPremiumTransactionEffectiveDate1, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM EXP_State\n\tORDER BY pol_key ASC, StateProvinceCode ASC\n),\nFIL_State AS (\n\tSELECT\n\tSourceSystem, \n\tpol_key, \n\tPremiumTransactionCode, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tClassCode, \n\tPremiumTransactionEffectiveDate1\n\tFROM EXP_State\n\tWHERE ClassCode<>'0174' and SourceSystem='DCT'\n),\nSRT_State AS (\n\tSELECT\n\tSourceSystem, \n\tpol_key, \n\tStateProvinceCode, \n\tPremiumTransactionCode, \n\tpol_eff_date, \n\tClassCode, \n\tPremiumTransactionEffectiveDate1\n\tFROM FIL_State\n\tORDER BY pol_key DESC, StateProvinceCode DESC, pol_eff_date DESC, PremiumTransactionEffectiveDate1 DESC\n),\nAGG_State AS (\n\tSELECT\n\tSourceSystem,\n\tpol_key,\n\tStateProvinceCode,\n\tPremiumTransactionCode,\n\t-- *INF*: LAST(PremiumTransactionCode)\n\tLAST(PremiumTransactionCode) AS o_PremiumTransactionCode,\n\tpol_eff_date,\n\tClassCode,\n\tPremiumTransactionEffectiveDate1,\n\t-- *INF*: MIN(PremiumTransactionEffectiveDate1)\n\tMIN(PremiumTransactionEffectiveDate1) AS o_PremiumTransactionEffectiveDate\n\tFROM SRT_State\n\tGROUP BY pol_key, StateProvinceCode, pol_eff_date\n),\nFIL_Transactions AS (\n\tSELECT\n\tStateProvinceCode, \n\tpol_key, \n\tPremiumTransactionCode, \n\to_PremiumTransactionCode, \n\tpol_eff_date, \n\tClassCode, \n\to_PremiumTransactionEffectiveDate\n\tFROM AGG_State\n\tWHERE pol_eff_date<>o_PremiumTransactionEffectiveDate and o_PremiumTransactionCode='Endorse'\n),\nSRT_State_master AS (\n\tSELECT\n\tpol_key, \n\tStateProvinceCode, \n\tPremiumTransactionCode, \n\to_PremiumTransactionCode, \n\tpol_eff_date, \n\tClassCode, \n\to_PremiumTransactionEffectiveDate\n\tFROM FIL_Transactions\n\tORDER BY pol_key ASC, StateProvinceCode ASC\n),\nJNR_State AS (SELECT\n\tSRT_State_Detail.SourceSystem, \n\tSRT_State_Detail.PremiumMasterCalculationID, \n\tSRT_State_Detail.PremiumMasterRunDate, \n\tSRT_State_Detail.StateRatingEffectiveDate, \n\tSRT_State_Detail.WCRetrospectiveRatingIndicator, \n\tSRT_State_Detail.ExperienceModificationFactor, \n\tSRT_State_Detail.ExperienceModificationEffectiveDate, \n\tSRT_State_Detail.PremiumMasterPremium, \n\tSRT_State_Detail.BaseRate, \n\tSRT_State_Detail.TypeBureauCode, \n\tSRT_State_Detail.pol_sym, \n\tSRT_State_Detail.pol_num, \n\tSRT_State_Detail.pol_mod, \n\tSRT_State_Detail.pol_key, \n\tSRT_State_Detail.CoverageType, \n\tSRT_State_Detail.PremiumTransactionCode, \n\tSRT_State_Detail.CoverageGUID, \n\tSRT_State_Detail.RatingCoverageAKID, \n\tSRT_State_Detail.Period_start_date, \n\tSRT_State_Detail.Period_end_date, \n\tSRT_State_Detail.AnyARDIndicator, \n\tSRT_State_Detail.ExperienceRated, \n\tSRT_State_Detail.TermType, \n\tSRT_State_Detail.StateProvinceCode, \n\tSRT_State_Detail.pol_eff_date, \n\tSRT_State_Detail.pol_exp_date, \n\tSRT_State_Detail.pol_cancellation_date, \n\tSRT_State_Detail.pol_cancellation_ind, \n\tSRT_State_Detail.InterstateRiskId, \n\tSRT_State_Detail.pol_id, \n\tSRT_State_Detail.fed_tax_id, \n\tSRT_State_Detail.pol_term, \n\tSRT_State_Detail.pol_ak_id, \n\tSRT_State_Detail.InsuranceSegmentAbbreviation, \n\tSRT_State_Detail.cust_role, \n\tSRT_State_Detail.name, \n\tSRT_State_Detail.addr_line_1, \n\tSRT_State_Detail.city_name, \n\tSRT_State_Detail.state_prov_code, \n\tSRT_State_Detail.zip_postal_code, \n\tSRT_State_Detail.ClassCode, \n\tSRT_State_Detail.WrittenExposure, \n\tSRT_State_Detail.DeductibleAmount, \n\tSRT_State_Detail.InsuranceLine, \n\tSRT_State_Detail.PolicyPremiumTotal, \n\tSRT_State_Detail.ManualPremiumInd, \n\tSRT_State_Detail.PolicyStateManualPremiumTotal, \n\tSRT_State_Detail.BalMinPremiumTotal, \n\tSRT_State_Detail.ReasonAmendedCode, \n\tSRT_State_Detail.StrategicProfitCenterAbbreviation, \n\tSRT_State_Detail.pol_status_code, \n\tSRT_State_Detail.PremiumTransactionEnteredDate, \n\tSRT_State_Detail.OffsetOnsetCode, \n\tSRT_State_Detail.RunMonthAuditTransFlag1, \n\tSRT_State_Detail.AgeOfPolicy1, \n\tSRT_State_Detail.RateEffectiveDate, \n\tSRT_State_Detail.PremiumTransactionEffectiveDate1, \n\tSRT_State_master.pol_key AS pol_key1, \n\tSRT_State_master.StateProvinceCode AS StateProvinceCode1, \n\tSRT_State_master.pol_eff_date AS pol_eff_date1, \n\tSRT_State_master.o_PremiumTransactionEffectiveDate, \n\tSRT_State_Detail.LossesSubjectToDeductibleCode, \n\tSRT_State_Detail.BasisOfDeductibleCalculationCode\n\tFROM SRT_State_Detail\n\tLEFT OUTER JOIN SRT_State_master\n\tON SRT_State_master.pol_key = SRT_State_Detail.pol_key AND SRT_State_master.StateProvinceCode = SRT_State_Detail.StateProvinceCode\n),\nEXPTRANS AS (\n\tSELECT\n\tSourceSystem,\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\to_PremiumTransactionEffectiveDate AS PremiumTransactionEffectiveDate1,\n\tStateRatingEffectiveDate AS i_StateRatingEffectiveDate,\n\t-- *INF*: IIF(ISNULL(PremiumTransactionEffectiveDate1),i_StateRatingEffectiveDate,PremiumTransactionEffectiveDate1)\n\tIFF(\n\t    PremiumTransactionEffectiveDate1 IS NULL, i_StateRatingEffectiveDate,\n\t    PremiumTransactionEffectiveDate1\n\t) AS o_StateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tPremiumMasterPremium,\n\tBaseRate AS i_BaseRate,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- SourceSystem='DCT' AND StateProvinceCode='48' AND ClassCode='9046',1-i_BaseRate,\r\n\t-- SourceSystem='DCT' AND StateProvinceCode<>'48' AND ClassCode='9046',0,i_BaseRate)\n\tDECODE(\n\t    TRUE,\n\t    SourceSystem = 'DCT' AND StateProvinceCode = '48' AND ClassCode = '9046', 1 - i_BaseRate,\n\t    SourceSystem = 'DCT' AND StateProvinceCode <> '48' AND ClassCode = '9046', 0,\n\t    i_BaseRate\n\t) AS v_BaseRate,\n\t-- *INF*: DECODE(TRUE, \r\n\t-- SourceSystem='DCT' AND ClassCode='9046',ROUND(v_BaseRate,3),\r\n\t-- SUBSTR(ClassCode,1,4)='7709', 0,v_BaseRate)\n\tDECODE(\n\t    TRUE,\n\t    SourceSystem = 'DCT' AND ClassCode = '9046', ROUND(v_BaseRate, 3),\n\t    SUBSTR(ClassCode, 1, 4) = '7709', 0,\n\t    v_BaseRate\n\t) AS o_BaseRate,\n\tTypeBureauCode,\n\tpol_sym,\n\tpol_num,\n\tpol_mod,\n\tpol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tClassCode,\n\tWrittenExposure,\n\t-- *INF*: IIF(SUBSTR(ClassCode,1,4)='7709',0,WrittenExposure)\n\tIFF(SUBSTR(ClassCode, 1, 4) = '7709', 0, WrittenExposure) AS o_Exposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tPolicyPremiumTotal,\n\tManualPremiumInd,\n\tPolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tRunMonthAuditTransFlag1,\n\tAgeOfPolicy1,\n\tRateEffectiveDate,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM JNR_State\n),\nsort_PTID AS (\n\tSELECT\n\tpol_key AS Pol_key, \n\tPeriod_start_date, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterCalculationID, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType\n\tFROM EXPTRANS\n\tORDER BY Pol_key ASC, Period_start_date ASC, ExperienceModificationEffectiveDate ASC, PremiumMasterCalculationID ASC\n),\nagg_latest_indicators AS (\n\tSELECT\n\tPol_key,\n\tPremiumMasterCalculationID,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType\n\tFROM sort_PTID\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY Pol_key ORDER BY NULL) = 1\n),\nsort_pol_key AS (\n\tSELECT\n\tPol_key, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tTermType\n\tFROM agg_latest_indicators\n\tORDER BY Pol_key ASC\n),\nsort_pol_key_to_join AS (\n\tSELECT\n\tworkWcStatPremiumSourceID, \n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\to_StateRatingEffectiveDate AS StateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\to_BaseRate AS BaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tClassCode, \n\to_Exposure AS Exposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tRateEffectiveDate, \n\tSourceSystem, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tpol_key AS Pol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tRunMonthAuditTransFlag1 AS RunMonthAuditTransFlag, \n\tAgeOfPolicy1 AS AgeOfPolicy, \n\tTermType, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM EXPTRANS\n\tORDER BY Pol_key ASC\n),\njoin_indicators AS (SELECT\n\tsort_pol_key_to_join.PremiumMasterCalculationID, \n\tsort_pol_key_to_join.PremiumMasterRunDate, \n\tsort_pol_key_to_join.StateRatingEffectiveDate, \n\tsort_pol_key_to_join.WCRetrospectiveRatingIndicator, \n\tsort_pol_key_to_join.ExperienceModificationFactor, \n\tsort_pol_key_to_join.ExperienceModificationEffectiveDate, \n\tsort_pol_key_to_join.PremiumMasterPremium, \n\tsort_pol_key_to_join.BaseRate, \n\tsort_pol_key_to_join.TypeBureauCode, \n\tsort_pol_key_to_join.pol_sym, \n\tsort_pol_key_to_join.pol_num, \n\tsort_pol_key_to_join.pol_mod, \n\tsort_pol_key_to_join.StateProvinceCode, \n\tsort_pol_key_to_join.pol_eff_date, \n\tsort_pol_key_to_join.pol_exp_date, \n\tsort_pol_key_to_join.pol_cancellation_date, \n\tsort_pol_key_to_join.pol_cancellation_ind, \n\tsort_pol_key_to_join.InterstateRiskId, \n\tsort_pol_key_to_join.pol_id, \n\tsort_pol_key_to_join.fed_tax_id, \n\tsort_pol_key_to_join.pol_term, \n\tsort_pol_key_to_join.pol_ak_id, \n\tsort_pol_key_to_join.InsuranceSegmentAbbreviation, \n\tsort_pol_key_to_join.cust_role, \n\tsort_pol_key_to_join.name, \n\tsort_pol_key_to_join.addr_line_1, \n\tsort_pol_key_to_join.city_name, \n\tsort_pol_key_to_join.state_prov_code, \n\tsort_pol_key_to_join.zip_postal_code, \n\tsort_pol_key_to_join.ClassCode, \n\tsort_pol_key_to_join.Exposure, \n\tsort_pol_key_to_join.DeductibleAmount, \n\tsort_pol_key_to_join.InsuranceLine, \n\tsort_pol_key_to_join.SourceSystem, \n\tsort_pol_key_to_join.ReasonAmendedCode, \n\tsort_pol_key_to_join.StrategicProfitCenterAbbreviation, \n\tsort_pol_key_to_join.pol_status_code, \n\tsort_pol_key_to_join.RunMonthAuditTransFlag, \n\tsort_pol_key_to_join.AgeOfPolicy, \n\tsort_pol_key_to_join.PolicyPremiumTotal, \n\tsort_pol_key_to_join.ManualPremiumInd, \n\tsort_pol_key_to_join.PolicyStateManualPremiumTotal, \n\tsort_pol_key_to_join.BalMinPremiumTotal, \n\tsort_pol_key_to_join.RateEffectiveDate, \n\tsort_pol_key_to_join.PremiumTransactionEnteredDate, \n\tsort_pol_key_to_join.OffsetOnsetCode, \n\tsort_pol_key_to_join.Pol_key, \n\tsort_pol_key_to_join.CoverageType, \n\tsort_pol_key_to_join.PremiumTransactionCode, \n\tsort_pol_key_to_join.CoverageGUID, \n\tsort_pol_key_to_join.RatingCoverageAKID, \n\tsort_pol_key.TermType, \n\tsort_pol_key_to_join.Period_start_date, \n\tsort_pol_key_to_join.Period_end_date, \n\tsort_pol_key.Pol_key AS Pol_key1, \n\tsort_pol_key.AnyARDIndicator, \n\tsort_pol_key.ExperienceRated, \n\tsort_pol_key_to_join.LossesSubjectToDeductibleCode, \n\tsort_pol_key_to_join.BasisOfDeductibleCalculationCode\n\tFROM sort_pol_key_to_join\n\tINNER JOIN sort_pol_key\n\tON sort_pol_key.Pol_key = sort_pol_key_to_join.Pol_key\n),\nsort_CovGUID AS (\n\tSELECT\n\tPremiumMasterCalculationID, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tExperienceModificationFactor, \n\tPol_key, \n\tClassCode, \n\tExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tBaseRate, \n\tTypeBureauCode, \n\tpol_sym, \n\tpol_num, \n\tpol_mod, \n\tStateProvinceCode, \n\tCoverageGUID, \n\tpol_eff_date, \n\tpol_exp_date, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tPremiumMasterRunDate, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tSourceSystem, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tRunMonthAuditTransFlag, \n\tAgeOfPolicy, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tRateEffectiveDate, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tRatingCoverageAKID, \n\tTermType, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM join_indicators\n\tORDER BY Pol_key ASC, ClassCode ASC, TypeBureauCode ASC, StateProvinceCode ASC, CoverageGUID ASC, pol_eff_date ASC, pol_exp_date ASC, PremiumMasterRunDate ASC, PremiumTransactionEnteredDate ASC, OffsetOnsetCode ASC\n),\nFilter_NonDCTandOffsets AS (\n\tSELECT\n\tPol_key, \n\tClassCode, \n\tTypeBureauCode, \n\tStateProvinceCode, \n\tCoverageGUID, \n\tpol_eff_date, \n\tpol_exp_date, \n\tPremiumMasterRunDate, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tBaseRate, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tSourceSystem\n\tFROM sort_CovGUID\n\tWHERE (OffsetOnsetCode!='Offset' OR ISNULL(OffsetOnsetCode)) and SourceSystem='DCT'\n),\nAgg_Exp_mod AS (\n\tSELECT\n\tPol_key,\n\tClassCode,\n\tTypeBureauCode,\n\tStateProvinceCode,\n\tCoverageGUID,\n\tpol_eff_date,\n\tpol_exp_date,\n\tPremiumMasterRunDate,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tBaseRate,\n\tPremiumTransactionEnteredDate\n\tFROM Filter_NonDCTandOffsets\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY Pol_key, ClassCode, TypeBureauCode, StateProvinceCode, CoverageGUID, pol_eff_date, pol_exp_date ORDER BY NULL) = 1\n),\nJoin_Org_Exp_Mod AS (SELECT\n\tsort_CovGUID.PremiumMasterCalculationID, \n\tsort_CovGUID.PremiumMasterRunDate, \n\tsort_CovGUID.StateRatingEffectiveDate, \n\tsort_CovGUID.WCRetrospectiveRatingIndicator, \n\tAgg_Exp_mod.ExperienceModificationFactor AS ExperienceModificationFactor_DCT, \n\tAgg_Exp_mod.ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate_DCT, \n\tsort_CovGUID.PremiumMasterPremium, \n\tsort_CovGUID.TypeBureauCode, \n\tsort_CovGUID.pol_sym, \n\tsort_CovGUID.pol_num, \n\tsort_CovGUID.pol_mod, \n\tsort_CovGUID.StateProvinceCode, \n\tsort_CovGUID.pol_eff_date, \n\tsort_CovGUID.pol_exp_date, \n\tsort_CovGUID.pol_cancellation_date, \n\tsort_CovGUID.pol_cancellation_ind, \n\tsort_CovGUID.InterstateRiskId, \n\tsort_CovGUID.pol_id, \n\tsort_CovGUID.fed_tax_id, \n\tsort_CovGUID.pol_term, \n\tsort_CovGUID.pol_ak_id, \n\tsort_CovGUID.InsuranceSegmentAbbreviation, \n\tsort_CovGUID.cust_role, \n\tsort_CovGUID.name, \n\tsort_CovGUID.addr_line_1, \n\tsort_CovGUID.city_name, \n\tsort_CovGUID.state_prov_code, \n\tsort_CovGUID.zip_postal_code, \n\tsort_CovGUID.ClassCode, \n\tsort_CovGUID.Exposure, \n\tsort_CovGUID.DeductibleAmount, \n\tsort_CovGUID.InsuranceLine, \n\tsort_CovGUID.SourceSystem, \n\tsort_CovGUID.ReasonAmendedCode, \n\tsort_CovGUID.StrategicProfitCenterAbbreviation, \n\tsort_CovGUID.pol_status_code, \n\tsort_CovGUID.RunMonthAuditTransFlag, \n\tsort_CovGUID.AgeOfPolicy, \n\tsort_CovGUID.PolicyPremiumTotal, \n\tsort_CovGUID.ManualPremiumInd, \n\tsort_CovGUID.PolicyStateManualPremiumTotal, \n\tsort_CovGUID.BalMinPremiumTotal, \n\tsort_CovGUID.RateEffectiveDate, \n\tsort_CovGUID.PremiumTransactionEnteredDate, \n\tsort_CovGUID.OffsetOnsetCode, \n\tsort_CovGUID.Pol_key, \n\tsort_CovGUID.CoverageType, \n\tsort_CovGUID.PremiumTransactionCode, \n\tsort_CovGUID.CoverageGUID, \n\tsort_CovGUID.RatingCoverageAKID, \n\tsort_CovGUID.TermType, \n\tsort_CovGUID.Period_start_date, \n\tsort_CovGUID.Period_end_date, \n\tsort_CovGUID.AnyARDIndicator, \n\tsort_CovGUID.ExperienceRated, \n\tAgg_Exp_mod.Pol_key AS Pol_key1, \n\tAgg_Exp_mod.ClassCode AS ClassCode1, \n\tAgg_Exp_mod.CoverageGUID AS CoverageGUID1, \n\tAgg_Exp_mod.BaseRate AS BaseRate_DCT, \n\tAgg_Exp_mod.TypeBureauCode AS TypeBureauCode1, \n\tAgg_Exp_mod.StateProvinceCode AS StateProvinceCode1, \n\tsort_CovGUID.ExperienceModificationFactor AS ExperienceModificationFactor_PMS, \n\tsort_CovGUID.ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate_PMS, \n\tsort_CovGUID.BaseRate AS BaseRate_PMS, \n\tsort_CovGUID.LossesSubjectToDeductibleCode, \n\tsort_CovGUID.BasisOfDeductibleCalculationCode\n\tFROM sort_CovGUID\n\tLEFT OUTER JOIN Agg_Exp_mod\n\tON Agg_Exp_mod.Pol_key = sort_CovGUID.Pol_key AND Agg_Exp_mod.ClassCode = sort_CovGUID.ClassCode AND Agg_Exp_mod.TypeBureauCode = sort_CovGUID.TypeBureauCode AND Agg_Exp_mod.StateProvinceCode = sort_CovGUID.StateProvinceCode AND Agg_Exp_mod.CoverageGUID = sort_CovGUID.CoverageGUID\n),\nExp_BaseRate_ExpMod AS (\n\tSELECT\n\tPremiumMasterCalculationID,\n\tPremiumMasterRunDate,\n\tStateRatingEffectiveDate,\n\tWCRetrospectiveRatingIndicator,\n\tExperienceModificationEffectiveDate_DCT,\n\tPremiumMasterPremium,\n\tBaseRate_DCT,\n\tpol_sym,\n\tPol_key,\n\tTypeBureauCode,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tClassCode,\n\tExperienceModificationFactor_DCT,\n\tpol_num,\n\tpol_mod,\n\tpol_cancellation_date,\n\tpol_cancellation_ind,\n\tInterstateRiskId,\n\tpol_id,\n\tfed_tax_id,\n\tpol_term,\n\tpol_ak_id,\n\tInsuranceSegmentAbbreviation,\n\tcust_role,\n\tname,\n\taddr_line_1,\n\tcity_name,\n\tstate_prov_code,\n\tzip_postal_code,\n\tExposure,\n\tDeductibleAmount,\n\tInsuranceLine,\n\tSourceSystem,\n\tReasonAmendedCode,\n\tStrategicProfitCenterAbbreviation,\n\tpol_status_code,\n\tRunMonthAuditTransFlag,\n\tAgeOfPolicy,\n\tPolicyPremiumTotal,\n\tManualPremiumInd,\n\tPolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tRateEffectiveDate,\n\tPremiumTransactionEnteredDate,\n\tOffsetOnsetCode,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tTermType,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tExperienceModificationFactor_PMS,\n\tExperienceModificationEffectiveDate_PMS,\n\tBaseRate_PMS,\n\t-- *INF*: iif(SourceSystem='DCT',ExperienceModificationFactor_DCT,ExperienceModificationFactor_PMS)\n\tIFF(\n\t    SourceSystem = 'DCT', ExperienceModificationFactor_DCT, ExperienceModificationFactor_PMS\n\t) AS O_ExperienceModificationFactor,\n\t-- *INF*: iif(SourceSystem='DCT',ExperienceModificationEffectiveDate_DCT,ExperienceModificationEffectiveDate_PMS)\n\tIFF(\n\t    SourceSystem = 'DCT', ExperienceModificationEffectiveDate_DCT,\n\t    ExperienceModificationEffectiveDate_PMS\n\t) AS O_ExperienceModificationEffectiveDate,\n\t-- *INF*: iif(SourceSystem='DCT',BaseRate_DCT,BaseRate_PMS)\n\tIFF(SourceSystem = 'DCT', BaseRate_DCT, BaseRate_PMS) AS O_BaseRate,\n\tLossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode\n\tFROM Join_Org_Exp_Mod\n),\nsort_Class_Exp_Mod AS (\n\tSELECT\n\tPremiumMasterCalculationID, \n\tPremiumMasterRunDate, \n\tStateRatingEffectiveDate, \n\tWCRetrospectiveRatingIndicator, \n\tO_ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate, \n\tPremiumMasterPremium, \n\tO_BaseRate AS BaseRate, \n\tpol_sym, \n\tPol_key, \n\tTypeBureauCode, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tClassCode, \n\tO_ExperienceModificationFactor AS ExperienceModificationFactor, \n\tpol_num, \n\tpol_mod, \n\tpol_cancellation_date, \n\tpol_cancellation_ind, \n\tInterstateRiskId, \n\tpol_id, \n\tfed_tax_id, \n\tpol_term, \n\tpol_ak_id, \n\tInsuranceSegmentAbbreviation, \n\tcust_role, \n\tname, \n\taddr_line_1, \n\tcity_name, \n\tstate_prov_code, \n\tzip_postal_code, \n\tExposure, \n\tDeductibleAmount, \n\tInsuranceLine, \n\tSourceSystem, \n\tReasonAmendedCode, \n\tStrategicProfitCenterAbbreviation, \n\tpol_status_code, \n\tRunMonthAuditTransFlag, \n\tAgeOfPolicy, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tRateEffectiveDate, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tTermType, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM Exp_BaseRate_ExpMod\n\tORDER BY Pol_key ASC, TypeBureauCode ASC, StateProvinceCode ASC, pol_eff_date ASC, pol_exp_date ASC, ClassCode ASC, ExperienceModificationFactor ASC\n),\nFil_DCT_data AS (\n\tSELECT\n\tPol_key, \n\tTypeBureauCode, \n\tStateProvinceCode, \n\tpol_eff_date, \n\tpol_exp_date, \n\tClassCode, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate, \n\tSourceSystem\n\tFROM sort_Class_Exp_Mod\n\tWHERE SourceSystem='DCT'\n),\nagg_exp_mod_eff_date AS (\n\tSELECT\n\tPol_key AS Pol_key1,\n\tTypeBureauCode,\n\tStateProvinceCode,\n\tpol_eff_date,\n\tpol_exp_date,\n\tClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\t-- *INF*: min(ExperienceModificationEffectiveDate)\n\tmin(ExperienceModificationEffectiveDate) AS ExperienceModificationEffectiveDate_out\n\tFROM Fil_DCT_data\n\tGROUP BY Pol_key1, TypeBureauCode, StateProvinceCode, pol_eff_date, pol_exp_date, ClassCode, ExperienceModificationFactor\n),\njoin_exp_Mod_eff_date AS (SELECT\n\tsort_Class_Exp_Mod.PremiumMasterCalculationID, \n\tsort_Class_Exp_Mod.PremiumMasterRunDate, \n\tsort_Class_Exp_Mod.StateRatingEffectiveDate, \n\tsort_Class_Exp_Mod.WCRetrospectiveRatingIndicator, \n\tsort_Class_Exp_Mod.ExperienceModificationFactor, \n\tagg_exp_mod_eff_date.ExperienceModificationEffectiveDate_out AS ExperienceModificationEffectiveDate_DCT, \n\tsort_Class_Exp_Mod.PremiumMasterPremium, \n\tsort_Class_Exp_Mod.BaseRate, \n\tsort_Class_Exp_Mod.TypeBureauCode, \n\tsort_Class_Exp_Mod.pol_sym, \n\tsort_Class_Exp_Mod.pol_num, \n\tsort_Class_Exp_Mod.pol_mod, \n\tsort_Class_Exp_Mod.StateProvinceCode, \n\tsort_Class_Exp_Mod.pol_eff_date, \n\tsort_Class_Exp_Mod.pol_exp_date, \n\tsort_Class_Exp_Mod.pol_cancellation_date, \n\tsort_Class_Exp_Mod.pol_cancellation_ind, \n\tsort_Class_Exp_Mod.InterstateRiskId, \n\tsort_Class_Exp_Mod.pol_id, \n\tsort_Class_Exp_Mod.fed_tax_id, \n\tsort_Class_Exp_Mod.pol_term, \n\tsort_Class_Exp_Mod.pol_ak_id, \n\tsort_Class_Exp_Mod.InsuranceSegmentAbbreviation, \n\tsort_Class_Exp_Mod.cust_role, \n\tsort_Class_Exp_Mod.name, \n\tsort_Class_Exp_Mod.addr_line_1, \n\tsort_Class_Exp_Mod.city_name, \n\tsort_Class_Exp_Mod.state_prov_code, \n\tsort_Class_Exp_Mod.zip_postal_code, \n\tsort_Class_Exp_Mod.ClassCode, \n\tsort_Class_Exp_Mod.Exposure, \n\tsort_Class_Exp_Mod.DeductibleAmount, \n\tsort_Class_Exp_Mod.InsuranceLine, \n\tsort_Class_Exp_Mod.SourceSystem, \n\tsort_Class_Exp_Mod.ReasonAmendedCode, \n\tsort_Class_Exp_Mod.StrategicProfitCenterAbbreviation, \n\tsort_Class_Exp_Mod.pol_status_code, \n\tsort_Class_Exp_Mod.RunMonthAuditTransFlag, \n\tsort_Class_Exp_Mod.AgeOfPolicy, \n\tsort_Class_Exp_Mod.PolicyPremiumTotal, \n\tsort_Class_Exp_Mod.ManualPremiumInd, \n\tsort_Class_Exp_Mod.PolicyStateManualPremiumTotal, \n\tsort_Class_Exp_Mod.BalMinPremiumTotal, \n\tsort_Class_Exp_Mod.RateEffectiveDate, \n\tsort_Class_Exp_Mod.PremiumTransactionEnteredDate, \n\tsort_Class_Exp_Mod.OffsetOnsetCode, \n\tsort_Class_Exp_Mod.Pol_key, \n\tsort_Class_Exp_Mod.CoverageType, \n\tsort_Class_Exp_Mod.PremiumTransactionCode, \n\tsort_Class_Exp_Mod.CoverageGUID, \n\tsort_Class_Exp_Mod.RatingCoverageAKID, \n\tsort_Class_Exp_Mod.TermType, \n\tsort_Class_Exp_Mod.Period_start_date, \n\tsort_Class_Exp_Mod.Period_end_date, \n\tsort_Class_Exp_Mod.AnyARDIndicator, \n\tsort_Class_Exp_Mod.ExperienceRated, \n\tagg_exp_mod_eff_date.Pol_key1, \n\tagg_exp_mod_eff_date.TypeBureauCode AS TypeBureauCode1, \n\tagg_exp_mod_eff_date.StateProvinceCode AS StateProvinceCode1, \n\tagg_exp_mod_eff_date.pol_eff_date AS pol_eff_date1, \n\tagg_exp_mod_eff_date.pol_exp_date AS pol_exp_date1, \n\tagg_exp_mod_eff_date.ClassCode AS ClassCode1, \n\tagg_exp_mod_eff_date.ExperienceModificationFactor AS ExperienceModificationFactor1, \n\tsort_Class_Exp_Mod.ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate_PMS, \n\tsort_Class_Exp_Mod.LossesSubjectToDeductibleCode, \n\tsort_Class_Exp_Mod.BasisOfDeductibleCalculationCode\n\tFROM sort_Class_Exp_Mod\n\tLEFT OUTER JOIN agg_exp_mod_eff_date\n\tON agg_exp_mod_eff_date.Pol_key1 = sort_Class_Exp_Mod.Pol_key AND agg_exp_mod_eff_date.TypeBureauCode = sort_Class_Exp_Mod.TypeBureauCode AND agg_exp_mod_eff_date.StateProvinceCode = sort_Class_Exp_Mod.StateProvinceCode AND agg_exp_mod_eff_date.pol_eff_date = sort_Class_Exp_Mod.pol_eff_date AND agg_exp_mod_eff_date.pol_exp_date = sort_Class_Exp_Mod.pol_exp_date AND agg_exp_mod_eff_date.ClassCode = sort_Class_Exp_Mod.ClassCode AND agg_exp_mod_eff_date.ExperienceModificationFactor = sort_Class_Exp_Mod.ExperienceModificationFactor\n),\nLKP_PolicyAudit AS (\n\tSELECT\n\tPolicyAKId,\n\tNoncomplianceofWCPoolAudit,\n\ti_PolicyAKid\n\tFROM (\n\t\tSELECT \n\t\t\tPolicyAKId,\n\t\t\tNoncomplianceofWCPoolAudit,\n\t\t\ti_PolicyAKid\n\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyAudit\n\t\tWHERE CurrentSnapshotFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyAKId ORDER BY PolicyAKId) = 1\n),\nEXP_Premium AS (\n\tSELECT\n\tjoin_exp_Mod_eff_date.PremiumMasterCalculationID AS i_PremiumMasterCalculationID,\n\tjoin_exp_Mod_eff_date.PremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tjoin_exp_Mod_eff_date.StateRatingEffectiveDate AS i_StateRatingEffectiveDate,\n\tjoin_exp_Mod_eff_date.WCRetrospectiveRatingIndicator AS i_WCRetrospectiveRatingIndicator,\n\tjoin_exp_Mod_eff_date.ExperienceModificationFactor AS i_WorkersCompensationExperienceModificationFactor,\n\tjoin_exp_Mod_eff_date.ExperienceModificationEffectiveDate_DCT AS i_WCExperienceModificationEffectiveDate,\n\tjoin_exp_Mod_eff_date.PremiumMasterPremium AS i_PremiumMasterPremium,\n\tjoin_exp_Mod_eff_date.BaseRate AS i_WCBaseRate,\n\tjoin_exp_Mod_eff_date.TypeBureauCode AS i_TypeBureauCode,\n\tjoin_exp_Mod_eff_date.pol_sym AS i_pol_sym,\n\tjoin_exp_Mod_eff_date.pol_num AS i_pol_num,\n\tjoin_exp_Mod_eff_date.pol_mod AS i_pol_mod,\n\tjoin_exp_Mod_eff_date.StateProvinceCode AS i_StateProvinceCode,\n\tjoin_exp_Mod_eff_date.pol_eff_date AS i_pol_eff_date,\n\tjoin_exp_Mod_eff_date.pol_exp_date AS i_pol_exp_date,\n\tjoin_exp_Mod_eff_date.pol_cancellation_date AS i_pol_cancellation_date,\n\tjoin_exp_Mod_eff_date.pol_cancellation_ind AS i_pol_cancellation_ind,\n\tjoin_exp_Mod_eff_date.InterstateRiskId AS i_WCInterStateRiskId,\n\tjoin_exp_Mod_eff_date.pol_id AS i_pol_id,\n\tjoin_exp_Mod_eff_date.fed_tax_id AS i_fed_tax_id,\n\tjoin_exp_Mod_eff_date.pol_term AS i_pol_term,\n\tjoin_exp_Mod_eff_date.pol_ak_id AS i_pol_ak_id,\n\tjoin_exp_Mod_eff_date.InsuranceSegmentAbbreviation AS i_InsuranceSegmentAbbreviation,\n\tjoin_exp_Mod_eff_date.cust_role AS i_cust_role,\n\tjoin_exp_Mod_eff_date.name AS i_name,\n\tjoin_exp_Mod_eff_date.addr_line_1 AS i_addr_line_1,\n\tjoin_exp_Mod_eff_date.city_name AS i_city_name,\n\tjoin_exp_Mod_eff_date.state_prov_code AS i_state_prov_code,\n\tjoin_exp_Mod_eff_date.zip_postal_code AS i_zip_postal_code,\n\tjoin_exp_Mod_eff_date.ClassCode AS i_ClassCode,\n\tjoin_exp_Mod_eff_date.Exposure AS i_Exposure,\n\tjoin_exp_Mod_eff_date.DeductibleAmount AS i_DeductibleAmount,\n\tjoin_exp_Mod_eff_date.InsuranceLine AS i_InsuranceLine,\n\tjoin_exp_Mod_eff_date.SourceSystem AS i_SourceSystem,\n\tjoin_exp_Mod_eff_date.ReasonAmendedCode AS i_ReasonAmendedCode,\n\tjoin_exp_Mod_eff_date.StrategicProfitCenterAbbreviation AS i_StrategicProfitCenterAbbreviation,\n\tjoin_exp_Mod_eff_date.pol_status_code AS i_pol_status_code,\n\tLKP_PolicyAudit.NoncomplianceofWCPoolAudit AS i_NoncomplianceofWCPoolAudit,\n\t-- *INF*: RTRIM(LTRIM(i_DeductibleAmount))\n\tRTRIM(LTRIM(i_DeductibleAmount)) AS v_DeductibleAmount,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_addr_line_1))='N/A', '', LTRIM(RTRIM(i_addr_line_1)))\n\tIFF(LTRIM(RTRIM(i_addr_line_1)) = 'N/A', '', LTRIM(RTRIM(i_addr_line_1))) AS v_addr_line_1,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_city_name))='N/A', '', LTRIM(RTRIM(i_city_name)))\n\tIFF(LTRIM(RTRIM(i_city_name)) = 'N/A', '', LTRIM(RTRIM(i_city_name))) AS v_city_name,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_state_prov_code))='N/A', '', LTRIM(RTRIM(i_state_prov_code)))\n\tIFF(LTRIM(RTRIM(i_state_prov_code)) = 'N/A', '', LTRIM(RTRIM(i_state_prov_code))) AS v_state_prov_code,\n\ti_StateProvinceCode AS v_StateProvinceCode,\n\t-- *INF*: IIF(LTRIM(RTRIM(i_zip_postal_code))='N/A', '', LTRIM(RTRIM(i_zip_postal_code)))\n\tIFF(LTRIM(RTRIM(i_zip_postal_code)) = 'N/A', '', LTRIM(RTRIM(i_zip_postal_code))) AS v_zip_postal_code,\n\ti_pol_sym || i_pol_num || i_pol_mod AS v_PolicyKey,\n\t-- *INF*: :LKP.LKP_AUDITSCHEDULE(v_PolicyKey, i_InsuranceLine, i_pol_eff_date)\n\tLKP_AUDITSCHEDULE_v_PolicyKey_i_InsuranceLine_i_pol_eff_date.AuditStatus AS v_AuditStatus,\n\t-- *INF*: IIF(i_NoncomplianceofWCPoolAudit = 'T','U',DECODE(TRUE,\r\n\t--   UPPER(i_ReasonAmendedCode) = 'ESTIMATED',\r\n\t--     DECODE(TRUE,\r\n\t--       (IN(i_StateProvinceCode, '21', '48') OR UPPER(i_InsuranceSegmentAbbreviation)='POOL'),\r\n\t--         'U',\r\n\t--         'Y'\r\n\t--       ),\r\n\t--   IN(UPPER(i_ReasonAmendedCode),'CANCELLATION','SEEDETAIL'),\r\n\t--     'N',\r\n\t--   (UPPER(i_StrategicProfitCenterAbbreviation)='ARGENT' AND ISNULL(i_ReasonAmendedCode) AND UPPER(i_InsuranceSegmentAbbreviation)='CL'),\r\n\t--     'Y',\r\n\t--   (UPPER(i_StrategicProfitCenterAbbreviation)='WB - CL' AND ISNULL(i_ReasonAmendedCode) AND UPPER(i_InsuranceSegmentAbbreviation)='POOL' AND IN(i_pol_status_code,'N','C')),\r\n\t--     'Y',\r\n\t--   (UPPER(i_StrategicProfitCenterAbbreviation)='WB - CL' AND ISNULL(i_ReasonAmendedCode) AND UPPER(i_InsuranceSegmentAbbreviation)='CL' AND i_pol_status_code ='N'),\r\n\t--     'Y',\r\n\t--     'N'\r\n\t-- ))\n\tIFF(\n\t    i_NoncomplianceofWCPoolAudit = 'T', 'U',\n\t    DECODE(\n\t        TRUE,\n\t        UPPER(i_ReasonAmendedCode) = 'ESTIMATED', DECODE(\n\t            TRUE,\n\t            (i_StateProvinceCode IN ('21','48')\n\t    or UPPER(i_InsuranceSegmentAbbreviation) = 'POOL'), 'U',\n\t            'Y'\n\t        ),\n\t        UPPER(i_ReasonAmendedCode) IN ('CANCELLATION','SEEDETAIL'), 'N',\n\t        (UPPER(i_StrategicProfitCenterAbbreviation) = 'ARGENT'\n\t    and i_ReasonAmendedCode IS NULL\n\t    and UPPER(i_InsuranceSegmentAbbreviation) = 'CL'), 'Y',\n\t        (UPPER(i_StrategicProfitCenterAbbreviation) = 'WB - CL'\n\t    and i_ReasonAmendedCode IS NULL\n\t    and UPPER(i_InsuranceSegmentAbbreviation) = 'POOL'\n\t    and i_pol_status_code IN ('N','C')), 'Y',\n\t        (UPPER(i_StrategicProfitCenterAbbreviation) = 'WB - CL'\n\t    and i_ReasonAmendedCode IS NULL\n\t    and UPPER(i_InsuranceSegmentAbbreviation) = 'CL'\n\t    and i_pol_status_code = 'N'), 'Y',\n\t        'N'\n\t    )\n\t) AS v_DCT_EstimatedAuditCode,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_MULTISTATEPOLICY(i_pol_ak_id)), '0', '1')\n\tIFF(LKP_MULTISTATEPOLICY_i_pol_ak_id.PolicyAKId IS NULL, '0', '1') AS v_MultistatePolicyIndicator,\n\t-- *INF*: TRUNC(i_pol_eff_date, 'DD')\n\tCAST(TRUNC(i_pol_eff_date, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_PolicyEffectiveDate,\n\t-- *INF*: :LKP.LKP_SUPClassificationWorkersCompensation(i_ClassCode, v_StateProvinceCode,v_PolicyEffectiveDate)\n\tLKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_v_StateProvinceCode_v_PolicyEffectiveDate.SubjecttoExperienceModificationClassIndicator AS v_ExpModZeroByState,\n\t-- *INF*: iif ( not isnull(v_ExpModZeroByState) , substr(v_ExpModZeroByState,1,1) , null)\n\tIFF(v_ExpModZeroByState IS NOT NULL, substr(v_ExpModZeroByState, 1, 1), null) AS v_SubjecttoExperienceModificationClassIndicator_State,\n\t-- *INF*: iif ( not isnull(v_ExpModZeroByState) , substr(v_ExpModZeroByState,2,1) , null)\n\tIFF(v_ExpModZeroByState IS NOT NULL, substr(v_ExpModZeroByState, 2, 1), null) AS v_ExperienceModificationClassIndicator_State,\n\t-- *INF*: Decode( true, (not isnull(v_ExpModZeroByState)  and\r\n\t-- ((v_ExperienceModificationClassIndicator_State = 'N' ) AND (v_SubjecttoExperienceModificationClassIndicator_State =  'N'))) ,'0',\r\n\t-- (not isnull(v_ExpModZeroByState)  and\r\n\t-- ((v_ExperienceModificationClassIndicator_State = 'Y' ) OR  (v_SubjecttoExperienceModificationClassIndicator_State =  'Y'))) ,'1', '2')\r\n\t-- \r\n\t-- -- 0 exp mod not appliable \r\n\t-- --1 exp mod appliable \r\n\t-- --2 no match found for classcode & statecode combination \r\n\t-- \r\n\t-- \n\tDecode(\n\t    true,\n\t    (v_ExpModZeroByState IS NULL and ((v_ExperienceModificationClassIndicator_State = 'N') AND (v_SubjecttoExperienceModificationClassIndicator_State = 'NOT N'))), '0',\n\t    (v_ExpModZeroByState IS NULL and ((v_ExperienceModificationClassIndicator_State = 'Y') OR (v_SubjecttoExperienceModificationClassIndicator_State = 'NOT Y'))), '1',\n\t    '2'\n\t) AS v_ExpModZeroByStateInd,\n\t-- *INF*: :LKP.LKP_SUPClassificationWorkersCompensation(i_ClassCode, '99',v_PolicyEffectiveDate)\r\n\t-- -- second lookup on SupWorkersCompensationPremiumModifierClass table using classcode and default state of '99' for across states\r\n\t-- \n\tLKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_99_v_PolicyEffectiveDate.SubjecttoExperienceModificationClassIndicator AS v_ExpModZeroNonState,\n\t-- *INF*: iif ( not isnull(v_ExpModZeroNonState) , substr(v_ExpModZeroNonState,1,1) , null)\n\tIFF(v_ExpModZeroNonState IS NOT NULL, substr(v_ExpModZeroNonState, 1, 1), null) AS v_SubjecttoExperienceModificationClassIndicator_NonState,\n\t-- *INF*: iif (not isnull(v_ExpModZeroNonState) , substr(v_ExpModZeroNonState,2,1) , null)\n\tIFF(v_ExpModZeroNonState IS NOT NULL, substr(v_ExpModZeroNonState, 2, 1), null) AS v_ExperienceModificationClassIndicator_NonState,\n\t-- *INF*: Decode( true,\r\n\t--  (not isnull(v_ExpModZeroNonState)  and\r\n\t-- ((v_ExperienceModificationClassIndicator_NonState = 'N' ) AND (v_SubjecttoExperienceModificationClassIndicator_NonState =  'N'))) ,'0',\r\n\t-- (not isnull(v_ExpModZeroNonState)  and\r\n\t-- ((v_ExperienceModificationClassIndicator_NonState = 'Y' ) OR  (v_SubjecttoExperienceModificationClassIndicator_NonState =  'Y'))) ,'1',\r\n\t--  '2')\r\n\t-- \r\n\t-- \r\n\t-- -- 0 exp mod not appliable \r\n\t-- --1 exp mod appliable \r\n\t-- --2 no match found for classcode & statecode combination \r\n\t-- \n\tDecode(\n\t    true,\n\t    (v_ExpModZeroNonState IS NULL and ((v_ExperienceModificationClassIndicator_NonState = 'N') AND (v_SubjecttoExperienceModificationClassIndicator_NonState = 'NOT N'))), '0',\n\t    (v_ExpModZeroNonState IS NULL and ((v_ExperienceModificationClassIndicator_NonState = 'Y') OR (v_SubjecttoExperienceModificationClassIndicator_NonState = 'NOT Y'))), '1',\n\t    '2'\n\t) AS v_ExpModZeroNonStateInd,\n\t-- *INF*: --existing\r\n\t-- --DECODE(TRUE,(v_ExpModZeroByStateInd = '1'  OR v_ExpModZeroNonStateInd = '1'), '1', '0')\r\n\t-- \r\n\t-- \r\n\t-- DECODE(TRUE,v_ExpModZeroByStateInd = '1' , '1',  --found & exp mod apply \r\n\t--  (v_ExpModZeroByStateInd = '2'  and  v_ExpModZeroNonStateInd = '1') , '1', --not found in lookup for state & but found in lookup for default state,\r\n\t-- '0')\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- -- 0 exp mod not appliable \r\n\t-- --1 exp mod appliable \r\n\t-- --2 no match found for classcode & statecode combination \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    v_ExpModZeroByStateInd = '1', '1',\n\t    (v_ExpModZeroByStateInd = '2' and v_ExpModZeroNonStateInd = '1'), '1',\n\t    '0'\n\t) AS v_ExpModZeroPerClassInd,\n\ti_SourceSystem AS o_SourceSystemId,\n\ti_PremiumMasterCalculationID AS o_PremiumMasterCalculationID,\n\t-- *INF*: RTRIM(LTRIM(i_TypeBureauCode))\n\tRTRIM(LTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: TRUNC(i_PremiumMasterRunDate, 'DD')\n\tCAST(TRUNC(i_PremiumMasterRunDate, 'DAY') AS TIMESTAMP_NTZ(0)) AS o_PremiumMasterRunDate,\n\t-- *INF*: TO_DATE('1800-01-01', 'YYYY-MM-DD')\n\tTO_TIMESTAMP('1800-01-01', 'YYYY-MM-DD') AS o_LossMasterRunDate,\n\t'17124' AS o_BureauCompanyCode,\n\t-- *INF*: RTRIM(LTRIM(i_pol_sym || i_pol_num || i_pol_mod))\n\tRTRIM(LTRIM(i_pol_sym || i_pol_num || i_pol_mod)) AS o_PolicyKey,\n\t-- *INF*: RTRIM(LTRIM(i_StateProvinceCode))\n\tRTRIM(LTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\tv_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: IIF(i_pol_cancellation_ind='Y' AND i_pol_cancellation_date  != TO_DATE('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'), TRUNC(i_pol_cancellation_date, 'DD'), TRUNC(i_pol_exp_date,'DD'))\n\tIFF(\n\t    i_pol_cancellation_ind = 'Y'\n\t    and i_pol_cancellation_date != TO_TIMESTAMP('2100-12-31 23:59:59', 'YYYY-MM-DD HH24:MI:SS'),\n\t    CAST(TRUNC(i_pol_cancellation_date, 'DAY') AS TIMESTAMP_NTZ(0)),\n\t    CAST(TRUNC(i_pol_exp_date, 'DAY') AS TIMESTAMP_NTZ(0))\n\t) AS o_PolicyEndDate,\n\t-- *INF*: IIF(ISNULL(i_WCInterStateRiskId),'N/A', RTRIM(LTRIM(TO_CHAR(i_WCInterStateRiskId))))\r\n\t-- --IIF(ISNULL(i_WCInterStateRiskId), LPAD('', 9, '0'), RTRIM(LTRIM(TO_CHAR(i_WCInterStateRiskId))))\n\tIFF(i_WCInterStateRiskId IS NULL, 'N/A', RTRIM(LTRIM(TO_CHAR(i_WCInterStateRiskId)))) AS o_InterstateRiskId,\n\t-- *INF*: --Removed lookup as part of PROD-6820 and PROD-13914/12901/13877\r\n\t-- -- As per historic data, it was never used as this form was on none of the policies\r\n\t-- --IIF( NOT ISNULL(:LKP.LKP_POLICYFORM_FORM(i_pol_id, 'WC000316')), 'E', '')\r\n\t-- ''\n\t'' AS o_EmployeeLeasingCode,\n\t-- *INF*: IIF(ISNULL(i_StateRatingEffectiveDate), TO_DATE('1800-01-01', 'YYYY-MM-DD'), TRUNC(i_StateRatingEffectiveDate, 'DD'))\n\tIFF(\n\t    i_StateRatingEffectiveDate IS NULL, TO_TIMESTAMP('1800-01-01', 'YYYY-MM-DD'),\n\t    CAST(TRUNC(i_StateRatingEffectiveDate, 'DAY') AS TIMESTAMP_NTZ(0))\n\t) AS o_StateRatingEffectiveDate,\n\t-- *INF*: IIF(i_fed_tax_id='N/A', LPAD('',10, ' '),LPAD(SUBSTR(i_fed_tax_id, 1, 10), 10, '0'))\n\tIFF(i_fed_tax_id = 'N/A', LPAD('', 10, ' '), LPAD(SUBSTR(i_fed_tax_id, 1, 10), 10, '0')) AS o_FederalTaxId,\n\t-- *INF*: IIF(LTRIM(i_pol_term,'0')='36', '1', '0')\n\tIFF(LTRIM(i_pol_term, '0') = '36', '1', '0') AS o_ThreeYearFixedRatePolicyIndicator,\n\tv_MultistatePolicyIndicator AS o_MultistatePolicyIndicator,\n\t-- *INF*: IIF(i_StateProvinceCode='21', 0,\r\n\t--      IIF(LENGTH(i_WCInterStateRiskId)=9,1,0))\r\n\t-- \r\n\t-- --IIF(ISNULL(i_WCInterStateRiskId) OR i_WCInterStateRiskId='-1' OR i_WCInterStateRiskId='N/A' , '0', '1')\n\tIFF(\n\t    i_StateProvinceCode = '21', 0,\n\t    IFF(\n\t        LENGTH(i_WCInterStateRiskId) = 9, 1, 0\n\t    )\n\t) AS o_InterstateRatedPolicyIndicator,\n\t-- *INF*: IIF(i_WCRetrospectiveRatingIndicator='1','1','0')\n\tIFF(i_WCRetrospectiveRatingIndicator = '1', '1', '0') AS o_RetrospectiveRatedPolicyIndicator,\n\t-- *INF*: IIF(i_pol_cancellation_date   >=   i_pol_eff_date  AND  i_pol_cancellation_date  <=  i_pol_exp_date, '1', '0')\n\tIFF(\n\t    i_pol_cancellation_date >= i_pol_eff_date AND i_pol_cancellation_date <= i_pol_exp_date, '1',\n\t    '0'\n\t) AS o_CancelledMidTermPolicyIndicator,\n\t-- *INF*: IIF(IN(i_StateProvinceCode, '22', '21'), '0', '1')\n\tIFF(i_StateProvinceCode IN ('22','21'), '0', '1') AS o_ManagedCareOrganizationPolicyIndicator,\n\t-- *INF*: IIF(i_WCRetrospectiveRatingIndicator='1' and i_StateProvinceCode='48' ,'05','01')\r\n\t-- \r\n\t-- \r\n\t-- --IIF(i_WCRetrospectiveRatingIndicator='1','05','01')\n\tIFF(i_WCRetrospectiveRatingIndicator = '1' and i_StateProvinceCode = '48', '05', '01') AS o_TypeOfCoverageIdCode,\n\t-- *INF*: IIF(i_InsuranceSegmentAbbreviation='Pool', '02', '01')\n\tIFF(i_InsuranceSegmentAbbreviation = 'Pool', '02', '01') AS o_TypeOfPlan,\n\t-- *INF*: IIF(ISNULL(v_DeductibleAmount) OR v_DeductibleAmount='N/A','0',v_DeductibleAmount)\n\tIFF(v_DeductibleAmount IS NULL OR v_DeductibleAmount = 'N/A', '0', v_DeductibleAmount) AS o_DeductibleAmountPerClaimAccident,\n\t-- *INF*: IIF(UPPER(i_cust_role)='INSURED', RTRIM(LTRIM(i_name)), 'N/A')\n\tIFF(UPPER(i_cust_role) = 'INSURED', RTRIM(LTRIM(i_name)), 'N/A') AS o_InsuredName,\n\t-- *INF*: substr(v_addr_line_1 || ' ' || v_city_name || ' ,' || v_state_prov_code || ' ' || v_zip_postal_code,1,500)\n\tsubstr(v_addr_line_1 || ' ' || v_city_name || ' ,' || v_state_prov_code || ' ' || v_zip_postal_code, 1, 500) AS o_WCSTATAddress,\n\t-- *INF*: IIF(IN(LTRIM(RTRIM(i_ClassCode)),'','N/A'), '',SUBSTR(LTRIM(RTRIM(i_ClassCode)),1,6))\n\tIFF(LTRIM(RTRIM(i_ClassCode)) IN ('','N/A'), '', SUBSTR(LTRIM(RTRIM(i_ClassCode)), 1, 6)) AS o_PremiumMasterClassCode,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_WorkersCompensationExperienceModificationFactor) or :LKP.LKP_EXPMODTOTALPREMIUMAMOUNT(v_PolicyKey)=0,0,\r\n\t-- v_ExpModZeroPerClassInd = '1',i_WorkersCompensationExperienceModificationFactor,\r\n\t-- 0)\r\n\t-- -- default to zero for nulls or if disqualified by virtue of lookup on SupWorkersCompensationPremiumModifierClass\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    i_WorkersCompensationExperienceModificationFactor IS NULL or LKP_EXPMODTOTALPREMIUMAMOUNT_v_PolicyKey.TotalPremiumTransactionAmount = 0, 0,\n\t    v_ExpModZeroPerClassInd = '1', i_WorkersCompensationExperienceModificationFactor,\n\t    0\n\t) AS v_ExperienceModificationFactor,\n\t-- *INF*: RTRIM(LTRIM(i_pol_sym || i_pol_num || i_pol_mod))\n\tRTRIM(LTRIM(i_pol_sym || i_pol_num || i_pol_mod)) AS v_ExpModPolKey,\n\t-- *INF*: :LKP.LKP_EXPMODTOTALPREMIUMAMOUNT(v_ExpModPolKey)\n\tLKP_EXPMODTOTALPREMIUMAMOUNT_v_ExpModPolKey.TotalPremiumTransactionAmount AS v_ExpModTotalPremiumAmt,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_WorkersCompensationExperienceModificationFactor) or v_ExpModTotalPremiumAmt = 0,0,\r\n\t-- v_ExpModZeroPerClassInd = '1',i_WorkersCompensationExperienceModificationFactor,\r\n\t-- 0)\n\tDECODE(\n\t    TRUE,\n\t    i_WorkersCompensationExperienceModificationFactor IS NULL or v_ExpModTotalPremiumAmt = 0, 0,\n\t    v_ExpModZeroPerClassInd = '1', i_WorkersCompensationExperienceModificationFactor,\n\t    0\n\t) AS o_ExperienceModificationFactor,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- i_SourceSystem = 'DCT PT',i_WCExperienceModificationEffectiveDate,\r\n\t-- ISNULL(V_ExperienceModificationEffectiveDate), TO_DATE('2100-12-31', 'YYYY-MM-DD'), \r\n\t-- v_ExperienceModificationFactor = 0,TO_DATE('2100-12-31', 'YYYY-MM-DD'), \r\n\t-- v_ExpModTotalPremiumAmt = 0,TO_DATE('2100-12-31', 'YYYY-MM-DD'), \r\n\t-- TRUNC(V_ExperienceModificationEffectiveDate, 'DD'))\r\n\t-- -- default to '01-01-1800 for null dates but override to 12-31-2100 for exp mod factor value of zero if determined or naturally present\n\tDECODE(\n\t    TRUE,\n\t    i_SourceSystem = 'DCT PT', i_WCExperienceModificationEffectiveDate,\n\t    V_ExperienceModificationEffectiveDate IS NULL, TO_TIMESTAMP('2100-12-31', 'YYYY-MM-DD'),\n\t    v_ExperienceModificationFactor = 0, TO_TIMESTAMP('2100-12-31', 'YYYY-MM-DD'),\n\t    v_ExpModTotalPremiumAmt = 0, TO_TIMESTAMP('2100-12-31', 'YYYY-MM-DD'),\n\t    CAST(TRUNC(V_ExperienceModificationEffectiveDate, 'DAY') AS TIMESTAMP_NTZ(0))\n\t) AS o_ExperienceModificationEffectiveDate,\n\ti_Exposure AS o_Exposure,\n\ti_PremiumMasterPremium AS o_PremiumMasterDirectWrittenPremiumAmount,\n\t-- *INF*: IIF(ISNULL(i_WCBaseRate), 0, i_WCBaseRate)\n\tIFF(i_WCBaseRate IS NULL, 0, i_WCBaseRate) AS o_ManualChargedRate,\n\tv_AuditStatus AS o_AuditStatus,\n\t-- *INF*: DECODE(TRUE,\r\n\t--  IN(UPPER(v_AuditStatus), 'BYPASSED', 'REVERSED', 'OVERDUE'),\r\n\t-- 'Y',\r\n\t-- IN(i_StateProvinceCode, '21', '48') AND UPPER(v_AuditStatus)='ESTIMATED',\r\n\t-- 'U',\r\n\t-- 'N'\r\n\t--  )\n\tDECODE(\n\t    TRUE,\n\t    UPPER(v_AuditStatus) IN ('BYPASSED','REVERSED','OVERDUE'), 'Y',\n\t    i_StateProvinceCode IN ('21','48') AND UPPER(v_AuditStatus) = 'ESTIMATED', 'U',\n\t    'N'\n\t) AS v_PMS_EstimatedAuditCode,\n\t-- *INF*: IIF(i_SourceSystem='DCT',v_DCT_EstimatedAuditCode, v_PMS_EstimatedAuditCode)\n\tIFF(i_SourceSystem = 'DCT', v_DCT_EstimatedAuditCode, v_PMS_EstimatedAuditCode) AS o_EstimatedAuditCode,\n\tjoin_exp_Mod_eff_date.RunMonthAuditTransFlag AS o_RunMonthAuditTransFlag,\n\tjoin_exp_Mod_eff_date.AgeOfPolicy AS o_AgeOfPolicy,\n\tjoin_exp_Mod_eff_date.PolicyPremiumTotal,\n\tjoin_exp_Mod_eff_date.ManualPremiumInd,\n\tjoin_exp_Mod_eff_date.PolicyStateManualPremiumTotal,\n\tjoin_exp_Mod_eff_date.BalMinPremiumTotal,\n\tjoin_exp_Mod_eff_date.RateEffectiveDate,\n\tjoin_exp_Mod_eff_date.PremiumTransactionEnteredDate,\n\tjoin_exp_Mod_eff_date.OffsetOnsetCode,\n\tjoin_exp_Mod_eff_date.Pol_key,\n\tjoin_exp_Mod_eff_date.CoverageType,\n\tjoin_exp_Mod_eff_date.PremiumTransactionCode,\n\tjoin_exp_Mod_eff_date.CoverageGUID,\n\tjoin_exp_Mod_eff_date.RatingCoverageAKID,\n\tjoin_exp_Mod_eff_date.TermType,\n\tjoin_exp_Mod_eff_date.Period_start_date,\n\tjoin_exp_Mod_eff_date.Period_end_date,\n\tjoin_exp_Mod_eff_date.AnyARDIndicator,\n\tjoin_exp_Mod_eff_date.ExperienceRated,\n\tjoin_exp_Mod_eff_date.ExperienceModificationEffectiveDate_PMS,\n\t-- *INF*: iif(i_SourceSystem='DCT',i_WCExperienceModificationEffectiveDate,ExperienceModificationEffectiveDate_PMS)\n\tIFF(\n\t    i_SourceSystem = 'DCT', i_WCExperienceModificationEffectiveDate,\n\t    ExperienceModificationEffectiveDate_PMS\n\t) AS V_ExperienceModificationEffectiveDate,\n\tjoin_exp_Mod_eff_date.LossesSubjectToDeductibleCode,\n\tjoin_exp_Mod_eff_date.BasisOfDeductibleCalculationCode\n\tFROM join_exp_Mod_eff_date\n\tLEFT JOIN LKP_PolicyAudit\n\tON LKP_PolicyAudit.PolicyAKId = join_exp_Mod_eff_date.pol_ak_id\n\tLEFT JOIN LKP_AUDITSCHEDULE LKP_AUDITSCHEDULE_v_PolicyKey_i_InsuranceLine_i_pol_eff_date\n\tON LKP_AUDITSCHEDULE_v_PolicyKey_i_InsuranceLine_i_pol_eff_date.PolicyKey = v_PolicyKey\n\tAND LKP_AUDITSCHEDULE_v_PolicyKey_i_InsuranceLine_i_pol_eff_date.InsuranceLine = i_InsuranceLine\n\tAND LKP_AUDITSCHEDULE_v_PolicyKey_i_InsuranceLine_i_pol_eff_date.AuditEffectiveDate = i_pol_eff_date\n\n\tLEFT JOIN LKP_MULTISTATEPOLICY LKP_MULTISTATEPOLICY_i_pol_ak_id\n\tON LKP_MULTISTATEPOLICY_i_pol_ak_id.PolicyAKId = i_pol_ak_id\n\n\tLEFT JOIN LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_v_StateProvinceCode_v_PolicyEffectiveDate\n\tON LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_v_StateProvinceCode_v_PolicyEffectiveDate.ClassCode = i_ClassCode\n\tAND LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_v_StateProvinceCode_v_PolicyEffectiveDate.RatingStateCode = v_StateProvinceCode\n\tAND LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_v_StateProvinceCode_v_PolicyEffectiveDate.EffectiveDate = v_PolicyEffectiveDate\n\n\tLEFT JOIN LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_99_v_PolicyEffectiveDate\n\tON LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_99_v_PolicyEffectiveDate.ClassCode = i_ClassCode\n\tAND LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_99_v_PolicyEffectiveDate.RatingStateCode = '99'\n\tAND LKP_SUPCLASSIFICATIONWORKERSCOMPENSATION_i_ClassCode_99_v_PolicyEffectiveDate.EffectiveDate = v_PolicyEffectiveDate\n\n\tLEFT JOIN LKP_EXPMODTOTALPREMIUMAMOUNT LKP_EXPMODTOTALPREMIUMAMOUNT_v_PolicyKey\n\tON LKP_EXPMODTOTALPREMIUMAMOUNT_v_PolicyKey.PolicyKey = v_PolicyKey\n\n\tLEFT JOIN LKP_EXPMODTOTALPREMIUMAMOUNT LKP_EXPMODTOTALPREMIUMAMOUNT_v_ExpModPolKey\n\tON LKP_EXPMODTOTALPREMIUMAMOUNT_v_ExpModPolKey.PolicyKey = v_ExpModPolKey\n\n),\nLKP_WorkWCSTATExtract_Premium AS (\n\tSELECT\n\tExposure,\n\tCorrectionSeqNumber,\n\tPolicyKey,\n\tStateProvinceCode,\n\tPremiumMasterClassCode\n\tFROM (\n\t\tSELECT A.Exposure as Exposure, \r\n\t\tA.CorrectionSeqNumber as CorrectionSeqNumber,\r\n\t\tA.PolicyKey as PolicyKey, \r\n\t\tA.StateProvinceCode as StateProvinceCode, \r\n\t\tA.PremiumMasterClassCode as PremiumMasterClassCode \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkWCSTATExtract A\r\n\t\tjoin (\r\n\t\tSELECT max(PremiumMasterRunDate) as PremiumMasterRunDate, \r\n\t\tmax(CorrectionSeqNumber) as CorrectionSeqNumber,\r\n\t\tPolicyKey as PolicyKey, \r\n\t\tStateProvinceCode as StateProvinceCode, \r\n\t\tPremiumMasterClassCode as PremiumMasterClassCode \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkWCSTATExtract\r\n\t\twhere EDWPremiumMasterCalculationPKId<>-1\r\n\t\tgroup by PolicyKey, \r\n\t\tStateProvinceCode, \r\n\t\tPremiumMasterClassCode\r\n\t\t) B\r\n\t\ton A.PolicyKey=B.PolicyKey and A.StateProvinceCode=B.StateProvinceCode and A.PremiumMasterClassCode=B.PremiumMasterClassCode\r\n\t\tand A.PremiumMasterRunDate=B.PremiumMasterRunDate and A.CorrectionSeqNumber=B.CorrectionSeqNumber\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,StateProvinceCode,PremiumMasterClassCode ORDER BY Exposure) = 1\n),\nEXP_GetValueForPremium AS (\n\tSELECT\n\tEXP_Premium.o_SourceSystemId,\n\tLKP_WorkWCSTATExtract_Premium.Exposure AS i_lkp_Exposure,\n\tLKP_WorkWCSTATExtract_Premium.CorrectionSeqNumber AS i_lkp_CorrectionSeqNumber,\n\tEXP_Premium.o_PremiumMasterCalculationID AS EDWPremiumMasterCalculationPKId,\n\t-1 AS EDWLossMasterCalculationPKId,\n\tEXP_Premium.o_TypeBureauCode AS TypeBureauCode,\n\tEXP_Premium.o_PremiumMasterRunDate AS PremiumMasterRunDate,\n\tEXP_Premium.o_LossMasterRunDate AS LossMasterRunDate,\n\tEXP_Premium.o_BureauCompanyCode AS BureauCompanyCode,\n\tEXP_Premium.o_PolicyKey AS PolicyKey,\n\tEXP_Premium.o_StateProvinceCode AS StateProvinceCode,\n\tEXP_Premium.o_PolicyEffectiveDate AS PolicyEffectiveDate,\n\tEXP_Premium.o_PolicyEndDate AS PolicyEndDate,\n\tEXP_Premium.o_InterstateRiskId AS InterstateRiskId,\n\tEXP_Premium.o_EmployeeLeasingCode AS EmployeeLeasingCode,\n\tEXP_Premium.o_StateRatingEffectiveDate AS StateRatingEffectiveDate,\n\tEXP_Premium.o_FederalTaxId AS FederalTaxId,\n\tEXP_Premium.o_ThreeYearFixedRatePolicyIndicator AS ThreeYearFixedRatePolicyIndicator,\n\tEXP_Premium.o_MultistatePolicyIndicator AS MultistatePolicyIndicator,\n\tEXP_Premium.o_InterstateRatedPolicyIndicator AS InterstateRatedPolicyIndicator,\n\tEXP_Premium.o_RetrospectiveRatedPolicyIndicator AS RetrospectiveRatedPolicyIndicator,\n\tEXP_Premium.o_CancelledMidTermPolicyIndicator AS CancelledMidTermPolicyIndicator,\n\tEXP_Premium.o_ManagedCareOrganizationPolicyIndicator AS ManagedCareOrganizationPolicyIndicator,\n\tEXP_Premium.o_TypeOfCoverageIdCode AS TypeOfCoverageIdCode,\n\tEXP_Premium.o_TypeOfPlan AS TypeOfPlan,\n\tEXP_Premium.o_DeductibleAmountPerClaimAccident AS DeductibleAmountPerClaimAccident,\n\tEXP_Premium.o_InsuredName AS InsuredName,\n\tEXP_Premium.o_WCSTATAddress AS WCSTATAddress,\n\tEXP_Premium.o_PremiumMasterClassCode AS PremiumMasterClassCode,\n\tEXP_Premium.o_ExperienceModificationFactor AS ExperienceModificationFactor,\n\tEXP_Premium.o_ExperienceModificationEffectiveDate AS ExperienceModificationEffectiveDate,\n\t-- *INF*: IIF(TermType='ILF' and ExperienceModificationFactor!=0,PolicyEffectiveDate,ExperienceModificationEffectiveDate)\n\tIFF(\n\t    TermType = 'ILF' and ExperienceModificationFactor != 0, PolicyEffectiveDate,\n\t    ExperienceModificationEffectiveDate\n\t) AS ExperienceModificationEffectiveDate_out,\n\tEXP_Premium.o_Exposure AS Exposure,\n\tEXP_Premium.o_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\tEXP_Premium.o_ManualChargedRate AS ManualChargedRate,\n\tEXP_Premium.o_AuditStatus AS AuditStatus,\n\t'N/A' AS o_LossMasterClassCode,\n\t-- *INF*:  TO_DATE('1800-01-01', 'YYYY-MM-DD')\n\tTO_TIMESTAMP('1800-01-01', 'YYYY-MM-DD') AS o_ClaimLossDate,\n\t'N/A' AS o_ClaimNumber,\n\t'N/A' AS o_ClaimOccurrenceStatusCode,\n\t'' AS o_InjuryTypeCode,\n\t'N/A' AS o_CatastropheCode,\n\t0 AS o_IncurredIndemnityAmount,\n\t0 AS o_IncurredMedicalAmount,\n\t'N/A' AS o_CauseOfLoss,\n\t'N/A' AS o_TypeOfRecoveryCode,\n\t'N/A' AS o_JurisdictionStateCode,\n\t'N/A' AS o_BodyPartCode,\n\t'N/A' AS o_NatureOfInjuryCode,\n\t'N/A' AS o_CauseOfInjuryCode,\n\t0 AS o_PaidIndemnityAmount,\n\t0 AS o_PaidMedicalAmount,\n\t0 AS o_DeductibleReimbursementAmount,\n\t0 AS o_PaidAllocatedLossAdjustmentExpenseAmount,\n\t0 AS o_IncurredAllocatedLossAdjustmentExpenseAmount,\n\t'00' AS o_loss_condition,\n\t'00' AS o_TypeOfSettlement,\n\t'N/A' AS o_ManagedCareOrganizationType,\n\t'N' AS o_LumpSumIndicator,\n\tEXP_Premium.o_EstimatedAuditCode AS EstimatedAuditCode,\n\t-- *INF*: IIF(IS_NUMBER(i_lkp_CorrectionSeqNumber), TO_INTEGER(i_lkp_CorrectionSeqNumber), 0)\n\tIFF(\n\t    REGEXP_LIKE(i_lkp_CorrectionSeqNumber, '^[0-9]+$'),\n\t    CAST(i_lkp_CorrectionSeqNumber AS INTEGER),\n\t    0\n\t) AS v_lkp_CorrectionSeqNumber,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(i_lkp_Exposure),\r\n\t-- '',\r\n\t-- i_lkp_Exposure != Exposure AND IN(UPPER(AuditStatus), 'COMPLETED', 'ESTIMATED', 'AMENDED', 'CANCELLED'),\r\n\t-- TO_CHAR(v_lkp_CorrectionSeqNumber+1),\r\n\t-- ''\r\n\t-- )\n\tDECODE(\n\t    TRUE,\n\t    i_lkp_Exposure IS NULL, '',\n\t    i_lkp_Exposure != Exposure AND UPPER(AuditStatus) IN ('COMPLETED','ESTIMATED','AMENDED','CANCELLED'), TO_CHAR(v_lkp_CorrectionSeqNumber + 1),\n\t    ''\n\t) AS o_CorrectionSeqNumber,\n\tEXP_Premium.o_RunMonthAuditTransFlag,\n\tEXP_Premium.o_AgeOfPolicy,\n\tEXP_Premium.PolicyPremiumTotal,\n\tEXP_Premium.ManualPremiumInd,\n\tEXP_Premium.PolicyStateManualPremiumTotal,\n\tEXP_Premium.BalMinPremiumTotal,\n\tEXP_Premium.RateEffectiveDate,\n\t-- *INF*: IIF(TermType='ARD' OR TermType='RED' OR TermType='EMF',RateEffectiveDate,PolicyEffectiveDate)\n\tIFF(\n\t    TermType = 'ARD' OR TermType = 'RED' OR TermType = 'EMF', RateEffectiveDate,\n\t    PolicyEffectiveDate\n\t) AS RateEffectiveDate_out,\n\tEXP_Premium.PremiumTransactionEnteredDate,\n\tEXP_Premium.OffsetOnsetCode,\n\tEXP_Premium.Pol_key,\n\tEXP_Premium.CoverageType,\n\tEXP_Premium.PremiumTransactionCode,\n\tEXP_Premium.CoverageGUID,\n\tEXP_Premium.RatingCoverageAKID,\n\tEXP_Premium.TermType,\n\tEXP_Premium.Period_start_date,\n\tEXP_Premium.Period_end_date,\n\tEXP_Premium.AnyARDIndicator,\n\tEXP_Premium.ExperienceRated,\n\tEXP_Premium.LossesSubjectToDeductibleCode,\n\tEXP_Premium.BasisOfDeductibleCalculationCode\n\tFROM EXP_Premium\n\tLEFT JOIN LKP_WorkWCSTATExtract_Premium\n\tON LKP_WorkWCSTATExtract_Premium.PolicyKey = EXP_Premium.o_PolicyKey AND LKP_WorkWCSTATExtract_Premium.StateProvinceCode = EXP_Premium.o_StateProvinceCode AND LKP_WorkWCSTATExtract_Premium.PremiumMasterClassCode = EXP_Premium.o_PremiumMasterClassCode\n),\nSRT_SortData AS (\n\tSELECT\n\to_SourceSystemId, \n\tTypeBureauCode, \n\tBureauCompanyCode, \n\tPolicyKey, \n\tStateProvinceCode, \n\tPolicyEffectiveDate, \n\tPolicyEndDate, \n\tPremiumMasterClassCode, \n\tExperienceModificationFactor, \n\tExperienceModificationEffectiveDate_out AS ExperienceModificationEffectiveDate, \n\tManualChargedRate, \n\tPremiumMasterRunDate, \n\tPremiumTransactionEnteredDate, \n\tOffsetOnsetCode, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tLossMasterRunDate, \n\tInterstateRiskId, \n\tEmployeeLeasingCode, \n\tStateRatingEffectiveDate, \n\tFederalTaxId, \n\tThreeYearFixedRatePolicyIndicator, \n\tMultistatePolicyIndicator, \n\tInterstateRatedPolicyIndicator, \n\tRetrospectiveRatedPolicyIndicator, \n\tCancelledMidTermPolicyIndicator, \n\tManagedCareOrganizationPolicyIndicator, \n\tTypeOfCoverageIdCode, \n\tTypeOfPlan, \n\tDeductibleAmountPerClaimAccident, \n\tInsuredName, \n\tWCSTATAddress, \n\tExposure, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tAuditStatus, \n\to_LossMasterClassCode, \n\to_ClaimLossDate, \n\to_ClaimNumber, \n\to_ClaimOccurrenceStatusCode, \n\to_InjuryTypeCode, \n\to_CatastropheCode, \n\to_IncurredIndemnityAmount, \n\to_IncurredMedicalAmount, \n\to_CauseOfLoss, \n\to_TypeOfRecoveryCode, \n\to_JurisdictionStateCode, \n\to_BodyPartCode, \n\to_NatureOfInjuryCode, \n\to_CauseOfInjuryCode, \n\to_PaidIndemnityAmount, \n\to_PaidMedicalAmount, \n\to_DeductibleReimbursementAmount, \n\to_PaidAllocatedLossAdjustmentExpenseAmount, \n\to_IncurredAllocatedLossAdjustmentExpenseAmount, \n\to_loss_condition, \n\to_TypeOfSettlement, \n\to_ManagedCareOrganizationType, \n\to_LumpSumIndicator, \n\tEstimatedAuditCode, \n\to_CorrectionSeqNumber, \n\to_RunMonthAuditTransFlag, \n\to_AgeOfPolicy, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tRateEffectiveDate_out AS RateEffectiveDate, \n\tPol_key, \n\tCoverageType, \n\tPremiumTransactionCode, \n\tCoverageGUID, \n\tRatingCoverageAKID, \n\tRunMonthAuditTransFlag, \n\tAgeOfPolicy, \n\tTermType, \n\tPeriod_start_date, \n\tPeriod_end_date, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tLossesSubjectToDeductibleCode, \n\tBasisOfDeductibleCalculationCode\n\tFROM EXP_GetValueForPremium\n\tORDER BY TypeBureauCode ASC, BureauCompanyCode ASC, PolicyKey ASC, StateProvinceCode ASC, PolicyEffectiveDate ASC, PolicyEndDate ASC, PremiumMasterClassCode ASC, ExperienceModificationFactor ASC, ExperienceModificationEffectiveDate ASC, ManualChargedRate ASC, PremiumMasterRunDate ASC, PremiumTransactionEnteredDate ASC, OffsetOnsetCode ASC\n),\nagg_SummarizePremiums AS (\n\tSELECT\n\to_SourceSystemId AS i_SourceSystemId,\n\tTypeBureauCode,\n\tBureauCompanyCode,\n\tPolicyKey,\n\tStateProvinceCode,\n\tPolicyEffectiveDate,\n\tPolicyEndDate,\n\tPremiumMasterClassCode,\n\tExperienceModificationFactor,\n\tExperienceModificationEffectiveDate,\n\tManualChargedRate,\n\tPremiumMasterRunDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tLossMasterRunDate,\n\tInterstateRiskId,\n\tEmployeeLeasingCode,\n\tStateRatingEffectiveDate,\n\tFederalTaxId,\n\tThreeYearFixedRatePolicyIndicator,\n\tMultistatePolicyIndicator,\n\tInterstateRatedPolicyIndicator,\n\tRetrospectiveRatedPolicyIndicator,\n\tCancelledMidTermPolicyIndicator,\n\tManagedCareOrganizationPolicyIndicator,\n\tTypeOfCoverageIdCode,\n\tTypeOfPlan,\n\tDeductibleAmountPerClaimAccident,\n\tInsuredName,\n\tWCSTATAddress,\n\tExposure,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tAuditStatus,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimLossDate AS ClaimLossDate,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimOccurrenceStatusCode AS ClaimOccurrenceStatusCode,\n\to_InjuryTypeCode AS InjuryTypeCode,\n\to_CatastropheCode AS CatastropheCode,\n\to_IncurredIndemnityAmount AS IncurredIndemnityAmount,\n\to_IncurredMedicalAmount AS IncurredMedicalAmount,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_TypeOfRecoveryCode AS TypeOfRecoveryCode,\n\to_JurisdictionStateCode AS JurisdictionStateCode,\n\to_BodyPartCode AS BodyPartCode,\n\to_NatureOfInjuryCode AS NatureOfInjuryCode,\n\to_CauseOfInjuryCode AS CauseOfInjuryCode,\n\to_PaidIndemnityAmount AS PaidIndemnityAmount,\n\to_PaidMedicalAmount AS PaidMedicalAmount,\n\to_DeductibleReimbursementAmount AS DeductibleReimbursementAmount,\n\to_PaidAllocatedLossAdjustmentExpenseAmount AS PaidAllocatedLossAdjustmentExpenseAmount,\n\to_IncurredAllocatedLossAdjustmentExpenseAmount AS IncurredAllocatedLossAdjustmentExpenseAmount,\n\to_loss_condition AS loss_condition,\n\to_TypeOfSettlement AS TypeOfSettlement,\n\to_ManagedCareOrganizationType AS ManagedCareOrganizationType,\n\to_LumpSumIndicator AS LumpSumIndicator,\n\tEstimatedAuditCode,\n\to_CorrectionSeqNumber AS CorrectionSeqNumber,\n\t-- *INF*: Last(i_SourceSystemId)\n\tLast(i_SourceSystemId) AS o_SourceSystemId,\n\t-- *INF*: LAST(EDWPremiumMasterCalculationPKId)\n\tLAST(EDWPremiumMasterCalculationPKId) AS o_EDWPremiumMasterCalculationPKId2,\n\t-- *INF*: LAST(EDWLossMasterCalculationPKId)\n\tLAST(EDWLossMasterCalculationPKId) AS o_EDWLossMasterCalculationPKId2,\n\tTypeBureauCode AS o_TypeBureauCode1,\n\t-- *INF*: LAST(PremiumMasterRunDate)\n\tLAST(PremiumMasterRunDate) AS o_PremiumMasterRunDate1,\n\t-- *INF*: LAST(LossMasterRunDate)\n\tLAST(LossMasterRunDate) AS o_LossMasterRunDate1,\n\tBureauCompanyCode AS o_BureauCompanyCode1,\n\tPolicyKey AS o_PolicyKey1,\n\tStateProvinceCode AS o_StateProvinceCode1,\n\tPolicyEffectiveDate AS o_PolicyEffectiveDate1,\n\tPolicyEndDate AS o_PolicyEndDate1,\n\t-- *INF*: LAST(InterstateRiskId)\n\tLAST(InterstateRiskId) AS o_InterstateRiskId1,\n\t-- *INF*: LAST(EmployeeLeasingCode)\n\tLAST(EmployeeLeasingCode) AS o_EmployeeLeasingCode1,\n\t-- *INF*: LAST(StateRatingEffectiveDate)\n\tLAST(StateRatingEffectiveDate) AS o_StateRatingEffectiveDate1,\n\t-- *INF*: LAST(FederalTaxId)\n\tLAST(FederalTaxId) AS o_FederalTaxId1,\n\t-- *INF*: LAST(ThreeYearFixedRatePolicyIndicator)\n\tLAST(ThreeYearFixedRatePolicyIndicator) AS o_ThreeYearFixedRatePolicyIndicator1,\n\t-- *INF*: LAST(MultistatePolicyIndicator)\n\tLAST(MultistatePolicyIndicator) AS o_MultistatePolicyIndicator1,\n\t-- *INF*: LAST(InterstateRatedPolicyIndicator)\n\tLAST(InterstateRatedPolicyIndicator) AS o_InterstateRatedPolicyIndicator1,\n\t-- *INF*: LAST(RetrospectiveRatedPolicyIndicator)\n\tLAST(RetrospectiveRatedPolicyIndicator) AS o_RetrospectiveratedPolicyIndicator1,\n\t-- *INF*: LAST(CancelledMidTermPolicyIndicator)\n\tLAST(CancelledMidTermPolicyIndicator) AS o_CancelledMidTermPolicyIndicator1,\n\t-- *INF*: LAST(ManagedCareOrganizationPolicyIndicator)\n\tLAST(ManagedCareOrganizationPolicyIndicator) AS o_ManagedCareOrganizationPolicyIndicator1,\n\t-- *INF*: LAST(TypeOfCoverageIdCode)\n\tLAST(TypeOfCoverageIdCode) AS o_TypeOfCoverageIdCode1,\n\t-- *INF*: LAST(TypeOfPlan)\n\tLAST(TypeOfPlan) AS o_TypeOfPlan1,\n\t-- *INF*: LAST(DeductibleAmountPerClaimAccident)\n\tLAST(DeductibleAmountPerClaimAccident) AS o_DeductibleAmountPerClaimAccident1,\n\t-- *INF*: LAST(InsuredName)\n\tLAST(InsuredName) AS o_InsuredName1,\n\t-- *INF*: LAST(WCSTATAddress)\n\tLAST(WCSTATAddress) AS o_WCSTATAddress1,\n\tPremiumMasterClassCode AS o_PremiumMasterClassCode1,\n\tExperienceModificationFactor AS o_ExperienceModificationFactor1,\n\tExperienceModificationEffectiveDate AS o_ExperienceModificationEffectiveDate1,\n\t-- *INF*: SUM(Exposure)\r\n\t-- -- Compute net values of Written Exposure for later rounding\n\tSUM(Exposure) AS o_Exposure1,\n\t-- *INF*: SUM(PremiumMasterDirectWrittenPremiumAmount)\n\tSUM(PremiumMasterDirectWrittenPremiumAmount) AS o_PremiumMasterDirectWrittenPremiumAmount1,\n\tManualChargedRate AS o_ManualChargedRate1,\n\t-- *INF*: LAST(LossMasterClassCode)\n\tLAST(LossMasterClassCode) AS o_LossMasterClassCode1,\n\t-- *INF*: LAST(ClaimLossDate)\n\tLAST(ClaimLossDate) AS o_ClaimLossDate1,\n\t-- *INF*: LAST(ClaimOccurrenceStatusCode)\n\tLAST(ClaimOccurrenceStatusCode) AS o_ClaimOccurrenceStatusCode1,\n\t-- *INF*: LAST(InjuryTypeCode)\n\tLAST(InjuryTypeCode) AS o_InjuryTypeCode1,\n\t-- *INF*: LAST(CatastropheCode)\n\tLAST(CatastropheCode) AS o_CatastropheCode1,\n\t-- *INF*: LAST(IncurredIndemnityAmount)\n\tLAST(IncurredIndemnityAmount) AS o_IncurredIndemnityAmount1,\n\t-- *INF*: LAST(IncurredMedicalAmount)\n\tLAST(IncurredMedicalAmount) AS o_IncurredMedicalAmount1,\n\t-- *INF*: LAST(CauseOfLoss)\n\tLAST(CauseOfLoss) AS o_CauseOfLoss1,\n\t-- *INF*: LAST(TypeOfRecoveryCode)\n\tLAST(TypeOfRecoveryCode) AS o_TypeOfRecoveryCode1,\n\t-- *INF*: LAST(JurisdictionStateCode)\n\tLAST(JurisdictionStateCode) AS o_JurisdictionStateCode1,\n\t-- *INF*: LAST(BodyPartCode)\n\tLAST(BodyPartCode) AS o_BodyPartCode1,\n\t-- *INF*: LAST(NatureOfInjuryCode)\n\tLAST(NatureOfInjuryCode) AS o_NatureOfInjuryCode1,\n\t-- *INF*: LAST(CauseOfInjuryCode)\n\tLAST(CauseOfInjuryCode) AS o_CauseOfInjuryCode1,\n\t-- *INF*: LAST(PaidIndemnityAmount)\n\tLAST(PaidIndemnityAmount) AS o_PaidIndemnityAmount1,\n\t-- *INF*: LAST(PaidMedicalAmount)\n\tLAST(PaidMedicalAmount) AS o_PaidMedicalAmount1,\n\t-- *INF*: LAST(DeductibleReimbursementAmount)\n\tLAST(DeductibleReimbursementAmount) AS o_DeductibleReimbursementAmount1,\n\t-- *INF*: LAST(PaidAllocatedLossAdjustmentExpenseAmount)\n\tLAST(PaidAllocatedLossAdjustmentExpenseAmount) AS o_PaidAllocatedLossAdjustmentExpenseAmount1,\n\t-- *INF*: LAST(IncurredAllocatedLossAdjustmentExpenseAmount)\n\tLAST(IncurredAllocatedLossAdjustmentExpenseAmount) AS o_IncurredAllocatedLossAdjustmentExpenseAmount1,\n\t-- *INF*: LAST(loss_condition)\n\tLAST(loss_condition) AS o_loss_condition2,\n\t-- *INF*: LAST(TypeOfSettlement)\n\tLAST(TypeOfSettlement) AS o_TypeOfSettlement2,\n\t-- *INF*: LAST(ManagedCareOrganizationType)\n\tLAST(ManagedCareOrganizationType) AS o_ManagedCareOrganizationType2,\n\t-- *INF*: LAST(LumpSumIndicator)\n\tLAST(LumpSumIndicator) AS o_LumpSumIndicator2,\n\t-- *INF*: LAST(EstimatedAuditCode)\n\tLAST(EstimatedAuditCode) AS o_EstimatedAuditCode2,\n\t-- *INF*: LAST(CorrectionSeqNumber)\n\tLAST(CorrectionSeqNumber) AS o_CorrectionSeqNumber2,\n\t-- *INF*: LAST(ClaimNumber)\n\tLAST(ClaimNumber) AS o_ClaimNumber1,\n\to_RunMonthAuditTransFlag AS i_RunMonthAuditTransFlag,\n\t-- *INF*: SUM(\r\n\t-- IIF(i_RunMonthAuditTransFlag=1,\r\n\t-- PremiumMasterDirectWrittenPremiumAmount,0)\r\n\t-- )\n\tSUM(\n\t    IFF(\n\t        i_RunMonthAuditTransFlag = 1, PremiumMasterDirectWrittenPremiumAmount, 0\n\t    )) AS o_RunMonthAuditPremium,\n\to_AgeOfPolicy AS i_AgeOfPolicy,\n\t-- *INF*: LAST(i_AgeOfPolicy)\n\tLAST(i_AgeOfPolicy) AS o_AgeOfPolicy,\n\tPolicyPremiumTotal,\n\tManualPremiumInd,\n\tPolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tRateEffectiveDate,\n\t-- *INF*: min(RateEffectiveDate)\n\tmin(RateEffectiveDate) AS O_RateEffectiveDate,\n\tPol_key,\n\tCoverageType,\n\tPremiumTransactionCode,\n\tCoverageGUID,\n\tRatingCoverageAKID,\n\tRunMonthAuditTransFlag,\n\tAgeOfPolicy,\n\tTermType,\n\tPeriod_start_date,\n\tPeriod_end_date,\n\tAnyARDIndicator,\n\tExperienceRated,\n\t0 AS ARDPassFlag,\n\tLossesSubjectToDeductibleCode,\n\t-- *INF*: LAST(LossesSubjectToDeductibleCode)\n\tLAST(LossesSubjectToDeductibleCode) AS o_LossesSubjectToDeductibleCode,\n\tBasisOfDeductibleCalculationCode,\n\t-- *INF*: LAST(BasisOfDeductibleCalculationCode)\n\tLAST(BasisOfDeductibleCalculationCode) AS o_BasisOfDeductibleCalculationCode\n\tFROM SRT_SortData\n\tGROUP BY TypeBureauCode, BureauCompanyCode, PolicyKey, StateProvinceCode, PolicyEffectiveDate, PolicyEndDate, PremiumMasterClassCode, ExperienceModificationFactor, ExperienceModificationEffectiveDate, ManualChargedRate\n),\nfilter_EMF_ARD AS (\n\tSELECT\n\to_TypeBureauCode1, \n\to_BureauCompanyCode1, \n\to_PolicyKey1, \n\to_StateProvinceCode1, \n\to_PolicyEffectiveDate1, \n\to_PolicyEndDate1, \n\to_PremiumMasterClassCode1, \n\to_ExperienceModificationFactor1, \n\to_ExperienceModificationEffectiveDate1, \n\to_ManualChargedRate1, \n\to_PremiumMasterDirectWrittenPremiumAmount1, \n\tTermType\n\tFROM agg_SummarizePremiums\n\tWHERE TermType='EMF' OR TermType='ARD' OR  TermType='RED'\n),\nagg_split_class_code_premiums AS (\n\tSELECT\n\to_TypeBureauCode1,\n\to_BureauCompanyCode1,\n\to_PolicyKey1,\n\to_StateProvinceCode1,\n\to_PolicyEffectiveDate1,\n\to_PolicyEndDate1,\n\to_PremiumMasterClassCode1,\n\to_PremiumMasterDirectWrittenPremiumAmount1 AS i_PremiumMasterDirectWrittenPremiumAmount1,\n\t-- *INF*: sum(i_PremiumMasterDirectWrittenPremiumAmount1)\n\tsum(i_PremiumMasterDirectWrittenPremiumAmount1) AS o_PremiumMasterDirectWrittenPremiumAmount1\n\tFROM filter_EMF_ARD\n\tGROUP BY o_TypeBureauCode1, o_BureauCompanyCode1, o_PolicyKey1, o_StateProvinceCode1, o_PolicyEffectiveDate1, o_PolicyEndDate1, o_PremiumMasterClassCode1\n),\nsort_Pol_ClassCode AS (\n\tSELECT\n\to_TypeBureauCode1, \n\to_BureauCompanyCode1, \n\to_PolicyKey1, \n\to_StateProvinceCode1, \n\to_PolicyEffectiveDate1, \n\to_PolicyEndDate1, \n\to_PremiumMasterClassCode1, \n\to_PremiumMasterDirectWrittenPremiumAmount1\n\tFROM agg_split_class_code_premiums\n\tORDER BY o_TypeBureauCode1 ASC, o_BureauCompanyCode1 ASC, o_PolicyKey1 ASC, o_StateProvinceCode1 ASC, o_PolicyEffectiveDate1 ASC, o_PolicyEndDate1 ASC, o_PremiumMasterClassCode1 ASC\n),\nsort_pol_ClassCode_join AS (\n\tSELECT\n\to_SourceSystemId, \n\to_EDWPremiumMasterCalculationPKId2, \n\to_EDWLossMasterCalculationPKId2, \n\to_TypeBureauCode1, \n\to_PremiumMasterRunDate1, \n\to_LossMasterRunDate1, \n\to_BureauCompanyCode1, \n\to_PolicyKey1, \n\to_StateProvinceCode1, \n\to_PolicyEffectiveDate1, \n\to_PolicyEndDate1, \n\to_InterstateRiskId1, \n\to_EmployeeLeasingCode1, \n\to_StateRatingEffectiveDate1, \n\to_FederalTaxId1, \n\to_ThreeYearFixedRatePolicyIndicator1, \n\to_MultistatePolicyIndicator1, \n\to_InterstateRatedPolicyIndicator1, \n\to_RetrospectiveratedPolicyIndicator1, \n\to_CancelledMidTermPolicyIndicator1, \n\to_ManagedCareOrganizationPolicyIndicator1, \n\to_TypeOfCoverageIdCode1, \n\to_TypeOfPlan1, \n\to_DeductibleAmountPerClaimAccident1, \n\to_InsuredName1, \n\to_WCSTATAddress1, \n\to_PremiumMasterClassCode1, \n\to_ExperienceModificationFactor1, \n\to_ExperienceModificationEffectiveDate1, \n\to_Exposure1, \n\to_PremiumMasterDirectWrittenPremiumAmount1, \n\to_ManualChargedRate1, \n\to_LossMasterClassCode1, \n\to_ClaimLossDate1, \n\to_ClaimOccurrenceStatusCode1, \n\to_InjuryTypeCode1, \n\to_CatastropheCode1, \n\to_IncurredIndemnityAmount1, \n\to_IncurredMedicalAmount1, \n\to_CauseOfLoss1, \n\to_TypeOfRecoveryCode1, \n\to_JurisdictionStateCode1, \n\to_BodyPartCode1, \n\to_NatureOfInjuryCode1, \n\to_CauseOfInjuryCode1, \n\to_PaidIndemnityAmount1, \n\to_PaidMedicalAmount1, \n\to_DeductibleReimbursementAmount1, \n\to_PaidAllocatedLossAdjustmentExpenseAmount1, \n\to_IncurredAllocatedLossAdjustmentExpenseAmount1, \n\to_loss_condition2, \n\to_TypeOfSettlement2, \n\to_ManagedCareOrganizationType2, \n\to_LumpSumIndicator2, \n\to_EstimatedAuditCode2, \n\to_CorrectionSeqNumber2, \n\to_ClaimNumber1, \n\to_RunMonthAuditPremium, \n\to_AgeOfPolicy, \n\tPolicyPremiumTotal, \n\tManualPremiumInd, \n\tPolicyStateManualPremiumTotal, \n\tBalMinPremiumTotal, \n\tO_RateEffectiveDate AS RateEffectiveDate, \n\tTermType, \n\tAnyARDIndicator, \n\tExperienceRated, \n\tARDPassFlag, \n\to_LossesSubjectToDeductibleCode, \n\to_BasisOfDeductibleCalculationCode\n\tFROM agg_SummarizePremiums\n\tORDER BY o_TypeBureauCode1 ASC, o_BureauCompanyCode1 ASC, o_PolicyKey1 ASC, o_StateProvinceCode1 ASC, o_PolicyEffectiveDate1 ASC, o_PolicyEndDate1 ASC, o_PremiumMasterClassCode1 ASC\n),\njoin_Split_period_ClassCode_premiums AS (SELECT\n\tsort_pol_ClassCode_join.o_SourceSystemId AS o_SourceSystemID, \n\tsort_pol_ClassCode_join.o_EDWPremiumMasterCalculationPKId2, \n\tsort_pol_ClassCode_join.o_EDWLossMasterCalculationPKId2, \n\tsort_pol_ClassCode_join.o_TypeBureauCode1, \n\tsort_pol_ClassCode_join.o_PremiumMasterRunDate1, \n\tsort_pol_ClassCode_join.o_LossMasterRunDate1, \n\tsort_pol_ClassCode_join.o_BureauCompanyCode1, \n\tsort_pol_ClassCode_join.o_PolicyKey1, \n\tsort_pol_ClassCode_join.o_StateProvinceCode1, \n\tsort_pol_ClassCode_join.o_PolicyEffectiveDate1, \n\tsort_pol_ClassCode_join.o_PolicyEndDate1, \n\tsort_pol_ClassCode_join.o_InterstateRiskId1, \n\tsort_pol_ClassCode_join.o_EmployeeLeasingCode1, \n\tsort_pol_ClassCode_join.o_StateRatingEffectiveDate1, \n\tsort_pol_ClassCode_join.o_FederalTaxId1, \n\tsort_pol_ClassCode_join.o_ThreeYearFixedRatePolicyIndicator1, \n\tsort_pol_ClassCode_join.o_MultistatePolicyIndicator1, \n\tsort_pol_ClassCode_join.o_InterstateRatedPolicyIndicator1, \n\tsort_pol_ClassCode_join.o_RetrospectiveratedPolicyIndicator1, \n\tsort_pol_ClassCode_join.o_CancelledMidTermPolicyIndicator1, \n\tsort_pol_ClassCode_join.o_ManagedCareOrganizationPolicyIndicator1, \n\tsort_pol_ClassCode_join.o_TypeOfCoverageIdCode1, \n\tsort_pol_ClassCode_join.o_TypeOfPlan1, \n\tsort_pol_ClassCode_join.o_DeductibleAmountPerClaimAccident1, \n\tsort_pol_ClassCode_join.o_InsuredName1, \n\tsort_pol_ClassCode_join.o_WCSTATAddress1, \n\tsort_pol_ClassCode_join.o_PremiumMasterClassCode1, \n\tsort_pol_ClassCode_join.o_ExperienceModificationFactor1, \n\tsort_pol_ClassCode_join.o_ExperienceModificationEffectiveDate1, \n\tsort_pol_ClassCode_join.o_Exposure1, \n\tsort_pol_ClassCode_join.o_PremiumMasterDirectWrittenPremiumAmount1, \n\tsort_pol_ClassCode_join.o_ManualChargedRate1, \n\tsort_pol_ClassCode_join.o_LossMasterClassCode1, \n\tsort_pol_ClassCode_join.o_ClaimLossDate1, \n\tsort_pol_ClassCode_join.o_ClaimOccurrenceStatusCode1, \n\tsort_pol_ClassCode_join.o_InjuryTypeCode1, \n\tsort_pol_ClassCode_join.o_CatastropheCode1, \n\tsort_pol_ClassCode_join.o_IncurredIndemnityAmount1, \n\tsort_pol_ClassCode_join.o_IncurredMedicalAmount1, \n\tsort_pol_ClassCode_join.o_CauseOfLoss1, \n\tsort_pol_ClassCode_join.o_TypeOfRecoveryCode1, \n\tsort_pol_ClassCode_join.o_JurisdictionStateCode1, \n\tsort_pol_ClassCode_join.o_BodyPartCode1, \n\tsort_pol_ClassCode_join.o_NatureOfInjuryCode1, \n\tsort_pol_ClassCode_join.o_CauseOfInjuryCode1, \n\tsort_pol_ClassCode_join.o_PaidIndemnityAmount1, \n\tsort_pol_ClassCode_join.o_PaidMedicalAmount1, \n\tsort_pol_ClassCode_join.o_DeductibleReimbursementAmount1, \n\tsort_pol_ClassCode_join.o_PaidAllocatedLossAdjustmentExpenseAmount1, \n\tsort_pol_ClassCode_join.o_IncurredAllocatedLossAdjustmentExpenseAmount1, \n\tsort_pol_ClassCode_join.o_loss_condition2, \n\tsort_pol_ClassCode_join.o_TypeOfSettlement2, \n\tsort_pol_ClassCode_join.o_ManagedCareOrganizationType2, \n\tsort_pol_ClassCode_join.o_LumpSumIndicator2, \n\tsort_pol_ClassCode_join.o_EstimatedAuditCode2, \n\tsort_pol_ClassCode_join.o_CorrectionSeqNumber2, \n\tsort_pol_ClassCode_join.o_ClaimNumber1, \n\tsort_pol_ClassCode_join.o_RunMonthAuditPremium, \n\tsort_pol_ClassCode_join.o_AgeOfPolicy, \n\tsort_pol_ClassCode_join.PolicyPremiumTotal, \n\tsort_pol_ClassCode_join.ManualPremiumInd, \n\tsort_pol_ClassCode_join.PolicyStateManualPremiumTotal, \n\tsort_pol_ClassCode_join.BalMinPremiumTotal, \n\tsort_pol_ClassCode_join.RateEffectiveDate, \n\tsort_pol_ClassCode_join.TermType, \n\tsort_pol_ClassCode_join.AnyARDIndicator, \n\tsort_pol_ClassCode_join.ExperienceRated, \n\tsort_pol_ClassCode_join.ARDPassFlag, \n\tsort_Pol_ClassCode.o_TypeBureauCode1 AS o_TypeBureauCode11, \n\tsort_Pol_ClassCode.o_BureauCompanyCode1 AS o_BureauCompanyCode11, \n\tsort_Pol_ClassCode.o_PolicyKey1 AS o_PolicyKey11, \n\tsort_Pol_ClassCode.o_StateProvinceCode1 AS o_StateProvinceCode11, \n\tsort_Pol_ClassCode.o_PolicyEffectiveDate1 AS o_PolicyEffectiveDate11, \n\tsort_Pol_ClassCode.o_PolicyEndDate1 AS o_PolicyEndDate11, \n\tsort_Pol_ClassCode.o_PremiumMasterClassCode1 AS o_PremiumMasterClassCode11, \n\tsort_Pol_ClassCode.o_PremiumMasterDirectWrittenPremiumAmount1 AS o_PremiumMasterDirectWrittenPremiumAmount11, \n\tsort_pol_ClassCode_join.o_LossesSubjectToDeductibleCode, \n\tsort_pol_ClassCode_join.o_BasisOfDeductibleCalculationCode\n\tFROM sort_pol_ClassCode_join\n\tLEFT OUTER JOIN sort_Pol_ClassCode\n\tON sort_Pol_ClassCode.o_TypeBureauCode1 = sort_pol_ClassCode_join.o_TypeBureauCode1 AND sort_Pol_ClassCode.o_BureauCompanyCode1 = sort_pol_ClassCode_join.o_BureauCompanyCode1 AND sort_Pol_ClassCode.o_PolicyKey1 = sort_pol_ClassCode_join.o_PolicyKey1 AND sort_Pol_ClassCode.o_StateProvinceCode1 = sort_pol_ClassCode_join.o_StateProvinceCode1 AND sort_Pol_ClassCode.o_PolicyEffectiveDate1 = sort_pol_ClassCode_join.o_PolicyEffectiveDate1 AND sort_Pol_ClassCode.o_PolicyEndDate1 = sort_pol_ClassCode_join.o_PolicyEndDate1 AND sort_Pol_ClassCode.o_PremiumMasterClassCode1 = sort_pol_ClassCode_join.o_PremiumMasterClassCode1\n),\nEXP_Target_Data AS (\n\tSELECT\n\tSYSDATE AS CreatedDate,\n\tSYSDATE AS ModifiedDate,\n\to_SourceSystemID,\n\to_EDWPremiumMasterCalculationPKId2 AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId2 AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode1 AS TypeBureauCode,\n\to_PremiumMasterRunDate1 AS PremiumMasterRunDate,\n\to_LossMasterRunDate1 AS LossMasterRunDate,\n\to_BureauCompanyCode1 AS BureauCompanyCode,\n\to_PolicyKey1 AS PolicyKey,\n\to_StateProvinceCode1 AS StateProvinceCode,\n\to_PolicyEffectiveDate1 AS PolicyEffectiveDate,\n\to_PolicyEndDate1 AS PolicyEndDate,\n\to_InterstateRiskId1 AS InterstateRiskId,\n\to_EmployeeLeasingCode1 AS EmployeeLeasingCode,\n\to_StateRatingEffectiveDate1 AS StateRatingEffectiveDate,\n\to_FederalTaxId1 AS FederalTaxId,\n\to_ThreeYearFixedRatePolicyIndicator1 AS ThreeYearFixedRatePolicyIndicator,\n\to_MultistatePolicyIndicator1 AS MultistatePolicyIndicator,\n\to_InterstateRatedPolicyIndicator1 AS InterstateRatedPolicyIndicator,\n\to_RetrospectiveratedPolicyIndicator1 AS RetrospectiveratedPolicyIndicator,\n\to_CancelledMidTermPolicyIndicator1 AS CancelledMidTermPolicyIndicator,\n\to_ManagedCareOrganizationPolicyIndicator1 AS ManagedCareOrganizationPolicyIndicator,\n\to_TypeOfCoverageIdCode1 AS TypeOfCoverageIdCode,\n\to_TypeOfPlan1 AS TypeOfPlan,\n\to_DeductibleAmountPerClaimAccident1 AS DeductibleAmountPerClaimAccident,\n\to_InsuredName1 AS InsuredName,\n\to_WCSTATAddress1 AS WCSTATAddress,\n\to_PremiumMasterClassCode1 AS PremiumMasterClassCode,\n\to_ExperienceModificationFactor1 AS ExperienceModificationFactor,\n\to_ExperienceModificationEffectiveDate1 AS ExperienceModificationEffectiveDate,\n\to_Exposure1 AS Exposure,\n\to_PremiumMasterDirectWrittenPremiumAmount1 AS PremiumMasterDirectWrittenPremiumAmount,\n\to_ManualChargedRate1 AS ManualChargedRate,\n\to_LossMasterClassCode1 AS LossMasterClassCode,\n\to_ClaimLossDate1 AS ClaimLossDate,\n\to_ClaimOccurrenceStatusCode1 AS ClaimOccurrenceStatusCode,\n\to_InjuryTypeCode1 AS InjuryTypeCode,\n\to_CatastropheCode1 AS CatastropheCode,\n\to_IncurredIndemnityAmount1 AS IncurredIndemnityAmount,\n\to_IncurredMedicalAmount1 AS IncurredMedicalAmount,\n\to_CauseOfLoss1 AS CauseOfLoss,\n\to_TypeOfRecoveryCode1 AS TypeOfRecoveryCode,\n\to_JurisdictionStateCode1 AS JurisdictionStateCode,\n\to_BodyPartCode1 AS BodyPartCode,\n\to_NatureOfInjuryCode1 AS NatureOfInjuryCode,\n\to_CauseOfInjuryCode1 AS CauseOfInjuryCode,\n\to_PaidIndemnityAmount1 AS PaidIndemnityAmount,\n\to_PaidMedicalAmount1 AS PaidMedicalAmount,\n\to_DeductibleReimbursementAmount1 AS DeductibleReimbursementAmount,\n\to_PaidAllocatedLossAdjustmentExpenseAmount1 AS PaidAllocatedLossAdjustmentExpenseAmount,\n\to_IncurredAllocatedLossAdjustmentExpenseAmount1 AS IncurredAllocatedLossAdjustmentExpenseAmount,\n\to_loss_condition2 AS loss_condition,\n\to_TypeOfSettlement2 AS TypeOfSettlement,\n\to_ManagedCareOrganizationType2 AS ManagedCareOrganizationType,\n\to_LumpSumIndicator2 AS LumpSumIndicator,\n\to_EstimatedAuditCode2 AS EstimatedAuditCode,\n\to_CorrectionSeqNumber2 AS CorrectionSeqNumber,\n\to_ClaimNumber1 AS ClaimNumber,\n\to_RunMonthAuditPremium AS RunMonthAuditPremium,\n\to_AgeOfPolicy AS AgeOfPolicy,\n\tPolicyPremiumTotal,\n\tManualPremiumInd,\n\tPolicyStateManualPremiumTotal,\n\tBalMinPremiumTotal,\n\tRateEffectiveDate,\n\tAnyARDIndicator,\n\tExperienceRated,\n\tTermType,\n\to_PremiumMasterDirectWrittenPremiumAmount11 AS i_PremiumMasterDirectWrittenPremiumAmount11,\n\t-- *INF*: iif(ISNULL(i_PremiumMasterDirectWrittenPremiumAmount11),0,i_PremiumMasterDirectWrittenPremiumAmount11)\n\tIFF(\n\t    i_PremiumMasterDirectWrittenPremiumAmount11 IS NULL, 0,\n\t    i_PremiumMasterDirectWrittenPremiumAmount11\n\t) AS v_PremiumMasterDirectWrittenPremiumAmount,\n\t-- *INF*: iif(round(v_PremiumMasterDirectWrittenPremiumAmount)!=0,1,0)\n\tIFF(round(v_PremiumMasterDirectWrittenPremiumAmount) != 0, 1, 0) AS ARD_PASS_FLAG,\n\t'N/A' AS Splitperiodcode,\n\to_LossesSubjectToDeductibleCode AS LossesSubjectToDeductibleCode,\n\to_BasisOfDeductibleCalculationCode AS BasisOfDeductibleCalculationCode,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditID\n\tFROM join_Split_period_ClassCode_premiums\n),\nWorkWCSTATAggregatedPremium AS (\n\tTRUNCATE TABLE WorkWCSTATAggregatedPremium;\n\tINSERT INTO WorkWCSTATAggregatedPremium\n\t(AuditId, CreatedDate, ModifiedDate, SourceSystemId, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, PremiumMasterRunDate, LossMasterRunDate, BureauCompanyCode, PolicyKey, StateProvinceCode, PolicyEffectiveDate, PolicyEndDate, InterstateRiskId, EmployeeLeasingCode, StateRatingEffectiveDate, FederalTaxId, ThreeYearFixedRatePolicyIndicator, MultistatePolicyIndicator, InterstateRatedPolicyIndicator, RetrospectiveratedPolicyIndicator, CancelledMidTermPolicyIndicator, ManagedCareOrganizationPolicyIndicator, TypeOfCoverageIdCode, TypeOfPlan, DeductibleAmountPerClaimAccident, InsuredName, WCSTATAddress, PremiumMasterClassCode, ExperienceModificationFactor, ExperienceModificationEffectiveDate, Exposure, PremiumMasterDirectWrittenPremiumAmount, ManualChargedRate, LossMasterClassCode, ClaimLossDate, ClaimOccurrenceStatusCode, InjuryTypeCode, CatastropheCode, IncurredIndemnityAmount, IncurredMedicalAmount, CauseOfLoss, TypeOfRecoveryCode, JurisdictionStateCode, BodyPartCode, NatureOfInjuryCode, CauseOfInjuryCode, PaidIndemnityAmount, PaidMedicalAmount, DeductibleReimbursementAmount, PaidAllocatedLossAdjustmentExpenseAmount, IncurredAllocatedLossAdjustmentExpenseAmount, LossCondition, TypeOfSettlement, ManagedCareOrganizationType, LumpSumIndicator, EstimatedAuditCode, CorrectionSeqNumber, ClaimNumber, RunMonthAuditPremium, AgeOfPolicy, PolicyPremiumTotal, ManualPremiumIndicator, PolicyStateManualPremiumTotal, BalMinPremiumTotal, RateEffectiveDate, AnyARDIndicator, ExperienceRated, TermType, ARDPassFlag, SplitPeriodCode, LossesSubjectToDeductibleCode, BasisOfDeductibleCalculationCode)\n\tSELECT \n\tAuditID AS AUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\to_SourceSystemID AS SOURCESYSTEMID, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tBUREAUCOMPANYCODE, \n\tPOLICYKEY, \n\tSTATEPROVINCECODE, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYENDDATE, \n\tINTERSTATERISKID, \n\tEMPLOYEELEASINGCODE, \n\tSTATERATINGEFFECTIVEDATE, \n\tFEDERALTAXID, \n\tTHREEYEARFIXEDRATEPOLICYINDICATOR, \n\tMULTISTATEPOLICYINDICATOR, \n\tINTERSTATERATEDPOLICYINDICATOR, \n\tRETROSPECTIVERATEDPOLICYINDICATOR, \n\tCANCELLEDMIDTERMPOLICYINDICATOR, \n\tMANAGEDCAREORGANIZATIONPOLICYINDICATOR, \n\tTYPEOFCOVERAGEIDCODE, \n\tTYPEOFPLAN, \n\tDEDUCTIBLEAMOUNTPERCLAIMACCIDENT, \n\tINSUREDNAME, \n\tWCSTATADDRESS, \n\tPREMIUMMASTERCLASSCODE, \n\tEXPERIENCEMODIFICATIONFACTOR, \n\tEXPERIENCEMODIFICATIONEFFECTIVEDATE, \n\tEXPOSURE, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tMANUALCHARGEDRATE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMLOSSDATE, \n\tCLAIMOCCURRENCESTATUSCODE, \n\tINJURYTYPECODE, \n\tCATASTROPHECODE, \n\tINCURREDINDEMNITYAMOUNT, \n\tINCURREDMEDICALAMOUNT, \n\tCAUSEOFLOSS, \n\tTYPEOFRECOVERYCODE, \n\tJURISDICTIONSTATECODE, \n\tBODYPARTCODE, \n\tNATUREOFINJURYCODE, \n\tCAUSEOFINJURYCODE, \n\tPAIDINDEMNITYAMOUNT, \n\tPAIDMEDICALAMOUNT, \n\tDEDUCTIBLEREIMBURSEMENTAMOUNT, \n\tPAIDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tINCURREDALLOCATEDLOSSADJUSTMENTEXPENSEAMOUNT, \n\tloss_condition AS LOSSCONDITION, \n\tTYPEOFSETTLEMENT, \n\tMANAGEDCAREORGANIZATIONTYPE, \n\tLUMPSUMINDICATOR, \n\tESTIMATEDAUDITCODE, \n\tCORRECTIONSEQNUMBER, \n\tCLAIMNUMBER, \n\tRUNMONTHAUDITPREMIUM, \n\tAGEOFPOLICY, \n\tPOLICYPREMIUMTOTAL, \n\tManualPremiumInd AS MANUALPREMIUMINDICATOR, \n\tPOLICYSTATEMANUALPREMIUMTOTAL, \n\tBALMINPREMIUMTOTAL, \n\tRATEEFFECTIVEDATE, \n\tANYARDINDICATOR, \n\tEXPERIENCERATED, \n\tTERMTYPE, \n\tARD_PASS_FLAG AS ARDPASSFLAG, \n\tSplitperiodcode AS SPLITPERIODCODE, \n\tLOSSESSUBJECTTODEDUCTIBLECODE, \n\tBASISOFDEDUCTIBLECALCULATIONCODE\n\tFROM EXP_Target_Data\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME_IL": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "NUM_OF_MONTHS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}