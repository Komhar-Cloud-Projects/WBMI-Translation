{
    "name": "s_m_CLM_CMS_Claims_Response_File",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_CMS_Claims_Response_File",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_CMS_Claims_Response_File AS (\n\n-- TODO Manual --\n\n),\nEXP_Default AS (\n\tSELECT\n\tRecord_Identifier,\n\tSubmitted_DCN,\n\t-- *INF*: ltrim(rtrim(Submitted_DCN))\n\tltrim(rtrim(Submitted_DCN)) AS out_Submitted_DCN,\n\tSubmitted_Action_Type,\n\tInjured_Party_HICN,\n\tSubmitted_Injured_Party_SSN,\n\tSubmitted_Injured_Party_Last_Name,\n\tSubmitted_Injured_Party_First_Name,\n\tSubmitted_Injured_Party_Middle_Initial,\n\tSubmitted_Injured_Party_Gender,\n\tSubmitted_Injured_Party_DOB,\n\tSubmitted_Plan_TIN,\n\tSubmitted_Plan_Office_Code,\n\tSubmitted_Policy_Number,\n\tSubmitted_Claim_Number,\n\t-- *INF*: LTRIM(RTRIM(Submitted_Claim_Number))\n\tLTRIM(RTRIM(Submitted_Claim_Number)) AS out_Submitted_Claim_Number,\n\tReserved_For_Future_Use,\n\tApplied_Injured_Party_HICN,\n\tReserved_For_Future_Use1,\n\tApplied_Injured_Party_Last_Name,\n\tApplied_Injured_Party_First_Name,\n\tApplied_Injured_Party_Middle_Initial,\n\tApplied_Injured_Party_Gender,\n\tApplied_Injured_Party_DOB,\n\tApplied_MSP_Effective_Date,\n\tApplied_MSP_Termination_Date,\n\tApplied_MSP_Type_Indicator,\n\tReserved_For_Future_Use2,\n\tApplied_Disposition_Code,\n\tApplied_Error_Code1,\n\tApplied_Error_Code2,\n\tApplied_Error_Code3,\n\tApplied_Error_Code4,\n\tApplied_Error_Code5,\n\tApplied_Error_Code6,\n\tApplied_Error_Code7,\n\tApplied_Error_Code8,\n\tApplied_Error_Code9,\n\tApplied_Error_Code10,\n\tApplied_Compliance_Flag1,\n\tApplied_Compliance_Flag2,\n\tApplied_Compliance_Flag3,\n\tApplied_Compliance_Flag4,\n\tApplied_Compliance_Flag5,\n\tApplied_Compliance_Flag6,\n\tApplied_Compliance_Flag7,\n\tApplied_Compliance_Flag8,\n\tApplied_Compliance_Flag9,\n\tApplied_Compliance_Flag10,\n\tReserved_For_Future_Use3,\n\tSYSDATE AS System_Date\n\tFROM SQ_CMS_Claims_Response_File\n),\nFIL_Header_Trailer AS (\n\tSELECT\n\tRecord_Identifier, \n\tout_Submitted_DCN AS Submitted_DCN, \n\tSubmitted_Action_Type, \n\tInjured_Party_HICN, \n\tSubmitted_Injured_Party_SSN, \n\tSubmitted_Injured_Party_Last_Name, \n\tSubmitted_Injured_Party_First_Name, \n\tSubmitted_Injured_Party_Middle_Initial, \n\tSubmitted_Injured_Party_Gender, \n\tSubmitted_Injured_Party_DOB, \n\tSubmitted_Plan_TIN, \n\tSubmitted_Plan_Office_Code, \n\tSubmitted_Policy_Number, \n\tout_Submitted_Claim_Number AS Submitted_Claim_Number, \n\tReserved_For_Future_Use, \n\tApplied_Injured_Party_HICN, \n\tReserved_For_Future_Use1, \n\tApplied_Injured_Party_Last_Name, \n\tApplied_Injured_Party_First_Name, \n\tApplied_Injured_Party_Middle_Initial, \n\tApplied_Injured_Party_Gender, \n\tApplied_Injured_Party_DOB, \n\tApplied_MSP_Effective_Date, \n\tApplied_MSP_Termination_Date, \n\tApplied_MSP_Type_Indicator, \n\tReserved_For_Future_Use2, \n\tApplied_Disposition_Code, \n\tApplied_Error_Code1, \n\tApplied_Error_Code2, \n\tApplied_Error_Code3, \n\tApplied_Error_Code4, \n\tApplied_Error_Code5, \n\tApplied_Error_Code6, \n\tApplied_Error_Code7, \n\tApplied_Error_Code8, \n\tApplied_Error_Code9, \n\tApplied_Error_Code10, \n\tApplied_Compliance_Flag1, \n\tApplied_Compliance_Flag2, \n\tApplied_Compliance_Flag3, \n\tApplied_Compliance_Flag4, \n\tApplied_Compliance_Flag5, \n\tApplied_Compliance_Flag6, \n\tApplied_Compliance_Flag7, \n\tApplied_Compliance_Flag8, \n\tApplied_Compliance_Flag9, \n\tApplied_Compliance_Flag10, \n\tReserved_For_Future_Use3, \n\tSystem_Date\n\tFROM EXP_Default\n\tWHERE IIF(IN(Record_Identifier,'NGRH','NGRT'), FALSE,TRUE)\n),\nLKP_Claim_Source_Determine AS (\n\tSELECT\n\tclaim_number,\n\tclaim_rep_first_name,\n\tclaim_rep_last_name,\n\thandling_office_mgr,\n\tsource_sys_id,\n\tSubmitted_Claim_Number\n\tFROM (\n\t\tSELECT CASE co.source_sys_id\r\n\t\t        WHEN 'PMS' THEN LTRIM(RTRIM(co.claim_occurrence_key))\r\n\t\t        ELSE LTRIM(RTRIM(co.s3p_claim_num))\r\n\t\t    END AS claim_number, \r\n\t\t    cr.claim_rep_first_name AS claim_rep_first_name, \r\n\t\t    cr.claim_rep_last_name AS claim_rep_last_name, \r\n\t\t    cr.handling_office_mgr AS handling_office_mgr, \r\n\t\t    co.source_sys_id AS source_sys_id\r\n\t\tFROM dbo.claim_occurrence co\r\n\t\tINNER JOIN dbo.claim_representative_occurrence cro ON cro.claim_occurrence_ak_id = co.claim_occurrence_ak_id\r\n\t\t    AND cro.crrnt_snpsht_flag = 1\r\n\t\t    AND cro.claim_rep_role_code = 'H'\r\n\t\tINNER JOIN dbo.claim_representative cr ON cr.claim_rep_ak_id = cro.claim_rep_ak_id\r\n\t\t    AND cr.crrnt_snpsht_flag = 1\r\n\t\tWHERE co.crrnt_snpsht_flag = 1 --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_number ORDER BY claim_number) = 1\n),\nEXP_Post_LKP AS (\n\tSELECT\n\tFIL_Header_Trailer.Submitted_DCN,\n\tFIL_Header_Trailer.Submitted_Action_Type,\n\tFIL_Header_Trailer.Injured_Party_HICN,\n\tFIL_Header_Trailer.Submitted_Injured_Party_SSN,\n\tFIL_Header_Trailer.Submitted_Injured_Party_Last_Name,\n\tFIL_Header_Trailer.Submitted_Injured_Party_First_Name,\n\tFIL_Header_Trailer.Submitted_Injured_Party_Middle_Initial,\n\tFIL_Header_Trailer.Submitted_Injured_Party_Gender,\n\tFIL_Header_Trailer.Submitted_Injured_Party_DOB,\n\tFIL_Header_Trailer.Submitted_Plan_TIN,\n\tFIL_Header_Trailer.Submitted_Plan_Office_Code,\n\tFIL_Header_Trailer.Submitted_Policy_Number,\n\tFIL_Header_Trailer.Submitted_Claim_Number,\n\tFIL_Header_Trailer.Reserved_For_Future_Use,\n\tFIL_Header_Trailer.Applied_Injured_Party_HICN,\n\tFIL_Header_Trailer.Reserved_For_Future_Use1,\n\tFIL_Header_Trailer.Applied_Injured_Party_Last_Name,\n\tFIL_Header_Trailer.Applied_Injured_Party_First_Name,\n\tFIL_Header_Trailer.Applied_Injured_Party_Middle_Initial,\n\tFIL_Header_Trailer.Applied_Injured_Party_Gender,\n\tFIL_Header_Trailer.Applied_Injured_Party_DOB,\n\tFIL_Header_Trailer.Applied_MSP_Effective_Date,\n\tFIL_Header_Trailer.Applied_MSP_Termination_Date,\n\tFIL_Header_Trailer.Applied_MSP_Type_Indicator,\n\tFIL_Header_Trailer.Reserved_For_Future_Use2,\n\tFIL_Header_Trailer.Applied_Disposition_Code,\n\tFIL_Header_Trailer.Applied_Error_Code1,\n\tFIL_Header_Trailer.Applied_Error_Code2,\n\tFIL_Header_Trailer.Applied_Error_Code3,\n\tFIL_Header_Trailer.Applied_Error_Code4,\n\tFIL_Header_Trailer.Applied_Error_Code5,\n\tFIL_Header_Trailer.Applied_Error_Code6,\n\tFIL_Header_Trailer.Applied_Error_Code7,\n\tFIL_Header_Trailer.Applied_Error_Code8,\n\tFIL_Header_Trailer.Applied_Error_Code9,\n\tFIL_Header_Trailer.Applied_Error_Code10,\n\tFIL_Header_Trailer.Applied_Compliance_Flag1,\n\tFIL_Header_Trailer.Applied_Compliance_Flag2,\n\tFIL_Header_Trailer.Applied_Compliance_Flag3,\n\tFIL_Header_Trailer.Applied_Compliance_Flag4,\n\tFIL_Header_Trailer.Applied_Compliance_Flag5,\n\tFIL_Header_Trailer.Applied_Compliance_Flag6,\n\tFIL_Header_Trailer.Applied_Compliance_Flag7,\n\tFIL_Header_Trailer.Applied_Compliance_Flag8,\n\tFIL_Header_Trailer.Applied_Compliance_Flag9,\n\tFIL_Header_Trailer.Applied_Compliance_Flag10,\n\tFIL_Header_Trailer.Reserved_For_Future_Use3,\n\tFIL_Header_Trailer.System_Date,\n\tLKP_Claim_Source_Determine.claim_number,\n\tLKP_Claim_Source_Determine.claim_rep_first_name,\n\tLKP_Claim_Source_Determine.claim_rep_last_name,\n\t-- *INF*: CONCAT(CONCAT(claim_rep_first_name,' '),  claim_rep_last_name)\n\tCONCAT(CONCAT(claim_rep_first_name, ' '), claim_rep_last_name) AS claim_rep_full_name,\n\tLKP_Claim_Source_Determine.handling_office_mgr,\n\tLKP_Claim_Source_Determine.source_sys_id\n\tFROM FIL_Header_Trailer\n\tLEFT JOIN LKP_Claim_Source_Determine\n\tON LKP_Claim_Source_Determine.claim_number = FIL_Header_Trailer.Submitted_Claim_Number\n),\nRTR_SPLIT_SOURCE AS (\n\tSELECT\n\tSubmitted_DCN,\n\tSubmitted_Action_Type,\n\tInjured_Party_HICN,\n\tSubmitted_Injured_Party_SSN,\n\tSubmitted_Injured_Party_Last_Name,\n\tSubmitted_Injured_Party_First_Name,\n\tSubmitted_Injured_Party_Middle_Initial,\n\tSubmitted_Injured_Party_Gender,\n\tSubmitted_Injured_Party_DOB,\n\tSubmitted_Plan_TIN,\n\tSubmitted_Plan_Office_Code,\n\tSubmitted_Policy_Number,\n\tSubmitted_Claim_Number,\n\tReserved_For_Future_Use,\n\tApplied_Injured_Party_HICN,\n\tReserved_For_Future_Use1 AS Reserved_For_Future_Use11,\n\tApplied_Injured_Party_Last_Name,\n\tApplied_Injured_Party_First_Name,\n\tApplied_Injured_Party_Middle_Initial,\n\tApplied_Injured_Party_Gender,\n\tApplied_Injured_Party_DOB,\n\tApplied_MSP_Effective_Date,\n\tApplied_MSP_Termination_Date,\n\tApplied_MSP_Type_Indicator,\n\tReserved_For_Future_Use2 AS Reserved_For_Future_Use21,\n\tApplied_Disposition_Code,\n\tApplied_Error_Code1,\n\tApplied_Error_Code2,\n\tApplied_Error_Code3,\n\tApplied_Error_Code4,\n\tApplied_Error_Code5,\n\tApplied_Error_Code6,\n\tApplied_Error_Code7,\n\tApplied_Error_Code8,\n\tApplied_Error_Code9,\n\tApplied_Error_Code10,\n\tApplied_Compliance_Flag1,\n\tApplied_Compliance_Flag2,\n\tApplied_Compliance_Flag3,\n\tApplied_Compliance_Flag4,\n\tApplied_Compliance_Flag5,\n\tApplied_Compliance_Flag6,\n\tApplied_Compliance_Flag7,\n\tApplied_Compliance_Flag8,\n\tApplied_Compliance_Flag9,\n\tApplied_Compliance_Flag10,\n\tReserved_For_Future_Use3 AS Reserved_For_Future_Use31,\n\tSystem_Date,\n\tclaim_number,\n\tclaim_rep_full_name,\n\thandling_office_mgr,\n\tsource_sys_id\n\tFROM EXP_Post_LKP\n),\nRTR_SPLIT_SOURCE_EXCEED AS (SELECT * FROM RTR_SPLIT_SOURCE WHERE source_sys_id='EXCEED' OR source_sys_id='PMS'),\nRTR_SPLIT_SOURCE_DCT AS (SELECT * FROM RTR_SPLIT_SOURCE WHERE source_sys_id='DCT'),\nEXP_EXCEED_PMS AS (\n\tSELECT\n\tSubmitted_DCN AS Submitted_DCN1,\n\tSubmitted_Action_Type AS Submitted_Action_Type1,\n\tInjured_Party_HICN AS Injured_Party_HICN1,\n\tSubmitted_Injured_Party_Last_Name AS Submitted_Injured_Party_Last_Name1,\n\tSubmitted_Injured_Party_First_Name AS Submitted_Injured_Party_First_Name1,\n\tSubmitted_Injured_Party_Middle_Initial AS Submitted_Injured_Party_Middle_Initial1,\n\tSubmitted_Injured_Party_Gender AS Submitted_Injured_Party_Gender1,\n\tSubmitted_Injured_Party_DOB AS Submitted_Injured_Party_DOB1,\n\tSubmitted_Plan_TIN AS Submitted_Plan_TIN1,\n\tSubmitted_Plan_Office_Code AS Submitted_Plan_Office_Code1,\n\tSubmitted_Policy_Number AS Submitted_Policy_Number1,\n\tSubmitted_Claim_Number AS Submitted_Claim_Number1,\n\tReserved_For_Future_Use AS Reserved_For_Future_Use1,\n\tApplied_Injured_Party_HICN AS Applied_Injured_Party_HICN1,\n\tReserved_For_Future_Use AS Reserved_For_Future_Use111,\n\tApplied_Injured_Party_Last_Name AS Applied_Injured_Party_Last_Name1,\n\tApplied_Injured_Party_First_Name AS Applied_Injured_Party_First_Name1,\n\tApplied_Injured_Party_Middle_Initial AS Applied_Injured_Party_Middle_Initial1,\n\tApplied_Injured_Party_Gender AS Applied_Injured_Party_Gender1,\n\tApplied_Injured_Party_DOB AS Applied_Injured_Party_DOB1,\n\tApplied_MSP_Effective_Date AS Applied_MSP_Effective_Date1,\n\tApplied_MSP_Termination_Date AS Applied_MSP_Termination_Date1,\n\tApplied_MSP_Type_Indicator AS Applied_MSP_Type_Indicator1,\n\tReserved_For_Future_Use2 AS Reserved_For_Future_Use211,\n\tApplied_Disposition_Code AS Applied_Disposition_Code1,\n\tApplied_Error_Code AS Applied_Error_Code11,\n\tApplied_Error_Code2 AS Applied_Error_Code21,\n\tApplied_Error_Code3 AS Applied_Error_Code31,\n\tApplied_Error_Code4 AS Applied_Error_Code41,\n\tApplied_Error_Code5 AS Applied_Error_Code51,\n\tApplied_Error_Code6 AS Applied_Error_Code61,\n\tApplied_Error_Code7 AS Applied_Error_Code71,\n\tApplied_Error_Code8 AS Applied_Error_Code81,\n\tApplied_Error_Code9 AS Applied_Error_Code91,\n\tApplied_Error_Code10 AS Applied_Error_Code101,\n\tApplied_Compliance_Flag AS Applied_Compliance_Flag11,\n\tApplied_Compliance_Flag2 AS Applied_Compliance_Flag21,\n\tApplied_Compliance_Flag3 AS Applied_Compliance_Flag31,\n\tApplied_Compliance_Flag4 AS Applied_Compliance_Flag41,\n\tApplied_Compliance_Flag5 AS Applied_Compliance_Flag51,\n\tApplied_Compliance_Flag6 AS Applied_Compliance_Flag61,\n\tApplied_Compliance_Flag7 AS Applied_Compliance_Flag71,\n\tApplied_Compliance_Flag8 AS Applied_Compliance_Flag81,\n\tApplied_Compliance_Flag9 AS Applied_Compliance_Flag91,\n\tApplied_Compliance_Flag10 AS Applied_Compliance_Flag101,\n\tReserved_For_Future_Use3 AS Reserved_For_Future_Use311,\n\tSystem_Date AS System_Date1\n\tFROM RTR_SPLIT_SOURCE_EXCEED\n),\nCMS_CLM_RESPONSE AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_CLM_RESPONSE\n\t(WBMI_RECEIVED_DT, SUBMITTED_DCN, SUBMITTED_ACT_TYPE, INJURED_PARTY_HICN, SUB_INJ_PRY_LST_NM, SUB_INJ_PRY_FST_NM, SUB_INJ_PR_MID_INT, SUB_INJ_PRY_GENDER, SUB_INJ_PRTY_DOB, SUB_PLAN_TIN, SUB_PLAN_OFF_CD, SUB_POLICY_NUM, SUB_CLAIM_NUM, APP_INJ_PRTY_HICN, APP_INJ_PRTY_LN, APP_INJ_PRTY_FN, APP_INJ_PRTY_MI, APP_INJ_PRTY_GNDR, APP_INJ_PRTY_DOB, APP_MSP_EFF_DATE, APP_MSP_TERM_DATE, APP_MSP_TYPE_IND, APP_DISPOSITION_CD, APP_ERROR_CODE_1, APP_ERROR_CODE_2, APP_ERROR_CODE_3, APP_ERROR_CODE_4, APP_ERROR_CODE_5, APP_ERROR_CODE_6, APP_ERROR_CODE_7, APP_ERROR_CODE_8, APP_ERROR_CODE_9, APP_ERROR_CODE_10, APP_COMPL_CODE_1, APP_COMPL_CODE_2, APP_COMPL_CODE_3, APP_COMPL_CODE_4, APP_COMPL_CODE_5, APP_COMPL_CODE_6, APP_COMPL_CODE_7, APP_COMPL_CODE_8, APP_COMPL_CODE_9, APP_COMPL_CODE_10)\n\tSELECT \n\tSystem_Date1 AS WBMI_RECEIVED_DT, \n\tSubmitted_DCN1 AS SUBMITTED_DCN, \n\tSubmitted_Action_Type1 AS SUBMITTED_ACT_TYPE, \n\tInjured_Party_HICN1 AS INJURED_PARTY_HICN, \n\tSubmitted_Injured_Party_Last_Name1 AS SUB_INJ_PRY_LST_NM, \n\tSubmitted_Injured_Party_First_Name1 AS SUB_INJ_PRY_FST_NM, \n\tSubmitted_Injured_Party_Middle_Initial1 AS SUB_INJ_PR_MID_INT, \n\tSubmitted_Injured_Party_Gender1 AS SUB_INJ_PRY_GENDER, \n\tSubmitted_Injured_Party_DOB1 AS SUB_INJ_PRTY_DOB, \n\tSubmitted_Plan_TIN1 AS SUB_PLAN_TIN, \n\tSubmitted_Plan_Office_Code1 AS SUB_PLAN_OFF_CD, \n\tSubmitted_Policy_Number1 AS SUB_POLICY_NUM, \n\tSubmitted_Claim_Number1 AS SUB_CLAIM_NUM, \n\tApplied_Injured_Party_HICN1 AS APP_INJ_PRTY_HICN, \n\tApplied_Injured_Party_Last_Name1 AS APP_INJ_PRTY_LN, \n\tApplied_Injured_Party_First_Name1 AS APP_INJ_PRTY_FN, \n\tApplied_Injured_Party_Middle_Initial1 AS APP_INJ_PRTY_MI, \n\tApplied_Injured_Party_Gender1 AS APP_INJ_PRTY_GNDR, \n\tApplied_Injured_Party_DOB1 AS APP_INJ_PRTY_DOB, \n\tApplied_MSP_Effective_Date1 AS APP_MSP_EFF_DATE, \n\tApplied_MSP_Termination_Date1 AS APP_MSP_TERM_DATE, \n\tApplied_MSP_Type_Indicator1 AS APP_MSP_TYPE_IND, \n\tApplied_Disposition_Code1 AS APP_DISPOSITION_CD, \n\tApplied_Error_Code11 AS APP_ERROR_CODE_1, \n\tApplied_Error_Code21 AS APP_ERROR_CODE_2, \n\tApplied_Error_Code31 AS APP_ERROR_CODE_3, \n\tApplied_Error_Code41 AS APP_ERROR_CODE_4, \n\tApplied_Error_Code51 AS APP_ERROR_CODE_5, \n\tApplied_Error_Code61 AS APP_ERROR_CODE_6, \n\tApplied_Error_Code71 AS APP_ERROR_CODE_7, \n\tApplied_Error_Code81 AS APP_ERROR_CODE_8, \n\tApplied_Error_Code91 AS APP_ERROR_CODE_9, \n\tApplied_Error_Code101 AS APP_ERROR_CODE_10, \n\tApplied_Compliance_Flag11 AS APP_COMPL_CODE_1, \n\tApplied_Compliance_Flag21 AS APP_COMPL_CODE_2, \n\tApplied_Compliance_Flag31 AS APP_COMPL_CODE_3, \n\tApplied_Compliance_Flag41 AS APP_COMPL_CODE_4, \n\tApplied_Compliance_Flag51 AS APP_COMPL_CODE_5, \n\tApplied_Compliance_Flag61 AS APP_COMPL_CODE_6, \n\tApplied_Compliance_Flag71 AS APP_COMPL_CODE_7, \n\tApplied_Compliance_Flag81 AS APP_COMPL_CODE_8, \n\tApplied_Compliance_Flag91 AS APP_COMPL_CODE_9, \n\tApplied_Compliance_Flag101 AS APP_COMPL_CODE_10\n\tFROM EXP_EXCEED_PMS\n),\nLKP_Claimant_name AS (\n\tSELECT\n\tclaim_party_full_name,\n\tcms_document_cntl_num\n\tFROM (\n\t\tselect CONVERT(varchar(15), P.cms_document_cntl_num) as cms_document_cntl_num,\r\n\t\t    cp.claim_party_full_name as claim_party_full_name\r\n\t\tfrom dbo.claim_medical_plan p\r\n\t\tjoin dbo.vw_claim_medical m on m.claim_med_ak_id = p.claim_med_ak_id and m.crrnt_snpsht_flag = 1\r\n\t\tjoin dbo.claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = m.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1\r\n\t\tINNER JOIN dbo.vw_claim_party1 cp ON cp.claim_party_ak_id = cpo.claim_party_ak_id AND cp.crrnt_snpsht_flag = 1\r\n\t\twhere p.crrnt_snpsht_flag = 1\r\n\t\t    and p.source_sys_id = 'DCT' --\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY cms_document_cntl_num ORDER BY claim_party_full_name) = 1\n),\nEXP_DCT AS (\n\tSELECT\n\tRTR_SPLIT_SOURCE_DCT.Submitted_DCN AS Submitted_DCN3,\n\t-- *INF*: TO_INTEGER(Submitted_DCN3)\r\n\t-- \n\tCAST(Submitted_DCN3 AS INTEGER) AS out_Submitted_DCN3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Action_Type AS Submitted_Action_Type3,\n\tRTR_SPLIT_SOURCE_DCT.Injured_Party_HICN AS Injured_Party_HICN3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Injured_Party_Last_Name AS Submitted_Injured_Party_Last_Name3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Injured_Party_First_Name AS Submitted_Injured_Party_First_Name3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Injured_Party_Middle_Initial AS Submitted_Injured_Party_Middle_Initial3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Injured_Party_Gender AS Submitted_Injured_Party_Gender3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Injured_Party_DOB AS Submitted_Injured_Party_DOB3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Plan_TIN AS Submitted_Plan_TIN3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Plan_Office_Code AS Submitted_Plan_Office_Code3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Policy_Number AS Submitted_Policy_Number3,\n\tRTR_SPLIT_SOURCE_DCT.Submitted_Claim_Number AS Submitted_Claim_Number3,\n\tRTR_SPLIT_SOURCE_DCT.Reserved_For_Future_Use AS Reserved_For_Future_Use3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_HICN AS Applied_Injured_Party_HICN3,\n\tRTR_SPLIT_SOURCE_DCT.Reserved_For_Future_Use11 AS Reserved_For_Future_Use113,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_Last_Name AS Applied_Injured_Party_Last_Name3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_First_Name AS Applied_Injured_Party_First_Name3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_Middle_Initial AS Applied_Injured_Party_Middle_Initial3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_Gender AS Applied_Injured_Party_Gender3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Injured_Party_DOB AS Applied_Injured_Party_DOB3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_MSP_Effective_Date AS Applied_MSP_Effective_Date3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_MSP_Termination_Date AS Applied_MSP_Termination_Date3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_MSP_Type_Indicator AS Applied_MSP_Type_Indicator3,\n\tRTR_SPLIT_SOURCE_DCT.Reserved_For_Future_Use21 AS Reserved_For_Future_Use213,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Disposition_Code AS Applied_Disposition_Code3,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code1 AS Applied_Error_Code13,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code2 AS Applied_Error_Code23,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code AS Applied_Error_Code33,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code4 AS Applied_Error_Code43,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code5 AS Applied_Error_Code53,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code6 AS Applied_Error_Code63,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code7 AS Applied_Error_Code73,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code8 AS Applied_Error_Code83,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code9 AS Applied_Error_Code93,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Error_Code10 AS Applied_Error_Code103,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag1 AS Applied_Compliance_Flag13,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag2 AS Applied_Compliance_Flag23,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag AS Applied_Compliance_Flag33,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag4 AS Applied_Compliance_Flag43,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag5 AS Applied_Compliance_Flag53,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag6 AS Applied_Compliance_Flag63,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag7 AS Applied_Compliance_Flag73,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag8 AS Applied_Compliance_Flag83,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag9 AS Applied_Compliance_Flag93,\n\tRTR_SPLIT_SOURCE_DCT.Applied_Compliance_Flag10 AS Applied_Compliance_Flag103,\n\tRTR_SPLIT_SOURCE_DCT.Reserved_For_Future_Use31 AS Reserved_For_Future_Use313,\n\tRTR_SPLIT_SOURCE_DCT.System_Date AS System_Date3,\n\tRTR_SPLIT_SOURCE_DCT.claim_number AS claim_number3,\n\tRTR_SPLIT_SOURCE_DCT.claim_rep_full_name AS claim_rep_full_name3,\n\tRTR_SPLIT_SOURCE_DCT.handling_office_mgr AS handling_office_mgr3,\n\tLKP_Claimant_name.claim_party_full_name AS ClaimantName,\n\t-- *INF*: :UDF.DEFAULT_VALUE_FOR_STRINGS(ClaimantName)\n\tUDF_DEFAULT_VALUE_FOR_STRINGS(ClaimantName) AS out_ClaimantName\n\tFROM RTR_SPLIT_SOURCE_DCT\n\tLEFT JOIN LKP_Claimant_name\n\tON LKP_Claimant_name.cms_document_cntl_num = RTR_SPLIT_SOURCE.Submitted_DCN3\n),\nCmsClaimResponse AS (\n\tINSERT INTO CmsClaimResponse\n\t(WbmiReceivedDt, SubmittedDcn, SubmittedActionType, InjuredPartyHICN, SubInjuredPartyLastName, SubInjuredPartyFirstName, SubInjuredPartyMiddleInitial, SubInjuredPartyGender, SubInjuredPartyDob, SubPlanTin, SubPlanOfficeCd, SubPolicyNum, SubClaimNum, AppInjuredPartyHICN, AppInjuredPartyLastName, AppInjuredPartyFirstName, AppInjuredPartyMiddleInitial, AppInjuredPartyGender, AppInjuredPartyDob, AppMspEffDate, AppMspTermDate, AppMspTypeInd, AppDispositionCd, AppErrorCode1, AppErrorCode2, AppErrorCode3, AppErrorCode4, AppErrorCode5, AppErrorCode6, AppErrorCode7, AppErrorCode8, AppErrorCode9, AppErrorCode10, AppComplCode1, AppComplCode2, AppComplCode3, AppComplCode4, AppComplCode5, AppComplCode6, AppComplCode7, AppComplCode8, AppComplCode9, AppComplCode10, ClaimRepName, ClaimRepManagerName, ClaimNum, ClaimantName, WbmiPlanType)\n\tSELECT \n\tSystem_Date3 AS WBMIRECEIVEDDT, \n\tout_Submitted_DCN3 AS SUBMITTEDDCN, \n\tSubmitted_Action_Type3 AS SUBMITTEDACTIONTYPE, \n\tInjured_Party_HICN3 AS INJUREDPARTYHICN, \n\tSubmitted_Injured_Party_Last_Name3 AS SUBINJUREDPARTYLASTNAME, \n\tSubmitted_Injured_Party_First_Name3 AS SUBINJUREDPARTYFIRSTNAME, \n\tSubmitted_Injured_Party_Middle_Initial3 AS SUBINJUREDPARTYMIDDLEINITIAL, \n\tSubmitted_Injured_Party_Gender3 AS SUBINJUREDPARTYGENDER, \n\tSubmitted_Injured_Party_DOB3 AS SUBINJUREDPARTYDOB, \n\tSubmitted_Plan_TIN3 AS SUBPLANTIN, \n\tSubmitted_Plan_Office_Code3 AS SUBPLANOFFICECD, \n\tSubmitted_Policy_Number3 AS SUBPOLICYNUM, \n\tSubmitted_Claim_Number3 AS SUBCLAIMNUM, \n\tApplied_Injured_Party_HICN3 AS APPINJUREDPARTYHICN, \n\tApplied_Injured_Party_Last_Name3 AS APPINJUREDPARTYLASTNAME, \n\tApplied_Injured_Party_First_Name3 AS APPINJUREDPARTYFIRSTNAME, \n\tApplied_Injured_Party_Middle_Initial3 AS APPINJUREDPARTYMIDDLEINITIAL, \n\tApplied_Injured_Party_Gender3 AS APPINJUREDPARTYGENDER, \n\tApplied_Injured_Party_DOB3 AS APPINJUREDPARTYDOB, \n\tApplied_MSP_Effective_Date3 AS APPMSPEFFDATE, \n\tApplied_MSP_Termination_Date3 AS APPMSPTERMDATE, \n\tApplied_MSP_Type_Indicator3 AS APPMSPTYPEIND, \n\tApplied_Disposition_Code3 AS APPDISPOSITIONCD, \n\tApplied_Error_Code13 AS APPERRORCODE1, \n\tApplied_Error_Code23 AS APPERRORCODE2, \n\tApplied_Error_Code33 AS APPERRORCODE3, \n\tApplied_Error_Code43 AS APPERRORCODE4, \n\tApplied_Error_Code53 AS APPERRORCODE5, \n\tApplied_Error_Code63 AS APPERRORCODE6, \n\tApplied_Error_Code73 AS APPERRORCODE7, \n\tApplied_Error_Code83 AS APPERRORCODE8, \n\tApplied_Error_Code93 AS APPERRORCODE9, \n\tApplied_Error_Code103 AS APPERRORCODE10, \n\tApplied_Compliance_Flag13 AS APPCOMPLCODE1, \n\tApplied_Compliance_Flag23 AS APPCOMPLCODE2, \n\tApplied_Compliance_Flag33 AS APPCOMPLCODE3, \n\tApplied_Compliance_Flag43 AS APPCOMPLCODE4, \n\tApplied_Compliance_Flag53 AS APPCOMPLCODE5, \n\tApplied_Compliance_Flag63 AS APPCOMPLCODE6, \n\tApplied_Compliance_Flag73 AS APPCOMPLCODE7, \n\tApplied_Compliance_Flag83 AS APPCOMPLCODE8, \n\tApplied_Compliance_Flag93 AS APPCOMPLCODE9, \n\tApplied_Compliance_Flag103 AS APPCOMPLCODE10, \n\tclaim_rep_full_name3 AS CLAIMREPNAME, \n\thandling_office_mgr3 AS CLAIMREPMANAGERNAME, \n\tclaim_number3 AS CLAIMNUM, \n\tout_ClaimantName AS CLAIMANTNAME, \n\tApplied_MSP_Type_Indicator3 AS WBMIPLANTYPE\n\tFROM EXP_DCT\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}