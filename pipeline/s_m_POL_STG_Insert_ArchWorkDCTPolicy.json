{
    "name": "s_m_POL_STG_Insert_ArchWorkDCTPolicy",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_ArchWorkDCTPolicy",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkDCTPolicy AS (\n\tSELECT\n\t\tWorkDCTPolicyId,\n\t\tExtractDate,\n\t\tSourceSystemId,\n\t\tSessionId,\n\t\tPolicyId,\n\t\tPartyId,\n\t\tName,\n\t\tFirstName,\n\t\tLastName,\n\t\tMiddleName,\n\t\tEntityType,\n\t\tFederalEmployeeIDNumber,\n\t\tSICCode,\n\t\tNAICSCode,\n\t\tProgram,\n\t\tPolicyGUId,\n\t\tCustomerNum,\n\t\tPolicyNumber,\n\t\tPolicyVersion,\n\t\tPolicyVersionFormatted,\n\t\tPolicyEffectiveDate,\n\t\tPolicyExpirationDate,\n\t\tLineOfBusiness,\n\t\tTerm,\n\t\tPrimaryRatingState,\n\t\tProduct,\n\t\tAuditPeriod,\n\t\tCancellationDate,\n\t\tTransactionDate,\n\t\tPreviousPolicyNumber,\n\t\tInceptionDate,\n\t\tTransactionType,\n\t\tDivision,\n\t\tTerrorism,\n\t\tWBProduct,\n\t\tWBProductType,\n\t\tRiskGrade,\n\t\tBCCCode,\n\t\tWBPolicyId,\n\t\tAutomaticRenewalIndicator,\n\t\tAssociation,\n\t\tAssociationDiscountFactor,\n\t\tLineType,\n\t\tPolicyProgram,\n\t\tPriorPolicyKey,\n\t\tRenewalPolicySymbol,\n\t\tRenewalPolicyNumber,\n\t\tRenewalPolicyMod,\n\t\tPolicyStatus,\n\t\tTransactionCreatedDate,\n\t\tTransactionEffectiveDate,\n\t\tTransactionExpirationDate,\n\t\tTransactionCancellationDate,\n\t\tReasonCode,\n\t\tReasonCodeCaption,\n\t\tTransactionState,\n\t\tTransactionPurpose,\n\t\tSICCodeDesc,\n\t\tNAICSCodeDesc,\n\t\tTitle,\n\t\tDoingBusinessAs,\n\t\tQuoteActionTimeStamp,\n\t\tQuoteActionStatus,\n\t\tQuoteActionUserClassification,\n\t\tQuoteActionUserName,\n\t\tAgencyCode,\n\t\tIsApplicant,\n\t\tRejectedReason,\n\t\tRejectedReasonDetails,\n\t\tProducerName,\n\t\tPhoneNumber,\n\t\tCustomerCare,\n\t\tBusinessSegmentCode,\n\t\tTransactionCreatedUserId,\n\t\tEndorsedProcessedBy AS EndorsedProcessedby,\n\t\tEstimatedQuotePremium,\n\t\tIsRollover,\n\t\tPriorCarrierName,\n\t\tPirorCarrierNameOther,\n\t\tMailPolicyToInsured,\n\t\tDataFix,\n\t\tDataFixDate,\n\t\tDataFixType,\n\t\tPolicyIssueCodeDesc,\n\t\tPolicyIssueCodeOverride,\n\t\tDeclaredEvent,\n\t\tIssuedUWID,\n\t\tIssuedUnderwriter,\n\t\tExternalQuoteSource,\n\t\tTurnstileGenerated,\n\t\tPenguinTechGenerated,\n\t\tLCSurveyOrderedIndicator,\n\t\tLCSurveyOrderedDate,\n\t\tExpiredReason,\n\t\tExpiredReasonDetails\n\tFROM WorkDCTPolicy\n),\nEXp_Default AS (\n\tSELECT\n\tExtractDate,\n\tSourceSystemId,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tWorkDCTPolicyId,\n\tSessionId,\n\tPolicyId,\n\tPartyId,\n\tName,\n\tFirstName,\n\tLastName,\n\tMiddleName,\n\tEntityType,\n\tFederalEmployeeIDNumber,\n\tSICCode,\n\tNAICSCode,\n\tProgram,\n\tPolicyGUId,\n\tCustomerNum,\n\tPolicyNumber,\n\tPolicyVersion,\n\tPolicyVersionFormatted,\n\tPolicyEffectiveDate,\n\tPolicyExpirationDate,\n\tLineOfBusiness,\n\tTerm,\n\tPrimaryRatingState,\n\tProduct,\n\tAuditPeriod,\n\tCancellationDate,\n\tTransactionDate,\n\tPreviousPolicyNumber,\n\tInceptionDate,\n\tTransactionType,\n\tDivision,\n\tTerrorism,\n\tWBProduct,\n\tWBProductType,\n\tRiskGrade,\n\tBCCCode,\n\tWBPolicyId,\n\tAutomaticRenewalIndicator,\n\t-- *INF*: DECODE(AutomaticRenewalIndicator, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    AutomaticRenewalIndicator,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_AutomaticRenewalIndicator,\n\tAssociation,\n\tAssociationDiscountFactor,\n\tLineType,\n\tPolicyProgram,\n\tPriorPolicyKey,\n\tRenewalPolicySymbol,\n\tRenewalPolicyNumber,\n\tRenewalPolicyMod,\n\tPolicyStatus,\n\tTransactionCreatedDate,\n\tTransactionEffectiveDate,\n\tTransactionExpirationDate,\n\tTransactionCancellationDate,\n\tReasonCode,\n\tReasonCodeCaption,\n\tTransactionState,\n\tTransactionPurpose,\n\tSICCodeDesc,\n\tNAICSCodeDesc,\n\tTitle,\n\tDoingBusinessAs,\n\tQuoteActionTimeStamp,\n\tQuoteActionStatus,\n\tQuoteActionUserClassification,\n\tQuoteActionUserName,\n\tAgencyCode,\n\tIsApplicant,\n\tRejectedReason,\n\tRejectedReasonDetails,\n\tProducerName,\n\tPhoneNumber,\n\tCustomerCare,\n\tBusinessSegmentCode,\n\tTransactionCreatedUserId,\n\tEndorsedProcessedby,\n\tEstimatedQuotePremium,\n\tIsRollover AS i_IsRollover,\n\t-- *INF*: IIF(i_IsRollover='T','1','0')\n\tIFF(i_IsRollover = 'T', '1', '0') AS o_IsRollover,\n\tPriorCarrierName,\n\tPirorCarrierNameOther,\n\tMailPolicyToInsured AS i_MailPolicyToInsured,\n\t-- *INF*: IIF(i_MailPolicyToInsured='T','1','0')\n\tIFF(i_MailPolicyToInsured = 'T', '1', '0') AS o_MailPolicyToInsured,\n\tDataFix,\n\tDataFixDate,\n\tDataFixType,\n\tPolicyIssueCodeDesc,\n\tPolicyIssueCodeOverride AS i_PolicyIssueCodeOverride,\n\t-- *INF*: DECODE(i_PolicyIssueCodeOverride, 'T', 1, 'F', 0)\n\tDECODE(\n\t    i_PolicyIssueCodeOverride,\n\t    'T', 1,\n\t    'F', 0\n\t) AS o_PolicyIssueCodeOverride,\n\tDeclaredEvent AS i_DeclaredEvent,\n\t-- *INF*: DECODE(i_DeclaredEvent, 'T', 1, 'F', 0,Null)\n\tDECODE(\n\t    i_DeclaredEvent,\n\t    'T', 1,\n\t    'F', 0,\n\t    Null\n\t) AS o_DeclaredEvent,\n\tIssuedUWID,\n\tIssuedUnderwriter,\n\tExternalQuoteSource,\n\tTurnstileGenerated AS i_TurnstileGenerated,\n\t-- *INF*: DECODE(i_TurnstileGenerated, 'T', 1, 'F', 0)\n\tDECODE(\n\t    i_TurnstileGenerated,\n\t    'T', 1,\n\t    'F', 0\n\t) AS o_TurnstileGenerated,\n\tPenguinTechGenerated AS i_PenguinTechGenerated,\n\t-- *INF*: DECODE(i_PenguinTechGenerated, 'T', 1, 'F', 0)\n\tDECODE(\n\t    i_PenguinTechGenerated,\n\t    'T', 1,\n\t    'F', 0\n\t) AS o_PenguinTechGenerated,\n\tLCSurveyOrderedIndicator,\n\t-- *INF*: DECODE(LCSurveyOrderedIndicator, 'T', '1', 'F', '0',Null)\n\tDECODE(\n\t    LCSurveyOrderedIndicator,\n\t    'T', '1',\n\t    'F', '0',\n\t    Null\n\t) AS o_LCSurveyOrderedIndicator,\n\tLCSurveyOrderedDate,\n\tExpiredReason,\n\tExpiredReasonDetails\n\tFROM SQ_WorkDCTPolicy\n),\nArchWorkDCTPolicy AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchWorkDCTPolicy\n\t(ExtractDate, SourceSystemId, AuditId, WorkDCTPolicyId, SessionId, PolicyId, PartyId, Name, FirstName, LastName, MiddleName, EntityType, FederalEmployeeIDNumber, SICCode, NAICSCode, Program, PolicyGUId, CustomerNum, PolicyNumber, PolicyVersion, PolicyVersionFormatted, PolicyEffectiveDate, PolicyExpirationDate, LineOfBusiness, Term, PrimaryRatingState, Product, AuditPeriod, CancellationDate, TransactionDate, PreviousPolicyNumber, InceptionDate, TransactionType, Division, Terrorism, WBProduct, WBProductType, RiskGrade, BCCCode, WBPolicyId, AutomaticRenewalIndicator, Association, AssociationDiscountFactor, LineType, PolicyProgram, PriorPolicyKey, RenewalPolicySymbol, RenewalPolicyNumber, RenewalPolicyMod, PolicyStatus, TransactionCreatedDate, TransactionEffectiveDate, TransactionExpirationDate, TransactionCancellationDate, ReasonCode, ReasonCodeCaption, TransactionState, TransactionPurpose, SICCodeDesc, NAICSCodeDesc, Title, DoingBusinessAs, QuoteActionTimeStamp, QuoteActionStatus, QuoteActionUserClassification, QuoteActionUserName, AgencyCode, IsApplicant, RejectedReason, RejectedReasonDetails, ProducerName, PhoneNumber, CustomerCare, BusinessSegmentCode, TransactionCreatedUserId, EndorsedProcessedBy, EstimatedQuotePremium, IsRollover, PriorCarrierName, PirorCarrierNameOther, MailPolicyToInsured, DataFix, DataFixDate, DataFixType, PolicyIssueCodeDesc, PolicyIssueCodeOverride, DeclaredEvent, IssuedUWID, IssuedUnderwriter, ExternalQuoteSource, TurnstileGenerated, PenguinTechGenerated, LCSurveyOrderedIndicator, LCSurveyOrderedDate, ExpiredReason, ExpiredReasonDetails)\n\tSELECT \n\tEXTRACTDATE, \n\tSOURCESYSTEMID, \n\taudit_id AS AUDITID, \n\tWORKDCTPOLICYID, \n\tSESSIONID, \n\tPOLICYID, \n\tPARTYID, \n\tNAME, \n\tFIRSTNAME, \n\tLASTNAME, \n\tMIDDLENAME, \n\tENTITYTYPE, \n\tFEDERALEMPLOYEEIDNUMBER, \n\tSICCODE, \n\tNAICSCODE, \n\tPROGRAM, \n\tPOLICYGUID, \n\tCUSTOMERNUM, \n\tPOLICYNUMBER, \n\tPOLICYVERSION, \n\tPOLICYVERSIONFORMATTED, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYEXPIRATIONDATE, \n\tLINEOFBUSINESS, \n\tTERM, \n\tPRIMARYRATINGSTATE, \n\tPRODUCT, \n\tAUDITPERIOD, \n\tCANCELLATIONDATE, \n\tTRANSACTIONDATE, \n\tPREVIOUSPOLICYNUMBER, \n\tINCEPTIONDATE, \n\tTRANSACTIONTYPE, \n\tDIVISION, \n\tTERRORISM, \n\tWBPRODUCT, \n\tWBPRODUCTTYPE, \n\tRISKGRADE, \n\tBCCCODE, \n\tWBPOLICYID, \n\to_AutomaticRenewalIndicator AS AUTOMATICRENEWALINDICATOR, \n\tASSOCIATION, \n\tASSOCIATIONDISCOUNTFACTOR, \n\tLINETYPE, \n\tPOLICYPROGRAM, \n\tPRIORPOLICYKEY, \n\tRENEWALPOLICYSYMBOL, \n\tRENEWALPOLICYNUMBER, \n\tRENEWALPOLICYMOD, \n\tPOLICYSTATUS, \n\tTRANSACTIONCREATEDDATE, \n\tTRANSACTIONEFFECTIVEDATE, \n\tTRANSACTIONEXPIRATIONDATE, \n\tTRANSACTIONCANCELLATIONDATE, \n\tREASONCODE, \n\tREASONCODECAPTION, \n\tTRANSACTIONSTATE, \n\tTRANSACTIONPURPOSE, \n\tSICCODEDESC, \n\tNAICSCODEDESC, \n\tTITLE, \n\tDOINGBUSINESSAS, \n\tQUOTEACTIONTIMESTAMP, \n\tQUOTEACTIONSTATUS, \n\tQUOTEACTIONUSERCLASSIFICATION, \n\tQUOTEACTIONUSERNAME, \n\tAGENCYCODE, \n\tISAPPLICANT, \n\tREJECTEDREASON, \n\tREJECTEDREASONDETAILS, \n\tPRODUCERNAME, \n\tPHONENUMBER, \n\tCUSTOMERCARE, \n\tBUSINESSSEGMENTCODE, \n\tTRANSACTIONCREATEDUSERID, \n\tEndorsedProcessedby AS ENDORSEDPROCESSEDBY, \n\tESTIMATEDQUOTEPREMIUM, \n\to_IsRollover AS ISROLLOVER, \n\tPRIORCARRIERNAME, \n\tPIRORCARRIERNAMEOTHER, \n\to_MailPolicyToInsured AS MAILPOLICYTOINSURED, \n\tDATAFIX, \n\tDATAFIXDATE, \n\tDATAFIXTYPE, \n\tPOLICYISSUECODEDESC, \n\to_PolicyIssueCodeOverride AS POLICYISSUECODEOVERRIDE, \n\to_DeclaredEvent AS DECLAREDEVENT, \n\tISSUEDUWID, \n\tISSUEDUNDERWRITER, \n\tEXTERNALQUOTESOURCE, \n\to_TurnstileGenerated AS TURNSTILEGENERATED, \n\to_PenguinTechGenerated AS PENGUINTECHGENERATED, \n\to_LCSurveyOrderedIndicator AS LCSURVEYORDEREDINDICATOR, \n\tLCSURVEYORDEREDDATE, \n\tEXPIREDREASON, \n\tEXPIREDREASONDETAILS\n\tFROM EXp_Default\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}