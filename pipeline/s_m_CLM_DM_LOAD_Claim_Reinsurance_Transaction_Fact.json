{
    "name": "s_m_CLM_DM_LOAD_Claim_Reinsurance_Transaction_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Reinsurance_Transaction_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_calender_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nLKP_Reins_Cov_Dim_Id AS (\n\tSELECT\n\treins_cov_dim_id,\n\tedw_reins_cov_ak_id,\n\teff_from_date,\n\teff_to_date\n\tFROM (\n\t\tSELECT \n\t\t\treins_cov_dim_id,\n\t\t\tedw_reins_cov_ak_id,\n\t\t\teff_from_date,\n\t\t\teff_to_date\n\t\tFROM reinsurance_coverage_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_reins_cov_ak_id,eff_from_date,eff_to_date ORDER BY reins_cov_dim_id) = 1\n),\nLKP_claim_reinsurance_transaction AS (\n\tSELECT\n\tclaimant_cov_det_ak_id,\n\tclaim_reins_financial_type_code,\n\tclaim_reins_trans_date\n\tFROM (\n\t\tSELECT claim_reinsurance_transaction.claimant_cov_det_ak_id as claimant_cov_det_ak_id, claim_reinsurance_transaction.claim_reins_financial_type_code as claim_reins_financial_type_code, claim_reinsurance_transaction.claim_reins_trans_date as claim_reins_trans_date \r\n\t\t FROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_reinsurance_transaction\r\n\t\twhere claim_reins_trans_code= 23\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,claim_reins_financial_type_code,claim_reins_trans_date ORDER BY claimant_cov_det_ak_id) = 1\n),\nSQ_claim_reinsurance_transaction AS (\n\tSELECT CRT.claim_reins_trans_id,\r\n\t       CRT.source_sys_id,\r\n\t       CRT.logical_flag,\r\n\t       CRT.claim_reins_trans_ak_id,\r\n\t       CRT.claimant_cov_det_ak_id,\r\n\t       CRT.reins_cov_ak_id,\r\n\t       CRT.sar_id,\r\n\t       CRT.cause_of_loss,\r\n\t       CRT.reserve_ctgry,\r\n\t       CRT.type_disability,\r\n\t       CRT.claim_reins_pms_trans_code,\r\n\t       CRT.claim_reins_trans_base_type_code,\r\n\t       CRT.claim_reins_financial_type_code,\r\n\t       CRT.trans_ctgry_code,\r\n\t       CRT.claim_reins_trans_code,\r\n\t       CRT.claim_reins_trans_amt,\r\n\t       CRT.claim_reins_trans_hist_amt,\r\n\t       CRT.claim_reins_trans_date,\r\n\t       CRT.claim_reins_acct_entered_date,\r\n\t       CRT.offset_onset_ind,\r\n\t       CRT.reprocess_date\r\n\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_reinsurance_transaction CRT\n),\nEXP_get_values AS (\n\tSELECT\n\tclaim_reins_trans_id,\n\tclaim_reins_trans_ak_id,\n\tclaimant_cov_det_ak_id,\n\treins_cov_ak_id,\n\tclaim_reins_financial_type_code,\n\tclaim_reins_trans_code,\n\tclaim_reins_trans_date,\n\t-- *INF*: to_date('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tto_date('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS v_trans_date,\n\tv_trans_date AS trans_date_out,\n\tclaim_reins_trans_base_type_code,\n\tclaim_reins_trans_amt,\n\tclaim_reins_trans_hist_amt,\n\treprocess_date,\n\tsource_sys_id,\n\tclaim_reins_acct_entered_date,\n\toffset_onset_ind,\n\tlogical_flag,\n\ttrans_ctgry_code,\n\t'C' AS trans_kind_code,\n\tsar_id,\n\tcause_of_loss,\n\treserve_ctgry,\n\ttype_disability,\n\tclaim_reins_pms_trans_code\n\tFROM SQ_claim_reinsurance_transaction\n),\nLKP_Claim_Transaction_Type_Dim AS (\n\tSELECT\n\tclaim_trans_type_dim_id,\n\ttrans_ctgry_code,\n\ttrans_base_type_code,\n\ttrans_kind_code,\n\ttrans_code,\n\ttype_disability,\n\toffset_onset_ind\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_trans_type_dim_id,\n\t\t\ttrans_ctgry_code,\n\t\t\ttrans_base_type_code,\n\t\t\ttrans_kind_code,\n\t\t\ttrans_code,\n\t\t\ttype_disability,\n\t\t\toffset_onset_ind\n\t\tFROM claim_transaction_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY trans_ctgry_code,trans_base_type_code,trans_kind_code,trans_code,type_disability,offset_onset_ind ORDER BY claim_trans_type_dim_id DESC) = 1\n),\nLKP_claim_financial_type_dim AS (\n\tSELECT\n\tclaim_financial_type_dim_id,\n\tfinancial_type_code\n\tFROM (\n\t\tSELECT claim_financial_type_dim.claim_financial_type_dim_id as claim_financial_type_dim_id, claim_financial_type_dim.financial_type_code as financial_type_code FROM claim_financial_type_dim\r\n\t\tWHERE CRRNT_SNPSHT_FLAG = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY financial_type_code ORDER BY claim_financial_type_dim_id) = 1\n),\nmplt_Claim_occurence_dim_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Claim_occurrence_dim_hist_id AS (WITH\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Party_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_ak_id,\n\t\tclaim_case_ak_id,\n\t\tclaim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claim_party_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_party_occurrence.claim_case_ak_id as claim_case_ak_id, claim_party_occurrence.claim_party_occurrence_ak_id as claim_party_occurrence_ak_id, claim_party_occurrence.eff_from_date as eff_from_date, claim_party_occurrence.eff_to_date as eff_to_date \r\n\t\t\tFROM claim_party_occurrence\r\n\t\t\tWHERE\r\n\t\t\tclaim_party_occurrence.claim_party_role_code in ('CMT','CLMT')\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_ak_id) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Case AS (\n\t\tSELECT\n\t\tclaim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_ak_id) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_Claim_Party_occurrence.claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_Claim_Party_occurrence\n\t\tON LKP_Claim_Party_occurrence.claim_party_occurrence_ak_id = LKP_Claimant_coverage_detail.claim_party_occurrence_ak_id AND LKP_Claim_Party_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Party_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n\tLKP_claim_occurrence_Date AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key_ak_id,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key_ak_id,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_Claim_Case_Dim AS (\n\t\tSELECT\n\t\tclaim_case_dim_id,\n\t\tedw_claim_case_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_case_dim_id,\n\t\t\t\tedw_claim_case_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_case_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_case_ak_id,eff_from_date,eff_to_date ORDER BY claim_case_dim_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterAKId,\n\t\tInsuranceSegmentAKId,\n\t\tPolicyOfferingAKId,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT policy.pol_id as pol_id, policy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID, \r\n\t\t\tpolicy.StrategicProfitCenterAKId as StrategicProfitCenterAKId,\r\n\t\t\tpolicy.InsuranceSegmentAKId as InsuranceSegmentAKId,\r\n\t\t\tpolicy.PolicyOfferingAKId as PolicyOfferingAKId,\r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, policy.pol_exp_date as pol_exp_date, policy.pol_sym as pol_sym, policy.pol_num as pol_num, policy.pol_ak_id as pol_ak_id, policy.eff_from_date as eff_from_date, policy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy\r\n\t\t\tWHERE \r\n\t\t\tpolicy.pol_ak_id IN (select distinct pol_key_ak_id from claim_occurrence)\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_ak_id,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT contract_customer_dim.contract_cust_dim_id as contract_cust_dim_id, contract_customer_dim.edw_contract_cust_ak_id as edw_contract_cust_ak_id, contract_customer_dim.eff_from_date as eff_from_date, contract_customer_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM contract_customer_dim\r\n\t\t\tWHERE edw_contract_cust_ak_id IN\r\n\t\t\t(\r\n\t\t\tSELECT DISTINCT CC.contract_cust_ak_id \r\n\t\t\tFROM @{pipeline().parameters.DB_NAME_EDW}.dbo.contract_customer CC, @{pipeline().parameters.DB_NAME_EDW}.V2.policy P, @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence CO\r\n\t\t\tWHERE CC.contract_cust_ak_id = P.contract_cust_ak_id\r\n\t\t\tAND CO.pol_key_ak_id = P.pol_ak_id\r\n\t\t\tAND P.crrnt_snpsht_flag = 1\r\n\t\t\tAND CC.crrnt_snpsht_flag = 1\r\n\t\t\t)\r\n\t\t\t\r\n\t\t\t--- 2/12/2014 : Modified the Lookup Query to join on AK ID values instead of Natural Key\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tLKP_V2_Agency AS (\n\t\tSELECT\n\t\tSalesTerritoryAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesTerritoryAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID,EffectiveDate,ExpirationDate ORDER BY SalesTerritoryAKID) = 1\n\t),\n\tLKP_agency_dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tedw_agency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tedw_agency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy_dim.pol_dim_id as pol_dim_id, \r\n\t\t\tpolicy_dim.edw_pol_pk_id as edw_pol_pk_id, \r\n\t\t\tpolicy_dim.eff_from_date as eff_from_date, \r\n\t\t\tpolicy_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM policy_dim\r\n\t\t\tWHERE edw_pol_pk_id IN \r\n\t\t\t(SELECT policy.pol_id as pol_id FROM @{pipeline().parameters.DB_NAME_EDW}.v2.policy policy\r\n\t\t\tWHERE policy.pol_ak_id IN (select distinct pol_key_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_occurrence))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tEXP_Lkp_Dim_ids AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence_Date.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_RegionalSalesManager AS (\n\t\tSELECT\n\t\tSalesDirectorAKID,\n\t\tRegionalSalesManagerAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tSalesDirectorAKID,\n\t\t\t\tRegionalSalesManagerAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM @{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY RegionalSalesManagerAKID,EffectiveDate,ExpirationDate ORDER BY SalesDirectorAKID) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence_Date.claim_loss_date, \n\t\tLKP_claim_occurrence_Date.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_start_date, \n\t\tLKP_claim_occurrence_Date.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_examiner_id, \n\t\tEXP_Lkp_Dim_ids.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tEXP_Lkp_Dim_ids.claim_created_by_id, \n\t\tLKP_Claim_Case_Dim.claim_case_dim_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.AgencyAKID, \n\t\tLKP_V2_Agency.SalesTerritoryAKID, \n\t\tLKP_V2_Agency.RegionalSalesManagerAKID, \n\t\tLKP_RegionalSalesManager.SalesDirectorAKID, \n\t\tLKP_V2_policy.StrategicProfitCenterAKId, \n\t\tLKP_V2_policy.InsuranceSegmentAKId, \n\t\tLKP_V2_policy.PolicyOfferingAKId, \n\t\tLKP_agency_dim.agency_dim_id, \n\t\tLKP_claim_occurrence_Date.pol_key_ak_id AS PolicyAkid\n\t\tFROM EXP_Lkp_Dim_ids\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Case_Dim\n\t\tON LKP_Claim_Case_Dim.edw_claim_case_ak_id = LKP_Claim_Case.claim_case_ak_id AND LKP_Claim_Case_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Case_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_RegionalSalesManager\n\t\tON LKP_RegionalSalesManager.RegionalSalesManagerAKID = LKP_V2_Agency.RegionalSalesManagerAKID AND LKP_RegionalSalesManager.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_RegionalSalesManager.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_Agency\n\t\tON LKP_V2_Agency.AgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_V2_Agency.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_V2_Agency.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_ak_id = LKP_claim_occurrence_Date.pol_key_ak_id AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_dim\n\t\tON LKP_agency_dim.edw_agency_ak_id = LKP_V2_policy.agency_ak_id AND LKP_agency_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_Date\n\t\tON LKP_claim_occurrence_Date.claim_occurrence_ak_id = LKP_Claim_Party_occurrence.claim_occurrence_ak_id AND LKP_claim_occurrence_Date.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_Date.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_ak_id = LKP_V2_policy.contract_cust_ak_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nmplt_Claimant_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nmplt_Claimant_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_Claimant_coverage_detail AS (\n\t\tSELECT\n\t\tclaim_party_occurrence_ak_id,\n\t\tclaimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_party_occurrence_ak_id,\n\t\t\t\tclaimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_detail\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claim_party_occurrence_ak_id DESC) = 1\n\t),\n\tLKP_CLAIMANT_DIM AS (\n\t\tSELECT\n\t\tclaimant_dim_id,\n\t\tedw_claim_party_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT claimant_dim.claimant_dim_id as claimant_dim_id, claimant_dim.edw_claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id, claimant_dim.eff_from_date as eff_from_date, claimant_dim.eff_to_date as eff_to_date \r\n\t\t\tFROM claimant_dim\r\n\t\t\tWHERE edw_claim_party_occurrence_ak_id IN\r\n\t\t\t(select claim_party_occurrence_ak_id from @{pipeline().parameters.DB_NAME_EDW}.dbo.claim_party_occurrence where claim_party_role_code in ('CMT','CLMT'))\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claimant_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_dim_id\n\t\tFROM LKP_CLAIMANT_DIM\n\t),\n),\nmplt_Strategic_Business_Division_Dim AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, SYSDATE, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nmplt_claimant_coverage_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_CLAIMANT_COV_DIM AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaimant_cov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claimant_cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id\n\t\tFROM LKP_CLAIMANT_COV_DIM\n\t),\n),\nmplt_claimant_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_CLAIMANT_COV_DIM AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaimant_cov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claimant_coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY claimant_cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tclaimant_cov_dim_id\n\t\tFROM LKP_CLAIMANT_COV_DIM\n\t),\n),\nmplt_coverage_dim_hist_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nmplt_coverage_dim_id AS (WITH\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claimant_cov_det_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_coverage_dim AS (\n\t\tSELECT\n\t\tcov_dim_id,\n\t\tedw_claimant_cov_det_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcov_dim_id,\n\t\t\t\tedw_claimant_cov_det_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM coverage_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claimant_cov_det_ak_id,eff_from_date,eff_to_date ORDER BY cov_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tcov_dim_id\n\t\tFROM LKP_coverage_dim\n\t),\n),\nEXP_Values AS (\n\tSELECT\n\tEXP_get_values.logical_flag,\n\tmplt_Strategic_Business_Division_Dim.strtgc_bus_dvsn_dim_id,\n\tEXP_get_values.reins_cov_ak_id,\n\tEXP_get_values.claim_reins_trans_date,\n\tEXP_get_values.trans_date_out,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_occurrence_dim_id AS claim_occurrence_dim_hist_id,\n\tmplt_Claimant_dim_id.claimant_dim_id,\n\tmplt_Claimant_dim_hist_id.claimant_dim_id AS claimant_dim_hist_id,\n\tmplt_claimant_coverage_dim_id.claimant_cov_dim_id,\n\tmplt_claimant_coverage_dim_hist_id.claimant_cov_dim_id AS claimant_cov_dim_hist_id,\n\tmplt_coverage_dim_id.cov_dim_id,\n\tmplt_coverage_dim_hist_id.cov_dim_id AS cov_dim_hist_id,\n\tLKP_Claim_Transaction_Type_Dim.claim_trans_type_dim_id,\n\tLKP_claim_financial_type_dim.claim_financial_type_dim_id,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_claim_rep_id AS claim_rep_dim_prim_claim_rep_id1,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_prim_claim_rep_id,\n\tmplt_Claim_occurence_dim_id.pol_key_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.pol_key_dim_id AS pol_key_dim_hist_id,\n\tEXP_get_values.reprocess_date,\n\tmplt_Claim_occurence_dim_id.claim_loss_date,\n\tmplt_Claim_occurence_dim_id.claim_discovery_date,\n\tmplt_Claim_occurence_dim_id.claim_scripted_date,\n\tmplt_Claim_occurence_dim_id.source_claim_rpted_date,\n\tmplt_Claim_occurence_dim_id.claim_occurrence_rpted_date,\n\tmplt_Claim_occurence_dim_id.claim_open_date,\n\tmplt_Claim_occurence_dim_id.claim_close_date,\n\tmplt_Claim_occurence_dim_id.claim_reopen_date,\n\tmplt_Claim_occurence_dim_id.claim_closed_after_reopen_date,\n\tmplt_Claim_occurence_dim_id.claim_notice_only_date,\n\tmplt_Claim_occurence_dim_id.claim_cat_start_date,\n\tmplt_Claim_occurence_dim_id.claim_cat_end_date,\n\tmplt_Claim_occurence_dim_id.claim_rep_assigned_date,\n\tmplt_Claim_occurence_dim_id.claim_rep_unassigned_date,\n\tEXP_get_values.claim_reins_trans_id,\n\tmplt_Claim_occurence_dim_id.pol_eff_date,\n\tmplt_Claim_occurence_dim_id.pol_exp_date,\n\tEXP_get_values.claimant_cov_det_ak_id,\n\tEXP_get_values.claim_reins_financial_type_code,\n\tEXP_get_values.claim_reins_trans_code,\n\tEXP_get_values.trans_ctgry_code,\n\tEXP_get_values.claim_reins_trans_amt,\n\tEXP_get_values.claim_reins_trans_hist_amt,\n\tEXP_get_values.source_sys_id,\n\tmplt_Claim_occurence_dim_id.agency_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.agency_dim_id AS agency_dim_hist_id,\n\tEXP_get_values.claim_reins_trans_ak_id,\n\tEXP_get_values.claim_reins_draft_num,\n\tEXP_get_values.claim_reins_acct_entered_date AS IN_claim_reins_acct_entered_date,\n\tEXP_get_values.offset_onset_ind,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_examiner_id,\n\tmplt_Claim_occurence_dim_id.claim_rep_dim_prim_litigation_handler_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_examiner_id AS claim_rep_dim_examiner_hist_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_rep_dim_prim_litigation_handler_id AS claim_rep_dim_prim_litigation_handler_hist_id,\n\tmplt_Claim_occurence_dim_id.claim_created_by_id,\n\tmplt_Claim_occurence_dim_id.claim_case_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.claim_case_dim_id AS claim_case_dim_hist_id,\n\tmplt_Claim_occurence_dim_id.contract_cust_dim_id,\n\tmplt_Claim_occurrence_dim_hist_id.contract_cust_dim_id AS contract_cust_dim_hist_id,\n\tmplt_Claim_occurence_dim_id.AgencyDimID,\n\tmplt_Claim_occurrence_dim_hist_id.SalesDirectorAKID,\n\tmplt_Claim_occurrence_dim_hist_id.AgencyDimID AS AgencyDimID1,\n\tmplt_Claim_occurence_dim_id.SalesDirectorAKID AS SalesDirectorAKID1,\n\tmplt_Claim_occurrence_dim_hist_id.PolicyAkid\n\tFROM EXP_get_values\n\t -- Manually join with mplt_Claim_occurence_dim_id\n\t -- Manually join with mplt_Claim_occurrence_dim_hist_id\n\t -- Manually join with mplt_Claimant_dim_hist_id\n\t -- Manually join with mplt_Claimant_dim_id\n\t -- Manually join with mplt_Strategic_Business_Division_Dim\n\t -- Manually join with mplt_claimant_coverage_dim_hist_id\n\t -- Manually join with mplt_claimant_coverage_dim_id\n\t -- Manually join with mplt_coverage_dim_hist_id\n\t -- Manually join with mplt_coverage_dim_id\n\tLEFT JOIN LKP_Claim_Transaction_Type_Dim\n\tON LKP_Claim_Transaction_Type_Dim.trans_ctgry_code = EXP_get_values.trans_ctgry_code AND LKP_Claim_Transaction_Type_Dim.trans_base_type_code = EXP_get_values.claim_reins_trans_base_type_code AND LKP_Claim_Transaction_Type_Dim.trans_kind_code = EXP_get_values.trans_kind_code AND LKP_Claim_Transaction_Type_Dim.trans_code = EXP_get_values.claim_reins_trans_code AND LKP_Claim_Transaction_Type_Dim.type_disability = EXP_get_values.type_disability AND LKP_Claim_Transaction_Type_Dim.offset_onset_ind = EXP_get_values.offset_onset_ind\n\tLEFT JOIN LKP_claim_financial_type_dim\n\tON LKP_claim_financial_type_dim.financial_type_code = EXP_get_values.claim_reins_financial_type_code\n),\nLKP_CoverageDetailDim AS (\n\tSELECT\n\tCoverageDetailDimId,\n\tclaim_reins_trans_id,\n\tPolicyAkid\n\tFROM (\n\t\tSELECT CDD.CoverageDetailDimId as CoverageDetailDimId,\r\n\t\tCRT.claim_reins_trans_id as claim_reins_trans_id,\r\n\t\tPC.PolicyAkid as PolicyAkid       \r\n\t\tFROM    @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_reinsurance_transaction CRT\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\ton CCD.claimant_cov_det_ak_id = CRT.claimant_cov_det_ak_id and CCD.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton CCD.RatingCoverageAKId=RC.RatingCoverageAKID\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\ton RC.RatingCoverageAKID=PT.RatingCoverageAKId\r\n\t\tand RC.EffectiveDate=PT.EffectiveDate\r\n\t\tand PT.SourceSystemID='DCT'\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RC.PolicyCoverageAKID=PC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\tand PC.SourceSystemID='DCT'\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim CDD\r\n\t\ton PT.PremiumTransactionID=CDD.EDWPremiumTransactionPKId and CDD.ExpirationDate='2100-12-31 23:59:59'\r\n\t\tunion\r\n\t\tSELECT CDD.CoverageDetailDimId as CoverageDetailDimId,\r\n\t\tCRT.claim_reins_trans_id as claim_reins_trans_id,\r\n\t\tPC.PolicyAkid as PolicyAkid\r\n\t\tFROM    @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_reinsurance_transaction CRT\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\ton CCD.claimant_cov_det_ak_id = CRT.claimant_cov_det_ak_id and CCD.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton CCD.StatisticalCoverageAKID=SC.StatisticalCoverageAKID\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton SC.PolicyCoverageAKID=PC.PolicyCoverageAKID\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\tand PC.SourceSystemID='PMS'\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\t\ton SC.StatisticalCoverageAKID=PT.StatisticalCoverageAKID\r\n\t\tand PT.SourceSystemID='PMS'\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.CoverageDetailDim CDD\r\n\t\ton PT.PremiumTransactionID=CDD.EDWPremiumTransactionPKId and CDD.ExpirationDate='2100-12-31 23:59:59'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_reins_trans_id,PolicyAkid ORDER BY CoverageDetailDimId) = 1\n),\nLKP_InsuranceReferenceCoverageDim AS (\n\tSELECT\n\tInsuranceReferenceCoverageDimId,\n\tclaimant_cov_det_ak_id,\n\tEffectiveDate,\n\tExpirationDate\n\tFROM (\n\t\tSELECT T.claimant_cov_det_ak_id AS claimant_cov_det_ak_id,\r\n\t\t       T.InsuranceReferenceCoverageDimId AS InsuranceReferenceCoverageDimId,\r\n\t\tT.EffectiveDate as EffectiveDate,\r\n\t\tT.ExpirationDate as ExpirationDate\r\n\t\t       FROM\r\n\t\t( SELECT CCD.claimant_cov_det_ak_id,\r\n\t\t       IRC.InsuranceReferenceCoverageDimId,\r\n\t\tRC.RatingCoverageEffectiveDate EffectiveDate,\r\n\t\tRC.RatingCoverageExpirationDate ExpirationDate\r\n\t\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD,\r\n\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence  CPO,\r\n\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO,\r\n\t\t       @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC,\r\n\t\t       @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC,\r\n\t\t       @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_insurance_line SIL,\r\n\t\t       @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim IRC\r\n\t\tWHERE  SIL.ins_line_code = PC.InsuranceLine\r\n\t\tAND CCD.claim_party_occurrence_ak_id=CPO.claim_party_occurrence_ak_id and CPO.crrnt_snpsht_flag=1 \r\n\t\t\t\tAND CPO.claim_occurrence_ak_id=CO.claim_occurrence_ak_id and CO.crrnt_snpsht_flag=1\r\n\t\t       AND CCD.RatingCoverageAKId = rc.RatingCoverageAKID\r\n\t\t       AND pc.PolicyCoverageAKID = rc.PolicyCoverageAKID\r\n\t\t\t   AND co.pol_key_ak_id=pc.policyakid\r\n\t\t       AND IRC.DctCoverageTypeCode= RC.CoverageType \r\n\t\t       AND IRC.DctRiskTypeCode =  CASE WHEN RC.CoverageForm='BusinessAuto' THEN 'N/A' ELSE RC.RiskType END \r\n\t\t       AND IRC.InsuranceLineCode = SIL.StandardInsuranceLineCode\r\n\t\t       AND IRC.DctPerilGroup=RC.PerilGroup\r\n\t\t       AND NOT (IRC.DctRiskTypeCode='N/A' AND IRC.DctCoverageTypeCode='N/A' AND IRC.DctPerilGroup='N/A')\r\n\t\t       AND CCD.crrnt_snpsht_flag = 1\r\n\t\t       AND PC.CurrentSnapshotFlag = 1\r\n\t\t       AND SIL.crrnt_snpsht_flag = 1\r\n\t\tUNION ALL\r\n\t\tSELECT T2.claimant_cov_det_ak_id,\r\n\t\t       IRC.InsuranceReferenceCoverageDimId,\r\n\t\t'1800-1-1' EffectiveDate,\r\n\t\t'2100-12-31 23:59:59' ExpirationDate\r\n\t\tFROM (SELECT claimant_cov_det_ak_id,\r\n\t\t\t\t\t COALESCE(StandardInsuranceLineCode,'N/A') AS StandardInsuranceLineCode,\r\n\t\t\t\t\t COALESCE(MajorPerilCode,'N/A') AS MajorPerilCode,\r\n\t\t\t\t\t\t\t CASE WHEN (StandardInsuranceLineCode IN ('GL') AND (MajorPerilCode<>'540'\r\n\t\t\t\t        OR ClassCode NOT IN ( '11111','22222','22250','92100','17000','17001','17002')))\r\n\t\t\t\t        OR (StandardInsuranceLineCode IN( 'WC','IM','CG','CA'))\r\n\t\t\t\t\t OR (StandardInsuranceLineCode='N/A' AND TypeBureauCode in ('CF','B2','BB','BE','BF','BM','BT','FT','GL','GS','IM','MS','PF','PH','PI','PL','PQ','WC','WP','NB','RL','RN','RP'))\r\n\t\t\t\t\t THEN 'N/A' ELSE COALESCE(RiskUnit,'N/A') END AS RiskUnit,\r\n\t\t\t\t\t CASE WHEN StandardInsuranceLineCode='CR' \r\n\t\t\t\t\t OR (StandardInsuranceLineCode='N/A' AND TypeBureauCode in ('CF','B2','BB','BE','BF','BM','BT','FT','GL','GS','IM','MS','PF','PH','PI','PL','PQ','WC','WP','NB','RL','RN','RP'))\r\n\t\t\t\t\t THEN 'N/A' ELSE COALESCE(RiskUnitGroup,'N/A') END AS RiskUnitGroup,\r\n\t\t \t\t\tCASE WHEN REPLACE(ProductTypeCode ,'0','')=''  OR StandardInsuranceLineCode<>'GL' \r\n\t\t\t\t        THEN 'N/A' ELSE COALESCE(REPLACE(ProductTypeCode ,'0',''),'N/A') END AS ProductTypeCode \r\n\t\t\t FROM (\r\n\t\tSELECT CCD.claimant_cov_det_ak_id,\r\n\t\t\t\t     PC.TypeBureauCode,\r\n\t\t\t\t\t \t\t\t CASE WHEN REPLACE(SC.RiskUnit,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.RiskUnit,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.RiskUnit)) END AS RiskUnit,\r\n\t\t\t\t\t CASE WHEN REPLACE(SC.RiskUnitGroup,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.RiskUnitGroup,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.RiskUnitGroup)) END AS RiskUnitGroup,\r\n\t\t\t\t\t CASE WHEN REPLACE(SC.MajorPerilCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SC.MajorPerilCode,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SC.MajorPerilCode)) END MajorPerilCode,\r\n\t\t\t\t\t CASE WHEN (REPLACE(SIL.StandardInsuranceLineCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SIL.StandardInsuranceLineCode,' ',''))<>0 OR SIL.StandardInsuranceLineCode='N/A') \r\n\t\t\t\t\t AND (PC.TypeBureauCode IN ('AL','AN','AP') OR SC.MajorPerilCode IN ('930','931')) THEN 'CA' WHEN REPLACE(SIL.StandardInsuranceLineCode,'0','')='' OR PATINDEX('%[^0-9a-zA-Z]%',REPLACE(SIL.StandardInsuranceLineCode,' ',''))<>0 THEN 'N/A' ELSE LTRIM(RTRIM(SIL.StandardInsuranceLineCode)) END AS StandardInsuranceLineCode,\r\n\t\t            SC.ClassCode,\r\n\t\t \t SUBSTRING(sc.RiskUnitSequenceNumber,2,1) as ProductTypeCode\r\n\t\t\t\tFROM   @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC,\r\n\t\t\t\t\t   @{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_insurance_line SIL\r\n\t\t\t\tWHERE  CCD.StatisticalCoverageAKID = SC.StatisticalCoverageAKID\r\n\t\t\t\t\t   AND PC.PolicyCoverageAKID = SC.PolicyCoverageAKID\r\n\t\t\t\t\t   AND SC.SourcesystemID = 'PMS'\r\n\t\t\t\t\t   AND SIL.ins_line_code = PC.InsuranceLine\r\n\t\t\t\t\t   AND CCD.crrnt_snpsht_flag = 1\r\n\t\t\t\t\t   AND SIL.crrnt_snpsht_flag = 1)T1) T2,    \r\n\t\t       @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceCoverageDim IRC\r\n\t\tWHERE  IRC.PmsRiskUnitCode = T2.RiskUnit\r\n\t\t       AND IRC.PmsRiskUnitGroupCode = T2.RiskUnitGroup\r\n\t\t       AND IRC.PmsMajorPerilCode = T2.MajorPerilCode \r\n\t\t       AND IRC.InsuranceLineCode = T2.StandardInsuranceLineCode\r\n\t\t       AND IRC.PmsProductTypeCode = T2.ProductTypeCode\r\n\t\t       AND IRC.DctRiskTypeCode='N/A' \r\n\t\t       AND IRC.DctCoverageTypeCode='N/A'\r\n\t\t       AND IRC.DctPerilGroup='N/A') T\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id,EffectiveDate,ExpirationDate ORDER BY InsuranceReferenceCoverageDimId) = 1\n),\nLKP_InsuranceReferenceDimId AS (\n\tSELECT\n\tInsuranceReferenceDimId,\n\tclaimant_cov_det_ak_id\n\tFROM (\n\t\tSELECT CCD.claimant_cov_det_ak_id AS claimant_cov_det_ak_id,\r\n\t\tIRD.InsuranceReferenceDimId AS InsuranceReferenceDimId\r\n\t\tFROM (\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.StatisticalCoverage SC\r\n\t\ton CCD.StatisticalCoverageAKID=SC.StatisticalCoverageAKId\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton SC.PolicyCoverageAKId=PC.PolicyCoverageAKID\r\n\t\twhere SC.SourceSystemId='PMS' and CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tPC.RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence  CPO\r\n\t\ton CCD.claim_party_occurrence_ak_id=CPO.claim_party_occurrence_ak_id\r\n\t\tand CPO.crrnt_snpsht_flag=1\r\n\t\tJoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\ton CPO.claim_occurrence_ak_id=CO.claim_occurrence_ak_id\r\n\t\tand CO.crrnt_snpsht_flag=1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\t\ton CCD.RatingCoverageAKID=RC.RatingCoverageAKId \r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\t\ton RC.PolicyCoverageAKId=PC.PolicyCoverageAKID \r\n\t\tand co.pol_key_ak_id=pc.policyakid\r\n\t\tand PC.CurrentSnapshotFlag=1\r\n\t\twhere CCD.crrnt_snpsht_flag =1\r\n\t\t\r\n\t\tunion all\r\n\t\tselect CCD.claimant_cov_det_ak_id,\r\n\t\tCCD.Claim_party_occurrence_ak_id,\r\n\t\tCCD.ProductAKId,\r\n\t\tCCD.InsuranceReferenceLineOfBusinessAKID,\r\n\t\tnull RatingPlanAKId\r\n\t\tfrom @{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_detail CCD\r\n\t\twhere CCD.crrnt_snpsht_flag =1 and CCD.StatisticalCoverageAKID=-1 and CCD.RatingCoverageAKID=-1\r\n\t\t ) CCD\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_party_occurrence CPO\r\n\t\ton CCD.Claim_party_occurrence_ak_id = CPO.claim_party_occurrence_ak_id\r\n\t\tand CPO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence CO\r\n\t\ton CPO.Claim_Occurrence_ak_id = CO.claim_occurrence_ak_id\r\n\t\tand CO.crrnt_snpsht_flag = 1\r\n\t\tjoin @{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy P\r\n\t\ton CO.pol_key_ak_id = P.pol_ak_id\r\n\t\tand P.crrnt_snpsht_flag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyOffering PO\r\n\t\ton P.PolicyOfferingAKId = PO.PolicyOfferingAKID\r\n\t\tand PO.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment ISe\r\n\t\ton P.InsuranceSegmentAKID = ISe.InsuranceSegmentAKID\r\n\t\tand ISe.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter SPC\r\n\t\ton P.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId\r\n\t\tand SPC.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.EnterpriseGroup EG\r\n\t\ton SPC.EnterPriseGroupId = EG.EnterpriseGroupId\r\n\t\tand EG.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity IRE\r\n\t\ton SPC.InsuranceReferenceLegalEntityId = IRE.InsuranceReferenceLegalEntityId\r\n\t\tand IRE.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.Product Pr\r\n\t\ton CCD.ProductAKId = Pr.ProductAKId\r\n\t\tand Pr.CurrentSnapshotFlag = 1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLineOfBusiness IRLOB\r\n\t\ton CCD.InsuranceReferenceLineOfBusinessAKID = IRLOB.InsuranceReferenceLineOfBusinessAKId\r\n\t\tand IRLOB.CurrentSnapshotFlag =1\r\n\t\tleft join @{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingPlan RPDT\r\n\t\ton CCD.RatingPlanAKId=RPDT.RatingPlanAKId and RPDT.CurrentSnapshotFlag=1\r\n\t\tjoin @{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.InsuranceReferenceDim IRD\r\n\t\ton isnull(Pr.ProductCode, '000') = IRD.ProductCode \r\n\t\tand isnull(PO.PolicyOfferingCode, '000') = IRD.PolicyOfferingCode \r\n\t\tand isnull(ISe.InsuranceSegmentCode, 'N/A') = IRD.InsuranceSegmentCode \r\n\t\tand isnull(SPC.StrategicProfitCenterCode, '6') = IRD.StrategicProfitCenterCode \r\n\t\tand isnull(IRLOB.InsuranceReferenceLineOfBusinessCode, '000') = IRD.InsuranceReferenceLineOfBusinessCode \r\n\t\tand isnull(EG.EnterpriseGroupCode, '1')=IRD.EnterpriseGroupCode \r\n\t\tand isnull(IRE.InsuranceReferenceLegalEntityCode, '1')=IRD.InsuranceReferenceLegalEntityCode\r\n\t\tand isnull(RPDT.RatingPlanCode, '1')=IRD.RatingPlanCode\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claimant_cov_det_ak_id ORDER BY InsuranceReferenceDimId) = 1\n),\nLKP_SalesDivisionDim AS (\n\tSELECT\n\tSalesDivisionDimID,\n\tAgencyAKID\n\tFROM (\n\t\tSelect A.AgencyAKID AS AgencyAKID, \r\n\t\tSDD.SalesDivisionDimID AS SalesDivisionDimID\r\n\t\tFROM \r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency A,\r\n\t\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.RegionalSalesManager RSM,\r\n\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SalesDivisionDim SDD\r\n\t\tWHERE A.CurrentSnapshotFlag =1\r\n\t\tAND RSM.RegionalSalesManagerAKID = A.RegionalSalesManagerAKID\r\n\t\tAND RSM.CurrentSnapshotFlag = 1\r\n\t\tAND RSM.SalesDirectorAKID = SDD.EDWSalesDirectorAKID\r\n\t\tAND A.SalesTerritoryAKID = SDD.EDWSalesTerritoryAKID\r\n\t\tAND RSM.RegionalSalesManagerAKID = SDD.EDWRegionalSalesManagerAKID\r\n\t\tAND SDD.CurrentSnapshotFlag =1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY AgencyAKID ORDER BY SalesDivisionDimID) = 1\n),\nEXP_Financial_Values AS (\n\tSELECT\n\tEXP_Values.logical_flag,\n\tEXP_Values.reins_cov_ak_id,\n\tEXP_Values.trans_date_out,\n\tEXP_Values.strtgc_bus_dvsn_dim_id,\n\t-- *INF*: IIF(ISNULL(strtgc_bus_dvsn_dim_id), 0,strtgc_bus_dvsn_dim_id)\n\tIFF(strtgc_bus_dvsn_dim_id IS NULL, 0, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_dim_id_out,\n\tEXP_Values.claim_occurrence_dim_id,\n\t-- *INF*: iif(isnull(claim_occurrence_dim_id),-1,claim_occurrence_dim_id)\n\tIFF(claim_occurrence_dim_id IS NULL, - 1, claim_occurrence_dim_id) AS claim_occurrence_dim_id_out,\n\tEXP_Values.claim_occurrence_dim_hist_id,\n\t-- *INF*: iif(isnull(claim_occurrence_dim_hist_id),-1,claim_occurrence_dim_hist_id)\n\tIFF(claim_occurrence_dim_hist_id IS NULL, - 1, claim_occurrence_dim_hist_id) AS claim_occurrence_dim_hist_id_out,\n\tEXP_Values.claimant_dim_id,\n\t-- *INF*: iif(isnull(claimant_dim_id),-1,claimant_dim_id)\n\tIFF(claimant_dim_id IS NULL, - 1, claimant_dim_id) AS claimant_dim_id_out,\n\tEXP_Values.claimant_dim_hist_id,\n\t-- *INF*: iif(isnull(claimant_dim_hist_id),-1,claimant_dim_hist_id)\n\tIFF(claimant_dim_hist_id IS NULL, - 1, claimant_dim_hist_id) AS claimant_dim_hist_id_out,\n\tEXP_Values.claimant_cov_dim_id,\n\t-- *INF*: iif(isnull(claimant_cov_dim_id),-1,claimant_cov_dim_id)\n\tIFF(claimant_cov_dim_id IS NULL, - 1, claimant_cov_dim_id) AS claimant_cov_dim_id_out,\n\tEXP_Values.claimant_cov_dim_hist_id,\n\t-- *INF*: iif(isnull(claimant_cov_dim_hist_id),-1,claimant_cov_dim_hist_id)\n\tIFF(claimant_cov_dim_hist_id IS NULL, - 1, claimant_cov_dim_hist_id) AS claimant_cov_dim_hist_id_out,\n\tEXP_Values.cov_dim_id,\n\t-- *INF*: iif(isnull(cov_dim_id),-1,cov_dim_id)\n\tIFF(cov_dim_id IS NULL, - 1, cov_dim_id) AS cov_dim_id_out,\n\tEXP_Values.cov_dim_hist_id,\n\t-- *INF*: iif(isnull(cov_dim_hist_id),-1,cov_dim_hist_id)\n\tIFF(cov_dim_hist_id IS NULL, - 1, cov_dim_hist_id) AS cov_dim_hist_id_out,\n\tEXP_Values.claim_trans_type_dim_id,\n\t-- *INF*: iif(isnull(claim_trans_type_dim_id),-1,claim_trans_type_dim_id)\n\tIFF(claim_trans_type_dim_id IS NULL, - 1, claim_trans_type_dim_id) AS claim_trans_type_dim_id_out,\n\tEXP_Values.claim_financial_type_dim_id,\n\t-- *INF*: iif(isnull(claim_financial_type_dim_id),-1,claim_financial_type_dim_id)\n\tIFF(claim_financial_type_dim_id IS NULL, - 1, claim_financial_type_dim_id) AS claim_financial_type_dim_id_out,\n\tEXP_Values.claim_rep_dim_prim_claim_rep_id1 AS claim_rep_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_id), -1, claim_rep_dim_id)\n\tIFF(claim_rep_dim_id IS NULL, - 1, claim_rep_dim_id) AS claim_rep_dim_prim_claim_rep_id,\n\tEXP_Values.claim_rep_dim_prim_claim_rep_id AS claim_rep_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_hist_id), -1, claim_rep_dim_hist_id)\n\tIFF(claim_rep_dim_hist_id IS NULL, - 1, claim_rep_dim_hist_id) AS claim_rep_dim_prim_claim_rep_hist_id,\n\tEXP_Values.pol_key_dim_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_id), -1, pol_key_dim_id)\n\tIFF(pol_key_dim_id IS NULL, - 1, pol_key_dim_id) AS pol_key_dim_id_out,\n\tEXP_Values.pol_key_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(pol_key_dim_hist_id), -1, pol_key_dim_hist_id)\n\tIFF(pol_key_dim_hist_id IS NULL, - 1, pol_key_dim_hist_id) AS pol_key_dim_hist_id_out,\n\t-1 AS claim_created_by_dim_id,\n\t-1 AS claim_trans_oper_dim_id,\n\tEXP_Values.claim_reins_trans_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_reins_trans_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_reins_trans_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_trans_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_trans_date_id), v_claim_trans_date_id, -1)\n\tIFF(NOT v_claim_trans_date_id IS NULL, v_claim_trans_date_id, - 1) AS claim_reins_trans_date_id,\n\tEXP_Values.reprocess_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(reprocess_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_reprocess_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_reprocess_date_id), v_reprocess_date_id, -1)\n\tIFF(NOT v_reprocess_date_id IS NULL, v_reprocess_date_id, - 1) AS reprocess_date_id,\n\tEXP_Values.claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date_id), v_claim_loss_date_id, -1)\n\tIFF(NOT v_claim_loss_date_id IS NULL, v_claim_loss_date_id, - 1) AS claim_loss_date_id,\n\tEXP_Values.claim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_discovery_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_discovery_date_id), v_claim_discovery_date_id, -1)\n\tIFF(NOT v_claim_discovery_date_id IS NULL, v_claim_discovery_date_id, - 1) AS claim_discovery_date_id,\n\tEXP_Values.claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date_id,\n\t-- *INF*: IIF(ISNULL(v_claim_scripted_date_id),-1,v_claim_scripted_date_id)\n\tIFF(v_claim_scripted_date_id IS NULL, - 1, v_claim_scripted_date_id) AS claim_scripted_date_id,\n\tEXP_Values.source_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_rpted_date_id,\n\t-- *INF*: IIF(ISNULL(v_source_claim_rpted_date_id),-1,v_source_claim_rpted_date_id)\n\tIFF(v_source_claim_rpted_date_id IS NULL, - 1, v_source_claim_rpted_date_id) AS source_claim_rpted_date_id,\n\tEXP_Values.claim_occurrence_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_occurrence_rpted_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_occurrence_rpted_date_id), v_claim_occurrence_rpted_date_id, -1)\n\tIFF(NOT v_claim_occurrence_rpted_date_id IS NULL, v_claim_occurrence_rpted_date_id, - 1) AS claim_occurrence_rpted_date_id,\n\tEXP_Values.claim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date), v_claim_open_date, -1)\n\tIFF(NOT v_claim_open_date IS NULL, v_claim_open_date, - 1) AS claim_open_date_id,\n\tEXP_Values.claim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date), v_claim_close_date, -1)\n\tIFF(NOT v_claim_close_date IS NULL, v_claim_close_date, - 1) AS claim_close_date_id,\n\tEXP_Values.claim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date), v_claim_reopen_date, -1)\n\tIFF(NOT v_claim_reopen_date IS NULL, v_claim_reopen_date, - 1) AS claim_reopen_date_id,\n\tEXP_Values.claim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date), v_claim_closed_after_reopen_date, -1)\n\tIFF(NOT v_claim_closed_after_reopen_date IS NULL, v_claim_closed_after_reopen_date, - 1) AS claim_closed_after_reopen_date_id,\n\tEXP_Values.claim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date), v_claim_notice_only_date, -1)\n\tIFF(NOT v_claim_notice_only_date IS NULL, v_claim_notice_only_date, - 1) AS claim_notice_only_date_id,\n\tEXP_Values.claim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date_id), v_claim_cat_start_date_id, -1)\n\tIFF(NOT v_claim_cat_start_date_id IS NULL, v_claim_cat_start_date_id, - 1) AS claim_cat_start_date_id,\n\tEXP_Values.claim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date_id), v_claim_cat_end_date_id, -1)\n\tIFF(NOT v_claim_cat_end_date_id IS NULL, v_claim_cat_end_date_id, - 1) AS claim_cat_end_date_id,\n\tEXP_Values.claim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date_id), v_claim_rep_assigned_date_id, -1)\n\tIFF(NOT v_claim_rep_assigned_date_id IS NULL, v_claim_rep_assigned_date_id, - 1) AS claim_rep_assigned_date_id,\n\tEXP_Values.claim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date_id), v_claim_rep_unassigned_date_id, -1)\n\tIFF(NOT v_claim_rep_unassigned_date_id IS NULL, v_claim_rep_unassigned_date_id, - 1) AS claim_rep_unassigned_date_id,\n\tEXP_Values.claim_reins_trans_id,\n\tEXP_Values.pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_eff_date_id), v_pol_eff_date_id, -1)\n\tIFF(NOT v_pol_eff_date_id IS NULL, v_pol_eff_date_id, - 1) AS pol_eff_date_id,\n\tEXP_Values.pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date_id,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_exp_date_id), v_pol_exp_date_id, -1 )\n\tIFF(NOT v_pol_exp_date_id IS NULL, v_pol_exp_date_id, - 1) AS pol_exp_date_id,\n\tEXP_Values.claimant_cov_det_ak_id,\n\tEXP_Values.claim_reins_financial_type_code,\n\tEXP_Values.claim_reins_trans_code,\n\tEXP_Values.trans_ctgry_code,\n\tEXP_Values.claim_reins_trans_amt,\n\tEXP_Values.claim_reins_trans_hist_amt,\n\tEXP_Values.source_sys_id,\n\t-- *INF*: :LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D', claim_reins_trans_date)\r\n\t-- \r\n\t-- \n\tLKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id AS var_LKP_claim_transaction,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', \r\n\t-- DECODE(claim_reins_trans_code,  '20', claim_reins_trans_amt, \r\n\t-- '21',claim_reins_trans_amt, \r\n\t-- '22', claim_reins_trans_amt, \r\n\t-- '23',claim_reins_trans_amt, \r\n\t-- '24', claim_reins_trans_amt, \r\n\t-- '28', claim_reins_trans_amt, \r\n\t-- '29', claim_reins_trans_amt, \r\n\t-- '41', 0, \r\n\t-- '42', 0, \r\n\t-- '43', 0, \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t'20', claim_reins_trans_amt,\n\t'21', claim_reins_trans_amt,\n\t'22', claim_reins_trans_amt,\n\t'23', claim_reins_trans_amt,\n\t'24', claim_reins_trans_amt,\n\t'28', claim_reins_trans_amt,\n\t'29', claim_reins_trans_amt,\n\t'41', 0,\n\t'42', 0,\n\t'43', 0,\n\t'65', 0,\n\t'66', 0,\n\t'90', 0,\n\t'91', 0,\n\t'92', 0,\n\t0), 0) AS var_ceded_loss_paid,\n\tvar_ceded_loss_paid AS ceded_loss_paid,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', \r\n\t-- DECODE(claim_reins_trans_code, '20', 0,\r\n\t-- '21', claim_reins_trans_amt * -1, \r\n\t-- '22', (claim_reins_trans_amt  -  claim_reins_trans_hist_amt ) * -1, \r\n\t-- '23', 0, \r\n\t-- '24', 0, \r\n\t-- '28', claim_reins_trans_amt * -1, \r\n\t-- '29', 0, \r\n\t-- '41', claim_reins_trans_hist_amt, \r\n\t-- '42', claim_reins_trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', claim_reins_trans_hist_amt, \r\n\t-- '66', claim_reins_trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0))\n\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t'20', 0,\n\t'21', claim_reins_trans_amt * - 1,\n\t'22', ( claim_reins_trans_amt - claim_reins_trans_hist_amt ) * - 1,\n\t'23', 0,\n\t'24', 0,\n\t'28', claim_reins_trans_amt * - 1,\n\t'29', 0,\n\t'41', claim_reins_trans_hist_amt,\n\t'42', claim_reins_trans_hist_amt,\n\t'43', 0,\n\t'65', claim_reins_trans_hist_amt,\n\t'66', claim_reins_trans_hist_amt,\n\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t0)) AS var_ceded_loss_outstanding,\n\tvar_ceded_loss_outstanding AS ceded_loss_outstanding,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'D', \r\n\t-- DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt,\r\n\t-- '21', 0, \r\n\t-- '22', claim_reins_trans_hist_amt, \r\n\t-- '23', claim_reins_trans_amt, \r\n\t-- '24', claim_reins_trans_amt, \r\n\t-- '28',0, \r\n\t-- '29', claim_reins_trans_amt, \r\n\t-- '41', claim_reins_trans_hist_amt, \r\n\t-- '42', claim_reins_trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', claim_reins_trans_hist_amt, \r\n\t-- '66', claim_reins_trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'D',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 1111))\n\tIFF(claim_reins_financial_type_code = 'D', DECODE(claim_reins_trans_code,\n\t'20', claim_reins_trans_amt,\n\t'21', 0,\n\t'22', claim_reins_trans_hist_amt,\n\t'23', claim_reins_trans_amt,\n\t'24', claim_reins_trans_amt,\n\t'28', 0,\n\t'29', claim_reins_trans_amt,\n\t'41', claim_reins_trans_hist_amt,\n\t'42', claim_reins_trans_hist_amt,\n\t'43', 0,\n\t'65', claim_reins_trans_hist_amt,\n\t'66', claim_reins_trans_hist_amt,\n\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t1111)) AS var_ceded_loss_incurred,\n\tvar_ceded_loss_incurred AS ceded_loss_incurred,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'E', \r\n\t-- DECODE(claim_reins_trans_code,  '20', claim_reins_trans_amt, \r\n\t-- '21',claim_reins_trans_amt, \r\n\t-- '22', claim_reins_trans_amt, \r\n\t-- '23',claim_reins_trans_amt, \r\n\t-- '24', claim_reins_trans_amt, \r\n\t-- '28', claim_reins_trans_amt, \r\n\t-- '29', claim_reins_trans_amt,\r\n\t-- '40',0, \r\n\t-- '41', 0, \r\n\t-- '42', 0, \r\n\t-- '43', 0, \r\n\t-- '65',0, \r\n\t-- '66', 0, \r\n\t-- '90', 0, \r\n\t-- '91', 0, \r\n\t-- '92', 0, 0),0)\n\tIFF(claim_reins_financial_type_code = 'E', DECODE(claim_reins_trans_code,\n\t'20', claim_reins_trans_amt,\n\t'21', claim_reins_trans_amt,\n\t'22', claim_reins_trans_amt,\n\t'23', claim_reins_trans_amt,\n\t'24', claim_reins_trans_amt,\n\t'28', claim_reins_trans_amt,\n\t'29', claim_reins_trans_amt,\n\t'40', 0,\n\t'41', 0,\n\t'42', 0,\n\t'43', 0,\n\t'65', 0,\n\t'66', 0,\n\t'90', 0,\n\t'91', 0,\n\t'92', 0,\n\t0), 0) AS var_ceded_alae_paid,\n\tvar_ceded_alae_paid AS ceded_alae_paid,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'E' and source_sys_id = 'EXCEED',\r\n\t-- DECODE(claim_reins_trans_code, '20', 0,\r\n\t-- '21', claim_reins_trans_amt * -1, \r\n\t-- '22', (claim_reins_trans_amt -  claim_reins_trans_hist_amt ) * -1, \r\n\t-- '23', 0, \r\n\t-- '24', 0, \r\n\t-- '28', claim_reins_trans_amt * -1, \r\n\t-- '29', 0,\r\n\t-- '40',claim_reins_trans_hist_amt, \r\n\t-- '41', claim_reins_trans_hist_amt, \r\n\t-- '42', claim_reins_trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', claim_reins_trans_hist_amt, \r\n\t-- '66', claim_reins_trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0),\r\n\t-- 0)\n\tIFF(claim_reins_financial_type_code = 'E' AND source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code,\n\t'20', 0,\n\t'21', claim_reins_trans_amt * - 1,\n\t'22', ( claim_reins_trans_amt - claim_reins_trans_hist_amt ) * - 1,\n\t'23', 0,\n\t'24', 0,\n\t'28', claim_reins_trans_amt * - 1,\n\t'29', 0,\n\t'40', claim_reins_trans_hist_amt,\n\t'41', claim_reins_trans_hist_amt,\n\t'42', claim_reins_trans_hist_amt,\n\t'43', 0,\n\t'65', claim_reins_trans_hist_amt,\n\t'66', claim_reins_trans_hist_amt,\n\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t0), 0) AS var_ceded_alae_outstanding,\n\tvar_ceded_alae_outstanding AS ceded_alae_outstanding,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'E' and source_sys_id = 'EXCEED',\r\n\t-- DECODE(claim_reins_trans_code, '20', claim_reins_trans_amt,\r\n\t-- '21', 0, \r\n\t-- '22', claim_reins_trans_hist_amt, \r\n\t-- '23', claim_reins_trans_amt, \r\n\t-- '24', claim_reins_trans_amt, \r\n\t-- '28',claim_reins_trans_amt, \r\n\t-- '29', claim_reins_trans_amt,\r\n\t-- '40', claim_reins_trans_hist_amt, \r\n\t-- '41', claim_reins_trans_hist_amt, \r\n\t-- '42', claim_reins_trans_hist_amt, \r\n\t-- '43', 0, \r\n\t-- '65', claim_reins_trans_hist_amt, \r\n\t-- '66', claim_reins_trans_hist_amt, \r\n\t-- '90', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '91', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), \r\n\t-- '92', IIF(NOT ISNULL(:LKP.LKP_CLAIM_REINSURANCE_TRANSACTION(claimant_cov_det_ak_id, 'E',claim_reins_trans_date)), 0, claim_reins_trans_hist_amt), 0),\r\n\t-- 0)\n\tIFF(claim_reins_financial_type_code = 'E' AND source_sys_id = 'EXCEED', DECODE(claim_reins_trans_code,\n\t'20', claim_reins_trans_amt,\n\t'21', 0,\n\t'22', claim_reins_trans_hist_amt,\n\t'23', claim_reins_trans_amt,\n\t'24', claim_reins_trans_amt,\n\t'28', claim_reins_trans_amt,\n\t'29', claim_reins_trans_amt,\n\t'40', claim_reins_trans_hist_amt,\n\t'41', claim_reins_trans_hist_amt,\n\t'42', claim_reins_trans_hist_amt,\n\t'43', 0,\n\t'65', claim_reins_trans_hist_amt,\n\t'66', claim_reins_trans_hist_amt,\n\t'90', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'91', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t'92', IFF(NOT LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id IS NULL, 0, claim_reins_trans_hist_amt),\n\t0), 0) AS var_ceded_alae_incurred,\n\t-- *INF*: var_ceded_alae_paid + var_ceded_alae_outstanding\r\n\t-- \r\n\t-- ---var_ceded_alae_incurred\n\tvar_ceded_alae_paid + var_ceded_alae_outstanding AS ceded_alae_incurred,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tEXP_Values.agency_dim_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_id), -1, agency_dim_id)\n\tIFF(agency_dim_id IS NULL, - 1, agency_dim_id) AS agency_dim_id_out,\n\tEXP_Values.AgencyDimID1 AS agency_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(agency_dim_hist_id), -1, agency_dim_hist_id)\n\tIFF(agency_dim_hist_id IS NULL, - 1, agency_dim_hist_id) AS agency_dim_hist_id_out,\n\tEXP_Values.claim_reins_trans_ak_id,\n\tEXP_Values.claim_reins_draft_num,\n\tEXP_Values.IN_claim_reins_acct_entered_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_reins_acct_entered_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_reins_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS V_claim_reins_acct_entered_date,\n\t-- *INF*: IIF(NOT ISNULL(V_claim_reins_acct_entered_date), V_claim_reins_acct_entered_date, -1)\n\tIFF(NOT V_claim_reins_acct_entered_date IS NULL, V_claim_reins_acct_entered_date, - 1) AS OUT_claim_reins_acct_entered_date_Id,\n\tEXP_Values.offset_onset_ind,\n\t'000000' AS Error_Flag,\n\tEXP_Values.claim_rep_dim_examiner_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_id), -1, claim_rep_dim_examiner_id)\n\tIFF(claim_rep_dim_examiner_id IS NULL, - 1, claim_rep_dim_examiner_id) AS claim_rep_dim_examiner_id_Out,\n\tEXP_Values.claim_rep_dim_prim_litigation_handler_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_id), -1, claim_rep_dim_prim_litigation_handler_id)\n\tIFF(claim_rep_dim_prim_litigation_handler_id IS NULL, - 1, claim_rep_dim_prim_litigation_handler_id) AS claim_rep_dim_prim_litigation_handler_id_out,\n\tEXP_Values.claim_rep_dim_examiner_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_examiner_hist_id), -1, claim_rep_dim_examiner_hist_id)\n\tIFF(claim_rep_dim_examiner_hist_id IS NULL, - 1, claim_rep_dim_examiner_hist_id) AS claim_rep_dim_examiner_hist_id_out,\n\tEXP_Values.claim_rep_dim_prim_litigation_handler_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_rep_dim_prim_litigation_handler_hist_id), -1, claim_rep_dim_prim_litigation_handler_hist_id)\n\tIFF(claim_rep_dim_prim_litigation_handler_hist_id IS NULL, - 1, claim_rep_dim_prim_litigation_handler_hist_id) AS claim_rep_dim_prim_litigation_handler_hist_id_out,\n\tEXP_Values.claim_created_by_id,\n\t-- *INF*: IIF(ISNULL(claim_created_by_id),-1,claim_created_by_id)\n\tIFF(claim_created_by_id IS NULL, - 1, claim_created_by_id) AS claim_created_by_dim_id_out,\n\tEXP_Values.claim_case_dim_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_id),-1,claim_case_dim_id)\n\tIFF(claim_case_dim_id IS NULL, - 1, claim_case_dim_id) AS claim_case_dim_id_out,\n\tEXP_Values.claim_case_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(claim_case_dim_hist_id),-1,claim_case_dim_hist_id)\n\tIFF(claim_case_dim_hist_id IS NULL, - 1, claim_case_dim_hist_id) AS claim_case_dim_hist_id_out,\n\tEXP_Values.contract_cust_dim_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_id),-1,contract_cust_dim_id)\n\tIFF(contract_cust_dim_id IS NULL, - 1, contract_cust_dim_id) AS contract_cust_dim_id_out,\n\tEXP_Values.contract_cust_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(contract_cust_dim_hist_id),-1,contract_cust_dim_hist_id)\n\tIFF(contract_cust_dim_hist_id IS NULL, - 1, contract_cust_dim_hist_id) AS contract_cust_dim_hist_id_out,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'S', \r\n\t-- DECODE(claim_reins_trans_code, \r\n\t-- '25', claim_reins_trans_amt * -1, \r\n\t-- '31', claim_reins_trans_amt * -1, \r\n\t-- '32', claim_reins_trans_amt * -1, \r\n\t-- '33', claim_reins_trans_amt * -1, \r\n\t-- '34', claim_reins_trans_amt * -1, \r\n\t-- '38', claim_reins_trans_amt * -1, \r\n\t-- '39', claim_reins_trans_amt * -1 \r\n\t-- , 0),0)\n\tIFF(claim_reins_financial_type_code = 'S', DECODE(claim_reins_trans_code,\n\t'25', claim_reins_trans_amt * - 1,\n\t'31', claim_reins_trans_amt * - 1,\n\t'32', claim_reins_trans_amt * - 1,\n\t'33', claim_reins_trans_amt * - 1,\n\t'34', claim_reins_trans_amt * - 1,\n\t'38', claim_reins_trans_amt * - 1,\n\t'39', claim_reins_trans_amt * - 1,\n\t0), 0) AS var_ceded_salvage_paid,\n\tvar_ceded_salvage_paid AS ceded_salvage_paid,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'B', \r\n\t-- DECODE(claim_reins_trans_code, \r\n\t-- '25', claim_reins_trans_amt * -1, \r\n\t-- '31', claim_reins_trans_amt * -1, \r\n\t-- '32', claim_reins_trans_amt * -1, \r\n\t-- '33', claim_reins_trans_amt * -1, \r\n\t-- '34', claim_reins_trans_amt * -1, \r\n\t-- '38', claim_reins_trans_amt * -1, \r\n\t-- '39', claim_reins_trans_amt * -1 \r\n\t-- , 0),0)\n\tIFF(claim_reins_financial_type_code = 'B', DECODE(claim_reins_trans_code,\n\t'25', claim_reins_trans_amt * - 1,\n\t'31', claim_reins_trans_amt * - 1,\n\t'32', claim_reins_trans_amt * - 1,\n\t'33', claim_reins_trans_amt * - 1,\n\t'34', claim_reins_trans_amt * - 1,\n\t'38', claim_reins_trans_amt * - 1,\n\t'39', claim_reins_trans_amt * - 1,\n\t0), 0) AS var_ceded_subrogation_paid,\n\tvar_ceded_subrogation_paid AS ceded_subrogation_paid,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'R' and trans_ctgry_code<>'EX', \r\n\t-- DECODE(claim_reins_trans_code, \r\n\t-- '25', claim_reins_trans_amt * -1, \r\n\t-- '31', claim_reins_trans_amt * -1, \r\n\t-- '32', claim_reins_trans_amt * -1, \r\n\t-- '33', claim_reins_trans_amt * -1, \r\n\t-- '34', claim_reins_trans_amt * -1, \r\n\t-- '38', claim_reins_trans_amt * -1, \r\n\t-- '39', claim_reins_trans_amt * -1 \r\n\t-- , 0),0)\n\tIFF(claim_reins_financial_type_code = 'R' AND trans_ctgry_code <> 'EX', DECODE(claim_reins_trans_code,\n\t'25', claim_reins_trans_amt * - 1,\n\t'31', claim_reins_trans_amt * - 1,\n\t'32', claim_reins_trans_amt * - 1,\n\t'33', claim_reins_trans_amt * - 1,\n\t'34', claim_reins_trans_amt * - 1,\n\t'38', claim_reins_trans_amt * - 1,\n\t'39', claim_reins_trans_amt * - 1,\n\t0), 0) AS var_ceded_other_recovery_loss_paid,\n\tvar_ceded_other_recovery_loss_paid AS ceded_other_recovery_loss_paid,\n\t-- *INF*: IIF(claim_reins_financial_type_code = 'R' and trans_ctgry_code = 'EX', \r\n\t-- DECODE(claim_reins_trans_code, \r\n\t-- '25', claim_reins_trans_amt * -1, \r\n\t-- '31', claim_reins_trans_amt * -1, \r\n\t-- '32', claim_reins_trans_amt * -1, \r\n\t-- '33', claim_reins_trans_amt * -1, \r\n\t-- '34', claim_reins_trans_amt * -1, \r\n\t-- '38', claim_reins_trans_amt * -1, \r\n\t-- '39', claim_reins_trans_amt * -1 \r\n\t-- , 0),0)\n\tIFF(claim_reins_financial_type_code = 'R' AND trans_ctgry_code = 'EX', DECODE(claim_reins_trans_code,\n\t'25', claim_reins_trans_amt * - 1,\n\t'31', claim_reins_trans_amt * - 1,\n\t'32', claim_reins_trans_amt * - 1,\n\t'33', claim_reins_trans_amt * - 1,\n\t'34', claim_reins_trans_amt * - 1,\n\t'38', claim_reins_trans_amt * - 1,\n\t'39', claim_reins_trans_amt * - 1,\n\t0), 0) AS var_ceded_other_recovery_alae_paid,\n\tvar_ceded_other_recovery_alae_paid AS ceded_other_recovery_alae_paid,\n\t-- *INF*: round(var_ceded_salvage_paid+var_ceded_subrogation_paid+var_ceded_other_recovery_loss_paid,2)\n\tround(var_ceded_salvage_paid + var_ceded_subrogation_paid + var_ceded_other_recovery_loss_paid, 2) AS var_total_ceded_loss_recovery_paid,\n\tvar_total_ceded_loss_recovery_paid AS total_ceded_loss_recovery_paid,\n\tvar_ceded_loss_paid *-1 AS net_loss_paid,\n\tvar_ceded_loss_outstanding*-1 AS net_loss_outstanding,\n\tvar_ceded_loss_incurred  *  -1 AS net_loss_incurred,\n\tvar_ceded_alae_paid*-1 AS net_alae_paid,\n\tvar_ceded_alae_outstanding*-1 AS net_alae_outstanding,\n\tvar_ceded_alae_incurred*-1 AS net_alae_incurred,\n\t-1 AS default_id,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(TO_DATE('01/01/1800 00:00:00','MM/DD/YYYY HH24:MI:SS'))\n\tLKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_id AS DEFAULT_DATE_ID,\n\t'N/A' AS DEFAULT_STRING,\n\t0 AS DEFAULT_AMOUNT,\n\tEXP_Values.AgencyDimID,\n\t-- *INF*: iif(isnull(AgencyDimID),-1,AgencyDimID)\n\tIFF(AgencyDimID IS NULL, - 1, AgencyDimID) AS AgencyDimID_out,\n\tLKP_SalesDivisionDim.SalesDivisionDimID,\n\t-- *INF*: iif(isnull(SalesDivisionDimID),-1,SalesDivisionDimID)\n\tIFF(SalesDivisionDimID IS NULL, - 1, SalesDivisionDimID) AS SalesDivisionDimID_out,\n\tLKP_InsuranceReferenceDimId.InsuranceReferenceDimId,\n\t-- *INF*: iif(isnull(InsuranceReferenceDimId),-1,InsuranceReferenceDimId)\n\tIFF(InsuranceReferenceDimId IS NULL, - 1, InsuranceReferenceDimId) AS InsuranceReferenceDimId_out,\n\tLKP_InsuranceReferenceCoverageDim.InsuranceReferenceCoverageDimId,\n\t-- *INF*: iif(isnull(InsuranceReferenceCoverageDimId),-1,InsuranceReferenceCoverageDimId)\n\tIFF(InsuranceReferenceCoverageDimId IS NULL, - 1, InsuranceReferenceCoverageDimId) AS InsuranceReferenceCoverageDimId_out,\n\tLKP_CoverageDetailDim.CoverageDetailDimId,\n\t-- *INF*: iif(isnull(CoverageDetailDimId),-1,CoverageDetailDimId)\n\tIFF(CoverageDetailDimId IS NULL, - 1, CoverageDetailDimId) AS CoverageDetailDimId_out\n\tFROM EXP_Values\n\tLEFT JOIN LKP_CoverageDetailDim\n\tON LKP_CoverageDetailDim.claim_reins_trans_id = EXP_Values.claim_reins_trans_id AND LKP_CoverageDetailDim.PolicyAkid = EXP_Values.PolicyAkid\n\tLEFT JOIN LKP_InsuranceReferenceCoverageDim\n\tON LKP_InsuranceReferenceCoverageDim.claimant_cov_det_ak_id = EXP_Values.claimant_cov_det_ak_id AND LKP_InsuranceReferenceCoverageDim.EffectiveDate <= EXP_Values.trans_date_out AND LKP_InsuranceReferenceCoverageDim.ExpirationDate >= EXP_Values.trans_date_out\n\tLEFT JOIN LKP_InsuranceReferenceDimId\n\tON LKP_InsuranceReferenceDimId.claimant_cov_det_ak_id = EXP_Values.claimant_cov_det_ak_id\n\tLEFT JOIN LKP_SalesDivisionDim\n\tON LKP_SalesDivisionDim.AgencyAKID = mplt_Claim_occurence_dim_id.AgencyAKID\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_reins_trans_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_reins_trans_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_reins_trans_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_reprocess_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(reprocess_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_source_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(source_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_occurrence_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_occurrence_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CLAIM_REINSURANCE_TRANSACTION LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date\n\tON LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claimant_cov_det_ak_id = claimant_cov_det_ak_id\n\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claim_reins_financial_type_code = 'D'\n\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_D_claim_reins_trans_date.claim_reins_trans_date = claim_reins_trans_date\n\n\tLEFT JOIN LKP_CLAIM_REINSURANCE_TRANSACTION LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date\n\tON LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claimant_cov_det_ak_id = claimant_cov_det_ak_id\n\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claim_reins_financial_type_code = 'E'\n\tAND LKP_CLAIM_REINSURANCE_TRANSACTION_claimant_cov_det_ak_id_E_claim_reins_trans_date.claim_reins_trans_date = claim_reins_trans_date\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_reins_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_reins_acct_entered_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_reins_acct_entered_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS\n\tON LKP_CALENDER_DIM_TO_DATE_01_01_1800_00_00_00_MM_DD_YYYY_HH24_MI_SS.clndr_date = TO_DATE('01/01/1800 00:00:00', 'MM/DD/YYYY HH24:MI:SS')\n\n),\nEXP_Dim_IDs AS (\n\tSELECT\n\tclaim_occurrence_dim_id_out,\n\tclaim_occurrence_dim_hist_id_out,\n\tclaimant_dim_id_out,\n\tclaimant_dim_hist_id_out,\n\tclaimant_cov_dim_id_out,\n\tclaimant_cov_dim_hist_id_out,\n\tcov_dim_id_out,\n\tcov_dim_hist_id_out,\n\tclaim_trans_type_dim_id_out,\n\tclaim_financial_type_dim_id_out,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tclaim_rep_dim_prim_claim_rep_hist_id,\n\tpol_key_dim_id_out,\n\tpol_key_dim_hist_id_out,\n\tclaim_reins_trans_date_id,\n\treprocess_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_occurrence_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tclaim_reins_trans_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tclaim_reins_trans_amt,\n\tclaim_reins_trans_hist_amt,\n\tceded_loss_paid,\n\tceded_loss_outstanding,\n\tceded_loss_incurred,\n\tceded_alae_paid,\n\tceded_alae_outstanding,\n\tceded_alae_incurred,\n\taudit_id,\n\tagency_dim_id_out,\n\tagency_dim_hist_id_out,\n\tclaim_reins_trans_ak_id,\n\tclaim_reins_draft_num,\n\tOUT_claim_reins_acct_entered_date_Id,\n\toffset_onset_ind,\n\tclaim_rep_dim_examiner_id_Out,\n\tclaim_rep_dim_prim_litigation_handler_id_out,\n\tclaim_rep_dim_examiner_hist_id_out,\n\tclaim_rep_dim_prim_litigation_handler_hist_id_out,\n\tclaim_created_by_dim_id_out,\n\tclaim_case_dim_id_out,\n\tclaim_case_dim_hist_id_out,\n\tcontract_cust_dim_id_out,\n\tcontract_cust_dim_hist_id_out,\n\tceded_salvage_paid,\n\tceded_subrogation_paid,\n\tceded_other_recovery_loss_paid,\n\tceded_other_recovery_alae_paid,\n\ttotal_ceded_loss_recovery_paid,\n\tnet_loss_paid,\n\tnet_loss_outstanding,\n\tnet_loss_incurred,\n\tnet_alae_paid,\n\tnet_alae_outstanding,\n\tnet_alae_incurred,\n\tdefault_id,\n\tDEFAULT_DATE_ID,\n\tDEFAULT_STRING,\n\tDEFAULT_AMOUNT,\n\treins_cov_ak_id,\n\tclaim_reins_trans_date,\n\ttrans_date_out,\n\t-- *INF*: :LKP.LKP_REINS_COV_DIM_ID(reins_cov_ak_id,trans_date_out)\n\tLKP_REINS_COV_DIM_ID_reins_cov_ak_id_trans_date_out.reins_cov_dim_id AS V_reins_cov_dim_id,\n\t-- *INF*: IIF(ISNULL(V_reins_cov_dim_id), -1,V_reins_cov_dim_id)\n\tIFF(V_reins_cov_dim_id IS NULL, - 1, V_reins_cov_dim_id) AS reins_cov_dim_id_out,\n\t-- *INF*: :LKP.LKP_REINS_COV_DIM_ID(reins_cov_ak_id,claim_reins_trans_date)\n\tLKP_REINS_COV_DIM_ID_reins_cov_ak_id_claim_reins_trans_date.reins_cov_dim_id AS V_reins_cov_dim_hist_id,\n\t-- *INF*: IIF(ISNULL(V_reins_cov_dim_hist_id), -1,V_reins_cov_dim_hist_id)\n\tIFF(V_reins_cov_dim_hist_id IS NULL, - 1, V_reins_cov_dim_hist_id) AS reins_cov_dim_hist_id_out,\n\tError_Flag,\n\tstrtgc_bus_dvsn_dim_id_out AS strtgc_bus_dvsn_dim_id,\n\tAgencyDimID_out AS AgencyDimID,\n\tSalesDivisionDimID_out AS SalesDivisionDimID,\n\tInsuranceReferenceDimId_out AS InsuranceReferenceDimId,\n\tInsuranceReferenceCoverageDimId_out AS InsuranceReferenceCoverageDimId,\n\tCoverageDetailDimId_out AS CoverageDetailDimId,\n\tSYSDATE AS ModifiedDate\n\tFROM EXP_Financial_Values\n\tLEFT JOIN LKP_REINS_COV_DIM_ID LKP_REINS_COV_DIM_ID_reins_cov_ak_id_trans_date_out\n\tON LKP_REINS_COV_DIM_ID_reins_cov_ak_id_trans_date_out.edw_reins_cov_ak_id = reins_cov_ak_id\n\tAND LKP_REINS_COV_DIM_ID_reins_cov_ak_id_trans_date_out.eff_from_date = trans_date_out\n\n\tLEFT JOIN LKP_REINS_COV_DIM_ID LKP_REINS_COV_DIM_ID_reins_cov_ak_id_claim_reins_trans_date\n\tON LKP_REINS_COV_DIM_ID_reins_cov_ak_id_claim_reins_trans_date.edw_reins_cov_ak_id = reins_cov_ak_id\n\tAND LKP_REINS_COV_DIM_ID_reins_cov_ak_id_claim_reins_trans_date.eff_from_date = claim_reins_trans_date\n\n),\nLKP_claim_loss_transaction_fact AS (\n\tSELECT\n\tclaim_loss_trans_fact_id,\n\tIN_claim_reins_trans_id,\n\tedw_claim_reins_trans_pk_id\n\tFROM (\n\t\tSELECT CLTF.claim_loss_trans_fact_id    AS claim_loss_trans_fact_id,\r\n\t\t       CLTF.edw_claim_reins_trans_pk_id AS edw_claim_reins_trans_pk_id\r\n\t\tFROM   @{pipeline().parameters.TARGET_TABLE_OWNER}.claim_loss_transaction_fact CLTF\r\n\t\tWHERE CLTF.edw_claim_reins_trans_pk_id <> -1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_reins_trans_pk_id ORDER BY claim_loss_trans_fact_id DESC) = 1\n),\nRTR_claim_reinsurance_transaction_fact AS (\n\tSELECT\n\tLKP_claim_loss_transaction_fact.claim_loss_trans_fact_id AS claim_reins_trans_fact_id,\n\tEXP_Dim_IDs.claim_occurrence_dim_id_out AS claim_occurrence_dim_id,\n\tEXP_Dim_IDs.claim_occurrence_dim_hist_id_out AS claim_occurrence_dim_hist_id,\n\tEXP_Dim_IDs.claimant_dim_id_out AS claimant_dim_id,\n\tEXP_Dim_IDs.claimant_dim_hist_id_out AS claimant_dim_hist_id,\n\tEXP_Dim_IDs.claimant_cov_dim_id_out AS claimant_cov_dim_id,\n\tEXP_Dim_IDs.claimant_cov_dim_hist_id_out AS claimant_cov_dim_hist_id,\n\tEXP_Dim_IDs.cov_dim_id_out AS cov_dim_id,\n\tEXP_Dim_IDs.cov_dim_hist_id_out AS cov_dim_hist_id,\n\tEXP_Dim_IDs.claim_trans_type_dim_id_out AS claim_trans_type_dim_id,\n\tEXP_Dim_IDs.claim_financial_type_dim_id_out AS claim_financial_type_dim_id,\n\tEXP_Dim_IDs.claim_rep_dim_prim_claim_rep_id,\n\tEXP_Dim_IDs.claim_rep_dim_prim_claim_rep_hist_id,\n\tEXP_Dim_IDs.pol_key_dim_id_out AS pol_key_dim_id,\n\tEXP_Dim_IDs.pol_key_dim_hist_id_out AS pol_key_dim_hist_id,\n\tEXP_Dim_IDs.claim_reins_trans_date_id,\n\tEXP_Dim_IDs.reprocess_date_id,\n\tEXP_Dim_IDs.claim_reins_trans_id,\n\tEXP_Dim_IDs.claim_loss_date_id,\n\tEXP_Dim_IDs.claim_discovery_date_id,\n\tEXP_Dim_IDs.claim_scripted_date_id,\n\tEXP_Dim_IDs.source_claim_rpted_date_id,\n\tEXP_Dim_IDs.claim_occurrence_rpted_date_id,\n\tEXP_Dim_IDs.claim_open_date_id,\n\tEXP_Dim_IDs.claim_close_date_id,\n\tEXP_Dim_IDs.claim_reopen_date_id,\n\tEXP_Dim_IDs.claim_closed_after_reopen_date_id,\n\tEXP_Dim_IDs.claim_notice_only_date_id,\n\tEXP_Dim_IDs.claim_cat_start_date_id,\n\tEXP_Dim_IDs.claim_cat_end_date_id,\n\tEXP_Dim_IDs.claim_rep_assigned_date_id,\n\tEXP_Dim_IDs.claim_rep_unassigned_date_id,\n\tEXP_Dim_IDs.pol_eff_date_id,\n\tEXP_Dim_IDs.pol_exp_date_id,\n\tEXP_Dim_IDs.claim_reins_trans_amt,\n\tEXP_Dim_IDs.claim_reins_trans_hist_amt,\n\tEXP_Dim_IDs.ceded_loss_paid,\n\tEXP_Dim_IDs.ceded_loss_outstanding,\n\tEXP_Dim_IDs.ceded_loss_incurred,\n\tEXP_Dim_IDs.ceded_alae_paid,\n\tEXP_Dim_IDs.ceded_alae_outstanding,\n\tEXP_Dim_IDs.ceded_alae_incurred,\n\tEXP_Dim_IDs.audit_id,\n\tEXP_Dim_IDs.agency_dim_id_out AS agency_dim_id,\n\tEXP_Dim_IDs.agency_dim_hist_id_out AS agency_dim_hist_id,\n\tEXP_Dim_IDs.claim_reins_trans_ak_id,\n\tEXP_Dim_IDs.claim_reins_draft_num,\n\tEXP_Dim_IDs.OUT_claim_reins_acct_entered_date_Id AS claim_reins_acct_entered_date_ID,\n\tEXP_Dim_IDs.offset_onset_ind,\n\tEXP_Dim_IDs.Error_Flag,\n\tEXP_Dim_IDs.claim_rep_dim_examiner_id_Out,\n\tEXP_Dim_IDs.claim_rep_dim_prim_litigation_handler_id_out,\n\tEXP_Dim_IDs.claim_rep_dim_examiner_hist_id_out,\n\tEXP_Dim_IDs.claim_rep_dim_prim_litigation_handler_hist_id_out,\n\tEXP_Dim_IDs.claim_created_by_dim_id_out,\n\tEXP_Dim_IDs.claim_case_dim_id_out,\n\tEXP_Dim_IDs.claim_case_dim_hist_id_out,\n\tEXP_Dim_IDs.contract_cust_dim_id_out AS contract_cust_dim_id,\n\tEXP_Dim_IDs.contract_cust_dim_hist_id_out AS contract_cust_dim_hist_id,\n\tEXP_Dim_IDs.ceded_salvage_paid,\n\tEXP_Dim_IDs.ceded_subrogation_paid,\n\tEXP_Dim_IDs.ceded_other_recovery_loss_paid,\n\tEXP_Dim_IDs.ceded_other_recovery_alae_paid,\n\tEXP_Dim_IDs.total_ceded_loss_recovery_paid,\n\tEXP_Dim_IDs.net_loss_paid,\n\tEXP_Dim_IDs.net_loss_outstanding,\n\tEXP_Dim_IDs.net_loss_incurred,\n\tEXP_Dim_IDs.net_alae_paid,\n\tEXP_Dim_IDs.net_alae_outstanding,\n\tEXP_Dim_IDs.net_alae_incurred,\n\tEXP_Dim_IDs.default_id,\n\tEXP_Dim_IDs.DEFAULT_DATE_ID,\n\tEXP_Dim_IDs.DEFAULT_STRING,\n\tEXP_Dim_IDs.DEFAULT_AMOUNT,\n\tEXP_Dim_IDs.reins_cov_dim_id_out,\n\tEXP_Dim_IDs.reins_cov_dim_hist_id_out,\n\tEXP_Dim_IDs.strtgc_bus_dvsn_dim_id,\n\tEXP_Dim_IDs.AgencyDimID,\n\tEXP_Dim_IDs.SalesDivisionDimID,\n\tEXP_Dim_IDs.InsuranceReferenceDimId,\n\tEXP_Dim_IDs.InsuranceReferenceCoverageDimId,\n\tEXP_Dim_IDs.CoverageDetailDimId,\n\tEXP_Dim_IDs.ModifiedDate\n\tFROM EXP_Dim_IDs\n\tLEFT JOIN LKP_claim_loss_transaction_fact\n\tON LKP_claim_loss_transaction_fact.edw_claim_reins_trans_pk_id = EXP_Dim_IDs.claim_reins_trans_id\n),\nRTR_claim_reinsurance_transaction_fact_INSERT AS (SELECT * FROM RTR_claim_reinsurance_transaction_fact WHERE ISNULL(claim_reins_trans_fact_id)),\nRTR_claim_reinsurance_transaction_fact_DEFAULT1 AS (SELECT * FROM RTR_claim_reinsurance_transaction_fact WHERE NOT ( (ISNULL(claim_reins_trans_fact_id)) )),\nUPD_claim_loss_transaction_fact_update AS (\n\tSELECT\n\tclaim_reins_trans_fact_id, \n\tclaim_occurrence_dim_hist_id AS claim_occurrence_dim_hist_id2, \n\tclaimant_dim_id AS claimant_dim_id2, \n\tclaimant_dim_hist_id AS claimant_dim_hist_id2, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id2, \n\tclaimant_cov_dim_hist_id AS claimant_cov_dim_hist_id2, \n\tcov_dim_id AS cov_dim_id2, \n\tcov_dim_hist_id AS cov_dim_hist_id2, \n\tclaim_trans_type_dim_id AS claim_trans_type_dim_id2, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id2, \n\tclaim_rep_dim_prim_claim_rep_id AS claim_rep_dim_id2, \n\tclaim_rep_dim_prim_claim_rep_hist_id AS claim_rep_dim_hist_id2, \n\tpol_key_dim_id AS pol_key_dim_id2, \n\tpol_key_dim_hist_id AS pol_key_dim_hist_id2, \n\tclaim_reins_trans_date_id AS claim_reins_trans_date_id2, \n\treprocess_date_id AS reprocess_date_id2, \n\tclaim_reins_trans_id, \n\tclaim_reins_trans_amt, \n\tclaim_reins_trans_hist_amt, \n\tceded_loss_paid, \n\tceded_loss_outstanding, \n\tceded_loss_incurred, \n\tceded_alae_paid, \n\tceded_alae_outstanding, \n\tceded_alae_incurred, \n\tagency_dim_id AS agency_dim_id2, \n\tagency_dim_hist_id AS agency_dim_hist_id2, \n\tclaim_reins_trans_ak_id, \n\tclaim_reins_draft_num, \n\tclaim_reins_acct_entered_date_ID, \n\toffset_onset_ind, \n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id2, \n\taudit_id AS audit_id2, \n\tError_Flag, \n\tclaim_loss_date_id AS claim_loss_date_id2, \n\tclaim_discovery_date_id AS claim_discovery_date_id2, \n\tclaim_scripted_date_id, \n\tsource_claim_rpted_date_id, \n\tclaim_occurrence_rpted_date_id AS claim_occurrence_rpted_date_id2, \n\tclaim_open_date_id AS claim_open_date_id2, \n\tclaim_close_date_id AS claim_close_date_id2, \n\tclaim_reopen_date_id AS claim_reopen_date_id2, \n\tclaim_closed_after_reopen_date_id AS claim_closed_after_reopen_date_id2, \n\tclaim_notice_only_date_id, \n\tclaim_cat_start_date_id AS claim_cat_start_date_id2, \n\tclaim_cat_end_date_id AS claim_cat_end_date_id2, \n\tclaim_rep_assigned_date_id AS claim_rep_assigned_date_id2, \n\tclaim_rep_unassigned_date_id AS claim_rep_unassigned_date_id2, \n\tpol_eff_date_id AS pol_eff_date_id2, \n\tpol_exp_date_id AS pol_exp_date_id2, \n\tclaim_rep_dim_examiner_id_Out AS claim_rep_dim_examiner_id_Out2, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out2, \n\tclaim_rep_dim_examiner_hist_id_out AS claim_rep_dim_examiner_hist_id_out2, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out AS claim_rep_dim_prim_litigation_handler_hist_id_out2, \n\tclaim_created_by_dim_id_out AS claim_created_by_dim_id_out2, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out2, \n\tclaim_case_dim_hist_id_out AS claim_case_dim_hist_id_out2, \n\tcontract_cust_dim_id, \n\tcontract_cust_dim_hist_id, \n\tceded_salvage_paid, \n\tceded_subrogation_paid, \n\tceded_other_recovery_loss_paid, \n\tceded_other_recovery_alae_paid, \n\ttotal_ceded_loss_recovery_paid, \n\tnet_loss_paid AS net_loss_paid2, \n\tnet_loss_outstanding AS net_loss_outstanding2, \n\tnet_loss_incurred AS net_loss_incurred2, \n\tnet_alae_paid AS net_alae_paid2, \n\tnet_alae_outstanding AS net_alae_outstanding2, \n\tnet_alae_incurred AS net_alae_incurred2, \n\tdefault_id AS default_id2, \n\tDEFAULT_DATE_ID AS DEFAULT_DATE_ID2, \n\tDEFAULT_STRING AS DEFAULT_STRING2, \n\tDEFAULT_AMOUNT AS DEFAULT_AMOUNT2, \n\treins_cov_dim_id_out AS reins_cov_dim_id_out2, \n\treins_cov_dim_hist_id_out AS reins_cov_dim_hist_id_out2, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id2, \n\tAgencyDimID AS AgencyDimID2, \n\tSalesDivisionDimID AS SalesDivisionDimID2, \n\tInsuranceReferenceDimId AS InsuranceReferenceDimId2, \n\tInsuranceReferenceCoverageDimId AS InsuranceReferenceCoverageDimId2, \n\tCoverageDetailDimId AS CoverageDetailDimId2, \n\tModifiedDate AS ModifiedDate2\n\tFROM RTR_claim_reinsurance_transaction_fact_DEFAULT1\n),\nclaim_loss_transaction_fact_update AS (\n\tMERGE INTO claim_loss_transaction_fact AS T\n\tUSING UPD_claim_loss_transaction_fact_update AS S\n\tON T.claim_loss_trans_fact_id = S.claim_reins_trans_fact_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.err_flag = S.Error_Flag, T.edw_claim_trans_pk_id = S.default_id2, T.edw_claim_reins_trans_pk_id = S.claim_reins_trans_id, T.claim_occurrence_dim_id = S.claim_occurrence_dim_id2, T.claim_occurrence_dim_hist_id = S.claim_occurrence_dim_hist_id2, T.claimant_dim_id = S.claimant_dim_id2, T.claimant_dim_hist_id = S.claimant_dim_hist_id2, T.claimant_cov_dim_id = S.claimant_cov_dim_id2, T.claimant_cov_dim_hist_id = S.claimant_cov_dim_hist_id2, T.cov_dim_id = S.cov_dim_id2, T.cov_dim_hist_id = S.cov_dim_hist_id2, T.claim_trans_type_dim_id = S.claim_trans_type_dim_id2, T.claim_financial_type_dim_id = S.claim_financial_type_dim_id2, T.reins_cov_dim_id = S.reins_cov_dim_id_out2, T.reins_cov_dim_hist_id = S.reins_cov_dim_hist_id_out2, T.claim_rep_dim_prim_claim_rep_id = S.claim_rep_dim_id2, T.claim_rep_dim_prim_claim_rep_hist_id = S.claim_rep_dim_hist_id2, T.claim_rep_dim_examiner_id = S.claim_rep_dim_examiner_id_Out2, T.claim_rep_dim_examiner_hist_id = S.claim_rep_dim_examiner_hist_id_out2, T.claim_rep_dim_prim_litigation_handler_id = S.claim_rep_dim_prim_litigation_handler_id_out2, T.claim_rep_dim_prim_litigation_handler_hist_id = S.claim_rep_dim_prim_litigation_handler_hist_id_out2, T.claim_rep_dim_trans_entry_oper_id = S.default_id2, T.claim_rep_dim_trans_entry_oper_hist_id = S.default_id2, T.claim_rep_dim_claim_created_by_id = S.claim_created_by_dim_id_out2, T.pol_dim_id = S.pol_key_dim_id2, T.pol_dim_hist_id = S.pol_key_dim_hist_id2, T.agency_dim_id = S.agency_dim_id2, T.agency_dim_hist_id = S.agency_dim_hist_id2, T.claim_pay_dim_id = S.default_id2, T.claim_pay_dim_hist_id = S.default_id2, T.claim_pay_ctgry_type_dim_id = S.default_id2, T.claim_pay_ctgry_type_dim_hist_id = S.default_id2, T.claim_case_dim_id = S.claim_case_dim_id_out2, T.claim_case_dim_hist_id = S.claim_case_dim_hist_id_out2, T.contract_cust_dim_id = S.contract_cust_dim_id, T.contract_cust_dim_hist_id = S.contract_cust_dim_hist_id, T.claim_master_1099_list_dim_id = S.default_id2, T.claim_subrogation_dim_id = S.default_id2, T.claim_trans_date_id = S.claim_reins_trans_date_id2, T.claim_trans_reprocess_date_id = S.reprocess_date_id2, T.claim_loss_date_id = S.claim_loss_date_id2, T.claim_discovery_date_id = S.claim_discovery_date_id2, T.claim_scripted_date_id = S.claim_scripted_date_id, T.source_claim_rpted_date_id = S.source_claim_rpted_date_id, T.claim_rpted_date_id = S.claim_occurrence_rpted_date_id2, T.claim_open_date_id = S.claim_open_date_id2, T.claim_close_date_id = S.claim_close_date_id2, T.claim_reopen_date_id = S.claim_reopen_date_id2, T.claim_closed_after_reopen_date_id = S.claim_closed_after_reopen_date_id2, T.claim_notice_only_date_id = S.claim_notice_only_date_id, T.claim_cat_start_date_id = S.claim_cat_start_date_id2, T.claim_cat_end_date_id = S.claim_cat_end_date_id2, T.claim_rep_assigned_date_id = S.claim_rep_assigned_date_id2, T.claim_rep_unassigned_date_id = S.claim_rep_unassigned_date_id2, T.pol_eff_date_id = S.pol_eff_date_id2, T.pol_exp_date_id = S.pol_exp_date_id2, T.claim_subrogation_referred_to_subrogation_date_id = S.DEFAULT_DATE_ID2, T.claim_subrogation_pay_start_date_id = S.DEFAULT_DATE_ID2, T.claim_subrogation_closure_date_id = S.DEFAULT_DATE_ID2, T.acct_entered_date_id = S.claim_reins_acct_entered_date_ID, T.trans_amt = S.claim_reins_trans_amt, T.trans_hist_amt = S.claim_reins_trans_hist_amt, T.tax_id = S.DEFAULT_STRING2, T.direct_loss_paid_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_loss_outstanding_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_loss_incurred_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_paid_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_outstanding_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_incurred_excluding_recoveries = S.DEFAULT_AMOUNT2, T.direct_loss_paid_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_loss_outstanding_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_loss_incurred_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_paid_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_outstanding_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_alae_incurred_including_recoveries = S.DEFAULT_AMOUNT2, T.direct_subrogation_paid = S.DEFAULT_AMOUNT2, T.direct_subrogation_outstanding = S.DEFAULT_AMOUNT2, T.direct_subrogation_incurred = S.DEFAULT_AMOUNT2, T.direct_salvage_paid = S.DEFAULT_AMOUNT2, T.direct_salvage_outstanding = S.DEFAULT_AMOUNT2, T.direct_salvage_incurred = S.DEFAULT_AMOUNT2, T.direct_other_recovery_loss_paid = S.DEFAULT_AMOUNT2, T.direct_other_recovery_loss_outstanding = S.DEFAULT_AMOUNT2, T.direct_other_recovery_loss_incurred = S.DEFAULT_AMOUNT2, T.direct_other_recovery_alae_paid = S.DEFAULT_AMOUNT2, T.direct_other_recovery_alae_outstanding = S.DEFAULT_AMOUNT2, T.direct_other_recovery_alae_incurred = S.DEFAULT_AMOUNT2, T.total_direct_loss_recovery_paid = S.DEFAULT_AMOUNT2, T.total_direct_loss_recovery_outstanding = S.DEFAULT_AMOUNT2, T.total_direct_loss_recovery_incurred = S.DEFAULT_AMOUNT2, T.direct_other_recovery_paid = S.DEFAULT_AMOUNT2, T.direct_other_recovery_outstanding = S.DEFAULT_AMOUNT2, T.direct_other_recovery_incurred = S.DEFAULT_AMOUNT2, T.ceded_loss_paid = S.ceded_loss_paid, T.ceded_loss_outstanding = S.ceded_loss_outstanding, T.ceded_loss_incurred = S.ceded_loss_incurred, T.ceded_alae_paid = S.ceded_alae_paid, T.ceded_alae_outstanding = S.ceded_alae_outstanding, T.ceded_alae_incurred = S.ceded_alae_incurred, T.ceded_salvage_paid = S.ceded_salvage_paid, T.ceded_subrogation_paid = S.ceded_subrogation_paid, T.ceded_other_recovery_loss_paid = S.ceded_other_recovery_loss_paid, T.ceded_other_recovery_alae_paid = S.ceded_other_recovery_alae_paid, T.total_ceded_loss_recovery_paid = S.total_ceded_loss_recovery_paid, T.net_loss_paid = S.net_loss_paid2, T.net_loss_outstanding = S.net_loss_outstanding2, T.net_loss_incurred = S.net_loss_incurred2, T.net_alae_paid = S.net_alae_paid2, T.net_alae_outstanding = S.net_alae_outstanding2, T.net_alae_incurred = S.net_alae_incurred2, T.asl_dim_id = S.default_id2, T.asl_prdct_code_dim_id = S.default_id2, T.loss_master_dim_id = S.default_id2, T.strtgc_bus_dvsn_dim_id = S.strtgc_bus_dvsn_dim_id2, T.prdct_code_dim_id = S.default_id2, T.ClaimReserveDimId = S.default_id2, T.ClaimRepresentativeDimFeatureClaimRepresentativeId = S.default_id2, T.FeatureRepresentativeAssignedDateId = S.DEFAULT_DATE_ID2, T.InsuranceReferenceDimId = S.InsuranceReferenceDimId2, T.AgencyDimId = S.AgencyDimID2, T.SalesDivisionDimId = S.SalesDivisionDimID2, T.InsuranceReferenceCoverageDimId = S.InsuranceReferenceCoverageDimId2, T.CoverageDetailDimId = S.CoverageDetailDimId2, T.ModifiedDate = S.ModifiedDate2\n),\nUPD_claim_loss_transaction_fact_insert AS (\n\tSELECT\n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id1, \n\tclaim_occurrence_dim_hist_id AS claim_occurrence_dim_hist_id1, \n\tclaimant_dim_id AS claimant_dim_id1, \n\tclaimant_dim_hist_id AS claimant_dim_hist_id1, \n\tclaimant_cov_dim_id AS claimant_cov_dim_id1, \n\tclaimant_cov_dim_hist_id AS claimant_cov_dim_hist_id1, \n\tcov_dim_id AS cov_dim_id1, \n\tcov_dim_hist_id AS cov_dim_hist_id1, \n\tclaim_trans_type_dim_id AS claim_trans_type_dim_id1, \n\tclaim_financial_type_dim_id AS claim_financial_type_dim_id1, \n\tclaim_rep_dim_prim_claim_rep_id, \n\tclaim_rep_dim_prim_claim_rep_hist_id, \n\tpol_key_dim_id AS pol_key_dim_id1, \n\tpol_key_dim_hist_id AS pol_key_dim_hist_id1, \n\tclaim_reins_trans_date_id AS claim_reins_trans_date_id1, \n\treprocess_date_id AS reprocess_date_id1, \n\tclaim_reins_trans_id, \n\tclaim_reins_trans_amt, \n\tclaim_reins_trans_hist_amt, \n\tceded_loss_paid, \n\tceded_loss_outstanding, \n\tceded_loss_incurred, \n\tceded_alae_paid, \n\tceded_alae_outstanding, \n\tceded_alae_incurred, \n\taudit_id AS audit_id1, \n\tagency_dim_id AS agency_dim_id1, \n\tagency_dim_hist_id AS agency_dim_hist_id1, \n\tclaim_reins_trans_ak_id, \n\tclaim_reins_acct_entered_date_ID, \n\tError_Flag, \n\tclaim_loss_date_id AS claim_loss_date_id1, \n\tclaim_discovery_date_id AS claim_discovery_date_id1, \n\tclaim_scripted_date_id, \n\tsource_claim_rpted_date_id, \n\tclaim_occurrence_rpted_date_id AS claim_occurrence_rpted_date_id1, \n\tclaim_open_date_id AS claim_open_date_id1, \n\tclaim_close_date_id AS claim_close_date_id1, \n\tclaim_reopen_date_id AS claim_reopen_date_id1, \n\tclaim_closed_after_reopen_date_id AS claim_closed_after_reopen_date_id1, \n\tclaim_notice_only_date_id, \n\tclaim_cat_start_date_id AS claim_cat_start_date_id1, \n\tclaim_cat_end_date_id AS claim_cat_end_date_id1, \n\tclaim_rep_assigned_date_id AS claim_rep_assigned_date_id1, \n\tclaim_rep_unassigned_date_id AS claim_rep_unassigned_date_id1, \n\tpol_eff_date_id AS pol_eff_date_id1, \n\tpol_exp_date_id AS pol_exp_date_id1, \n\tclaim_rep_dim_examiner_id_Out AS claim_rep_dim_examiner_id_Out1, \n\tclaim_rep_dim_examiner_hist_id_out AS claim_rep_dim_examiner_hist_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_id_out AS claim_rep_dim_prim_litigation_handler_id_out1, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out AS claim_rep_dim_prim_litigation_handler_hist_id_out1, \n\tclaim_created_by_dim_id_out AS claim_created_by_dim_id_out1, \n\tclaim_case_dim_id_out AS claim_case_dim_id_out1, \n\tclaim_case_dim_hist_id_out AS claim_case_dim_hist_id_out1, \n\tcontract_cust_dim_id, \n\tcontract_cust_dim_hist_id, \n\tceded_salvage_paid, \n\tceded_subrogation_paid, \n\tceded_other_recovery_loss_paid, \n\tceded_other_recovery_alae_paid, \n\ttotal_ceded_loss_recovery_paid, \n\tnet_loss_paid AS net_loss_paid1, \n\tnet_loss_outstanding AS net_loss_outstanding1, \n\tnet_loss_incurred AS net_loss_incurred1, \n\tnet_alae_paid AS net_alae_paid1, \n\tnet_alae_outstanding AS net_alae_outstanding1, \n\tnet_alae_incurred AS net_alae_incurred1, \n\tdefault_id AS default_id1, \n\tDEFAULT_DATE_ID AS DEFAULT_DATE_ID1, \n\tDEFAULT_STRING AS DEFAULT_STRING1, \n\tDEFAULT_AMOUNT AS DEFAULT_AMOUNT1, \n\treins_cov_dim_id_out AS reins_cov_dim_id_out1, \n\treins_cov_dim_hist_id_out AS reins_cov_dim_hist_id_out1, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id1, \n\tAgencyDimID AS AgencyDimID1, \n\tSalesDivisionDimID AS SalesDivisionDimID1, \n\tInsuranceReferenceDimId AS InsuranceReferenceDimId1, \n\tInsuranceReferenceCoverageDimId AS InsuranceReferenceCoverageDimId1, \n\tCoverageDetailDimId AS CoverageDetailDimId1, \n\tModifiedDate AS ModifiedDate1\n\tFROM RTR_claim_reinsurance_transaction_fact_INSERT\n),\nclaim_loss_transaction_fact_insert AS (\n\tINSERT INTO claim_loss_transaction_fact\n\t(err_flag, audit_id, edw_claim_trans_pk_id, edw_claim_reins_trans_pk_id, claim_occurrence_dim_id, claim_occurrence_dim_hist_id, claimant_dim_id, claimant_dim_hist_id, claimant_cov_dim_id, claimant_cov_dim_hist_id, cov_dim_id, cov_dim_hist_id, claim_trans_type_dim_id, claim_financial_type_dim_id, reins_cov_dim_id, reins_cov_dim_hist_id, claim_rep_dim_prim_claim_rep_id, claim_rep_dim_prim_claim_rep_hist_id, claim_rep_dim_examiner_id, claim_rep_dim_examiner_hist_id, claim_rep_dim_prim_litigation_handler_id, claim_rep_dim_prim_litigation_handler_hist_id, claim_rep_dim_trans_entry_oper_id, claim_rep_dim_trans_entry_oper_hist_id, claim_rep_dim_claim_created_by_id, pol_dim_id, pol_dim_hist_id, agency_dim_id, agency_dim_hist_id, claim_pay_dim_id, claim_pay_dim_hist_id, claim_pay_ctgry_type_dim_id, claim_pay_ctgry_type_dim_hist_id, claim_case_dim_id, claim_case_dim_hist_id, contract_cust_dim_id, contract_cust_dim_hist_id, claim_master_1099_list_dim_id, claim_subrogation_dim_id, claim_trans_date_id, claim_trans_reprocess_date_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, pol_eff_date_id, pol_exp_date_id, claim_subrogation_referred_to_subrogation_date_id, claim_subrogation_pay_start_date_id, claim_subrogation_closure_date_id, acct_entered_date_id, trans_amt, trans_hist_amt, tax_id, direct_loss_paid_excluding_recoveries, direct_loss_outstanding_excluding_recoveries, direct_loss_incurred_excluding_recoveries, direct_alae_paid_excluding_recoveries, direct_alae_outstanding_excluding_recoveries, direct_alae_incurred_excluding_recoveries, direct_loss_paid_including_recoveries, direct_loss_outstanding_including_recoveries, direct_loss_incurred_including_recoveries, direct_alae_paid_including_recoveries, direct_alae_outstanding_including_recoveries, direct_alae_incurred_including_recoveries, direct_subrogation_paid, direct_subrogation_outstanding, direct_subrogation_incurred, direct_salvage_paid, direct_salvage_outstanding, direct_salvage_incurred, direct_other_recovery_loss_paid, direct_other_recovery_loss_outstanding, direct_other_recovery_loss_incurred, direct_other_recovery_alae_paid, direct_other_recovery_alae_outstanding, direct_other_recovery_alae_incurred, total_direct_loss_recovery_paid, total_direct_loss_recovery_outstanding, total_direct_loss_recovery_incurred, direct_other_recovery_paid, direct_other_recovery_outstanding, direct_other_recovery_incurred, ceded_loss_paid, ceded_loss_outstanding, ceded_loss_incurred, ceded_alae_paid, ceded_alae_outstanding, ceded_alae_incurred, ceded_salvage_paid, ceded_subrogation_paid, ceded_other_recovery_loss_paid, ceded_other_recovery_alae_paid, total_ceded_loss_recovery_paid, net_loss_paid, net_loss_outstanding, net_loss_incurred, net_alae_paid, net_alae_outstanding, net_alae_incurred, asl_dim_id, asl_prdct_code_dim_id, loss_master_dim_id, strtgc_bus_dvsn_dim_id, prdct_code_dim_id, ClaimReserveDimId, ClaimRepresentativeDimFeatureClaimRepresentativeId, FeatureRepresentativeAssignedDateId, InsuranceReferenceDimId, AgencyDimId, SalesDivisionDimId, InsuranceReferenceCoverageDimId, CoverageDetailDimId, ModifiedDate)\n\tSELECT \n\tError_Flag AS ERR_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\tdefault_id1 AS EDW_CLAIM_TRANS_PK_ID, \n\tclaim_reins_trans_id AS EDW_CLAIM_REINS_TRANS_PK_ID, \n\tclaim_occurrence_dim_id1 AS CLAIM_OCCURRENCE_DIM_ID, \n\tclaim_occurrence_dim_hist_id1 AS CLAIM_OCCURRENCE_DIM_HIST_ID, \n\tclaimant_dim_id1 AS CLAIMANT_DIM_ID, \n\tclaimant_dim_hist_id1 AS CLAIMANT_DIM_HIST_ID, \n\tclaimant_cov_dim_id1 AS CLAIMANT_COV_DIM_ID, \n\tclaimant_cov_dim_hist_id1 AS CLAIMANT_COV_DIM_HIST_ID, \n\tcov_dim_id1 AS COV_DIM_ID, \n\tcov_dim_hist_id1 AS COV_DIM_HIST_ID, \n\tclaim_trans_type_dim_id1 AS CLAIM_TRANS_TYPE_DIM_ID, \n\tclaim_financial_type_dim_id1 AS CLAIM_FINANCIAL_TYPE_DIM_ID, \n\treins_cov_dim_id_out1 AS REINS_COV_DIM_ID, \n\treins_cov_dim_hist_id_out1 AS REINS_COV_DIM_HIST_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_HIST_ID, \n\tclaim_rep_dim_examiner_id_Out1 AS CLAIM_REP_DIM_EXAMINER_ID, \n\tclaim_rep_dim_examiner_hist_id_out1 AS CLAIM_REP_DIM_EXAMINER_HIST_ID, \n\tclaim_rep_dim_prim_litigation_handler_id_out1 AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_ID, \n\tclaim_rep_dim_prim_litigation_handler_hist_id_out1 AS CLAIM_REP_DIM_PRIM_LITIGATION_HANDLER_HIST_ID, \n\tdefault_id1 AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_ID, \n\tdefault_id1 AS CLAIM_REP_DIM_TRANS_ENTRY_OPER_HIST_ID, \n\tclaim_created_by_dim_id_out1 AS CLAIM_REP_DIM_CLAIM_CREATED_BY_ID, \n\tpol_key_dim_id1 AS POL_DIM_ID, \n\tpol_key_dim_hist_id1 AS POL_DIM_HIST_ID, \n\tagency_dim_id1 AS AGENCY_DIM_ID, \n\tagency_dim_hist_id1 AS AGENCY_DIM_HIST_ID, \n\tdefault_id1 AS CLAIM_PAY_DIM_ID, \n\tdefault_id1 AS CLAIM_PAY_DIM_HIST_ID, \n\tdefault_id1 AS CLAIM_PAY_CTGRY_TYPE_DIM_ID, \n\tdefault_id1 AS CLAIM_PAY_CTGRY_TYPE_DIM_HIST_ID, \n\tclaim_case_dim_id_out1 AS CLAIM_CASE_DIM_ID, \n\tclaim_case_dim_hist_id_out1 AS CLAIM_CASE_DIM_HIST_ID, \n\tCONTRACT_CUST_DIM_ID, \n\tCONTRACT_CUST_DIM_HIST_ID, \n\tdefault_id1 AS CLAIM_MASTER_1099_LIST_DIM_ID, \n\tdefault_id1 AS CLAIM_SUBROGATION_DIM_ID, \n\tclaim_reins_trans_date_id1 AS CLAIM_TRANS_DATE_ID, \n\treprocess_date_id1 AS CLAIM_TRANS_REPROCESS_DATE_ID, \n\tclaim_loss_date_id1 AS CLAIM_LOSS_DATE_ID, \n\tclaim_discovery_date_id1 AS CLAIM_DISCOVERY_DATE_ID, \n\tCLAIM_SCRIPTED_DATE_ID, \n\tSOURCE_CLAIM_RPTED_DATE_ID, \n\tclaim_occurrence_rpted_date_id1 AS CLAIM_RPTED_DATE_ID, \n\tclaim_open_date_id1 AS CLAIM_OPEN_DATE_ID, \n\tclaim_close_date_id1 AS CLAIM_CLOSE_DATE_ID, \n\tclaim_reopen_date_id1 AS CLAIM_REOPEN_DATE_ID, \n\tclaim_closed_after_reopen_date_id1 AS CLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tCLAIM_NOTICE_ONLY_DATE_ID, \n\tclaim_cat_start_date_id1 AS CLAIM_CAT_START_DATE_ID, \n\tclaim_cat_end_date_id1 AS CLAIM_CAT_END_DATE_ID, \n\tclaim_rep_assigned_date_id1 AS CLAIM_REP_ASSIGNED_DATE_ID, \n\tclaim_rep_unassigned_date_id1 AS CLAIM_REP_UNASSIGNED_DATE_ID, \n\tpol_eff_date_id1 AS POL_EFF_DATE_ID, \n\tpol_exp_date_id1 AS POL_EXP_DATE_ID, \n\tDEFAULT_DATE_ID1 AS CLAIM_SUBROGATION_REFERRED_TO_SUBROGATION_DATE_ID, \n\tDEFAULT_DATE_ID1 AS CLAIM_SUBROGATION_PAY_START_DATE_ID, \n\tDEFAULT_DATE_ID1 AS CLAIM_SUBROGATION_CLOSURE_DATE_ID, \n\tclaim_reins_acct_entered_date_ID AS ACCT_ENTERED_DATE_ID, \n\tclaim_reins_trans_amt AS TRANS_AMT, \n\tclaim_reins_trans_hist_amt AS TRANS_HIST_AMT, \n\tDEFAULT_STRING1 AS TAX_ID, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_PAID_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_INCURRED_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_PAID_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_OUTSTANDING_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_INCURRED_EXCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_PAID_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_LOSS_INCURRED_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_PAID_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_OUTSTANDING_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_ALAE_INCURRED_INCLUDING_RECOVERIES, \n\tDEFAULT_AMOUNT1 AS DIRECT_SUBROGATION_PAID, \n\tDEFAULT_AMOUNT1 AS DIRECT_SUBROGATION_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS DIRECT_SUBROGATION_INCURRED, \n\tDEFAULT_AMOUNT1 AS DIRECT_SALVAGE_PAID, \n\tDEFAULT_AMOUNT1 AS DIRECT_SALVAGE_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS DIRECT_SALVAGE_INCURRED, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_LOSS_PAID, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_LOSS_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_LOSS_INCURRED, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_ALAE_PAID, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_ALAE_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_ALAE_INCURRED, \n\tDEFAULT_AMOUNT1 AS TOTAL_DIRECT_LOSS_RECOVERY_PAID, \n\tDEFAULT_AMOUNT1 AS TOTAL_DIRECT_LOSS_RECOVERY_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS TOTAL_DIRECT_LOSS_RECOVERY_INCURRED, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_PAID, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_OUTSTANDING, \n\tDEFAULT_AMOUNT1 AS DIRECT_OTHER_RECOVERY_INCURRED, \n\tCEDED_LOSS_PAID, \n\tCEDED_LOSS_OUTSTANDING, \n\tCEDED_LOSS_INCURRED, \n\tCEDED_ALAE_PAID, \n\tCEDED_ALAE_OUTSTANDING, \n\tCEDED_ALAE_INCURRED, \n\tCEDED_SALVAGE_PAID, \n\tCEDED_SUBROGATION_PAID, \n\tCEDED_OTHER_RECOVERY_LOSS_PAID, \n\tCEDED_OTHER_RECOVERY_ALAE_PAID, \n\tTOTAL_CEDED_LOSS_RECOVERY_PAID, \n\tnet_loss_paid1 AS NET_LOSS_PAID, \n\tnet_loss_outstanding1 AS NET_LOSS_OUTSTANDING, \n\tnet_loss_incurred1 AS NET_LOSS_INCURRED, \n\tnet_alae_paid1 AS NET_ALAE_PAID, \n\tnet_alae_outstanding1 AS NET_ALAE_OUTSTANDING, \n\tnet_alae_incurred1 AS NET_ALAE_INCURRED, \n\tdefault_id1 AS ASL_DIM_ID, \n\tdefault_id1 AS ASL_PRDCT_CODE_DIM_ID, \n\tdefault_id1 AS LOSS_MASTER_DIM_ID, \n\tstrtgc_bus_dvsn_dim_id1 AS STRTGC_BUS_DVSN_DIM_ID, \n\tdefault_id1 AS PRDCT_CODE_DIM_ID, \n\tdefault_id1 AS CLAIMRESERVEDIMID, \n\tdefault_id1 AS CLAIMREPRESENTATIVEDIMFEATURECLAIMREPRESENTATIVEID, \n\tDEFAULT_DATE_ID1 AS FEATUREREPRESENTATIVEASSIGNEDDATEID, \n\tInsuranceReferenceDimId1 AS INSURANCEREFERENCEDIMID, \n\tAgencyDimID1 AS AGENCYDIMID, \n\tSalesDivisionDimID1 AS SALESDIVISIONDIMID, \n\tInsuranceReferenceCoverageDimId1 AS INSURANCEREFERENCECOVERAGEDIMID, \n\tCoverageDetailDimId1 AS COVERAGEDETAILDIMID, \n\tModifiedDate1 AS MODIFIEDDATE\n\tFROM UPD_claim_loss_transaction_fact_insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246509"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905529"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604471"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 02:30:45"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 02:35:48"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "V2"
            },
            "TARGET_TABLE_OWNER_V3": {
                "type": "string",
                "defaultValue": "V3"
            },
            "DB_NAME_DATAMART": {
                "type": "string",
                "defaultValue": "WC_Data_Mart"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}