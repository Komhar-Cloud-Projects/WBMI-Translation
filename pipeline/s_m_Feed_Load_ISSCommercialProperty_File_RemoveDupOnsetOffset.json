{
    "name": "s_m_Feed_Load_ISSCommercialProperty_File_RemoveDupOnsetOffset",
    "properties": {
        "activities": [
            {
                "name": "m_Feed_Load_ISSCommercialProperty_File_RemoveDupOnse_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_ISSCommercialPropertyExtract_Loss_Unique AS (\n\tSELECT ISCP.ISSCommercialPropertyExtractId, ISCP.AuditId, \r\n\tISCP.CreatedDate, ISCP.EDWPremiumMasterCalculationPKId, \r\n\tISCP.EDWLossMasterCalculationPKId, ISCP.TypeBureauCode, \r\n\tISCP.BureauLineOfInsurance, ISCP.BureauCompanyNumber,\r\n\t ISCP.StateProvinceCode, ISCP.PremiumMasterRunDate, \r\n\t ISCP.LossMasterRunDate, ISCP.PolicyKey,\r\n\t  ISCP.PremiumMasterClassCode, ISCP.LossMasterClassCode, \r\n\t  ISCP.ClaimNumber, ISCP.ClaimantNumber, \r\n\t  ISCP.RiskTerritoryCode, ISCP.PolicyEffectiveDate, \r\n\t  ISCP.CauseOfLoss, ISCP.DeductibleAmount, \r\n\t  ISCP.CoverageCode, ISCP.ConstructionCode, \r\n\t  ISCP.ISOFireProtectionCode, ISCP.SublineCode, \r\n\t  ISCP.PackageModificationAdjustmentGroupDescription, ISCP.PolicyForm,\r\n\t   ISCP.PremiumMasterDirectWrittenPremiumAmount, ISCP.PaidLossAmount,\r\n\t    ISCP.OutstandingLossAmount, ISCP.PolicyExpirationDate, \r\n\t\tISCP.InceptionToDatePaidLossAmount, ISCP.ClaimantCoverageDetailId, \r\n\t\tISCP.AnnualStatementLineNumber, ISCP.TransactionEffectiveDate, \r\n\t\tISCP.LocationNumber, ISCP.BuildingNumber \r\n\tFROM\r\n\t ISSCommercialPropertyExtract ISCP\r\n\t where ISCP.EDWLossMasterCalculationPKId<>-1 and \r\n\tISCP.LossMasterRunDate\r\n\tbetween \r\n\t DATEADD(qq,DATEDIFF(qq,0,GETDATE())+@{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER},0)--first day of last Quarter   \r\n\t AND\r\n\t DATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE())+@{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\n),\nEXP_Loss_Unique AS (\n\tSELECT\n\tISSCommercialPropertyExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tTransactionEffectiveDate,\n\tLocationNumber,\n\tBuildingNumber\n\tFROM SQ_ISSCommercialPropertyExtract_Loss_Unique\n),\nSQ_ISSCommercialPropertyExtract_PremiumDup AS (\n\tWITH ROLLUP_TABLE_TEMP\r\n\tAS\r\n\t(SELECT\r\n\t\t\tCONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode,\r\n\t\t\tLossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode,\r\n\t\t\tSublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, ABS(PaidLossAmount), ABS(OutstandingLossAmount),\r\n\t\t\tPolicyExpirationDate,\r\n\t\t\tABS(InceptionToDatePaidLossAmount), ClaimantCoverageDetailId, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber,\r\n\t\t\tBuildingNumber) AS CONCAT_KEY\r\n\t\t\t,SUM(PremiumMasterDirectWrittenPremiumAmount) ROLL_UP_DWP_AMT\r\n\t\t\t,MAX(ISSCommercialPropertyExtractId) MAX_ISS_KEY\r\n\t\t\t,COUNT(*) AS count\r\n\t\tFROM ISSCommercialPropertyExtract\r\n\t\tWHERE EDWPremiumMasterCalculationPKId <> -1\r\n\t\tAND (ISSCommercialPropertyExtract.PremiumMasterRunDate\r\n\t\tBETWEEN\r\n\t\tDATEADD(qq, DATEDIFF(qq, 0, GETDATE()) + @{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER}, 0)--first day of last Quarter   \r\n\t\tAND\r\n\t\tDATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE()) + @{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\r\n\t\t)\r\n\t\tGROUP BY CONCAT(TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode,\r\n\t\tLossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode,\r\n\t\tSublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, ABS(PaidLossAmount), ABS(OutstandingLossAmount),\r\n\t\tPolicyExpirationDate,\r\n\t\tABS(InceptionToDatePaidLossAmount), ClaimantCoverageDetailId, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber,\r\n\t\tBuildingNumber)\r\n\t\tHAVING COUNT(*) > 1)\r\n\t\r\n\tSELECT\r\n\t\tISCP.ISSCommercialPropertyExtractId\r\n\t\t,ISCP.AuditId\r\n\t\t,ISCP.CreatedDate\r\n\t\t,ISCP.EDWPremiumMasterCalculationPKId\r\n\t\t,ISCP.EDWLossMasterCalculationPKId\r\n\t\t,ISCP.TypeBureauCode\r\n\t\t,ISCP.BureauLineOfInsurance\r\n\t\t,ISCP.BureauCompanyNumber\r\n\t\t,ISCP.StateProvinceCode\r\n\t\t,ISCP.PremiumMasterRunDate\r\n\t\t,ISCP.LossMasterRunDate\r\n\t\t,ISCP.PolicyKey\r\n\t\t,ISCP.PremiumMasterClassCode\r\n\t\t,ISCP.LossMasterClassCode\r\n\t\t,ISCP.ClaimNumber\r\n\t\t,ISCP.ClaimantNumber\r\n\t\t,ISCP.RiskTerritoryCode\r\n\t\t,ISCP.PolicyEffectiveDate\r\n\t\t,ISCP.CauseOfLoss\r\n\t\t,ISCP.DeductibleAmount\r\n\t\t,ISCP.CoverageCode\r\n\t\t,ISCP.ConstructionCode\r\n\t\t,ISCP.ISOFireProtectionCode\r\n\t\t,ISCP.SublineCode\r\n\t\t,ISCP.PackageModificationAdjustmentGroupDescription\r\n\t\t,ISCP.PolicyForm\r\n\t\t,ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT AS PremiumMasterDirectWrittenPremiumAmount\r\n\t\t,ISCP.PaidLossAmount\r\n\t\t,ISCP.OutstandingLossAmount\r\n\t\t,ISCP.PolicyExpirationDate\r\n\t\t,ISCP.InceptionToDatePaidLossAmount\r\n\t\t,ISCP.ClaimantCoverageDetailId\r\n\t\t,ISCP.AnnualStatementLineNumber\r\n\t\t,ISCP.TransactionEffectiveDate\r\n\t\t,ISCP.LocationNumber\r\n\t\t,ISCP.BuildingNumber\r\n\tFROM ROLLUP_TABLE_TEMP\r\n\tINNER JOIN ISSCommercialPropertyExtract ISCP\r\n\t\tON ISCP.ISSCommercialPropertyExtractId = ROLLUP_TABLE_TEMP.MAX_ISS_KEY\r\n\t\t\tAND ISCP.EDWPremiumMasterCalculationPKId <> -1\r\n\t\t\tAND (ISCP.PremiumMasterRunDate\r\n\t\t\tBETWEEN\r\n\t\t\tDATEADD(qq, DATEDIFF(qq, 0, GETDATE()) + @{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER}, 0)--first day of last Quarter   \r\n\t\t\tAND\r\n\t\t\tDATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE()) + @{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\r\n\t\t\t)\r\n\tWHERE ROLLUP_TABLE_TEMP.ROLL_UP_DWP_AMT <> 0\n),\nEXP_Premium_Dup AS (\n\tSELECT\n\tISSCommercialPropertyExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tTransactionEffectiveDate,\n\tLocationNumber,\n\tBuildingNumber\n\tFROM SQ_ISSCommercialPropertyExtract_PremiumDup\n),\nSQ_ISSCommercialPropertyExtract_Premium_unique AS (\n\twith Premium_unique as\r\n\t(\r\n\tselect concat(TypeBureauCode,BureauLineOfInsurance,BureauCompanyNumber,StateProvinceCode,PremiumMasterRunDate,LossMasterRunDate,PolicyKey,PremiumMasterClassCode,\r\n\tLossMasterClassCode,ClaimNumber,ClaimantNumber,RiskTerritoryCode,PolicyEffectiveDate,CauseOfLoss,DeductibleAmount,CoverageCode,ConstructionCode,ISOFireProtectionCode,\r\n\tSublineCode,PackageModificationAdjustmentGroupDescription,PolicyForm,abs(PaidLossAmount),abs(OutstandingLossAmount),\r\n\tPolicyExpirationDate,\r\n\tabs(InceptionToDatePaidLossAmount),ClaimantCoverageDetailId,AnnualStatementLineNumber,TransactionEffectiveDate,LocationNumber,\r\n\tBuildingNumber) as concat,\r\n\tcount(*) as count\r\n\tfrom\r\n\tISSCommercialPropertyExtract where EDWPremiumMasterCalculationPKId<>-1 and ( ISSCommercialPropertyExtract.PremiumMasterRunDate\r\n\t between \r\n\t DATEADD(qq,DATEDIFF(qq,0,GETDATE())+@{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER},0)--first day of last Quarter   \r\n\t AND\r\n\t DATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE())+@{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\r\n\t) OR\r\n\t(ISSCommercialPropertyExtract.LossMasterRunDate\r\n\tbetween \r\n\t DATEADD(qq,DATEDIFF(qq,0,GETDATE())+@{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER},0)--first day of last Quarter   \r\n\t AND\r\n\t DATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE())+@{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\r\n\t)  group by\r\n\tconcat(TypeBureauCode,BureauLineOfInsurance,BureauCompanyNumber,StateProvinceCode,PremiumMasterRunDate,LossMasterRunDate,PolicyKey,PremiumMasterClassCode,\r\n\tLossMasterClassCode,ClaimNumber,ClaimantNumber,RiskTerritoryCode,PolicyEffectiveDate,CauseOfLoss,DeductibleAmount,CoverageCode,ConstructionCode,ISOFireProtectionCode,\r\n\tSublineCode,PackageModificationAdjustmentGroupDescription,PolicyForm,\r\n\tabs(PaidLossAmount),abs(OutstandingLossAmount),\r\n\tPolicyExpirationDate,\r\n\tabs(InceptionToDatePaidLossAmount),ClaimantCoverageDetailId,AnnualStatementLineNumber,TransactionEffectiveDate,\r\n\tLocationNumber,BuildingNumber) \r\n\t having count(*)=1  \r\n\t )\r\n\t SELECT ISCP.ISSCommercialPropertyExtractId, ISCP.AuditId,\r\n\t ISCP.CreatedDate, ISCP.EDWPremiumMasterCalculationPKId,\r\n\t  ISCP.EDWLossMasterCalculationPKId, ISCP.TypeBureauCode, \r\n\t  ISCP.BureauLineOfInsurance, ISCP.BureauCompanyNumber, \r\n\t  ISCP.StateProvinceCode, ISCP.PremiumMasterRunDate,\r\n\t   ISCP.LossMasterRunDate, ISCP.PolicyKey, \r\n\t   ISCP.PremiumMasterClassCode, ISCP.LossMasterClassCode,\r\n\t    ISCP.ClaimNumber, ISCP.ClaimantNumber, \r\n\t\tISCP.RiskTerritoryCode, ISCP.PolicyEffectiveDate, \r\n\t\tISCP.CauseOfLoss, ISCP.DeductibleAmount, \r\n\t\tISCP.CoverageCode, ISCP.ConstructionCode,\r\n\t\t ISCP.ISOFireProtectionCode, ISCP.SublineCode, \r\n\t\t ISCP.PackageModificationAdjustmentGroupDescription, \r\n\t\t ISCP.PolicyForm, ISCP.PremiumMasterDirectWrittenPremiumAmount, \r\n\t\t ISCP.PaidLossAmount, ISCP.OutstandingLossAmount,\r\n\t\t  ISCP.PolicyExpirationDate, ISCP.InceptionToDatePaidLossAmount,\r\n\t\t   ISCP.ClaimantCoverageDetailId, ISCP.AnnualStatementLineNumber,\r\n\t\t    ISCP.TransactionEffectiveDate, ISCP.LocationNumber, \r\n\t\t\tISCP.BuildingNumber \r\n\tFROM\r\n\t ISSCommercialPropertyExtract  ISCP inner join Premium_unique b on\r\n\t concat(TypeBureauCode,BureauLineOfInsurance,BureauCompanyNumber,StateProvinceCode,PremiumMasterRunDate,LossMasterRunDate,PolicyKey,PremiumMasterClassCode,\r\n\tLossMasterClassCode,ClaimNumber,ClaimantNumber,RiskTerritoryCode,PolicyEffectiveDate,CauseOfLoss,DeductibleAmount,CoverageCode,ConstructionCode,ISOFireProtectionCode,\r\n\tSublineCode,PackageModificationAdjustmentGroupDescription,PolicyForm,abs(PaidLossAmount),abs(OutstandingLossAmount),\r\n\tPolicyExpirationDate,\r\n\tabs(InceptionToDatePaidLossAmount),ClaimantCoverageDetailId,AnnualStatementLineNumber,TransactionEffectiveDate,LocationNumber,\r\n\tBuildingNumber) =b.concat \r\n\t\r\n\tWHERE\r\n\t( ISCP.PremiumMasterRunDate\r\n\t between \r\n\t DATEADD(qq,DATEDIFF(qq,0,GETDATE())+@{pipeline().parameters.FIRST_DAY_OF_THE_QUARTER},0)--first day of last Quarter   \r\n\t AND\r\n\t DATEADD(dd, -1, DATEADD(qq, DATEDIFF(qq, 0, GETDATE())+@{pipeline().parameters.LAST_DAY_OF_THE_QUARTER}, 0)) -- Last day of last Quarter\r\n\t)\r\n\tand ISCP.EDWPremiumMasterCalculationPKId<>-1\n),\nEXP_Premium_unique AS (\n\tSELECT\n\tISSCommercialPropertyExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId,\n\tAnnualStatementLineNumber,\n\tTransactionEffectiveDate,\n\tLocationNumber,\n\tBuildingNumber\n\tFROM SQ_ISSCommercialPropertyExtract_Premium_unique\n),\nUnoin_All AS (\n\tSELECT ISSCommercialPropertyExtractId, AuditId AS Auditid, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode, SublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber, BuildingNumber\n\tFROM EXP_Premium_unique\n\tUNION\n\tSELECT ISSCommercialPropertyExtractId, AuditId AS Auditid, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode, SublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber, BuildingNumber\n\tFROM EXP_Loss_Unique\n\tUNION\n\tSELECT ISSCommercialPropertyExtractId, AuditId AS Auditid, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode, SublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailId, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber, BuildingNumber\n\tFROM EXP_Premium_Dup\n),\nEXP_get_all_data AS (\n\tSELECT\n\tISSCommercialPropertyExtractId,\n\tAuditid AS i_AuditId,\n\tCreatedDate AS i_CreatedDate,\n\tEDWPremiumMasterCalculationPKId AS i_EDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId AS i_EDWLossMasterCalculationPKId,\n\tTypeBureauCode AS i_TypeBureauCode,\n\tBureauLineOfInsurance AS i_BureauLineOfInsurance,\n\tBureauCompanyNumber AS i_BureauCompanyNumber,\n\tStateProvinceCode AS i_StateProvinceCode,\n\tPremiumMasterRunDate AS i_PremiumMasterRunDate,\n\tLossMasterRunDate AS i_LossMasterRunDate,\n\tPolicyKey AS i_PolicyKey,\n\tPremiumMasterClassCode AS i_PremiumMasterClassCode,\n\tLossMasterClassCode AS i_LossMasterClassCode,\n\tClaimNumber AS i_ClaimNumber,\n\tClaimantNumber AS i_ClaimantNumber,\n\tRiskTerritoryCode AS i_RiskTerritoryCode,\n\tPolicyEffectiveDate AS i_PolicyEffectiveDate,\n\tCauseOfLoss AS i_CauseOfLoss,\n\tDeductibleAmount AS i_DeductibleAmount,\n\tCoverageCode AS i_CoverageCode,\n\tConstructionCode AS i_ConstructionCode,\n\tISOFireProtectionCode AS i_ISOFireProtectionCode,\n\tSublineCode AS i_SublineCode,\n\tPackageModificationAdjustmentGroupDescription AS i_PackageModificationAdjustmentGroupDescription,\n\tPolicyForm AS i_PolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount AS i_PremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount AS i_PaidLossAmount,\n\tOutstandingLossAmount AS i_OutstandingLossAmount,\n\tPolicyExpirationDate AS i_PolicyExpirationDate,\n\tInceptionToDatePaidLossAmount AS i_InceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailId AS i_ClaimantCoverageDetailId,\n\tAnnualStatementLineNumber AS i_AnnualStatementLineNumber,\n\tTransactionEffectiveDate AS i_TransactionEffectiveDate,\n\tLocationNumber AS i_LocationNumber,\n\tBuildingNumber AS i_BuildingNumber,\n\tISSCommercialPropertyExtractId AS o_WorkISSExtractId,\n\ti_AuditId AS o_AuditId,\n\ti_CreatedDate AS o_CreatedDate,\n\ti_EDWPremiumMasterCalculationPKId AS o_EDWPremiumMasterCalculationPKId,\n\ti_EDWLossMasterCalculationPKId AS o_EDWLossMasterCalculationPKId,\n\t-- *INF*: LTRIM(RTRIM(i_TypeBureauCode))\n\tLTRIM(RTRIM(i_TypeBureauCode)) AS o_TypeBureauCode,\n\t-- *INF*: LTRIM(RTRIM(i_BureauLineOfInsurance))\n\tLTRIM(RTRIM(i_BureauLineOfInsurance)) AS o_BureauLineOfInsurance,\n\t-- *INF*: LTRIM(RTRIM(i_BureauCompanyNumber))\n\tLTRIM(RTRIM(i_BureauCompanyNumber)) AS o_BureauCompanyNumber,\n\t-- *INF*: LTRIM(RTRIM(i_StateProvinceCode))\n\tLTRIM(RTRIM(i_StateProvinceCode)) AS o_StateProvinceCode,\n\ti_PremiumMasterRunDate AS o_PremiumMasterRunDate,\n\ti_LossMasterRunDate AS o_LossMasterRunDate,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyKey))\n\tLTRIM(RTRIM(i_PolicyKey)) AS o_PolicyKey,\n\t-- *INF*: LTRIM(RTRIM(i_PremiumMasterClassCode))\n\tLTRIM(RTRIM(i_PremiumMasterClassCode)) AS o_PremiumMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_LossMasterClassCode))\n\tLTRIM(RTRIM(i_LossMasterClassCode)) AS o_LossMasterClassCode,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimNumber))\n\tLTRIM(RTRIM(i_ClaimNumber)) AS o_ClaimNumber,\n\t-- *INF*: LTRIM(RTRIM(i_ClaimantNumber))\n\tLTRIM(RTRIM(i_ClaimantNumber)) AS o_ClaimantNumber,\n\t-- *INF*: LTRIM(RTRIM(i_RiskTerritoryCode))\n\tLTRIM(RTRIM(i_RiskTerritoryCode)) AS o_RiskTerritoryCode,\n\ti_PolicyEffectiveDate AS o_PolicyEffectiveDate,\n\t-- *INF*: LTRIM(RTRIM(i_CauseOfLoss))\n\tLTRIM(RTRIM(i_CauseOfLoss)) AS o_CauseOfLoss,\n\t-- *INF*: LTRIM(RTRIM(i_DeductibleAmount))\n\tLTRIM(RTRIM(i_DeductibleAmount)) AS o_DeductibleAmount,\n\t-- *INF*: LTRIM(RTRIM(i_CoverageCode))\n\tLTRIM(RTRIM(i_CoverageCode)) AS o_CoverageCode,\n\t-- *INF*: LTRIM(RTRIM(i_ConstructionCode))\n\tLTRIM(RTRIM(i_ConstructionCode)) AS o_ConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(i_ISOFireProtectionCode))\n\tLTRIM(RTRIM(i_ISOFireProtectionCode)) AS o_ISOFireProtectionCode,\n\t-- *INF*: LTRIM(RTRIM(i_SublineCode))\n\tLTRIM(RTRIM(i_SublineCode)) AS o_SublineCode,\n\t-- *INF*: LTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription))\n\tLTRIM(RTRIM(i_PackageModificationAdjustmentGroupDescription)) AS o_PackageModificationAdjustmentGroupDescription,\n\t-- *INF*: LTRIM(RTRIM(i_PolicyForm))\n\tLTRIM(RTRIM(i_PolicyForm)) AS o_PolicyForm,\n\ti_PremiumMasterDirectWrittenPremiumAmount AS o_PremiumMasterDirectWrittenPremiumAmount,\n\ti_PaidLossAmount AS o_PaidLossAmount,\n\ti_OutstandingLossAmount AS o_OutstandingLossAmount,\n\ti_PolicyExpirationDate AS o_PolicyExpirationDate,\n\ti_InceptionToDatePaidLossAmount AS o_InceptionToDatePaidLossAmount,\n\ti_ClaimantCoverageDetailId AS o_ClaimantCoverageDetailID,\n\ti_AnnualStatementLineNumber AS o_AnnualStatementLineNumber,\n\ti_TransactionEffectiveDate AS o_TransactionEffectiveDate,\n\ti_LocationNumber AS o_LocationNumber,\n\ti_BuildingNumber AS o_BuildingNumber\n\tFROM Unoin_All\n),\nRTR_CR_CF AS (\n\tSELECT\n\to_WorkISSExtractId AS WorkISSExtractId,\n\to_AuditId AS AuditId,\n\to_CreatedDate AS CreatedDate,\n\to_EDWPremiumMasterCalculationPKId AS EDWPremiumMasterCalculationPKId,\n\to_EDWLossMasterCalculationPKId AS EDWLossMasterCalculationPKId,\n\to_TypeBureauCode AS TypeBureauCode,\n\to_BureauLineOfInsurance AS BureauLineOfInsurance,\n\to_BureauCompanyNumber AS BureauCompanyNumber,\n\to_StateProvinceCode AS StateProvinceCode,\n\to_PremiumMasterRunDate AS PremiumMasterRunDate,\n\to_LossMasterRunDate AS LossMasterRunDate,\n\to_PolicyKey AS PolicyKey,\n\to_PremiumMasterClassCode AS PremiumMasterClassCode,\n\to_LossMasterClassCode AS LossMasterClassCode,\n\to_ClaimNumber AS ClaimNumber,\n\to_ClaimantNumber AS ClaimantNumber,\n\to_RiskTerritoryCode AS RiskTerritoryCode,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_CauseOfLoss AS CauseOfLoss,\n\to_DeductibleAmount AS DeductibleAmount,\n\to_CoverageCode AS CoverageCode,\n\to_ConstructionCode AS ConstructionCode,\n\to_ISOFireProtectionCode AS ISOFireProtectionCode,\n\to_SublineCode AS SublineCode,\n\to_PackageModificationAdjustmentGroupDescription AS PackageModificationAdjustmentGroupDescription,\n\to_PolicyForm AS PolicyForm,\n\to_PremiumMasterDirectWrittenPremiumAmount AS PremiumMasterDirectWrittenPremiumAmount,\n\to_PaidLossAmount AS PaidLossAmount,\n\to_OutstandingLossAmount AS OutstandingLossAmount,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\to_InceptionToDatePaidLossAmount AS InceptionToDatePaidLossAmount,\n\to_ClaimantCoverageDetailID AS ClaimantCoverageDetailID,\n\to_AnnualStatementLineNumber AS AnnualStatementLineNumber,\n\to_TransactionEffectiveDate AS TransactionEffectiveDate,\n\to_LocationNumber AS LocationNumber,\n\to_BuildingNumber AS BuildingNumber\n\tFROM EXP_get_all_data\n),\nRTR_CR_CF_CommercialProperty AS (SELECT * FROM RTR_CR_CF WHERE IN(LTRIM(RTRIM(TypeBureauCode)),'CF','Property','SBOPProperty') AND NOT IN(SublineCode,'940','960','965')),\nRTR_CR_CF_DEFAULT1 AS (SELECT * FROM RTR_CR_CF WHERE NOT ( (IN(LTRIM(RTRIM(TypeBureauCode)),'CF','Property','SBOPProperty') AND NOT IN(SublineCode,'940','960','965')) )),\nEXP_TargetCommercialProperty AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_CommercialProperty_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_CommercialProperty_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\tWorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailID,\n\tAnnualStatementLineNumber,\n\tTransactionEffectiveDate,\n\tLocationNumber,\n\tBuildingNumber\n\tFROM RTR_CR_CF_CommercialProperty\n),\nSRT_ISS_FlatFile_CF AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\tBureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\tPremiumMasterClassCode, \n\tLossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\tCauseOfLoss, \n\tDeductibleAmount, \n\tCoverageCode, \n\tConstructionCode, \n\tISOFireProtectionCode, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPolicyForm, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tTransactionEffectiveDate, \n\tLocationNumber, \n\tBuildingNumber\n\tFROM EXP_TargetCommercialProperty\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, CoverageCode ASC, AnnualStatementLineNumber ASC\n),\nISSFlatFile_CF AS (\n\tINSERT INTO ISSFlatFile\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode, SublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber, BuildingNumber)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tDEDUCTIBLEAMOUNT, \n\tCOVERAGECODE, \n\tCONSTRUCTIONCODE, \n\tISOFIREPROTECTIONCODE, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPOLICYFORM, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tTRANSACTIONEFFECTIVEDATE, \n\tLOCATIONNUMBER, \n\tBUILDINGNUMBER\n\tFROM SRT_ISS_FlatFile_CF\n),\nEXP_TargetCrime AS (\n\tSELECT\n\t-- *INF*: TRUNC(sysdate,'DD')\n\tCAST(TRUNC(CURRENT_TIMESTAMP, 'DAY') AS TIMESTAMP_NTZ(0)) AS v_RunDate,\n\t-- *INF*: 'ISS_Crime_'||TO_CHAR(v_RunDate,'YYYYMMDD')||'.CSV'\n\t'ISS_Crime_' || TO_CHAR(v_RunDate, 'YYYYMMDD') || '.CSV' AS FileName,\n\tWorkISSExtractId,\n\tAuditId,\n\tCreatedDate,\n\tEDWPremiumMasterCalculationPKId,\n\tEDWLossMasterCalculationPKId,\n\tTypeBureauCode,\n\tBureauLineOfInsurance,\n\tBureauCompanyNumber,\n\tStateProvinceCode,\n\tPremiumMasterRunDate,\n\tLossMasterRunDate,\n\tPolicyKey,\n\tPremiumMasterClassCode,\n\tLossMasterClassCode,\n\tClaimNumber,\n\tClaimantNumber,\n\tRiskTerritoryCode,\n\tPolicyEffectiveDate,\n\tCauseOfLoss,\n\tDeductibleAmount,\n\tCoverageCode,\n\tConstructionCode,\n\tISOFireProtectionCode,\n\tSublineCode,\n\tPackageModificationAdjustmentGroupDescription,\n\tPolicyForm,\n\tPremiumMasterDirectWrittenPremiumAmount,\n\tPaidLossAmount,\n\tOutstandingLossAmount,\n\tPolicyExpirationDate,\n\tInceptionToDatePaidLossAmount,\n\tClaimantCoverageDetailID,\n\tAnnualStatementLineNumber,\n\tTransactionEffectiveDate,\n\tLocationNumber,\n\tBuildingNumber,\n\t'00' AS DefaultString,\n\t03 AS o_BureauLineOfInsurance,\n\t'N/A' AS o_PremiumMasterClassCode,\n\t'N/A' AS o_LossMasterClassCode,\n\t'N/A' AS o_CauseOfLoss,\n\t'N/A' AS o_DeductibleAmount,\n\t'N/A' AS o_CoverageCode\n\tFROM RTR_CR_CF_DEFAULT1\n),\nSRT_ISS_FlatFile_CR AS (\n\tSELECT\n\tFileName, \n\tWorkISSExtractId, \n\tAuditId, \n\tCreatedDate, \n\tEDWPremiumMasterCalculationPKId, \n\tEDWLossMasterCalculationPKId, \n\tTypeBureauCode, \n\to_BureauLineOfInsurance AS BureauLineOfInsurance, \n\tBureauCompanyNumber, \n\tStateProvinceCode, \n\tPremiumMasterRunDate, \n\tLossMasterRunDate, \n\tPolicyKey, \n\to_PremiumMasterClassCode AS PremiumMasterClassCode, \n\to_LossMasterClassCode AS LossMasterClassCode, \n\tClaimNumber, \n\tClaimantNumber, \n\tRiskTerritoryCode, \n\tPolicyEffectiveDate, \n\to_CauseOfLoss AS CauseOfLoss, \n\to_DeductibleAmount AS DeductibleAmount, \n\to_CoverageCode AS CoverageCode, \n\tDefaultString AS ConstructionCode, \n\tDefaultString AS ISOFireProtectionCode, \n\tSublineCode, \n\tPackageModificationAdjustmentGroupDescription, \n\tPolicyForm, \n\tPremiumMasterDirectWrittenPremiumAmount, \n\tPaidLossAmount, \n\tOutstandingLossAmount, \n\tPolicyExpirationDate, \n\tInceptionToDatePaidLossAmount, \n\tClaimantCoverageDetailID, \n\tAnnualStatementLineNumber, \n\tTransactionEffectiveDate, \n\tLocationNumber, \n\tBuildingNumber\n\tFROM EXP_TargetCrime\n\tORDER BY PolicyKey ASC, PremiumMasterClassCode ASC, CoverageCode ASC, AnnualStatementLineNumber ASC\n),\nISSFlatFile_CR AS (\n\tINSERT INTO ISSFlatFile\n\t(FileName, WorkISSExtractId, AuditId, CreatedDate, EDWPremiumMasterCalculationPKId, EDWLossMasterCalculationPKId, TypeBureauCode, BureauLineOfInsurance, BureauCompanyNumber, StateProvinceCode, PremiumMasterRunDate, LossMasterRunDate, PolicyKey, PremiumMasterClassCode, LossMasterClassCode, ClaimNumber, ClaimantNumber, RiskTerritoryCode, PolicyEffectiveDate, CauseOfLoss, DeductibleAmount, CoverageCode, ConstructionCode, ISOFireProtectionCode, SublineCode, PackageModificationAdjustmentGroupDescription, PolicyForm, PremiumMasterDirectWrittenPremiumAmount, PaidLossAmount, OutstandingLossAmount, PolicyExpirationDate, InceptionToDatePaidLossAmount, ClaimantCoverageDetailID, AnnualStatementLineNumber, TransactionEffectiveDate, LocationNumber, BuildingNumber)\n\tSELECT \n\tFILENAME, \n\tWORKISSEXTRACTID, \n\tAUDITID, \n\tCREATEDDATE, \n\tEDWPREMIUMMASTERCALCULATIONPKID, \n\tEDWLOSSMASTERCALCULATIONPKID, \n\tTYPEBUREAUCODE, \n\tBUREAULINEOFINSURANCE, \n\tBUREAUCOMPANYNUMBER, \n\tSTATEPROVINCECODE, \n\tPREMIUMMASTERRUNDATE, \n\tLOSSMASTERRUNDATE, \n\tPOLICYKEY, \n\tPREMIUMMASTERCLASSCODE, \n\tLOSSMASTERCLASSCODE, \n\tCLAIMNUMBER, \n\tCLAIMANTNUMBER, \n\tRISKTERRITORYCODE, \n\tPOLICYEFFECTIVEDATE, \n\tCAUSEOFLOSS, \n\tDEDUCTIBLEAMOUNT, \n\tCOVERAGECODE, \n\tCONSTRUCTIONCODE, \n\tISOFIREPROTECTIONCODE, \n\tSUBLINECODE, \n\tPACKAGEMODIFICATIONADJUSTMENTGROUPDESCRIPTION, \n\tPOLICYFORM, \n\tPREMIUMMASTERDIRECTWRITTENPREMIUMAMOUNT, \n\tPAIDLOSSAMOUNT, \n\tOUTSTANDINGLOSSAMOUNT, \n\tPOLICYEXPIRATIONDATE, \n\tINCEPTIONTODATEPAIDLOSSAMOUNT, \n\tCLAIMANTCOVERAGEDETAILID, \n\tANNUALSTATEMENTLINENUMBER, \n\tTRANSACTIONEFFECTIVEDATE, \n\tLOCATIONNUMBER, \n\tBUILDINGNUMBER\n\tFROM SRT_ISS_FlatFile_CR\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "FIRST_DAY_OF_THE_QUARTER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "LAST_DAY_OF_THE_QUARTER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "DataFeed -Informatica/PolicyDataServices/"
        },
        "annotations": []
    }
}