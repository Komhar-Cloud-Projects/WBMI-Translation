{
    "name": "s_m_POL_ExampleIDO_STG_Insert_DCCFPropertyStaging",
    "properties": {
        "activities": [
            {
                "name": "m_POL_ExampleIDO_STG_Insert_DCCFPropertyStaging",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_DC_CF_Property AS (\n\tWITH cte_DCCFProperty(Sessionid) as\r\n\t(select sessionid from @{pipeline().parameters.SOURCE_DATABASE_WB}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.WB_EDWIncrementalDataQualitySessions where ModifiedDate between '@{pipeline().parameters.SELECTION_START_TS}' and '@{pipeline().parameters.SELECTION_END_TS}' \r\n\tAND Autoshred<> '1' \r\n\t UNION \r\n\t select distinct A.sessionid from @{pipeline().parameters.SOURCE_TABLE_OWNER}.DC_Session A Inner join @{pipeline().parameters.SOURCE_TABLE_OWNER}.DC_Transaction B on A.SessionID=B.SessionID where B.State<> 'committed' and A.CreateDateTime>='@{pipeline().parameters.SELECTION_START_TS}')\r\n\tSELECT \r\n\tX.CF_RiskId, \r\n\tX.CF_PropertyId, \r\n\tX.SessionId, \r\n\tX.Id, \r\n\tX.BG1Coverages, \r\n\tX.BG1PremRatingGroup, \r\n\tX.BG1SpecificOccupancyGroupLA, \r\n\tX.BG1SpecificRate, \r\n\tX.BG1SpecificRateForNY, \r\n\tX.BG1SpecificRateLCMSelect, \r\n\tX.BG1SpecificRateSelect, \r\n\tX.BG2HeavyMachinery, \r\n\tX.BG2PremRatingGroup, \r\n\tX.BG2SpecificRate, \r\n\tX.BG2Symbol, \r\n\tX.BG2SymbolApply, \r\n\tX.BG2SymbolPrefix, \r\n\tX.BG2TrailerAutoHomesMS, \r\n\tX.BlanketHighestRateNote, \r\n\tX.BuildingMaterialsSuppliesOfOthersPremiumBLDRK, \r\n\tX.BurglarAlarm, \r\n\tX.BurglarAlarmExtentOfProtection, \r\n\tX.BurglarAlarmGrade, \r\n\tX.CauseOfLoss, \r\n\tX.ClassLimit, \r\n\tX.CoinsurancePercentage, \r\n\tX.CoinsurancePercentageGroupRated, \r\n\tX.CoinsuranceRequirement, \r\n\tX.CoinsuranceValueReporting, \r\n\tX.CollapseBLDRK, \r\n\tX.CommunicationSupply, \r\n\tX.ComputerFailure, \r\n\tX.ContentType, \r\n\tX.CSP, \r\n\tX.EarthquakeSelect, \r\n\tX.EligibleForDeductibleInsurancePlan, \r\n\tX.ExteriorWallsOfClayMS, \r\n\tX.IncidentalApartment, \r\n\tX.LimitedSprinklerExposure, \r\n\tX.NonSprinkleredBuilding, \r\n\tX.OccupancyType, \r\n\tX.OtherCauseOfLossRiskType, \r\n\tX.OtherPremRatingGroup, \r\n\tX.OtherProtectiveDeviceFactor, \r\n\tX.OtherProtectiveDevices, \r\n\tX.PowerSupply, \r\n\tX.ProviderType, \r\n\tX.PublicPropertySelect, \r\n\tX.RenovationsBLDRK, \r\n\tX.ReportingFormBLDRK, \r\n\tX.SpecializedUse, \r\n\tX.SprinkleredBuilding, \r\n\tX.SprinklerPercentage, \r\n\tX.StateOwnedPropCredit, \r\n\tX.SubContractors, \r\n\tX.TenantsImprovementsBetterments, \r\n\tX.TheftOfBuildingMaterialsBLDRK, \r\n\tX.UnitNumber, \r\n\tX.Valuation, \r\n\tX.WatchmanProtection, \r\n\tX.WaterSupply, \r\n\tX.WindstormProtectiveDevices, \r\n\tX.YardConstruction \r\n\tFROM\r\n\tDC_CF_Property X\r\n\tinner join\r\n\tcte_DCCFProperty Y on X.Sessionid = Y.Sessionid\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Metadata AS (\n\tSELECT\n\tCF_RiskId,\n\tCF_PropertyId,\n\tSessionId,\n\tId,\n\tBG1Coverages,\n\tBG1PremRatingGroup,\n\tBG1SpecificOccupancyGroupLA,\n\tBG1SpecificRate,\n\tBG1SpecificRateForNY,\n\tBG1SpecificRateLCMSelect,\n\tBG1SpecificRateSelect,\n\tBG2HeavyMachinery,\n\tBG2PremRatingGroup,\n\tBG2SpecificRate,\n\tBG2Symbol,\n\tBG2SymbolApply,\n\tBG2SymbolPrefix,\n\tBG2TrailerAutoHomesMS,\n\tBlanketHighestRateNote,\n\tBuildingMaterialsSuppliesOfOthersPremiumBLDRK,\n\tBurglarAlarm,\n\tBurglarAlarmExtentOfProtection,\n\tBurglarAlarmGrade,\n\tCauseOfLoss,\n\tClassLimit,\n\tCoinsurancePercentage,\n\tCoinsurancePercentageGroupRated,\n\tCoinsuranceRequirement,\n\tCoinsuranceValueReporting,\n\tCollapseBLDRK,\n\tCommunicationSupply,\n\tComputerFailure,\n\tContentType,\n\tCSP,\n\tEarthquakeSelect,\n\tEligibleForDeductibleInsurancePlan,\n\tExteriorWallsOfClayMS,\n\tIncidentalApartment,\n\tLimitedSprinklerExposure,\n\tNonSprinkleredBuilding,\n\tOccupancyType,\n\tOtherCauseOfLossRiskType,\n\tOtherPremRatingGroup,\n\tOtherProtectiveDeviceFactor,\n\tOtherProtectiveDevices,\n\tPowerSupply,\n\tProviderType,\n\tPublicPropertySelect,\n\tRenovationsBLDRK,\n\tReportingFormBLDRK,\n\tSpecializedUse,\n\tSprinkleredBuilding,\n\tSprinklerPercentage,\n\tStateOwnedPropCredit,\n\tSubContractors,\n\tTenantsImprovementsBetterments,\n\tTheftOfBuildingMaterialsBLDRK,\n\tUnitNumber,\n\tValuation,\n\tWatchmanProtection,\n\tWaterSupply,\n\tWindstormProtectiveDevices,\n\tYardConstruction,\n\t-- *INF*: DECODE(BG1SpecificRateForNY, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    BG1SpecificRateForNY,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateForNY,\n\t-- *INF*: DECODE(BG1SpecificRateLCMSelect, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    BG1SpecificRateLCMSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateLCMSelect,\n\t-- *INF*: DECODE(BG1SpecificRateSelect, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    BG1SpecificRateSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG1SpecificRateSelect,\n\t-- *INF*: DECODE(BG2SymbolApply, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    BG2SymbolApply,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG2SymbolApply,\n\t-- *INF*: DECODE(BG2TrailerAutoHomesMS, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    BG2TrailerAutoHomesMS,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_BG2TrailerAutoHomesMS,\n\t-- *INF*: DECODE(ComputerFailure, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    ComputerFailure,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ComputerFailure,\n\t-- *INF*: DECODE(EarthquakeSelect, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    EarthquakeSelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_EarthquakeSelect,\n\t-- *INF*: DECODE(EligibleForDeductibleInsurancePlan, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    EligibleForDeductibleInsurancePlan,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_EligibleForDeductibleInsurancePlan,\n\t-- *INF*: DECODE(ExteriorWallsOfClayMS, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    ExteriorWallsOfClayMS,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ExteriorWallsOfClayMS,\n\t-- *INF*: DECODE(IncidentalApartment, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    IncidentalApartment,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_IncidentalApartment,\n\t-- *INF*: DECODE(LimitedSprinklerExposure, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    LimitedSprinklerExposure,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_LimitedSprinklerExposure,\n\t-- *INF*: DECODE(NonSprinkleredBuilding, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    NonSprinkleredBuilding,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_NonSprinkleredBuilding,\n\t-- *INF*: DECODE(OtherProtectiveDevices, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    OtherProtectiveDevices,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_OtherProtectiveDevices,\n\t-- *INF*: DECODE(PublicPropertySelect, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    PublicPropertySelect,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_PublicPropertySelect,\n\t-- *INF*: DECODE(RenovationsBLDRK, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    RenovationsBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_RenovationsBLDRK,\n\t-- *INF*: DECODE(ReportingFormBLDRK, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    ReportingFormBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_ReportingFormBLDRK,\n\t-- *INF*: DECODE(SprinkleredBuilding, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    SprinkleredBuilding,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_SprinkleredBuilding,\n\t-- *INF*: DECODE(StateOwnedPropCredit, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    StateOwnedPropCredit,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_StateOwnedPropCredit,\n\t-- *INF*: DECODE(TenantsImprovementsBetterments, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    TenantsImprovementsBetterments,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_TenantsImprovementsBetterments,\n\t-- *INF*: DECODE(TheftOfBuildingMaterialsBLDRK, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    TheftOfBuildingMaterialsBLDRK,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_TheftOfBuildingMaterialsBLDRK,\n\t-- *INF*: DECODE(WaterSupply, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    WaterSupply,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_WaterSupply,\n\t-- *INF*: DECODE(WindstormProtectiveDevices, 'T', 1, 'F', 0, NULL)\n\tDECODE(\n\t    WindstormProtectiveDevices,\n\t    'T', 1,\n\t    'F', 0,\n\t    NULL\n\t) AS o_WindstormProtectiveDevices,\n\tsysdate AS o_ExtractDate,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS o_SourceSystemId\n\tFROM SQ_DC_CF_Property\n),\nDCCFPropertyStaging AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.DCCFPropertyStaging;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.DCCFPropertyStaging\n\t(CF_PropertyId, SessionId, Id, BG1Coverages, BG1PremRatingGroup, BG1SpecificOccupancyGroupLA, BG1SpecificRate, BG1SpecificRateForNY, BG1SpecificRateLCMSelect, BG1SpecificRateSelect, BG2HeavyMachinery, BG2PremRatingGroup, BG2SpecificRate, BG2Symbol, BG2SymbolApply, BG2SymbolPrefix, BG2TrailerAutoHomesMS, BlanketHighestRateNote, BuildingMaterialsSuppliesOfOthersPremiumBLDRK, BurglarAlarm, BurglarAlarmExtentOfProtection, BurglarAlarmGrade, CauseOfLoss, ClassLimit, CoinsurancePercentage, CoinsurancePercentageGroupRated, CoinsuranceRequirement, CoinsuranceValueReporting, CollapseBLDRK, CommunicationSupply, ComputerFailure, ContentType, CSP, EarthquakeSelect, EligibleForDeductibleInsurancePlan, ExteriorWallsOfClayMS, IncidentalApartment, LimitedSprinklerExposure, NonSprinkleredBuilding, OccupancyType, OtherCauseOfLossRiskType, OtherPremRatingGroup, OtherProtectiveDeviceFactor, OtherProtectiveDevices, PowerSupply, ProviderType, PublicPropertySelect, RenovationsBLDRK, ReportingFormBLDRK, SpecializedUse, SprinkleredBuilding, SprinklerPercentage, StateOwnedPropCredit, SubContractors, TenantsImprovementsBetterments, TheftOfBuildingMaterialsBLDRK, UnitNumber, Valuation, WatchmanProtection, WaterSupply, WindstormProtectiveDevices, YardConstruction, ExtractDate, SourceSystemId, CF_RiskId)\n\tSELECT \n\tCF_PROPERTYID, \n\tSESSIONID, \n\tID, \n\tBG1COVERAGES, \n\tBG1PREMRATINGGROUP, \n\tBG1SPECIFICOCCUPANCYGROUPLA, \n\tBG1SPECIFICRATE, \n\to_BG1SpecificRateForNY AS BG1SPECIFICRATEFORNY, \n\to_BG1SpecificRateLCMSelect AS BG1SPECIFICRATELCMSELECT, \n\to_BG1SpecificRateSelect AS BG1SPECIFICRATESELECT, \n\tBG2HEAVYMACHINERY, \n\tBG2PREMRATINGGROUP, \n\tBG2SPECIFICRATE, \n\tBG2SYMBOL, \n\to_BG2SymbolApply AS BG2SYMBOLAPPLY, \n\tBG2SYMBOLPREFIX, \n\to_BG2TrailerAutoHomesMS AS BG2TRAILERAUTOHOMESMS, \n\tBLANKETHIGHESTRATENOTE, \n\tBUILDINGMATERIALSSUPPLIESOFOTHERSPREMIUMBLDRK, \n\tBURGLARALARM, \n\tBURGLARALARMEXTENTOFPROTECTION, \n\tBURGLARALARMGRADE, \n\tCAUSEOFLOSS, \n\tCLASSLIMIT, \n\tCOINSURANCEPERCENTAGE, \n\tCOINSURANCEPERCENTAGEGROUPRATED, \n\tCOINSURANCEREQUIREMENT, \n\tCOINSURANCEVALUEREPORTING, \n\tCOLLAPSEBLDRK, \n\tCOMMUNICATIONSUPPLY, \n\to_ComputerFailure AS COMPUTERFAILURE, \n\tCONTENTTYPE, \n\tCSP, \n\to_EarthquakeSelect AS EARTHQUAKESELECT, \n\to_EligibleForDeductibleInsurancePlan AS ELIGIBLEFORDEDUCTIBLEINSURANCEPLAN, \n\to_ExteriorWallsOfClayMS AS EXTERIORWALLSOFCLAYMS, \n\to_IncidentalApartment AS INCIDENTALAPARTMENT, \n\to_LimitedSprinklerExposure AS LIMITEDSPRINKLEREXPOSURE, \n\to_NonSprinkleredBuilding AS NONSPRINKLEREDBUILDING, \n\tOCCUPANCYTYPE, \n\tOTHERCAUSEOFLOSSRISKTYPE, \n\tOTHERPREMRATINGGROUP, \n\tOTHERPROTECTIVEDEVICEFACTOR, \n\to_OtherProtectiveDevices AS OTHERPROTECTIVEDEVICES, \n\tPOWERSUPPLY, \n\tPROVIDERTYPE, \n\to_PublicPropertySelect AS PUBLICPROPERTYSELECT, \n\to_RenovationsBLDRK AS RENOVATIONSBLDRK, \n\to_ReportingFormBLDRK AS REPORTINGFORMBLDRK, \n\tSPECIALIZEDUSE, \n\to_SprinkleredBuilding AS SPRINKLEREDBUILDING, \n\tSPRINKLERPERCENTAGE, \n\to_StateOwnedPropCredit AS STATEOWNEDPROPCREDIT, \n\tSUBCONTRACTORS, \n\to_TenantsImprovementsBetterments AS TENANTSIMPROVEMENTSBETTERMENTS, \n\to_TheftOfBuildingMaterialsBLDRK AS THEFTOFBUILDINGMATERIALSBLDRK, \n\tUNITNUMBER, \n\tVALUATION, \n\tWATCHMANPROTECTION, \n\to_WaterSupply AS WATERSUPPLY, \n\to_WindstormProtectiveDevices AS WINDSTORMPROTECTIVEDEVICES, \n\tYARDCONSTRUCTION, \n\to_ExtractDate AS EXTRACTDATE, \n\to_SourceSystemId AS SOURCESYSTEMID, \n\tCF_RISKID\n\tFROM EXP_Metadata\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_DATABASE_WB": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/PolicyStaging/"
        },
        "annotations": []
    }
}