{
    "name": "s_m_CLM_NCCI_Extract_Create_File_For_Transmission",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_NCCI_Extract_Create_File_For_Transmission",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_work_claim_ncci_report_extract1 AS (\n\tSELECT count(*) as work_claim_ncci_rpt_extract_id\r\n\tFROM   work_claim_ncci_report_extract  WITH (NOLOCK)\r\n\tWHERE  transm_status in ('Y','O')\n),\nExp_Control_Submission_Record AS (\n\tSELECT\n\t'9' AS Record_type_code,\n\t'17124' AS Carrier_Group_Code,\n\t' ' AS Filler,\n\twork_claim_ncci_rpt_extract_id AS Count,\n\t-- *INF*: lpad(to_Char(Count),8,'0')\n\tlpad(to_Char(Count), 8, '0') AS o_Count,\n\t' ' AS Reserved_For_Future_Use\n\tFROM SQ_work_claim_ncci_report_extract1\n),\nFF_NCCI_Control_Submission_Record AS (\n\tINSERT INTO FF_NCCI_Control_Submission_Record\n\t(Record_type_code, Carrier_Group_Code, Filler, o_Count, Reserved_For_Future_Use)\n\tSELECT \n\tRECORD_TYPE_CODE, \n\tCARRIER_GROUP_CODE, \n\tFILLER, \n\tO_COUNT, \n\tRESERVED_FOR_FUTURE_USE\n\tFROM Exp_Control_Submission_Record\n),\nSQ_work_claim_ncci_report_extract AS (\n\tSELECT ncci_extract_tab.rcrd_type_code,\r\n\t       ncci_extract_tab.carrier_code,\r\n\t       ncci_extract_tab.future_use_1,\r\n\t       ncci_extract_tab.pol_num_id,\r\n\t       ncci_extract_tab.pol_eff_date,\r\n\t       ncci_extract_tab.valuation_lvl_code,\r\n\t       ncci_extract_tab.repl_rpt_code,\r\n\t       ncci_extract_tab.claim_num_id,\r\n\t       ncci_extract_tab.future_use_2,\r\n\t       ncci_extract_tab.jurisdiction_state,\r\n\t       ncci_extract_tab.acc_state,\r\n\t       ncci_extract_tab.acc_date,\r\n\t       ncci_extract_tab.reported_to_insr_date,\r\n\t       ncci_extract_tab.class_code,\r\n\t       ncci_extract_tab.type_of_loss,\r\n\t       ncci_extract_tab.type_of_recovery,\r\n\t       ncci_extract_tab.type_of_claim,\r\n\t       ncci_extract_tab.claimant_gndr_code,\r\n\t       ncci_extract_tab.birth_yr,\r\n\t       ncci_extract_tab.hire_yr,\r\n\t       ncci_extract_tab.future_use_3,\r\n\t       ncci_extract_tab.preinjury_avg_weeky_wage_amt,\r\n\t       ncci_extract_tab.method_of_determining_preinjury_avg_wkly_wage_code,\r\n\t       ncci_extract_tab.part_of_body_code,\r\n\t       ncci_extract_tab.nature_of_inj,\r\n\t       ncci_extract_tab.cause_of_inj,\r\n\t       ncci_extract_tab.claim_status_code,\r\n\t       ncci_extract_tab.closing_date,\r\n\t       ncci_extract_tab.incurred_indemnity_amt_total,\r\n\t       ncci_extract_tab.bnft_type_code_1,\r\n\t       ncci_extract_tab.bnft_amt_paid_1,\r\n\t       ncci_extract_tab.wkly_bnft_1,\r\n\t       ncci_extract_tab.bnft_type_code_2,\r\n\t       ncci_extract_tab.bnft_amt_paid_2,\r\n\t       ncci_extract_tab.wkly_bnft_2,\r\n\t       ncci_extract_tab.bnft_type_code_3,\r\n\t       ncci_extract_tab.bnft_amt_paid_3,\r\n\t       ncci_extract_tab.wkly_bnft_3,\r\n\t       ncci_extract_tab.bnft_type_code_4,\r\n\t       ncci_extract_tab.bnft_amt_paid_4,\r\n\t       ncci_extract_tab.wkly_bnft_4,\r\n\t       ncci_extract_tab.bnft_type_code_5,\r\n\t       ncci_extract_tab.bnft_amt_paid_5,\r\n\t       ncci_extract_tab.wkly_bnft_5,\r\n\t       ncci_extract_tab.future_use_4,\r\n\t       ncci_extract_tab.vocational_rehabilitation_evaluation_exp_amt_paid,\r\n\t       ncci_extract_tab.vocational_rehabilitation_maint_bnft_amt_paid,\r\n\t       ncci_extract_tab.vocational_rehabilitation_education_exp_amt_paid,\r\n\t       ncci_extract_tab.vocational_rehabilitation_other_amt_paid,\r\n\t       ncci_extract_tab.incurred_med_amt_total,\r\n\t       ncci_extract_tab.total_paid_med_amt,\r\n\t       ncci_extract_tab.post_inj_wkly_wage_amt,\r\n\t       ncci_extract_tab.impairment_disability_percentage,\r\n\t       ncci_extract_tab.impairment_percentage_basis_code,\r\n\t       ncci_extract_tab.max_med_improvement_date,\r\n\t       ncci_extract_tab.attorney_or_au_rep_ind,\r\n\t       ncci_extract_tab.controverted_disputed_case_ind,\r\n\t       ncci_extract_tab.claimant_lgl_amt_paid,\r\n\t       ncci_extract_tab.emplyr_lgl_amt_paid,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_1,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_1,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_2,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_2,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_3,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_3,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_4,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_4,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_5,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_5,\r\n\t       ncci_extract_tab.bnft_cvrd_by_lump_sum_settlement_code_6,\r\n\t       ncci_extract_tab.lump_sum_settlement_amt_paid_6,\r\n\t       ncci_extract_tab.med_extinguishment_ind,\r\n\t       ncci_extract_tab.return_to_work_date,\r\n\t       ncci_extract_tab.return_to_work_rate_of_pay_ind,\r\n\t       ncci_extract_tab.extraordinary_loss_event_claim_ind,\r\n\t       ncci_extract_tab.future_use_5,\r\n\t       ncci_extract_tab.prv_carrier_code,\r\n\t       ncci_extract_tab.future_use_6,\r\n\t       ncci_extract_tab.prv_pol_num_id,\r\n\t       ncci_extract_tab.prv_pol_eff_date,\r\n\t       ncci_extract_tab.prv_reported_to_insr_date,\r\n\t       ncci_extract_tab.prv_claim_num_id,\r\n\t       ncci_extract_tab.recovery_reimb_amt,\r\n\t       ncci_extract_tab.future_use_7,\r\n\t       ncci_extract_tab.future_use_8\r\n\tFROM   work_claim_ncci_report_extract ncci_extract_tab WITH (NOLOCK)\r\n\tWHERE  ncci_extract_tab.transm_status in ('Y','O')\n),\nEXP_Source AS (\n\tSELECT\n\trcrd_type_code,\n\tcarrier_code,\n\tfuture_use_1,\n\tpol_num_id,\n\tpol_eff_date,\n\tvaluation_lvl_code,\n\trepl_rpt_code,\n\tclaim_num_id,\n\tfuture_use_2,\n\tjurisdiction_state,\n\tacc_state,\n\tacc_date,\n\treported_to_insr_date,\n\tclass_code,\n\ttype_of_loss,\n\ttype_of_recovery,\n\ttype_of_claim,\n\tclaimant_gndr_code,\n\tbirth_yr,\n\thire_yr,\n\tfuture_use_3,\n\tpreinjury_avg_weeky_wage_amt,\n\tmethod_of_determining_preinjury_avg_wkly_wage_code,\n\tpart_of_body_code,\n\tnature_of_inj,\n\tcause_of_inj,\n\tclaim_status_code,\n\tclosing_date,\n\tincurred_indemnity_amt_total,\n\tbnft_type_code_1,\n\tbnft_amt_paid_1,\n\twkly_bnft_1,\n\tbnft_type_code_2,\n\tbnft_amt_paid_2,\n\twkly_bnft_2,\n\tbnft_type_code_3,\n\tbnft_amt_paid_3,\n\twkly_bnft_3,\n\tbnft_type_code_4,\n\tbnft_amt_paid_4,\n\twkly_bnft_4,\n\tbnft_type_code_5,\n\tbnft_amt_paid_5,\n\twkly_bnft_5,\n\tfuture_use_4,\n\tvocational_rehabilitation_evaluation_exp_amt_paid,\n\tvocational_rehabilitation_maint_bnft_amt_paid,\n\tvocational_rehabilitation_education_exp_amt_paid,\n\tvocational_rehabilitation_other_amt_paid,\n\tincurred_med_amt_total,\n\ttotal_paid_med_amt,\n\tpost_inj_wkly_wage_amt,\n\timpairment_disability_percentage,\n\timpairment_percentage_basis_code,\n\tmax_med_improvement_date,\n\tattorney_or_au_rep_ind,\n\tcontroverted_disputed_case_ind,\n\tclaimant_lgl_amt_paid,\n\templyr_lgl_amt_paid,\n\tbnft_cvrd_by_lump_sum_settlement_code_1,\n\tlump_sum_settlement_amt_paid_1,\n\tbnft_cvrd_by_lump_sum_settlement_code_2,\n\tlump_sum_settlement_amt_paid_2,\n\tbnft_cvrd_by_lump_sum_settlement_code_3,\n\tlump_sum_settlement_amt_paid_3,\n\tbnft_cvrd_by_lump_sum_settlement_code_4,\n\tlump_sum_settlement_amt_paid_4,\n\tbnft_cvrd_by_lump_sum_settlement_code_5,\n\tlump_sum_settlement_amt_paid_5,\n\tbnft_cvrd_by_lump_sum_settlement_code_6,\n\tlump_sum_settlement_amt_paid_6,\n\tmed_extinguishment_ind,\n\treturn_to_work_date,\n\treturn_to_work_rate_of_pay_ind,\n\textraordinary_loss_event_claim_ind,\n\tfuture_use_5,\n\tprv_carrier_code,\n\tfuture_use_6,\n\tprv_pol_num_id,\n\tprv_pol_eff_date,\n\tprv_reported_to_insr_date,\n\tprv_claim_num_id,\n\trecovery_reimb_amt,\n\tfuture_use_7,\n\tfuture_use_8,\n\t' ' AS Default\n\tFROM SQ_work_claim_ncci_report_extract\n),\nFF_NCCI_WC_CLAIMS AS (\n\tINSERT INTO FF_NCCI_WC_CLAIMS\n\t(rcrd_type_code, carrier_code, future_use_1, pol_num_id, pol_eff_date, valuation_lvl_code, repl_rpt_code, claim_num_id, future_use_2, jurisdiction_state, acc_state, acc_date, reported_to_insr_date, class_code, type_of_loss, type_of_recovery, type_of_claim, claimant_gndr_code, birth_yr, hire_yr, future_use_3, preinjury_avg_weeky_wage_amt, method_of_determining_preinjury_avg_wkly_wage_code, part_of_body_code, nature_of_inj, cause_of_inj, claim_status_code, closing_date, incurred_indemnity_amt_total, bnft_type_code_1, bnft_amt_paid_1, wkly_bnft_1, bnft_type_code_2, bnft_amt_paid_2, wkly_bnft_2, bnft_type_code_3, bnft_amt_paid_3, wkly_bnft_3, bnft_type_code_4, bnft_amt_paid_4, wkly_bnft_4, bnft_type_code_5, bnft_amt_paid_5, wkly_bnft_5, future_use_4, vocational_rehabilitation_evaluation_exp_amt_paid, vocational_rehabilitation_maint_bnft_amt_paid, vocational_rehabilitation_education_exp_amt_paid, vocational_rehabilitation_other_amt_paid, incurred_med_amt_total, total_paid_med_amt, post_inj_wkly_wage_amt, impairment_disability_percentage, impairment_percentage_basis_code, max_med_improvement_date, attorney_or_au_rep_ind, controverted_disputed_case_ind, claimant_lgl_amt_paid, emplyr_lgl_amt_paid, bnft_cvrd_by_lump_sum_settlement_code_1, lump_sum_settlement_amt_paid_1, bnft_cvrd_by_lump_sum_settlement_code_2, lump_sum_settlement_amt_paid_2, bnft_cvrd_by_lump_sum_settlement_code_3, lump_sum_settlement_amt_paid_3, bnft_cvrd_by_lump_sum_settlement_code_4, lump_sum_settlement_amt_paid_4, bnft_cvrd_by_lump_sum_settlement_code_5, lump_sum_settlement_amt_paid_5, bnft_cvrd_by_lump_sum_settlement_code_6, lump_sum_settlement_amt_paid_6, med_extinguishment_ind, return_to_work_date, return_to_work_rate_of_pay_ind, extraordinary_loss_event_claim_ind, future_use_5, prv_carrier_code, future_use_6, prv_pol_num_id, prv_pol_eff_date, prv_reported_to_insr_date, prv_claim_num_id, recovery_reimb_amt, future_use_7, Used_For_Texas_Only, future_use_8)\n\tSELECT \n\tRCRD_TYPE_CODE, \n\tCARRIER_CODE, \n\tFUTURE_USE_1, \n\tPOL_NUM_ID, \n\tPOL_EFF_DATE, \n\tVALUATION_LVL_CODE, \n\tREPL_RPT_CODE, \n\tCLAIM_NUM_ID, \n\tFUTURE_USE_2, \n\tJURISDICTION_STATE, \n\tACC_STATE, \n\tACC_DATE, \n\tREPORTED_TO_INSR_DATE, \n\tCLASS_CODE, \n\tTYPE_OF_LOSS, \n\tTYPE_OF_RECOVERY, \n\tTYPE_OF_CLAIM, \n\tCLAIMANT_GNDR_CODE, \n\tBIRTH_YR, \n\tHIRE_YR, \n\tFUTURE_USE_3, \n\tPREINJURY_AVG_WEEKY_WAGE_AMT, \n\tMETHOD_OF_DETERMINING_PREINJURY_AVG_WKLY_WAGE_CODE, \n\tPART_OF_BODY_CODE, \n\tNATURE_OF_INJ, \n\tCAUSE_OF_INJ, \n\tCLAIM_STATUS_CODE, \n\tCLOSING_DATE, \n\tINCURRED_INDEMNITY_AMT_TOTAL, \n\tBNFT_TYPE_CODE_1, \n\tBNFT_AMT_PAID_1, \n\tWKLY_BNFT_1, \n\tBNFT_TYPE_CODE_2, \n\tBNFT_AMT_PAID_2, \n\tWKLY_BNFT_2, \n\tBNFT_TYPE_CODE_3, \n\tBNFT_AMT_PAID_3, \n\tWKLY_BNFT_3, \n\tBNFT_TYPE_CODE_4, \n\tBNFT_AMT_PAID_4, \n\tWKLY_BNFT_4, \n\tBNFT_TYPE_CODE_5, \n\tBNFT_AMT_PAID_5, \n\tWKLY_BNFT_5, \n\tFUTURE_USE_4, \n\tVOCATIONAL_REHABILITATION_EVALUATION_EXP_AMT_PAID, \n\tVOCATIONAL_REHABILITATION_MAINT_BNFT_AMT_PAID, \n\tVOCATIONAL_REHABILITATION_EDUCATION_EXP_AMT_PAID, \n\tVOCATIONAL_REHABILITATION_OTHER_AMT_PAID, \n\tINCURRED_MED_AMT_TOTAL, \n\tTOTAL_PAID_MED_AMT, \n\tPOST_INJ_WKLY_WAGE_AMT, \n\tIMPAIRMENT_DISABILITY_PERCENTAGE, \n\tIMPAIRMENT_PERCENTAGE_BASIS_CODE, \n\tMAX_MED_IMPROVEMENT_DATE, \n\tATTORNEY_OR_AU_REP_IND, \n\tCONTROVERTED_DISPUTED_CASE_IND, \n\tCLAIMANT_LGL_AMT_PAID, \n\tEMPLYR_LGL_AMT_PAID, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_1, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_1, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_2, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_2, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_3, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_3, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_4, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_4, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_5, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_5, \n\tBNFT_CVRD_BY_LUMP_SUM_SETTLEMENT_CODE_6, \n\tLUMP_SUM_SETTLEMENT_AMT_PAID_6, \n\tMED_EXTINGUISHMENT_IND, \n\tRETURN_TO_WORK_DATE, \n\tRETURN_TO_WORK_RATE_OF_PAY_IND, \n\tEXTRAORDINARY_LOSS_EVENT_CLAIM_IND, \n\tFUTURE_USE_5, \n\tPRV_CARRIER_CODE, \n\tFUTURE_USE_6, \n\tPRV_POL_NUM_ID, \n\tPRV_POL_EFF_DATE, \n\tPRV_REPORTED_TO_INSR_DATE, \n\tPRV_CLAIM_NUM_ID, \n\tRECOVERY_REIMB_AMT, \n\tFUTURE_USE_7, \n\tfuture_use_8 AS USED_FOR_TEXAS_ONLY, \n\tDefault AS FUTURE_USE_8\n\tFROM EXP_Source\n),\nSQ_Update_Transm_Status AS (\n\tSELECT ncci_extract_tab.work_claim_ncci_rpt_extract_id \r\n\tFROM\r\n\t work_claim_ncci_report_extract ncci_extract_tab WITH (NOLOCK)\r\n\tWHERE  ncci_extract_tab.transm_status in ('Y','O')\n),\nEXP_Change_Transm_Status AS (\n\tSELECT\n\twork_claim_ncci_rpt_extract_id,\n\t'N' AS transm_status\n\tFROM SQ_Update_Transm_Status\n),\nUPD_Change_Transm_Status AS (\n\tSELECT\n\twork_claim_ncci_rpt_extract_id, \n\ttransm_status\n\tFROM EXP_Change_Transm_Status\n),\nShortcut_to_work_claim_ncci_report_extract AS (\n\tMERGE INTO work_claim_ncci_report_extract AS T\n\tUSING UPD_Change_Transm_Status AS S\n\tON T.work_claim_ncci_rpt_extract_id = S.work_claim_ncci_rpt_extract_id\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.transm_status = S.transm_status\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {},
        "folder": {
            "name": "DataFeed -Informatica/ClaimDataServices/"
        },
        "annotations": []
    }
}