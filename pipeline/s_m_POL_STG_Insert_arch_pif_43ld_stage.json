{
    "name": "s_m_POL_STG_Insert_arch_pif_43ld_stage",
    "properties": {
        "activities": [
            {
                "name": "m_POL_STG_Insert_arch_pif_43ld_stage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_pif_43ld_stage AS (\n\tSELECT\n\t\tpif_43ld_stage_id,\n\t\tpif_symbol,\n\t\tpif_policy_number,\n\t\tpif_module,\n\t\tpmd4d_segment_id,\n\t\tpmd4d_segment_status,\n\t\tpmd4d_year_transaction,\n\t\tpmd4d_month_transaction,\n\t\tpmd4d_day_transaction,\n\t\tpmd4d_segment_level_code,\n\t\tpmd4d_segment_part_code,\n\t\tpmd4d_sub_part_code,\n\t\tpmd4d_insurance_line,\n\t\tpmd4d_location_number,\n\t\tpmd4d_risk_unit_group,\n\t\tpmd4d_seq_rsk_unt_grp,\n\t\tpmd4d_risk_unit,\n\t\tpmd4d_risk_sequence,\n\t\tpmd4d_risk_type_ind,\n\t\tpmd4d_year_item_effective,\n\t\tpmd4d_month_item_effective,\n\t\tpmd4d_day_item_effective,\n\t\tpmd4d_seq_audit_schedule,\n\t\tpmd4d_year_process,\n\t\tpmd4d_month_process,\n\t\tpmd4d_day_process,\n\t\tpmd4d_frequency,\n\t\tpmd4d_type,\n\t\tpmd4d_cancellation_date,\n\t\tpmd4d_number_of_reqsts,\n\t\tpmd4d_audit_dates_ind,\n\t\tpmd4d_pms_future_use,\n\t\tpmd4d_cancellation_type,\n\t\tpmd4d_previous_audit_type,\n\t\tpmd4d_type_manual_ind,\n\t\tpmd4d_auditor_manual_ind,\n\t\tpmd4d_audit_type_manual_ind,\n\t\tpmd4d_customer_future_use,\n\t\tpmd4d_auditor_name,\n\t\tpmd4d_op_id,\n\t\tpmd4d_previous_status,\n\t\tpmd4d_yr2000_cust_use,\n\t\tpmd4d_audit_number_1,\n\t\tpmd4d_status_1,\n\t\tpmd4d_transaction_type_1,\n\t\tpmd4d_audit_type_1,\n\t\tpmd4d_effective_date_1,\n\t\tpmd4d_expiration_date_1,\n\t\tpmd4d_audit_req_date_1,\n\t\tpmd4d_entered_date_1,\n\t\tpmd4d_auditor_code_1,\n\t\tpmd4d_audit_cost_1,\n\t\tpmd4d_audit_time_1,\n\t\tpmd4d_audit_premium_1,\n\t\tpmd4d_audit_number_2,\n\t\tpmd4d_status_2,\n\t\tpmd4d_transaction_type_2,\n\t\tpmd4d_audit_type_2,\n\t\tpmd4d_effective_date_2,\n\t\tpmd4d_expiration_date_2,\n\t\tpmd4d_audit_req_date_2,\n\t\tpmd4d_entered_date_2,\n\t\tpmd4d_auditor_code_2,\n\t\tpmd4d_audit_cost_2,\n\t\tpmd4d_audit_time_2,\n\t\tpmd4d_audit_premium_2,\n\t\tpmd4d_audit_number_3,\n\t\tpmd4d_status_3,\n\t\tpmd4d_transaction_type_3,\n\t\tpmd4d_audit_type_3,\n\t\tpmd4d_effective_date_3,\n\t\tpmd4d_expiration_date_3,\n\t\tpmd4d_audit_req_date_3,\n\t\tpmd4d_entered_date_3,\n\t\tpmd4d_auditor_code_3,\n\t\tpmd4d_audit_cost_3,\n\t\tpmd4d_audit_time_3,\n\t\tpmd4d_audit_premium_3,\n\t\tpmd4d_audit_number_4,\n\t\tpmd4d_status_4,\n\t\tpmd4d_transaction_type_4,\n\t\tpmd4d_audit_type_4,\n\t\tpmd4d_effective_date_4,\n\t\tpmd4d_expiration_date_4,\n\t\tpmd4d_audit_req_date_4,\n\t\tpmd4d_entered_date_4,\n\t\tpmd4d_auditor_code_4,\n\t\tpmd4d_audit_cost_4,\n\t\tpmd4d_audit_time_4,\n\t\tpmd4d_audit_premium_4,\n\t\textract_date,\n\t\tas_of_date,\n\t\trecord_count,\n\t\tsource_system_id\n\tFROM pif_43ld_stage\n),\nexp_arch_pif_43ld_stage AS (\n\tSELECT\n\tpif_43ld_stage_id,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tpmd4d_segment_id,\n\tpmd4d_segment_status,\n\tpmd4d_year_transaction,\n\tpmd4d_month_transaction,\n\tpmd4d_day_transaction,\n\tpmd4d_segment_level_code,\n\tpmd4d_segment_part_code,\n\tpmd4d_sub_part_code,\n\tpmd4d_insurance_line,\n\tpmd4d_location_number,\n\tpmd4d_risk_unit_group,\n\tpmd4d_seq_rsk_unt_grp,\n\tpmd4d_risk_unit,\n\tpmd4d_risk_sequence,\n\tpmd4d_risk_type_ind,\n\tpmd4d_year_item_effective,\n\tpmd4d_month_item_effective,\n\tpmd4d_day_item_effective,\n\tpmd4d_seq_audit_schedule,\n\tpmd4d_year_process,\n\tpmd4d_month_process,\n\tpmd4d_day_process,\n\tpmd4d_frequency,\n\tpmd4d_type,\n\tpmd4d_cancellation_date,\n\tpmd4d_number_of_reqsts,\n\tpmd4d_audit_dates_ind,\n\tpmd4d_pms_future_use,\n\tpmd4d_cancellation_type,\n\tpmd4d_previous_audit_type,\n\tpmd4d_type_manual_ind,\n\tpmd4d_auditor_manual_ind,\n\tpmd4d_audit_type_manual_ind,\n\tpmd4d_customer_future_use,\n\tpmd4d_auditor_name,\n\tpmd4d_op_id,\n\tpmd4d_previous_status,\n\tpmd4d_yr2000_cust_use,\n\tpmd4d_audit_number_1,\n\tpmd4d_status_1,\n\tpmd4d_transaction_type_1,\n\tpmd4d_audit_type_1,\n\tpmd4d_effective_date_1,\n\tpmd4d_expiration_date_1,\n\tpmd4d_audit_req_date_1,\n\tpmd4d_entered_date_1,\n\tpmd4d_auditor_code_1,\n\tpmd4d_audit_cost_1,\n\tpmd4d_audit_time_1,\n\tpmd4d_audit_premium_1,\n\tpmd4d_audit_number_2,\n\tpmd4d_status_2,\n\tpmd4d_transaction_type_2,\n\tpmd4d_audit_type_2,\n\tpmd4d_effective_date_2,\n\tpmd4d_expiration_date_2,\n\tpmd4d_audit_req_date_2,\n\tpmd4d_entered_date_2,\n\tpmd4d_auditor_code_2,\n\tpmd4d_audit_cost_2,\n\tpmd4d_audit_time_2,\n\tpmd4d_audit_premium_2,\n\tpmd4d_audit_number_3,\n\tpmd4d_status_3,\n\tpmd4d_transaction_type_3,\n\tpmd4d_audit_type_3,\n\tpmd4d_effective_date_3,\n\tpmd4d_expiration_date_3,\n\tpmd4d_audit_req_date_3,\n\tpmd4d_entered_date_3,\n\tpmd4d_auditor_code_3,\n\tpmd4d_audit_cost_3,\n\tpmd4d_audit_time_3,\n\tpmd4d_audit_premium_3,\n\tpmd4d_audit_number_4,\n\tpmd4d_status_4,\n\tpmd4d_transaction_type_4,\n\tpmd4d_audit_type_4,\n\tpmd4d_effective_date_4,\n\tpmd4d_expiration_date_4,\n\tpmd4d_audit_req_date_4,\n\tpmd4d_entered_date_4,\n\tpmd4d_auditor_code_4,\n\tpmd4d_audit_cost_4,\n\tpmd4d_audit_time_4,\n\tpmd4d_audit_premium_4,\n\textract_date,\n\tas_of_date,\n\trecord_count,\n\tsource_system_id,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID\n\tFROM SQ_pif_43ld_stage\n),\narch_pif_43ld_stage AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.arch_pif_43ld_stage\n\t(pif_43ld_stage_id, pif_symbol, pif_policy_number, pif_module, pmd4d_segment_id, pmd4d_segment_status, pmd4d_year_transaction, pmd4d_month_transaction, pmd4d_day_transaction, pmd4d_segment_level_code, pmd4d_segment_part_code, pmd4d_sub_part_code, pmd4d_insurance_line, pmd4d_location_number, pmd4d_risk_unit_group, pmd4d_seq_rsk_unt_grp, pmd4d_risk_unit, pmd4d_risk_sequence, pmd4d_risk_type_ind, pmd4d_year_item_effective, pmd4d_month_item_effective, pmd4d_day_item_effective, pmd4d_seq_audit_schedule, pmd4d_year_process, pmd4d_month_process, pmd4d_day_process, pmd4d_frequency, pmd4d_type, pmd4d_cancellation_date, pmd4d_number_of_reqsts, pmd4d_audit_dates_ind, pmd4d_pms_future_use, pmd4d_cancellation_type, pmd4d_previous_audit_type, pmd4d_type_manual_ind, pmd4d_auditor_manual_ind, pmd4d_audit_type_manual_ind, pmd4d_customer_future_use, pmd4d_auditor_name, pmd4d_op_id, pmd4d_previous_status, pmd4d_yr2000_cust_use, pmd4d_audit_number_1, pmd4d_status_1, pmd4d_transaction_type_1, pmd4d_audit_type_1, pmd4d_effective_date_1, pmd4d_expiration_date_1, pmd4d_audit_req_date_1, pmd4d_entered_date_1, pmd4d_auditor_code_1, pmd4d_audit_cost_1, pmd4d_audit_time_1, pmd4d_audit_premium_1, pmd4d_audit_number_2, pmd4d_status_2, pmd4d_transaction_type_2, pmd4d_audit_type_2, pmd4d_effective_date_2, pmd4d_expiration_date_2, pmd4d_audit_req_date_2, pmd4d_entered_date_2, pmd4d_auditor_code_2, pmd4d_audit_cost_2, pmd4d_audit_time_2, pmd4d_audit_premium_2, pmd4d_audit_number_3, pmd4d_status_3, pmd4d_transaction_type_3, pmd4d_audit_type_3, pmd4d_effective_date_3, pmd4d_expiration_date_3, pmd4d_audit_req_date_3, pmd4d_entered_date_3, pmd4d_auditor_code_3, pmd4d_audit_cost_3, pmd4d_audit_time_3, pmd4d_audit_premium_3, pmd4d_audit_number_4, pmd4d_status_4, pmd4d_transaction_type_4, pmd4d_audit_type_4, pmd4d_effective_date_4, pmd4d_expiration_date_4, pmd4d_audit_req_date_4, pmd4d_entered_date_4, pmd4d_auditor_code_4, pmd4d_audit_cost_4, pmd4d_audit_time_4, pmd4d_audit_premium_4, extract_date, as_of_date, record_count, source_system_id, audit_id)\n\tSELECT \n\tPIF_43LD_STAGE_ID, \n\tPIF_SYMBOL, \n\tPIF_POLICY_NUMBER, \n\tPIF_MODULE, \n\tPMD4D_SEGMENT_ID, \n\tPMD4D_SEGMENT_STATUS, \n\tPMD4D_YEAR_TRANSACTION, \n\tPMD4D_MONTH_TRANSACTION, \n\tPMD4D_DAY_TRANSACTION, \n\tPMD4D_SEGMENT_LEVEL_CODE, \n\tPMD4D_SEGMENT_PART_CODE, \n\tPMD4D_SUB_PART_CODE, \n\tPMD4D_INSURANCE_LINE, \n\tPMD4D_LOCATION_NUMBER, \n\tPMD4D_RISK_UNIT_GROUP, \n\tPMD4D_SEQ_RSK_UNT_GRP, \n\tPMD4D_RISK_UNIT, \n\tPMD4D_RISK_SEQUENCE, \n\tPMD4D_RISK_TYPE_IND, \n\tPMD4D_YEAR_ITEM_EFFECTIVE, \n\tPMD4D_MONTH_ITEM_EFFECTIVE, \n\tPMD4D_DAY_ITEM_EFFECTIVE, \n\tPMD4D_SEQ_AUDIT_SCHEDULE, \n\tPMD4D_YEAR_PROCESS, \n\tPMD4D_MONTH_PROCESS, \n\tPMD4D_DAY_PROCESS, \n\tPMD4D_FREQUENCY, \n\tPMD4D_TYPE, \n\tPMD4D_CANCELLATION_DATE, \n\tPMD4D_NUMBER_OF_REQSTS, \n\tPMD4D_AUDIT_DATES_IND, \n\tPMD4D_PMS_FUTURE_USE, \n\tPMD4D_CANCELLATION_TYPE, \n\tPMD4D_PREVIOUS_AUDIT_TYPE, \n\tPMD4D_TYPE_MANUAL_IND, \n\tPMD4D_AUDITOR_MANUAL_IND, \n\tPMD4D_AUDIT_TYPE_MANUAL_IND, \n\tPMD4D_CUSTOMER_FUTURE_USE, \n\tPMD4D_AUDITOR_NAME, \n\tPMD4D_OP_ID, \n\tPMD4D_PREVIOUS_STATUS, \n\tPMD4D_YR2000_CUST_USE, \n\tPMD4D_AUDIT_NUMBER_1, \n\tPMD4D_STATUS_1, \n\tPMD4D_TRANSACTION_TYPE_1, \n\tPMD4D_AUDIT_TYPE_1, \n\tPMD4D_EFFECTIVE_DATE_1, \n\tPMD4D_EXPIRATION_DATE_1, \n\tPMD4D_AUDIT_REQ_DATE_1, \n\tPMD4D_ENTERED_DATE_1, \n\tPMD4D_AUDITOR_CODE_1, \n\tPMD4D_AUDIT_COST_1, \n\tPMD4D_AUDIT_TIME_1, \n\tPMD4D_AUDIT_PREMIUM_1, \n\tPMD4D_AUDIT_NUMBER_2, \n\tPMD4D_STATUS_2, \n\tPMD4D_TRANSACTION_TYPE_2, \n\tPMD4D_AUDIT_TYPE_2, \n\tPMD4D_EFFECTIVE_DATE_2, \n\tPMD4D_EXPIRATION_DATE_2, \n\tPMD4D_AUDIT_REQ_DATE_2, \n\tPMD4D_ENTERED_DATE_2, \n\tPMD4D_AUDITOR_CODE_2, \n\tPMD4D_AUDIT_COST_2, \n\tPMD4D_AUDIT_TIME_2, \n\tPMD4D_AUDIT_PREMIUM_2, \n\tPMD4D_AUDIT_NUMBER_3, \n\tPMD4D_STATUS_3, \n\tPMD4D_TRANSACTION_TYPE_3, \n\tPMD4D_AUDIT_TYPE_3, \n\tPMD4D_EFFECTIVE_DATE_3, \n\tPMD4D_EXPIRATION_DATE_3, \n\tPMD4D_AUDIT_REQ_DATE_3, \n\tPMD4D_ENTERED_DATE_3, \n\tPMD4D_AUDITOR_CODE_3, \n\tPMD4D_AUDIT_COST_3, \n\tPMD4D_AUDIT_TIME_3, \n\tPMD4D_AUDIT_PREMIUM_3, \n\tPMD4D_AUDIT_NUMBER_4, \n\tPMD4D_STATUS_4, \n\tPMD4D_TRANSACTION_TYPE_4, \n\tPMD4D_AUDIT_TYPE_4, \n\tPMD4D_EFFECTIVE_DATE_4, \n\tPMD4D_EXPIRATION_DATE_4, \n\tPMD4D_AUDIT_REQ_DATE_4, \n\tPMD4D_ENTERED_DATE_4, \n\tPMD4D_AUDITOR_CODE_4, \n\tPMD4D_AUDIT_COST_4, \n\tPMD4D_AUDIT_TIME_4, \n\tPMD4D_AUDIT_PREMIUM_4, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_SYSTEM_ID, \n\tAUDIT_ID AS AUDIT_ID\n\tFROM exp_arch_pif_43ld_stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyStaging/"
        },
        "annotations": []
    }
}