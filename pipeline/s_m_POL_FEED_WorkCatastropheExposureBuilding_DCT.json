{
    "name": "s_m_POL_FEED_WorkCatastropheExposureBuilding_DCT",
    "properties": {
        "activities": [
            {
                "name": "m_POL_FEED_WorkCatastropheExposureBuilding_DCT",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_WorkCatastropheExposureDeductible AS (\n\tSELECT D.PolicyKey as PolicyKey, D.LocationNumber as LocationNumber, D.BuildingNumber as BuildingNumber, D.BusinessType as BusinessType, \r\n\t RelevantDeductibles.TargetColumn AS TargetColumn,\r\n\t (CASE WHEN RelevantDeductibles.CalculationRule = 'MAX' THEN MAX(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t  WHEN RelevantDeductibles.CalculationRule = 'MIN' THEN MIN(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t  WHEN RelevantDeductibles.CalculationRule = 'SUM' THEN SUM(CONVERT(BIGINT, D.DeductibleValue)) \r\n\t  ELSE 0 \r\n\t END) AS DeductibleValue\r\n\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureDeductible D\r\n\tINNER JOIN (SELECT DISTINCT BusinessType, DeductibleType, CalculationRule, TargetColumn \r\n\t  FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SupCatastropheExposureDeductibleRule \r\n\t  WHERE SourceSystemId = 'DCT') RelevantDeductibles ON D.BusinessType = RelevantDeductibles.BusinessType AND D.DeductibleType = RelevantDeductibles.DeductibleType\r\n\tWHERE D.BusinessType IN ('Commercial Property', 'SBOP', 'SMARTbusiness') \r\n\tGROUP BY D.PolicyKey, D.LocationNumber, D.BuildingNumber, D.BusinessType, RelevantDeductibles.TargetColumn, RelevantDeductibles.CalculationRule\r\n\tORDER BY D.PolicyKey, D.LocationNumber, D.BuildingNumber, D.BusinessType, RelevantDeductibles.TargetColumn, RelevantDeductibles.CalculationRule\n),\nEXP_ConcatDeductible AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\tTargetColumn,\n\tDeductibleValue,\n\t-- *INF*: IIF(TargetColumn='Pol Blkt Ded', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Pol Blkt Ded', CAST(DeductibleValue AS BIGINT), 0) AS o_PolicyBlanketDeductible,\n\t-- *INF*: IIF(TargetColumn='Loc Bldg Deductible', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Loc Bldg Deductible', CAST(DeductibleValue AS BIGINT), 0) AS o_LocationBuildingDeductible,\n\t-- *INF*: IIF(TargetColumn='Loc Conts Deductible', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Loc Conts Deductible', CAST(DeductibleValue AS BIGINT), 0) AS o_LocationContentsDeductible,\n\t-- *INF*: IIF(TargetColumn='Loc BI Deductible', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Loc BI Deductible', CAST(DeductibleValue AS BIGINT), 0) AS o_LocationBIDeductible,\n\t-- *INF*: IIF(TargetColumn='BPP Earthquake Deductible Percentage', TO_BIGINT(DeductibleValue), 0)\n\tIFF(\n\t    TargetColumn = 'BPP Earthquake Deductible Percentage', CAST(DeductibleValue AS BIGINT), 0\n\t) AS o_BPPEarthquakeDeductiblePercentage,\n\t-- *INF*: IIF(TargetColumn='Building Earthquake Deductible Percentage', TO_BIGINT(DeductibleValue), 0)\n\tIFF(\n\t    TargetColumn = 'Building Earthquake Deductible Percentage', CAST(DeductibleValue AS BIGINT),\n\t    0\n\t) AS o_BuildingEarthquakeDeductiblePercentage,\n\t-- *INF*: IIF(TargetColumn='Earthquake Deductible Percentage', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Earthquake Deductible Percentage', CAST(DeductibleValue AS BIGINT), 0) AS o_EarthquakeDeductiblePercentage,\n\t-- *INF*: IIF(TargetColumn='Loc BI Deductible-Building', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Loc BI Deductible-Building', CAST(DeductibleValue AS BIGINT), 0) AS LocBIDeductibleBuilding,\n\t-- *INF*: IIF(TargetColumn='Loc BI Deductible-Contents', TO_BIGINT(DeductibleValue), 0)\n\tIFF(TargetColumn = 'Loc BI Deductible-Contents', CAST(DeductibleValue AS BIGINT), 0) AS LocBIDeductibleContents\n\tFROM SQ_WorkCatastropheExposureDeductible\n),\nAGG_RowToColumn_Deductible AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\to_PolicyBlanketDeductible AS PolicyBlanketDeductible,\n\to_LocationBuildingDeductible AS LocationBuildingDeductible,\n\to_LocationContentsDeductible AS LocationContentsDeductible,\n\to_LocationBIDeductible AS LocationBIDeductible,\n\to_BPPEarthquakeDeductiblePercentage AS BPPEarthquakeDeductiblePercentage,\n\to_BuildingEarthquakeDeductiblePercentage AS BuildingEarthquakeDeductiblePercentage,\n\to_EarthquakeDeductiblePercentage AS EarthquakeDeductiblePercentage,\n\tLocBIDeductibleBuilding,\n\tLocBIDeductibleContents,\n\t-- *INF*: SUM(PolicyBlanketDeductible)\n\tSUM(PolicyBlanketDeductible) AS o_PolicyBlanketDeductible,\n\t-- *INF*: SUM(LocationBuildingDeductible)\n\tSUM(LocationBuildingDeductible) AS o_LocationBuildingDeductible,\n\t-- *INF*: SUM(LocationContentsDeductible)\n\tSUM(LocationContentsDeductible) AS o_LocationContentsDeductible,\n\t-- *INF*: SUM(LocationBIDeductible)\n\tSUM(LocationBIDeductible) AS o_LocationBIDeductible,\n\t-- *INF*: SUM(BPPEarthquakeDeductiblePercentage)\n\tSUM(BPPEarthquakeDeductiblePercentage) AS o_BPPEarthquakeDeductiblePercentage,\n\t-- *INF*: SUM(BuildingEarthquakeDeductiblePercentage)\n\tSUM(BuildingEarthquakeDeductiblePercentage) AS o_BuildingEarthquakeDeductiblePercentage,\n\t-- *INF*: SUM(EarthquakeDeductiblePercentage)\n\tSUM(EarthquakeDeductiblePercentage) AS o_EarthquakeDeductiblePercentage,\n\t-- *INF*: Sum(LocBIDeductibleBuilding)\n\tSum(LocBIDeductibleBuilding) AS o_LocBIDeductibleBuilding,\n\t-- *INF*: SUM(LocBIDeductibleContents)\n\tSUM(LocBIDeductibleContents) AS o_LocBIDeductibleContents\n\tFROM EXP_ConcatDeductible\n\tGROUP BY PolicyKey, LocationNumber, BuildingNumber, BusinessType\n),\nEXP_SplitDeductible AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\to_PolicyBlanketDeductible AS PolicyBlanketDeductible,\n\to_LocationBuildingDeductible AS LocationBuildingDeductible,\n\to_LocationContentsDeductible AS LocationContentsDeductible,\n\to_LocationBIDeductible AS LocationBIDeductible,\n\to_LocBIDeductibleBuilding AS LocBIDeductibleBuilding,\n\to_LocBIDeductibleContents AS LocBIDeductibleContents,\n\to_BPPEarthquakeDeductiblePercentage AS BPPEarthquakeDeductiblePercentage,\n\to_BuildingEarthquakeDeductiblePercentage AS BuildingEarthquakeDeductiblePercentage,\n\to_EarthquakeDeductiblePercentage AS EarthquakeDeductiblePercentage,\n\t-- *INF*: IIF(PolicyBlanketDeductible=0, NULL,PolicyBlanketDeductible)\r\n\t-- \r\n\t-- --DECODE(TRUE,BusinessType='SBOP', LocationContentsDeductible, IN(BusinessType, 'Commercial Property', 'SMARTbusiness'), NULL,NULL)\n\tIFF(PolicyBlanketDeductible = 0, NULL, PolicyBlanketDeductible) AS o_PolicyBlanketDeductible,\n\t-- *INF*: IIF(LocationBuildingDeductible=0 AND LocationContentsDeductible=0 AND LocationBIDeductible=0, NULL,  GREATEST(LocationBuildingDeductible,LocationContentsDeductible,LocationBIDeductible))\n\tIFF(\n\t    LocationBuildingDeductible = 0 AND LocationContentsDeductible = 0 AND LocationBIDeductible = 0,\n\t    NULL,\n\t    GREATEST(LocationBuildingDeductible, LocationContentsDeductible, LocationBIDeductible)\n\t) AS o_LocationDeductible,\n\t-- *INF*: IIF(LocationBuildingDeductible=0, NULL, LocationBuildingDeductible)\n\tIFF(LocationBuildingDeductible = 0, NULL, LocationBuildingDeductible) AS o_LocationBuildingDeductible,\n\t-- *INF*: IIF(LocationContentsDeductible=0, NULL, LocationContentsDeductible)\n\tIFF(LocationContentsDeductible = 0, NULL, LocationContentsDeductible) AS o_LocationContentsDeductible,\n\t-- *INF*: IIF(LocationBIDeductible=0, NULL, LocationBIDeductible)\n\tIFF(LocationBIDeductible = 0, NULL, LocationBIDeductible) AS o_LocationBIDeductible,\n\t-- *INF*:  IIF(LocBIDeductibleBuilding=0, NULL,LocBIDeductibleBuilding)\n\tIFF(LocBIDeductibleBuilding = 0, NULL, LocBIDeductibleBuilding) AS o_LocBIDeductibleBuilding,\n\t-- *INF*: IIF(LocBIDeductibleContents=0, NULL,LocBIDeductibleContents)\n\tIFF(LocBIDeductibleContents = 0, NULL, LocBIDeductibleContents) AS o_LocBIDeductibleContents\n\tFROM AGG_RowToColumn_Deductible\n),\nSQ_WorkCatastropheExposureTransaction AS (\n\tSELECT WCET.SourceSystemID,\r\n\tWCET.PolicyKey,\r\n\tWCET.LocationNumber,\r\n\tWCET.BuildingNumber,\r\n\tWCET.BusinessType,\r\n\tIRLE.InsuranceReferenceLegalEntityDescription,\r\n\tWCET.PremiumTransactionAmount,\r\n\tRL.StreetAddress,\r\n\tRL.RatingCity,\r\n\tSS.state_code,\r\n\tRL.ZipPostalCode,\r\n\tRL.RatingCounty,\r\n\tPT.ConstructionCode,\r\n\tAGY.AgencyCode,\r\n\tSPC.StrategicProfitCenterDescription, \r\n\tISG.InsuranceSegmentDescription,\r\n\tCC.name,\r\n\tCC.cust_num ,\r\n\tPOL.pol_eff_date,\r\n\tPOL.pol_exp_date,\r\n\tRTRIM(SUBSTRING(SBCC.StandardBusinessClassCode, 1, 5)) OccupancyCode,\r\n\tCC.sic_code,\r\n\t@{pipeline().parameters.PROCESS_DATE} ProcessDate,\r\n\tWCET.CoverageDescription,\r\n\tWCET.AddToLocationPremiumFlag\r\n\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction WCET\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction PT\r\n\tON WCET.PremiumTransactionAKId=PT.PremiumTransactionAKID\r\n\tAND PT.CurrentSnapshotFlag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RatingCoverage RC\r\n\tON PT.RatingCoverageAKID=RC.RatingCoverageAKID\r\n\tAND RC.EffectiveDate=PT.EffectiveDate \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PolicyCoverage PC\r\n\tON PC.PolicyCoverageAKID=RC.PolicyCoverageAKID\r\n\tAND PC.CurrentSnapshotFlag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.RiskLocation RL\r\n\tON PC.RiskLocationAKID=RL.RiskLocationAKID\r\n\tAND RL.CurrentSnapshotFlag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.policy POL\r\n\tON POL.pol_ak_id=RL.PolicyAKID\r\n\tAND POL.crrnt_snpsht_flag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.contract_customer CC\r\n\tON CC.contract_cust_ak_id=POL.contract_cust_ak_id\r\n\tAND CC.crrnt_snpsht_flag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER_V2}.Agency AGY\r\n\tON AGY.AgencyAKID=POL.AgencyAKId\r\n\tAND AGY.CurrentSnapshotFlag=1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_business_classification_code SBCC\r\n\tON SBCC.sup_bus_class_code_id=POL.sup_bus_class_code_id \r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.sup_state SS\r\n\tON (CASE WHEN len(SS.state_abbrev) = 1 THEN '0' + SS.state_abbrev ELSE SS.state_abbrev END) = (CASE WHEN len(RL.StateProvinceCode) = 1 THEN '0' + RL.StateProvinceCode ELSE RL.StateProvinceCode END)\r\n\tAND SS.crrnt_snpsht_flag = 1\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceSegment ISG\r\n\tON POL.InsuranceSegmentAKId=ISG.InsuranceSegmentAKId\r\n\tAND ISG.CurrentSnapshotFlag=1\r\n\tAND ISG.InsuranceSegmentAbbreviation = 'CL'\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.StrategicProfitCenter SPC\r\n\tON POL.StrategicProfitCenterAKId=SPC.StrategicProfitCenterAKId\r\n\tAND SPC.CurrentSnapshotFlag=1 \r\n\tAND SPC.StrategicProfitCenterDescription IN ('West Bend Commercial Lines', 'NSI')\r\n\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceLegalEntity IRLE\r\n\tON SPC.InsuranceReferenceLegalEntityId = IRLE.InsuranceReferenceLegalEntityId \r\n\tAND IRLE.CurrentSnapshotFlag = 1\r\n\tWHERE WCET.BusinessType IN ('Commercial Property','SBOP','SMARTbusiness')\r\n\tAND WCET.BuildingNumber <> '000' \r\n\t\r\n\t@{pipeline().parameters.WHERE_CLAUSE}\n),\nEXP_Cal AS (\n\tSELECT\n\tSourceSystemId,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\tInsuranceReferenceLegalEntityDescription,\n\tPremiumTransactionAmount,\n\tStreetAddress,\n\tRatingCity,\n\tstate_code,\n\tZipPostalCode,\n\tRatingCounty,\n\tConstructionCode,\n\t-- *INF*: LTRIM(RTRIM(ConstructionCode))\n\tLTRIM(RTRIM(ConstructionCode)) AS ConstructionCode1,\n\tAgencyCode,\n\tStrategicProfitCenterDescription,\n\tInsuranceSegmentDescription,\n\tname,\n\tcust_num,\n\tpol_eff_date,\n\tpol_exp_date,\n\tOccupancyCode,\n\tsic_code,\n\tProcessDate,\n\tCoverageDescription,\n\tAddToLocationPremiumFlag,\n\t-- *INF*: IIF(state_code='N/A', '', RTRIM(state_code))\n\tIFF(state_code = 'N/A', '', RTRIM(state_code)) AS o_RatingStateProvinceAbbreviation,\n\t-- *INF*: SUBSTR(LTRIM(ZipPostalCode), 0, 5)\n\tSUBSTR(LTRIM(ZipPostalCode), 0, 5) AS o_RatingPostalCode,\n\tAgencyCode AS o_AgencyCode,\n\tname AS o_InsuredName,\n\t-- *INF*: RTRIM(SUBSTR(cust_num, 1, 12))\n\tRTRIM(SUBSTR(cust_num, 1, 12)) AS o_CustomerNumber,\n\tpol_eff_date AS o_PolicyEffectiveDate,\n\tpol_exp_date AS o_PolicyExpirationDate,\n\t-- *INF*: RTRIM(SUBSTR(sic_code, 1, 4))\n\tRTRIM(SUBSTR(sic_code, 1, 4)) AS o_SicCode\n\tFROM SQ_WorkCatastropheExposureTransaction\n),\nAGG_BuildingPremium AS (\n\tSELECT\n\tSourceSystemId,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\tInsuranceReferenceLegalEntityDescription,\n\tPremiumTransactionAmount,\n\tStreetAddress,\n\tRatingCity,\n\to_RatingStateProvinceAbbreviation AS RatingStateProvinceAbbreviation,\n\to_RatingPostalCode AS RatingPostalCode,\n\tRatingCounty,\n\tConstructionCode1 AS ConstructionCode,\n\to_AgencyCode AS AgencyCode,\n\tStrategicProfitCenterDescription,\n\tInsuranceSegmentDescription,\n\to_InsuredName AS InsuredName,\n\to_CustomerNumber AS CustomerNumber,\n\to_PolicyEffectiveDate AS PolicyEffectiveDate,\n\to_PolicyExpirationDate AS PolicyExpirationDate,\n\tOccupancyCode,\n\to_SicCode AS SicCode,\n\tProcessDate,\n\tCoverageDescription,\n\tAddToLocationPremiumFlag,\n\t-- *INF*: MAX(ConstructionCode, ConstructionCode != 'N/A')\n\tMAX(ConstructionCode, ConstructionCode != 'N/A') AS o_ConstructionCode,\n\t-- *INF*: SUM(PremiumTransactionAmount, AddToLocationPremiumFlag='T')\n\tSUM(PremiumTransactionAmount, AddToLocationPremiumFlag = 'T') AS o_BuildingPremium\n\tFROM EXP_Cal\n\tGROUP BY PolicyKey, LocationNumber, BuildingNumber, BusinessType\n),\nSQ_WorkCatastropheExposureLimit AS (\n\tSELECT L.PolicyKey as PolicyKey , L.LocationNumber as LocationNumber , L.BuildingNumber as BuildingNumber, L.BusinessType as BusinessType, \r\n\t RelevantLimits.TargetColumn AS TargetColumn,\r\n\t (CASE WHEN RelevantLimits.CalculationRule = 'MAX' THEN MAX(CONVERT(BIGINT, L.LimitValue)) \r\n\t  WHEN RelevantLimits.CalculationRule = 'MIN' THEN MIN(CONVERT(BIGINT, L.LimitValue)) \r\n\t  WHEN RelevantLimits.CalculationRule = 'SUM' THEN SUM(CONVERT(BIGINT, L.LimitValue)) \r\n\t  ELSE 0 \r\n\t END) AS LimitValue\r\n\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureLimit L\r\n\tINNER JOIN (SELECT DISTINCT BusinessType, LimitType, CalculationRule, TargetColumn \r\n\t  FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SupCatastropheExposureLimitRule \r\n\t  WHERE SourceSystemId = 'DCT' \r\n\t  AND TargetColumn <> 'Pol Blkt Limit') RelevantLimits ON L.BusinessType = RelevantLimits.BusinessType AND L.LimitType = RelevantLimits.LimitType\r\n\tWHERE L.BusinessType IN ('Commercial Property', 'SBOP', 'SMARTbusiness') \r\n\tGROUP BY L.PolicyKey, L.LocationNumber, L.BuildingNumber, L.BusinessType, RelevantLimits.TargetColumn, RelevantLimits.CalculationRule\r\n\tORDER BY L.PolicyKey, L.LocationNumber, L.BuildingNumber, L.BusinessType, RelevantLimits.TargetColumn, RelevantLimits.CalculationRule\n),\nEXP_ConcatLimit AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\tTargetColumn,\n\tLimitValue,\n\t-- *INF*: IIF(TargetColumn='Loc Bldg Limit', TO_BIGINT(LimitValue), 0)\n\tIFF(TargetColumn = 'Loc Bldg Limit', CAST(LimitValue AS BIGINT), 0) AS o_LocationBuildingLimit,\n\t-- *INF*: IIF(TargetColumn='Loc Conts Limit', TO_BIGINT(LimitValue), 0)\n\tIFF(TargetColumn = 'Loc Conts Limit', CAST(LimitValue AS BIGINT), 0) AS o_LocationContentsLimit,\n\t-- *INF*: IIF(TargetColumn='Loc BI Limit', TO_BIGINT(LimitValue), 0)\n\tIFF(TargetColumn = 'Loc BI Limit', CAST(LimitValue AS BIGINT), 0) AS o_LocationBILimit\n\tFROM SQ_WorkCatastropheExposureLimit\n),\nAGG_RowToColumn_Limit AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\to_LocationBuildingLimit AS LocationBuildingLimit,\n\to_LocationContentsLimit AS LocationContentsLimit,\n\to_LocationBILimit AS LocationBILimit,\n\t-- *INF*: SUM(LocationBuildingLimit)\n\tSUM(LocationBuildingLimit) AS o_LocationBuildingLimit,\n\t-- *INF*: SUM(LocationContentsLimit)\n\tSUM(LocationContentsLimit) AS o_LocationContentsLimit,\n\t-- *INF*: SUM(LocationBILimit)\n\tSUM(LocationBILimit) AS o_LocationBILimit\n\tFROM EXP_ConcatLimit\n\tGROUP BY PolicyKey, LocationNumber, BuildingNumber, BusinessType\n),\nEXP_SplitLimit AS (\n\tSELECT\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType,\n\to_LocationBuildingLimit AS LocationBuildingLimit,\n\to_LocationContentsLimit AS LocationContentsLimit,\n\to_LocationBILimit AS LocationBILimit,\n\t-- *INF*: DECODE(TRUE, \r\n\t-- BusinessType= 'Commercial Property', LocationBILimit, \r\n\t-- BusinessType= 'SBOP',LocationBuildingLimit * 0.2,\r\n\t-- BusinessType='SMARTbusiness' ,LocationBuildingLimit * 0.2,\r\n\t-- 0)\r\n\t-- \r\n\t-- \r\n\t-- -----IIF(LocationBILimit=0, NULL, LocationBILimit)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Property', LocationBILimit,\n\t    BusinessType = 'SBOP', LocationBuildingLimit * 0.2,\n\t    BusinessType = 'SMARTbusiness', LocationBuildingLimit * 0.2,\n\t    0\n\t) AS v_LocationBILimit,\n\t-- *INF*: IIF(LocationBuildingLimit=0 AND LocationContentsLimit=0 AND v_LocationBILimit=0, NULL, \r\n\t-- IIF(BusinessType='SBOP',LocationBuildingLimit+LocationContentsLimit,\r\n\t-- LocationBuildingLimit+LocationContentsLimit+v_LocationBILimit))\n\tIFF(\n\t    LocationBuildingLimit = 0 AND LocationContentsLimit = 0 AND v_LocationBILimit = 0, NULL,\n\t    IFF(\n\t        BusinessType = 'SBOP', LocationBuildingLimit + LocationContentsLimit,\n\t        LocationBuildingLimit + LocationContentsLimit + v_LocationBILimit\n\t    )\n\t) AS o_LocationLimit,\n\t-- *INF*: IIF(LocationBuildingLimit=0, NULL, LocationBuildingLimit)\n\tIFF(LocationBuildingLimit = 0, NULL, LocationBuildingLimit) AS o_LocationBuildingLimit,\n\t-- *INF*: IIF(LocationContentsLimit=0, NULL, LocationContentsLimit)\n\tIFF(LocationContentsLimit = 0, NULL, LocationContentsLimit) AS o_LocationContentsLimit,\n\t-- *INF*: IIF(v_LocationBILimit=0, NULL, v_LocationBILimit)\n\tIFF(v_LocationBILimit = 0, NULL, v_LocationBILimit) AS o_LocationBILimit\n\tFROM AGG_RowToColumn_Limit\n),\nJNR_Limit AS (SELECT\n\tAGG_BuildingPremium.SourceSystemId, \n\tAGG_BuildingPremium.PolicyKey, \n\tAGG_BuildingPremium.LocationNumber, \n\tAGG_BuildingPremium.BuildingNumber, \n\tAGG_BuildingPremium.BusinessType, \n\tAGG_BuildingPremium.InsuranceReferenceLegalEntityDescription, \n\tAGG_BuildingPremium.StreetAddress, \n\tAGG_BuildingPremium.RatingCity, \n\tAGG_BuildingPremium.RatingStateProvinceAbbreviation, \n\tAGG_BuildingPremium.RatingPostalCode, \n\tAGG_BuildingPremium.RatingCounty, \n\tAGG_BuildingPremium.o_ConstructionCode AS ConstructionCode, \n\tAGG_BuildingPremium.AgencyCode, \n\tAGG_BuildingPremium.StrategicProfitCenterDescription, \n\tAGG_BuildingPremium.InsuranceSegmentDescription, \n\tAGG_BuildingPremium.InsuredName, \n\tAGG_BuildingPremium.CustomerNumber, \n\tAGG_BuildingPremium.PolicyEffectiveDate, \n\tAGG_BuildingPremium.PolicyExpirationDate, \n\tAGG_BuildingPremium.OccupancyCode, \n\tAGG_BuildingPremium.SicCode, \n\tAGG_BuildingPremium.ProcessDate, \n\tAGG_BuildingPremium.o_BuildingPremium AS BuildingPremium, \n\tEXP_SplitLimit.PolicyKey AS PolicyKey_Limit, \n\tEXP_SplitLimit.LocationNumber AS LocationNumber_Limit, \n\tEXP_SplitLimit.BuildingNumber AS BuildingNumber_Limit, \n\tEXP_SplitLimit.BusinessType AS BusinessType_Limit, \n\tEXP_SplitLimit.o_LocationLimit AS LocationLimit, \n\tEXP_SplitLimit.o_LocationBuildingLimit AS LocationBuildingLimit, \n\tEXP_SplitLimit.o_LocationContentsLimit AS LocationContentsLimit, \n\tEXP_SplitLimit.o_LocationBILimit AS LocationBILimit\n\tFROM AGG_BuildingPremium\n\tLEFT OUTER JOIN EXP_SplitLimit\n\tON EXP_SplitLimit.PolicyKey = AGG_BuildingPremium.PolicyKey AND EXP_SplitLimit.LocationNumber = AGG_BuildingPremium.LocationNumber AND EXP_SplitLimit.BuildingNumber = AGG_BuildingPremium.BuildingNumber AND EXP_SplitLimit.BusinessType = AGG_BuildingPremium.BusinessType\n),\nJNR_Deductible AS (SELECT\n\tJNR_Limit.SourceSystemId, \n\tJNR_Limit.PolicyKey, \n\tJNR_Limit.LocationNumber, \n\tJNR_Limit.BuildingNumber, \n\tJNR_Limit.BusinessType, \n\tJNR_Limit.InsuranceReferenceLegalEntityDescription, \n\tJNR_Limit.StreetAddress, \n\tJNR_Limit.RatingCity, \n\tJNR_Limit.RatingStateProvinceAbbreviation, \n\tJNR_Limit.RatingPostalCode, \n\tJNR_Limit.RatingCounty, \n\tJNR_Limit.ConstructionCode, \n\tJNR_Limit.AgencyCode, \n\tJNR_Limit.StrategicProfitCenterDescription, \n\tJNR_Limit.InsuranceSegmentDescription, \n\tJNR_Limit.InsuredName, \n\tJNR_Limit.CustomerNumber, \n\tJNR_Limit.PolicyEffectiveDate, \n\tJNR_Limit.PolicyExpirationDate, \n\tJNR_Limit.OccupancyCode, \n\tJNR_Limit.SicCode, \n\tJNR_Limit.ProcessDate, \n\tJNR_Limit.BuildingPremium, \n\tJNR_Limit.LocationLimit, \n\tJNR_Limit.LocationBuildingLimit, \n\tJNR_Limit.LocationContentsLimit, \n\tJNR_Limit.LocationBILimit, \n\tEXP_SplitDeductible.PolicyKey AS PolicyKey_Deductible, \n\tEXP_SplitDeductible.LocationNumber AS LocationNumber_Deductible, \n\tEXP_SplitDeductible.BuildingNumber AS BuildingNumber_Deductible, \n\tEXP_SplitDeductible.BusinessType AS BusinessType_Deductible, \n\tEXP_SplitDeductible.BPPEarthquakeDeductiblePercentage, \n\tEXP_SplitDeductible.BuildingEarthquakeDeductiblePercentage, \n\tEXP_SplitDeductible.EarthquakeDeductiblePercentage, \n\tEXP_SplitDeductible.o_PolicyBlanketDeductible AS PolicyBlanketDeductible, \n\tEXP_SplitDeductible.o_LocationDeductible AS LocationDeductible, \n\tEXP_SplitDeductible.o_LocationBuildingDeductible AS LocationBuildingDeductible, \n\tEXP_SplitDeductible.o_LocationContentsDeductible AS LocationContentsDeductible, \n\tEXP_SplitDeductible.o_LocationBIDeductible AS LocationBIDeductible, \n\tEXP_SplitDeductible.o_LocBIDeductibleBuilding, \n\tEXP_SplitDeductible.o_LocBIDeductibleContents\n\tFROM JNR_Limit\n\tLEFT OUTER JOIN EXP_SplitDeductible\n\tON EXP_SplitDeductible.PolicyKey = JNR_Limit.PolicyKey AND EXP_SplitDeductible.LocationNumber = JNR_Limit.LocationNumber AND EXP_SplitDeductible.BuildingNumber = JNR_Limit.BuildingNumber AND EXP_SplitDeductible.BusinessType = JNR_Limit.BusinessType\n),\nLKP_WorkCatastropheExposureLimit_CPP_SBOP AS (\n\tSELECT\n\tLimitValue,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT L.PolicyKey AS PolicyKey\r\n\t\t     , L.BusinessType AS BusinessType\r\n\t\t\t , (CASE WHEN RelevantLimits.CalculationRule = 'MAX' THEN MAX(CONVERT(BIGINT, L.LimitValue))\r\n\t\t  WHEN RelevantLimits.CalculationRule = 'MIN' THEN MIN(CONVERT(BIGINT, L.LimitValue))\r\n\t\t  WHEN RelevantLimits.CalculationRule = 'SUM' THEN SUM(CONVERT(BIGINT, L.LimitValue))\r\n\t\t  ELSE 0\r\n\t\t END) AS LimitValue\r\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureLimit L\r\n\t\tINNER JOIN (SELECT DISTINCT BusinessType, LimitType, CalculationRule, TargetColumn\r\n\t\t  FROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SupCatastropheExposureLimitRule\r\n\t\t  WHERE SourceSystemId = 'DCT'\r\n\t\t  AND TargetColumn = 'Pol Blkt Limit') RelevantLimits ON L.BusinessType = RelevantLimits.BusinessType AND L.LimitType = RelevantLimits.LimitType\r\n\t\tWHERE L.BusinessType IN ('Commercial Property', 'SBOP')\r\n\t\tGROUP BY L.PolicyKey, L.BusinessType, RelevantLimits.CalculationRule\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY LimitValue) = 1\n),\nLKP_WorkCatastropheExposureLimit_SMARTBlanket AS (\n\tSELECT\n\tLimitValue,\n\tPolicyKey\n\tFROM (\n\t\tselect L.PolicyKey as PolicyKey, SUM(CONVERT(BIGINT, L.LimitValue)) as LimitValue\r\n\t\tfrom @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureLimit L with (nolock)\r\n\t\twhere L.BusinessType = 'SMARTbusiness'\r\n\t\tand (L.LimitType like '%Blanket Building' or L.LimitType like '%Blanket Building and Personal Property' or L.LimitType like '%Blanket Contents')\r\n\t\tgroup by L.PolicyKey\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey ORDER BY LimitValue) = 1\n),\nLKP_WorkCatastropheExposureTransaction_BalnketDeductible AS (\n\tSELECT\n\tCoverageGroupDescription,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageGroupDescription,\n\t\t\tPolicyKey,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageGroupDescription like '%blanket%' AND BusinessType='SBOP'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY CoverageGroupDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_ALS AS (\n\tSELECT\n\tDctCoverageTypeCode,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tDctCoverageTypeCode,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE DctCoverageTypeCode = 'ALS'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY DctCoverageTypeCode) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription = 'Business Personal Property'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_Earthquake AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Earthquake'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Earthquake - Building'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Earthquake - Business Personal Property'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Earthquake - Personal Property'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome AS (\n\tSELECT\n\tCoverageGroupDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageGroupDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageGroupDescription = 'Business Income'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageGroupDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_Earthquake AS (\n\tSELECT\n\tCoverageGroupDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageGroupDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageGroupDescription='Earthquake'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageGroupDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_Elite AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Enhancement Endorsement Elite - Property'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_Essential AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Enhancement Endorsement Essential - Property'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium AS (\n\tSELECT\n\tLocationEarthquakePremium,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \r\n\t\tPolicyKey as PolicyKey, \r\n\t\tLocationNumber as LocationNumber, \r\n\t\tBuildingNumber as BuildingNumber, \r\n\t\tBusinessType as BusinessType,\r\n\t\tSUM(PremiumTransactionAmount) as LocationEarthquakePremium\r\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\r\n\t\tWHERE CoverageGroupDescription='Earthquake'\r\n\t\tGROUP BY \r\n\t\tPolicyKey, \r\n\t\tLocationNumber, \r\n\t\tBuildingNumber, \r\n\t\tBusinessType \r\n\t\tORDER BY\r\n\t\tPolicyKey, \r\n\t\tLocationNumber, \r\n\t\tBuildingNumber, \r\n\t\tBusinessType\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY LocationEarthquakePremium) = 1\n),\nLKP_WorkCatastropheExposureTransaction_PlusPak AS (\n\tSELECT\n\tCoverageDescription,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageDescription,\n\t\t\tPolicyKey,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE CoverageDescription='Plus Pak'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY CoverageDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_PolicyBlanketPremium AS (\n\tSELECT\n\tPolicyBlanketPremium,\n\tPolicyKey,\n\tBusinessType\n\tFROM (\n\t\tSELECT\r\n\t\tPolicyKey as PolicyKey, \r\n\t\tBusinessType as BusinessType, \r\n\t\tSUM(PremiumTransactionAmount) as PolicyBlanketPremium\r\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\r\n\t\tWHERE CoverageGroupDescription IN ('Blanket Building','Blanket Building and Contents','Blanket Business Income','Blanket Contents') \r\n\t\tGROUP BY \r\n\t\tPolicyKey, \r\n\t\tBusinessType \r\n\t\tORDER BY\r\n\t\tPolicyKey, \r\n\t\tBusinessType\r\n\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,BusinessType ORDER BY PolicyBlanketPremium) = 1\n),\nLKP_WorkCatastropheExposureTransaction_Terrorism AS (\n\tSELECT\n\tCoverageGroupDescription,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tCoverageGroupDescription,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE (TerrorismRiskIndicator = 1\r\n\t\t  or (CoverageGroupDescription = 'Terrorism' and PremiumTransactionAmount > 0.0)\r\n\t\t  )\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY CoverageGroupDescription) = 1\n),\nLKP_WorkCatastropheExposureTransaction_WindCoverageFlag AS (\n\tSELECT\n\tWindCoverageFlag,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tSELECT \n\t\t\tWindCoverageFlag,\n\t\t\tPolicyKey,\n\t\t\tLocationNumber,\n\t\t\tBuildingNumber,\n\t\t\tBusinessType\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction\n\t\tWHERE WindCoverageFlag=1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY WindCoverageFlag) = 1\n),\nLKP_WorkCatastropheExposureTransaction_YearBuilt AS (\n\tSELECT\n\tYearBuilt,\n\ti_PolicyKey,\n\ti_LocationNumber,\n\ti_BuildingNumber,\n\ti_BusinessType,\n\tPolicyKey,\n\tLocationNumber,\n\tBuildingNumber,\n\tBusinessType\n\tFROM (\n\t\tselect distinct t.PolicyKey as PolicyKey,\r\n\t\t t.LocationNumber as LocationNumber, t.BuildingNumber as BuildingNumber, t.BusinessType as BusinessType,\r\n\t\t   FIRST_VALUE(pt.YearBuilt) OVER (\r\n\t\t  PARTITION BY t.PolicyKey, t.LocationNumber, t.BuildingNumber, t.BusinessType\r\n\t\t  ORDER BY PT.PremiumTransactionEffectiveDate desc, PT.PremiumTransactionEnteredDate desc, \r\n\t\t  PT.OffsetOnsetCode desc) as YearBuilt\r\n\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureTransaction t with (nolock)\r\n\t\tjoin @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.PremiumTransaction pt with (nolock) on t.PremiumTransactionAKID = pt.PremiumTransactionAKID\r\n\t\t and pt.YearBuilt <> '0000'\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PolicyKey,LocationNumber,BuildingNumber,BusinessType ORDER BY YearBuilt) = 1\n),\nEXP_MetaData AS (\n\tSELECT\n\tJNR_Deductible.SourceSystemId,\n\tJNR_Deductible.PolicyKey,\n\tJNR_Deductible.LocationNumber,\n\tJNR_Deductible.BuildingNumber,\n\tJNR_Deductible.BusinessType,\n\tJNR_Deductible.InsuranceReferenceLegalEntityDescription,\n\tJNR_Deductible.StreetAddress,\n\tJNR_Deductible.RatingCity,\n\tJNR_Deductible.RatingStateProvinceAbbreviation,\n\tJNR_Deductible.RatingPostalCode,\n\tJNR_Deductible.RatingCounty,\n\tJNR_Deductible.ConstructionCode,\n\tLKP_WorkCatastropheExposureTransaction_YearBuilt.YearBuilt,\n\tJNR_Deductible.AgencyCode,\n\tJNR_Deductible.StrategicProfitCenterDescription,\n\tJNR_Deductible.InsuranceSegmentDescription,\n\tJNR_Deductible.InsuredName,\n\tJNR_Deductible.CustomerNumber,\n\tJNR_Deductible.PolicyEffectiveDate,\n\tJNR_Deductible.PolicyExpirationDate,\n\tJNR_Deductible.OccupancyCode,\n\tJNR_Deductible.SicCode,\n\tJNR_Deductible.ProcessDate,\n\tJNR_Deductible.BuildingPremium,\n\tBuildingPremium AS o_Source_BuildingPremium,\n\tLKP_WorkCatastropheExposureLimit_CPP_SBOP.LimitValue AS PolicyBlanketLimit_CPP_SBOP,\n\tLKP_WorkCatastropheExposureLimit_SMARTBlanket.LimitValue AS PolicyBlanketLimit_SMART,\n\tJNR_Deductible.LocationLimit,\n\tJNR_Deductible.LocationBuildingLimit,\n\tJNR_Deductible.LocationContentsLimit,\n\tJNR_Deductible.LocationBILimit,\n\tJNR_Deductible.BPPEarthquakeDeductiblePercentage,\n\tJNR_Deductible.BuildingEarthquakeDeductiblePercentage,\n\tJNR_Deductible.EarthquakeDeductiblePercentage,\n\tJNR_Deductible.PolicyBlanketDeductible,\n\tJNR_Deductible.LocationDeductible,\n\tJNR_Deductible.LocationBuildingDeductible,\n\tJNR_Deductible.LocationContentsDeductible,\n\tJNR_Deductible.LocationBIDeductible,\n\tJNR_Deductible.o_LocBIDeductibleBuilding AS LocBIDeductibleBuilding,\n\tJNR_Deductible.o_LocBIDeductibleContents AS LocBIDeductibleContents,\n\t-- *INF*: IIF(ISNULL(LocBIDeductibleBuilding),LocBIDeductibleContents,LocBIDeductibleBuilding)\n\tIFF(LocBIDeductibleBuilding IS NULL, LocBIDeductibleContents, LocBIDeductibleBuilding) AS v_LocBIDedu_Buld_Cont,\n\tLKP_WorkCatastropheExposureTransaction_PolicyBlanketPremium.PolicyBlanketPremium AS lkp_PolicyBlanketPremium,\n\tLKP_WorkCatastropheExposureTransaction_PlusPak.CoverageDescription AS lkp_CoverageDescription_PlusPak,\n\tLKP_WorkCatastropheExposureTransaction_Essential.CoverageDescription AS lkp_CoverageDescription_Essential,\n\tLKP_WorkCatastropheExposureTransaction_Elite.CoverageDescription AS lkp_CoverageDescription_Elite,\n\tLKP_WorkCatastropheExposureTransaction_WindCoverageFlag.WindCoverageFlag AS lkp_WindCoverageFlag,\n\tLKP_WorkCatastropheExposureTransaction_Earthquake.CoverageGroupDescription AS lkp_CoverageGroupDescription_Earthquake,\n\tLKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium.LocationEarthquakePremium AS lkp_LocationEarthquakePremium,\n\tLKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty.CoverageDescription AS lkp_CoverageDescription_EarthquakePersonalProperty,\n\tLKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty.CoverageDescription AS lkp_CoverageDescription_EarthquakeBusinessPersonalProperty,\n\tLKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding.CoverageDescription AS lkp_CoverageDescription_EarthquakeBuilding,\n\tLKP_WorkCatastropheExposureTransaction_CD_Earthquake.CoverageDescription AS lkp_CoverageDescription_Earthquake,\n\tLKP_WorkCatastropheExposureTransaction_CD_ALS.DctCoverageTypeCode AS lkp_DctCoverageTypeCode,\n\tLKP_WorkCatastropheExposureTransaction_Terrorism.CoverageGroupDescription AS lkp_CoverageGroupDescription_Terrorism,\n\tLKP_WorkCatastropheExposureTransaction_BalnketDeductible.CoverageGroupDescription AS lkp_CoverageGroupDescription_BlanketDed,\n\tLKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty.CoverageDescription AS lkp_CoverageDescription_BusinessPersonalProperty,\n\tLKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome.CoverageGroupDescription AS lkp_CoverageGroupDescription_BusinessIncome,\n\t-- *INF*: IIF((BusinessType = 'SBOP'  OR Not ISNULL(lkp_CoverageDescription_PlusPak)),'1','0')\r\n\t-- \n\tIFF((BusinessType = 'SBOP' OR lkp_CoverageDescription_PlusPak IS NOT NULL), '1', '0') AS v_PlusPakFlag,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- NOT ISNULL(lkp_CoverageDescription_Elite),'L',\r\n\t-- NOT ISNULL(lkp_CoverageDescription_Essential),'S',\r\n\t-- 'N')\r\n\t-- -- Flag Elite as 'L', Essential as 'S' and neither as 'N'\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    lkp_CoverageDescription_Elite IS NOT NULL, 'L',\n\t    lkp_CoverageDescription_Essential IS NOT NULL, 'S',\n\t    'N'\n\t) AS v_EliteFlag,\n\t-- *INF*: IIF(ISNULL(lkp_PolicyBlanketPremium), NULL, ROUND(lkp_PolicyBlanketPremium,0))\n\tIFF(lkp_PolicyBlanketPremium IS NULL, NULL, ROUND(lkp_PolicyBlanketPremium, 0)) AS v_PolicyBlanketPremium,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- v_EliteFlag = 'L', 1.08,\r\n\t-- v_EliteFlag = 'S', 1.05,\r\n\t-- v_PlusPakFlag = '1', 1.05,\r\n\t-- 1.00)\r\n\t-- --Elite gets a modifier of 1.08, Essential and/or PlusPak get 1.05 else we default to 1\n\tDECODE(\n\t    TRUE,\n\t    v_EliteFlag = 'L', 1.08,\n\t    v_EliteFlag = 'S', 1.05,\n\t    v_PlusPakFlag = '1', 1.05,\n\t    1.00\n\t) AS v_Multiplier,\n\t-- *INF*: ROUND(LocationBuildingLimit*v_Multiplier, 0)\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE, ISNULL(LocationBuildingLimit), 0,((BusinessType<>'SBOP' OR BusinessType<>'SMARTbusiness' OR BusinessType<>'Commercial Property') AND ISNULL(lkp_CoverageDescription_PlusPak)), LocationBuildingLimit,  ROUND(LocationBuildingLimit*1.05, 0))\r\n\t-- \r\n\t-- --DECODE(TRUE, ISNULL(LocationBuildingLimit), 0,BusinessType<>'SBOP' AND ISNULL(lkp_CoverageDescription_PlusPak), LocationBuildingLimit,  ROUND(LocationBuildingLimit*1.05, 0))\r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE, ISNULL(LocationBuildingLimit), 0,BusinessType<>'SBOP' AND ISNULL(lkp_CoverageDescription_PlusPak), LocationBuildingLimit, BusinessType='SBOP', ROUND(LocationBuildingLimit*1.05, 0), 0)\n\tROUND(LocationBuildingLimit * v_Multiplier, 0) AS v_AdjustedBuildingLimit,\n\t-- *INF*: ROUND(LocationContentsLimit*v_Multiplier, 0)\r\n\t-- --DECODE(TRUE,ISNULL(LocationContentsLimit),0,((BusinessType<>'SBOP' OR BusinessType<>'SMARTbusiness' OR BusinessType<>'Commercial Property') and ISNULL(lkp_CoverageDescription_PlusPak)), LocationContentsLimit, ROUND(LocationContentsLimit*1.05, 0))\r\n\t-- \r\n\t-- --DECODE(TRUE, ISNULL(LocationContentsLimit),0, BusinessType<>'SBOP' and ISNULL(lkp_CoverageDescription_PlusPak), LocationContentsLimit,    BusinessType='SBOP',ROUND(LocationContentsLimit*1.05, 0),0)\n\tROUND(LocationContentsLimit * v_Multiplier, 0) AS v_AdjustedContentsLimit,\n\t-- *INF*: ROUND(LocationBILimit*v_Multiplier, 0)\r\n\t-- \r\n\t-- --DECODE(TRUE,ISNULL(LocationBILimit),0,((BusinessType<>'SBOP' OR BusinessType<>'SMARTbusiness' OR BusinessType<>'Commercial Property') and ISNULL(lkp_CoverageDescription_PlusPak)), LocationBILimit, ROUND(LocationBILimit*1.05, 0))\r\n\t-- \r\n\t-- --DECODE(TRUE, ISNULL(LocationBILimit),0, BusinessType<>'SBOP' and ISNULL(lkp_CoverageDescription_PlusPak), LocationBILimit, BusinessType='SBOP', ROUND(LocationBILimit*1.05, 0),0)\n\tROUND(LocationBILimit * v_Multiplier, 0) AS v_AdjustedBILimit,\n\t-- *INF*: IIF(ISNULL(v_AdjustedBuildingLimit),0,v_AdjustedBuildingLimit)+\r\n\t-- IIF(ISNULL(v_AdjustedContentsLimit),0,v_AdjustedContentsLimit)+\r\n\t-- IIF(ISNULL(v_AdjustedBILimit),0,v_AdjustedBILimit)\n\tIFF(v_AdjustedBuildingLimit IS NULL, 0, v_AdjustedBuildingLimit) + IFF(v_AdjustedContentsLimit IS NULL, 0, v_AdjustedContentsLimit) + IFF(v_AdjustedBILimit IS NULL, 0, v_AdjustedBILimit) AS v_AdjustedTotalInsuredValue,\n\t-- *INF*: IIF(ISNULL(lkp_WindCoverageFlag), '0', '1')\n\tIFF(lkp_WindCoverageFlag IS NULL, '0', '1') AS v_LocationWindCoverageFlag,\n\t-- *INF*: IIF(ISNULL(lkp_CoverageGroupDescription_Earthquake), '0', '1')\n\tIFF(lkp_CoverageGroupDescription_Earthquake IS NULL, '0', '1') AS v_LocationEarthquakeFlag,\n\t-- *INF*: IIF(ISNULL(lkp_LocationEarthquakePremium), NULL, ROUND(lkp_LocationEarthquakePremium,0))\n\tIFF(lkp_LocationEarthquakePremium IS NULL, NULL, ROUND(lkp_LocationEarthquakePremium, 0)) AS v_LocationEarthquakePremium,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(LocationContentsLimit), 0,\r\n\t-- (BusinessType='SBOP' AND (NOT ISNULL(lkp_CoverageDescription_EarthquakePersonalProperty)\r\n\t-- OR NOT ISNULL(lkp_CoverageDescription_EarthquakeBusinessPersonalProperty))\r\n\t-- ), LocationContentsLimit,\r\n\t-- (BusinessType='Commercial Property' )AND NOT ISNULL(lkp_CoverageDescription_EarthquakePersonalProperty), LocationContentsLimit\r\n\t-- ,0)\n\tDECODE(\n\t    TRUE,\n\t    LocationContentsLimit IS NULL, 0,\n\t    (BusinessType = 'SBOP' AND (lkp_CoverageDescription_EarthquakePersonalProperty IS NULL OR lkp_CoverageDescription_EarthquakeBusinessPersonalProperty IS NOT NOT NULL)), LocationContentsLimit,\n\t    (BusinessType = 'Commercial Property') AND lkp_CoverageDescription_EarthquakePersonalProperty IS NOT NULL, LocationContentsLimit,\n\t    0\n\t) AS v_Earthquake_LocationContentsLimit_CP_SBOP,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(LocationBuildingLimit), 0,\r\n\t-- (BusinessType='SBOP' OR BusinessType='Commercial Property') AND NOT ISNULL(lkp_CoverageDescription_EarthquakeBuilding), LocationBuildingLimit\r\n\t-- ,0)\n\tDECODE(\n\t    TRUE,\n\t    LocationBuildingLimit IS NULL, 0,\n\t    (BusinessType = 'SBOP' OR BusinessType = 'Commercial Property') AND lkp_CoverageDescription_EarthquakeBuilding IS NOT NULL, LocationBuildingLimit,\n\t    0\n\t) AS v_Earthquake_LocationBuildingLimit_CP_SBOP,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(LocationBuildingLimit),0,\r\n\t-- BusinessType='SMARTbusiness' AND NOT ISNULL(lkp_CoverageDescription_Earthquake), LocationBuildingLimit,\r\n\t-- 0)\n\tDECODE(\n\t    TRUE,\n\t    LocationBuildingLimit IS NULL, 0,\n\t    BusinessType = 'SMARTbusiness' AND lkp_CoverageDescription_Earthquake IS NOT NULL, LocationBuildingLimit,\n\t    0\n\t) AS v_Earthquake_LocationBuildingLimit_SMT,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- ISNULL(LocationContentsLimit),0,\r\n\t-- BusinessType='SMARTbusiness' AND NOT ISNULL(lkp_CoverageDescription_Earthquake), LocationContentsLimit,\r\n\t-- 0)\n\tDECODE(\n\t    TRUE,\n\t    LocationContentsLimit IS NULL, 0,\n\t    BusinessType = 'SMARTbusiness' AND lkp_CoverageDescription_Earthquake IS NOT NULL, LocationContentsLimit,\n\t    0\n\t) AS v_Earthquake_LocationContentsLimit_SMT,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- (v_Earthquake_LocationContentsLimit_CP_SBOP+v_Earthquake_LocationBuildingLimit_CP_SBOP) != 0, v_Earthquake_LocationContentsLimit_CP_SBOP+v_Earthquake_LocationBuildingLimit_CP_SBOP,\r\n\t-- (v_Earthquake_LocationBuildingLimit_SMT+v_Earthquake_LocationContentsLimit_SMT) != 0, v_Earthquake_LocationBuildingLimit_SMT+v_Earthquake_LocationContentsLimit_SMT,\r\n\t-- NULL)\r\n\t-- \r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    (v_Earthquake_LocationContentsLimit_CP_SBOP + v_Earthquake_LocationBuildingLimit_CP_SBOP) != 0, v_Earthquake_LocationContentsLimit_CP_SBOP + v_Earthquake_LocationBuildingLimit_CP_SBOP,\n\t    (v_Earthquake_LocationBuildingLimit_SMT + v_Earthquake_LocationContentsLimit_SMT) != 0, v_Earthquake_LocationBuildingLimit_SMT + v_Earthquake_LocationContentsLimit_SMT,\n\t    NULL\n\t) AS v_LocationEarthquakeLimit,\n\t-- *INF*: Decode(TRUE,BusinessType = 'SBOP' OR BusinessType ='SMARTbusiness' OR NOT ISNULL(lkp_DctCoverageTypeCode) ,1,0)\r\n\t-- \r\n\t-- --IIF(ISNULL(lkp_DctCoverageTypeCode), '0', '1')\n\tDecode(\n\t    TRUE,\n\t    BusinessType = 'SBOP' OR BusinessType = 'SMARTbusiness' OR lkp_DctCoverageTypeCode IS NOT NULL, 1,\n\t    0\n\t) AS v_ActualLossSustainedCoverageFlag,\n\t-- *INF*: IIF(ISNULL(lkp_CoverageGroupDescription_Terrorism), '0', '1')\n\tIFF(lkp_CoverageGroupDescription_Terrorism IS NULL, '0', '1') AS v_TerrorismFlag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_AuditId,\n\tSYSDATE AS o_CreatedDate,\n\tSYSDATE AS o_ModifiedDate,\n\tSourceSystemId AS o_SourceSystemId,\n\tPolicyKey AS o_PolicyKey,\n\tLocationNumber AS o_LocationNumber,\n\tBuildingNumber AS o_BuildingNumber,\n\tBusinessType AS o_BusinessType,\n\tInsuranceReferenceLegalEntityDescription AS o_InsuranceReferenceLegalEntityDescription,\n\tv_PolicyBlanketPremium AS o_PolicyBlanketPremium,\n\t-- *INF*: DECODE(BusinessType,\r\n\t-- 'Commercial Property',\r\n\t-- PolicyBlanketLimit_CPP_SBOP,\r\n\t-- 'SBOP',\r\n\t-- PolicyBlanketLimit_CPP_SBOP,\r\n\t-- 'SMARTbusiness',\r\n\t-- PolicyBlanketLimit_SMART,\r\n\t-- 0)\n\tDECODE(\n\t    BusinessType,\n\t    'Commercial Property', PolicyBlanketLimit_CPP_SBOP,\n\t    'SBOP', PolicyBlanketLimit_CPP_SBOP,\n\t    'SMARTbusiness', PolicyBlanketLimit_SMART,\n\t    0\n\t) AS v_PolicyBlanketLimit,\n\tv_PolicyBlanketLimit AS o_PolicyBlanketLimit,\n\t-- *INF*: DECODE(TRUE, BusinessType='SBOP' AND NOT ISNULL(lkp_CoverageGroupDescription_BlanketDed), PolicyBlanketDeductible,NULL )\r\n\t-- \n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'SBOP' AND lkp_CoverageGroupDescription_BlanketDed IS NOT NULL, PolicyBlanketDeductible,\n\t    NULL\n\t) AS o_PolicyBlanketDeductible,\n\tStreetAddress AS o_RatingAddress,\n\tRatingCity AS o_RatingCity,\n\tRatingStateProvinceAbbreviation AS o_RatingStateProvinceAbbreviation,\n\tRatingPostalCode AS o_RatingPostalCode,\n\tRatingCounty AS o_RatingCounty,\n\t-- *INF*: IIF(ISNULL(ConstructionCode),'N/A',ConstructionCode)\n\tIFF(ConstructionCode IS NULL, 'N/A', ConstructionCode) AS o_ConstructionClass,\n\t-- *INF*: IIF(ISNULL(YearBuilt),'0000',YearBuilt)\n\tIFF(YearBuilt IS NULL, '0000', YearBuilt) AS o_YearBuilt,\n\t-- *INF*: IIF(ISNULL(BuildingPremium),0, BuildingPremium)\n\tIFF(BuildingPremium IS NULL, 0, BuildingPremium) AS v_BuildingPremium,\n\t-- *INF*: IIF(v_BuildingPremium=0,\r\n\t-- IIF(ISNULL(v_PolicyBlanketPremium),0,v_PolicyBlanketPremium),v_BuildingPremium)\n\tIFF(\n\t    v_BuildingPremium = 0,\n\t    IFF(\n\t        v_PolicyBlanketPremium IS NULL, 0, v_PolicyBlanketPremium\n\t    ),\n\t    v_BuildingPremium\n\t) AS o_BuildingPremium,\n\tLocationLimit AS o_LocationLimit,\n\tLocationDeductible AS o_LocationDeductible,\n\tLocationBuildingLimit AS o_LocationBuildingLimit,\n\tLocationBuildingDeductible AS o_LocationBuildingDeductible,\n\tLocationContentsLimit AS o_LocationContentsLimit,\n\t-- *INF*: LocationContentsDeductible\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- --DECODE(TRUE,\r\n\t-- --BusinessType='SMARTbusiness' and NOT ISNULL(lkp_CoverageDescription_BusinessPersonalProperty), LocationBuildingDeductible,\r\n\t-- --IN (BusinessType, 'Commercial Property','SBOP'), LocationContentsDeductible,\r\n\t-- --NULL)\n\tLocationContentsDeductible AS o_LocationContentsDeductible,\n\tLocationBILimit AS o_LocationBILimit,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- IN(BusinessType,'SMARTbusiness') AND NOT ISNULL(lkp_CoverageGroupDescription_BusinessIncome),\r\n\t-- LocationBIDeductible,\r\n\t-- BusinessType='SBOP', LocationBIDeductible,\r\n\t-- BusinessType= 'Commercial Property' AND NOT ISNULL(lkp_CoverageGroupDescription_BusinessIncome),v_LocBIDedu_Buld_Cont,\r\n\t-- NULL)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType IN ('SMARTbusiness') AND lkp_CoverageGroupDescription_BusinessIncome IS NOT NULL, LocationBIDeductible,\n\t    BusinessType = 'SBOP', LocationBIDeductible,\n\t    BusinessType = 'Commercial Property' AND lkp_CoverageGroupDescription_BusinessIncome IS NOT NULL, v_LocBIDedu_Buld_Cont,\n\t    NULL\n\t) AS o_LocationBIDeductible,\n\tv_PlusPakFlag AS o_PlusPakFlag,\n\t-- *INF*: IIF(v_AdjustedBuildingLimit=0, NULL, v_AdjustedBuildingLimit)\n\tIFF(v_AdjustedBuildingLimit = 0, NULL, v_AdjustedBuildingLimit) AS o_AdjustedBuildingLimit,\n\t-- *INF*: IIF(v_AdjustedContentsLimit=0, NULL, v_AdjustedContentsLimit)\n\tIFF(v_AdjustedContentsLimit = 0, NULL, v_AdjustedContentsLimit) AS o_AdjustedContentsLimit,\n\t-- *INF*: IIF(v_AdjustedBILimit=0, NULL, v_AdjustedBILimit)\n\tIFF(v_AdjustedBILimit = 0, NULL, v_AdjustedBILimit) AS o_AdjustedBILimit,\n\tv_AdjustedTotalInsuredValue AS o_AdjustedTotalInsuredValue,\n\tv_LocationWindCoverageFlag AS o_LocationWindCoverageFlag,\n\tv_LocationEarthquakeFlag AS o_LocationEarthquakeFlag,\n\tv_LocationEarthquakePremium AS o_LocationEarthquakePremium,\n\tv_LocationEarthquakeLimit AS o_LocationEarthquakeLimit,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- BusinessType='Commercial Property' and\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage!=0 , IIF(ISNULL(BuildingEarthquakeDeductiblePercentage/100*LocationBuildingLimit), 0,BuildingEarthquakeDeductiblePercentage/100*LocationBuildingLimit) ,\r\n\t-- 0)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Property' and BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage != 0, IFF(\n\t        BuildingEarthquakeDeductiblePercentage / 100 * LocationBuildingLimit IS NULL, 0,\n\t        BuildingEarthquakeDeductiblePercentage / 100 * LocationBuildingLimit\n\t    ),\n\t    0\n\t) AS v_BuildingEarthquakeDeductible,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- BusinessType='Commercial Property' and\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage!=0 , IIF(ISNULL(BPPEarthquakeDeductiblePercentage/100*LocationContentsLimit), 0,BPPEarthquakeDeductiblePercentage/100*LocationContentsLimit) ,\r\n\t-- 0)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Property' and BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage != 0, IFF(\n\t        BPPEarthquakeDeductiblePercentage / 100 * LocationContentsLimit IS NULL, 0,\n\t        BPPEarthquakeDeductiblePercentage / 100 * LocationContentsLimit\n\t    ),\n\t    0\n\t) AS v_BPPEarthquakeDeductible,\n\t-- *INF*: DECODE(TRUE,\r\n\t-- BusinessType='Commercial Property', DECODE(TRUE,\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage!=0 , GREATEST(v_BuildingEarthquakeDeductible , v_BPPEarthquakeDeductible),\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage=0 ,  BPPEarthquakeDeductiblePercentage/100*LocationContentsLimit,\r\n\t-- BPPEarthquakeDeductiblePercentage=0 AND BuildingEarthquakeDeductiblePercentage!=0 ,  BuildingEarthquakeDeductiblePercentage/100*LocationBuildingLimit ,\r\n\t-- NULL),\r\n\t-- BusinessType='SMARTbusiness', DECODE(TRUE,\r\n\t-- EarthquakeDeductiblePercentage!=0, EarthquakeDeductiblePercentage/100*v_LocationEarthquakeLimit ,\r\n\t-- NULL)\r\n\t-- ,BusinessType='SBOP',DECODE(TRUE,\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage!=0 ,BuildingEarthquakeDeductiblePercentage/100*LocationBuildingLimit ,\r\n\t-- BPPEarthquakeDeductiblePercentage!=0 AND BuildingEarthquakeDeductiblePercentage=0 ,  BPPEarthquakeDeductiblePercentage/100*LocationContentsLimit,\r\n\t-- BPPEarthquakeDeductiblePercentage=0 AND BuildingEarthquakeDeductiblePercentage!=0 ,  \r\n\t-- BuildingEarthquakeDeductiblePercentage/100*LocationBuildingLimit,\r\n\t-- NULL),\r\n\t-- NULL)\n\tDECODE(\n\t    TRUE,\n\t    BusinessType = 'Commercial Property', DECODE(\n\t        TRUE,\n\t        BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage != 0, GREATEST(v_BuildingEarthquakeDeductible, v_BPPEarthquakeDeductible),\n\t        BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage = 0, BPPEarthquakeDeductiblePercentage / 100 * LocationContentsLimit,\n\t        BPPEarthquakeDeductiblePercentage = 0 AND BuildingEarthquakeDeductiblePercentage != 0, BuildingEarthquakeDeductiblePercentage / 100 * LocationBuildingLimit,\n\t        NULL\n\t    ),\n\t    BusinessType = 'SMARTbusiness', DECODE(\n\t        TRUE,\n\t        EarthquakeDeductiblePercentage != 0, EarthquakeDeductiblePercentage / 100 * v_LocationEarthquakeLimit,\n\t        NULL\n\t    ),\n\t    BusinessType = 'SBOP', DECODE(\n\t        TRUE,\n\t        BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage != 0, BuildingEarthquakeDeductiblePercentage / 100 * LocationBuildingLimit,\n\t        BPPEarthquakeDeductiblePercentage != 0 AND BuildingEarthquakeDeductiblePercentage = 0, BPPEarthquakeDeductiblePercentage / 100 * LocationContentsLimit,\n\t        BPPEarthquakeDeductiblePercentage = 0 AND BuildingEarthquakeDeductiblePercentage != 0, BuildingEarthquakeDeductiblePercentage / 100 * LocationBuildingLimit,\n\t        NULL\n\t    ),\n\t    NULL\n\t) AS v_LocationEarthquakeDeductible,\n\t-- *INF*: IIF(v_LocationEarthquakeDeductible=0, NULL, v_LocationEarthquakeDeductible)\n\tIFF(v_LocationEarthquakeDeductible = 0, NULL, v_LocationEarthquakeDeductible) AS o_LocationEarthquakeDeductible,\n\tAgencyCode AS o_AgencyCode,\n\tStrategicProfitCenterDescription AS o_StrategicProfitCenterDescription,\n\tInsuranceSegmentDescription AS o_InsuranceSegmentDescription,\n\tv_ActualLossSustainedCoverageFlag AS o_ActualLossSustainedCoverageFlag,\n\tInsuredName AS o_InsuredName,\n\tCustomerNumber AS o_CustomerNumber,\n\tPolicyEffectiveDate AS o_PolicyEffectiveDate,\n\tPolicyExpirationDate AS o_PolicyExpirationDate,\n\tOccupancyCode AS o_OccupancyCode,\n\tSicCode AS o_SicCode,\n\tv_TerrorismFlag AS o_TerrorismFlag,\n\tProcessDate AS o_ProcessDate,\n\tv_EliteFlag AS o_EliteFlag\n\tFROM JNR_Deductible\n\tLEFT JOIN LKP_WorkCatastropheExposureLimit_CPP_SBOP\n\tON LKP_WorkCatastropheExposureLimit_CPP_SBOP.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureLimit_CPP_SBOP.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureLimit_SMARTBlanket\n\tON LKP_WorkCatastropheExposureLimit_SMARTBlanket.PolicyKey = JNR_Deductible.PolicyKey\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_BalnketDeductible\n\tON LKP_WorkCatastropheExposureTransaction_BalnketDeductible.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_BalnketDeductible.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_ALS\n\tON LKP_WorkCatastropheExposureTransaction_CD_ALS.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_ALS.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_ALS.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_ALS.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty\n\tON LKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_BusinessPersonalProperty.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_Earthquake\n\tON LKP_WorkCatastropheExposureTransaction_CD_Earthquake.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_Earthquake.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_Earthquake.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_Earthquake.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding\n\tON LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBuilding.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty\n\tON LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakeBusinessPersonalProperty.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty\n\tON LKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CD_EarthquakePersonalProperty.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome\n\tON LKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_CGD_BusinessIncome.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_Earthquake\n\tON LKP_WorkCatastropheExposureTransaction_Earthquake.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_Earthquake.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_Earthquake.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_Earthquake.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_Elite\n\tON LKP_WorkCatastropheExposureTransaction_Elite.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_Elite.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_Essential\n\tON LKP_WorkCatastropheExposureTransaction_Essential.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_Essential.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium\n\tON LKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_LocationEarthquakePremium.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_PlusPak\n\tON LKP_WorkCatastropheExposureTransaction_PlusPak.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_PlusPak.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_PolicyBlanketPremium\n\tON LKP_WorkCatastropheExposureTransaction_PolicyBlanketPremium.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_PolicyBlanketPremium.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_Terrorism\n\tON LKP_WorkCatastropheExposureTransaction_Terrorism.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_Terrorism.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_Terrorism.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_Terrorism.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_WindCoverageFlag\n\tON LKP_WorkCatastropheExposureTransaction_WindCoverageFlag.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_WindCoverageFlag.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_WindCoverageFlag.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_WindCoverageFlag.BusinessType = JNR_Deductible.BusinessType\n\tLEFT JOIN LKP_WorkCatastropheExposureTransaction_YearBuilt\n\tON LKP_WorkCatastropheExposureTransaction_YearBuilt.PolicyKey = JNR_Deductible.PolicyKey AND LKP_WorkCatastropheExposureTransaction_YearBuilt.LocationNumber = JNR_Deductible.LocationNumber AND LKP_WorkCatastropheExposureTransaction_YearBuilt.BuildingNumber = JNR_Deductible.BuildingNumber AND LKP_WorkCatastropheExposureTransaction_YearBuilt.BusinessType = JNR_Deductible.BusinessType\n),\nFil_Null_Values AS (\n\tSELECT\n\to_AuditId AS AuditId, \n\to_CreatedDate AS CreatedDate, \n\to_ModifiedDate AS ModifiedDate, \n\to_SourceSystemId AS SourceSystemId, \n\to_PolicyKey AS PolicyKey, \n\to_LocationNumber AS LocationNumber, \n\to_BuildingNumber AS BuildingNumber, \n\to_BusinessType AS BusinessType, \n\to_InsuranceReferenceLegalEntityDescription AS InsuranceReferenceLegalEntityDescription, \n\to_PolicyBlanketPremium AS PolicyBlanketPremium, \n\to_PolicyBlanketLimit AS PolicyBlanketLimit, \n\to_PolicyBlanketDeductible AS PolicyBlanketDeductible, \n\to_RatingAddress AS RatingAddress, \n\to_RatingCity AS RatingCity, \n\to_RatingStateProvinceAbbreviation AS RatingStateProvinceAbbreviation, \n\to_RatingPostalCode AS RatingPostalCode, \n\to_RatingCounty AS RatingCounty, \n\to_ConstructionClass AS ConstructionClass, \n\to_YearBuilt AS YearBuilt, \n\to_BuildingPremium AS BuildingPremium, \n\to_LocationLimit AS LocationLimit, \n\to_LocationDeductible AS LocationDeductible, \n\to_LocationBuildingLimit AS LocationBuildingLimit, \n\to_LocationBuildingDeductible AS LocationBuildingDeductible, \n\to_LocationContentsLimit AS LocationContentsLimit, \n\to_LocationContentsDeductible AS LocationContentsDeductible, \n\to_LocationBILimit AS LocationBILimit, \n\to_LocationBIDeductible AS LocationBIDeductible, \n\to_PlusPakFlag AS PlusPakFlag, \n\to_AdjustedBuildingLimit AS AdjustedBuildingLimit, \n\to_AdjustedContentsLimit AS AdjustedContentsLimit, \n\to_AdjustedBILimit AS AdjustedBILimit, \n\to_AdjustedTotalInsuredValue AS AdjustedTotalInsuredValue, \n\to_LocationWindCoverageFlag AS LocationWindCoverageFlag, \n\to_LocationEarthquakeFlag AS LocationEarthquakeFlag, \n\to_LocationEarthquakePremium AS LocationEarthquakePremium, \n\to_LocationEarthquakeLimit AS LocationEarthquakeLimit, \n\to_LocationEarthquakeDeductible AS LocationEarthquakeDeductible, \n\to_AgencyCode AS AgencyCode, \n\to_StrategicProfitCenterDescription AS StrategicProfitCenterDescription, \n\to_InsuranceSegmentDescription AS InsuranceSegmentDescription, \n\to_ActualLossSustainedCoverageFlag AS ActualLossSustainedCoverageFlag, \n\to_InsuredName AS InsuredName, \n\to_CustomerNumber AS CustomerNumber, \n\to_PolicyEffectiveDate AS PolicyEffectiveDate, \n\to_PolicyExpirationDate AS PolicyExpirationDate, \n\to_OccupancyCode AS OccupancyCode, \n\to_SicCode AS SicCode, \n\to_TerrorismFlag AS TerrorismFlag, \n\to_ProcessDate AS ProcessDate, \n\to_Source_BuildingPremium AS Source_BuildingPremium, \n\to_EliteFlag AS EliteFlag\n\tFROM EXP_MetaData\n\tWHERE IIF(ISNULL(Source_BuildingPremium),0,Source_BuildingPremium)!=0\r\nOR\r\nIIF(ISNULL(LocationLimit),0,LocationLimit)!=0\r\nOR\r\nIIF(ISNULL(LocationDeductible),0,LocationDeductible)!=0 \r\nOR\r\nIIF(ISNULL(LocationBuildingLimit),0,LocationBuildingLimit)!=0\r\nOR\r\nIIF(ISNULL(LocationBuildingDeductible),0,LocationBuildingDeductible)!=0\r\nOR\r\nIIF(ISNULL(LocationContentsLimit),0,LocationContentsLimit)!=0 \r\nOR\r\nIIF(ISNULL(LocationContentsDeductible),0,LocationContentsDeductible)!=0 \r\nOR\r\nIIF(ISNULL(LocationBILimit),0,LocationBILimit)!=0 \r\nOR\r\nIIF(ISNULL(LocationBIDeductible),0,LocationBIDeductible)!=0\n),\nWorkCatastropheExposureBuilding AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureBuilding;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.WorkCatastropheExposureBuilding\n\t(AuditId, CreatedDate, ModifiedDate, SourceSystemId, PolicyKey, LocationNumber, BuildingNumber, BusinessType, InsuranceReferenceLegalEntityDescription, PolicyBlanketPremium, PolicyBlanketLimit, PolicyBlanketDeductible, RatingAddress, RatingCity, RatingStateProvinceAbbreviation, RatingPostalCode, RatingCounty, ConstructionClass, YearBuilt, BuildingPremium, LocationLimit, LocationDeductible, LocationBuildingLimit, LocationBuildingDeductible, LocationContentsLimit, LocationContentsDeductible, LocationBILimit, LocationBIDeductible, AdjustedBuildingLimit, AdjustedContentsLimit, AdjustedBILimit, AdjustedTotalInsuredValue, LocationWindCoverageFlag, LocationEarthquakeFlag, LocationEarthquakePremium, LocationEarthquakeLimit, LocationEarthquakeDeductible, AgencyCode, StrategicProfitCenterDescription, InsuranceSegmentDescription, PlusPakFlag, ActualLossSustainedCoverageFlag, InsuredName, CustomerNumber, PolicyEffectiveDate, PolicyExpirationDate, OccupancyCode, SicCode, TerrorismFlag, ProcessDate, EliteFlag)\n\tSELECT \n\tAUDITID, \n\tCREATEDDATE, \n\tMODIFIEDDATE, \n\tSOURCESYSTEMID, \n\tPOLICYKEY, \n\tLOCATIONNUMBER, \n\tBUILDINGNUMBER, \n\tBUSINESSTYPE, \n\tINSURANCEREFERENCELEGALENTITYDESCRIPTION, \n\tPOLICYBLANKETPREMIUM, \n\tPOLICYBLANKETLIMIT, \n\tPOLICYBLANKETDEDUCTIBLE, \n\tRATINGADDRESS, \n\tRATINGCITY, \n\tRATINGSTATEPROVINCEABBREVIATION, \n\tRATINGPOSTALCODE, \n\tRATINGCOUNTY, \n\tCONSTRUCTIONCLASS, \n\tYEARBUILT, \n\tBUILDINGPREMIUM, \n\tLOCATIONLIMIT, \n\tLOCATIONDEDUCTIBLE, \n\tLOCATIONBUILDINGLIMIT, \n\tLOCATIONBUILDINGDEDUCTIBLE, \n\tLOCATIONCONTENTSLIMIT, \n\tLOCATIONCONTENTSDEDUCTIBLE, \n\tLOCATIONBILIMIT, \n\tLOCATIONBIDEDUCTIBLE, \n\tADJUSTEDBUILDINGLIMIT, \n\tADJUSTEDCONTENTSLIMIT, \n\tADJUSTEDBILIMIT, \n\tADJUSTEDTOTALINSUREDVALUE, \n\tLOCATIONWINDCOVERAGEFLAG, \n\tLOCATIONEARTHQUAKEFLAG, \n\tLOCATIONEARTHQUAKEPREMIUM, \n\tLOCATIONEARTHQUAKELIMIT, \n\tLOCATIONEARTHQUAKEDEDUCTIBLE, \n\tAGENCYCODE, \n\tSTRATEGICPROFITCENTERDESCRIPTION, \n\tINSURANCESEGMENTDESCRIPTION, \n\tPLUSPAKFLAG, \n\tACTUALLOSSSUSTAINEDCOVERAGEFLAG, \n\tINSUREDNAME, \n\tCUSTOMERNUMBER, \n\tPOLICYEFFECTIVEDATE, \n\tPOLICYEXPIRATIONDATE, \n\tOCCUPANCYCODE, \n\tSICCODE, \n\tTERRORISMFLAG, \n\tPROCESSDATE, \n\tELITEFLAG\n\tFROM Fil_Null_Values\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "PROCESS_DATE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER_V2": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_CLAUSE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}