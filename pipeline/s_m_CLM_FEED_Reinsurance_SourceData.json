{
    "name": "s_m_CLM_FEED_Reinsurance_SourceData",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_FEED_Reinsurance_SourceData",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_Get_Max_Sapiens_SourceSequenceNumber AS (\n\tSELECT\n\tSource_Seq_Num,\n\tID\n\tFROM (\n\t\tSELECT MAX(A.SourceSequenceNumber) AS Source_Seq_Num,\r\n\t\t\t1 AS ID\r\n\t\tFROM (\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SapiensReinsurancePolicy\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.ArchSapiensReinsurancePolicy\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SapiensReinsuranceClaim\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.ArchSapiensReinsuranceClaim\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SapiensReinsuranceClaimRestate\r\n\t\t\tUNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.ArchSapiensReinsuranceClaimRestate\r\n\t\t       UNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.SapiensReinsurancePolicyRestate\r\n\t\t       UNION ALL\r\n\t\t\tSELECT isnull(max(SourceSequenceNumber), 999) AS SourceSequenceNumber\r\n\t\t\tFROM @{pipeline().parameters.TARGET_DATABASE_NAME}.@{pipeline().parameters.TARGET_TABLE_OWNER}.ArchSapiensReinsurancePolicyRestate\t) A\r\n\t\t\t--\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY ID ORDER BY Source_Seq_Num DESC) = 1\n),\nSQ_claim_loss_transaction_fact AS (\n\tdeclare @startDate date\r\n\tset @startDate = CASE WHEN '@{pipeline().parameters.PMSESSIONNAME}' LIKE '%Restate%' THEN '1800-01-01 00:00:00' ELSE CAST('@{pipeline().parameters.SELECTION_START_TS}' as date) END\r\n\t\r\n\tselect * \r\n\tfrom (SELECT \r\n\t\tCASE WHEN cod.claim_num = 'N/A' THEN SUBSTRING(cod.claim_occurrence_key, 1, 20) ELSE RTRIM(cod.claim_num) END as ClaimNumber,\r\n\t\tP.pol_key as PolicyKey,\r\n\t      P.pol_eff_date as pol_eff_date,\r\n\t\tIRD.ProductCode AS ProductCode,\r\n\t\tIRD.AccountingProductCode AS AccountingProductCode,\r\n\t\tIRD.StrategicProfitCenterAbbreviation,\r\n\t\tasld.asl_code AS ASLCode,\r\n\t\tCASE \r\n\t\t\tWHEN asl_code = '220' then '220'\r\n\t\t\tELSE CASE WHEN sub_asl_code = 'N/A' THEN '' ELSE sub_asl_code END\r\n\t\tEND AS SubASLCode,\r\n\t\tIRD.InsuranceReferenceLineOfBusinessCode,\r\n\t\tP.state_of_domicile_code AS RiskStateCode,\r\n\t\tcov.edw_claimant_cov_det_ak_id as SubClaim,\r\n\t\tcfint.financial_type_code as FinancialTypeCode,\r\n\t\tcfint.financial_type_code_descript as FinancialTypeCodeDescription,\r\n\t\tcov.cause_of_loss as CauseOfLoss,\r\n\t\tclmt.claimant_num as ClaimantNumber,\r\n\t\tclmt.claimant_full_name as ClaimantFullName,\r\n\t\tcod.claim_loss_date as ClaimLossDate,\r\n\t\tcod.claim_rpted_date as ClaimReportedDate,\r\n\t\tcod.claim_cat_code as ClaimCatastropheCode,\r\n\t\tcod.claim_cat_start_date as ClaimCatastropheStartDate,\r\n\t\tcod.claim_cat_end_date as ClaimCatastropheEndDate,\r\n\t\ttransdt.CalendarDate as ClaimTransactionDate,\r\n\t\tctyp.trans_code as TransactionCode,\r\n\t\tctyp.trans_code_descript as TransactionCodeDescription,\r\n\t\tcltf.trans_amt as TransactionAmount,\r\n\t\tcltf.trans_hist_amt as TransactionHistoryAmount,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss = '06'\t-- WC Medical Loss Paid (WCM)\r\n\t\t\t\tTHEN cltf.direct_loss_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as WorkersCompensationMedicalLossPaid,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss = '06'\t-- WC Medical Expense Paid (WME)\r\n\t\t\t\tTHEN cltf.direct_alae_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as WorkersCompensationMedicalExpensePaid,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss <> '06'\t-- WC Indemnity Expense Paid (WCE)\r\n\t\t\t\tTHEN cltf.direct_alae_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as WorkersCompensationIndemnityExpensePaid,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss <> '06'\t-- WC Indemnity Loss Paid (WCI)\r\n\t\t\t\tTHEN cltf.direct_loss_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as WorkersCompensationIndemnityLossPaid,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode <> '100'\t\t\t\t\t\t\t\t-- PC Expense Paid (EXP)\r\n\t\t\t\tTHEN cltf.direct_alae_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as PropertyCasualtyExpensePaid,\r\n\t\tCASE\r\n\t\t\tWHEN IRD.ProductCode <> '100'\t\t\t\t\t\t\t\t-- PC Loss Paid (IDM)\r\n\t\t\t\tTHEN cltf.direct_loss_paid_including_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND as PropertyCasualtyLossPaid,\r\n\t\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss = '06'\t-- WC Medical Loss Outstanding (OWM)\r\n\t\t\t\tTHEN cltf.direct_loss_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t\t) as WorkersCompensationMedicalLossOutstanding,\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss = '06'\t-- WC Medical Expense Outstanding (OWE)\r\n\t\t\t\tTHEN cltf.direct_alae_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t\t) as WorkersCompensationMedicalExpenseOutstanding,\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss <> '06'\t-- WC Indemnity Expense Outstanding (OWC)\r\n\t\t\t\tTHEN cltf.direct_alae_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t\t) as WorkersCompensationIndemnityExpenseOutstanding,\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode = '100' AND cov.cause_of_loss <> '06'\t-- WC Indemnity Loss Outstanding (OWI)\r\n\t\t\t\tTHEN cltf.direct_loss_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t\t) as WorkersCompensationIndemnityLossOutstanding,\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode <> '100'\t\t\t\t\t\t\t\t-- PC Expense Outstanding (OXP)\r\n\t\t\t\tTHEN cltf.direct_alae_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t\t) as PropertyCasualtyExpenseOutstanding,\r\n\t\r\n\t\tSUM(CASE\r\n\t\t\tWHEN IRD.ProductCode <> '100'\t\t\t\t\t\t\t\t-- PC Loss Outstanding (ODM)\r\n\t\t\t\tTHEN cltf.direct_loss_outstanding_excluding_recoveries\r\n\t\t\tELSE 0.0 \r\n\t\tEND) OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code  \r\n\t\t\t\tORDER BY cltf.claim_trans_date_id, cltf.edw_claim_trans_pk_id\r\n\t\t) as PropertyCasualtyLossOutstanding,\r\n\t\tcltf.edw_claim_trans_pk_id,\r\n\t\tCASE row_number() OVER (PARTITION BY cod.claim_num, P.pol_key, IRD.ProductCode, IRD.AccountingProductCode, IRD.StrategicProfitCenterAbbreviation, asld.asl_code, asld.sub_asl_code, IRD.InsuranceReferenceLineOfBusinessCode, P.state_of_domicile_code, cov.edw_claimant_cov_det_ak_id, cfint.financial_type_code\r\n\t\t\t\tORDER BY cltf.claim_trans_date_id desc, cltf.edw_claim_trans_pk_id desc) \r\n\t\t\tWHEN 1 THEN 1\r\n\t\t\tELSE 0\r\n\t\tEND as ContainsOutstandingReserveAmountFlag,\r\n\t\tcov.unit_descript,\r\n\t\tcov.LocationUnitNumber,\r\n\t\t(case when ISNUMERIC(cod.ClaimRelationshipKey)=1 then cod.ClaimRelationshipKey else NULL end) as ClaimRelationshipId,\r\n\t\tctyp.trans_ctgry_code as ClaimTransactionCategory,\r\n\t\tCASE LEN(RTRIM(cod.claim_occurrence_key)) \r\n\t\t\tWHEN 20 THEN 'EXCEED'\r\n\t\t\tWHEN 23 THEN 'PMS'\r\n\t\t\tELSE ''\r\n\t\tEND AS SourceSystemID\r\n\t\r\n\t\tFROM @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_loss_transaction_fact cltf with (nolock) \r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.policy_dim P with (nolock) ON cltf.pol_dim_id = P.pol_dim_id\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_transaction_type_dim ctyp with (nolock) ON cltf.claim_trans_type_dim_id = ctyp.claim_trans_type_dim_id \r\n\t\t\tAND ctyp.trans_kind_code = 'D'\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_financial_type_dim cfint with (nolock) ON cfint.claim_financial_type_dim_id = cltf.claim_financial_type_dim_id\r\n\t\t\tAND cfint.financial_type_code in ('D','E','S','R','B')\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claim_occurrence_dim cod with (nolock) ON cltf.claim_occurrence_dim_id = cod.claim_occurrence_dim_id\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_dim clmt with (nolock) ON cltf.claimant_dim_id = clmt.claimant_dim_id\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.claimant_coverage_dim cov with (nolock) ON cltf.claimant_cov_dim_id = cov.claimant_cov_dim_id\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.InsuranceReferenceDim IRD with (nolock) ON cltf.InsuranceReferenceDimId = IRD.InsuranceReferenceDimId\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.asl_dim asld with (nolock) ON cltf.asl_dim_id = asld.asl_dim_id\r\n\t\tINNER JOIN @{pipeline().parameters.SOURCE_DATABASE_NAME}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.calendar_dim transdt with (nolock) ON transdt.clndr_id = cltf.claim_trans_date_id\r\n\t\t@{pipeline().parameters.WHERE}\r\n\t) A \r\n\twhere A.ClaimTransactionDate >= @startDate\r\n\t@{pipeline().parameters.WHERE_ERROR}\n),\nEXP_Umbrella_layer AS (\n\tSELECT\n\tClaimNumber,\n\tPolicyKey,\n\tpol_eff_date,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\t-- *INF*: DECODE (true,\r\n\t-- ASLCode = '220',SubASLCode,\r\n\t-- ASLCode = '440',SubASLCode,\r\n\t-- ASLCode = '500',SubASLCode,\r\n\t-- pol_eff_date >= TO_DATE('2020-01-01','YYYY-MM-DD')  AND ClaimLossDate >= TO_DATE('2020-01-01','YYYY-MM-DD'),SubASLCode,\r\n\t-- PolicyKey = 'A08302003',SubASLCode,\r\n\t-- PolicyKey = 'NSP134447200',SubASLCode,\r\n\t-- PolicyKey = 'NAQ196857501',SubASLCode,\r\n\t-- PolicyKey = 'A24779000',SubASLCode,\r\n\t-- '')\r\n\t-- --all policies with claims whose losses are newer than 1/1/2020, asl codes of 220, 440, 500 and the above select policies\n\tDECODE(\n\t    true,\n\t    ASLCode = '220', SubASLCode,\n\t    ASLCode = '440', SubASLCode,\n\t    ASLCode = '500', SubASLCode,\n\t    pol_eff_date >= TO_TIMESTAMP('2020-01-01', 'YYYY-MM-DD') AND ClaimLossDate >= TO_TIMESTAMP('2020-01-01', 'YYYY-MM-DD'), SubASLCode,\n\t    PolicyKey = 'A08302003', SubASLCode,\n\t    PolicyKey = 'NSP134447200', SubASLCode,\n\t    PolicyKey = 'NAQ196857501', SubASLCode,\n\t    PolicyKey = 'A24779000', SubASLCode,\n\t    ''\n\t) AS o_SubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tcause_of_loss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tClaimTransactionDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tedw_claim_trans_pk_id AS ClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag,\n\tunit_descript AS i_unit_descript,\n\tLocationUnitNumber AS i_LocationUnitNumber,\n\t-- *INF*: DECODE(ProductCode,\r\n\t-- '900', i_LocationUnitNumber,\r\n\t-- '890', IIF(INSTR(i_unit_descript,'UMBRELLA')>0,\t\r\n\t--         LTRIM(RTRIM(SUBSTR(i_unit_descript,9)))\r\n\t-- \t\t)\r\n\t-- \t)\n\tDECODE(\n\t    ProductCode,\n\t    '900', i_LocationUnitNumber,\n\t    '890', IFF(\n\t        REGEXP_INSTR(i_unit_descript, 'UMBRELLA') > 0,\n\t        LTRIM(RTRIM(SUBSTR(i_unit_descript, 9)))\n\t    )\n\t) AS v_LayerForUmbrellaPolicies,\n\t-- *INF*: IIF(IN(ProductCode,'890','900')=1,\r\n\t--     IIF(LTRIM(RTRIM(v_LayerForUmbrellaPolicies))='',\r\n\t--         '1',\r\n\t--         LTRIM(RTRIM(v_LayerForUmbrellaPolicies))),\r\n\t--     NULL)\n\tIFF(\n\t    ProductCode IN ('890','900') = 1,\n\t    IFF(\n\t        LTRIM(RTRIM(v_LayerForUmbrellaPolicies)) = '', '1',\n\t        LTRIM(RTRIM(v_LayerForUmbrellaPolicies))\n\t    ),\n\t    NULL\n\t) AS v_ReinsuranceUmbrellaLayer,\n\t-- *INF*: IIF(Is_Number(v_ReinsuranceUmbrellaLayer),\r\n\t-- TO_INTEGER(RTRIM(v_ReinsuranceUmbrellaLayer)),\r\n\t-- NULL)\n\tIFF(\n\t    REGEXP_LIKE(v_ReinsuranceUmbrellaLayer, '^[0-9]+$'),\n\t    CAST(RTRIM(v_ReinsuranceUmbrellaLayer) AS INTEGER),\n\t    NULL\n\t) AS o_ReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory,\n\tSourceSystemID\n\tFROM SQ_claim_loss_transaction_fact\n),\nRTR_Reserves_Payments AS (\n\tSELECT\n\tClaimNumber,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\to_SubASLCode AS SubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tcause_of_loss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tClaimTransactionDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag,\n\to_ReinsuranceUmbrellaLayer AS ReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory,\n\tSourceSystemID\n\tFROM EXP_Umbrella_layer\n),\nRTR_Reserves_Payments_Reserves AS (SELECT * FROM RTR_Reserves_Payments WHERE (INDEXOF(TransactionCode,'40','41','42','65','66','90','91','92','95','97','98','99') > 0 \r\nor ContainsOutstandingReserveAmountFlag='1') \r\nAND \r\nINDEXOF(FinancialTypeCode,'D','E') > 0),\nRTR_Reserves_Payments_Payments AS (SELECT * FROM RTR_Reserves_Payments WHERE INDEXOF(TransactionCode,'40','41','42','65','66','90','91','92','95','97','98','99')=0),\nEXP_Payments AS (\n\tSELECT\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,\n\tSYSDATE AS CurrentDateTime,\n\tClaimNumber,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tcause_of_loss AS CauseOfLoss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tClaimTransactionDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\t'Payment' AS o_TransactionType,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tPaymentSourceSequenceNumber AS SourceSequenceNumber,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag AS ContainsOutstandingReserveAmountFlag2,\n\tReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory AS ClaimTransactionCategory3,\n\tSourceSystemID AS SourceSystemID3\n\tFROM RTR_Reserves_Payments_Payments\n),\nEXP_Reserves AS (\n\tSELECT\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AuditId,\n\tSYSDATE AS CurrentDateTime,\n\tClaimNumber,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tcause_of_loss AS CauseOfLoss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tClaimTransactionDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\t'Reserve' AS o_TransactionType,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tReserveSourceSequenceNumber AS SourceSequenceNumber,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag AS ContainsOutstandingReserveAmountFlag1,\n\tReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory AS ClaimTransactionCategory1,\n\tSourceSystemID AS SourceSystemID1\n\tFROM RTR_Reserves_Payments_Reserves\n),\nunion_payment_reserves AS (\n\tSELECT AuditId, CurrentDateTime, ClaimNumber, PolicyKey, ProductCode, AccountingProductCode, StrategicProfitCenterAbbreviation, ASLCode, SubASLCode, InsuranceReferenceLineOfBusinessCode, RiskStateCode, SubClaim, FinancialTypeCode, FinancialTypeCodeDescription, CauseOfLoss, ClaimantNumber, ClaimantFullName, ClaimLossDate, ClaimReportedDate, ClaimCatastropheCode, ClaimCatastropheStartDate, ClaimCatastropheEndDate, ClaimTransactionDate, TransactionCode, TransactionCodeDescription, o_TransactionType, TransactionAmount, TransactionHistoryAmount, SourceSequenceNumber, WorkersCompensationMedicalLossPaid, WorkersCompensationMedicalExpensePaid, WorkersCompensationIndemnityExpensePaid, WorkersCompensationIndemnityLossPaid, PropertyCasualtyExpensePaid, PropertyCasualtyLossPaid, WorkersCompensationMedicalLossOutstanding, WorkersCompensationMedicalExpenseOutstanding, WorkersCompensationIndemnityExpenseOutstanding, WorkersCompensationIndemnityLossOutstanding, PropertyCasualtyExpenseOutstanding, PropertyCasualtyLossOutstanding, ClaimTransactionPKId, ContainsOutstandingReserveAmountFlag2, ReinsuranceUmbrellaLayer, ClaimRelationshipId, ClaimTransactionCategory3, SourceSystemID3\n\tFROM EXP_Payments\n\tUNION\n\tSELECT AuditId, CurrentDateTime, ClaimNumber, PolicyKey, ProductCode, AccountingProductCode, StrategicProfitCenterAbbreviation, ASLCode, SubASLCode, InsuranceReferenceLineOfBusinessCode, RiskStateCode, SubClaim, FinancialTypeCode, FinancialTypeCodeDescription, CauseOfLoss, ClaimantNumber, ClaimantFullName, ClaimLossDate, ClaimReportedDate, ClaimCatastropheCode, ClaimCatastropheStartDate, ClaimCatastropheEndDate, ClaimTransactionDate, TransactionCode, TransactionCodeDescription, o_TransactionType, TransactionAmount, TransactionHistoryAmount, SourceSequenceNumber, WorkersCompensationMedicalLossPaid, WorkersCompensationMedicalExpensePaid, WorkersCompensationIndemnityExpensePaid, WorkersCompensationIndemnityLossPaid, PropertyCasualtyExpensePaid, PropertyCasualtyLossPaid, WorkersCompensationMedicalLossOutstanding, WorkersCompensationMedicalExpenseOutstanding, WorkersCompensationIndemnityExpenseOutstanding, WorkersCompensationIndemnityLossOutstanding, PropertyCasualtyExpenseOutstanding, PropertyCasualtyLossOutstanding, ClaimTransactionPKId, ContainsOutstandingReserveAmountFlag1 AS ContainsOutstandingReserveAmountFlag2, ReinsuranceUmbrellaLayer, ClaimRelationshipId, ClaimTransactionCategory1 AS ClaimTransactionCategory3, SourceSystemID1 AS SourceSystemID3\n\tFROM EXP_Reserves\n),\nsort_claim_subclaim AS (\n\tSELECT\n\tAuditId, \n\tCurrentDateTime, \n\tClaimNumber, \n\tPolicyKey, \n\tProductCode, \n\tAccountingProductCode, \n\tStrategicProfitCenterAbbreviation, \n\tASLCode, \n\tSubASLCode, \n\tInsuranceReferenceLineOfBusinessCode, \n\tRiskStateCode, \n\tSubClaim, \n\tFinancialTypeCode, \n\tFinancialTypeCodeDescription, \n\tCauseOfLoss, \n\tClaimantNumber, \n\tClaimantFullName, \n\tClaimLossDate, \n\tClaimReportedDate, \n\tClaimCatastropheCode, \n\tClaimCatastropheStartDate, \n\tClaimCatastropheEndDate, \n\tClaimTransactionDate AS Payment_TransactionDate, \n\tTransactionCode, \n\tTransactionCodeDescription, \n\to_TransactionType, \n\tTransactionAmount, \n\tTransactionHistoryAmount, \n\tSourceSequenceNumber, \n\tWorkersCompensationMedicalLossPaid, \n\tWorkersCompensationMedicalExpensePaid, \n\tWorkersCompensationIndemnityExpensePaid, \n\tWorkersCompensationIndemnityLossPaid, \n\tPropertyCasualtyExpensePaid, \n\tPropertyCasualtyLossPaid, \n\tWorkersCompensationMedicalLossOutstanding, \n\tWorkersCompensationMedicalExpenseOutstanding, \n\tWorkersCompensationIndemnityExpenseOutstanding, \n\tWorkersCompensationIndemnityLossOutstanding, \n\tPropertyCasualtyExpenseOutstanding, \n\tPropertyCasualtyLossOutstanding, \n\tClaimTransactionPKId, \n\tContainsOutstandingReserveAmountFlag2, \n\tReinsuranceUmbrellaLayer, \n\tClaimRelationshipId, \n\tClaimTransactionCategory3, \n\tSourceSystemID3\n\tFROM union_payment_reserves\n\tORDER BY ClaimNumber ASC, SubClaim ASC\n),\nexp_passthrough AS (\n\tSELECT\n\tAuditId,\n\tCurrentDateTime,\n\tClaimNumber,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tCauseOfLoss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tPayment_TransactionDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\to_TransactionType,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tSourceSequenceNumber,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag2,\n\tReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory3,\n\tSourceSystemID3\n\tFROM sort_claim_subclaim\n),\nagg_SubClaim_Transactiondate AS (\n\tSELECT\n\tClaimNumber,\n\tSubClaim,\n\tClaimTransactionDate,\n\t-- *INF*: max(ClaimTransactionDate)\n\tmax(ClaimTransactionDate) AS Reserve_TransactionDate\n\tFROM union_payment_reserves\n\tGROUP BY SubClaim\n),\nsort_claim_subclaim2 AS (\n\tSELECT\n\tClaimNumber, \n\tSubClaim, \n\tReserve_TransactionDate\n\tFROM agg_SubClaim_Transactiondate\n\tORDER BY ClaimNumber ASC, SubClaim ASC\n),\njnr_get_reserve_transaction_date AS (SELECT\n\tsort_claim_subclaim2.ClaimNumber, \n\tsort_claim_subclaim2.SubClaim, \n\tsort_claim_subclaim2.Reserve_TransactionDate, \n\texp_passthrough.AuditId, \n\texp_passthrough.CurrentDateTime, \n\texp_passthrough.ClaimNumber AS ClaimNumber1, \n\texp_passthrough.PolicyKey, \n\texp_passthrough.ProductCode, \n\texp_passthrough.AccountingProductCode, \n\texp_passthrough.StrategicProfitCenterAbbreviation, \n\texp_passthrough.ASLCode, \n\texp_passthrough.SubASLCode, \n\texp_passthrough.InsuranceReferenceLineOfBusinessCode, \n\texp_passthrough.RiskStateCode, \n\texp_passthrough.SubClaim AS SubClaim1, \n\texp_passthrough.FinancialTypeCode, \n\texp_passthrough.FinancialTypeCodeDescription, \n\texp_passthrough.CauseOfLoss, \n\texp_passthrough.ClaimantNumber, \n\texp_passthrough.ClaimantFullName, \n\texp_passthrough.ClaimLossDate, \n\texp_passthrough.ClaimReportedDate, \n\texp_passthrough.ClaimCatastropheCode, \n\texp_passthrough.ClaimCatastropheStartDate, \n\texp_passthrough.ClaimCatastropheEndDate, \n\texp_passthrough.Payment_TransactionDate, \n\texp_passthrough.TransactionCode, \n\texp_passthrough.TransactionCodeDescription, \n\texp_passthrough.o_TransactionType, \n\texp_passthrough.TransactionAmount, \n\texp_passthrough.TransactionHistoryAmount, \n\texp_passthrough.SourceSequenceNumber, \n\texp_passthrough.WorkersCompensationMedicalLossPaid, \n\texp_passthrough.WorkersCompensationMedicalExpensePaid, \n\texp_passthrough.WorkersCompensationIndemnityExpensePaid, \n\texp_passthrough.WorkersCompensationIndemnityLossPaid, \n\texp_passthrough.PropertyCasualtyExpensePaid, \n\texp_passthrough.PropertyCasualtyLossPaid, \n\texp_passthrough.WorkersCompensationMedicalLossOutstanding, \n\texp_passthrough.WorkersCompensationMedicalExpenseOutstanding, \n\texp_passthrough.WorkersCompensationIndemnityExpenseOutstanding, \n\texp_passthrough.WorkersCompensationIndemnityLossOutstanding, \n\texp_passthrough.PropertyCasualtyExpenseOutstanding, \n\texp_passthrough.PropertyCasualtyLossOutstanding, \n\texp_passthrough.ClaimTransactionPKId, \n\texp_passthrough.ContainsOutstandingReserveAmountFlag2, \n\texp_passthrough.ReinsuranceUmbrellaLayer, \n\texp_passthrough.ClaimRelationshipId, \n\texp_passthrough.ClaimTransactionCategory3, \n\texp_passthrough.SourceSystemID3\n\tFROM exp_passthrough\n\tINNER JOIN sort_claim_subclaim2\n\tON sort_claim_subclaim2.ClaimNumber = exp_passthrough.ClaimNumber AND sort_claim_subclaim2.SubClaim = exp_passthrough.SubClaim\n),\nexp_transacion_date_calculation AS (\n\tSELECT\n\tAuditId,\n\tCurrentDateTime,\n\tClaimNumber1,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim1,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tCauseOfLoss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tTransactionCode,\n\tTransactionCodeDescription,\n\to_TransactionType,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tSourceSequenceNumber,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag2,\n\tReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory3,\n\tSourceSystemID3,\n\tReserve_TransactionDate,\n\tPayment_TransactionDate,\n\t-- *INF*: IIF(o_TransactionType='Reserve',Reserve_TransactionDate,Payment_TransactionDate)\n\tIFF(o_TransactionType = 'Reserve', Reserve_TransactionDate, Payment_TransactionDate) AS v_Claim_TransactionDate,\n\tv_Claim_TransactionDate AS Claim_TransactionDate\n\tFROM jnr_get_reserve_transaction_date\n),\nsort_transactiondate_pkid AS (\n\tSELECT\n\tAuditId, \n\tCurrentDateTime, \n\tClaimNumber1 AS ClaimNumber, \n\tPolicyKey, \n\tProductCode, \n\tAccountingProductCode, \n\tStrategicProfitCenterAbbreviation, \n\tASLCode, \n\tSubASLCode, \n\tInsuranceReferenceLineOfBusinessCode, \n\tRiskStateCode, \n\tSubClaim1 AS SubClaim, \n\tFinancialTypeCode, \n\tFinancialTypeCodeDescription, \n\tCauseOfLoss, \n\tClaimantNumber, \n\tClaimantFullName, \n\tClaimLossDate, \n\tClaimReportedDate, \n\tClaimCatastropheCode, \n\tClaimCatastropheStartDate, \n\tClaimCatastropheEndDate, \n\tClaim_TransactionDate, \n\tTransactionCode, \n\tTransactionCodeDescription, \n\to_TransactionType, \n\tTransactionAmount, \n\tTransactionHistoryAmount, \n\tSourceSequenceNumber, \n\tWorkersCompensationMedicalLossPaid, \n\tWorkersCompensationMedicalExpensePaid, \n\tWorkersCompensationIndemnityExpensePaid, \n\tWorkersCompensationIndemnityLossPaid, \n\tPropertyCasualtyExpensePaid, \n\tPropertyCasualtyLossPaid, \n\tWorkersCompensationMedicalLossOutstanding, \n\tWorkersCompensationMedicalExpenseOutstanding, \n\tWorkersCompensationIndemnityExpenseOutstanding, \n\tWorkersCompensationIndemnityLossOutstanding, \n\tPropertyCasualtyExpenseOutstanding, \n\tPropertyCasualtyLossOutstanding, \n\tClaimTransactionPKId, \n\tContainsOutstandingReserveAmountFlag2, \n\tReinsuranceUmbrellaLayer, \n\tClaimRelationshipId, \n\tClaimTransactionCategory3, \n\tSourceSystemID3\n\tFROM exp_transacion_date_calculation\n\tORDER BY Claim_TransactionDate ASC, ClaimTransactionPKId ASC\n),\nexp_calculate_SSN AS (\n\tSELECT\n\tAuditId,\n\tCurrentDateTime,\n\tClaimNumber,\n\tPolicyKey,\n\tProductCode,\n\tAccountingProductCode,\n\tStrategicProfitCenterAbbreviation,\n\tASLCode,\n\tSubASLCode,\n\tInsuranceReferenceLineOfBusinessCode,\n\tRiskStateCode,\n\tSubClaim,\n\tFinancialTypeCode,\n\tFinancialTypeCodeDescription,\n\tCauseOfLoss,\n\tClaimantNumber,\n\tClaimantFullName,\n\tClaimLossDate,\n\tClaimReportedDate,\n\tClaimCatastropheCode,\n\tClaimCatastropheStartDate,\n\tClaimCatastropheEndDate,\n\tClaim_TransactionDate AS Reserve_TransactionDate,\n\tTransactionCode,\n\t-- *INF*: IIF(ISNULL(:LKP.LKP_Get_Max_Sapiens_SourceSequenceNumber(1)),\r\n\t-- \t0,\r\n\t-- \t:LKP.LKP_Get_Max_Sapiens_SourceSequenceNumber(1))\n\tIFF(\n\t    LKP_GET_MAX_SAPIENS_SOURCESEQUENCENUMBER_1.Source_Seq_Num IS NULL, 0,\n\t    LKP_GET_MAX_SAPIENS_SOURCESEQUENCENUMBER_1.Source_Seq_Num\n\t) AS v_lkp_Source_Seq_Num,\n\tv_count+1 AS v_count,\n\t-- *INF*: iif(o_TransactionType='Reserve' OR  \r\n\t-- o_TransactionType='Payment',\r\n\t-- \tv_lkp_Source_Seq_Num + v_count,-1)\n\tIFF(\n\t    o_TransactionType = 'Reserve' OR o_TransactionType = 'Payment',\n\t    v_lkp_Source_Seq_Num + v_count,\n\t    - 1\n\t) AS o_SourceSequenceNumber,\n\tTransactionCodeDescription,\n\to_TransactionType,\n\tTransactionAmount,\n\tTransactionHistoryAmount,\n\tSourceSequenceNumber,\n\tWorkersCompensationMedicalLossPaid,\n\tWorkersCompensationMedicalExpensePaid,\n\tWorkersCompensationIndemnityExpensePaid,\n\tWorkersCompensationIndemnityLossPaid,\n\tPropertyCasualtyExpensePaid,\n\tPropertyCasualtyLossPaid,\n\tWorkersCompensationMedicalLossOutstanding,\n\tWorkersCompensationMedicalExpenseOutstanding,\n\tWorkersCompensationIndemnityExpenseOutstanding,\n\tWorkersCompensationIndemnityLossOutstanding,\n\tPropertyCasualtyExpenseOutstanding,\n\tPropertyCasualtyLossOutstanding,\n\tClaimTransactionPKId,\n\tContainsOutstandingReserveAmountFlag2,\n\tReinsuranceUmbrellaLayer,\n\tClaimRelationshipId,\n\tClaimTransactionCategory3,\n\tSourceSystemID3\n\tFROM sort_transactiondate_pkid\n\tLEFT JOIN LKP_GET_MAX_SAPIENS_SOURCESEQUENCENUMBER LKP_GET_MAX_SAPIENS_SOURCESEQUENCENUMBER_1\n\tON LKP_GET_MAX_SAPIENS_SOURCESEQUENCENUMBER_1.ID = 1\n\n),\nSapiensReinsuranceClaim AS (\n\tINSERT INTO SapiensReinsuranceClaim\n\t(AuditId, CreatedDate, ClaimNumber, PolicyKey, ProductCode, AccountingProductCode, StrategicProfitCenterAbbreviation, ASLCode, SubASLCode, InsuranceReferenceLineOfBusinessCode, RiskStateCode, SubClaim, FinancialTypeCode, FinancialTypeCodeDescription, CauseOfLoss, ClaimantNumber, ClaimantFullName, ClaimLossDate, ClaimReportedDate, ClaimCatastropheCode, ClaimCatastropheStartDate, ClaimCatastropheEndDate, ClaimTransactionDate, TransactionCode, TransactionCodeDescription, TransactionType, TransactionAmount, TransactionHistoryAmount, SourceSequenceNumber, TransactionNumber, WorkersCompensationMedicalLossPaid, WorkersCompensationMedicalExpensePaid, WorkersCompensationIndemnityExpensePaid, WorkersCompensationIndemnityLossPaid, PropertyCasualtyExpensePaid, PropertyCasualtyLossPaid, WorkersCompensationMedicalLossOutstanding, WorkersCompensationMedicalExpenseOutstanding, WorkersCompensationIndemnityExpenseOutstanding, WorkersCompensationIndemnityLossOutstanding, PropertyCasualtyExpenseOutstanding, PropertyCasualtyLossOutstanding, ClaimTransactionPKId, ContainsOutstandingReserveAmountFlag, ReinsuranceUmbrellaLayer, ClaimRelationshipId, ClaimTransactionCategory, SourceSystemID)\n\tSELECT \n\tAUDITID, \n\tCurrentDateTime AS CREATEDDATE, \n\tCLAIMNUMBER, \n\tPOLICYKEY, \n\tPRODUCTCODE, \n\tACCOUNTINGPRODUCTCODE, \n\tSTRATEGICPROFITCENTERABBREVIATION, \n\tASLCODE, \n\tSUBASLCODE, \n\tINSURANCEREFERENCELINEOFBUSINESSCODE, \n\tRISKSTATECODE, \n\tSUBCLAIM, \n\tFINANCIALTYPECODE, \n\tFINANCIALTYPECODEDESCRIPTION, \n\tCAUSEOFLOSS, \n\tCLAIMANTNUMBER, \n\tCLAIMANTFULLNAME, \n\tCLAIMLOSSDATE, \n\tCLAIMREPORTEDDATE, \n\tCLAIMCATASTROPHECODE, \n\tCLAIMCATASTROPHESTARTDATE, \n\tCLAIMCATASTROPHEENDDATE, \n\tReserve_TransactionDate AS CLAIMTRANSACTIONDATE, \n\tTRANSACTIONCODE, \n\tTRANSACTIONCODEDESCRIPTION, \n\to_TransactionType AS TRANSACTIONTYPE, \n\tTRANSACTIONAMOUNT, \n\tTRANSACTIONHISTORYAMOUNT, \n\to_SourceSequenceNumber AS SOURCESEQUENCENUMBER, \n\to_SourceSequenceNumber AS TRANSACTIONNUMBER, \n\tWORKERSCOMPENSATIONMEDICALLOSSPAID, \n\tWORKERSCOMPENSATIONMEDICALEXPENSEPAID, \n\tWORKERSCOMPENSATIONINDEMNITYEXPENSEPAID, \n\tWORKERSCOMPENSATIONINDEMNITYLOSSPAID, \n\tPROPERTYCASUALTYEXPENSEPAID, \n\tPROPERTYCASUALTYLOSSPAID, \n\tWORKERSCOMPENSATIONMEDICALLOSSOUTSTANDING, \n\tWORKERSCOMPENSATIONMEDICALEXPENSEOUTSTANDING, \n\tWORKERSCOMPENSATIONINDEMNITYEXPENSEOUTSTANDING, \n\tWORKERSCOMPENSATIONINDEMNITYLOSSOUTSTANDING, \n\tPROPERTYCASUALTYEXPENSEOUTSTANDING, \n\tPROPERTYCASUALTYLOSSOUTSTANDING, \n\tCLAIMTRANSACTIONPKID, \n\tContainsOutstandingReserveAmountFlag2 AS CONTAINSOUTSTANDINGRESERVEAMOUNTFLAG, \n\tREINSURANCEUMBRELLALAYER, \n\tCLAIMRELATIONSHIPID, \n\tClaimTransactionCategory3 AS CLAIMTRANSACTIONCATEGORY, \n\tSourceSystemID3 AS SOURCESYSTEMID\n\tFROM exp_calculate_SSN\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "PMSESSIONNAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_DATABASE_NAME": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WHERE_ERROR": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "PolicyDataServices/"
        },
        "annotations": []
    }
}