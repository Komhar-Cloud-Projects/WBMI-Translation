{
    "name": "s_m_CMN_DW_Load_SystemCoverage",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_DW_Load_SystemCoverage",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_SystemCoverage AS (\n\tSELECT\n\t\tSystemCoverageId,\n\t\tCreatedDate,\n\t\tModifiedDate,\n\t\tConformedCoverageId,\n\t\tInsuranceLineCode,\n\t\tInsuranceLineDescription,\n\t\tSourceSystemId,\n\t\tDctRiskTypeCode,\n\t\tDctCoverageTypeCode,\n\t\tPmsRiskUnitGroupCode,\n\t\tPmsRiskUnitGroupDescription,\n\t\tPmsRiskUnitCode,\n\t\tPmsRiskUnitDescription,\n\t\tPmsMajorPerilCode,\n\t\tPmsMajorPerilDescription,\n\t\tPmsProductTypeCode,\n\t\tDctPerilGroup,\n\t\tDctSubCoverageTypeCode,\n\t\tDctCoverageVersion,\n\t\tLossHistoryCode,\n\t\tLossHistoryDescription,\n\t\tISOMajorCrimeGroup\n\tFROM SystemCoverage\n\tWHERE SystemCoverage.SystemCoverageId is not null\n),\nEXP_Values AS (\n\tSELECT\n\tSystemCoverageId AS i_SystemCoverageId,\n\tCreatedDate AS i_CreatedDate,\n\tModifiedDate AS i_ModifiedDate,\n\tConformedCoverageId AS i_ConformedCoverageId,\n\tInsuranceLineCode AS i_InsuranceLineCode,\n\tInsuranceLineDescription AS i_InsuranceLineDescription,\n\tSourceSystemId AS i_SourceSystemId,\n\tDctRiskTypeCode AS i_DctRiskTypeCode,\n\tDctCoverageTypeCode AS i_DctCoverageTypeCode,\n\tPmsRiskUnitGroupCode AS i_PmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription AS i_PmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode AS i_PmsRiskUnitCode,\n\tPmsRiskUnitDescription AS i_PmsRiskUnitDescription,\n\tPmsMajorPerilCode AS i_PmsMajorPerilCode,\n\tPmsMajorPerilDescription AS i_PmsMajorPerilDescription,\n\tPmsProductTypeCode AS i_PmsProductTypeCode,\n\tDctPerilGroup AS i_DctPerilGroup,\n\tDctSubCoverageTypeCode AS i_DctSubCoverageTypeCode,\n\tDctCoverageVersion AS i_DctCoverageVersion,\n\tLossHistoryCode AS i_LossHistoryCode,\n\tLossHistoryDescription AS i_LossHistoryDescription,\n\tISOMajorCrimeGroup AS i_ISOMajorCrimeGroup,\n\ti_SystemCoverageId AS o_SystemCoverageId,\n\t-- *INF*: IIF(ISNULL(i_ConformedCoverageId), -99, i_ConformedCoverageId)\n\tIFF(i_ConformedCoverageId IS NULL, - 99, i_ConformedCoverageId) AS o_ConformedCoverageId,\n\t-- *INF*: IIF(ISNULL(i_InsuranceLineCode) OR LENGTH(i_InsuranceLineCode)=0 OR IS_SPACES(i_InsuranceLineCode), 'N/A', LTRIM(RTRIM(i_InsuranceLineCode)))\n\tIFF(\n\t    i_InsuranceLineCode IS NULL\n\t    or LENGTH(i_InsuranceLineCode) = 0\n\t    or LENGTH(i_InsuranceLineCode)>0\n\t    and TRIM(i_InsuranceLineCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_InsuranceLineCode))\n\t) AS o_InsuranceLineCode,\n\t-- *INF*: IIF(ISNULL(i_InsuranceLineDescription) OR LENGTH(i_InsuranceLineDescription)=0 OR IS_SPACES(i_InsuranceLineDescription), 'Not Applicable', LTRIM(RTRIM(i_InsuranceLineDescription)))\n\tIFF(\n\t    i_InsuranceLineDescription IS NULL\n\t    or LENGTH(i_InsuranceLineDescription) = 0\n\t    or LENGTH(i_InsuranceLineDescription)>0\n\t    and TRIM(i_InsuranceLineDescription)='',\n\t    'Not Applicable',\n\t    LTRIM(RTRIM(i_InsuranceLineDescription))\n\t) AS o_InsuranceLineDescription,\n\t-- *INF*: IIF(ISNULL(i_SourceSystemId) OR LENGTH(i_SourceSystemId)=0 OR IS_SPACES(i_SourceSystemId), 'N/A', LTRIM(RTRIM(i_SourceSystemId)))\n\tIFF(\n\t    i_SourceSystemId IS NULL\n\t    or LENGTH(i_SourceSystemId) = 0\n\t    or LENGTH(i_SourceSystemId)>0\n\t    and TRIM(i_SourceSystemId)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_SourceSystemId))\n\t) AS o_SourceSystemId,\n\t-- *INF*: IIF(ISNULL(i_DctRiskTypeCode) OR LENGTH(i_DctRiskTypeCode)=0 OR IS_SPACES(i_DctRiskTypeCode), 'N/A', LTRIM(RTRIM(i_DctRiskTypeCode)))\n\tIFF(\n\t    i_DctRiskTypeCode IS NULL\n\t    or LENGTH(i_DctRiskTypeCode) = 0\n\t    or LENGTH(i_DctRiskTypeCode)>0\n\t    and TRIM(i_DctRiskTypeCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_DctRiskTypeCode))\n\t) AS o_DctRiskTypeCode,\n\t-- *INF*: IIF(ISNULL(i_DctCoverageTypeCode) OR LENGTH(i_DctCoverageTypeCode)=0 OR IS_SPACES(i_DctCoverageTypeCode), 'N/A', LTRIM(RTRIM(i_DctCoverageTypeCode)))\n\tIFF(\n\t    i_DctCoverageTypeCode IS NULL\n\t    or LENGTH(i_DctCoverageTypeCode) = 0\n\t    or LENGTH(i_DctCoverageTypeCode)>0\n\t    and TRIM(i_DctCoverageTypeCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_DctCoverageTypeCode))\n\t) AS o_DctCoverageTypeCode,\n\t-- *INF*: IIF(ISNULL(i_PmsRiskUnitGroupCode) OR LENGTH(i_PmsRiskUnitGroupCode)=0 OR IS_SPACES(i_PmsRiskUnitGroupCode), 'N/A', LTRIM(RTRIM(i_PmsRiskUnitGroupCode)))\n\tIFF(\n\t    i_PmsRiskUnitGroupCode IS NULL\n\t    or LENGTH(i_PmsRiskUnitGroupCode) = 0\n\t    or LENGTH(i_PmsRiskUnitGroupCode)>0\n\t    and TRIM(i_PmsRiskUnitGroupCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_PmsRiskUnitGroupCode))\n\t) AS o_PmsRiskUnitGroupCode,\n\t-- *INF*: IIF(ISNULL(i_PmsRiskUnitGroupDescription) OR LENGTH(i_PmsRiskUnitGroupDescription)=0 OR IS_SPACES(i_PmsRiskUnitGroupDescription), 'Not Applicable', LTRIM(RTRIM(i_PmsRiskUnitGroupDescription)))\n\tIFF(\n\t    i_PmsRiskUnitGroupDescription IS NULL\n\t    or LENGTH(i_PmsRiskUnitGroupDescription) = 0\n\t    or LENGTH(i_PmsRiskUnitGroupDescription)>0\n\t    and TRIM(i_PmsRiskUnitGroupDescription)='',\n\t    'Not Applicable',\n\t    LTRIM(RTRIM(i_PmsRiskUnitGroupDescription))\n\t) AS o_PmsRiskUnitGroupDescription,\n\t-- *INF*: IIF(ISNULL(i_PmsRiskUnitCode) OR LENGTH(i_PmsRiskUnitCode)=0 OR IS_SPACES(i_PmsRiskUnitCode), 'N/A', LTRIM(RTRIM(i_PmsRiskUnitCode)))\n\tIFF(\n\t    i_PmsRiskUnitCode IS NULL\n\t    or LENGTH(i_PmsRiskUnitCode) = 0\n\t    or LENGTH(i_PmsRiskUnitCode)>0\n\t    and TRIM(i_PmsRiskUnitCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_PmsRiskUnitCode))\n\t) AS o_PmsRiskUnitCode,\n\t-- *INF*: IIF(ISNULL(i_PmsRiskUnitDescription) OR LENGTH(i_PmsRiskUnitDescription)=0 OR IS_SPACES(i_PmsRiskUnitDescription), 'Not Applicable', LTRIM(RTRIM(i_PmsRiskUnitDescription)))\n\tIFF(\n\t    i_PmsRiskUnitDescription IS NULL\n\t    or LENGTH(i_PmsRiskUnitDescription) = 0\n\t    or LENGTH(i_PmsRiskUnitDescription)>0\n\t    and TRIM(i_PmsRiskUnitDescription)='',\n\t    'Not Applicable',\n\t    LTRIM(RTRIM(i_PmsRiskUnitDescription))\n\t) AS o_PmsRiskUnitDescription,\n\t-- *INF*: IIF(ISNULL(i_PmsMajorPerilCode) OR LENGTH(i_PmsMajorPerilCode)=0 OR IS_SPACES(i_PmsMajorPerilCode), 'N/A', LTRIM(RTRIM(i_PmsMajorPerilCode)))\n\tIFF(\n\t    i_PmsMajorPerilCode IS NULL\n\t    or LENGTH(i_PmsMajorPerilCode) = 0\n\t    or LENGTH(i_PmsMajorPerilCode)>0\n\t    and TRIM(i_PmsMajorPerilCode)='',\n\t    'N/A',\n\t    LTRIM(RTRIM(i_PmsMajorPerilCode))\n\t) AS o_PmsMajorPerilCode,\n\t-- *INF*: IIF(ISNULL(i_PmsMajorPerilDescription) OR LENGTH(i_PmsMajorPerilDescription)=0 OR IS_SPACES(i_PmsMajorPerilDescription), 'Not Applicable', LTRIM(RTRIM(i_PmsMajorPerilDescription)))\n\tIFF(\n\t    i_PmsMajorPerilDescription IS NULL\n\t    or LENGTH(i_PmsMajorPerilDescription) = 0\n\t    or LENGTH(i_PmsMajorPerilDescription)>0\n\t    and TRIM(i_PmsMajorPerilDescription)='',\n\t    'Not Applicable',\n\t    LTRIM(RTRIM(i_PmsMajorPerilDescription))\n\t) AS o_PmsMajorPerilDescription,\n\t-- *INF*: IIF(ISNULL(i_PmsProductTypeCode), 'N/A',LTRIM(RTRIM(i_PmsProductTypeCode)))\n\tIFF(i_PmsProductTypeCode IS NULL, 'N/A', LTRIM(RTRIM(i_PmsProductTypeCode))) AS o_PmsProductTypeCode,\n\t-- *INF*: IIF(ISNULL(i_DctPerilGroup),'N/A',i_DctPerilGroup)\n\tIFF(i_DctPerilGroup IS NULL, 'N/A', i_DctPerilGroup) AS o_DctPerilGroup,\n\t-- *INF*: IIF(ISNULL(i_DctSubCoverageTypeCode), 'N/A', i_DctSubCoverageTypeCode)\n\tIFF(i_DctSubCoverageTypeCode IS NULL, 'N/A', i_DctSubCoverageTypeCode) AS o_DctSubCoverageTypeCode,\n\t-- *INF*: IIF(ISNULL(i_DctCoverageVersion), 'N/A', i_DctCoverageVersion)\n\tIFF(i_DctCoverageVersion IS NULL, 'N/A', i_DctCoverageVersion) AS o_DctCoverageVersion,\n\t-- *INF*: IIF(ISNULL(i_LossHistoryCode), 'N/A', i_LossHistoryCode)\n\tIFF(i_LossHistoryCode IS NULL, 'N/A', i_LossHistoryCode) AS o_LossHistoryCode,\n\t-- *INF*: IIF(ISNULL(i_LossHistoryDescription), 'N/A', i_LossHistoryDescription)\n\tIFF(i_LossHistoryDescription IS NULL, 'N/A', i_LossHistoryDescription) AS o_LossHistoryDescription,\n\t-- *INF*: IIF(ISNULL(i_ISOMajorCrimeGroup)OR IS_SPACES(i_ISOMajorCrimeGroup)OR LENGTH(i_ISOMajorCrimeGroup)=0,'N/A',LTRIM(RTRIM(i_ISOMajorCrimeGroup)))\n\tIFF(\n\t    i_ISOMajorCrimeGroup IS NULL\n\t    or LENGTH(i_ISOMajorCrimeGroup)>0\n\t    and TRIM(i_ISOMajorCrimeGroup)=''\n\t    or LENGTH(i_ISOMajorCrimeGroup) = 0,\n\t    'N/A',\n\t    LTRIM(RTRIM(i_ISOMajorCrimeGroup))\n\t) AS o_ISOMajorCrimeGroup\n\tFROM SQ_SystemCoverage\n),\nLKP_SystemCoverage AS (\n\tSELECT\n\tSystemCoverageId,\n\tConformedCoverageId,\n\tInsuranceLineDescription,\n\tSourceSystemId,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilDescription,\n\tLossHistoryCode,\n\tLossHistoryDescription,\n\tISOMajorCrimeGroup,\n\tInsuranceLineCode,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitCode,\n\tPmsMajorPerilCode,\n\tPmsProductTypeCode,\n\tDctPerilGroup,\n\tDctSubCoverageTypeCode,\n\tDctCoverageVersion\n\tFROM (\n\t\tSELECT \n\t\t\tSystemCoverageId,\n\t\t\tConformedCoverageId,\n\t\t\tInsuranceLineDescription,\n\t\t\tSourceSystemId,\n\t\t\tPmsRiskUnitGroupDescription,\n\t\t\tPmsRiskUnitDescription,\n\t\t\tPmsMajorPerilDescription,\n\t\t\tLossHistoryCode,\n\t\t\tLossHistoryDescription,\n\t\t\tISOMajorCrimeGroup,\n\t\t\tInsuranceLineCode,\n\t\t\tDctRiskTypeCode,\n\t\t\tDctCoverageTypeCode,\n\t\t\tPmsRiskUnitGroupCode,\n\t\t\tPmsRiskUnitCode,\n\t\t\tPmsMajorPerilCode,\n\t\t\tPmsProductTypeCode,\n\t\t\tDctPerilGroup,\n\t\t\tDctSubCoverageTypeCode,\n\t\t\tDctCoverageVersion\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.SystemCoverage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY InsuranceLineCode,DctRiskTypeCode,DctCoverageTypeCode,PmsRiskUnitGroupCode,PmsRiskUnitCode,PmsMajorPerilCode,PmsProductTypeCode,DctPerilGroup,DctSubCoverageTypeCode,DctCoverageVersion ORDER BY SystemCoverageId) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tLKP_SystemCoverage.SystemCoverageId AS lkp_ExistingSystemCoverageId,\n\tLKP_SystemCoverage.ConformedCoverageId AS lkp_ExistingConformedCoverageId,\n\tLKP_SystemCoverage.InsuranceLineDescription AS lkp_InsuranceLineDescription,\n\tLKP_SystemCoverage.SourceSystemId AS lkp_SourceSystemId,\n\tLKP_SystemCoverage.PmsRiskUnitGroupDescription AS lkp_PmsRiskUnitGroupDescription,\n\tLKP_SystemCoverage.PmsRiskUnitDescription AS lkp_PmsRiskUnitDescription,\n\tLKP_SystemCoverage.PmsMajorPerilDescription AS lkp_PmsMajorPerilDescription,\n\tLKP_SystemCoverage.LossHistoryCode AS lkp_LossHistoryCode,\n\tLKP_SystemCoverage.LossHistoryDescription AS lkp_LossHistoryDescription,\n\tLKP_SystemCoverage.ISOMajorCrimeGroup AS lkp_ISOMajorCrimeGroup,\n\tEXP_Values.o_SystemCoverageId AS new_SystemCoverageId,\n\tEXP_Values.o_ConformedCoverageId AS new_ConformedCoverageId,\n\tEXP_Values.o_InsuranceLineCode AS InsuranceLineCode,\n\tEXP_Values.o_InsuranceLineDescription AS InsuranceLineDescription,\n\tEXP_Values.o_SourceSystemId AS SourceSystemId,\n\tEXP_Values.o_DctRiskTypeCode AS DctRiskTypeCode,\n\tEXP_Values.o_DctCoverageTypeCode AS DctCoverageTypeCode,\n\tEXP_Values.o_PmsRiskUnitGroupCode AS PmsRiskUnitGroupCode,\n\tEXP_Values.o_PmsRiskUnitGroupDescription AS PmsRiskUnitGroupDescription,\n\tEXP_Values.o_PmsRiskUnitCode AS PmsRiskUnitCode,\n\tEXP_Values.o_PmsRiskUnitDescription AS PmsRiskUnitDescription,\n\tEXP_Values.o_PmsMajorPerilCode AS PmsMajorPerilCode,\n\tEXP_Values.o_PmsMajorPerilDescription AS PmsMajorPerilDescription,\n\tEXP_Values.o_PmsProductTypeCode AS PmsProductTypeCode,\n\tEXP_Values.o_DctPerilGroup AS DctPerilGroup,\n\tEXP_Values.o_DctSubCoverageTypeCode AS DctSubCoverageTypeCode,\n\tEXP_Values.o_DctCoverageVersion AS DctCoverageVersion,\n\tEXP_Values.o_LossHistoryCode AS LossHistoryCode,\n\tEXP_Values.o_LossHistoryDescription AS LossHistoryDescription,\n\tEXP_Values.o_ISOMajorCrimeGroup AS ISOMajorCrimeGroup,\n\t-- *INF*: IIF(ISNULL(new_ConformedCoverageId), lkp_ExistingConformedCoverageId, new_ConformedCoverageId)\n\tIFF(\n\t    new_ConformedCoverageId IS NULL, lkp_ExistingConformedCoverageId, new_ConformedCoverageId\n\t) AS o_ConformedCoverageId,\n\t-- *INF*: DECODE(true,\r\n\t-- ISNULL(lkp_ExistingSystemCoverageId),'Insert',\r\n\t-- new_ConformedCoverageId = lkp_ExistingConformedCoverageId\r\n\t-- AND lkp_InsuranceLineDescription=InsuranceLineDescription\r\n\t-- AND lkp_SourceSystemId=SourceSystemId\r\n\t-- AND lkp_PmsRiskUnitGroupDescription=PmsRiskUnitGroupDescription\r\n\t-- AND lkp_PmsRiskUnitDescription=PmsRiskUnitDescription\r\n\t-- AND lkp_PmsMajorPerilDescription=PmsMajorPerilDescription \r\n\t-- AND lkp_LossHistoryCode=LossHistoryCode \r\n\t-- AND lkp_LossHistoryDescription=LossHistoryDescription\r\n\t-- AND lkp_ISOMajorCrimeGroup=ISOMajorCrimeGroup,\r\n\t-- 'Ignore',\r\n\t-- 'Update')\n\tDECODE(\n\t    true,\n\t    lkp_ExistingSystemCoverageId IS NULL, 'Insert',\n\t    new_ConformedCoverageId = lkp_ExistingConformedCoverageId AND lkp_InsuranceLineDescription = InsuranceLineDescription AND lkp_SourceSystemId = SourceSystemId AND lkp_PmsRiskUnitGroupDescription = PmsRiskUnitGroupDescription AND lkp_PmsRiskUnitDescription = PmsRiskUnitDescription AND lkp_PmsMajorPerilDescription = PmsMajorPerilDescription AND lkp_LossHistoryCode = LossHistoryCode AND lkp_LossHistoryDescription = LossHistoryDescription AND lkp_ISOMajorCrimeGroup = ISOMajorCrimeGroup, 'Ignore',\n\t    'Update'\n\t) AS o_InsertUpdateOrIgnore,\n\tSYSDATE AS o_CurrentDate\n\tFROM EXP_Values\n\tLEFT JOIN LKP_SystemCoverage\n\tON LKP_SystemCoverage.InsuranceLineCode = EXP_Values.o_InsuranceLineCode AND LKP_SystemCoverage.DctRiskTypeCode = EXP_Values.o_DctRiskTypeCode AND LKP_SystemCoverage.DctCoverageTypeCode = EXP_Values.o_DctCoverageTypeCode AND LKP_SystemCoverage.PmsRiskUnitGroupCode = EXP_Values.o_PmsRiskUnitGroupCode AND LKP_SystemCoverage.PmsRiskUnitCode = EXP_Values.o_PmsRiskUnitCode AND LKP_SystemCoverage.PmsMajorPerilCode = EXP_Values.o_PmsMajorPerilCode AND LKP_SystemCoverage.PmsProductTypeCode = EXP_Values.o_PmsProductTypeCode AND LKP_SystemCoverage.DctPerilGroup = EXP_Values.o_DctPerilGroup AND LKP_SystemCoverage.DctSubCoverageTypeCode = EXP_Values.o_DctSubCoverageTypeCode AND LKP_SystemCoverage.DctCoverageVersion = EXP_Values.o_DctCoverageVersion\n),\nRTR_Insert_Update_Groups AS (\n\tSELECT\n\tlkp_ExistingSystemCoverageId,\n\tnew_SystemCoverageId AS SystemCoverageId,\n\to_ConformedCoverageId AS ConformedCoverageId,\n\tInsuranceLineCode,\n\tInsuranceLineDescription,\n\tSourceSystemId,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilCode,\n\tPmsMajorPerilDescription,\n\tPmsProductTypeCode,\n\tDctPerilGroup,\n\tDctSubCoverageTypeCode,\n\tDctCoverageVersion,\n\tLossHistoryCode,\n\tLossHistoryDescription,\n\tISOMajorCrimeGroup,\n\to_InsertUpdateOrIgnore AS InsertUpdateOrIgnore,\n\to_CurrentDate AS CurrentDate\n\tFROM EXP_Detect_Changes\n),\nRTR_Insert_Update_Groups_INSERT AS (SELECT * FROM RTR_Insert_Update_Groups WHERE InsertUpdateOrIgnore='Insert'),\nRTR_Insert_Update_Groups_UPDATE AS (SELECT * FROM RTR_Insert_Update_Groups WHERE InsertUpdateOrIgnore='Update'),\nUPD_SystemCoverage_Insert AS (\n\tSELECT\n\tSystemCoverageId, \n\tConformedCoverageId, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tSourceSystemId, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup, \n\tCurrentDate\n\tFROM RTR_Insert_Update_Groups_INSERT\n),\nSystemCoverage_Insert AS (\n\tSET QUOTED_IDENTIFIER ON;\r\n\t\r\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.SystemCoverage(SystemCoverageId,CreatedDate,ModifiedDate,ConformedCoverageId,InsuranceLineCode,InsuranceLineDescription,SourceSystemId,DctRiskTypeCode,DctCoverageTypeCode,PmsRiskUnitGroupCode,PmsRiskUnitGroupDescription,PmsRiskUnitCode,PmsRiskUnitDescription,PmsMajorPerilCode,PmsMajorPerilDescription,PmsProductTypeCode,DctPerilGroup,DctSubCoverageTypeCode,DctCoverageVersion,LossHistoryCode,LossHistoryDescription,ISOMajorCrimeGroup\r\n\t) \n\tSELECT S.SystemCoverageId,S.CreatedDate,S.ModifiedDate,S.ConformedCoverageId,S.InsuranceLineCode,S.InsuranceLineDescription,S.SourceSystemId,S.DctRiskTypeCode,S.DctCoverageTypeCode,S.PmsRiskUnitGroupCode,S.PmsRiskUnitGroupDescription,S.PmsRiskUnitCode,S.PmsRiskUnitDescription,S.PmsMajorPerilCode,S.PmsMajorPerilDescription, S.PmsProductTypeCode,S.DctPerilGroup,S.DctSubCoverageTypeCode,S.DctCoverageVersion,S.LossHistoryCode,S.LossHistoryDescription,S.ISOMajorCrimeGroup\n\tFROM UPD_SystemCoverage_Insert S\n),\nUPD_SystemCoverage AS (\n\tSELECT\n\tlkp_ExistingSystemCoverageId AS lkp_ExistingSystemCoverageId3, \n\tSystemCoverageId, \n\tCurrentDate AS ModifiedDate, \n\tConformedCoverageId, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tSourceSystemId, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup\n\tFROM RTR_Insert_Update_Groups_UPDATE\n),\nSystemCoverage_Update AS (\n\tSET QUOTED_IDENTIFIER ON;\r\n\t\r\n\tUPDATE @{pipeline().parameters.TARGET_TABLE_OWNER}.SystemCoverage SET ModifiedDate = S.ModifiedDate, ConformedCoverageId = S.ConformedCoverageId, InsuranceLineCode = S.InsuranceLineCode, InsuranceLineDescription = S.InsuranceLineDescription, SourceSystemId = S.SourceSystemId, DctRiskTypeCode = S.DctRiskTypeCode, DctCoverageTypeCode = S.DctCoverageTypeCode, PmsRiskUnitGroupCode = S.PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription = S.PmsRiskUnitGroupDescription, PmsRiskUnitCode = S.PmsRiskUnitCode, PmsRiskUnitDescription = S.PmsRiskUnitDescription, PmsMajorPerilCode = S.PmsMajorPerilCode, PmsMajorPerilDescription = S.PmsMajorPerilDescription, PmsProductTypeCode = S.PmsProductTypeCode, DctPerilGroup = S.DctPerilGroup, DctSubCoverageTypeCode = S.DctSubCoverageTypeCode, DctCoverageVersion = S.DctCoverageVersion,LossHistoryCode = S.LossHistoryCode, LossHistoryDescription=S.LossHistoryDescription,ISOMajorCrimeGroup = S.ISOMajorCrimeGroup WHERE SystemCoverageId = S.SystemCoverageId\n\tFROM UPD_SystemCoverage S\n\n\t------------ POST SQL ----------\n\texec [spSetIndexStatus] @Enable = 1, @Schema = 'dbo', @TableName = 'SystemCoverage', @IndexWildcard = 'AK1SystemCoverage';\r\n\t\r\n\texec [spSetIndexStatus] @Enable = 1, @Schema = 'dbo', @TableName = 'SystemCoverage', @IndexWildcard = 'AK2SystemCoverage';\n\t-------------------------------\n\n\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Common DataWarehouse/"
        },
        "annotations": []
    }
}