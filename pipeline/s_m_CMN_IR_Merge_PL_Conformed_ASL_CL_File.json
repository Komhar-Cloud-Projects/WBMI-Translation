{
    "name": "s_m_CMN_IR_Merge_PL_Conformed_ASL_CL_File",
    "properties": {
        "activities": [
            {
                "name": "m_CMN_IR_Merge_PL_Conformed_ASL_CL_File",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_PL_Conformed_Coverage_MasterFile AS (\n\n-- TODO Manual --\n\n),\nEXP_Src_DataCollect AS (\n\tSELECT\n\tSource_System,\n\tProduct_Code,\n\tProduct_Description,\n\tCoverage_Summary_Code,\n\tCoverage_Summary_Description,\n\tCoverage_Group_Code,\n\tCoverage_Group_Description,\n\tCoverage_Code,\n\tCoverage_Description,\n\tCoverage_Code_ACORD,\n\tRated_Coverage_Code,\n\tRated_Coverage_Description,\n\tAnnual_Statement_Line_Code,\n\tAnnual_Statement_Line_Code_Description,\n\tSub_Annual_Statement_Line_Code,\n\tSub_Annual_Statement_Line_Code_Description,\n\tSub_Non_Annual_Statement_Line_Code,\n\tSub_Non_Annual_Statement_Line_Code_Description,\n\t-- *INF*: IIF(\r\n\t-- (ISNULL(Source_System) or IS_SPACES(Source_System)  or LENGTH(Source_System)=0)\r\n\t-- AND (ISNULL(Product_Code) or IS_SPACES(Product_Code)  or LENGTH(Product_Code)=0)\r\n\t-- AND (ISNULL(Product_Description) or IS_SPACES(Product_Description)  or LENGTH(Product_Description)=0)\r\n\t-- AND (ISNULL(Coverage_Summary_Code) or IS_SPACES(Coverage_Summary_Code)  or LENGTH(Coverage_Summary_Code)=0)\r\n\t-- AND (ISNULL(Coverage_Summary_Description) or IS_SPACES(Coverage_Summary_Description)  or LENGTH(Coverage_Summary_Description)=0)\r\n\t-- AND (ISNULL(Coverage_Group_Code) or IS_SPACES(Coverage_Group_Code)  or LENGTH(Coverage_Group_Code)=0)\r\n\t-- AND (ISNULL(Coverage_Group_Description) or IS_SPACES(Coverage_Group_Description)  or LENGTH(Coverage_Group_Description)=0)\r\n\t-- AND (ISNULL(Coverage_Code) or IS_SPACES(Coverage_Code)  or LENGTH(Coverage_Code)=0)\r\n\t-- AND (ISNULL(Coverage_Description) or IS_SPACES(Coverage_Description)  or LENGTH(Coverage_Description)=0)\r\n\t-- AND (ISNULL(Coverage_Code_ACORD) or IS_SPACES(Coverage_Code_ACORD)  or LENGTH(Coverage_Code_ACORD)=0)\r\n\t-- AND (ISNULL(Rated_Coverage_Code) or IS_SPACES(Rated_Coverage_Code)  or LENGTH(Rated_Coverage_Code)=0)\r\n\t-- AND (ISNULL(Rated_Coverage_Description) or IS_SPACES(Rated_Coverage_Description)  or LENGTH(Rated_Coverage_Description)=0)\r\n\t-- AND (ISNULL(Annual_Statement_Line_Code) or IS_SPACES(Annual_Statement_Line_Code)  or LENGTH(Annual_Statement_Line_Code)=0)\r\n\t-- AND (ISNULL(Annual_Statement_Line_Code_Description) or IS_SPACES(Annual_Statement_Line_Code_Description)  or LENGTH(Annual_Statement_Line_Code_Description)=0)\r\n\t-- AND (ISNULL(Sub_Annual_Statement_Line_Code) or IS_SPACES(Sub_Annual_Statement_Line_Code)  or LENGTH(Sub_Annual_Statement_Line_Code)=0)\r\n\t-- AND (ISNULL(Sub_Annual_Statement_Line_Code_Description) or IS_SPACES(Sub_Annual_Statement_Line_Code_Description)  or LENGTH(Sub_Annual_Statement_Line_Code_Description)=0)\r\n\t-- AND (ISNULL(Sub_Non_Annual_Statement_Line_Code) or IS_SPACES(Sub_Non_Annual_Statement_Line_Code)  or LENGTH(Sub_Non_Annual_Statement_Line_Code)=0)\r\n\t-- AND (ISNULL(Sub_Non_Annual_Statement_Line_Code_Description) or IS_SPACES(Sub_Non_Annual_Statement_Line_Code_Description)  or LENGTH(Sub_Non_Annual_Statement_Line_Code_Description)=0)\r\n\t-- ,1,0)\n\tIFF(( Source_System IS NULL \n\t\t\tOR LENGTH(Source_System)>0 AND TRIM(Source_System)='' \n\t\t\tOR LENGTH(Source_System\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Product_Code IS NULL \n\t\t\tOR LENGTH(Product_Code)>0 AND TRIM(Product_Code)='' \n\t\t\tOR LENGTH(Product_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Product_Description IS NULL \n\t\t\tOR LENGTH(Product_Description)>0 AND TRIM(Product_Description)='' \n\t\t\tOR LENGTH(Product_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Summary_Code IS NULL \n\t\t\tOR LENGTH(Coverage_Summary_Code)>0 AND TRIM(Coverage_Summary_Code)='' \n\t\t\tOR LENGTH(Coverage_Summary_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Summary_Description IS NULL \n\t\t\tOR LENGTH(Coverage_Summary_Description)>0 AND TRIM(Coverage_Summary_Description)='' \n\t\t\tOR LENGTH(Coverage_Summary_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Group_Code IS NULL \n\t\t\tOR LENGTH(Coverage_Group_Code)>0 AND TRIM(Coverage_Group_Code)='' \n\t\t\tOR LENGTH(Coverage_Group_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Group_Description IS NULL \n\t\t\tOR LENGTH(Coverage_Group_Description)>0 AND TRIM(Coverage_Group_Description)='' \n\t\t\tOR LENGTH(Coverage_Group_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Code IS NULL \n\t\t\tOR LENGTH(Coverage_Code)>0 AND TRIM(Coverage_Code)='' \n\t\t\tOR LENGTH(Coverage_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Description IS NULL \n\t\t\tOR LENGTH(Coverage_Description)>0 AND TRIM(Coverage_Description)='' \n\t\t\tOR LENGTH(Coverage_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Coverage_Code_ACORD IS NULL \n\t\t\tOR LENGTH(Coverage_Code_ACORD)>0 AND TRIM(Coverage_Code_ACORD)='' \n\t\t\tOR LENGTH(Coverage_Code_ACORD\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Rated_Coverage_Code IS NULL \n\t\t\tOR LENGTH(Rated_Coverage_Code)>0 AND TRIM(Rated_Coverage_Code)='' \n\t\t\tOR LENGTH(Rated_Coverage_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Rated_Coverage_Description IS NULL \n\t\t\tOR LENGTH(Rated_Coverage_Description)>0 AND TRIM(Rated_Coverage_Description)='' \n\t\t\tOR LENGTH(Rated_Coverage_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Annual_Statement_Line_Code IS NULL \n\t\t\tOR LENGTH(Annual_Statement_Line_Code)>0 AND TRIM(Annual_Statement_Line_Code)='' \n\t\t\tOR LENGTH(Annual_Statement_Line_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Annual_Statement_Line_Code_Description IS NULL \n\t\t\tOR LENGTH(Annual_Statement_Line_Code_Description)>0 AND TRIM(Annual_Statement_Line_Code_Description)='' \n\t\t\tOR LENGTH(Annual_Statement_Line_Code_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Sub_Annual_Statement_Line_Code IS NULL \n\t\t\tOR LENGTH(Sub_Annual_Statement_Line_Code)>0 AND TRIM(Sub_Annual_Statement_Line_Code)='' \n\t\t\tOR LENGTH(Sub_Annual_Statement_Line_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Sub_Annual_Statement_Line_Code_Description IS NULL \n\t\t\tOR LENGTH(Sub_Annual_Statement_Line_Code_Description)>0 AND TRIM(Sub_Annual_Statement_Line_Code_Description)='' \n\t\t\tOR LENGTH(Sub_Annual_Statement_Line_Code_Description\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Sub_Non_Annual_Statement_Line_Code IS NULL \n\t\t\tOR LENGTH(Sub_Non_Annual_Statement_Line_Code)>0 AND TRIM(Sub_Non_Annual_Statement_Line_Code)='' \n\t\t\tOR LENGTH(Sub_Non_Annual_Statement_Line_Code\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( Sub_Non_Annual_Statement_Line_Code_Description IS NULL \n\t\t\tOR LENGTH(Sub_Non_Annual_Statement_Line_Code_Description)>0 AND TRIM(Sub_Non_Annual_Statement_Line_Code_Description)='' \n\t\t\tOR LENGTH(Sub_Non_Annual_Statement_Line_Code_Description\n\t\t\t) = 0 \n\t\t),\n\t\t1,\n\t\t0\n\t) AS o_FilterFlag\n\tFROM SQ_PL_Conformed_Coverage_MasterFile\n),\nFIL_EmptyRows AS (\n\tSELECT\n\tSource_System, \n\tProduct_Code, \n\tProduct_Description, \n\tCoverage_Summary_Code, \n\tCoverage_Summary_Description, \n\tCoverage_Group_Code, \n\tCoverage_Group_Description, \n\tCoverage_Code, \n\tCoverage_Description, \n\tCoverage_Code_ACORD, \n\tRated_Coverage_Code, \n\tRated_Coverage_Description, \n\tAnnual_Statement_Line_Code, \n\tAnnual_Statement_Line_Code_Description, \n\tSub_Annual_Statement_Line_Code, \n\tSub_Annual_Statement_Line_Code_Description, \n\tSub_Non_Annual_Statement_Line_Code, \n\tSub_Non_Annual_Statement_Line_Code_Description, \n\to_FilterFlag AS FilterFlag\n\tFROM EXP_Src_DataCollect\n\tWHERE FilterFlag=0 AND NOT (ISNULL(Coverage_Code_ACORD) or IS_SPACES(Coverage_Code_ACORD)  or LENGTH(Coverage_Code_ACORD)=0)\n),\nEXP_DataPrep AS (\n\tSELECT\n\t2 AS SRT_Order,\n\tSource_System,\n\tProduct_Code,\n\tProduct_Description,\n\tCoverage_Summary_Code,\n\tCoverage_Summary_Description,\n\tCoverage_Group_Code,\n\tCoverage_Group_Description,\n\tCoverage_Code,\n\tCoverage_Description,\n\tCoverage_Code_ACORD,\n\tRated_Coverage_Code,\n\tRated_Coverage_Description,\n\tAnnual_Statement_Line_Code,\n\tAnnual_Statement_Line_Code_Description,\n\tSub_Annual_Statement_Line_Code,\n\tSub_Annual_Statement_Line_Code_Description,\n\tSub_Non_Annual_Statement_Line_Code,\n\tSub_Non_Annual_Statement_Line_Code_Description,\n\t'N/A' AS InsuranceLineCode,\n\t'N/A' AS InsuranceLineDescription,\n\t'N/A' AS DctRiskTypeCode,\n\t'N/A' AS DctPerilGroup,\n\t'N/A' AS DctCoverageVersion,\n\t'N/A' AS PmsRiskUnitGroupCode,\n\t'N/A' AS PmsRiskUnitGroupDescription,\n\t'N/A' AS PmsRiskUnitCode,\n\t'N/A' AS PmsRiskUnitDescription,\n\t'N/A' AS PmsMajorPerilCode,\n\t'N/A' AS PmsMajorPerilDescription,\n\t'N/A' AS PmsProductTypeCode,\n\t'N/A' AS LossHistoryCode,\n\t'N/A' AS LossHistoryDescription,\n\t'N/A' AS ISOMajorCrimeGroup\n\tFROM FIL_EmptyRows\n),\nSQ_CSV_ConformedCoverage AS (\n\n-- TODO Manual --\n\n),\nEXP_Src_DataCollect_CC AS (\n\tSELECT\n\t1 AS SRT_order,\n\tCoverageSummaryCode,\n\tCoverageSummaryDescription,\n\tCoverageGroupCode,\n\tCoverageGroupDescription,\n\tCoverageCode,\n\tCoverageDescription,\n\tRatedCoverageCode,\n\tRatedCoverageDescription,\n\tInsuranceLineCode,\n\tInsuranceLineDescription,\n\tSourceSystemId,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tDctSubCoverageTypeCode,\n\tDctPerilGroup,\n\tDctCoverageVersion,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilCode,\n\tPmsMajorPerilDescription,\n\tPmsProductTypeCode,\n\tLossHistoryCode,\n\tLossHistoryDescription,\n\tISOMajorCrimeGroup,\n\t-- *INF*: IIF(\r\n\t-- (ISNULL(CoverageSummaryCode) or IS_SPACES(CoverageSummaryCode)  or LENGTH(CoverageSummaryCode)=0)\r\n\t-- AND (ISNULL(CoverageSummaryDescription) or IS_SPACES(CoverageSummaryDescription)  or LENGTH(CoverageSummaryDescription)=0)\r\n\t-- AND (ISNULL(CoverageGroupCode) or IS_SPACES(CoverageGroupCode)  or LENGTH(CoverageGroupCode)=0)\r\n\t-- AND (ISNULL(CoverageGroupDescription) or IS_SPACES(CoverageGroupDescription)  or LENGTH(CoverageGroupDescription)=0)\r\n\t-- AND (ISNULL(CoverageCode) or IS_SPACES(CoverageCode)  or LENGTH(CoverageCode)=0)\r\n\t-- AND (ISNULL(CoverageDescription) or IS_SPACES(CoverageDescription)  or LENGTH(CoverageDescription)=0)\r\n\t-- AND (ISNULL(RatedCoverageCode) or IS_SPACES(RatedCoverageCode)  or LENGTH(RatedCoverageCode)=0)\r\n\t-- AND (ISNULL(RatedCoverageDescription) or IS_SPACES(RatedCoverageDescription)  or LENGTH(RatedCoverageDescription)=0)\r\n\t-- AND (ISNULL(InsuranceLineCode) or IS_SPACES(InsuranceLineCode)  or LENGTH(InsuranceLineCode)=0)\r\n\t-- AND (ISNULL(InsuranceLineDescription) or IS_SPACES(InsuranceLineDescription)  or LENGTH(InsuranceLineDescription)=0)\r\n\t-- AND (ISNULL(SourceSystemId) or IS_SPACES(SourceSystemId)  or LENGTH(SourceSystemId)=0)\r\n\t-- AND (ISNULL(DctRiskTypeCode) or IS_SPACES(DctRiskTypeCode)  or LENGTH(DctRiskTypeCode)=0)\r\n\t-- AND (ISNULL(DctCoverageTypeCode) or IS_SPACES(DctCoverageTypeCode)  or LENGTH(DctCoverageTypeCode)=0)\r\n\t-- AND (ISNULL(DctSubCoverageTypeCode) or IS_SPACES(DctSubCoverageTypeCode)  or LENGTH(DctSubCoverageTypeCode)=0)\r\n\t-- AND (ISNULL(DctPerilGroup) or IS_SPACES(DctPerilGroup)  or LENGTH(DctPerilGroup)=0)\r\n\t-- AND (ISNULL(DctCoverageVersion) or IS_SPACES(DctCoverageVersion)  or LENGTH(DctCoverageVersion)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitGroupCode) or IS_SPACES(PmsRiskUnitGroupCode)  or LENGTH(PmsRiskUnitGroupCode)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitGroupDescription) or IS_SPACES(PmsRiskUnitGroupDescription)  or LENGTH(PmsRiskUnitGroupDescription)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitCode) or IS_SPACES(PmsRiskUnitCode)  or LENGTH(PmsRiskUnitCode)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitDescription) or IS_SPACES(PmsRiskUnitDescription)  or LENGTH(PmsRiskUnitDescription)=0)\r\n\t-- AND (ISNULL(PmsMajorPerilCode) or IS_SPACES(PmsMajorPerilCode)  or LENGTH(PmsMajorPerilCode)=0)\r\n\t-- AND (ISNULL(PmsMajorPerilDescription) or IS_SPACES(PmsMajorPerilDescription)  or LENGTH(PmsMajorPerilDescription)=0)\r\n\t-- AND (ISNULL(PmsProductTypeCode) or IS_SPACES(PmsProductTypeCode)  or LENGTH(PmsProductTypeCode)=0)\r\n\t-- AND (ISNULL(LossHistoryCode) or IS_SPACES(LossHistoryCode)  or LENGTH(LossHistoryCode)=0)\r\n\t-- AND (ISNULL(LossHistoryDescription) or IS_SPACES(LossHistoryDescription)  or LENGTH(LossHistoryDescription)=0)\r\n\t-- AND (ISNULL(ISOMajorCrimeGroup) or IS_SPACES(ISOMajorCrimeGroup)  or LENGTH(ISOMajorCrimeGroup)=0)\r\n\t-- ,1,0)\n\tIFF(( CoverageSummaryCode IS NULL \n\t\t\tOR LENGTH(CoverageSummaryCode)>0 AND TRIM(CoverageSummaryCode)='' \n\t\t\tOR LENGTH(CoverageSummaryCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageSummaryDescription IS NULL \n\t\t\tOR LENGTH(CoverageSummaryDescription)>0 AND TRIM(CoverageSummaryDescription)='' \n\t\t\tOR LENGTH(CoverageSummaryDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageGroupCode IS NULL \n\t\t\tOR LENGTH(CoverageGroupCode)>0 AND TRIM(CoverageGroupCode)='' \n\t\t\tOR LENGTH(CoverageGroupCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageGroupDescription IS NULL \n\t\t\tOR LENGTH(CoverageGroupDescription)>0 AND TRIM(CoverageGroupDescription)='' \n\t\t\tOR LENGTH(CoverageGroupDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageCode IS NULL \n\t\t\tOR LENGTH(CoverageCode)>0 AND TRIM(CoverageCode)='' \n\t\t\tOR LENGTH(CoverageCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageDescription IS NULL \n\t\t\tOR LENGTH(CoverageDescription)>0 AND TRIM(CoverageDescription)='' \n\t\t\tOR LENGTH(CoverageDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( RatedCoverageCode IS NULL \n\t\t\tOR LENGTH(RatedCoverageCode)>0 AND TRIM(RatedCoverageCode)='' \n\t\t\tOR LENGTH(RatedCoverageCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( RatedCoverageDescription IS NULL \n\t\t\tOR LENGTH(RatedCoverageDescription)>0 AND TRIM(RatedCoverageDescription)='' \n\t\t\tOR LENGTH(RatedCoverageDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( InsuranceLineCode IS NULL \n\t\t\tOR LENGTH(InsuranceLineCode)>0 AND TRIM(InsuranceLineCode)='' \n\t\t\tOR LENGTH(InsuranceLineCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( InsuranceLineDescription IS NULL \n\t\t\tOR LENGTH(InsuranceLineDescription)>0 AND TRIM(InsuranceLineDescription)='' \n\t\t\tOR LENGTH(InsuranceLineDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( SourceSystemId IS NULL \n\t\t\tOR LENGTH(SourceSystemId)>0 AND TRIM(SourceSystemId)='' \n\t\t\tOR LENGTH(SourceSystemId\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctRiskTypeCode IS NULL \n\t\t\tOR LENGTH(DctRiskTypeCode)>0 AND TRIM(DctRiskTypeCode)='' \n\t\t\tOR LENGTH(DctRiskTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctCoverageTypeCode IS NULL \n\t\t\tOR LENGTH(DctCoverageTypeCode)>0 AND TRIM(DctCoverageTypeCode)='' \n\t\t\tOR LENGTH(DctCoverageTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctSubCoverageTypeCode IS NULL \n\t\t\tOR LENGTH(DctSubCoverageTypeCode)>0 AND TRIM(DctSubCoverageTypeCode)='' \n\t\t\tOR LENGTH(DctSubCoverageTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctPerilGroup IS NULL \n\t\t\tOR LENGTH(DctPerilGroup)>0 AND TRIM(DctPerilGroup)='' \n\t\t\tOR LENGTH(DctPerilGroup\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctCoverageVersion IS NULL \n\t\t\tOR LENGTH(DctCoverageVersion)>0 AND TRIM(DctCoverageVersion)='' \n\t\t\tOR LENGTH(DctCoverageVersion\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitGroupCode IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitGroupCode)>0 AND TRIM(PmsRiskUnitGroupCode)='' \n\t\t\tOR LENGTH(PmsRiskUnitGroupCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitGroupDescription IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitGroupDescription)>0 AND TRIM(PmsRiskUnitGroupDescription)='' \n\t\t\tOR LENGTH(PmsRiskUnitGroupDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitCode IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitCode)>0 AND TRIM(PmsRiskUnitCode)='' \n\t\t\tOR LENGTH(PmsRiskUnitCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitDescription IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitDescription)>0 AND TRIM(PmsRiskUnitDescription)='' \n\t\t\tOR LENGTH(PmsRiskUnitDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsMajorPerilCode IS NULL \n\t\t\tOR LENGTH(PmsMajorPerilCode)>0 AND TRIM(PmsMajorPerilCode)='' \n\t\t\tOR LENGTH(PmsMajorPerilCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsMajorPerilDescription IS NULL \n\t\t\tOR LENGTH(PmsMajorPerilDescription)>0 AND TRIM(PmsMajorPerilDescription)='' \n\t\t\tOR LENGTH(PmsMajorPerilDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsProductTypeCode IS NULL \n\t\t\tOR LENGTH(PmsProductTypeCode)>0 AND TRIM(PmsProductTypeCode)='' \n\t\t\tOR LENGTH(PmsProductTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( LossHistoryCode IS NULL \n\t\t\tOR LENGTH(LossHistoryCode)>0 AND TRIM(LossHistoryCode)='' \n\t\t\tOR LENGTH(LossHistoryCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( LossHistoryDescription IS NULL \n\t\t\tOR LENGTH(LossHistoryDescription)>0 AND TRIM(LossHistoryDescription)='' \n\t\t\tOR LENGTH(LossHistoryDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( ISOMajorCrimeGroup IS NULL \n\t\t\tOR LENGTH(ISOMajorCrimeGroup)>0 AND TRIM(ISOMajorCrimeGroup)='' \n\t\t\tOR LENGTH(ISOMajorCrimeGroup\n\t\t\t) = 0 \n\t\t),\n\t\t1,\n\t\t0\n\t) AS o_FilterFlag\n\tFROM SQ_CSV_ConformedCoverage\n),\nFIL_CC_Eliminate_EmptyRows AS (\n\tSELECT\n\tSRT_order, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tRatedCoverageCode, \n\tRatedCoverageDescription, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tSourceSystemId, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tDctSubCoverageTypeCode, \n\tDctPerilGroup, \n\tDctCoverageVersion, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup, \n\to_FilterFlag AS FilterFlag\n\tFROM EXP_Src_DataCollect_CC\n\tWHERE FilterFlag=0\n),\nUN_ConformedCoverage AS (\n\tSELECT CoverageSummaryCode, CoverageSummaryDescription, CoverageGroupCode, CoverageGroupDescription, CoverageCode, CoverageDescription, RatedCoverageCode, RatedCoverageDescription, InsuranceLineCode, InsuranceLineDescription, SourceSystemId, DctRiskTypeCode, DctCoverageTypeCode, DctSubCoverageTypeCode, DctPerilGroup, DctCoverageVersion, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, LossHistoryCode, LossHistoryDescription, ISOMajorCrimeGroup, SRT_order AS SRT_Order\n\tFROM FIL_CC_Eliminate_EmptyRows\n\tUNION\n\tSELECT Coverage_Summary_Code AS CoverageSummaryCode, Coverage_Summary_Description AS CoverageSummaryDescription, Coverage_Group_Code AS CoverageGroupCode, Coverage_Group_Description AS CoverageGroupDescription, Coverage_Code AS CoverageCode, Coverage_Description AS CoverageDescription, Rated_Coverage_Code AS RatedCoverageCode, Rated_Coverage_Description AS RatedCoverageDescription, InsuranceLineCode, InsuranceLineDescription, Source_System AS SourceSystemId, DctRiskTypeCode, Coverage_Code_ACORD AS DctCoverageTypeCode, Rated_Coverage_Code AS DctSubCoverageTypeCode, DctPerilGroup, DctCoverageVersion, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, LossHistoryCode, LossHistoryDescription, ISOMajorCrimeGroup, SRT_Order\n\tFROM EXP_DataPrep\n),\nSRT_Distinct_ConformedCoverage AS (\n\tSELECT\n\tSRT_Order, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tRatedCoverageCode, \n\tRatedCoverageDescription, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tSourceSystemId, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tDctSubCoverageTypeCode, \n\tDctPerilGroup, \n\tDctCoverageVersion, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tLossHistoryCode, \n\tLossHistoryDescription, \n\tISOMajorCrimeGroup\n\tFROM UN_ConformedCoverage\n\tORDER BY SRT_Order ASC, CoverageSummaryCode ASC, CoverageSummaryDescription ASC, CoverageGroupCode ASC, CoverageGroupDescription ASC, CoverageCode ASC, CoverageDescription ASC, RatedCoverageCode ASC, RatedCoverageDescription ASC, InsuranceLineCode ASC, InsuranceLineDescription ASC, SourceSystemId ASC, DctRiskTypeCode ASC, DctCoverageTypeCode ASC, DctSubCoverageTypeCode ASC, DctPerilGroup ASC, DctCoverageVersion ASC, PmsRiskUnitGroupCode ASC, PmsRiskUnitGroupDescription ASC, PmsRiskUnitCode ASC, PmsRiskUnitDescription ASC, PmsMajorPerilCode ASC, PmsMajorPerilDescription ASC, PmsProductTypeCode ASC, LossHistoryCode ASC, LossHistoryDescription ASC, ISOMajorCrimeGroup ASC\n),\nEXP_Tgt_DataCollect_CC AS (\n\tSELECT\n\tCoverageSummaryCode,\n\tCoverageSummaryDescription,\n\tCoverageGroupCode,\n\tCoverageGroupDescription,\n\tCoverageCode,\n\tCoverageDescription,\n\tRatedCoverageCode,\n\tRatedCoverageDescription,\n\tInsuranceLineCode,\n\tInsuranceLineDescription,\n\tSourceSystemId,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tDctSubCoverageTypeCode,\n\tDctPerilGroup,\n\tDctCoverageVersion,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilCode,\n\tPmsMajorPerilDescription,\n\tPmsProductTypeCode,\n\tLossHistoryCode,\n\tLossHistoryDescription,\n\tISOMajorCrimeGroup\n\tFROM SRT_Distinct_ConformedCoverage\n),\nCSV_ConformedCoverage AS (\n\tINSERT INTO CSV_ConformedCoverage\n\t(CoverageSummaryCode, CoverageSummaryDescription, CoverageGroupCode, CoverageGroupDescription, CoverageCode, CoverageDescription, RatedCoverageCode, RatedCoverageDescription, InsuranceLineCode, InsuranceLineDescription, SourceSystemId, DctRiskTypeCode, DctCoverageTypeCode, DctSubCoverageTypeCode, DctPerilGroup, DctCoverageVersion, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, LossHistoryCode, LossHistoryDescription, ISOMajorCrimeGroup)\n\tSELECT \n\tCOVERAGESUMMARYCODE, \n\tCOVERAGESUMMARYDESCRIPTION, \n\tCOVERAGEGROUPCODE, \n\tCOVERAGEGROUPDESCRIPTION, \n\tCOVERAGECODE, \n\tCOVERAGEDESCRIPTION, \n\tRATEDCOVERAGECODE, \n\tRATEDCOVERAGEDESCRIPTION, \n\tINSURANCELINECODE, \n\tINSURANCELINEDESCRIPTION, \n\tSOURCESYSTEMID, \n\tDCTRISKTYPECODE, \n\tDCTCOVERAGETYPECODE, \n\tDCTSUBCOVERAGETYPECODE, \n\tDCTPERILGROUP, \n\tDCTCOVERAGEVERSION, \n\tPMSRISKUNITGROUPCODE, \n\tPMSRISKUNITGROUPDESCRIPTION, \n\tPMSRISKUNITCODE, \n\tPMSRISKUNITDESCRIPTION, \n\tPMSMAJORPERILCODE, \n\tPMSMAJORPERILDESCRIPTION, \n\tPMSPRODUCTTYPECODE, \n\tLOSSHISTORYCODE, \n\tLOSSHISTORYDESCRIPTION, \n\tISOMAJORCRIMEGROUP\n\tFROM EXP_Tgt_DataCollect_CC\n),\nSQ_DCTASLCoverageCombinations AS (\n\n-- TODO Manual --\n\n),\nEXP_Src_DataCollect_ASL AS (\n\tSELECT\n\t1 AS SRT_Order,\n\tASLCode,\n\tASLCodeDescription,\n\tSubASLCode,\n\tSubASLCodeDescription,\n\tNonSubASLCode,\n\tNonSubASLCodeDescription,\n\tInsuranceLineCode,\n\tInsuranceLineDescription,\n\tRatedCoverageCode,\n\tRatedCoverageDescription,\n\tCoverageCode,\n\tCoverageDescription,\n\tCoverageGroupCode,\n\tCoverageGroupDescription,\n\tCoverageSummaryCode,\n\tCoverageSummaryDescription,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilCode,\n\tPmsMajorPerilDescription,\n\tPmsProductTypeCode,\n\tDctPerilGroup,\n\tDctSubCoverageTypeCode,\n\tDctCoverageVersion,\n\t-- *INF*: IIF(\r\n\t-- (ISNULL(ASLCode) or IS_SPACES(ASLCode)  or LENGTH(ASLCode)=0)\r\n\t-- AND (ISNULL(ASLCodeDescription) or IS_SPACES(ASLCodeDescription)  or LENGTH(ASLCodeDescription)=0)\r\n\t-- AND (ISNULL(SubASLCode) or IS_SPACES(SubASLCode)  or LENGTH(SubASLCode)=0)\r\n\t-- AND (ISNULL(SubASLCodeDescription) or IS_SPACES(SubASLCodeDescription)  or LENGTH(SubASLCodeDescription)=0)\r\n\t-- AND (ISNULL(NonSubASLCode) or IS_SPACES(NonSubASLCode)  or LENGTH(NonSubASLCode)=0)\r\n\t-- AND (ISNULL(NonSubASLCodeDescription) or IS_SPACES(NonSubASLCodeDescription)  or LENGTH(NonSubASLCodeDescription)=0)\r\n\t-- AND (ISNULL(InsuranceLineCode) or IS_SPACES(InsuranceLineCode)  or LENGTH(InsuranceLineCode)=0)\r\n\t-- AND (ISNULL(InsuranceLineDescription) or IS_SPACES(InsuranceLineDescription)  or LENGTH(InsuranceLineDescription)=0)\r\n\t-- AND (ISNULL(RatedCoverageCode) or IS_SPACES(RatedCoverageCode)  or LENGTH(RatedCoverageCode)=0)\r\n\t-- AND (ISNULL(RatedCoverageDescription) or IS_SPACES(RatedCoverageDescription)  or LENGTH(RatedCoverageDescription)=0)\r\n\t-- AND (ISNULL(CoverageSummaryCode) or IS_SPACES(CoverageSummaryCode)  or LENGTH(CoverageSummaryCode)=0)\r\n\t-- AND (ISNULL(CoverageSummaryDescription) or IS_SPACES(CoverageSummaryDescription)  or LENGTH(CoverageSummaryDescription)=0)\r\n\t-- AND (ISNULL(CoverageGroupCode) or IS_SPACES(CoverageGroupCode)  or LENGTH(CoverageGroupCode)=0)\r\n\t-- AND (ISNULL(CoverageGroupDescription) or IS_SPACES(CoverageGroupDescription)  or LENGTH(CoverageGroupDescription)=0)\r\n\t-- AND (ISNULL(CoverageCode) or IS_SPACES(CoverageCode)  or LENGTH(CoverageCode)=0)\r\n\t-- AND (ISNULL(CoverageDescription) or IS_SPACES(CoverageDescription)  or LENGTH(CoverageDescription)=0)\r\n\t-- AND (ISNULL(DctRiskTypeCode) or IS_SPACES(DctRiskTypeCode)  or LENGTH(DctRiskTypeCode)=0)\r\n\t-- AND (ISNULL(DctCoverageTypeCode) or IS_SPACES(DctCoverageTypeCode)  or LENGTH(DctCoverageTypeCode)=0)\r\n\t-- AND (ISNULL(DctSubCoverageTypeCode) or IS_SPACES(DctSubCoverageTypeCode)  or LENGTH(DctSubCoverageTypeCode)=0)\r\n\t-- AND (ISNULL(DctPerilGroup) or IS_SPACES(DctPerilGroup)  or LENGTH(DctPerilGroup)=0)\r\n\t-- AND (ISNULL(DctCoverageVersion) or IS_SPACES(DctCoverageVersion)  or LENGTH(DctCoverageVersion)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitGroupCode) or IS_SPACES(PmsRiskUnitGroupCode)  or LENGTH(PmsRiskUnitGroupCode)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitGroupDescription) or IS_SPACES(PmsRiskUnitGroupDescription)  or LENGTH(PmsRiskUnitGroupDescription)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitCode) or IS_SPACES(PmsRiskUnitCode)  or LENGTH(PmsRiskUnitCode)=0)\r\n\t-- AND (ISNULL(PmsRiskUnitDescription) or IS_SPACES(PmsRiskUnitDescription)  or LENGTH(PmsRiskUnitDescription)=0)\r\n\t-- AND (ISNULL(PmsMajorPerilCode) or IS_SPACES(PmsMajorPerilCode)  or LENGTH(PmsMajorPerilCode)=0)\r\n\t-- AND (ISNULL(PmsMajorPerilDescription) or IS_SPACES(PmsMajorPerilDescription)  or LENGTH(PmsMajorPerilDescription)=0)\r\n\t-- AND (ISNULL(PmsProductTypeCode) or IS_SPACES(PmsProductTypeCode)  or LENGTH(PmsProductTypeCode)=0)\r\n\t-- ,1,0)\n\tIFF(( ASLCode IS NULL \n\t\t\tOR LENGTH(ASLCode)>0 AND TRIM(ASLCode)='' \n\t\t\tOR LENGTH(ASLCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( ASLCodeDescription IS NULL \n\t\t\tOR LENGTH(ASLCodeDescription)>0 AND TRIM(ASLCodeDescription)='' \n\t\t\tOR LENGTH(ASLCodeDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( SubASLCode IS NULL \n\t\t\tOR LENGTH(SubASLCode)>0 AND TRIM(SubASLCode)='' \n\t\t\tOR LENGTH(SubASLCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( SubASLCodeDescription IS NULL \n\t\t\tOR LENGTH(SubASLCodeDescription)>0 AND TRIM(SubASLCodeDescription)='' \n\t\t\tOR LENGTH(SubASLCodeDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( NonSubASLCode IS NULL \n\t\t\tOR LENGTH(NonSubASLCode)>0 AND TRIM(NonSubASLCode)='' \n\t\t\tOR LENGTH(NonSubASLCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( NonSubASLCodeDescription IS NULL \n\t\t\tOR LENGTH(NonSubASLCodeDescription)>0 AND TRIM(NonSubASLCodeDescription)='' \n\t\t\tOR LENGTH(NonSubASLCodeDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( InsuranceLineCode IS NULL \n\t\t\tOR LENGTH(InsuranceLineCode)>0 AND TRIM(InsuranceLineCode)='' \n\t\t\tOR LENGTH(InsuranceLineCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( InsuranceLineDescription IS NULL \n\t\t\tOR LENGTH(InsuranceLineDescription)>0 AND TRIM(InsuranceLineDescription)='' \n\t\t\tOR LENGTH(InsuranceLineDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( RatedCoverageCode IS NULL \n\t\t\tOR LENGTH(RatedCoverageCode)>0 AND TRIM(RatedCoverageCode)='' \n\t\t\tOR LENGTH(RatedCoverageCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( RatedCoverageDescription IS NULL \n\t\t\tOR LENGTH(RatedCoverageDescription)>0 AND TRIM(RatedCoverageDescription)='' \n\t\t\tOR LENGTH(RatedCoverageDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageSummaryCode IS NULL \n\t\t\tOR LENGTH(CoverageSummaryCode)>0 AND TRIM(CoverageSummaryCode)='' \n\t\t\tOR LENGTH(CoverageSummaryCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageSummaryDescription IS NULL \n\t\t\tOR LENGTH(CoverageSummaryDescription)>0 AND TRIM(CoverageSummaryDescription)='' \n\t\t\tOR LENGTH(CoverageSummaryDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageGroupCode IS NULL \n\t\t\tOR LENGTH(CoverageGroupCode)>0 AND TRIM(CoverageGroupCode)='' \n\t\t\tOR LENGTH(CoverageGroupCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageGroupDescription IS NULL \n\t\t\tOR LENGTH(CoverageGroupDescription)>0 AND TRIM(CoverageGroupDescription)='' \n\t\t\tOR LENGTH(CoverageGroupDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageCode IS NULL \n\t\t\tOR LENGTH(CoverageCode)>0 AND TRIM(CoverageCode)='' \n\t\t\tOR LENGTH(CoverageCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( CoverageDescription IS NULL \n\t\t\tOR LENGTH(CoverageDescription)>0 AND TRIM(CoverageDescription)='' \n\t\t\tOR LENGTH(CoverageDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctRiskTypeCode IS NULL \n\t\t\tOR LENGTH(DctRiskTypeCode)>0 AND TRIM(DctRiskTypeCode)='' \n\t\t\tOR LENGTH(DctRiskTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctCoverageTypeCode IS NULL \n\t\t\tOR LENGTH(DctCoverageTypeCode)>0 AND TRIM(DctCoverageTypeCode)='' \n\t\t\tOR LENGTH(DctCoverageTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctSubCoverageTypeCode IS NULL \n\t\t\tOR LENGTH(DctSubCoverageTypeCode)>0 AND TRIM(DctSubCoverageTypeCode)='' \n\t\t\tOR LENGTH(DctSubCoverageTypeCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctPerilGroup IS NULL \n\t\t\tOR LENGTH(DctPerilGroup)>0 AND TRIM(DctPerilGroup)='' \n\t\t\tOR LENGTH(DctPerilGroup\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( DctCoverageVersion IS NULL \n\t\t\tOR LENGTH(DctCoverageVersion)>0 AND TRIM(DctCoverageVersion)='' \n\t\t\tOR LENGTH(DctCoverageVersion\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitGroupCode IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitGroupCode)>0 AND TRIM(PmsRiskUnitGroupCode)='' \n\t\t\tOR LENGTH(PmsRiskUnitGroupCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitGroupDescription IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitGroupDescription)>0 AND TRIM(PmsRiskUnitGroupDescription)='' \n\t\t\tOR LENGTH(PmsRiskUnitGroupDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitCode IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitCode)>0 AND TRIM(PmsRiskUnitCode)='' \n\t\t\tOR LENGTH(PmsRiskUnitCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsRiskUnitDescription IS NULL \n\t\t\tOR LENGTH(PmsRiskUnitDescription)>0 AND TRIM(PmsRiskUnitDescription)='' \n\t\t\tOR LENGTH(PmsRiskUnitDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsMajorPerilCode IS NULL \n\t\t\tOR LENGTH(PmsMajorPerilCode)>0 AND TRIM(PmsMajorPerilCode)='' \n\t\t\tOR LENGTH(PmsMajorPerilCode\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsMajorPerilDescription IS NULL \n\t\t\tOR LENGTH(PmsMajorPerilDescription)>0 AND TRIM(PmsMajorPerilDescription)='' \n\t\t\tOR LENGTH(PmsMajorPerilDescription\n\t\t\t) = 0 \n\t\t) \n\t\tAND ( PmsProductTypeCode IS NULL \n\t\t\tOR LENGTH(PmsProductTypeCode)>0 AND TRIM(PmsProductTypeCode)='' \n\t\t\tOR LENGTH(PmsProductTypeCode\n\t\t\t) = 0 \n\t\t),\n\t\t1,\n\t\t0\n\t) AS o_FilterFlag\n\tFROM SQ_DCTASLCoverageCombinations\n),\nFIL_ASL_Eliminate_EmptyRows AS (\n\tSELECT\n\tSRT_Order, \n\tASLCode, \n\tASLCodeDescription, \n\tSubASLCode, \n\tSubASLCodeDescription, \n\tNonSubASLCode, \n\tNonSubASLCodeDescription, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tRatedCoverageCode, \n\tRatedCoverageDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion, \n\to_FilterFlag AS FilterFlag\n\tFROM EXP_Src_DataCollect_ASL\n\tWHERE FilterFlag=0\n),\nUN_ASL AS (\n\tSELECT SRT_Order, Annual_Statement_Line_Code AS ASLCode, Annual_Statement_Line_Code_Description AS ASLCodeDescription, Sub_Annual_Statement_Line_Code AS SubASLCode, Sub_Annual_Statement_Line_Code_Description AS SubASLCodeDescription, Sub_Non_Annual_Statement_Line_Code AS NonSubASLCode, Sub_Non_Annual_Statement_Line_Code_Description AS NonSubASLCodeDescription, InsuranceLineCode, InsuranceLineDescription, Rated_Coverage_Code AS RatedCoverageCode, Rated_Coverage_Description AS RatedCoverageDescription, Coverage_Code AS CoverageCode, Coverage_Description AS CoverageDescription, Coverage_Group_Code AS CoverageGroupCode, Coverage_Group_Description AS CoverageGroupDescription, Coverage_Summary_Code AS CoverageSummaryCode, Coverage_Summary_Description AS CoverageSummaryDescription, DctRiskTypeCode, Coverage_Code_ACORD AS DctCoverageTypeCode, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, DctPerilGroup, Rated_Coverage_Code AS DctSubCoverageTypeCode, DctCoverageVersion\n\tFROM EXP_DataPrep\n\tUNION\n\tSELECT SRT_Order, ASLCode, ASLCodeDescription, SubASLCode, SubASLCodeDescription, NonSubASLCode, NonSubASLCodeDescription, InsuranceLineCode, InsuranceLineDescription, RatedCoverageCode, RatedCoverageDescription, CoverageCode, CoverageDescription, CoverageGroupCode, CoverageGroupDescription, CoverageSummaryCode, CoverageSummaryDescription, DctRiskTypeCode, DctCoverageTypeCode, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, DctPerilGroup, DctSubCoverageTypeCode, DctCoverageVersion\n\tFROM FIL_ASL_Eliminate_EmptyRows\n),\nSRT_Distinct_ASL AS (\n\tSELECT\n\tSRT_Order, \n\tASLCode, \n\tASLCodeDescription, \n\tSubASLCode, \n\tSubASLCodeDescription, \n\tNonSubASLCode, \n\tNonSubASLCodeDescription, \n\tInsuranceLineCode, \n\tInsuranceLineDescription, \n\tRatedCoverageCode, \n\tRatedCoverageDescription, \n\tCoverageCode, \n\tCoverageDescription, \n\tCoverageGroupCode, \n\tCoverageGroupDescription, \n\tCoverageSummaryCode, \n\tCoverageSummaryDescription, \n\tDctRiskTypeCode, \n\tDctCoverageTypeCode, \n\tPmsRiskUnitGroupCode, \n\tPmsRiskUnitGroupDescription, \n\tPmsRiskUnitCode, \n\tPmsRiskUnitDescription, \n\tPmsMajorPerilCode, \n\tPmsMajorPerilDescription, \n\tPmsProductTypeCode, \n\tDctPerilGroup, \n\tDctSubCoverageTypeCode, \n\tDctCoverageVersion\n\tFROM UN_ASL\n\tORDER BY SRT_Order ASC, ASLCode ASC, ASLCodeDescription ASC, SubASLCode ASC, SubASLCodeDescription ASC, NonSubASLCode ASC, NonSubASLCodeDescription ASC, InsuranceLineCode ASC, InsuranceLineDescription ASC, RatedCoverageCode ASC, RatedCoverageDescription ASC, CoverageCode ASC, CoverageDescription ASC, CoverageGroupCode ASC, CoverageGroupDescription ASC, CoverageSummaryCode ASC, CoverageSummaryDescription ASC, DctRiskTypeCode ASC, DctCoverageTypeCode ASC, PmsRiskUnitGroupCode ASC, PmsRiskUnitGroupDescription ASC, PmsRiskUnitCode ASC, PmsRiskUnitDescription ASC, PmsMajorPerilCode ASC, PmsMajorPerilDescription ASC, PmsProductTypeCode ASC, DctPerilGroup ASC, DctSubCoverageTypeCode ASC, DctCoverageVersion ASC\n),\nEXP_Tgt_DataCollect_ASL AS (\n\tSELECT\n\tASLCode,\n\tASLCodeDescription,\n\tSubASLCode,\n\tSubASLCodeDescription,\n\tNonSubASLCode,\n\tNonSubASLCodeDescription,\n\tInsuranceLineCode,\n\tInsuranceLineDescription,\n\tRatedCoverageCode,\n\tRatedCoverageDescription,\n\tCoverageCode,\n\tCoverageDescription,\n\tCoverageGroupCode,\n\tCoverageGroupDescription,\n\tCoverageSummaryCode,\n\tCoverageSummaryDescription,\n\tDctRiskTypeCode,\n\tDctCoverageTypeCode,\n\tPmsRiskUnitGroupCode,\n\tPmsRiskUnitGroupDescription,\n\tPmsRiskUnitCode,\n\tPmsRiskUnitDescription,\n\tPmsMajorPerilCode,\n\tPmsMajorPerilDescription,\n\tPmsProductTypeCode,\n\tDctPerilGroup,\n\tDctSubCoverageTypeCode,\n\tDctCoverageVersion\n\tFROM SRT_Distinct_ASL\n),\nDCTASLCoverageCombinations AS (\n\tINSERT INTO DCTASLCoverageCombinations\n\t(ASLCode, ASLCodeDescription, SubASLCode, SubASLCodeDescription, NonSubASLCode, NonSubASLCodeDescription, InsuranceLineCode, InsuranceLineDescription, RatedCoverageCode, RatedCoverageDescription, CoverageCode, CoverageDescription, CoverageGroupCode, CoverageGroupDescription, CoverageSummaryCode, CoverageSummaryDescription, DctRiskTypeCode, DctCoverageTypeCode, PmsRiskUnitGroupCode, PmsRiskUnitGroupDescription, PmsRiskUnitCode, PmsRiskUnitDescription, PmsMajorPerilCode, PmsMajorPerilDescription, PmsProductTypeCode, DctPerilGroup, DctSubCoverageTypeCode, DctCoverageVersion)\n\tSELECT \n\tASLCODE, \n\tASLCODEDESCRIPTION, \n\tSUBASLCODE, \n\tSUBASLCODEDESCRIPTION, \n\tNONSUBASLCODE, \n\tNONSUBASLCODEDESCRIPTION, \n\tINSURANCELINECODE, \n\tINSURANCELINEDESCRIPTION, \n\tRATEDCOVERAGECODE, \n\tRATEDCOVERAGEDESCRIPTION, \n\tCOVERAGECODE, \n\tCOVERAGEDESCRIPTION, \n\tCOVERAGEGROUPCODE, \n\tCOVERAGEGROUPDESCRIPTION, \n\tCOVERAGESUMMARYCODE, \n\tCOVERAGESUMMARYDESCRIPTION, \n\tDCTRISKTYPECODE, \n\tDCTCOVERAGETYPECODE, \n\tPMSRISKUNITGROUPCODE, \n\tPMSRISKUNITGROUPDESCRIPTION, \n\tPMSRISKUNITCODE, \n\tPMSRISKUNITDESCRIPTION, \n\tPMSMAJORPERILCODE, \n\tPMSMAJORPERILDESCRIPTION, \n\tPMSPRODUCTTYPECODE, \n\tDCTPERILGROUP, \n\tDCTSUBCOVERAGETYPECODE, \n\tDCTCOVERAGEVERSION\n\tFROM EXP_Tgt_DataCollect_ASL\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "INPUTFILE_PL_CC_ASL": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\FlatFiles\\ConformedCoverageMasterLoadFile-PL.csv"
            },
            "INPUTFILE_CL_CC": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\FlatFiles\\SRC_ConformedCoverage.csv"
            },
            "INPUTFILENAME_ASL": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\SRC_DCTASLCoverageCombinations.csv"
            },
            "OUTPUTFILECC": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\FlatFiles\\SRC_ConformedCoverage1.csv"
            },
            "OUTPUTFILEASL": {
                "type": "string",
                "defaultValue": "$PMSourceFileDir\\Coverage\\SRC_DCTASLCoverageCombinations1.csv"
            }
        },
        "folder": {
            "name": "Common DataWarehouse/"
        },
        "annotations": []
    }
}