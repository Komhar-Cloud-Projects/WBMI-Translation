{
    "name": "s_m_CUS_STG_Insert_TokenizedData_PIF_42GJ_STAGE_HISTORY_V1",
    "properties": {
        "activities": [
            {
                "name": "m_CUS_STG_Insert_TokenizedData_PIF_42GJ_STAGE_HISTOR_00",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_pif_42gp_stage AS (\n\tSELECT\n\tlogical_flag,\n\tpif_symbol,\n\tpif_policy_number,\n\tpif_module,\n\tipfcgp_year_of_loss,\n\tipfcgp_month_of_loss,\n\tipfcgp_day_of_loss,\n\tipfcgp_loss_occurence\n\tFROM (\n\t\tSELECT \n\t\t\tlogical_flag,\n\t\t\tpif_symbol,\n\t\t\tpif_policy_number,\n\t\t\tpif_module,\n\t\t\tipfcgp_year_of_loss,\n\t\t\tipfcgp_month_of_loss,\n\t\t\tipfcgp_day_of_loss,\n\t\t\tipfcgp_loss_occurence\n\t\tFROM pif_42gp_stage\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pif_symbol,pif_policy_number,pif_module,ipfcgp_year_of_loss,ipfcgp_month_of_loss,ipfcgp_day_of_loss,ipfcgp_loss_occurence ORDER BY logical_flag) = 1\n),\nSQ_pifmstr_PIF_42GJ AS (\n\n-- TODO Manual --\n\n),\nEXP_INPUTS AS (\n\tSELECT\n\tIPFC4J_ID_NUMBER AS IPFC4J_ID_NUMBER1,\n\t-- *INF*: LTRIM(RTRIM(IPFC4J_ID_NUMBER1))\n\tLTRIM(RTRIM(IPFC4J_ID_NUMBER1)) AS IPFC4J_ID_NUMBER\n\tFROM SQ_pifmstr_PIF_42GJ\n),\nLKP_pif_42gj_stage_history AS (\n),\nEXP_Evaluate AS (\n\tSELECT\n\tEXP_INPUTS.IPFC4J_ID_NUMBER,\n\tLKP_pif_42gj_stage_history.lkp_Ipfc4J_Id_Number,\n\tLKP_pif_42gj_stage_history.Ipfc4J_Id_Number_Tokens,\n\t-- *INF*: IIF(ISNULL(REPLACECHR(0,lkp_Ipfc4J_Id_Number,CHR(13),'')),IPFC4J_ID_NUMBER,Ipfc4J_Id_Number_Tokens)\r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \r\n\t-- \n\tIFF(\n\t    REGEXP_REPLACE(lkp_Ipfc4J_Id_Number,CHR(13),'','i') IS NULL, IPFC4J_ID_NUMBER,\n\t    Ipfc4J_Id_Number_Tokens\n\t) AS v_Ipfc4J_Id_Number1,\n\tv_Ipfc4J_Id_Number1 AS o_Ipfc4J_Id_Number\n\tFROM EXP_INPUTS\n\tLEFT JOIN LKP_pif_42gj_stage_history\n\tON LKP_pif_42gj_stage_history.lkp_Ipfc4J_Id_Number = EXP_INPUTS.IPFC4J_ID_NUMBER\n),\nFIL_REMV_NULL_SEG_ID AS (\n\tSELECT\n\tSQ_pifmstr_PIF_42GJ.PIF_SYMBOL, \n\tSQ_pifmstr_PIF_42GJ.PIF_POLICY_NUMBER, \n\tSQ_pifmstr_PIF_42GJ.PIF_MODULE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_REC_LENGTH_RED, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ACTION_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_FILE_ID, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEGMENT_ID, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEGMENT_LEVEL_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEGMENT_PART_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SUB_PART_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_INSURANCE_LINE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOCATION_NUMBER, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SUB_LOCATION_NUMBER, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_RISK_UNIT_GROUP, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_CLASS_CODE_GROUP, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_CLASS_CODE_MEMBER, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_RISK_UNIT, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_RISK_SEQUENCE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_RISK_TYPE_IND, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_YEAR_ITEM_EFFECTIVE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_MONTH_ITEM_EFFECTIVE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_DAY_ITEM_EFFECTIVE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOSS_YEAR, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOSS_MONTH, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOSS_DAY, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOSS_OCCURENCE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOSS_CLAIMANT, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_USE_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEQUENCE_USE_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_AI_SEQ_USE_CODE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_YEAR_PROCESS, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_MONTH_PROCESS, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_DAY_PROCESS, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_YEAR_CHANGE_ENTRY, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_MONTH_CHANGE_ENTRY, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_DAY_CHANGE_ENTRY, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEQUENCE_CHANGE_ENTRY, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SEGMENT_STATUS, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ENTRY_OPERATOR, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_USE_CODE_DATA, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_SORT_NAME, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_NAME_TYPE_IND, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ADDRESS_LINE_1, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ADDR_LIN_2_POS_1, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ADDR_LIN_2_POS_2_30, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ADDRESS_LINE_3, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ADDRESS_LINE_4, \n\tEXP_Evaluate.o_Ipfc4J_Id_Number AS IPFC4J_ID_NUMBER, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ZIP_BASIC, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_ZIP_EXPANDED, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PHONE_AREA, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PHONE_EXCHANGE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PHONE_NUMBER, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PHONE_EXTENSION, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_INTEREST_ITEM, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_LOCATION_STATE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_OFFSET_ONSET_IND, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PMS_FUTURE_USE_4J_1, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_CUST_SPL_USE_4J_1, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_PMS_FUTURE_USE, \n\tSQ_pifmstr_PIF_42GJ.IPFC4J_YR2000_CUST_USE\n\tFROM EXP_Evaluate\n\t -- Manually join with SQ_pifmstr_PIF_42GJ\n\tWHERE NOT ISNULL(IPFC4J_SEGMENT_ID)\n),\nSRT_pifmstr_PIF_42GJ_stage AS (\n\tSELECT\n\tPIF_SYMBOL, \n\tPIF_POLICY_NUMBER, \n\tPIF_MODULE, \n\tIPFC4J_REC_LENGTH_RED, \n\tIPFC4J_ACTION_CODE, \n\tIPFC4J_FILE_ID, \n\tIPFC4J_SEGMENT_ID, \n\tIPFC4J_SEGMENT_LEVEL_CODE, \n\tIPFC4J_SEGMENT_PART_CODE, \n\tIPFC4J_SUB_PART_CODE, \n\tIPFC4J_INSURANCE_LINE, \n\tIPFC4J_LOCATION_NUMBER, \n\tIPFC4J_SUB_LOCATION_NUMBER, \n\tIPFC4J_RISK_UNIT_GROUP, \n\tIPFC4J_CLASS_CODE_GROUP, \n\tIPFC4J_CLASS_CODE_MEMBER, \n\tIPFC4J_RISK_UNIT, \n\tIPFC4J_RISK_SEQUENCE, \n\tIPFC4J_RISK_TYPE_IND, \n\tIPFC4J_LOSS_YEAR, \n\tIPFC4J_LOSS_MONTH, \n\tIPFC4J_LOSS_DAY, \n\tIPFC4J_LOSS_OCCURENCE, \n\tIPFC4J_LOSS_CLAIMANT, \n\tIPFC4J_USE_CODE, \n\tIPFC4J_YEAR_ITEM_EFFECTIVE, \n\tIPFC4J_MONTH_ITEM_EFFECTIVE, \n\tIPFC4J_DAY_ITEM_EFFECTIVE, \n\tIPFC4J_SEQUENCE_USE_CODE, \n\tIPFC4J_AI_SEQ_USE_CODE, \n\tIPFC4J_YEAR_PROCESS, \n\tIPFC4J_MONTH_PROCESS, \n\tIPFC4J_DAY_PROCESS, \n\tIPFC4J_YEAR_CHANGE_ENTRY, \n\tIPFC4J_MONTH_CHANGE_ENTRY, \n\tIPFC4J_DAY_CHANGE_ENTRY, \n\tIPFC4J_SEQUENCE_CHANGE_ENTRY, \n\tIPFC4J_SEGMENT_STATUS, \n\tIPFC4J_ENTRY_OPERATOR, \n\tIPFC4J_USE_CODE_DATA, \n\tIPFC4J_SORT_NAME, \n\tIPFC4J_NAME_TYPE_IND, \n\tIPFC4J_ADDRESS_LINE_1, \n\tIPFC4J_ADDR_LIN_2_POS_1, \n\tIPFC4J_ADDR_LIN_2_POS_2_30, \n\tIPFC4J_ADDRESS_LINE_3, \n\tIPFC4J_ADDRESS_LINE_4, \n\tIPFC4J_ID_NUMBER, \n\tIPFC4J_ZIP_BASIC, \n\tIPFC4J_ZIP_EXPANDED, \n\tIPFC4J_PHONE_AREA, \n\tIPFC4J_PHONE_EXCHANGE, \n\tIPFC4J_PHONE_NUMBER, \n\tIPFC4J_PHONE_EXTENSION, \n\tIPFC4J_INTEREST_ITEM, \n\tIPFC4J_LOCATION_STATE, \n\tIPFC4J_OFFSET_ONSET_IND, \n\tIPFC4J_PMS_FUTURE_USE_4J_1, \n\tIPFC4J_CUST_SPL_USE_4J_1, \n\tIPFC4J_PMS_FUTURE_USE, \n\tIPFC4J_YR2000_CUST_USE\n\tFROM FIL_REMV_NULL_SEG_ID\n\tORDER BY PIF_SYMBOL ASC, PIF_POLICY_NUMBER ASC, PIF_MODULE ASC, IPFC4J_LOSS_YEAR ASC, IPFC4J_LOSS_MONTH ASC, IPFC4J_LOSS_DAY ASC, IPFC4J_LOSS_OCCURENCE ASC, IPFC4J_LOSS_CLAIMANT ASC, IPFC4J_USE_CODE ASC, IPFC4J_YEAR_ITEM_EFFECTIVE ASC, IPFC4J_MONTH_ITEM_EFFECTIVE ASC, IPFC4J_DAY_ITEM_EFFECTIVE ASC, IPFC4J_ENTRY_OPERATOR ASC\n),\nAGG_pifmstr_PIF_42GJ_stage AS (\n\tSELECT\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE,\n\tIPFC4J_REC_LENGTH_RED,\n\tIPFC4J_ACTION_CODE,\n\tIPFC4J_FILE_ID,\n\tIPFC4J_SEGMENT_ID,\n\tIPFC4J_SEGMENT_LEVEL_CODE,\n\tIPFC4J_SEGMENT_PART_CODE,\n\tIPFC4J_SUB_PART_CODE,\n\tIPFC4J_INSURANCE_LINE,\n\tIPFC4J_LOCATION_NUMBER,\n\tIPFC4J_SUB_LOCATION_NUMBER,\n\tIPFC4J_RISK_UNIT_GROUP,\n\tIPFC4J_CLASS_CODE_GROUP,\n\tIPFC4J_CLASS_CODE_MEMBER,\n\tIPFC4J_RISK_UNIT,\n\tIPFC4J_RISK_SEQUENCE,\n\tIPFC4J_RISK_TYPE_IND,\n\tIPFC4J_YEAR_ITEM_EFFECTIVE,\n\tIPFC4J_MONTH_ITEM_EFFECTIVE,\n\tIPFC4J_DAY_ITEM_EFFECTIVE,\n\tIPFC4J_LOSS_YEAR,\n\tIPFC4J_LOSS_MONTH,\n\tIPFC4J_LOSS_DAY,\n\tIPFC4J_LOSS_OCCURENCE,\n\tIPFC4J_LOSS_CLAIMANT,\n\tIPFC4J_USE_CODE,\n\tIPFC4J_SEQUENCE_USE_CODE,\n\tIPFC4J_AI_SEQ_USE_CODE,\n\tIPFC4J_YEAR_PROCESS,\n\tIPFC4J_MONTH_PROCESS,\n\tIPFC4J_DAY_PROCESS,\n\tIPFC4J_YEAR_CHANGE_ENTRY,\n\tIPFC4J_MONTH_CHANGE_ENTRY,\n\tIPFC4J_DAY_CHANGE_ENTRY,\n\tIPFC4J_SEQUENCE_CHANGE_ENTRY,\n\tIPFC4J_SEGMENT_STATUS,\n\tIPFC4J_ENTRY_OPERATOR,\n\tIPFC4J_USE_CODE_DATA,\n\tIPFC4J_SORT_NAME,\n\tIPFC4J_NAME_TYPE_IND,\n\tIPFC4J_ADDRESS_LINE_1,\n\tIPFC4J_ADDR_LIN_2_POS_1,\n\tIPFC4J_ADDR_LIN_2_POS_2_30,\n\tIPFC4J_ADDRESS_LINE_3,\n\tIPFC4J_ADDRESS_LINE_4,\n\tIPFC4J_ID_NUMBER,\n\tIPFC4J_ZIP_BASIC,\n\tIPFC4J_ZIP_EXPANDED,\n\tIPFC4J_PHONE_AREA,\n\tIPFC4J_PHONE_EXCHANGE,\n\tIPFC4J_PHONE_NUMBER,\n\tIPFC4J_PHONE_EXTENSION,\n\tIPFC4J_INTEREST_ITEM,\n\tIPFC4J_LOCATION_STATE,\n\tIPFC4J_OFFSET_ONSET_IND,\n\tIPFC4J_PMS_FUTURE_USE_4J_1,\n\tIPFC4J_CUST_SPL_USE_4J_1,\n\tIPFC4J_PMS_FUTURE_USE,\n\tIPFC4J_YR2000_CUST_USE\n\tFROM SRT_pifmstr_PIF_42GJ_stage\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY PIF_SYMBOL, PIF_POLICY_NUMBER, PIF_MODULE, IPFC4J_LOSS_YEAR, IPFC4J_LOSS_MONTH, IPFC4J_LOSS_DAY, IPFC4J_LOSS_OCCURENCE, IPFC4J_LOSS_CLAIMANT, IPFC4J_USE_CODE ORDER BY NULL) = 1\n),\nEXP_pifmstr_PIF_42GJ_stage AS (\n\tSELECT\n\tPIF_SYMBOL,\n\tPIF_POLICY_NUMBER,\n\tPIF_MODULE,\n\tIPFC4J_REC_LENGTH_RED,\n\tIPFC4J_ACTION_CODE,\n\tIPFC4J_FILE_ID,\n\tIPFC4J_SEGMENT_ID,\n\tIPFC4J_SEGMENT_LEVEL_CODE,\n\tIPFC4J_SEGMENT_PART_CODE,\n\tIPFC4J_SUB_PART_CODE,\n\tIPFC4J_INSURANCE_LINE,\n\tIPFC4J_LOCATION_NUMBER,\n\tIPFC4J_SUB_LOCATION_NUMBER,\n\tIPFC4J_RISK_UNIT_GROUP,\n\tIPFC4J_CLASS_CODE_GROUP,\n\tIPFC4J_CLASS_CODE_MEMBER,\n\tIPFC4J_RISK_UNIT,\n\tIPFC4J_RISK_SEQUENCE,\n\tIPFC4J_RISK_TYPE_IND,\n\tIPFC4J_YEAR_ITEM_EFFECTIVE,\n\tIPFC4J_MONTH_ITEM_EFFECTIVE,\n\tIPFC4J_DAY_ITEM_EFFECTIVE,\n\tIPFC4J_LOSS_YEAR,\n\tIPFC4J_LOSS_MONTH,\n\tIPFC4J_LOSS_DAY,\n\tIPFC4J_LOSS_OCCURENCE,\n\tIPFC4J_LOSS_CLAIMANT,\n\tIPFC4J_USE_CODE,\n\tIPFC4J_SEQUENCE_USE_CODE,\n\tIPFC4J_AI_SEQ_USE_CODE,\n\tIPFC4J_YEAR_PROCESS,\n\tIPFC4J_MONTH_PROCESS,\n\tIPFC4J_DAY_PROCESS,\n\tIPFC4J_YEAR_CHANGE_ENTRY,\n\tIPFC4J_MONTH_CHANGE_ENTRY,\n\tIPFC4J_DAY_CHANGE_ENTRY,\n\tIPFC4J_SEQUENCE_CHANGE_ENTRY,\n\tIPFC4J_SEGMENT_STATUS,\n\tIPFC4J_ENTRY_OPERATOR,\n\tIPFC4J_USE_CODE_DATA,\n\tIPFC4J_SORT_NAME,\n\tIPFC4J_NAME_TYPE_IND,\n\tIPFC4J_ADDRESS_LINE_1,\n\tIPFC4J_ADDR_LIN_2_POS_1,\n\tIPFC4J_ADDR_LIN_2_POS_2_30,\n\tIPFC4J_ADDRESS_LINE_3,\n\tIPFC4J_ADDRESS_LINE_4,\n\tIPFC4J_ID_NUMBER,\n\tIPFC4J_ZIP_BASIC,\n\tIPFC4J_ZIP_EXPANDED,\n\tIPFC4J_PHONE_AREA,\n\tIPFC4J_PHONE_EXCHANGE,\n\tIPFC4J_PHONE_NUMBER,\n\tIPFC4J_PHONE_EXTENSION,\n\tIPFC4J_INTEREST_ITEM,\n\tIPFC4J_LOCATION_STATE,\n\tIPFC4J_OFFSET_ONSET_IND,\n\tIPFC4J_PMS_FUTURE_USE_4J_1,\n\tIPFC4J_CUST_SPL_USE_4J_1,\n\tIPFC4J_PMS_FUTURE_USE,\n\tIPFC4J_YR2000_CUST_USE,\n\t-- *INF*: :LKP.LKP_PIF_42GP_STAGE(PIF_SYMBOL, PIF_POLICY_NUMBER, PIF_MODULE, IPFC4J_LOSS_YEAR, IPFC4J_LOSS_MONTH, IPFC4J_LOSS_DAY, IPFC4J_LOSS_OCCURENCE)\n\tLKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.logical_flag AS LOGICAL_FLAG_OP,\n\tSYSDATE AS EXTRACT_DATE,\n\tSYSDATE AS AS_OF_DATE,\n\t'' AS RECORD_COUNT_OP,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID\n\tFROM AGG_pifmstr_PIF_42GJ_stage\n\tLEFT JOIN LKP_PIF_42GP_STAGE LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE\n\tON LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_symbol = PIF_SYMBOL\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_policy_number = PIF_POLICY_NUMBER\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.pif_module = PIF_MODULE\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_year_of_loss = IPFC4J_LOSS_YEAR\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_month_of_loss = IPFC4J_LOSS_MONTH\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_day_of_loss = IPFC4J_LOSS_DAY\n\tAND LKP_PIF_42GP_STAGE_PIF_SYMBOL_PIF_POLICY_NUMBER_PIF_MODULE_IPFC4J_LOSS_YEAR_IPFC4J_LOSS_MONTH_IPFC4J_LOSS_DAY_IPFC4J_LOSS_OCCURENCE.ipfcgp_loss_occurence = IPFC4J_LOSS_OCCURENCE\n\n),\npifmstr_PIF_42GJ_stage AS (\n\tTRUNCATE TABLE pif_42gj_stage;\n\tINSERT INTO pif_42gj_stage\n\t(pif_symbol, pif_policy_number, pif_module, ipfc4j_rec_length_red, ipfc4j_action_code, ipfc4j_file_id, ipfc4j_segment_id, ipfc4j_segment_level_code, ipfc4j_segment_part_code, ipfc4j_sub_part_code, ipfc4j_insurance_line, ipfc4j_location_number, ipfc4j_sub_location_number, ipfc4j_risk_unit_group, ipfc4j_class_code_group, ipfc4j_class_code_member, ipfc4j_risk_unit, ipfc4j_risk_sequence, ipfc4j_risk_type_ind, ipfc4j_year_item_effective, ipfc4j_month_item_effective, ipfc4j_day_item_effective, ipfc4j_loss_year, ipfc4j_loss_month, ipfc4j_loss_day, ipfc4j_loss_occurence, ipfc4j_loss_claimant, ipfc4j_use_code, ipfc4j_sequence_use_code, ipfc4j_ai_seq_use_code, ipfc4j_year_process, ipfc4j_month_process, ipfc4j_day_process, ipfc4j_year_change_entry, ipfc4j_month_change_entry, ipfc4j_day_change_entry, ipfc4j_sequence_change_entry, ipfc4j_segment_status, ipfc4j_entry_operator, ipfc4j_use_code_data, ipfc4j_sort_name, ipfc4j_name_type_ind, ipfc4j_address_line_1, ipfc4j_addr_lin_2_pos_1, ipfc4j_addr_lin_2_pos_2_30, ipfc4j_address_line_3, ipfc4j_address_line_4, ipfc4j_id_number, ipfc4j_zip_basic, ipfc4j_zip_expanded, ipfc4j_phone_area, ipfc4j_phone_exchange, ipfc4j_phone_number, ipfc4j_phone_extension, ipfc4j_interest_item, ipfc4j_location_state, ipfc4j_offset_onset_ind, ipfc4j_pms_future_use_4j_1, ipfc4j_cust_spl_use_4j_1, ipfc4j_pms_future_use, ipfc4j_yr2000_cust_use, logical_flag, extract_date, as_of_date, record_count, source_system_id)\n\tSELECT \n\tPIF_SYMBOL AS PIF_SYMBOL, \n\tPIF_POLICY_NUMBER AS PIF_POLICY_NUMBER, \n\tPIF_MODULE AS PIF_MODULE, \n\tIPFC4J_REC_LENGTH_RED AS IPFC4J_REC_LENGTH_RED, \n\tIPFC4J_ACTION_CODE AS IPFC4J_ACTION_CODE, \n\tIPFC4J_FILE_ID AS IPFC4J_FILE_ID, \n\tIPFC4J_SEGMENT_ID AS IPFC4J_SEGMENT_ID, \n\tIPFC4J_SEGMENT_LEVEL_CODE AS IPFC4J_SEGMENT_LEVEL_CODE, \n\tIPFC4J_SEGMENT_PART_CODE AS IPFC4J_SEGMENT_PART_CODE, \n\tIPFC4J_SUB_PART_CODE AS IPFC4J_SUB_PART_CODE, \n\tIPFC4J_INSURANCE_LINE AS IPFC4J_INSURANCE_LINE, \n\tIPFC4J_LOCATION_NUMBER AS IPFC4J_LOCATION_NUMBER, \n\tIPFC4J_SUB_LOCATION_NUMBER AS IPFC4J_SUB_LOCATION_NUMBER, \n\tIPFC4J_RISK_UNIT_GROUP AS IPFC4J_RISK_UNIT_GROUP, \n\tIPFC4J_CLASS_CODE_GROUP AS IPFC4J_CLASS_CODE_GROUP, \n\tIPFC4J_CLASS_CODE_MEMBER AS IPFC4J_CLASS_CODE_MEMBER, \n\tIPFC4J_RISK_UNIT AS IPFC4J_RISK_UNIT, \n\tIPFC4J_RISK_SEQUENCE AS IPFC4J_RISK_SEQUENCE, \n\tIPFC4J_RISK_TYPE_IND AS IPFC4J_RISK_TYPE_IND, \n\tIPFC4J_YEAR_ITEM_EFFECTIVE AS IPFC4J_YEAR_ITEM_EFFECTIVE, \n\tIPFC4J_MONTH_ITEM_EFFECTIVE AS IPFC4J_MONTH_ITEM_EFFECTIVE, \n\tIPFC4J_DAY_ITEM_EFFECTIVE AS IPFC4J_DAY_ITEM_EFFECTIVE, \n\tIPFC4J_LOSS_YEAR AS IPFC4J_LOSS_YEAR, \n\tIPFC4J_LOSS_MONTH AS IPFC4J_LOSS_MONTH, \n\tIPFC4J_LOSS_DAY AS IPFC4J_LOSS_DAY, \n\tIPFC4J_LOSS_OCCURENCE AS IPFC4J_LOSS_OCCURENCE, \n\tIPFC4J_LOSS_CLAIMANT AS IPFC4J_LOSS_CLAIMANT, \n\tIPFC4J_USE_CODE AS IPFC4J_USE_CODE, \n\tIPFC4J_SEQUENCE_USE_CODE AS IPFC4J_SEQUENCE_USE_CODE, \n\tIPFC4J_AI_SEQ_USE_CODE AS IPFC4J_AI_SEQ_USE_CODE, \n\tIPFC4J_YEAR_PROCESS AS IPFC4J_YEAR_PROCESS, \n\tIPFC4J_MONTH_PROCESS AS IPFC4J_MONTH_PROCESS, \n\tIPFC4J_DAY_PROCESS AS IPFC4J_DAY_PROCESS, \n\tIPFC4J_YEAR_CHANGE_ENTRY AS IPFC4J_YEAR_CHANGE_ENTRY, \n\tIPFC4J_MONTH_CHANGE_ENTRY AS IPFC4J_MONTH_CHANGE_ENTRY, \n\tIPFC4J_DAY_CHANGE_ENTRY AS IPFC4J_DAY_CHANGE_ENTRY, \n\tIPFC4J_SEQUENCE_CHANGE_ENTRY AS IPFC4J_SEQUENCE_CHANGE_ENTRY, \n\tIPFC4J_SEGMENT_STATUS AS IPFC4J_SEGMENT_STATUS, \n\tIPFC4J_ENTRY_OPERATOR AS IPFC4J_ENTRY_OPERATOR, \n\tIPFC4J_USE_CODE_DATA AS IPFC4J_USE_CODE_DATA, \n\tIPFC4J_SORT_NAME AS IPFC4J_SORT_NAME, \n\tIPFC4J_NAME_TYPE_IND AS IPFC4J_NAME_TYPE_IND, \n\tIPFC4J_ADDRESS_LINE_1 AS IPFC4J_ADDRESS_LINE_1, \n\tIPFC4J_ADDR_LIN_2_POS_1 AS IPFC4J_ADDR_LIN_2_POS_1, \n\tIPFC4J_ADDR_LIN_2_POS_2_30 AS IPFC4J_ADDR_LIN_2_POS_2_30, \n\tIPFC4J_ADDRESS_LINE_3 AS IPFC4J_ADDRESS_LINE_3, \n\tIPFC4J_ADDRESS_LINE_4 AS IPFC4J_ADDRESS_LINE_4, \n\tIPFC4J_ID_NUMBER AS IPFC4J_ID_NUMBER, \n\tIPFC4J_ZIP_BASIC AS IPFC4J_ZIP_BASIC, \n\tIPFC4J_ZIP_EXPANDED AS IPFC4J_ZIP_EXPANDED, \n\tIPFC4J_PHONE_AREA AS IPFC4J_PHONE_AREA, \n\tIPFC4J_PHONE_EXCHANGE AS IPFC4J_PHONE_EXCHANGE, \n\tIPFC4J_PHONE_NUMBER AS IPFC4J_PHONE_NUMBER, \n\tIPFC4J_PHONE_EXTENSION AS IPFC4J_PHONE_EXTENSION, \n\tIPFC4J_INTEREST_ITEM AS IPFC4J_INTEREST_ITEM, \n\tIPFC4J_LOCATION_STATE AS IPFC4J_LOCATION_STATE, \n\tIPFC4J_OFFSET_ONSET_IND AS IPFC4J_OFFSET_ONSET_IND, \n\tIPFC4J_PMS_FUTURE_USE_4J_1 AS IPFC4J_PMS_FUTURE_USE_4J_1, \n\tIPFC4J_CUST_SPL_USE_4J_1 AS IPFC4J_CUST_SPL_USE_4J_1, \n\tIPFC4J_PMS_FUTURE_USE AS IPFC4J_PMS_FUTURE_USE, \n\tIPFC4J_YR2000_CUST_USE AS IPFC4J_YR2000_CUST_USE, \n\tLOGICAL_FLAG_OP AS LOGICAL_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT_OP AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID\n\tFROM EXP_pifmstr_PIF_42GJ_stage\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "CustomerStaging/"
        },
        "annotations": []
    }
}