WITH
SQ_CLIENT_TAB_STAGE AS (
	SELECT
		CLIENT_TAB_ID,
		CLIENT_ID,
		HISTORY_VLD_NBR,
		CICL_EFF_DT,
		CICL_PRI_SUB_CD,
		CICL_FST_NM,
		CICL_LST_NM,
		CICL_MDL_NM,
		NM_PFX,
		NM_SFX,
		PRIMARY_PRO_DSN_CD,
		LEG_ENT_CD,
		CICL_SDX_CD,
		CICL_OGN_INCEPT_CD,
		CICL_ADD_NM_IND,
		CICL_DOB_DT,
		CICL_BIR_ST_CD,
		GENDER_CD,
		PRI_LGG_CD,
		USER_ID,
		STATUS_CD,
		TRMINAL_ID,
		CICL_EXP_DT,
		CICL_EFF_ACY_TS,
		CICL_EXP_ACY_TS,
		STATUATORY_TLE_CD,
		CICL_LNG_NM,
		EXTRACT_DATE,
		AS_OF_DATE,
		RECORD_COUNT,
		SOURCE_SYSTEM_ID
	FROM CLIENT_TAB_STAGE
),
EXP_CLIENT_TAB_STAGE AS (
	SELECT
	CLIENT_TAB_ID,
	CLIENT_ID,
	HISTORY_VLD_NBR,
	CICL_EFF_DT,
	CICL_PRI_SUB_CD,
	CICL_FST_NM,
	CICL_LST_NM,
	CICL_MDL_NM,
	NM_PFX,
	NM_SFX,
	PRIMARY_PRO_DSN_CD,
	LEG_ENT_CD,
	CICL_SDX_CD,
	CICL_OGN_INCEPT_CD,
	CICL_ADD_NM_IND,
	CICL_DOB_DT,
	CICL_BIR_ST_CD,
	GENDER_CD,
	PRI_LGG_CD,
	USER_ID,
	STATUS_CD,
	TRMINAL_ID,
	CICL_EXP_DT,
	CICL_EFF_ACY_TS,
	CICL_EXP_ACY_TS,
	STATUATORY_TLE_CD,
	CICL_LNG_NM,
	EXTRACT_DATE,
	AS_OF_DATE,
	RECORD_COUNT,
	SOURCE_SYSTEM_ID,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP
	FROM SQ_CLIENT_TAB_STAGE
),
ARCH_CLIENT_TAB_STAGE AS (
	INSERT INTO ARCH_CLIENT_TAB_STAGE
	(CLIENT_TAB_ID, CLIENT_ID, HISTORY_VLD_NBR, CICL_EFF_DT, CICL_PRI_SUB_CD, CICL_FST_NM, CICL_LST_NM, CICL_MDL_NM, NM_PFX, NM_SFX, PRIMARY_PRO_DSN_CD, LEG_ENT_CD, CICL_SDX_CD, CICL_OGN_INCEPT_CD, CICL_ADD_NM_IND, CICL_DOB_DT, CICL_BIR_ST_CD, GENDER_CD, PRI_LGG_CD, USER_ID, STATUS_CD, TRMINAL_ID, CICL_EXP_DT, CICL_EFF_ACY_TS, CICL_EXP_ACY_TS, STATUATORY_TLE_CD, CICL_LNG_NM, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)
	SELECT 
	CLIENT_TAB_ID, 
	CLIENT_ID, 
	HISTORY_VLD_NBR, 
	CICL_EFF_DT, 
	CICL_PRI_SUB_CD, 
	CICL_FST_NM, 
	CICL_LST_NM, 
	CICL_MDL_NM, 
	NM_PFX, 
	NM_SFX, 
	PRIMARY_PRO_DSN_CD, 
	LEG_ENT_CD, 
	CICL_SDX_CD, 
	CICL_OGN_INCEPT_CD, 
	CICL_ADD_NM_IND, 
	CICL_DOB_DT, 
	CICL_BIR_ST_CD, 
	GENDER_CD, 
	PRI_LGG_CD, 
	USER_ID, 
	STATUS_CD, 
	TRMINAL_ID, 
	CICL_EXP_DT, 
	CICL_EFF_ACY_TS, 
	CICL_EXP_ACY_TS, 
	STATUATORY_TLE_CD, 
	CICL_LNG_NM, 
	EXTRACT_DATE, 
	AS_OF_DATE, 
	RECORD_COUNT, 
	SOURCE_SYSTEM_ID, 
	AUDIT_ID_OP AS AUDIT_ID
	FROM EXP_CLIENT_TAB_STAGE
),