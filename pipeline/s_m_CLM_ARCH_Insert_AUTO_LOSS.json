{
    "name": "s_m_CLM_ARCH_Insert_AUTO_LOSS",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_ARCH_Insert_AUTO_LOSS",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_AUTO_LOSS_STAGE1 AS (\n\tSELECT AUTO_LOSS_STAGE.AUTO_LOSS_ID, AUTO_LOSS_STAGE.CAU_CLAIM_NBR, AUTO_LOSS_STAGE.CAU_OBJECT_SEQ_NBR, AUTO_LOSS_STAGE.CAU_CAR_YR, AUTO_LOSS_STAGE.CAU_CAR_MAKE_NM, AUTO_LOSS_STAGE.CAU_CON_CLASS_CD, AUTO_LOSS_STAGE.CAU_ENGINE_TYPE_CD, AUTO_LOSS_STAGE.CAU_CAR_TAKEN_DT, AUTO_LOSS_STAGE.CAU_CAR_RGS_NBR, AUTO_LOSS_STAGE.CAU_ENTRY_OPR_ID, AUTO_LOSS_STAGE.CAU_UPDATE_OPR_ID, AUTO_LOSS_STAGE.CAU_CREATE_TS, AUTO_LOSS_STAGE.CAU_PMSD_TS, AUTO_LOSS_STAGE.CAU_UPD_TS, AUTO_LOSS_STAGE.CAU_CAR_MODEL_NM, AUTO_LOSS_STAGE.CAU_SPEED_LIM_NBR, AUTO_LOSS_STAGE.CAU_ACL_SPEED_NBR, AUTO_LOSS_STAGE.CAU_COUNTY, AUTO_LOSS_STAGE.CAU_VEHICLE_ID_NBR, AUTO_LOSS_STAGE.CAU_CAR_PLATE_NBR, AUTO_LOSS_STAGE.CAU_GUILT_CD, AUTO_LOSS_STAGE.CAU_CAR_TYPE_CD, AUTO_LOSS_STAGE.CAU_PERMISSION_IND, AUTO_LOSS_STAGE.CAU_VIOLATION_IND, AUTO_LOSS_STAGE.CAU_DRIVABLE_IND, AUTO_LOSS_STAGE.CAU_TRAILER_IND, AUTO_LOSS_STAGE.CAU_DENSELY_IND, AUTO_LOSS_STAGE.CAU_TRAF_LIGHT_IND, AUTO_LOSS_STAGE.CAU_ROAD_NBR, AUTO_LOSS_STAGE.CAU_ODOMETER_NBR, AUTO_LOSS_STAGE.CAU_ROAD_TYPE_CD, AUTO_LOSS_STAGE.CAU_ROAD_SRF_CD, AUTO_LOSS_STAGE.CAU_LIGHT_CON_CD, AUTO_LOSS_STAGE.CAU_PASSENGER_NBR, AUTO_LOSS_STAGE.CAU_PLACE_ACC_CD, AUTO_LOSS_STAGE.CAU_EPR_VEH_IND, AUTO_LOSS_STAGE.CAU_LEASE_VEH_IND, AUTO_LOSS_STAGE.CAU_OWNER_SAME_IND, AUTO_LOSS_STAGE.CAU_DRV_SAME_IND, AUTO_LOSS_STAGE.CAU_VIOLATION_CD, AUTO_LOSS_STAGE.CAU_RGS_STATE_CD, AUTO_LOSS_STAGE.CAU_RENT_START_DT, AUTO_LOSS_STAGE.CAU_RENT_END_DT, AUTO_LOSS_STAGE.CAU_DRV_LIC_NBR, AUTO_LOSS_STAGE.CAU_DRV_SEQ_NBR, AUTO_LOSS_STAGE.CAU_DRIVER_NBR, AUTO_LOSS_STAGE.CAU_PEM_GIVEN_ID, AUTO_LOSS_STAGE.CAU_UNIT_LEN_CD, AUTO_LOSS_STAGE.CAU_VEH_CAP_NBR, AUTO_LOSS_STAGE.CAU_VEH_ST_AMT, AUTO_LOSS_STAGE.CAU_GAR_ST_CD, AUTO_LOSS_STAGE.CAU_LEASED_IND, AUTO_LOSS_STAGE.CAU_OBJECT_TYPE_CD, AUTO_LOSS_STAGE.CAU_GAR_LOC_ID, AUTO_LOSS_STAGE.CAU_VEH_USE_ID, AUTO_LOSS_STAGE.CAU_UNIT_TFT_IND, AUTO_LOSS_STAGE.CAU_INSURIN_CO_ID, AUTO_LOSS_STAGE.CAU_EXCLUDE_IND, AUTO_LOSS_STAGE.CAU_CAR_COLOR, AUTO_LOSS_STAGE.EXTRACT_DATE, AUTO_LOSS_STAGE.AS_OF_DATE, AUTO_LOSS_STAGE.RECORD_COUNT, AUTO_LOSS_STAGE.SOURCE_SYSTEM_ID \r\n\tFROM\r\n\t AUTO_LOSS_STAGE\r\n\tWHERE\r\n\tAUTO_LOSS_STAGE.CAU_CREATE_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\r\n\tOR\r\n\tAUTO_LOSS_STAGE.CAU_UPD_TS >= '@{pipeline().parameters.SELECTION_START_TS}'\n),\nEXP_AUTO_LOSS_STAGE AS (\n\tSELECT\n\tAUTO_LOSS_ID,\n\tCAU_CLAIM_NBR,\n\tCAU_OBJECT_SEQ_NBR,\n\tCAU_CAR_YR,\n\tCAU_CAR_MAKE_NM,\n\tCAU_CON_CLASS_CD,\n\tCAU_ENGINE_TYPE_CD,\n\tCAU_CAR_TAKEN_DT,\n\tCAU_CAR_RGS_NBR,\n\tCAU_ENTRY_OPR_ID,\n\tCAU_UPDATE_OPR_ID,\n\tCAU_CREATE_TS,\n\tCAU_PMSD_TS,\n\tCAU_UPD_TS,\n\tCAU_CAR_MODEL_NM,\n\tCAU_SPEED_LIM_NBR,\n\tCAU_ACL_SPEED_NBR,\n\tCAU_COUNTY,\n\tCAU_VEHICLE_ID_NBR,\n\tCAU_CAR_PLATE_NBR,\n\tCAU_GUILT_CD,\n\tCAU_CAR_TYPE_CD,\n\tCAU_PERMISSION_IND,\n\tCAU_VIOLATION_IND,\n\tCAU_DRIVABLE_IND,\n\tCAU_TRAILER_IND,\n\tCAU_DENSELY_IND,\n\tCAU_TRAF_LIGHT_IND,\n\tCAU_ROAD_NBR,\n\tCAU_ODOMETER_NBR,\n\tCAU_ROAD_TYPE_CD,\n\tCAU_ROAD_SRF_CD,\n\tCAU_LIGHT_CON_CD,\n\tCAU_PASSENGER_NBR,\n\tCAU_PLACE_ACC_CD,\n\tCAU_EPR_VEH_IND,\n\tCAU_LEASE_VEH_IND,\n\tCAU_OWNER_SAME_IND,\n\tCAU_DRV_SAME_IND,\n\tCAU_VIOLATION_CD,\n\tCAU_RGS_STATE_CD,\n\tCAU_RENT_START_DT,\n\tCAU_RENT_END_DT,\n\tCAU_DRV_LIC_NBR,\n\tCAU_DRV_SEQ_NBR,\n\tCAU_DRIVER_NBR,\n\tCAU_PEM_GIVEN_ID,\n\tCAU_UNIT_LEN_CD,\n\tCAU_VEH_CAP_NBR,\n\tCAU_VEH_ST_AMT,\n\tCAU_GAR_ST_CD,\n\tCAU_LEASED_IND,\n\tCAU_OBJECT_TYPE_CD,\n\tCAU_GAR_LOC_ID,\n\tCAU_VEH_USE_ID,\n\tCAU_UNIT_TFT_IND,\n\tCAU_INSURIN_CO_ID,\n\tCAU_EXCLUDE_IND,\n\tCAU_CAR_COLOR,\n\tEXTRACT_DATE,\n\tAS_OF_DATE,\n\tRECORD_COUNT,\n\tSOURCE_SYSTEM_ID AS SOURCE_ID,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS AUDIT_ID_OP\n\tFROM SQ_AUTO_LOSS_STAGE1\n),\nARCH_AUTO_LOSS_STAGE AS (\n\tINSERT INTO ARCH_AUTO_LOSS_STAGE\n\t(AUTO_LOSS_ID, CAU_CLAIM_NBR, CAU_OBJECT_SEQ_NBR, CAU_CAR_YR, CAU_CAR_MAKE_NM, CAU_CON_CLASS_CD, CAU_ENGINE_TYPE_CD, CAU_CAR_TAKEN_DT, CAU_CAR_RGS_NBR, CAU_ENTRY_OPR_ID, CAU_UPDATE_OPR_ID, CAU_CREATE_TS, CAU_PMSD_TS, CAU_UPD_TS, CAU_CAR_MODEL_NM, CAU_SPEED_LIM_NBR, CAU_ACL_SPEED_NBR, CAU_COUNTY, CAU_VEHICLE_ID_NBR, CAU_CAR_PLATE_NBR, CAU_GUILT_CD, CAU_CAR_TYPE_CD, CAU_PERMISSION_IND, CAU_VIOLATION_IND, CAU_DRIVABLE_IND, CAU_TRAILER_IND, CAU_DENSELY_IND, CAU_TRAF_LIGHT_IND, CAU_ROAD_NBR, CAU_ODOMETER_NBR, CAU_ROAD_TYPE_CD, CAU_ROAD_SRF_CD, CAU_LIGHT_CON_CD, CAU_PASSENGER_NBR, CAU_PLACE_ACC_CD, CAU_EPR_VEH_IND, CAU_LEASE_VEH_IND, CAU_OWNER_SAME_IND, CAU_DRV_SAME_IND, CAU_VIOLATION_CD, CAU_RGS_STATE_CD, CAU_RENT_START_DT, CAU_RENT_END_DT, CAU_DRV_LIC_NBR, CAU_DRV_SEQ_NBR, CAU_DRIVER_NBR, CAU_PEM_GIVEN_ID, CAU_UNIT_LEN_CD, CAU_VEH_CAP_NBR, CAU_VEH_ST_AMT, CAU_GAR_ST_CD, CAU_LEASED_IND, CAU_OBJECT_TYPE_CD, CAU_GAR_LOC_ID, CAU_VEH_USE_ID, CAU_UNIT_TFT_IND, CAU_INSURIN_CO_ID, CAU_EXCLUDE_IND, CAU_CAR_COLOR, EXTRACT_DATE, AS_OF_DATE, RECORD_COUNT, SOURCE_SYSTEM_ID, AUDIT_ID)\n\tSELECT \n\tAUTO_LOSS_ID, \n\tCAU_CLAIM_NBR, \n\tCAU_OBJECT_SEQ_NBR, \n\tCAU_CAR_YR, \n\tCAU_CAR_MAKE_NM, \n\tCAU_CON_CLASS_CD, \n\tCAU_ENGINE_TYPE_CD, \n\tCAU_CAR_TAKEN_DT, \n\tCAU_CAR_RGS_NBR, \n\tCAU_ENTRY_OPR_ID, \n\tCAU_UPDATE_OPR_ID, \n\tCAU_CREATE_TS, \n\tCAU_PMSD_TS, \n\tCAU_UPD_TS, \n\tCAU_CAR_MODEL_NM, \n\tCAU_SPEED_LIM_NBR, \n\tCAU_ACL_SPEED_NBR, \n\tCAU_COUNTY, \n\tCAU_VEHICLE_ID_NBR, \n\tCAU_CAR_PLATE_NBR, \n\tCAU_GUILT_CD, \n\tCAU_CAR_TYPE_CD, \n\tCAU_PERMISSION_IND, \n\tCAU_VIOLATION_IND, \n\tCAU_DRIVABLE_IND, \n\tCAU_TRAILER_IND, \n\tCAU_DENSELY_IND, \n\tCAU_TRAF_LIGHT_IND, \n\tCAU_ROAD_NBR, \n\tCAU_ODOMETER_NBR, \n\tCAU_ROAD_TYPE_CD, \n\tCAU_ROAD_SRF_CD, \n\tCAU_LIGHT_CON_CD, \n\tCAU_PASSENGER_NBR, \n\tCAU_PLACE_ACC_CD, \n\tCAU_EPR_VEH_IND, \n\tCAU_LEASE_VEH_IND, \n\tCAU_OWNER_SAME_IND, \n\tCAU_DRV_SAME_IND, \n\tCAU_VIOLATION_CD, \n\tCAU_RGS_STATE_CD, \n\tCAU_RENT_START_DT, \n\tCAU_RENT_END_DT, \n\tCAU_DRV_LIC_NBR, \n\tCAU_DRV_SEQ_NBR, \n\tCAU_DRIVER_NBR, \n\tCAU_PEM_GIVEN_ID, \n\tCAU_UNIT_LEN_CD, \n\tCAU_VEH_CAP_NBR, \n\tCAU_VEH_ST_AMT, \n\tCAU_GAR_ST_CD, \n\tCAU_LEASED_IND, \n\tCAU_OBJECT_TYPE_CD, \n\tCAU_GAR_LOC_ID, \n\tCAU_VEH_USE_ID, \n\tCAU_UNIT_TFT_IND, \n\tCAU_INSURIN_CO_ID, \n\tCAU_EXCLUDE_IND, \n\tCAU_CAR_COLOR, \n\tEXTRACT_DATE, \n\tAS_OF_DATE, \n\tRECORD_COUNT, \n\tSOURCE_ID AS SOURCE_SYSTEM_ID, \n\tAUDIT_ID_OP AS AUDIT_ID\n\tFROM EXP_AUTO_LOSS_STAGE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "Staging/ClaimsStaging/"
        },
        "annotations": []
    }
}