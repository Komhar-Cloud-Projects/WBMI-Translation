WITH
SQ_CMS_Query_Reponse_File AS (

-- TODO Manual --

),
EXP_default AS (
	SELECT
	HIC_Number,
	Last_Name,
	First_Name,
	DOB,
	Sex_Code,
	Entitlement_Reason,
	Current_Medicare_PartA_Eff_Date,
	Current_Medicare_PartA_Termination_Date,
	Current_Medicare_PartB_Eff_Date,
	Current_Medicare_PartB_Termination_Date,
	Medicare_Beneficiary_Date_Of_Death,
	Current_Medicare_PartC_Plan_Contractor_Number,
	Current_Medicare_PartC_Plan_Enrollment_Date,
	Current_Medicare_PartC_Plan_Termination_Date,
	Disposition_Code,
	CMS_Document_Control_Number,
	SYSDATE AS System_Date,
	RRE_DCN_1,
	-- *INF*: TO_INTEGER(RRE_DCN_1)
	CAST(RRE_DCN_1 AS INTEGER) AS RRE_DCN_1_Out,
	RRE_DCN_2,
	Most_Recent_Medicare_Part_A_Effective_Date,
	-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_A_Effective_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_A_Effective_Date,'YYYYMMDD'),NULL)
	IFF(
	    IS_DATE(Most_Recent_Medicare_Part_A_Effective_Date, 'YYYYMMDD'),
	    TO_TIMESTAMP(Most_Recent_Medicare_Part_A_Effective_Date, 'YYYYMMDD'),
	    NULL
	) AS o_Most_Recent_Medicare_Part_A_Effective_Date,
	Most_Recent_Medicare_Part_A_Termination_Date,
	-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_A_Termination_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_A_Termination_Date,'YYYYMMDD'),NULL)
	IFF(
	    IS_DATE(Most_Recent_Medicare_Part_A_Termination_Date, 'YYYYMMDD'),
	    TO_TIMESTAMP(Most_Recent_Medicare_Part_A_Termination_Date, 'YYYYMMDD'),
	    NULL
	) AS o_Most_Recent_Medicare_Part_A_Termination_Date,
	Most_Recent_Medicare_Part_B_Effective_Date,
	-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_B_Effective_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_B_Effective_Date,'YYYYMMDD'),NULL)
	IFF(
	    IS_DATE(Most_Recent_Medicare_Part_B_Effective_Date, 'YYYYMMDD'),
	    TO_TIMESTAMP(Most_Recent_Medicare_Part_B_Effective_Date, 'YYYYMMDD'),
	    NULL
	) AS o_Most_Recent_Medicare_Part_B_Effective_Date,
	Most_Recent_Medicare_Part_B_Termination_Date,
	-- *INF*: IIF(IS_DATE(Most_Recent_Medicare_Part_B_Termination_Date,'YYYYMMDD'), TO_DATE(Most_Recent_Medicare_Part_B_Termination_Date,'YYYYMMDD'),NULL)
	IFF(
	    IS_DATE(Most_Recent_Medicare_Part_B_Termination_Date, 'YYYYMMDD'),
	    TO_TIMESTAMP(Most_Recent_Medicare_Part_B_Termination_Date, 'YYYYMMDD'),
	    NULL
	) AS o_Most_Recent_Medicare_Part_B_Termination_Date
	FROM SQ_CMS_Query_Reponse_File
),
LKP_claim_party_occurrence AS (
	SELECT
	source_sys_id,
	claim_occurrence_ak_id,
	claim_party_ak_id,
	Injured_Party_Id,
	RRE_DCN_1
	FROM (
		select m.injured_party_id as Injured_Party_Id,      
		    cpo.source_sys_id as Source_Sys_Id, 
		    cpo.claim_occurrence_ak_id as claim_occurrence_ak_id ,
		cpo.claim_party_ak_id as claim_party_ak_id
		from RPT_EDM.dbo.claim_medical m
		join RPT_EDM.dbo.claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = m.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1
		where m.crrnt_snpsht_flag = 1
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY Injured_Party_Id ORDER BY source_sys_id) = 1
),
RTR_split_records AS (
	SELECT
	EXP_default.HIC_Number,
	EXP_default.Last_Name,
	EXP_default.First_Name,
	EXP_default.DOB,
	EXP_default.Sex_Code,
	EXP_default.Entitlement_Reason,
	EXP_default.Current_Medicare_PartA_Eff_Date,
	EXP_default.Current_Medicare_PartA_Termination_Date,
	EXP_default.Current_Medicare_PartB_Eff_Date,
	EXP_default.Current_Medicare_PartB_Termination_Date,
	EXP_default.Medicare_Beneficiary_Date_Of_Death,
	EXP_default.Current_Medicare_PartC_Plan_Contractor_Number,
	EXP_default.Current_Medicare_PartC_Plan_Enrollment_Date,
	EXP_default.Current_Medicare_PartC_Plan_Termination_Date,
	EXP_default.Disposition_Code,
	EXP_default.CMS_Document_Control_Number,
	EXP_default.System_Date,
	EXP_default.RRE_DCN_1_Out,
	LKP_claim_party_occurrence.source_sys_id,
	LKP_claim_party_occurrence.claim_occurrence_ak_id AS claim_occurrence_id,
	LKP_claim_party_occurrence.claim_party_ak_id,
	EXP_default.o_Most_Recent_Medicare_Part_A_Effective_Date AS Most_Recent_Medicare_Part_A_Effective_Date,
	EXP_default.o_Most_Recent_Medicare_Part_A_Termination_Date AS Most_Recent_Medicare_Part_A_Termination_Date,
	EXP_default.o_Most_Recent_Medicare_Part_B_Effective_Date AS Most_Recent_Medicare_Part_B_Effective_Date,
	EXP_default.o_Most_Recent_Medicare_Part_B_Termination_Date AS Most_Recent_Medicare_Part_B_Termination_Date
	FROM EXP_default
	LEFT JOIN LKP_claim_party_occurrence
	ON LKP_claim_party_occurrence.Injured_Party_Id = EXP_default.RRE_DCN_1_Out
),
RTR_split_records_EXCEED AS (SELECT * FROM RTR_split_records WHERE source_sys_id <> 'DCT'),
RTR_split_records_DCT AS (SELECT * FROM RTR_split_records WHERE source_sys_id = 'DCT'),
CMS_QRY_RESPONSE AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_QRY_RESPONSE
	(WBMI_RECEIVED_DT, CMS_DOC_CNTL_NUM, HIC_NUMBER, LAST_NAME, FIRST_INITIAL, DOB, SEX_CODE, DISPOSITION_CODE, INJURED_PARTY_ID, ENTITLEMENT_REASON, CUR_MED_PARTA_EFF, CUR_MED_PARTA_TERM, CUR_MED_PARTB_EFF, CUR_MED_PARTB_TERM, MED_BEN_DATE_DEATH, CUR_MED_PARTC_NUM, CUR_MED_PARTC_ENRL, CUR_MED_PARTC_TERM, MOST_RECENT_MED_PARTA_EFF_DT, MOST_RECENT_MED_PARTA_TER_DT, MOST_RECENT_MED_PARTB_EFF_DT, MOST_RECENT_MED_PARTB_TER_DT)
	SELECT 
	System_Date AS WBMI_RECEIVED_DT, 
	CMS_Document_Control_Number AS CMS_DOC_CNTL_NUM, 
	HIC_Number AS HIC_NUMBER, 
	Last_Name AS LAST_NAME, 
	First_Name AS FIRST_INITIAL, 
	DOB, 
	Sex_Code AS SEX_CODE, 
	Disposition_Code AS DISPOSITION_CODE, 
	RRE_DCN_1_Out AS INJURED_PARTY_ID, 
	Entitlement_Reason AS ENTITLEMENT_REASON, 
	Current_Medicare_PartA_Eff_Date AS CUR_MED_PARTA_EFF, 
	Current_Medicare_PartA_Termination_Date AS CUR_MED_PARTA_TERM, 
	Current_Medicare_PartB_Eff_Date AS CUR_MED_PARTB_EFF, 
	Current_Medicare_PartB_Termination_Date AS CUR_MED_PARTB_TERM, 
	Medicare_Beneficiary_Date_Of_Death AS MED_BEN_DATE_DEATH, 
	Current_Medicare_PartC_Plan_Contractor_Number AS CUR_MED_PARTC_NUM, 
	Current_Medicare_PartC_Plan_Enrollment_Date AS CUR_MED_PARTC_ENRL, 
	Current_Medicare_PartC_Plan_Termination_Date AS CUR_MED_PARTC_TERM, 
	Most_Recent_Medicare_Part_A_Effective_Date AS MOST_RECENT_MED_PARTA_EFF_DT, 
	Most_Recent_Medicare_Part_A_Termination_Date AS MOST_RECENT_MED_PARTA_TER_DT, 
	Most_Recent_Medicare_Part_B_Effective_Date AS MOST_RECENT_MED_PARTB_EFF_DT, 
	Most_Recent_Medicare_Part_B_Termination_Date AS MOST_RECENT_MED_PARTB_TER_DT
	FROM RTR_split_records_EXCEED
),
LKP_Claim_Occurrence AS (
	SELECT
	claim_occurrence_id,
	claim_occurrence_ak_id,
	claim_occurrence_type_code,
	s3p_claim_num
	FROM (
		SELECT claim_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_occurrence.claim_occurrence_type_code as claim_occurrence_type_code, claim_occurrence.s3p_claim_num as s3p_claim_num, claim_occurrence.claim_occurrence_id as claim_occurrence_id FROM claim_occurrence where crrnt_snpsht_flag=1
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id ORDER BY claim_occurrence_id) = 1
),
LKP_Claim_Party AS (
	SELECT
	claim_party_ak_id,
	claim_party_full_name
	FROM (
		SELECT claim_party.claim_party_full_name as claim_party_full_name, claim_party.claim_party_ak_id as claim_party_ak_id FROM RPT_EDM.dbo.claim_party where
		crrnt_snpsht_flag=1
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY claim_party_ak_id ORDER BY claim_party_ak_id) = 1
),
lkp_Claim_Representative AS (
	SELECT
	claim_occurrence_ak_id,
	claim_rep_ak_id,
	claim_rep_full_name,
	handling_office_descript
	FROM (
		select cro.claim_occurrence_ak_id as claim_occurrence_ak_id
		,cro.claim_rep_ak_id as claim_rep_ak_id
		, cr.claim_rep_first_name+' '+ claim_rep_last_name as claim_rep_full_name
		, cr.handling_office_descript as handling_office_descript
		from 
		RPT_EDM.dbo.claim_representative_occurrence cro 
		left join RPT_EDM.dbo.claim_representative cr on cro.claim_rep_ak_id = cr.claim_rep_ak_id 
		and cro.crrnt_snpsht_flag=1 and cr.crrnt_snpsht_flag=1
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id ORDER BY claim_occurrence_ak_id) = 1
),
CmsQueryResponse AS (
	INSERT INTO CmsQueryResponse
	(WbmiReceivedDt, CmsDocControlNum, HICNumber, LastName, FirstInitial, Dob, SexCode, DispositionCode, InjuredPartyId, EntitlementReason, CurMedPartAEff, CurMedPartATerm, CurMedPartBEff, CurMedPartBTerm, MedBenDateDeath, CurMedPartCNum, CurMedPartCEnrl, CurMedPartCTerm, ClaimType, ClaimNum, AdjusterName, ClaimantName, ReportOfficeName)
	SELECT 
	RTR_split_records_DCT.System_Date AS WBMIRECEIVEDDT, 
	RTR_split_records_DCT.CMS_Document_Control_Number AS CMSDOCCONTROLNUM, 
	RTR_split_records_DCT.HIC_Number AS HICNUMBER, 
	RTR_split_records_DCT.Last_Name AS LASTNAME, 
	RTR_split_records_DCT.First_Name AS FIRSTINITIAL, 
	RTR_split_records_DCT.DOB AS DOB, 
	RTR_split_records_DCT.Sex_Code AS SEXCODE, 
	RTR_split_records_DCT.Disposition_Code AS DISPOSITIONCODE, 
	RTR_split_records_DCT.RRE_DCN_1_Out AS INJUREDPARTYID, 
	RTR_split_records_DCT.Entitlement_Reason AS ENTITLEMENTREASON, 
	RTR_split_records_DCT.Current_Medicare_PartA_Eff_Date AS CURMEDPARTAEFF, 
	RTR_split_records_DCT.Current_Medicare_PartA_Termination_Date AS CURMEDPARTATERM, 
	RTR_split_records_DCT.Current_Medicare_PartB_Eff_Date AS CURMEDPARTBEFF, 
	RTR_split_records_DCT.Current_Medicare_PartB_Termination_Date AS CURMEDPARTBTERM, 
	RTR_split_records_DCT.Medicare_Beneficiary_Date_Of_Death AS MEDBENDATEDEATH, 
	RTR_split_records_DCT.Current_Medicare_PartC_Plan_Contractor_Number AS CURMEDPARTCNUM, 
	RTR_split_records_DCT.Current_Medicare_PartC_Plan_Enrollment_Date AS CURMEDPARTCENRL, 
	RTR_split_records_DCT.Current_Medicare_PartC_Plan_Termination_Date AS CURMEDPARTCTERM, 
	LKP_Claim_Occurrence.claim_occurrence_type_code AS CLAIMTYPE, 
	LKP_Claim_Occurrence.s3p_claim_num AS CLAIMNUM, 
	lkp_Claim_Representative.claim_rep_full_name AS ADJUSTERNAME, 
	LKP_Claim_Party.claim_party_full_name AS CLAIMANTNAME, 
	lkp_Claim_Representative.handling_office_descript AS REPORTOFFICENAME
	FROM RTR_split_records_DCT
),
SQ_CMS_Query_Reponse_File_Part_C_D AS (

-- TODO Manual --

),
EXP_PART_C_D AS (
	SELECT
	CMS_Document_Control_Number,
	RRE_DCN_1,
	-- *INF*: TO_INTEGER(RRE_DCN_1)
	CAST(RRE_DCN_1 AS INTEGER) AS o_RRE_DCN_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_1,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_1,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_1,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_1,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_2,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_2,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_2,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_2,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_3,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_3,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_3,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_3,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_4,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_4,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_4,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_4,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_5,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_5,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_5,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_5,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_6,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_6,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_6,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_6,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_7,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_7,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_7,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_7,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_8,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_8,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_8,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_8,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_9,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_9,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_9,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_9,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_10,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_10,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_10,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_10,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_11,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_11,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_11,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_11,
	Most_Recent_Medicare_Part_C_Plan_Contract_Number_12,
	Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_12,
	Most_Recent_Medicare_Part_C_Plan_Termination_Date_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Name_12,
	Most_Recent_Medicare_Part_C_Plan_PBP_Number_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_12,
	Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_1,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_1,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_1,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_1,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_2,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_2,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_2,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_2,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_3,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_3,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_3,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_3,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_4,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_4,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_4,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_4,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_5,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_5,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_5,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_5,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_6,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_6,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_6,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_6,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_7,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_7,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_7,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_7,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_8,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_8,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_8,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_8,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_9,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_9,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_9,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_9,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_10,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_10,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_10,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_10,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_11,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_11,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_11,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_11,
	Most_Recent_Medicare_Part_D_Plan_Contract_Number_12,
	Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_12,
	Most_Recent_Medicare_Part_D_Plan_Termination_Date_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Name_12,
	Most_Recent_Medicare_Part_D_Plan_PBP_Number_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_12,
	Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_12,
	'C' AS o_MED_PART_C,
	'D' AS o_MED_PART_D
	FROM SQ_CMS_Query_Reponse_File_Part_C_D
),
LKP_claim_party_occurrence1 AS (
	SELECT
	source_sys_id,
	claim_occurrence_ak_id,
	claim_party_ak_id,
	Injured_Party_Id,
	RRE_DCN_1
	FROM (
		select m.injured_party_id as Injured_Party_Id,      
		    cpo.source_sys_id as Source_Sys_Id, 
		    cpo.claim_occurrence_ak_id as claim_occurrence_ak_id ,
		cpo.claim_party_ak_id as claim_party_ak_id
		from RPT_EDM.dbo.claim_medical m
		join RPT_EDM.dbo.claim_party_occurrence cpo on cpo.claim_party_occurrence_ak_id = m.claim_party_occurrence_ak_id and cpo.crrnt_snpsht_flag = 1
		where m.crrnt_snpsht_flag = 1
	)
	QUALIFY ROW_NUMBER() OVER (PARTITION BY Injured_Party_Id ORDER BY source_sys_id) = 1
),
RTR_split_records_PART_C_D AS (
	SELECT
	EXP_PART_C_D.CMS_Document_Control_Number,
	LKP_claim_party_occurrence1.source_sys_id,
	LKP_claim_party_occurrence1.claim_occurrence_ak_id AS claim_occurrence_id,
	LKP_claim_party_occurrence1.claim_party_ak_id,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Number_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_11 AS Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_11 AS Most_Recent_Medicare_Part_C_Plan_Termination_Date_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Name_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_11 AS Most_Recent_Medicare_Part_C_Plan_PBP_Number_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_11 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Number_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Number_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_12 AS Most_Recent_Medicare_Part_C_Plan_Enrollment_Date_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Termination_Date_12 AS Most_Recent_Medicare_Part_C_Plan_Termination_Date_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Name_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Name_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_PBP_Number_12 AS Most_Recent_Medicare_Part_C_Plan_PBP_Number_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_1_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_2_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_City_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_State_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_12 AS Most_Recent_Medicare_Part_C_Plan_Contract_Address_Zip_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_1,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_2,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_3,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_4,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_5,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_6,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_7,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_8,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_9,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_10,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Number_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_11 AS Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_11 AS Most_Recent_Medicare_Part_D_Plan_Termination_Date_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Name_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_11 AS Most_Recent_Medicare_Part_D_Plan_PBP_Number_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_11 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_111,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Number_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Number_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_12 AS Most_Recent_Medicare_Part_D_Plan_Enrollment_Date_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Termination_Date_12 AS Most_Recent_Medicare_Part_D_Plan_Termination_Date_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Name_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Name_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_PBP_Number_12 AS Most_Recent_Medicare_Part_D_Plan_PBP_Number_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_1_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_2_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_City_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_State_121,
	EXP_PART_C_D.Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_12 AS Most_Recent_Medicare_Part_D_Plan_Contract_Address_Zip_121,
	EXP_PART_C_D.o_MED_PART_C,
	EXP_PART_C_D.o_MED_PART_D
	FROM EXP_PART_C_D
	LEFT JOIN LKP_claim_party_occurrence1
	ON LKP_claim_party_occurrence1.Injured_Party_Id = EXP_PART_C_D.o_RRE_DCN_1
),
RTR_split_records_PART_C_D_EXCEED AS (SELECT * FROM RTR_split_records_PART_C_D WHERE source_sys_id <> 'DCT'),
RTR_split_records_PART_C_D_DCT AS (SELECT * FROM RTR_split_records_PART_C_D WHERE source_sys_id = 'DCT'),
NRM_CMS_Query_Response_PART_C_D AS (
),
EXP_CMS_QRY_RESPONSE_PART_C_D AS (
	SELECT
	CMS_DOC_CNTL_NUM,
	SYSDATE AS o_WBMI_RECEIVED_DT,
	MED_PARTC,
	PLAN_CONTRACT_NUM,
	ENROLL_DATE,
	-- *INF*: IIF(IS_DATE(ENROLL_DATE,'YYYYMMDD'),TO_DATE(ENROLL_DATE,'YYYYMMDD'),NULL)
	IFF(IS_DATE(ENROLL_DATE, 'YYYYMMDD'), TO_TIMESTAMP(ENROLL_DATE, 'YYYYMMDD'), NULL) AS o_ENROLL_DATE,
	TERM_DATE,
	-- *INF*: IIF(IS_DATE(TERM_DATE,'YYYYMMDD'),TO_DATE(TERM_DATE,'YYYYMMDD'),NULL)
	IFF(IS_DATE(TERM_DATE, 'YYYYMMDD'), TO_TIMESTAMP(TERM_DATE, 'YYYYMMDD'), NULL) AS o_TERM_DATE,
	PLAN_CONTRACT_NAME,
	PLAN_BENEFIT_PACK_NUM,
	PLAN_CONTRACT_ADD1,
	PLAN_CONTRACT_ADD2,
	PLAN_CONTRACT_CITY,
	PLAN_CONTRACT_STATE,
	PLAN_CONTRACT_ZIP,
	GCID_PLAN_CONTRACT_NUM,
	-- *INF*: IIF(MOD(GCID_PLAN_CONTRACT_NUM,12)=0,12,MOD(GCID_PLAN_CONTRACT_NUM,12))
	IFF(MOD(GCID_PLAN_CONTRACT_NUM, 12) = 0, 12, MOD(GCID_PLAN_CONTRACT_NUM, 12)) AS o_GCID_PLAN_CONTRACT_NUM
	FROM NRM_CMS_Query_Response_PART_C_D
),
FIL_CMS_QRY_RESPONSE_PART_C_D AS (
	SELECT
	CMS_DOC_CNTL_NUM, 
	o_WBMI_RECEIVED_DT, 
	MED_PARTC, 
	PLAN_CONTRACT_NUM, 
	o_ENROLL_DATE AS ENROLL_DATE, 
	o_TERM_DATE AS TERM_DATE, 
	PLAN_CONTRACT_NAME, 
	PLAN_BENEFIT_PACK_NUM, 
	PLAN_CONTRACT_ADD1, 
	PLAN_CONTRACT_ADD2, 
	PLAN_CONTRACT_CITY, 
	PLAN_CONTRACT_STATE, 
	PLAN_CONTRACT_ZIP, 
	o_GCID_PLAN_CONTRACT_NUM AS GCID_PLAN_CONTRACT_NUM
	FROM EXP_CMS_QRY_RESPONSE_PART_C_D
	WHERE IIF(
(LTRIM(RTRIM(PLAN_CONTRACT_NUM)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_NUM)))) OR
(NOT ISNULL(LTRIM(RTRIM(ENROLL_DATE)))) OR
(NOT ISNULL(LTRIM(RTRIM(TERM_DATE)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_NAME)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_NAME)))) OR
(LTRIM(RTRIM(PLAN_BENEFIT_PACK_NUM)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_BENEFIT_PACK_NUM)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_ADD1)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ADD1)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_ADD2)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ADD2)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_CITY)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_CITY)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_STATE)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_STATE)))) OR
(LTRIM(RTRIM(PLAN_CONTRACT_ZIP)) <> '' AND NOT ISNULL(LTRIM(RTRIM(PLAN_CONTRACT_ZIP))))
,TRUE, FALSE)
),
CMS_QRY_RESPONSE_PART_C_D AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.CMS_QRY_RESPONSE_PART_C_D
	(CMS_DOC_CNTL_NUM, WBMI_RECEIVED_DT, MED_PARTC, PART_INSTANCE_NUM, PLAN_CONTRACT_NUM, ENROLL_DATE, TERM_DATE, PLAN_CONTRACT_NAME, PLAN_BENEFIT_PACK_NUM, PLAN_CONTRACT_ADD1, PLAN_CONTRACT_ADD2, PLAN_CONTRACT_CITY, PLAN_CONTRACT_STATE, PLAN_CONTRACT_ZIP)
	SELECT 
	CMS_DOC_CNTL_NUM, 
	o_WBMI_RECEIVED_DT AS WBMI_RECEIVED_DT, 
	MED_PARTC, 
	GCID_PLAN_CONTRACT_NUM AS PART_INSTANCE_NUM, 
	PLAN_CONTRACT_NUM, 
	ENROLL_DATE, 
	TERM_DATE, 
	PLAN_CONTRACT_NAME, 
	PLAN_BENEFIT_PACK_NUM, 
	PLAN_CONTRACT_ADD1, 
	PLAN_CONTRACT_ADD2, 
	PLAN_CONTRACT_CITY, 
	PLAN_CONTRACT_STATE, 
	PLAN_CONTRACT_ZIP
	FROM FIL_CMS_QRY_RESPONSE_PART_C_D
),