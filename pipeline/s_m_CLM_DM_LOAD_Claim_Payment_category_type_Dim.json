{
    "name": "s_m_CLM_DM_LOAD_Claim_Payment_category_type_Dim",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Claim_Payment_category_type_Dim",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_claim_payment_category AS (\n\tSELECT DISTINCT claim_payment_category.claim_pay_ctgry_type , \r\n\tclaim_payment_category.claim_pay_ctgry_lump_sum_ind,\r\n\tclaim_payment_category.cov_ctgry_code\r\n\tFROM\r\n\t claim_payment_category\n),\nEXP_get_values AS (\n\tSELECT\n\tclaim_pay_ctgry_type,\n\tclaim_pay_ctgry_lump_sum_ind,\n\tcov_ctgry_code\n\tFROM SQ_claim_payment_category\n),\nLKP_sup_claim_benefit_type AS (\n\tSELECT\n\tbenefit_type_code_descript,\n\tbenefit_type_code\n\tFROM (\n\t\tSELECT LTRIM(RTRIM(sup_claim_benefit_type.benefit_type_code_descript)) as benefit_type_code_descript, LTRIM(RTRIM(sup_claim_benefit_type.benefit_type_code)) as benefit_type_code FROM sup_claim_benefit_type\r\n\t\twhere crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY benefit_type_code ORDER BY benefit_type_code_descript) = 1\n),\nLKP_sup_coverage_category AS (\n\tSELECT\n\tcov_ctgry_descript,\n\tcov_ctgry_code\n\tFROM (\n\t\tSELECT \r\n\t\tLTRIM(RTRIM(sup_coverage_category.cov_ctgry_code )) as cov_ctgry_code,\r\n\t\tLTRIM(RTRIM(sup_coverage_category.cov_ctgry_descript)) as cov_ctgry_descript   \r\n\t\tFROM @{pipeline().parameters.TARGET_TABLE_OWNER}.sup_coverage_category\r\n\t\twhere crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY cov_ctgry_code ORDER BY cov_ctgry_descript DESC) = 1\n),\nEXP_set_values AS (\n\tSELECT\n\tEXP_get_values.claim_pay_ctgry_type,\n\tLKP_sup_claim_benefit_type.benefit_type_code_descript AS IN_benefit_type_code_descript,\n\t-- *INF*: IIF(ISNULL(IN_benefit_type_code_descript), 'N/A', IN_benefit_type_code_descript)\n\tIFF(IN_benefit_type_code_descript IS NULL, 'N/A', IN_benefit_type_code_descript) AS claim_pay_ctgry_type_descript,\n\tEXP_get_values.claim_pay_ctgry_lump_sum_ind AS IN_claim_pay_ctgry_lump_sum_ind,\n\t-- *INF*: IIF(ISNULL(IN_claim_pay_ctgry_lump_sum_ind), 'N/A', IN_claim_pay_ctgry_lump_sum_ind)\n\tIFF(IN_claim_pay_ctgry_lump_sum_ind IS NULL, 'N/A', IN_claim_pay_ctgry_lump_sum_ind) AS claim_pay_ctgry_lump_sum_ind,\n\t1 AS crrnt_snpsht_flag,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\t-- *INF*: TO_DATE('01/01/1800 01:00:00','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('01/01/1800 01:00:00', 'MM/DD/YYYY HH24:MI:SS') AS eff_from_date,\n\t-- *INF*: TO_DATE('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tTO_TIMESTAMP('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS eff_to_date,\n\tSYSDATE AS created_date,\n\tSYSDATE AS modified_date,\n\tEXP_get_values.cov_ctgry_code AS IN_cov_ctgry_code,\n\t-- *INF*: IIF(ISNULL(IN_cov_ctgry_code), 'N/A', IN_cov_ctgry_code)\n\tIFF(IN_cov_ctgry_code IS NULL, 'N/A', IN_cov_ctgry_code) AS cov_ctgry_code,\n\tLKP_sup_coverage_category.cov_ctgry_descript AS IN_cov_ctgry_descript,\n\t-- *INF*: IIF(ISNULL(IN_cov_ctgry_descript), 'N/A', IN_cov_ctgry_descript)\n\tIFF(IN_cov_ctgry_descript IS NULL, 'N/A', IN_cov_ctgry_descript) AS cov_ctgry_descript\n\tFROM EXP_get_values\n\tLEFT JOIN LKP_sup_claim_benefit_type\n\tON LKP_sup_claim_benefit_type.benefit_type_code = EXP_get_values.claim_pay_ctgry_type\n\tLEFT JOIN LKP_sup_coverage_category\n\tON LKP_sup_coverage_category.cov_ctgry_code = EXP_get_values.cov_ctgry_code\n),\nLKP_claim_payment_category_type_dim AS (\n\tSELECT\n\tclaim_pay_ctgry_type_dim_id,\n\tclaim_pay_ctgry_type_descript,\n\tclaim_pay_ctgry_lump_sum_ind,\n\tcov_ctgry_code,\n\tcov_ctgry_descript,\n\tclaim_pay_ctgry_type\n\tFROM (\n\t\tSELECT \n\t\t\tclaim_pay_ctgry_type_dim_id,\n\t\t\tclaim_pay_ctgry_type_descript,\n\t\t\tclaim_pay_ctgry_lump_sum_ind,\n\t\t\tcov_ctgry_code,\n\t\t\tcov_ctgry_descript,\n\t\t\tclaim_pay_ctgry_type\n\t\tFROM claim_payment_category_type_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_pay_ctgry_type,claim_pay_ctgry_lump_sum_ind ORDER BY claim_pay_ctgry_type_dim_id) = 1\n),\nRTR_claim_payment_category_type_dim AS (\n\tSELECT\n\tLKP_claim_payment_category_type_dim.claim_pay_ctgry_type_dim_id,\n\tLKP_claim_payment_category_type_dim.claim_pay_ctgry_type_descript AS claim_pay_ctgry_type_descript_lkp,\n\tLKP_claim_payment_category_type_dim.claim_pay_ctgry_lump_sum_ind AS claim_pay_ctgry_lump_sum_ind_lkp,\n\tLKP_claim_payment_category_type_dim.cov_ctgry_code AS cov_ctgry_code_lkp,\n\tLKP_claim_payment_category_type_dim.cov_ctgry_descript AS cov_ctgry_descript_lkp,\n\tEXP_set_values.claim_pay_ctgry_type,\n\tEXP_set_values.claim_pay_ctgry_type_descript,\n\tEXP_set_values.crrnt_snpsht_flag,\n\tEXP_set_values.audit_id,\n\tEXP_set_values.eff_from_date,\n\tEXP_set_values.eff_to_date,\n\tEXP_set_values.created_date,\n\tEXP_set_values.modified_date,\n\tEXP_set_values.claim_pay_ctgry_lump_sum_ind,\n\tEXP_set_values.cov_ctgry_code,\n\tEXP_set_values.cov_ctgry_descript\n\tFROM EXP_set_values\n\tLEFT JOIN LKP_claim_payment_category_type_dim\n\tON LKP_claim_payment_category_type_dim.claim_pay_ctgry_type = EXP_set_values.claim_pay_ctgry_type AND LKP_claim_payment_category_type_dim.claim_pay_ctgry_lump_sum_ind = EXP_set_values.claim_pay_ctgry_lump_sum_ind\n),\nRTR_claim_payment_category_type_dim_INSERT AS (SELECT * FROM RTR_claim_payment_category_type_dim WHERE ISNULL(claim_pay_ctgry_type_dim_id)),\nRTR_claim_payment_category_type_dim_UPDATE AS (SELECT * FROM RTR_claim_payment_category_type_dim WHERE NOT ISNULL(claim_pay_ctgry_type_dim_id) AND (claim_pay_ctgry_type_descript_lkp != claim_pay_ctgry_type_descript OR claim_pay_ctgry_lump_sum_ind != claim_pay_ctgry_lump_sum_ind_lkp OR \r\ncov_ctgry_code != cov_ctgry_code_lkp OR \r\ncov_ctgry_descript != \r\ncov_ctgry_descript_lkp\r\n)),\nUPD_claim_payment_category_type_dim_update AS (\n\tSELECT\n\tclaim_pay_ctgry_type_dim_id AS claim_pay_ctgry_type_dim_id3, \n\tclaim_pay_ctgry_type_descript_lkp AS claim_pay_ctgry_type_descript_lkp3, \n\tclaim_pay_ctgry_type_descript AS claim_pay_ctgry_type_descript3, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag3, \n\taudit_id AS audit_id3, \n\teff_from_date AS eff_from_date3, \n\teff_to_date AS eff_to_date3, \n\tcreated_date AS created_date3, \n\tmodified_date AS modified_date3, \n\tclaim_pay_ctgry_lump_sum_ind AS claim_pay_ctgry_lump_sum_ind3, \n\tcov_ctgry_code AS cov_ctgry_code3, \n\tcov_ctgry_descript AS cov_ctgry_descript3\n\tFROM RTR_claim_payment_category_type_dim_UPDATE\n),\nclaim_payment_category_type_dim_update AS (\n\tMERGE INTO claim_payment_category_type_dim AS T\n\tUSING UPD_claim_payment_category_type_dim_update AS S\n\tON T.claim_pay_ctgry_type_dim_id = S.claim_pay_ctgry_type_dim_id3\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.claim_pay_ctgry_type_descript = S.claim_pay_ctgry_type_descript3, T.audit_id = S.audit_id3, T.modified_date = S.modified_date3, T.claim_pay_ctgry_lump_sum_ind = S.claim_pay_ctgry_lump_sum_ind3, T.cov_ctgry_code = S.cov_ctgry_code3, T.cov_ctgry_descript = S.cov_ctgry_descript3\n),\nUPD_claim_payment_category_type_dim_Insert AS (\n\tSELECT\n\tclaim_pay_ctgry_type AS claim_pay_ctgry_type1, \n\tclaim_pay_ctgry_type_descript AS claim_pay_ctgry_type_descript1, \n\tcrrnt_snpsht_flag AS crrnt_snpsht_flag1, \n\taudit_id AS audit_id1, \n\teff_from_date AS eff_from_date1, \n\teff_to_date AS eff_to_date1, \n\tcreated_date AS created_date1, \n\tmodified_date AS modified_date1, \n\tclaim_pay_ctgry_lump_sum_ind AS claim_pay_ctgry_lump_sum_ind1, \n\tcov_ctgry_code AS cov_ctgry_code1, \n\tcov_ctgry_descript AS cov_ctgry_descript1\n\tFROM RTR_claim_payment_category_type_dim_INSERT\n),\nclaim_payment_category_type_dim_insert AS (\n\tINSERT INTO claim_payment_category_type_dim\n\t(claim_pay_ctgry_type, claim_pay_ctgry_type_descript, crrnt_snpsht_flag, audit_id, eff_from_date, eff_to_date, created_date, modified_date, claim_pay_ctgry_lump_sum_ind, cov_ctgry_code, cov_ctgry_descript)\n\tSELECT \n\tclaim_pay_ctgry_type1 AS CLAIM_PAY_CTGRY_TYPE, \n\tclaim_pay_ctgry_type_descript1 AS CLAIM_PAY_CTGRY_TYPE_DESCRIPT, \n\tcrrnt_snpsht_flag1 AS CRRNT_SNPSHT_FLAG, \n\taudit_id1 AS AUDIT_ID, \n\teff_from_date1 AS EFF_FROM_DATE, \n\teff_to_date1 AS EFF_TO_DATE, \n\tcreated_date1 AS CREATED_DATE, \n\tmodified_date1 AS MODIFIED_DATE, \n\tclaim_pay_ctgry_lump_sum_ind1 AS CLAIM_PAY_CTGRY_LUMP_SUM_IND, \n\tcov_ctgry_code1 AS COV_CTGRY_CODE, \n\tcov_ctgry_descript1 AS COV_CTGRY_DESCRIPT\n\tFROM UPD_claim_payment_category_type_dim_Insert\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "RPT_EDM and EDW/Claims DataMart/"
        },
        "annotations": []
    }
}