WITH
SQ_PifReins53Stage AS (
	SELECT
		Pifreins53StageId,
		ExtractDate,
		SourceSystemid,
		PifSymbol,
		PifPolicyNumber,
		PifModule,
		REINId,
		REINSSectionCode,
		REINSInsuranceLine,
		REINSLocationNumber,
		REINSSubLocationNumber,
		REINSRiskUnitGroup,
		REINSSeqRskUntGrp,
		REINSUnitLob,
		REINSRiskSequence,
		REINSRiskTypeInd,
		REINSLayer,
		REINSCompanyNo,
		REINSEffYear,
		REINSEffMonth,
		REINSEffDay,
		REINSPercentPremCeded,
		REINSPercentLossCeded,
		REINSPercentFacCommNosign,
		REINSExpYear,
		REINSExpMonth,
		REINSExpDay,
		REINSCessionNo,
		REINSType,
		REINSEntYear,
		REINSEntMonth,
		REINSEntDay,
		REINSBrokerNo,
		REINSExcessAmt,
		REINSOccurLimit,
		REINSAggregateLimit,
		REINSSpecialUse,
		REINSProportionalCode,
		REINSPmsFutureUse,
		REINSCustFutureUse,
		REINSYr2000CustUse,
		REINSDupKeySeqNum
	FROM PifReins53Stage
),
EXP_PifReins53Stage AS (
	SELECT
	Pifreins53StageId,
	ExtractDate,
	SourceSystemid,
	PifSymbol,
	PifPolicyNumber,
	PifModule,
	REINId,
	REINSSectionCode,
	REINSInsuranceLine,
	REINSLocationNumber,
	REINSSubLocationNumber,
	REINSRiskUnitGroup,
	REINSSeqRskUntGrp,
	REINSUnitLob,
	REINSRiskSequence,
	REINSRiskTypeInd,
	REINSLayer,
	REINSCompanyNo,
	REINSEffYear,
	REINSEffMonth,
	REINSEffDay,
	REINSPercentPremCeded,
	REINSPercentLossCeded,
	REINSPercentFacCommNosign,
	REINSExpYear,
	REINSExpMonth,
	REINSExpDay,
	REINSCessionNo,
	REINSType,
	REINSEntYear,
	REINSEntMonth,
	REINSEntDay,
	REINSBrokerNo,
	REINSExcessAmt,
	REINSOccurLimit,
	REINSAggregateLimit,
	REINSSpecialUse,
	REINSProportionalCode,
	REINSPmsFutureUse,
	REINSCustFutureUse,
	REINSYr2000CustUse,
	REINSDupKeySeqNum,
	@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS o_audit_id
	FROM SQ_PifReins53Stage
),
ArchPifReins53Stage AS (
	INSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.ArchPifReins53Stage
	(ExtractDate, SourceSystemid, AuditId, PifSymbol, PifPolicyNumber, PifModule, REINId, REINSSectionCode, REINSInsuranceLine, REINSLocationNumber, REINSSubLocationNumber, REINSRiskUnitGroup, REINSSeqRskUntGrp, REINSUnitLob, REINSRiskSequence, REINSRiskTypeInd, REINSLayer, REINSCompanyNo, REINSEffYear, REINSEffMonth, REINSEffDay, REINSPercentPremCeded, REINSPercentLossCeded, REINSPercentFacCommNosign, REINSExpYear, REINSExpMonth, REINSExpDay, REINSCessionNo, REINSType, REINSEntYear, REINSEntMonth, REINSEntDay, REINSBrokerNo, REINSExcessAmt, REINSOccurLimit, REINSAggregateLimit, REINSSpecialUse, REINSProportionalCode, REINSPmsFutureUse, REINSCustFutureUse, REINSYr2000CustUse, REINSDupKeySeqNum)
	SELECT 
	EXTRACTDATE, 
	SOURCESYSTEMID, 
	o_audit_id AS AUDITID, 
	PIFSYMBOL, 
	PIFPOLICYNUMBER, 
	PIFMODULE, 
	REINID, 
	REINSSECTIONCODE, 
	REINSINSURANCELINE, 
	REINSLOCATIONNUMBER, 
	REINSSUBLOCATIONNUMBER, 
	REINSRISKUNITGROUP, 
	REINSSEQRSKUNTGRP, 
	REINSUNITLOB, 
	REINSRISKSEQUENCE, 
	REINSRISKTYPEIND, 
	REINSLAYER, 
	REINSCOMPANYNO, 
	REINSEFFYEAR, 
	REINSEFFMONTH, 
	REINSEFFDAY, 
	REINSPERCENTPREMCEDED, 
	REINSPERCENTLOSSCEDED, 
	REINSPERCENTFACCOMMNOSIGN, 
	REINSEXPYEAR, 
	REINSEXPMONTH, 
	REINSEXPDAY, 
	REINSCESSIONNO, 
	REINSTYPE, 
	REINSENTYEAR, 
	REINSENTMONTH, 
	REINSENTDAY, 
	REINSBROKERNO, 
	REINSEXCESSAMT, 
	REINSOCCURLIMIT, 
	REINSAGGREGATELIMIT, 
	REINSSPECIALUSE, 
	REINSPROPORTIONALCODE, 
	REINSPMSFUTUREUSE, 
	REINSCUSTFUTUREUSE, 
	REINSYR2000CUSTUSE, 
	REINSDUPKEYSEQNUM
	FROM EXP_PifReins53Stage
),