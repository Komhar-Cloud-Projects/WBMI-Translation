{
    "name": "s_m_Plines_STG_Insert_Vehicle",
    "properties": {
        "activities": [
            {
                "name": "m_Plines_STG_Insert_Vehicle",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nSQ_vehicle AS (\n\tSELECT\n\t\tveh_seq,\n\t\tpolicy_num,\n\t\tpolicy_sym,\n\t\tpolicy_mod,\n\t\tpolicy_mco,\n\t\tcov_part_type_code,\n\t\tveh_num,\n\t\tgarage_street,\n\t\tgarage_city,\n\t\tgarage_state_type_code,\n\t\tgarage_zip_type_code,\n\t\tgarage_county_type_code,\n\t\tterritory,\n\t\tyear,\n\t\tmake,\n\t\tmodel,\n\t\tveh_id,\n\t\tveh_sym,\n\t\tcost_or_stated_amt,\n\t\tbody_veh_type_code,\n\t\tveh_usage_type_code,\n\t\tregistration_state_type_code,\n\t\tnum_of_mile_from_work_school,\n\t\tnum_of_day_veh_use_per_week,\n\t\tperformance_type_code,\n\t\tsurcharge_type_code,\n\t\tgarage_flag,\n\t\ttotal_annual_mileage,\n\t\tclass,\n\t\tcc,\n\t\tanti_lock_flag,\n\t\tveh_cov_type_code,\n\t\tcredit_exist_ins_exp_date,\n\t\tcorp_own_flag,\n\t\tfour_or_less_flag,\n\t\tcorp_own_veh_pers_use_flag,\n\t\tpublic_or_livery_convey_flag,\n\t\tperm_assign_to_insd_flag,\n\t\tcorp_own_veh_oper_by_insd_flag,\n\t\tused_for_insd_occupation_flag,\n\t\tstandard_gross_weight_flag,\n\t\tcustom_type_code,\n\t\tcamper_type_code,\n\t\tcustom_built_flag,\n\t\tmc_extended_forks_flag,\n\t\tcompete_flag,\n\t\tanti_theft_type_code,\n\t\tanti_theft_category,\n\t\twindow_id_system_flag,\n\t\thood_lock_latching_flag,\n\t\tnot_sole_own_by_insd_flag,\n\t\texst_damage_flag,\n\t\tdamage_type_code,\n\t\tother_loss_flag,\n\t\tkept_at_school_flag,\n\t\tstreet_park_flag,\n\t\ttour_cycle_disc_flag,\n\t\tvisited_status_type_code,\n\t\tinside_city_limit_flag,\n\t\tmh_used_to_from_work_flag,\n\t\tmh_pickup_camper_flag,\n\t\tmh_converted_bus_flag,\n\t\trt_perm_park_flag,\n\t\trt_park_over_six_flag,\n\t\tadd_int_na_flag,\n\t\tauto_loan_lease_flag,\n\t\tmodified_date,\n\t\tmodified_user_id,\n\t\tpif_vehicle_name,\n\t\tpif_anti_theft_discount_points,\n\t\tendorsement_vehicle_view_code,\n\t\tveh_bus_use_descript,\n\t\tbus_name_on_title,\n\t\tveh_sym_entered,\n\t\tcdr_cov_flag,\n\t\tprv_titled_flag,\n\t\ttitled_date,\n\t\tanti_theft_flag,\n\t\tpif_veh_usage_type_code,\n\t\tpif_cdr_cov_flag,\n\t\tpif_disc_ctgry,\n\t\tpif_vehicle_age,\n\t\tveh_modified_flag,\n\t\trestoration_complete_flag,\n\t\tstrokes_code,\n\t\tveh_status_type_code,\n\t\tsnowmobile_hazard_flag,\n\t\tpif_auto_loan_lease_flag,\n\t\tmanually_entered_make_flag,\n\t\tmanually_entered_model_flag,\n\t\tmanually_entered_veh_sym_flag,\n\t\tpif_num_of_mile_from_work_school,\n\t\tveh_sym_override_flag,\n\t\tpif_num_of_day_veh_use_per_week,\n\t\tpif_total_annual_mileage,\n\t\tdelete_rsn_type_code,\n\t\tdelete_rsn_other_descript,\n\t\tPif_veh_cov_type_code,\n\t\tpif_anti_theft_category,\n\t\tpif_anti_theft_flag,\n\t\tleased_flag\n\tFROM vehicle\n),\nEXP_VEHICLE AS (\n\tSELECT\n\tveh_seq,\n\tpolicy_num,\n\tpolicy_sym,\n\tpolicy_mod,\n\tpolicy_mco,\n\tcov_part_type_code,\n\tveh_num,\n\tgarage_street,\n\tgarage_city,\n\tgarage_state_type_code,\n\tgarage_zip_type_code,\n\tgarage_county_type_code,\n\tterritory,\n\tyear,\n\tmake,\n\tmodel,\n\tveh_id,\n\tveh_sym,\n\tcost_or_stated_amt,\n\tbody_veh_type_code,\n\tveh_usage_type_code,\n\tregistration_state_type_code,\n\tnum_of_mile_from_work_school,\n\tnum_of_day_veh_use_per_week,\n\tperformance_type_code,\n\tsurcharge_type_code,\n\tgarage_flag,\n\ttotal_annual_mileage,\n\tclass,\n\tcc,\n\tanti_lock_flag,\n\tveh_cov_type_code,\n\tcredit_exist_ins_exp_date,\n\tcorp_own_flag,\n\tfour_or_less_flag,\n\tcorp_own_veh_pers_use_flag,\n\tpublic_or_livery_convey_flag,\n\tperm_assign_to_insd_flag,\n\tcorp_own_veh_oper_by_insd_flag,\n\tused_for_insd_occupation_flag,\n\tstandard_gross_weight_flag,\n\tcustom_type_code,\n\tcamper_type_code,\n\tcustom_built_flag,\n\tmc_extended_forks_flag,\n\tcompete_flag,\n\tanti_theft_type_code,\n\tanti_theft_category,\n\twindow_id_system_flag,\n\thood_lock_latching_flag,\n\tnot_sole_own_by_insd_flag,\n\texst_damage_flag,\n\tdamage_type_code,\n\tother_loss_flag,\n\tkept_at_school_flag,\n\tstreet_park_flag,\n\ttour_cycle_disc_flag,\n\tvisited_status_type_code,\n\tinside_city_limit_flag,\n\tmh_used_to_from_work_flag,\n\tmh_pickup_camper_flag,\n\tmh_converted_bus_flag,\n\trt_perm_park_flag,\n\trt_park_over_six_flag,\n\tadd_int_na_flag,\n\tauto_loan_lease_flag,\n\tmodified_date,\n\tmodified_user_id,\n\tpif_vehicle_name,\n\tpif_anti_theft_discount_points,\n\tendorsement_vehicle_view_code,\n\tveh_bus_use_descript,\n\tbus_name_on_title,\n\tveh_sym_entered,\n\tcdr_cov_flag,\n\ttitled_date,\n\tanti_theft_flag,\n\tpif_veh_usage_type_code,\n\tpif_cdr_cov_flag,\n\tpif_disc_ctgry,\n\tpif_vehicle_age,\n\tveh_modified_flag,\n\trestoration_complete_flag,\n\tstrokes_code,\n\tveh_status_type_code,\n\tsnowmobile_hazard_flag,\n\tpif_auto_loan_lease_flag,\n\tmanually_entered_make_flag,\n\tmanually_entered_model_flag,\n\tmanually_entered_veh_sym_flag,\n\tpif_num_of_mile_from_work_school,\n\tveh_sym_override_flag,\n\tpif_num_of_day_veh_use_per_week,\n\tpif_total_annual_mileage,\n\tdelete_rsn_type_code,\n\tdelete_rsn_other_descript,\n\tPif_veh_cov_type_code,\n\tpif_anti_theft_category,\n\tpif_anti_theft_flag,\n\tleased_flag,\n\tSYSDATE AS EXTRACT_DATE,\n\tSYSDATE AS AS_OF_DATE,\n\t'' AS RECORD_COUNT,\n\t@{pipeline().parameters.SOURCE_SYSTEM_ID} AS SOURCE_SYSTEM_ID\n\tFROM SQ_vehicle\n),\nvehicle_plines_stage AS (\n\tTRUNCATE TABLE @{pipeline().parameters.TARGET_TABLE_OWNER}.vehicle_plines_stage;\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.vehicle_plines_stage\n\t(veh_seq, policy_num, policy_sym, policy_mod, policy_mco, cov_part_type_code, veh_num, garage_street, garage_city, garage_state_type_code, garage_zip_type_code, garage_county_type_code, territory, year, make, model, veh_id, veh_sym, cost_or_stated_amt, body_veh_type_code, veh_usage_type_code, registration_state_type_code, num_of_mile_from_work_school, num_of_day_veh_use_per_week, performance_type_code, surcharge_type_code, garage_flag, total_annual_mileage, class, cc, anti_lock_flag, veh_cov_type_code, credit_exist_ins_exp_date, corp_own_flag, four_or_less_flag, corp_own_veh_pers_use_flag, public_or_livery_convey_flag, perm_assign_to_insd_flag, corp_own_veh_oper_by_insd_flag, used_for_insd_occupation_flag, standard_gross_weight_flag, custom_type_code, camper_type_code, custom_built_flag, mc_extended_forks_flag, compete_flag, anti_theft_type_code, anti_theft_category, window_id_system_flag, hood_lock_latching_flag, not_sole_own_by_insd_flag, exst_damage_flag, damage_type_code, other_loss_flag, kept_at_school_flag, street_park_flag, tour_cycle_disc_flag, visited_status_type_code, inside_city_limit_flag, mh_used_to_from_work_flag, mh_pickup_camper_flag, mh_converted_bus_flag, rt_perm_park_flag, rt_park_over_six_flag, add_int_na_flag, auto_loan_lease_flag, modified_date, modified_user_id, pif_vehicle_name, pif_anti_theft_discount_points, endorsement_vehicle_view_code, veh_bus_use_descript, bus_name_on_title, veh_sym_entered, cdr_cov_flag, titled_date, anti_theft_flag, pif_veh_usage_type_code, pif_cdr_cov_flag, pif_disc_ctgry, pif_vehicle_age, veh_modified_flag, restoration_complete_flag, strokes_code, veh_status_type_code, snowmobile_hazard_flag, pif_auto_loan_lease_flag, manually_entered_make_flag, manually_entered_model_flag, manually_entered_veh_sym_flag, pif_num_of_mile_from_work_school, veh_sym_override_flag, pif_num_of_day_veh_use_per_week, pif_total_annual_mileage, delete_rsn_type_code, delete_rsn_other_descript, Pif_veh_cov_type_code, pif_anti_theft_category, pif_anti_theft_flag, leased_flag, extract_date, as_of_date, record_count, source_system_id)\n\tSELECT \n\tVEH_SEQ, \n\tPOLICY_NUM, \n\tPOLICY_SYM, \n\tPOLICY_MOD, \n\tPOLICY_MCO, \n\tCOV_PART_TYPE_CODE, \n\tVEH_NUM, \n\tGARAGE_STREET, \n\tGARAGE_CITY, \n\tGARAGE_STATE_TYPE_CODE, \n\tGARAGE_ZIP_TYPE_CODE, \n\tGARAGE_COUNTY_TYPE_CODE, \n\tTERRITORY, \n\tYEAR, \n\tMAKE, \n\tMODEL, \n\tVEH_ID, \n\tVEH_SYM, \n\tCOST_OR_STATED_AMT, \n\tBODY_VEH_TYPE_CODE, \n\tVEH_USAGE_TYPE_CODE, \n\tREGISTRATION_STATE_TYPE_CODE, \n\tNUM_OF_MILE_FROM_WORK_SCHOOL, \n\tNUM_OF_DAY_VEH_USE_PER_WEEK, \n\tPERFORMANCE_TYPE_CODE, \n\tSURCHARGE_TYPE_CODE, \n\tGARAGE_FLAG, \n\tTOTAL_ANNUAL_MILEAGE, \n\tCLASS, \n\tCC, \n\tANTI_LOCK_FLAG, \n\tVEH_COV_TYPE_CODE, \n\tCREDIT_EXIST_INS_EXP_DATE, \n\tCORP_OWN_FLAG, \n\tFOUR_OR_LESS_FLAG, \n\tCORP_OWN_VEH_PERS_USE_FLAG, \n\tPUBLIC_OR_LIVERY_CONVEY_FLAG, \n\tPERM_ASSIGN_TO_INSD_FLAG, \n\tCORP_OWN_VEH_OPER_BY_INSD_FLAG, \n\tUSED_FOR_INSD_OCCUPATION_FLAG, \n\tSTANDARD_GROSS_WEIGHT_FLAG, \n\tCUSTOM_TYPE_CODE, \n\tCAMPER_TYPE_CODE, \n\tCUSTOM_BUILT_FLAG, \n\tMC_EXTENDED_FORKS_FLAG, \n\tCOMPETE_FLAG, \n\tANTI_THEFT_TYPE_CODE, \n\tANTI_THEFT_CATEGORY, \n\tWINDOW_ID_SYSTEM_FLAG, \n\tHOOD_LOCK_LATCHING_FLAG, \n\tNOT_SOLE_OWN_BY_INSD_FLAG, \n\tEXST_DAMAGE_FLAG, \n\tDAMAGE_TYPE_CODE, \n\tOTHER_LOSS_FLAG, \n\tKEPT_AT_SCHOOL_FLAG, \n\tSTREET_PARK_FLAG, \n\tTOUR_CYCLE_DISC_FLAG, \n\tVISITED_STATUS_TYPE_CODE, \n\tINSIDE_CITY_LIMIT_FLAG, \n\tMH_USED_TO_FROM_WORK_FLAG, \n\tMH_PICKUP_CAMPER_FLAG, \n\tMH_CONVERTED_BUS_FLAG, \n\tRT_PERM_PARK_FLAG, \n\tRT_PARK_OVER_SIX_FLAG, \n\tADD_INT_NA_FLAG, \n\tAUTO_LOAN_LEASE_FLAG, \n\tMODIFIED_DATE, \n\tMODIFIED_USER_ID, \n\tPIF_VEHICLE_NAME, \n\tPIF_ANTI_THEFT_DISCOUNT_POINTS, \n\tENDORSEMENT_VEHICLE_VIEW_CODE, \n\tVEH_BUS_USE_DESCRIPT, \n\tBUS_NAME_ON_TITLE, \n\tVEH_SYM_ENTERED, \n\tCDR_COV_FLAG, \n\tTITLED_DATE, \n\tANTI_THEFT_FLAG, \n\tPIF_VEH_USAGE_TYPE_CODE, \n\tPIF_CDR_COV_FLAG, \n\tPIF_DISC_CTGRY, \n\tPIF_VEHICLE_AGE, \n\tVEH_MODIFIED_FLAG, \n\tRESTORATION_COMPLETE_FLAG, \n\tSTROKES_CODE, \n\tVEH_STATUS_TYPE_CODE, \n\tSNOWMOBILE_HAZARD_FLAG, \n\tPIF_AUTO_LOAN_LEASE_FLAG, \n\tMANUALLY_ENTERED_MAKE_FLAG, \n\tMANUALLY_ENTERED_MODEL_FLAG, \n\tMANUALLY_ENTERED_VEH_SYM_FLAG, \n\tPIF_NUM_OF_MILE_FROM_WORK_SCHOOL, \n\tVEH_SYM_OVERRIDE_FLAG, \n\tPIF_NUM_OF_DAY_VEH_USE_PER_WEEK, \n\tPIF_TOTAL_ANNUAL_MILEAGE, \n\tDELETE_RSN_TYPE_CODE, \n\tDELETE_RSN_OTHER_DESCRIPT, \n\tPIF_VEH_COV_TYPE_CODE, \n\tPIF_ANTI_THEFT_CATEGORY, \n\tPIF_ANTI_THEFT_FLAG, \n\tLEASED_FLAG, \n\tEXTRACT_DATE AS EXTRACT_DATE, \n\tAS_OF_DATE AS AS_OF_DATE, \n\tRECORD_COUNT AS RECORD_COUNT, \n\tSOURCE_SYSTEM_ID AS SOURCE_SYSTEM_ID\n\tFROM EXP_VEHICLE\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "Default Value"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "Default Value"
            }
        },
        "folder": {
            "name": "CommonStaging/"
        },
        "annotations": []
    }
}