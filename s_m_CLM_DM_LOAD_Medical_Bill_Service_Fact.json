{
    "name": "s_m_CLM_DM_LOAD_Medical_Bill_Service_Fact",
    "properties": {
        "activities": [
            {
                "name": "m_CLM_DM_LOAD_Medical_Bill_Service_Fact",
                "type": "Script",
                "dependsOn": [],
                "policy": {
                    "retry": 0,
                    "retryIntervalInSeconds": 30,
                    "secureOutput": false,
                    "secureInput": false
                },
                "userProperties": [],
                "linkedServiceName": {
                    "referenceName": "ls_SNOWFLAKE_WBMI",
                    "type": "LinkedServiceReference"
                },
                "typeProperties": {
                    "scripts": [
                        {
                            "type": "Query",
                            "text": "WITH\nLKP_calender_dim AS (\n\tSELECT\n\tclndr_id,\n\tclndr_date\n\tFROM (\n\t\tSELECT \n\t\t\tclndr_id,\n\t\t\tclndr_date\n\t\tFROM calendar_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY clndr_date ORDER BY clndr_id) = 1\n),\nSQ_medical_bill_service AS (\n\tSELECT medical_bill_service.med_bill_serv_id, medical_bill_service.med_bill_ak_id, medical_bill_service.serv_from_date, medical_bill_service.serv_charge, medical_bill_service.serv_bill_review_red, medical_bill_service.serv_network_red \r\n\tFROM\r\n\t@{pipeline().parameters.SOURCE_TABLE_OWNER}.medical_bill_service medical_bill_service\n),\nEXP_Source AS (\n\tSELECT\n\tmed_bill_serv_id,\n\tmed_bill_ak_id,\n\tserv_from_date,\n\tserv_charge,\n\tserv_bill_review_red,\n\tserv_network_red,\n\t-- *INF*: to_date('12/31/2100 23:59:59','MM/DD/YYYY HH24:MI:SS')\n\tto_date('12/31/2100 23:59:59', 'MM/DD/YYYY HH24:MI:SS') AS Default_Date\n\tFROM SQ_medical_bill_service\n),\nLKP_Claim_Occurrence_Dim_ID AS (\n\tSELECT\n\tclaim_occurrence_dim_id,\n\tedw_claim_occurrence_ak_id,\n\tedw_claim_party_occurrence_ak_id,\n\tserv_from_date,\n\tmed_bill_ak_id\n\tFROM (\n\t\tSELECT  claim_occurrence_dim.claim_occurrence_dim_id AS claim_occurrence_dim_id, \r\n\t\tmedical_bill.claim_occurrence_ak_id AS edw_claim_occurrence_ak_id,  \r\n\t\tmedical_bill.claim_party_occurrence_ak_id as edw_claim_party_occurrence_ak_id,\r\n\t\tmedical_bill.med_bill_ak_id as med_bill_ak_id \r\n\t\tFROM \r\n\t\t@{pipeline().parameters.DB_NAME_EDW}.@{pipeline().parameters.SOURCE_TABLE_OWNER}.medical_bill medical_bill,\r\n\t\t@{pipeline().parameters.DB_NAME_DATAMART}.@{pipeline().parameters.TARGET_TABLE_OWNER}.claim_occurrence_dim claim_occurrence_dim\r\n\t\tWHERE\r\n\t\tmedical_bill.claim_occurrence_ak_id = claim_occurrence_dim.edw_claim_occurrence_ak_id\r\n\t\tAND medical_bill.crrnt_snpsht_flag = 1\r\n\t\tAND claim_occurrence_dim.crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_ak_id ORDER BY claim_occurrence_dim_id DESC) = 1\n),\nmplt_Claim_occurrence AS (WITH\n\tLKP_claim_rep_dim AS (\n\t\tSELECT\n\t\tclaim_rep_dim_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_dim_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_wbconnect_user_id,eff_from_date,eff_to_date ORDER BY claim_rep_dim_id DESC) = 1\n\t),\n\tLKP_claim_representative AS (\n\t\tSELECT\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tCASE claim_representative.claim_rep_wbconnect_user_id  WHEN 'N/A' THEN claim_representative.claim_rep_key \r\n\t\t\tELSE claim_representative.claim_rep_wbconnect_user_id END AS claim_rep_wbconnect_user_id, claim_representative.claim_rep_ak_id as claim_rep_ak_id, claim_representative.eff_from_date as eff_from_date, claim_representative.eff_to_date as eff_to_date FROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_wbconnect_user_id DESC) = 1\n\t),\n\tLKP_claim_occurence_reserve_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_reserve_calculation_id,\n\t\tclaim_occurrence_ak_id,\n\t\tfinancial_type_code,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_reserve_calculation_id,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\tfinancial_type_code,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_reserve_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,financial_type_code,eff_from_date,eff_to_date ORDER BY claim_occurrence_reserve_calculation_id DESC) = 1\n\t),\n\tINPUT AS (\n\t\t\n\t),\n\tEXP_get_values AS (\n\t\tSELECT\n\t\tIN_claim_occurrence_ak_id,\n\t\tIN_trans_date\n\t\tFROM INPUT\n\t),\n\tLKP_claim_occurrence_calc AS (\n\t\tSELECT\n\t\tclaim_occurrence_calculation_id,\n\t\tclaim_occurrence_reported_date,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_calculation_id,\n\t\t\t\tclaim_occurrence_reported_date,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_calculation\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_calculation_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Examiner AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'E'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_PLH AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'PLH'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_Claim_Rep_Occurrence_Handler AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_assigned_date,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tclaim_occurrence_ak_id\n\t\tFROM (\n\t\t\tSELECT claim_representative_occurrence.claim_rep_ak_id as claim_rep_ak_id, claim_representative_occurrence.claim_assigned_date as claim_assigned_date, claim_representative_occurrence.claim_occurrence_ak_id as claim_occurrence_ak_id, claim_representative_occurrence.eff_from_date as eff_from_date, claim_representative_occurrence.eff_to_date as eff_to_date FROM claim_representative_occurrence\r\n\t\t\tWHERE LTRIM(RTRIM(claim_representative_occurrence.claim_rep_role_code))  = 'H'\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id DESC) = 1\n\t),\n\tLKP_claim_occurrence AS (\n\t\tSELECT\n\t\tclaim_occurrence_id,\n\t\tpol_key,\n\t\tclaim_loss_date,\n\t\tclaim_discovery_date,\n\t\tclaim_cat_start_date,\n\t\tclaim_cat_end_date,\n\t\tclaim_created_by_key,\n\t\tclaim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_id,\n\t\t\t\tpol_key,\n\t\t\t\tclaim_loss_date,\n\t\t\t\tclaim_discovery_date,\n\t\t\t\tclaim_cat_start_date,\n\t\t\t\tclaim_cat_end_date,\n\t\t\t\tclaim_created_by_key,\n\t\t\t\tclaim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_id DESC) = 1\n\t),\n\tLKP_Claim_Created_by_rep_ak_id AS (\n\t\tSELECT\n\t\tclaim_rep_ak_id,\n\t\tclaim_rep_wbconnect_user_id,\n\t\tclaim_rep_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_rep_ak_id,\n\t\t\t\tclaim_rep_wbconnect_user_id,\n\t\t\t\tclaim_rep_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_representative\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY claim_rep_key,eff_from_date,eff_to_date ORDER BY claim_rep_ak_id) = 1\n\t),\n\tLKP_V2_policy AS (\n\t\tSELECT\n\t\tpol_id,\n\t\tcontract_cust_ak_id,\n\t\tagency_ak_id,\n\t\tpol_sym,\n\t\tpol_num,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_ak_id,\n\t\tAgencyAKID,\n\t\tStrategicProfitCenterCode,\n\t\tInsuranceSegmentCode,\n\t\tPolicyOfferingCode,\n\t\tpol_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \r\n\t\t\tpolicy.pol_id as pol_id, \r\n\t\t\tpolicy.contract_cust_ak_id as contract_cust_ak_id, \r\n\t\t\tpolicy.agency_ak_id as agency_ak_id, \r\n\t\t\tpolicy.pol_sym as pol_sym, \r\n\t\t\tpolicy.pol_num as pol_num, \r\n\t\t\tpolicy.pol_eff_date as pol_eff_date, \r\n\t\t\tpolicy.pol_exp_date as pol_exp_date, \r\n\t\t\tpolicy.strtgc_bus_dvsn_ak_id as strtgc_bus_dvsn_ak_id,\r\n\t\t\tpolicy.AgencyAKID as AgencyAKID,\r\n\t\t\tSPC.StrategicProfitCenterCode as StrategicProfitCenterCode, INSG.InsuranceSegmentCode as InsuranceSegmentCode, \r\n\t\t\tPO.PolicyOfferingCode as PolicyOfferingCode, \r\n\t\t\tpolicy.pol_key as pol_key, \r\n\t\t\tpolicy.eff_from_date as eff_from_date, \r\n\t\t\tpolicy.eff_to_date as eff_to_date \r\n\t\t\tFROM \r\n\t\t\tv2.policy policy,\r\n\t\t\tStrategicProfitCenter SPC,\r\n\t\t\tInsuranceSegment INSG,\r\n\t\t\tPolicyOffering PO\r\n\t\t\tWHERE \r\n\t\t\tpolicy.StrategicProfitCenterAKId = SPC.StrategicProfitCenterAKId and SPC.CurrentSnapshotFlag =  1\r\n\t\t\tand policy.InsuranceSegmentAKId = INSG.InsuranceSegmentAKId and INSG.CurrentSnapshotFlag = 1\r\n\t\t\tand policy.PolicyOfferingAKId = PO.PolicyOfferingAKId and PO.CurrentSnapshotFlag = 1\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_key,eff_from_date,eff_to_date ORDER BY pol_id DESC) = 1\n\t),\n\tEXP_get_reserve_calc_ids AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence.claim_occurrence_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_id), -1, claim_occurrence_id)\n\t\tIFF(claim_occurrence_id IS NULL, - 1, claim_occurrence_id) AS claim_occurrence_id_out,\n\t\t-- *INF*: IIF(ISNULL(claim_rep_occurrence_id), -1, claim_rep_occurrence_id)\n\t\tIFF(claim_rep_occurrence_id IS NULL, - 1, claim_rep_occurrence_id) AS claim_rep_occurrence_id_out,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_calculation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_calculation_id), -1, claim_occurrence_calculation_id)\n\t\tIFF(claim_occurrence_calculation_id IS NULL, - 1, claim_occurrence_calculation_id) AS claim_occurrence_calculation_id_out,\n\t\tEXP_get_values.IN_claim_occurrence_ak_id AS claim_occurrence_ak_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_ak_id), -1, claim_occurrence_ak_id)\n\t\tIFF(claim_occurrence_ak_id IS NULL, - 1, claim_occurrence_ak_id) AS claim_occurrence_ak_id_out,\n\t\tEXP_get_values.IN_trans_date,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'D', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: iif(isnull(claim_occurrence_reserve_calc_direct_loss_id), -1, claim_occurrence_reserve_calc_direct_loss_id)\n\t\tIFF(claim_occurrence_reserve_calc_direct_loss_id IS NULL, - 1, claim_occurrence_reserve_calc_direct_loss_id) AS out_claim_occurrence_reserve_calc_direct_loss_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'E', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_exp_id), -1, claim_occurrence_reserve_calc_exp_id)\n\t\tIFF(claim_occurrence_reserve_calc_exp_id IS NULL, - 1, claim_occurrence_reserve_calc_exp_id) AS out_claim_occurrence_reserve_calc_exp_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'B', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_subrogation_id), -1, claim_occurrence_reserve_calc_subrogation_id)\n\t\tIFF(claim_occurrence_reserve_calc_subrogation_id IS NULL, - 1, claim_occurrence_reserve_calc_subrogation_id) AS out_claim_occurrence_reserve_calc_subrogation_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'S', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_salvage_id), -1, claim_occurrence_reserve_calc_salvage_id)\n\t\tIFF(claim_occurrence_reserve_calc_salvage_id IS NULL, - 1, claim_occurrence_reserve_calc_salvage_id) AS out_claim_occurrence_reserve_calc_salvage_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_OCCURENCE_RESERVE_CALC(claim_occurrence_ak_id, 'R', IN_trans_date)\n\t\tLKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_reserve_calculation_id AS claim_occurrence_reserve_calc_recovery_id,\n\t\t-- *INF*: IIF(ISNULL(claim_occurrence_reserve_calc_recovery_id), -1, claim_occurrence_reserve_calc_recovery_id)\n\t\tIFF(claim_occurrence_reserve_calc_recovery_id IS NULL, - 1, claim_occurrence_reserve_calc_recovery_id) AS out_claim_occurrence_reserve_calc_recovery_id,\n\t\tLKP_claim_occurrence_calc.claim_occurrence_reported_date AS claim_occurrence_rpted_date\n\t\tFROM EXP_get_values\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_calc\n\t\tON LKP_claim_occurrence_calc.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence_calc.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence_calc.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.financial_type_code = 'D'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_D_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.financial_type_code = 'E'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_E_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.financial_type_code = 'B'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_B_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.financial_type_code = 'S'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_S_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_OCCURENCE_RESERVE_CALC LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date\n\t\tON LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.claim_occurrence_ak_id = claim_occurrence_ak_id\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.financial_type_code = 'R'\n\t\tAND LKP_CLAIM_OCCURENCE_RESERVE_CALC_claim_occurrence_ak_id_R_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t),\n\tLKP_claim_occurrence_dim AS (\n\t\tSELECT\n\t\tclaim_occurrence_dim_id,\n\t\tsource_claim_rpted_date,\n\t\tclaim_rpted_date,\n\t\tclaim_scripted_date,\n\t\tclaim_open_date,\n\t\tclaim_close_date,\n\t\tclaim_reopen_date,\n\t\tclaim_closed_after_reopen_date,\n\t\tclaim_notice_only_date,\n\t\tedw_claim_occurrence_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tclaim_occurrence_dim_id,\n\t\t\t\tsource_claim_rpted_date,\n\t\t\t\tclaim_rpted_date,\n\t\t\t\tclaim_scripted_date,\n\t\t\t\tclaim_open_date,\n\t\t\t\tclaim_close_date,\n\t\t\t\tclaim_reopen_date,\n\t\t\t\tclaim_closed_after_reopen_date,\n\t\t\t\tclaim_notice_only_date,\n\t\t\t\tedw_claim_occurrence_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM claim_occurrence_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_occurrence_ak_id,eff_from_date,eff_to_date ORDER BY claim_occurrence_dim_id DESC) = 1\n\t),\n\tLKP_Agency_Key AS (\n\t\tSELECT\n\t\tagency_key,\n\t\tagency_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_key,\n\t\t\t\tagency_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM agency\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_ak_id,eff_from_date,eff_to_date ORDER BY agency_key DESC) = 1\n\t),\n\tLKP_contract_customer AS (\n\t\tSELECT\n\t\tcontract_cust_id,\n\t\tcontract_cust_ak_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_id,\n\t\t\t\tcontract_cust_ak_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY contract_cust_ak_id,eff_from_date,eff_to_date ORDER BY contract_cust_id DESC) = 1\n\t),\n\tLKP_Policy_Dim AS (\n\t\tSELECT\n\t\tpol_dim_id,\n\t\tedw_pol_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tpol_dim_id,\n\t\t\t\tedw_pol_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM policy_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_pol_pk_id,eff_from_date,eff_to_date ORDER BY pol_dim_id DESC) = 1\n\t),\n\tLKP_AgencyDim AS (\n\t\tSELECT\n\t\tAgencyDimID,\n\t\tEDWAgencyAKID,\n\t\tEffectiveDate,\n\t\tExpirationDate\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tAgencyDimID,\n\t\t\t\tEDWAgencyAKID,\n\t\t\t\tEffectiveDate,\n\t\t\t\tExpirationDate\n\t\t\tFROM V3.AgencyDim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY EDWAgencyAKID,EffectiveDate,ExpirationDate ORDER BY AgencyDimID DESC) = 1\n\t),\n\tEXP_Claim_Rep_Lkp_Values AS (\n\t\tSELECT\n\t\tEXP_get_reserve_calc_ids.IN_trans_date,\n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_rep_ak_id AS claim_rep_primary_rep_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_rep_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_rep_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_Examiner.claim_rep_ak_id AS claim_rep_examiner_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_examiner_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_examiner_wbconnect_user_id,\n\t\tLKP_Claim_Rep_Occurrence_PLH.claim_rep_ak_id AS claim_rep_primary_lit_handler_ak_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REPRESENTATIVE(claim_rep_primary_lit_handler_ak_id, IN_trans_date)\n\t\tLKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_wbconnect_user_id AS v_claim_rep_primary_lit_handler_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_rep_ak_id, v_claim_rep_primary_rep_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_claim_rep_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_examiner_ak_id, v_claim_rep_examiner_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_examiner_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_primary_lit_handler_ak_id, v_claim_rep_primary_lit_handler_wbconnect_user_id, IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_rep_dim_prim_litigation_handler_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_ak_id,\n\t\tLKP_Claim_Created_by_rep_ak_id.claim_rep_wbconnect_user_id,\n\t\t-- *INF*: :LKP.LKP_CLAIM_REP_DIM(claim_rep_ak_id,claim_rep_wbconnect_user_id,IN_trans_date)\n\t\tLKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_dim_id AS claim_created_by_id\n\t\tFROM EXP_get_reserve_calc_ids\n\t\tLEFT JOIN LKP_Claim_Created_by_rep_ak_id\n\t\tON LKP_Claim_Created_by_rep_ak_id.claim_rep_key = LKP_claim_occurrence.claim_created_by_key AND LKP_Claim_Created_by_rep_ak_id.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Created_by_rep_ak_id.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Examiner\n\t\tON LKP_Claim_Rep_Occurrence_Examiner.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Examiner.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Examiner.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_PLH\n\t\tON LKP_Claim_Rep_Occurrence_PLH.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_PLH.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_PLH.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_rep_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_examiner_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REPRESENTATIVE LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date\n\t\tON LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.claim_rep_ak_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REPRESENTATIVE_claim_rep_primary_lit_handler_ak_id_IN_trans_date.eff_from_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_rep_ak_id_v_claim_rep_primary_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_examiner_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_examiner_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_examiner_ak_id_v_claim_rep_examiner_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_primary_lit_handler_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_from_date = v_claim_rep_primary_lit_handler_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_primary_lit_handler_ak_id_v_claim_rep_primary_lit_handler_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t\tLEFT JOIN LKP_CLAIM_REP_DIM LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date\n\t\tON LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.claim_rep_wbconnect_user_id = claim_rep_ak_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_from_date = claim_rep_wbconnect_user_id\n\t\tAND LKP_CLAIM_REP_DIM_claim_rep_ak_id_claim_rep_wbconnect_user_id_IN_trans_date.eff_to_date = IN_trans_date\n\t\n\t),\n\tLKP_agency_Dim AS (\n\t\tSELECT\n\t\tagency_dim_id,\n\t\tagency_key,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tagency_dim_id,\n\t\t\t\tagency_key,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM V2.agency_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY agency_key,eff_from_date,eff_to_date ORDER BY agency_dim_id DESC) = 1\n\t),\n\tLKP_contract_customer_dim AS (\n\t\tSELECT\n\t\tcontract_cust_dim_id,\n\t\tedw_contract_cust_pk_id,\n\t\teff_from_date,\n\t\teff_to_date\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tcontract_cust_dim_id,\n\t\t\t\tedw_contract_cust_pk_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date\n\t\t\tFROM contract_customer_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_contract_cust_pk_id,eff_from_date,eff_to_date ORDER BY contract_cust_dim_id DESC) = 1\n\t),\n\tOUTPUT AS (\n\t\tSELECT\n\t\tLKP_claim_occurrence_dim.claim_occurrence_dim_id, \n\t\tLKP_claim_occurrence.claim_loss_date, \n\t\tLKP_claim_occurrence.claim_discovery_date, \n\t\tLKP_claim_occurrence_dim.claim_scripted_date, \n\t\tLKP_claim_occurrence_dim.source_claim_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_rpted_date AS claim_occurrence_rpted_date, \n\t\tLKP_claim_occurrence_dim.claim_open_date, \n\t\tLKP_claim_occurrence_dim.claim_close_date, \n\t\tLKP_claim_occurrence_dim.claim_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_closed_after_reopen_date, \n\t\tLKP_claim_occurrence_dim.claim_notice_only_date, \n\t\tLKP_claim_occurrence.claim_cat_start_date, \n\t\tLKP_claim_occurrence.claim_cat_end_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.claim_assigned_date AS claim_rep_assigned_date, \n\t\tLKP_Claim_Rep_Occurrence_Handler.eff_to_date AS claim_rep_unassigned_date, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_claim_rep_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_examiner_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_rep_dim_prim_litigation_handler_id, \n\t\tLKP_Policy_Dim.pol_dim_id AS pol_key_dim_id, \n\t\tLKP_V2_policy.pol_eff_date, \n\t\tLKP_V2_policy.pol_exp_date, \n\t\tLKP_agency_Dim.agency_dim_id, \n\t\tEXP_Claim_Rep_Lkp_Values.claim_created_by_id, \n\t\tLKP_contract_customer_dim.contract_cust_dim_id, \n\t\tLKP_V2_policy.pol_sym, \n\t\tLKP_V2_policy.pol_num, \n\t\tLKP_V2_policy.strtgc_bus_dvsn_ak_id, \n\t\tLKP_AgencyDim.AgencyDimID, \n\t\tLKP_V2_policy.StrategicProfitCenterCode, \n\t\tLKP_V2_policy.InsuranceSegmentCode, \n\t\tLKP_V2_policy.PolicyOfferingCode\n\t\tFROM EXP_Claim_Rep_Lkp_Values\n\t\tLEFT JOIN LKP_AgencyDim\n\t\tON LKP_AgencyDim.EDWAgencyAKID = LKP_V2_policy.AgencyAKID AND LKP_AgencyDim.EffectiveDate <= EXP_get_values.IN_trans_date AND LKP_AgencyDim.ExpirationDate >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Claim_Rep_Occurrence_Handler\n\t\tON LKP_Claim_Rep_Occurrence_Handler.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_Claim_Rep_Occurrence_Handler.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Claim_Rep_Occurrence_Handler.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_Policy_Dim\n\t\tON LKP_Policy_Dim.edw_pol_pk_id = LKP_V2_policy.pol_id AND LKP_Policy_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_Policy_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_V2_policy\n\t\tON LKP_V2_policy.pol_key = LKP_claim_occurrence.pol_key AND LKP_V2_policy.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_V2_policy.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_agency_Dim\n\t\tON LKP_agency_Dim.agency_key = LKP_Agency_Key.agency_key AND LKP_agency_Dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_agency_Dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence\n\t\tON LKP_claim_occurrence.claim_occurrence_ak_id = EXP_get_values.IN_claim_occurrence_ak_id AND LKP_claim_occurrence.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_claim_occurrence.eff_to_date >= EXP_get_values.IN_trans_date\n\t\tLEFT JOIN LKP_claim_occurrence_dim\n\t\tON LKP_claim_occurrence_dim.edw_claim_occurrence_ak_id = EXP_get_reserve_calc_ids.claim_occurrence_ak_id_out AND LKP_claim_occurrence_dim.eff_from_date <= EXP_get_reserve_calc_ids.IN_trans_date AND LKP_claim_occurrence_dim.eff_to_date >= EXP_get_reserve_calc_ids.IN_trans_date\n\t\tLEFT JOIN LKP_contract_customer_dim\n\t\tON LKP_contract_customer_dim.edw_contract_cust_pk_id = LKP_contract_customer.contract_cust_id AND LKP_contract_customer_dim.eff_from_date <= EXP_get_values.IN_trans_date AND LKP_contract_customer_dim.eff_to_date >= EXP_get_values.IN_trans_date\n\t),\n),\nEXP_Capture_Date_Ids AS (\n\tSELECT\n\tclaim_loss_date AS IN_claim_loss_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_loss_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_loss_date), v_claim_loss_date, -1)\n\tIFF(NOT v_claim_loss_date IS NULL, v_claim_loss_date, - 1) AS claim_loss_date_id,\n\tclaim_discovery_date AS IN_claim_discovery_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS V_claim_discovery_date,\n\t-- *INF*: IIF(NOT ISNULL(V_claim_discovery_date), V_claim_discovery_date, -1)\n\tIFF(NOT V_claim_discovery_date IS NULL, V_claim_discovery_date, - 1) AS claim_discovery_date_id,\n\tclaim_scripted_date AS IN_claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_scripted_date,\n\t-- *INF*: IIF(ISNULL(v_claim_scripted_date),-1,v_claim_scripted_date)\n\tIFF(v_claim_scripted_date IS NULL, - 1, v_claim_scripted_date) AS claim_scripted_date_id,\n\tsource_claim_rpted_date AS IN_source_claim_scripted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_source_claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_source_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_source_claim_scripted_date,\n\t-- *INF*: IIF(ISNULL(v_source_claim_scripted_date),-1,v_source_claim_scripted_date)\n\tIFF(v_source_claim_scripted_date IS NULL, - 1, v_source_claim_scripted_date) AS source_claim_scripted_date_id,\n\tclaim_occurrence_rpted_date AS IN_claim_rpted_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rpted_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rpted_date), v_claim_rpted_date, -1)\n\tIFF(NOT v_claim_rpted_date IS NULL, v_claim_rpted_date, - 1) AS claim_rpted_date_id,\n\tclaim_open_date AS IN_claim_open_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_open_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_open_date), v_claim_open_date, -1)\n\tIFF(NOT v_claim_open_date IS NULL, v_claim_open_date, - 1) AS claim_open_date_id,\n\tclaim_close_date AS IN_claim_close_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_close_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_close_date), v_claim_close_date, -1)\n\tIFF(NOT v_claim_close_date IS NULL, v_claim_close_date, - 1) AS claim_close_date_id,\n\tclaim_reopen_date AS IN_claim_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_reopen_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_reopen_date), v_claim_reopen_date, -1)\n\tIFF(NOT v_claim_reopen_date IS NULL, v_claim_reopen_date, - 1) AS claim_reopen_date_id,\n\tclaim_closed_after_reopen_date AS IN_claim_closed_after_reopen_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_closed_after_reopen_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_closed_after_reopen_date), v_claim_closed_after_reopen_date, -1)\n\tIFF(NOT v_claim_closed_after_reopen_date IS NULL, v_claim_closed_after_reopen_date, - 1) AS claim_closed_after_reopen_date_id,\n\tclaim_notice_only_date AS IN_claim_notice_only_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_notice_only_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_notice_only_date), v_claim_notice_only_date, -1)\n\tIFF(NOT v_claim_notice_only_date IS NULL, v_claim_notice_only_date, - 1) AS claim_notice_only_date_id,\n\tclaim_cat_start_date AS IN_claim_cat_start_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_start_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_start_date), v_claim_cat_start_date, -1)\n\tIFF(NOT v_claim_cat_start_date IS NULL, v_claim_cat_start_date, - 1) AS claim_cat_start_date_id,\n\tclaim_cat_end_date AS IN_claim_cat_end_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_cat_end_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_cat_end_date), v_claim_cat_end_date, -1)\n\tIFF(NOT v_claim_cat_end_date IS NULL, v_claim_cat_end_date, - 1) AS claim_cat_end_date_id,\n\tclaim_rep_assigned_date AS IN_claim_rep_assigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_assigned_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_assigned_date), v_claim_rep_assigned_date, -1)\n\tIFF(NOT v_claim_rep_assigned_date IS NULL, v_claim_rep_assigned_date, - 1) AS claim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date AS IN_claim_rep_unassigned_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_claim_rep_unassigned_date,\n\t-- *INF*: IIF(NOT ISNULL(v_claim_rep_unassigned_date), v_claim_rep_unassigned_date, -1)\n\tIFF(NOT v_claim_rep_unassigned_date IS NULL, v_claim_rep_unassigned_date, - 1) AS claim_rep_unassigned_date_id,\n\tpol_eff_date AS IN_pol_eff_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_eff_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_eff_date), v_pol_eff_date, -1)\n\tIFF(NOT v_pol_eff_date IS NULL, v_pol_eff_date, - 1) AS pol_eff_date_id,\n\tpol_exp_date AS IN_pol_exp_date,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pol_exp_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pol_exp_date), v_pol_exp_date, -1)\n\tIFF(NOT v_pol_exp_date IS NULL, v_pol_exp_date, - 1) AS pol_exp_date_id,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pay_issued_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_issued_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_issued_date), v_pay_issued_date, -1)\n\tIFF(NOT v_pay_issued_date IS NULL, v_pay_issued_date, - 1) AS pay_issued_date_id,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pay_cashed_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_cashed_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_cashed_date), v_pay_cashed_date, -1)\n\tIFF(NOT v_pay_cashed_date IS NULL, v_pay_cashed_date, - 1) AS pay_cashed_date_id,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pay_voided_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_voided_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_voided_date), v_pay_voided_date, -1)\n\tIFF(NOT v_pay_voided_date IS NULL, v_pay_voided_date, - 1) AS pay_voided_date_id,\n\t-- *INF*: :LKP.LKP_CALENDER_DIM(to_date(to_char(IN_pay_reposted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY'))\n\tLKP_CALENDER_DIM_to_date_to_char_IN_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_id AS v_pay_reposted_date,\n\t-- *INF*: IIF(NOT ISNULL(v_pay_reposted_date), v_pay_reposted_date, -1)\n\tIFF(NOT v_pay_reposted_date IS NULL, v_pay_reposted_date, - 1) AS pay_reposted_date_id\n\tFROM mplt_Claim_occurrence\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_loss_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_loss_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_discovery_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_discovery_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_source_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_source_claim_scripted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_source_claim_scripted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_rpted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_rpted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_open_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_open_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_open_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_close_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_close_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_close_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_closed_after_reopen_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_closed_after_reopen_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_notice_only_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_notice_only_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_start_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_cat_start_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_cat_end_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_cat_end_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_assigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_rep_assigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_claim_rep_unassigned_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_claim_rep_unassigned_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pol_eff_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pol_eff_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pol_exp_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pol_exp_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pay_issued_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pay_issued_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pay_cashed_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pay_cashed_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pay_voided_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pay_voided_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n\tLEFT JOIN LKP_CALENDER_DIM LKP_CALENDER_DIM_to_date_to_char_IN_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY\n\tON LKP_CALENDER_DIM_to_date_to_char_IN_pay_reposted_date_MM_DD_YYYY_MM_DD_YYYY.clndr_date = to_date(to_char(IN_pay_reposted_date, 'MM/DD/YYYY'), 'MM/DD/YYYY')\n\n),\nLKP_Claimant_Dim AS (\n\tSELECT\n\tclaimant_dim_id,\n\tedw_claim_party_occurrence_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tclaimant_dim_id,\n\t\t\tedw_claim_party_occurrence_ak_id\n\t\tFROM claimant_dim\n\t\tWHERE crrnt_snpsht_flag = 1\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_claim_party_occurrence_ak_id ORDER BY claimant_dim_id DESC) = 1\n),\nLKP_Med_Bill_Dim AS (\n\tSELECT\n\tmed_bill_dim_id,\n\tedw_med_bill_ak_id\n\tFROM (\n\t\tSELECT \n\t\t\tmed_bill_dim_id,\n\t\t\tedw_med_bill_ak_id\n\t\tFROM medical_bill_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_med_bill_ak_id ORDER BY med_bill_dim_id DESC) = 1\n),\nLKP_Med_Bill_Serv_Dim_ID AS (\n\tSELECT\n\tmed_bill_serv_dim_id,\n\tedw_med_bill_serv_pk_id\n\tFROM (\n\t\tSELECT \n\t\t\tmed_bill_serv_dim_id,\n\t\t\tedw_med_bill_serv_pk_id\n\t\tFROM medical_bill_service_dim\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY edw_med_bill_serv_pk_id ORDER BY med_bill_serv_dim_id DESC) = 1\n),\nmplt_Strategic_Business_Division_Dim AS (WITH\n\tINPUT_Strategic_Business_Division AS (\n\t\t\n\t),\n\tEXP_inputs AS (\n\t\tSELECT\n\t\tpolicy_symbol,\n\t\tpolicy_number,\n\t\tpolicy_eff_date AS policy_eff_date_in,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol)='N/A','N/A',substr(policy_symbol,1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_symbol) = 'N/A', 'N/A', substr(policy_symbol, 1, 1)) AS policy_symbol_position_1,\n\t\t-- *INF*: IIF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number)='N/A','N/A',substr(policy_number,1,1))\n\t\tIFF(:UDF.DEFAULT_VALUE_FOR_STRINGS(policy_number) = 'N/A', 'N/A', substr(policy_number, 1, 1)) AS policy_number_position_1,\n\t\t-- *INF*: IIF(isnull(policy_eff_date_in),SYSDATE,policy_eff_date_in)\n\t\tIFF(policy_eff_date_in IS NULL, SYSDATE, policy_eff_date_in) AS policy_eff_date\n\t\tFROM INPUT_Strategic_Business_Division\n\t),\n\tLKP_strategic_business_division_dim AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tcrrnt_snpsht_flag,\n\t\taudit_id,\n\t\teff_from_date,\n\t\teff_to_date,\n\t\tcreated_date,\n\t\tmodified_date,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tpol_sym_1,\n\t\tpol_num_1,\n\t\tpol_eff_date,\n\t\tpol_exp_date,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\tpolicy_symbol_position_IN,\n\t\tpolicy_number_position_IN,\n\t\tpolicy_eff_date_IN\n\t\tFROM (\n\t\t\tSELECT \n\t\t\t\tstrtgc_bus_dvsn_dim_id,\n\t\t\t\tcrrnt_snpsht_flag,\n\t\t\t\taudit_id,\n\t\t\t\teff_from_date,\n\t\t\t\teff_to_date,\n\t\t\t\tcreated_date,\n\t\t\t\tmodified_date,\n\t\t\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\t\t\tpol_sym_1,\n\t\t\t\tpol_num_1,\n\t\t\t\tpol_eff_date,\n\t\t\t\tpol_exp_date,\n\t\t\t\tstrtgc_bus_dvsn_code,\n\t\t\t\tstrtgc_bus_dvsn_code_descript,\n\t\t\t\tpolicy_symbol_position_IN,\n\t\t\t\tpolicy_number_position_IN,\n\t\t\t\tpolicy_eff_date_IN\n\t\t\tFROM strategic_business_division_dim\n\t\t)\n\t\tQUALIFY ROW_NUMBER() OVER (PARTITION BY pol_sym_1,pol_num_1,pol_eff_date,pol_exp_date ORDER BY strtgc_bus_dvsn_dim_id) = 1\n\t),\n\tEXP_check_outputs AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_dim_id,\n\t\tedw_strtgc_bus_dvsn_ak_id,\n\t\tstrtgc_bus_dvsn_code,\n\t\tstrtgc_bus_dvsn_code_descript,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_dim_id),-1,strtgc_bus_dvsn_dim_id)\n\t\tIFF(strtgc_bus_dvsn_dim_id IS NULL, - 1, strtgc_bus_dvsn_dim_id) AS strtgc_bus_dvsn_id_out,\n\t\t-- *INF*: IIF(isnull(edw_strtgc_bus_dvsn_ak_id),-1,edw_strtgc_bus_dvsn_ak_id)\n\t\tIFF(edw_strtgc_bus_dvsn_ak_id IS NULL, - 1, edw_strtgc_bus_dvsn_ak_id) AS edw_strtgc_bus_dvsn_ak_id_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code),'N/A',strtgc_bus_dvsn_code)\n\t\tIFF(strtgc_bus_dvsn_code IS NULL, 'N/A', strtgc_bus_dvsn_code) AS strtgc_bus_dvsn_code_out,\n\t\t-- *INF*: IIF(isnull(strtgc_bus_dvsn_code_descript),'N/A',strtgc_bus_dvsn_code_descript)\n\t\tIFF(strtgc_bus_dvsn_code_descript IS NULL, 'N/A', strtgc_bus_dvsn_code_descript) AS strtgc_bus_dvsn_code_descript_out\n\t\tFROM LKP_strategic_business_division_dim\n\t),\n\tOUTPUT_return_Strategic_Business_Division AS (\n\t\tSELECT\n\t\tstrtgc_bus_dvsn_id_out AS strtgc_bus_dvsn_dim_id, \n\t\tedw_strtgc_bus_dvsn_ak_id_out AS edw_strtgc_bus_dvsn_ak_id, \n\t\tstrtgc_bus_dvsn_code_out AS strtgc_bus_dvsn_code, \n\t\tstrtgc_bus_dvsn_code_descript_out AS strtgc_bus_dvsn_code_descript\n\t\tFROM EXP_check_outputs\n\t),\n),\nEXP_Service_Amounts AS (\n\tSELECT\n\tEXP_Source.serv_charge,\n\tEXP_Source.serv_bill_review_red,\n\tEXP_Source.serv_network_red,\n\tserv_bill_review_red + serv_network_red AS v_gross_serv_saving,\n\tv_gross_serv_saving AS gross_serv_saving,\n\t-- *INF*: decode(true,\r\n\t-- serv_charge <> 0,\r\n\t-- (v_gross_serv_saving / serv_charge) * 100,\r\n\t-- 0)\n\tdecode(true,\n\tserv_charge <> 0, ( v_gross_serv_saving / serv_charge ) * 100,\n\t0) AS gross_serv_saving_perc,\n\t-- *INF*: decode(true,\r\n\t-- serv_charge <> 0,\r\n\t-- (serv_bill_review_red / serv_charge) * 100,\r\n\t-- 0\r\n\t-- )\n\tdecode(true,\n\tserv_charge <> 0, ( serv_bill_review_red / serv_charge ) * 100,\n\t0) AS service_review_saving_perc,\n\t-- *INF*: decode(true,\r\n\t-- serv_charge <> 0,\r\n\t-- (serv_network_red / serv_charge) * 100,\r\n\t-- 0\r\n\t-- )\n\tdecode(true,\n\tserv_charge <> 0, ( serv_network_red / serv_charge ) * 100,\n\t0) AS total_serv_network_red_perc,\n\t@{pipeline().parameters.WBMI_AUDIT_CONTROL_RUN_ID} AS audit_id,\n\tLKP_Med_Bill_Serv_Dim_ID.med_bill_serv_dim_id AS in_med_bill_serv_dim_id,\n\t-- *INF*: iif(isnull(in_med_bill_serv_dim_id),-1,in_med_bill_serv_dim_id)\n\tIFF(in_med_bill_serv_dim_id IS NULL, - 1, in_med_bill_serv_dim_id) AS med_bill_serv_dim_id,\n\tLKP_Claim_Occurrence_Dim_ID.claim_occurrence_dim_id,\n\tLKP_Med_Bill_Dim.med_bill_dim_id AS in_med_bill_dim_id,\n\t-- *INF*: iif(isnull(in_med_bill_dim_id),-1,in_med_bill_dim_id)\n\tIFF(in_med_bill_dim_id IS NULL, - 1, in_med_bill_dim_id) AS med_bill_dim_id,\n\tEXP_Capture_Date_Ids.claim_loss_date_id,\n\tEXP_Capture_Date_Ids.claim_discovery_date_id,\n\tEXP_Capture_Date_Ids.claim_rpted_date_id,\n\tEXP_Capture_Date_Ids.claim_open_date_id,\n\tEXP_Capture_Date_Ids.claim_close_date_id,\n\tEXP_Capture_Date_Ids.claim_reopen_date_id,\n\tEXP_Capture_Date_Ids.claim_closed_after_reopen_date_id,\n\tEXP_Capture_Date_Ids.claim_cat_start_date_id,\n\tEXP_Capture_Date_Ids.claim_cat_end_date_id,\n\tEXP_Capture_Date_Ids.claim_rep_assigned_date_id,\n\tEXP_Capture_Date_Ids.claim_rep_unassigned_date_id,\n\tEXP_Capture_Date_Ids.claim_scripted_date_id AS Claim_scripted_date_id,\n\tEXP_Capture_Date_Ids.source_claim_scripted_date_id AS Source_Claim_scripted_date_id,\n\tEXP_Capture_Date_Ids.claim_notice_only_date_id AS Claim_Notice_only_Date_ID,\n\tmplt_Claim_occurrence.agency_dim_id AS in_agency_dim_id,\n\t-- *INF*: iif(isnull(in_agency_dim_id),-1,in_agency_dim_id)\n\tIFF(in_agency_dim_id IS NULL, - 1, in_agency_dim_id) AS agency_dim_id,\n\tmplt_Claim_occurrence.contract_cust_dim_id AS in_contract_cust_dim_id,\n\t-- *INF*: iif(isnull(in_contract_cust_dim_id),-1,in_contract_cust_dim_id)\n\tIFF(in_contract_cust_dim_id IS NULL, - 1, in_contract_cust_dim_id) AS contract_cust_dim_id,\n\tmplt_Claim_occurrence.pol_key_dim_id AS in_pol_dim_id,\n\t-- *INF*: iif(isnull(in_pol_dim_id),-1,in_pol_dim_id)\n\tIFF(in_pol_dim_id IS NULL, - 1, in_pol_dim_id) AS pol_dim_id,\n\tEXP_Capture_Date_Ids.pol_eff_date_id,\n\tEXP_Capture_Date_Ids.pol_exp_date_id,\n\tLKP_Claimant_Dim.claimant_dim_id AS in_claimant_dim_id,\n\t-- *INF*: iif(isnull(in_claimant_dim_id),-1,in_claimant_dim_id)\n\tIFF(in_claimant_dim_id IS NULL, - 1, in_claimant_dim_id) AS claimant_dim_id,\n\tmplt_Claim_occurrence.claim_rep_dim_prim_claim_rep_id AS in_claim_rep_dim_prim_claim_rep_id,\n\t-- *INF*: iif(isnull(in_claim_rep_dim_prim_claim_rep_id),-1,in_claim_rep_dim_prim_claim_rep_id)\n\tIFF(in_claim_rep_dim_prim_claim_rep_id IS NULL, - 1, in_claim_rep_dim_prim_claim_rep_id) AS claim_rep_dim_prim_claim_rep_id,\n\tmplt_Claim_occurrence.claim_occurrence_dim_id AS claim_occurrence_dim_id1,\n\tmplt_Strategic_Business_Division_Dim.strtgc_bus_dvsn_dim_id,\n\tmplt_Claim_occurrence.AgencyDimID\n\tFROM EXP_Capture_Date_Ids\n\t -- Manually join with EXP_Source\n\t -- Manually join with mplt_Claim_occurrence\n\t -- Manually join with mplt_Strategic_Business_Division_Dim\n\tLEFT JOIN LKP_Claim_Occurrence_Dim_ID\n\tON LKP_Claim_Occurrence_Dim_ID.med_bill_ak_id = EXP_Source.med_bill_ak_id\n\tLEFT JOIN LKP_Claimant_Dim\n\tON LKP_Claimant_Dim.edw_claim_party_occurrence_ak_id = LKP_Claim_Occurrence_Dim_ID.edw_claim_party_occurrence_ak_id\n\tLEFT JOIN LKP_Med_Bill_Dim\n\tON LKP_Med_Bill_Dim.edw_med_bill_ak_id = EXP_Source.med_bill_ak_id\n\tLEFT JOIN LKP_Med_Bill_Serv_Dim_ID\n\tON LKP_Med_Bill_Serv_Dim_ID.edw_med_bill_serv_pk_id = EXP_Source.med_bill_serv_id\n),\nLKP_Medical_Bill_Service_Fact AS (\n\tSELECT\n\tmed_bill_serv_fact_id,\n\tmed_bill_dim_id,\n\tmed_bill_serv_dim_id,\n\tclaim_occurrence_dim_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_scripted_date_id,\n\tsource_claim_rpted_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tclaim_notice_only_date_id,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tgross_serv_saving,\n\tgross_serv_saving_percentage,\n\ttotal_serv_review_saving,\n\tserv_review_saving_percentage,\n\ttotal_serv_network_red,\n\ttotal_serv_network_red_percentage,\n\ttotal_serv_charge,\n\tagency_dim_id,\n\tcontract_cust_dim_id,\n\tpol_dim_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tclaimant_dim_id,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tstrtgc_bus_dvsn_dim_id\n\tFROM (\n\t\tSELECT \n\t\t\tmed_bill_serv_fact_id,\n\t\t\tmed_bill_dim_id,\n\t\t\tmed_bill_serv_dim_id,\n\t\t\tclaim_occurrence_dim_id,\n\t\t\tclaim_loss_date_id,\n\t\t\tclaim_discovery_date_id,\n\t\t\tclaim_scripted_date_id,\n\t\t\tsource_claim_rpted_date_id,\n\t\t\tclaim_rpted_date_id,\n\t\t\tclaim_open_date_id,\n\t\t\tclaim_close_date_id,\n\t\t\tclaim_reopen_date_id,\n\t\t\tclaim_closed_after_reopen_date_id,\n\t\t\tclaim_notice_only_date_id,\n\t\t\tclaim_cat_start_date_id,\n\t\t\tclaim_cat_end_date_id,\n\t\t\tclaim_rep_assigned_date_id,\n\t\t\tclaim_rep_unassigned_date_id,\n\t\t\tgross_serv_saving,\n\t\t\tgross_serv_saving_percentage,\n\t\t\ttotal_serv_review_saving,\n\t\t\tserv_review_saving_percentage,\n\t\t\ttotal_serv_network_red,\n\t\t\ttotal_serv_network_red_percentage,\n\t\t\ttotal_serv_charge,\n\t\t\tagency_dim_id,\n\t\t\tcontract_cust_dim_id,\n\t\t\tpol_dim_id,\n\t\t\tpol_eff_date_id,\n\t\t\tpol_exp_date_id,\n\t\t\tclaimant_dim_id,\n\t\t\tclaim_rep_dim_prim_claim_rep_id,\n\t\t\tstrtgc_bus_dvsn_dim_id\n\t\tFROM medical_bill_service_fact\n\t)\n\tQUALIFY ROW_NUMBER() OVER (PARTITION BY med_bill_serv_dim_id ORDER BY med_bill_serv_fact_id DESC) = 1\n),\nEXP_Detect_Changes AS (\n\tSELECT\n\tLKP_Medical_Bill_Service_Fact.med_bill_serv_fact_id AS LKP_med_bill_serv_fact_id,\n\tLKP_Medical_Bill_Service_Fact.med_bill_dim_id AS LKP_med_bill_dim_id,\n\tLKP_Medical_Bill_Service_Fact.med_bill_serv_dim_id AS LKP_med_bill_serv_dim_id,\n\tLKP_Medical_Bill_Service_Fact.claim_occurrence_dim_id AS LKP_claim_occurrence_dim_id,\n\tLKP_Medical_Bill_Service_Fact.claim_loss_date_id AS LKP_claim_loss_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_discovery_date_id AS LKP_claim_discovery_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_scripted_date_id AS LKP_claim_scripted_date_id,\n\tLKP_Medical_Bill_Service_Fact.source_claim_rpted_date_id AS LKP_source_claim_rpted_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_rpted_date_id AS LKP_claim_rpted_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_open_date_id AS LKP_claim_open_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_close_date_id AS LKP_claim_close_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_reopen_date_id AS LKP_claim_reopen_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_closed_after_reopen_date_id AS LKP_claim_closed_after_reopen_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_notice_only_date_id AS LKP_claim_notice_only_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_cat_start_date_id AS LKP_claim_cat_start_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_cat_end_date_id AS LKP_claim_cat_end_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_rep_assigned_date_id AS LKP_claim_rep_assigned_date_id,\n\tLKP_Medical_Bill_Service_Fact.claim_rep_unassigned_date_id AS LKP_claim_rep_unassigned_date_id,\n\tLKP_Medical_Bill_Service_Fact.gross_serv_saving AS LKP_gross_serv_saving,\n\tLKP_Medical_Bill_Service_Fact.gross_serv_saving_percentage AS LKP_gross_serv_saving_percentage,\n\tLKP_Medical_Bill_Service_Fact.total_serv_review_saving AS LKP_total_serv_review_saving,\n\tLKP_Medical_Bill_Service_Fact.serv_review_saving_percentage AS LKP_serv_review_saving_percentage,\n\tLKP_Medical_Bill_Service_Fact.total_serv_network_red AS LKP_total_serv_network_red,\n\tLKP_Medical_Bill_Service_Fact.total_serv_network_red_percentage AS LKP_total_serv_network_red_percentage,\n\tLKP_Medical_Bill_Service_Fact.total_serv_charge AS LKP_total_serv_charge,\n\tLKP_Medical_Bill_Service_Fact.agency_dim_id AS LKP_agency_dim_id,\n\tLKP_Medical_Bill_Service_Fact.contract_cust_dim_id AS LKP_contract_cust_dim_id,\n\tLKP_Medical_Bill_Service_Fact.pol_dim_id AS LKP_pol_dim_id,\n\tLKP_Medical_Bill_Service_Fact.pol_eff_date_id AS LKP_pol_eff_date_id,\n\tLKP_Medical_Bill_Service_Fact.pol_exp_date_id AS LKP_pol_exp_date_id,\n\tLKP_Medical_Bill_Service_Fact.claimant_dim_id AS LKP_claimant_dim_id,\n\tLKP_Medical_Bill_Service_Fact.claim_rep_dim_prim_claim_rep_id AS LKP_claim_rep_dim_prim_claim_rep_id,\n\tLKP_Medical_Bill_Service_Fact.strtgc_bus_dvsn_dim_id AS LKP_strtgc_bus_dvsn_dim_id,\n\tEXP_Service_Amounts.serv_charge,\n\tEXP_Service_Amounts.serv_bill_review_red,\n\tEXP_Service_Amounts.serv_network_red,\n\tEXP_Service_Amounts.gross_serv_saving,\n\tEXP_Service_Amounts.gross_serv_saving_perc,\n\tEXP_Service_Amounts.service_review_saving_perc,\n\tEXP_Service_Amounts.total_serv_network_red_perc,\n\tEXP_Service_Amounts.audit_id,\n\tEXP_Service_Amounts.med_bill_serv_dim_id,\n\tEXP_Service_Amounts.claim_occurrence_dim_id,\n\tEXP_Service_Amounts.med_bill_dim_id,\n\tEXP_Service_Amounts.claim_loss_date_id,\n\tEXP_Service_Amounts.claim_discovery_date_id,\n\tEXP_Service_Amounts.claim_rpted_date_id,\n\tEXP_Service_Amounts.claim_open_date_id,\n\tEXP_Service_Amounts.claim_close_date_id,\n\tEXP_Service_Amounts.claim_reopen_date_id,\n\tEXP_Service_Amounts.claim_closed_after_reopen_date_id,\n\tEXP_Service_Amounts.claim_cat_start_date_id,\n\tEXP_Service_Amounts.claim_cat_end_date_id,\n\tEXP_Service_Amounts.claim_rep_assigned_date_id,\n\tEXP_Service_Amounts.claim_rep_unassigned_date_id,\n\tEXP_Service_Amounts.Claim_scripted_date_id,\n\tEXP_Service_Amounts.Source_Claim_scripted_date_id,\n\tEXP_Service_Amounts.Claim_Notice_only_Date_ID,\n\tEXP_Service_Amounts.agency_dim_id,\n\tEXP_Service_Amounts.contract_cust_dim_id,\n\tEXP_Service_Amounts.pol_dim_id,\n\tEXP_Service_Amounts.pol_eff_date_id,\n\tEXP_Service_Amounts.pol_exp_date_id,\n\tEXP_Service_Amounts.claimant_dim_id,\n\tEXP_Service_Amounts.claim_rep_dim_prim_claim_rep_id,\n\tEXP_Service_Amounts.strtgc_bus_dvsn_dim_id,\n\t-- *INF*: IIF(NOT ISNULL(LKP_med_bill_serv_fact_id),\r\n\t-- IIF(\r\n\t-- LKP_med_bill_dim_id  <> med_bill_dim_id OR\r\n\t-- LKP_claim_occurrence_dim_id  <> claim_occurrence_dim_id OR\r\n\t-- LKP_claim_loss_date_id  <>claim_loss_date_id OR\r\n\t-- LKP_claim_discovery_date_id  <>claim_discovery_date_id OR\r\n\t-- LKP_claim_scripted_date_id  <> Claim_scripted_date_id OR\r\n\t-- LKP_source_claim_rpted_date_id  <> Source_Claim_scripted_date_id OR\r\n\t-- LKP_claim_rpted_date_id  <> claim_rpted_date_id  OR\r\n\t-- LKP_claim_open_date_id  <> claim_open_date_id OR\r\n\t-- LKP_claim_close_date_id  <> claim_close_date_id OR\r\n\t-- LKP_claim_reopen_date_id  <> claim_reopen_date_id  OR\r\n\t-- LKP_claim_closed_after_reopen_date_id  <> claim_closed_after_reopen_date_id OR\r\n\t-- LKP_claim_notice_only_date_id  <> Claim_Notice_only_Date_ID OR\r\n\t-- LKP_claim_cat_start_date_id  <> claim_cat_start_date_id OR\r\n\t-- LKP_claim_cat_end_date_id  <> claim_cat_end_date_id OR\r\n\t-- LKP_claim_rep_assigned_date_id  <> claim_rep_assigned_date_id OR\r\n\t-- LKP_claim_rep_unassigned_date_id  <> claim_rep_unassigned_date_id OR\r\n\t-- LKP_gross_serv_saving  <> TRUNC(gross_serv_saving,2) OR\r\n\t-- LKP_gross_serv_saving_percentage  <> TRUNC(gross_serv_saving_perc,2) OR\r\n\t-- LKP_total_serv_review_saving  <>  TRUNC(serv_bill_review_red,2) OR\r\n\t-- LKP_serv_review_saving_percentage  <> TRUNC(service_review_saving_perc,2) OR\r\n\t-- LKP_total_serv_network_red  <> TRUNC(serv_network_red,2) OR\r\n\t-- LKP_total_serv_network_red_percentage  <> TRUNC(total_serv_network_red_perc,2) OR\r\n\t-- LKP_total_serv_charge  <> TRUNC(serv_charge,2) OR\r\n\t-- LKP_agency_dim_id  <> agency_dim_id OR\r\n\t-- LKP_contract_cust_dim_id  <> contract_cust_dim_id  OR\r\n\t-- LKP_pol_dim_id  <> pol_dim_id OR\r\n\t-- LKP_pol_eff_date_id  <> pol_eff_date_id OR\r\n\t-- LKP_pol_exp_date_id  <> pol_exp_date_id OR\r\n\t-- LKP_claimant_dim_id  <> claimant_dim_id OR\r\n\t-- LKP_claim_rep_dim_prim_claim_rep_id  <> claim_rep_dim_prim_claim_rep_id OR\r\n\t-- LKP_strtgc_bus_dvsn_dim_id  <> strtgc_bus_dvsn_dim_id\r\n\t-- ,'UPDATE','NOCHANGE'),\r\n\t-- 'INSERT')\r\n\t-- \r\n\t-- ---- Had to use Trunc function to just limit the percentage to 2 places of precision.\n\tIFF(NOT LKP_med_bill_serv_fact_id IS NULL, IFF(LKP_med_bill_dim_id <> med_bill_dim_id OR LKP_claim_occurrence_dim_id <> claim_occurrence_dim_id OR LKP_claim_loss_date_id <> claim_loss_date_id OR LKP_claim_discovery_date_id <> claim_discovery_date_id OR LKP_claim_scripted_date_id <> Claim_scripted_date_id OR LKP_source_claim_rpted_date_id <> Source_Claim_scripted_date_id OR LKP_claim_rpted_date_id <> claim_rpted_date_id OR LKP_claim_open_date_id <> claim_open_date_id OR LKP_claim_close_date_id <> claim_close_date_id OR LKP_claim_reopen_date_id <> claim_reopen_date_id OR LKP_claim_closed_after_reopen_date_id <> claim_closed_after_reopen_date_id OR LKP_claim_notice_only_date_id <> Claim_Notice_only_Date_ID OR LKP_claim_cat_start_date_id <> claim_cat_start_date_id OR LKP_claim_cat_end_date_id <> claim_cat_end_date_id OR LKP_claim_rep_assigned_date_id <> claim_rep_assigned_date_id OR LKP_claim_rep_unassigned_date_id <> claim_rep_unassigned_date_id OR LKP_gross_serv_saving <> TRUNC(gross_serv_saving, 2) OR LKP_gross_serv_saving_percentage <> TRUNC(gross_serv_saving_perc, 2) OR LKP_total_serv_review_saving <> TRUNC(serv_bill_review_red, 2) OR LKP_serv_review_saving_percentage <> TRUNC(service_review_saving_perc, 2) OR LKP_total_serv_network_red <> TRUNC(serv_network_red, 2) OR LKP_total_serv_network_red_percentage <> TRUNC(total_serv_network_red_perc, 2) OR LKP_total_serv_charge <> TRUNC(serv_charge, 2) OR LKP_agency_dim_id <> agency_dim_id OR LKP_contract_cust_dim_id <> contract_cust_dim_id OR LKP_pol_dim_id <> pol_dim_id OR LKP_pol_eff_date_id <> pol_eff_date_id OR LKP_pol_exp_date_id <> pol_exp_date_id OR LKP_claimant_dim_id <> claimant_dim_id OR LKP_claim_rep_dim_prim_claim_rep_id <> claim_rep_dim_prim_claim_rep_id OR LKP_strtgc_bus_dvsn_dim_id <> strtgc_bus_dvsn_dim_id, 'UPDATE', 'NOCHANGE'), 'INSERT') AS V_Changed_Flag,\n\tV_Changed_Flag AS Changed_Flag\n\tFROM EXP_Service_Amounts\n\tLEFT JOIN LKP_Medical_Bill_Service_Fact\n\tON LKP_Medical_Bill_Service_Fact.med_bill_serv_dim_id = EXP_Service_Amounts.med_bill_serv_dim_id\n),\nRTR_Insert_Update AS (\n\tSELECT\n\tLKP_med_bill_serv_fact_id AS med_bill_serv_fact_id_exists,\n\tserv_charge,\n\tserv_bill_review_red,\n\tserv_network_red,\n\tgross_serv_saving,\n\tgross_serv_saving_perc,\n\tservice_review_saving_perc,\n\ttotal_serv_network_red_perc,\n\taudit_id,\n\tmed_bill_serv_dim_id,\n\tclaim_occurrence_dim_id,\n\tmed_bill_dim_id,\n\tClaim_scripted_date_id,\n\tSource_Claim_scripted_date_id,\n\tclaim_loss_date_id,\n\tclaim_discovery_date_id,\n\tclaim_rpted_date_id,\n\tclaim_open_date_id,\n\tclaim_close_date_id,\n\tclaim_reopen_date_id,\n\tclaim_closed_after_reopen_date_id,\n\tClaim_Notice_only_Date_ID,\n\tclaim_cat_start_date_id,\n\tclaim_cat_end_date_id,\n\tclaim_rep_assigned_date_id,\n\tclaim_rep_unassigned_date_id,\n\tagency_dim_id,\n\tcontract_cust_dim_id,\n\tpol_dim_id,\n\tpol_eff_date_id,\n\tpol_exp_date_id,\n\tclaimant_dim_id,\n\tclaim_rep_dim_prim_claim_rep_id,\n\tstrtgc_bus_dvsn_dim_id,\n\tChanged_Flag\n\tFROM EXP_Detect_Changes\n),\nRTR_Insert_Update_INSERT AS (SELECT * FROM RTR_Insert_Update WHERE Changed_Flag ='INSERT'),\nRTR_Insert_Update_UPDATE AS (SELECT * FROM RTR_Insert_Update WHERE Changed_Flag='UPDATE'),\nUPD_Med_Bill_Serv_Fact_Update AS (\n\tSELECT\n\tmed_bill_serv_fact_id_exists AS med_bill_serv_fact_id_exists2, \n\tserv_charge AS serv_charge2, \n\tserv_bill_review_red AS serv_bill_review_red2, \n\tserv_network_red AS serv_network_red2, \n\tgross_serv_saving AS gross_serv_saving2, \n\tgross_serv_saving_perc AS gross_serv_saving_perc2, \n\tservice_review_saving_perc AS service_review_saving_perc2, \n\ttotal_serv_network_red_perc AS total_serv_network_red_perc2, \n\taudit_id AS audit_id2, \n\tmed_bill_serv_dim_id AS med_bill_serv_dim_id2, \n\tclaim_occurrence_dim_id AS claim_occurrence_dim_id2, \n\tmed_bill_dim_id AS med_bill_dim_id2, \n\tclaim_loss_date_id, \n\tclaim_discovery_date_id, \n\tclaim_rpted_date_id, \n\tclaim_open_date_id, \n\tclaim_close_date_id, \n\tclaim_reopen_date_id, \n\tclaim_closed_after_reopen_date_id, \n\tclaim_cat_start_date_id, \n\tclaim_cat_end_date_id, \n\tclaim_rep_assigned_date_id, \n\tclaim_rep_unassigned_date_id, \n\tClaim_scripted_date_id AS Claim_scripted_date_id2, \n\tSource_Claim_scripted_date_id AS Source_Claim_scripted_date_id2, \n\tClaim_Notice_only_Date_ID AS Claim_Notice_only_Date_ID2, \n\tagency_dim_id AS agency_dim_id2, \n\tcontract_cust_dim_id AS contract_cust_dim_id2, \n\tpol_dim_id AS pol_dim_id2, \n\tpol_eff_date_id AS pol_eff_date_id2, \n\tpol_exp_date_id AS pol_exp_date_id2, \n\tclaimant_dim_id AS claimant_dim_id2, \n\tclaim_rep_dim_prim_claim_rep_id AS claim_rep_dim_prim_claim_rep_id2, \n\tstrtgc_bus_dvsn_dim_id AS strtgc_bus_dvsn_dim_id2\n\tFROM RTR_Insert_Update_UPDATE\n),\nmedical_bill_service_fact_upd AS (\n\tMERGE INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.medical_bill_service_fact AS T\n\tUSING UPD_Med_Bill_Serv_Fact_Update AS S\n\tON T.med_bill_serv_fact_id = S.med_bill_serv_fact_id_exists2\n\tWHEN MATCHED BY TARGET THEN\n\tUPDATE SET T.med_bill_dim_id = S.med_bill_dim_id2, T.med_bill_serv_dim_id = S.med_bill_serv_dim_id2, T.claim_occurrence_dim_id = S.claim_occurrence_dim_id2, T.claim_loss_date_id = S.claim_loss_date_id, T.claim_discovery_date_id = S.claim_discovery_date_id, T.claim_scripted_date_id = S.Claim_scripted_date_id2, T.source_claim_rpted_date_id = S.Source_Claim_scripted_date_id2, T.claim_rpted_date_id = S.claim_rpted_date_id, T.claim_open_date_id = S.claim_open_date_id, T.claim_close_date_id = S.claim_close_date_id, T.claim_reopen_date_id = S.claim_reopen_date_id, T.claim_closed_after_reopen_date_id = S.claim_closed_after_reopen_date_id, T.claim_notice_only_date_id = S.Claim_Notice_only_Date_ID2, T.claim_cat_start_date_id = S.claim_cat_start_date_id, T.claim_cat_end_date_id = S.claim_cat_end_date_id, T.claim_rep_assigned_date_id = S.claim_rep_assigned_date_id, T.claim_rep_unassigned_date_id = S.claim_rep_unassigned_date_id, T.gross_serv_saving = S.gross_serv_saving2, T.gross_serv_saving_percentage = S.gross_serv_saving_perc2, T.total_serv_review_saving = S.serv_bill_review_red2, T.serv_review_saving_percentage = S.service_review_saving_perc2, T.total_serv_network_red = S.serv_network_red2, T.total_serv_network_red_percentage = S.total_serv_network_red_perc2, T.total_serv_charge = S.serv_charge2, T.audit_id = S.audit_id2, T.agency_dim_id = S.agency_dim_id2, T.contract_cust_dim_id = S.contract_cust_dim_id2, T.pol_dim_id = S.pol_dim_id2, T.pol_eff_date_id = S.pol_eff_date_id2, T.pol_exp_date_id = S.pol_exp_date_id2, T.claimant_dim_id = S.claimant_dim_id2, T.claim_rep_dim_prim_claim_rep_id = S.claim_rep_dim_prim_claim_rep_id2, T.strtgc_bus_dvsn_dim_id = S.strtgc_bus_dvsn_dim_id2\n),\nmedical_bill_service_fact_ins AS (\n\tINSERT INTO @{pipeline().parameters.TARGET_TABLE_OWNER}.medical_bill_service_fact\n\t(med_bill_dim_id, med_bill_serv_dim_id, claim_occurrence_dim_id, claim_loss_date_id, claim_discovery_date_id, claim_scripted_date_id, source_claim_rpted_date_id, claim_rpted_date_id, claim_open_date_id, claim_close_date_id, claim_reopen_date_id, claim_closed_after_reopen_date_id, claim_notice_only_date_id, claim_cat_start_date_id, claim_cat_end_date_id, claim_rep_assigned_date_id, claim_rep_unassigned_date_id, gross_serv_saving, gross_serv_saving_percentage, total_serv_review_saving, serv_review_saving_percentage, total_serv_network_red, total_serv_network_red_percentage, total_serv_charge, audit_id, agency_dim_id, contract_cust_dim_id, pol_dim_id, pol_eff_date_id, pol_exp_date_id, claimant_dim_id, claim_rep_dim_prim_claim_rep_id, strtgc_bus_dvsn_dim_id)\n\tSELECT \n\tMED_BILL_DIM_ID, \n\tMED_BILL_SERV_DIM_ID, \n\tCLAIM_OCCURRENCE_DIM_ID, \n\tCLAIM_LOSS_DATE_ID, \n\tCLAIM_DISCOVERY_DATE_ID, \n\tClaim_scripted_date_id AS CLAIM_SCRIPTED_DATE_ID, \n\tSource_Claim_scripted_date_id AS SOURCE_CLAIM_RPTED_DATE_ID, \n\tCLAIM_RPTED_DATE_ID, \n\tCLAIM_OPEN_DATE_ID, \n\tCLAIM_CLOSE_DATE_ID, \n\tCLAIM_REOPEN_DATE_ID, \n\tCLAIM_CLOSED_AFTER_REOPEN_DATE_ID, \n\tClaim_Notice_only_Date_ID AS CLAIM_NOTICE_ONLY_DATE_ID, \n\tCLAIM_CAT_START_DATE_ID, \n\tCLAIM_CAT_END_DATE_ID, \n\tCLAIM_REP_ASSIGNED_DATE_ID, \n\tCLAIM_REP_UNASSIGNED_DATE_ID, \n\tGROSS_SERV_SAVING, \n\tgross_serv_saving_perc AS GROSS_SERV_SAVING_PERCENTAGE, \n\tserv_bill_review_red AS TOTAL_SERV_REVIEW_SAVING, \n\tservice_review_saving_perc AS SERV_REVIEW_SAVING_PERCENTAGE, \n\tserv_network_red AS TOTAL_SERV_NETWORK_RED, \n\ttotal_serv_network_red_perc AS TOTAL_SERV_NETWORK_RED_PERCENTAGE, \n\tserv_charge AS TOTAL_SERV_CHARGE, \n\tAUDIT_ID, \n\tAGENCY_DIM_ID, \n\tCONTRACT_CUST_DIM_ID, \n\tPOL_DIM_ID, \n\tPOL_EFF_DATE_ID, \n\tPOL_EXP_DATE_ID, \n\tCLAIMANT_DIM_ID, \n\tCLAIM_REP_DIM_PRIM_CLAIM_REP_ID, \n\tSTRTGC_BUS_DVSN_DIM_ID\n\tFROM RTR_Insert_Update_INSERT\n),"
                        }
                    ]
                },
                "state": "Inactive",
                "onInactiveMarkAs": "Succeeded"
            }
        ],
        "parameters": {
            "WBMI_AUDIT_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "246513"
            },
            "WBMI_BATCH_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "905536"
            },
            "WBMI_SESSION_CONTROL_RUN_ID": {
                "type": "string",
                "defaultValue": "7604583"
            },
            "SELECTION_START_TS": {
                "type": "string",
                "defaultValue": "08/30/2023 03:42:18"
            },
            "SELECTION_END_TS": {
                "type": "string",
                "defaultValue": "08/31/2023 04:16:08"
            },
            "DBCONNECTION_SOURCE": {
                "type": "string",
                "defaultValue": "SQLServer_RPT_EDM_Claim"
            },
            "DBCONNECTION_TARGET": {
                "type": "string",
                "defaultValue": "SQLServer_WC_Data_Mart_Claim"
            },
            "SOURCE_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "TARGET_TABLE_OWNER": {
                "type": "string",
                "defaultValue": "DBO"
            },
            "SOURCE_SYSTEM_ID": {
                "type": "string",
                "defaultValue": "EXCEED AND PMS"
            },
            "DB_NAME_DATAMART": {
                "type": "string",
                "defaultValue": "WC_Data_Mart"
            },
            "DB_NAME_EDW": {
                "type": "string",
                "defaultValue": "RPT_EDM"
            }
        },
        "folder": {
            "name": "Claims DataMart/"
        },
        "annotations": []
    }
}